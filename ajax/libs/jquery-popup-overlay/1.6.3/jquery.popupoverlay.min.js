!function(t){var e,i=t(window),o={},n=[],a=[],p=null,s="_open",l="_close",d=[],r={_init:function(e){var i=t(e),o=i.data("popupoptions");a[e.id]=!1,n[e.id]=0,i.data("popup-initialized")||(i.attr("data-popup-initialized","true"),r._initonce(e)),o.autoopen&&setTimeout(function(){r.show(e,0)},0)},_initonce:function(i){var o,n=t("body"),a=$el.data("popupoptions");if(p=parseInt(n.css("margin-right"),10),"tooltip"==a.type&&(a.background=!1,a.scrolllock=!1),a.scrolllock){var l,d;"undefined"==typeof e&&(l=t('<div style="width:50px;height:50px;overflow:auto"><div/></div>').appendTo("body"),d=l.children(),e=d.innerWidth()-d.height(99).innerWidth(),l.remove())}if($el.attr("id")||$el.attr("id","j-popup-"+parseInt(1e8*Math.random(),10)),$el.addClass("popup_content"),n.prepend(i),$el.wrap('<div id="'+i.id+'_wrapper" class="popup_wrapper" />'),o=t("#"+i.id+"_wrapper"),o.css({opacity:0,visibility:"hidden",position:"absolute"}),"overlay"==a.type&&o.css({overflow:"auto"}),$el.css({opacity:0,visibility:"hidden",display:"inline-block"}),a.setzindex&&!a.autozindex&&o.css("z-index","100001"),a.outline||$el.css("outline","none"),a.transition&&($el.css("transition",a.transition),o.css("transition",a.transition)),t(i).attr("aria-hidden",!0),a.background&&!t("#"+i.id+"_background").length){var c='<div id="'+i.id+'_background" class="popup_background"></div>';n.prepend(c);var u=t("#"+i.id+"_background");u.css({opacity:0,visibility:"hidden",backgroundColor:a.color,position:"fixed",top:0,right:0,bottom:0,left:0}),a.setzindex&&!a.autozindex&&u.css("z-index","100000"),a.transition&&u.css("transition",a.transition)}"overlay"==a.type&&($el.css({textAlign:"left",position:"relative",verticalAlign:"middle"}),o.css({position:"fixed",top:0,right:0,left:0,bottom:0,textAlign:"center"}),o.append('<div class="popup_align" />'),t(".popup_align").css({display:"inline-block",verticalAlign:"middle",height:"100%"})),$el.attr("role","dialog");var f=a.openelement?a.openelement:"."+i.id+s;t(f).each(function(e,i){t(i).attr("data-popup-ordinal",e),t(i).attr("id")||t(i).attr("id","open_"+parseInt(1e8*Math.random(),10))}),$el.attr("aria-labelledby")||$el.attr("aria-label")||$el.attr("aria-labelledby",t(f).attr("id")),t(document).on("click",f,function(e){if(!$el.data("popup-visible")){var o=t(this).data("popup-ordinal");setTimeout(function(){r.show(i,o)},0),e.preventDefault()}}),a.detach?$el.hide().detach():o.hide()},show:function(o,s){var u=t(o);if(!u.data("popup-visible")){u.data("popup-initialized")||r._init(o),u.attr("data-popup-initialized","true");var f=t("body"),h=u.data("popupoptions"),g=t("#"+o.id+"_wrapper"),v=t("#"+o.id+"_background");if(c(o,s,h.beforeopen),a[o.id]=s,d.push(o.id),h.autozindex){for(var b=document.getElementsByTagName("*"),m=b.length,y=0,_=0;m>_;_++){var k=t(b[_]).css("z-index");"auto"!==k&&(k=parseInt(k,10),k>y&&(y=k))}n[o.id]=y,h.background&&n[o.id]>0&&t("#"+o.id+"_background").css({zIndex:n[o.id]+1}),n[o.id]>0&&g.css({zIndex:n[o.id]+2})}h.detach?(g.prepend(o),u.show()):g.show(),setTimeout(function(){g.css({visibility:"visible",opacity:1}),t("html").addClass("popup_visible").addClass("popup_visible_"+o.id),u.addClass("popup_content_visible")},20),u.css({visibility:"visible",opacity:1}),h.background&&(v.css({visibility:"visible",opacity:h.opacity}),setTimeout(function(){v.css({opacity:h.opacity})},0)),h.scrolllock&&(f.css("overflow","hidden"),f.height()>i.height()&&f.css("margin-right",p+e)),u.data("popup-visible",!0),r.reposition(o,s),u.data("focusedelementbeforepopup",document.activeElement),h.keepfocus&&(u.attr("tabindex",-1),setTimeout(function(){"closebutton"===h.focuselement?t("#"+o.id+" ."+o.id+l+":first").focus():h.focuselement?t(h.focuselement).focus():u.focus()},h.focusdelay)),t(h.pagecontainer).attr("aria-hidden",!0),u.attr("aria-hidden",!1),g.one("transitionend",function(){c(o,s,h.opentransitionend)}),c(o,s,h.onopen)}},hide:function(e){var i=t("body"),o=t(e),n=o.data("popupoptions"),s=t("#"+e.id+"_wrapper"),l=t("#"+e.id+"_background");o.data("popup-visible",!1),1===d.length?t("html").removeClass("popup_visible").removeClass("popup_visible_"+e.id):t("html").removeClass("popup_visible_"+e.id),d.pop(),o.removeClass("popup_content_visible"),n.scrolllock&&setTimeout(function(){i.css({overflow:"visible","margin-right":p})},10),n.keepfocus&&setTimeout(function(){t(o.data("focusedelementbeforepopup")).is(":visible")&&o.data("focusedelementbeforepopup").focus()},0),s.css({visibility:"hidden",opacity:0}),o.css({visibility:"hidden",opacity:0}),n.background&&l.css({visibility:"hidden",opacity:0}),o.one("transitionend",function(t){o.data("popup-visible")||(n.detach?o.hide().detach():s.hide()),n.notransitiondetach||c(e,a[e.id],n.closetransitionend)}),n.notransitiondetach&&(n.detach?o.hide().detach():s.hide()),t(n.pagecontainer).attr("aria-hidden",!1),o.attr("aria-hidden",!0),c(e,a[e.id],n.onclose)},toggle:function(t,e){$el.data("popup-visible")?r.hide(t):setTimeout(function(){r.show(t,e)},0)},reposition:function(e,i){var o=t(e),n=o.data("popupoptions"),a=t("#"+e.id+"_wrapper");t("#"+e.id+"_background");if(i=i||0,"tooltip"==n.type){a.css({position:"absolute"});var p;p=n.triggerevent?t(n.triggerevent.target):n.openelement?t(n.openelement).filter('[data-popup-ordinal="'+i+'"]'):t("."+e.id+s+'[data-popup-ordinal="'+i+'"]');var l=p.offset();"right"==n.horizontal?a.css("left",l.left+p.outerWidth()+n.offsetleft):"leftedge"==n.horizontal?a.css("left",l.left+p.outerWidth()-p.outerWidth()+n.offsetleft):"left"==n.horizontal?a.css("right",t(window).width()-l.left-n.offsetleft):"rightedge"==n.horizontal?a.css("right",t(window).width()-l.left-p.outerWidth()-n.offsetleft):a.css("left",l.left+p.outerWidth()/2-o.outerWidth()/2-parseFloat(o.css("marginLeft"))+n.offsetleft),"bottom"==n.vertical?a.css("top",l.top+p.outerHeight()+n.offsettop):"bottomedge"==n.vertical?a.css("top",l.top+p.outerHeight()-o.outerHeight()+n.offsettop):"top"==n.vertical?a.css("bottom",t(window).height()-l.top-n.offsettop):"topedge"==n.vertical?a.css("bottom",t(window).height()-l.top-o.outerHeight()-n.offsettop):a.css("top",l.top+p.outerHeight()/2-o.outerHeight()/2-parseFloat(o.css("marginTop"))+n.offsettop)}else"overlay"==n.type&&(n.horizontal?a.css("text-align",n.horizontal):a.css("text-align","center"),n.vertical?o.css("vertical-align",n.vertical):o.css("vertical-align","middle"))}},c=function(e,i,n){var a=o.openelement?o.openelement:"."+e.id+s,p=t(a+'[data-popup-ordinal="'+i+'"]');"function"==typeof n&&n(p)};t(document).on("keydown",function(e){if(d.length){var i=d[d.length-1],o=document.getElementById(i);t(o).data("popupoptions").escape&&27==e.keyCode&&t(o).data("popup-visible")&&r.hide(o)}}),t(document).on("click touchstart",function(e){if(d.length){var i=d[d.length-1],o=document.getElementById(i);t(o).data("popupoptions").blur&&!t(e.target).parents().andSelf().is("#"+i)&&t(o).data("popup-visible")&&2!==e.which&&(r.hide(o),"overlay"===t(o).data("popupoptions").type&&e.preventDefault())}}),t(document).on("click",function(e){if(d.length){var i=d[d.length-1],o=document.getElementById(i),n=t(o).data("popupoptions").closeelement?t(o).data("popupoptions").closeelement:"."+i+l;t(e.target).parents().andSelf().is(n)&&(e.preventDefault(),r.hide(o))}}),t(document).on("focusin",function(e){if(d.length){var i=d[d.length-1],o=document.getElementById(i);t(o).data("popupoptions").keepfocus&&(o.contains(e.target)||(e.stopPropagation(),o.focus()))}}),t.fn.popup=function(e){return this.each(function(){if($el=t(this),"object"==typeof e){var i=t.extend({},t.fn.popup.defaults,e);$el.data("popupoptions",i),o=$el.data("popupoptions"),r._init(this)}else"string"==typeof e?($el.data("popupoptions")||($el.data("popupoptions",t.fn.popup.defaults),o=$el.data("popupoptions")),r[e].call(this,this)):($el.data("popupoptions")||($el.data("popupoptions",t.fn.popup.defaults),o=$el.data("popupoptions")),r._init(this))})},t.fn.popup.defaults={type:"overlay",autoopen:!1,background:!0,color:"black",opacity:"0.5",horizontal:"center",vertical:"middle",offsettop:0,offsetleft:0,escape:!0,blur:!0,setzindex:!0,autozindex:!1,scrolllock:!1,keepfocus:!0,focuselement:null,focusdelay:50,outline:!1,pagecontainer:null,detach:!1,openelement:null,closeelement:null,transition:null,triggerevent:null,notransitiondetach:!1,beforeopen:function(){},onclose:function(){},onopen:function(){},opentransitionend:function(){},closetransitionend:function(){}}}(jQuery);