(function(x){"object"===typeof exports&&"undefined"!==typeof module?module.exports=x():"function"===typeof define&&define.amd?define([],x):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).xstream=x()})(function(){return function k(h,f,d){function r(l,n){if(!f[l]){if(!h[l]){var m="function"==typeof require&&require;if(!n&&m)return m(l,!0);if(v)return v(l,!0);n=Error("Cannot find module '"+l+"'");throw n.code="MODULE_NOT_FOUND",n;}n=f[l]={exports:{}};
h[l][0].call(n.exports,function(c){var d=h[l][1][c];return r(d?d:c)},n,n.exports,k,h,f,d)}return f[l].exports}for(var v="function"==typeof require&&require,m=0;m<d.length;m++)r(d[m]);return r}({1:[function(k,h,f){function d(){}function r(b){for(var a=b.length,g=Array(a),c=0;c<a;++c)g[c]=b[c];return g}function v(b,a){return function(g){return b(g)&&a(g)}}function m(b,a,g){try{return b.f(a)}catch(e){return g._e(e),c}}function l(b){b._start=function(a){a.next=a._n;a.error=a._e;a.complete=a._c;this.start(a)};
b._stop=b.stop}var n=this&&this.__extends||function(b,a){function g(){this.constructor=b}for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);b.prototype=null===a?Object.create(a):(g.prototype=a.prototype,new g)},z=k("symbol-observable"),c={};f.NO=c;var p={_n:d,_e:d,_c:d};f.NO_IL=p;var B=function(){function b(a,b){this._stream=a;this._listener=b}b.prototype.unsubscribe=function(){this._stream.removeListener(this._listener)};return b}(),C=function(){function b(a){this._listener=a}b.prototype.next=function(a){this._listener._n(a)};
b.prototype.error=function(a){this._listener._e(a)};b.prototype.complete=function(){this._listener._c()};return b}(),D=function(){function b(a){this.type="fromObservable";this.ins=a;this.active=!1}b.prototype._start=function(a){this.out=a;this.active=!0;this._sub=this.ins.subscribe(new C(a));this.active||this._sub.unsubscribe()};b.prototype._stop=function(){this._sub&&this._sub.unsubscribe();this.active=!1};return b}(),E=function(){function b(a){this.type="merge";this.insArr=a;this.out=c;this.ac=
0}b.prototype._start=function(a){this.out=a;a=this.insArr;var b=a.length;this.ac=b;for(var c=0;c<b;c++)a[c]._add(this)};b.prototype._stop=function(){for(var a=this.insArr,b=a.length,e=0;e<b;e++)a[e]._remove(this);this.out=c};b.prototype._n=function(a){var b=this.out;b!==c&&b._n(a)};b.prototype._e=function(a){var b=this.out;b!==c&&b._e(a)};b.prototype._c=function(){if(0>=--this.ac){var a=this.out;a!==c&&a._c()}};return b}(),G=function(){function b(a,b,c){this.i=a;this.out=b;this.p=c;c.ils.push(this)}
b.prototype._n=function(a){var b=this.p,e=this.out;if(e!==c&&b.up(a,this.i)){a=b.vals;for(var b=a.length,u=Array(b),d=0;d<b;++d)u[d]=a[d];e._n(u)}};b.prototype._e=function(a){var b=this.out;b!==c&&b._e(a)};b.prototype._c=function(){var a=this.p;a.out!==c&&0===--a.Nc&&a.out._c()};return b}(),H=function(){function b(a){this.type="combine";this.insArr=a;this.out=c;this.ils=[];this.Nc=this.Nn=0;this.vals=[]}b.prototype.up=function(a,b){var g=this.vals[b],g=this.Nn?g===c?--this.Nn:this.Nn:0;this.vals[b]=
a;return 0===g};b.prototype._start=function(a){this.out=a;var b=this.insArr,e=this.Nc=this.Nn=b.length,d=this.vals=Array(e);if(0===e)a._n([]),a._c();else for(var f=0;f<e;f++)d[f]=c,b[f]._add(new G(f,a,this))};b.prototype._stop=function(){for(var a=this.insArr,b=a.length,e=this.ils,d=0;d<b;d++)a[d]._remove(e[d]);this.out=c;this.ils=[];this.vals=[]};return b}(),I=function(){function b(a){this.type="fromArray";this.a=a}b.prototype._start=function(a){for(var b=this.a,c=0,d=b.length;c<d;c++)a._n(b[c]);
a._c()};b.prototype._stop=function(){};return b}(),J=function(){function b(a){this.type="fromPromise";this.on=!1;this.p=a}b.prototype._start=function(a){var b=this;this.on=!0;this.p.then(function(g){b.on&&(a._n(g),a._c())},function(b){a._e(b)}).then(d,function(a){setTimeout(function(){throw a;})})};b.prototype._stop=function(){this.on=!1};return b}(),K=function(){function b(a){this.type="periodic";this.period=a;this.intervalID=-1;this.i=0}b.prototype._start=function(a){var b=this;this.intervalID=
setInterval(function(){a._n(b.i++)},this.period)};b.prototype._stop=function(){-1!==this.intervalID&&clearInterval(this.intervalID);this.intervalID=-1;this.i=0};return b}(),L=function(){function b(a,b){this.type="debug";this.ins=a;this.out=c;this.s=d;this.l="";"string"===typeof b?this.l=b:"function"===typeof b&&(this.s=b)}b.prototype._start=function(a){this.out=a;this.ins._add(this)};b.prototype._stop=function(){this.ins._remove(this);this.out=c};b.prototype._n=function(a){var b=this.out;if(b!==c){var e=
this.s,u=this.l;if(e!==d)try{e(a)}catch(F){b._e(F)}else u?console.log(u+":",a):console.log(a);b._n(a)}};b.prototype._e=function(a){var b=this.out;b!==c&&b._e(a)};b.prototype._c=function(){var a=this.out;a!==c&&a._c()};return b}(),M=function(){function b(a,b){this.type="drop";this.ins=b;this.out=c;this.max=a;this.dropped=0}b.prototype._start=function(a){this.out=a;this.dropped=0;this.ins._add(this)};b.prototype._stop=function(){this.ins._remove(this);this.out=c};b.prototype._n=function(a){var b=this.out;
b!==c&&this.dropped++>=this.max&&b._n(a)};b.prototype._e=function(a){var b=this.out;b!==c&&b._e(a)};b.prototype._c=function(){var a=this.out;a!==c&&a._c()};return b}(),N=function(){function b(a,b){this.out=a;this.op=b}b.prototype._n=function(){this.op.end()};b.prototype._e=function(a){this.out._e(a)};b.prototype._c=function(){this.op.end()};return b}(),O=function(){function b(a,b){this.type="endWhen";this.ins=b;this.out=c;this.o=a;this.oil=p}b.prototype._start=function(a){this.out=a;this.o._add(this.oil=
new N(a,this));this.ins._add(this)};b.prototype._stop=function(){this.ins._remove(this);this.o._remove(this.oil);this.out=c;this.oil=p};b.prototype.end=function(){var a=this.out;a!==c&&a._c()};b.prototype._n=function(a){var b=this.out;b!==c&&b._n(a)};b.prototype._e=function(a){var b=this.out;b!==c&&b._e(a)};b.prototype._c=function(){this.end()};return b}(),w=function(){function b(a,b){this.type="filter";this.ins=b;this.out=c;this.f=a}b.prototype._start=function(a){this.out=a;this.ins._add(this)};
b.prototype._stop=function(){this.ins._remove(this);this.out=c};b.prototype._n=function(a){var b=this.out;if(b!==c){var e=m(this,a,b);e!==c&&e&&b._n(a)}};b.prototype._e=function(a){var b=this.out;b!==c&&b._e(a)};b.prototype._c=function(){var a=this.out;a!==c&&a._c()};return b}(),P=function(){function b(a,b){this.out=a;this.op=b}b.prototype._n=function(a){this.out._n(a)};b.prototype._e=function(a){this.out._e(a)};b.prototype._c=function(){this.op.inner=c;this.op.less()};return b}(),Q=function(){function b(a){this.type=
"flatten";this.ins=a;this.out=c;this.open=!0;this.inner=c;this.il=p}b.prototype._start=function(a){this.out=a;this.open=!0;this.inner=c;this.il=p;this.ins._add(this)};b.prototype._stop=function(){this.ins._remove(this);this.inner!==c&&this.inner._remove(this.il);this.out=c;this.open=!0;this.inner=c;this.il=p};b.prototype.less=function(){var a=this.out;a!==c&&(this.open||this.inner!==c||a._c())};b.prototype._n=function(a){var b=this.out;if(b!==c){var e=this.inner,d=this.il;e!==c&&d!==p&&e._remove(d);
(this.inner=a)._add(this.il=new P(b,this))}};b.prototype._e=function(a){var b=this.out;b!==c&&b._e(a)};b.prototype._c=function(){this.open=!1;this.less()};return b}(),R=function(){function b(a,b,e){var g=this;this.type="fold";this.ins=e;this.out=c;this.f=function(b){return a(g.acc,b)};this.acc=this.seed=b}b.prototype._start=function(a){this.out=a;this.acc=this.seed;a._n(this.acc);this.ins._add(this)};b.prototype._stop=function(){this.ins._remove(this);this.out=c;this.acc=this.seed};b.prototype._n=
function(a){var b=this.out;b!==c&&(a=m(this,a,b),a!==c&&b._n(this.acc=a))};b.prototype._e=function(a){var b=this.out;b!==c&&b._e(a)};b.prototype._c=function(){var a=this.out;a!==c&&a._c()};return b}(),S=function(){function b(a){this.type="last";this.ins=a;this.out=c;this.has=!1;this.val=c}b.prototype._start=function(a){this.out=a;this.has=!1;this.ins._add(this)};b.prototype._stop=function(){this.ins._remove(this);this.val=this.out=c};b.prototype._n=function(a){this.has=!0;this.val=a};b.prototype._e=
function(a){var b=this.out;b!==c&&b._e(a)};b.prototype._c=function(){var a=this.out;a!==c&&(this.has?(a._n(this.val),a._c()):a._e(Error("last() failed because input stream completed")))};return b}(),T=function(){function b(a,b){this.out=a;this.op=b}b.prototype._n=function(a){this.out._n(a)};b.prototype._e=function(a){this.out._e(a)};b.prototype._c=function(){this.op.inner=c;this.op.less()};return b}(),U=function(){function b(a){this.type=a.type+"+flatten";this.ins=a.ins;this.out=c;this.mapOp=a;this.inner=
c;this.il=p;this.open=!0}b.prototype._start=function(a){this.out=a;this.inner=c;this.il=p;this.open=!0;this.mapOp.ins._add(this)};b.prototype._stop=function(){this.mapOp.ins._remove(this);this.inner!==c&&this.inner._remove(this.il);this.inner=this.out=c;this.il=p};b.prototype.less=function(){if(!this.open&&this.inner===c){var a=this.out;a!==c&&a._c()}};b.prototype._n=function(a){var b=this.out;if(b!==c){var e=this.inner,d=this.il;a=m(this.mapOp,a,b);a!==c&&(e!==c&&d!==p&&e._remove(d),(this.inner=
a)._add(this.il=new T(b,this)))}};b.prototype._e=function(a){var b=this.out;b!==c&&b._e(a)};b.prototype._c=function(){this.open=!1;this.less()};return b}(),y=function(){function b(a,b){this.type="map";this.ins=b;this.out=c;this.f=a}b.prototype._start=function(a){this.out=a;this.ins._add(this)};b.prototype._stop=function(){this.ins._remove(this);this.out=c};b.prototype._n=function(a){var b=this.out;b!==c&&(a=m(this,a,b),a!==c&&b._n(a))};b.prototype._e=function(a){var b=this.out;b!==c&&b._e(a)};b.prototype._c=
function(){var a=this.out;a!==c&&a._c()};return b}(),A=function(b){function a(a,c,d){c=b.call(this,c,d)||this;c.type="filter+map";c.passes=a;return c}n(a,b);a.prototype._n=function(a){if(this.passes(a)){var b=this.out;b!==c&&(a=m(this,a,b),a!==c&&b._n(a))}};return a}(y),V=function(){function b(a){this.type="remember";this.ins=a;this.out=c}b.prototype._start=function(a){this.out=a;this.ins._add(a)};b.prototype._stop=function(){this.ins._remove(this.out);this.out=c};return b}(),W=function(){function b(a,
b){this.type="replaceError";this.ins=b;this.out=c;this.f=a}b.prototype._start=function(a){this.out=a;this.ins._add(this)};b.prototype._stop=function(){this.ins._remove(this);this.out=c};b.prototype._n=function(a){var b=this.out;b!==c&&b._n(a)};b.prototype._e=function(a){var b=this.out;if(b!==c)try{this.ins._remove(this),(this.ins=this.f(a))._add(this)}catch(e){b._e(e)}};b.prototype._c=function(){var a=this.out;a!==c&&a._c()};return b}(),X=function(){function b(a,b){this.type="startWith";this.ins=
a;this.out=c;this.val=b}b.prototype._start=function(a){this.out=a;this.out._n(this.val);this.ins._add(a)};b.prototype._stop=function(){this.ins._remove(this.out);this.out=c};return b}(),Y=function(){function b(a,b){this.type="take";this.ins=b;this.out=c;this.max=a;this.taken=0}b.prototype._start=function(a){this.out=a;this.taken=0;0>=this.max?a._c():this.ins._add(this)};b.prototype._stop=function(){this.ins._remove(this);this.out=c};b.prototype._n=function(a){var b=this.out;if(b!==c){var e=++this.taken;
e<this.max?b._n(a):e===this.max&&(b._n(a),b._c())}};b.prototype._e=function(a){var b=this.out;b!==c&&b._e(a)};b.prototype._c=function(){var a=this.out;a!==c&&a._c()};return b}(),t=function(){function b(a){this._prod=a||c;this._ils=[];this._dl=this._stopID=c;this._d=!1;this._err=this._target=c}b.prototype._n=function(a){var b=this._ils,c=b.length;this._d&&this._dl._n(a);if(1==c)b[0]._n(a);else if(0!=c)for(var b=r(b),d=0;d<c;d++)b[d]._n(a)};b.prototype._e=function(a){if(this._err===c){this._err=a;var b=
this._ils,e=b.length;this._x();this._d&&this._dl._e(a);if(1==e)b[0]._e(a);else{if(0==e)return;for(var b=r(b),d=0;d<e;d++)b[d]._e(a)}if(!this._d&&0==e)throw this._err;}};b.prototype._c=function(){var a=this._ils,b=a.length;this._x();this._d&&this._dl._c();if(1==b)a[0]._c();else if(0!=b)for(var a=r(a),c=0;c<b;c++)a[c]._c()};b.prototype._x=function(){0!==this._ils.length&&(this._prod!==c&&this._prod._stop(),this._err=c,this._ils=[])};b.prototype._stopNow=function(){this._prod._stop();this._stopID=this._err=
c};b.prototype._add=function(a){var b=this._target;if(b!==c)return b._add(a);b=this._ils;b.push(a);1<b.length||(this._stopID!==c?(clearTimeout(this._stopID),this._stopID=c):(a=this._prod,a!==c&&a._start(this)))};b.prototype._remove=function(a){var b=this,e=this._target;if(e!==c)return e._remove(a);e=this._ils;a=e.indexOf(a);-1<a&&(e.splice(a,1),this._prod!==c&&0>=e.length?(this._err=c,this._stopID=setTimeout(function(){return b._stopNow()})):1===e.length&&this._pruneCycles())};b.prototype._pruneCycles=
function(){this._hasNoSinks(this,[])&&this._remove(this._ils[0])};b.prototype._hasNoSinks=function(a,b){if(-1!==b.indexOf(a)||a.out===this)return!0;if(a.out&&a.out!==c)return this._hasNoSinks(a.out,b.concat(a));if(a._ils){for(var g=0,d=a._ils.length;g<d;g++)if(!this._hasNoSinks(a._ils[g],b.concat(a)))return!1;return!0}return!1};b.prototype.ctor=function(){return this instanceof q?q:b};b.prototype.addListener=function(a){a._n=a.next||d;a._e=a.error||d;a._c=a.complete||d;this._add(a)};b.prototype.removeListener=
function(a){this._remove(a)};b.prototype.subscribe=function(a){this.addListener(a);return new B(this,a)};b.prototype[z.default]=function(){return this};b.create=function(a){if(a){if("function"!==typeof a.start||"function"!==typeof a.stop)throw Error("producer requires both start and stop functions");l(a)}return new b(a)};b.createWithMemory=function(a){a&&l(a);return new q(a)};b.never=function(){return new b({_start:d,_stop:d})};b.empty=function(){return new b({_start:function(a){a._c()},_stop:d})};
b.throw=function(a){return new b({_start:function(b){b._e(a)},_stop:d})};b.from=function(a){if("function"===typeof a[z.default])return b.fromObservable(a);if("function"===typeof a.then)return b.fromPromise(a);if(Array.isArray(a))return b.fromArray(a);throw new TypeError("Type of input to from() must be an Array, Promise, or Observable");};b.of=function(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];return b.fromArray(a)};b.fromArray=function(a){return new b(new I(a))};b.fromPromise=function(a){return new b(new J(a))};
b.fromObservable=function(a){return a.endWhen?a:new b(new D(a))};b.periodic=function(a){return new b(new K(a))};b.prototype._map=function(a){var b=this._prod,c=this.ctor();return b instanceof w?new c(new A(b.f,a,b.ins)):new c(new y(a,this))};b.prototype.map=function(a){return this._map(a)};b.prototype.mapTo=function(a){var b=this.map(function(){return a}),c=b._prod;c.type=c.type.replace("map","mapTo");return b};b.prototype.filter=function(a){var c=this._prod;return c instanceof w?new b(new w(v(c.f,
a),c.ins)):new b(new w(a,this))};b.prototype.take=function(a){return new (this.ctor())(new Y(a,this))};b.prototype.drop=function(a){return new b(new M(a,this))};b.prototype.last=function(){return new b(new S(this))};b.prototype.startWith=function(a){return new q(new X(this,a))};b.prototype.endWhen=function(a){return new (this.ctor())(new O(a,this))};b.prototype.fold=function(a,b){return new q(new R(a,b,this))};b.prototype.replaceError=function(a){return new (this.ctor())(new W(a,this))};b.prototype.flatten=
function(){var a=this._prod;return new b(a instanceof y&&!(a instanceof A)?new U(a):new Q(this))};b.prototype.compose=function(a){return a(this)};b.prototype.remember=function(){return new q(new V(this))};b.prototype.debug=function(a){return new (this.ctor())(new L(this,a))};b.prototype.imitate=function(a){if(a instanceof q)throw Error("A MemoryStream was given to imitate(), but it only supports a Stream. Read more about this restriction here: https://github.com/staltz/xstream#faq");this._target=
a;for(var b=this._ils,c=b.length,d=0;d<c;d++)a._add(b[d]);this._ils=[]};b.prototype.shamefullySendNext=function(a){this._n(a)};b.prototype.shamefullySendError=function(a){this._e(a)};b.prototype.shamefullySendComplete=function(){this._c()};b.prototype.setDebugListener=function(a){a?(this._d=!0,a._n=a.next||d,a._e=a.error||d,a._c=a.complete||d,this._dl=a):(this._d=!1,this._dl=c)};return b}();t.merge=function(){for(var b=[],a=0;a<arguments.length;a++)b[a]=arguments[a];return new t(new E(b))};t.combine=
function(){for(var b=[],a=0;a<arguments.length;a++)b[a]=arguments[a];return new t(new H(b))};f.Stream=t;var q=function(b){function a(a){a=b.call(this,a)||this;a._has=!1;return a}n(a,b);a.prototype._n=function(a){this._v=a;this._has=!0;b.prototype._n.call(this,a)};a.prototype._add=function(a){var b=this._target;if(b!==c)return b._add(a);b=this._ils;b.push(a);1<b.length?this._has&&a._n(this._v):this._stopID!==c?(this._has&&a._n(this._v),clearTimeout(this._stopID),this._stopID=c):this._has?a._n(this._v):
(a=this._prod,a!==c&&a._start(this))};a.prototype._stopNow=function(){this._has=!1;b.prototype._stopNow.call(this)};a.prototype._x=function(){this._has=!1;b.prototype._x.call(this)};a.prototype.map=function(a){return this._map(a)};a.prototype.mapTo=function(a){return b.prototype.mapTo.call(this,a)};a.prototype.take=function(a){return b.prototype.take.call(this,a)};a.prototype.endWhen=function(a){return b.prototype.endWhen.call(this,a)};a.prototype.replaceError=function(a){return b.prototype.replaceError.call(this,
a)};a.prototype.remember=function(){return this};a.prototype.debug=function(a){return b.prototype.debug.call(this,a)};return a}(t);f.MemoryStream=q;Object.defineProperty(f,"__esModule",{value:!0});f.default=t},{"symbol-observable":2}],2:[function(k,h,f){h.exports=k("./lib/index")},{"./lib/index":3}],3:[function(k,h,f){var d="undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{};Object.defineProperty(f,"__esModule",{value:!0});k=(k=k("./ponyfill"))&&
k.__esModule?k:{"default":k};h="undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof d?d:"undefined"!==typeof h?h:Function("return this")();h=(0,k["default"])(h);f["default"]=h},{"./ponyfill":4}],4:[function(k,h,f){Object.defineProperty(f,"__esModule",{value:!0});f["default"]=function(d){var f=d.Symbol;"function"===typeof f?f.observable?d=f.observable:(d=f("observable"),f.observable=d):d="@@observable";return d}},{}]},{},[1])(1)});