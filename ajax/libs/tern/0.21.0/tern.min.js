!function(e,t){return"object"==typeof exports&&"object"==typeof module?t(exports,require("./infer"),require("./signal"),require("acorn"),require("acorn/dist/walk")):"function"==typeof define&&define.amd?define(["exports","./infer","./signal","acorn/dist/acorn","acorn/dist/walk"],t):void t(e.tern||(e.tern={}),tern,tern.signal,acorn,acorn.walk)}(this,function(e,t,n,r,i){"use strict";function o(e,t){this.name=e,this.parent=t,this.scope=this.text=this.ast=this.lineOffsets=null}function s(e,n){var r={directSourceFile:n,allowReturnOutsideFunction:!0,allowImportExportEverywhere:!0,ecmaVersion:e.options.ecmaVersion,allowHashBang:!0},i=e.signalReturnFirst("preParse",n.text,r)||n.text,o=t.parse(i,r);return e.signal("postParse",o,i),o}function a(e,n,r){e.text=r.options.stripCRs?n.replace(/\r\n/g,"\n"):n,e.hasAstral=Y.test(e.text),t.withContext(r.cx,function(){e.ast=s(r,e)}),e.lineOffsets=null}function f(e,n,r){if(n.query&&!X.hasOwnProperty(n.query.type))return r("No query type '"+n.query.type+"' defined");var i=n.query;i||r(null,{});var o=n.files||[];o.length&&++e.uses;for(var s=0;s<o.length;++s){var a=o[s];a.name=e.normalizeFilename(a.name),"delete"==a.type?e.delFile(a.name):u(e,a.name,null,"full"==a.type?a.text:null)}var f="number"==typeof n.timeout?[n.timeout]:null;if(!i)return void c(e,f,function(){});var l=X[i.type];if(l.takesFile){if("string"!=typeof i.file)return r(".query.file must be a string");/^#/.test(i.file)||u(e,i.file,null)}c(e,f,function(n){if(n)return r(n);var s=l.takesFile&&v(e,o,i.file);return l.fullFile&&"part"==s.type?r("Can't run a "+i.type+" query on a file fragment"):(t.resetGuessing(),void t.withContext(e.cx,function(){var n,o=function(){n=l.run(e,i,s)};try{f?t.withTimeout(f[0],o):o()}catch(t){return e.options.debug&&"TernError"!=t.name&&console.error(t.stack),r(t)}r(null,n)}))})}function l(e,n){return t.withContext(e.cx,function(){n.scope=e.cx.topScope,e.signal("beforeLoad",n),t.analyze(n.ast,n.name,n.scope),e.signal("afterLoad",n)}),n}function u(e,n,r,i){var s=e.findFile(n);if(s)return null!=i&&(s.scope&&(e.needsPurge.push(n),t.clearScopes(s.ast),s.scope=null),a(s,i,e)),void(x(e,s.parent)>x(e,r)&&(s.parent=r,s.excluded&&(s.excluded=null)));var f=new o(n,r);e.files.push(f),e.fileMap[n]=f,null!=i?a(f,i,e):e.options.async?(e.startAsyncAction(),e.options.getFile(n,function(t,n){a(f,n||"",e),e.finishAsyncAction(t)})):a(f,e.options.getFile(n)||"",e)}function p(e,t,n){var r=function(){e.off("everythingFetched",r),clearTimeout(i),c(e,t,n)};e.on("everythingFetched",r);var i=setTimeout(r,e.options.fetchTimeout)}function c(e,n,r){if(e.pending)return p(e,n,r);var i=e.fetchError;if(i)return e.fetchError=null,r(i);e.needsPurge.length>0&&t.withContext(e.cx,function(){t.purge(e.needsPurge),e.needsPurge.length=0});for(var o=!0,s=0;s<e.files.length;){for(var a=[];s<e.files.length;++s){var f=e.files[s];null==f.text?o=!1:null!=f.scope||f.excluded||a.push(f)}a.sort(function(t,n){return x(e,t.parent)-x(e,n.parent)});for(var u=0;u<a.length;u++){var f=a[u];if(f.parent&&!w(e,f))f.excluded=!0;else if(n){var c=+new Date;try{t.withTimeout(n[0],function(){l(e,f)})}catch(e){if(e instanceof t.TimedOut)return r(e);throw e}n[0]-=+new Date-c}else l(e,f)}}o?r():p(e,n,r)}function d(e){var t=e.indexOf("\n");return t<0?e:e.slice(0,t)}function h(e,t,n){var r=Math.max(0,n-500),i=null;if(!/^\s*$/.test(e))for(;;){var o=t.indexOf(e,r);if(o<0||o>n+500)break;(null==i||Math.abs(i-n)>Math.abs(o-n))&&(i=o),r=o+e.length}return i}function g(e){for(var t=0;e;++t,e=e.prev);return t}function y(e){var t=new Error(e);return t.name="TernError",t}function v(e,n,r){var o=r.match(/^#(\d+)$/);if(!o)return e.findFile(r);var a=n[o[1]];if(!a||"delete"==a.type)throw y("Reference to unknown file "+r);if("full"==a.type)return e.fileMap[a.name];var f,l,u=a.backing=e.fileMap[a.name],p=te(u,null==a.offsetLines?a.offset:{line:a.offsetLines,ch:0},!0),c=d(a.text),v=h(c,u.text,p),m=null==v?Math.max(0,u.text.lastIndexOf("\n",p)):v;return t.withContext(e.cx,function(){t.purge(a.name,m,m+a.text.length);var n,r=a.text;if(n=r.match(/(?:"([^"]*)"|([\w$]+))\s*:\s*function\b/)){var o=i.findNodeAround(a.backing.ast,m,"ObjectExpression");o&&o.node.objType&&(f={type:o.node.objType,prop:n[2]||n[1]})}if(v&&(n=c.match(/^(.*?)\bfunction\b/))){for(var p=n[1].length,d="",h=0;h<p;++h)d+=" ";a.text=d+r.slice(p),l=!0}var y=t.scopeAt(u.ast,m,u.scope),x=t.scopeAt(u.ast,m+r.length,u.scope),b=a.scope=g(y)<g(x)?x:y;a.ast=s(e,a),t.analyze(a.ast,a.name,b);e:if(f||l){var w=t.scopeAt(a.ast,c.length,y);if(!w.fnType)break e;if(f){var F=f.type.getProp(f.prop);F.addType(w.fnType)}else if(l){var O=t.scopeAt(u.ast,m+c.length,u.scope);if(O==y||!O.fnType)break e;var P=O.fnType,j=w.fnType;if(!j||j.name!=P.name&&P.name)break e;for(var h=0,A=Math.min(P.args.length,j.args.length);h<A;++h)P.args[h].propagate(j.args[h]);P.self.propagate(j.self),j.retval.propagate(P.retval)}}}),a}function m(e){var t=0;return i.simple(e,{Expression:function(){++t}}),t}function x(e,t){for(var n=0;t;)t=e.fileMap[t].parent,++n;return n}function b(e,t){for(;;){var n=e.fileMap[t.parent];if(!n.parent)break;t=n}return t.name}function w(e,t){var n=b(e,t),r=m(t.ast),i=e.budgets[n];return null==i&&(i=e.budgets[n]=e.options.dependencyBudget),!(i<r)&&(e.budgets[n]=i-r,!0)}function F(e){return"number"==typeof e||"object"==typeof e&&"number"==typeof e.line&&"number"==typeof e.ch}function O(e){if(e.query){if("string"!=typeof e.query.type)return".query.type must be a string";if(e.query.start&&!F(e.query.start))return".query.start must be a position";if(e.query.end&&!F(e.query.end))return".query.end must be a position"}if(e.files){if(!Array.isArray(e.files))return"Files property must be an array";for(var t=0;t<e.files.length;++t){var n=e.files[t];if("object"!=typeof n)return".files[n] must be objects";if("string"!=typeof n.name)return".files[n].name must be a string";if("delete"!=n.type){if("string"!=typeof n.text)return".files[n].text must be a string";if("part"==n.type){if(!F(n.offset)&&"number"!=typeof n.offsetLines)return".files[n].offset must be a position"}else if("full"!=n.type)return'.files[n].type must be "full" or "part"'}}}}function P(e,t,n){var r,i=t+n;if(e.hasAstral)for(Y.lastIndex=t;(r=Y.exec(e.text))&&r.index<i;)i++;return i}function j(e,t){for(var n=e.text,r=e.lineOffsets||(e.lineOffsets=[0]),i=0,o=0,s=Math.min(Math.floor(t/ee),r.length-1),i=r[s],o=s*ee;o<t;){if(++o,i=n.indexOf("\n",i)+1,0===i)return null;o%ee===0&&r.push(i)}return i}function A(e,t,n){var r,i=n-t;if(e.hasAstral)for(Y.lastIndex=t;(r=Y.exec(e.text))&&r.index<n;)i--;return i}function k(e,t){if(!e)return{line:0,ch:0};for(var n,r,i=e.lineOffsets||(e.lineOffsets=[0]),o=e.text,s=i.length-1;s>=0;--s)i[s]<=t&&(n=s*ee,r=i[s]);for(;;){var a=o.indexOf("\n",r);if(a>=t||a<0)break;r=a+1,++n}return{line:n,ch:A(e,r,t)}}function C(e){for(var t in e)null==e[t]&&delete e[t];return e}function T(e,t,n){null!=n&&(e[t]=n)}function M(e,t){"string"!=typeof e&&(e=e.name,t=t.name);var n=/^[A-Z]/.test(e),r=/^[A-Z]/.test(t);return n==r?e<t?-1:e==t?0:1:n?1:-1}function q(e,t,n){return"Literal"==e.type&&"string"==typeof e.value&&e.start==t-1&&e.end<=n+1}function E(e,t){for(var n=0;n<e.properties.length;n++){var r=e.properties[n];if(r.key.start<=t&&r.key.end>=t)return r}}function N(e,n,i){function o(t,r,i,o){if((!x&&n.omitObjectPrototype===!1||r!=e.cx.protos.Object||p)&&!(n.filter!==!1&&p&&0!==(n.caseInsensitive?t.toLowerCase():t).indexOf(p)||u&&u.props[t])){var s=oe(n,c,t,r&&r.props[t],i);o&&s&&"string"!=typeof s&&o(s)}}if(null==n.end)throw y("missing .query.end field");var s=e.signalReturnFirst("completion",i,n);if(s)return s;for(var a=te(i,n.end),f=a,l=i.text;a&&r.isIdentifierChar(l.charCodeAt(a-1));)--a;if(n.expandWordForward!==!1)for(;f<l.length&&r.isIdentifierChar(l.charCodeAt(f));)++f;var u,p=l.slice(a,f),c=[];n.caseInsensitive&&(p=p.toLowerCase());var d,h,g,v,m,x,b=t.findExpressionAround(i.ast,null,a,i.scope);if(b){var w=b.node;if(n.inLiteral===!1&&"Literal"===w.type&&("string"==typeof w.value||w.regex))return{start:ne(n,i,a),end:ne(n,i,f),completions:[]};if("MemberExpression"==w.type&&w.object.end<a)m=b;else if(q(w,a,f)){var F=t.parentNode(w,i.ast);"MemberExpression"==F.type&&F.property==w&&(m={node:F,state:b.state})}else if("ObjectExpression"==w.type){var O=E(w,f);O?(x=b,h=v=O.key.name):p||/:\s*$/.test(i.text.slice(0,a))||(x=b,h=v=!0)}}if(x)g=t.typeFromContext(i.ast,x),u=x.node.objType;else if(m)h=m.node.property,h="Literal"==h.type?h.value.slice(1):h.name,m.node=m.node.object,g=t.expressionType(m);else if("."==l.charAt(a-1)){for(var P=a-1;P&&("."==l.charAt(P-1)||r.isIdentifierChar(l.charCodeAt(P-1)));)P--;var j=l.slice(P,a-1);j&&(g=t.def.parsePath(j,i.scope).getObjType(),h=p)}if(null!=h){if(e.cx.completingProperty=h,g&&t.forAllPropertiesOf(g,o),!c.length&&n.guess!==!1&&g&&g.guessProperties&&g.guessProperties(function(e,t,n){e!=h&&"âœ–"!=e&&o(e,t,n)}),!c.length&&p.length>=2&&n.guess!==!1)for(var h in e.cx.props)o(h,e.cx.props[h][0],0);d="memberCompletion"}else t.forAllLocalsAt(i.ast,a,i.scope,o),n.includeKeywords&&(e.options.ecmaVersion>=6?ie:re).forEach(function(e){o(e,null,0,function(e){e.isKeyword=!0})}),d="variableCompletion";return e.signal(d,i,a,f,o),n.sort!==!1&&c.sort(M),e.cx.completingProperty=null,{start:ne(n,i,a),end:ne(n,i,f),isProperty:!!h,isObjectKey:!!v,completions:c}}function D(e,t){var n=t.prefix,r=[];for(var i in e.cx.props)"<i>"==i||n&&0!==i.indexOf(n)||r.push(i);return t.sort!==!1&&r.sort(M),{completions:r}}function I(e,t){var n,r,i=e.body;return!!i&&(Array.isArray(i)?(n=i[0].start,r=i[i.length-1].end):(n=i.start,r=i.end),n<=t&&r>=t)}function L(e,t,n){var r=se(e,t,n);if(r)return r;throw y("No expression at the given position.")}function R(e){return e&&(e=e.getType())&&e instanceof t.Obj?e:null}function S(e,n,r,i){var o;i&&(t.resetGuessing(),o=t.expressionType(i));var s=e.hasHandler("typeAt");if(s)for(var a=te(r,n.end),f=0;f<s.length;f++)o=s[f](r,a,i,o);if(!o)throw y("No type found at the given position.");var l;if("ObjectExpression"==i.node.type&&null!=n.end&&(l=E(i.node,te(r,n.end)))){var u=l.key.name,p=R(t.typeFromContext(r.ast,i));if(p&&p.hasProp(u))o=p.hasProp(u);else{var c=R(o);c&&c.hasProp(u)&&(o=c.hasProp(u))}}return o}function z(e,n,r){var i,o=se(r,n),s=S(e,n,r,o),a=s;if(s=n.preferFunction?s.getFunctionType()||s.getType():s.getType(),o&&("Identifier"==o.node.type?i=o.node.name:"MemberExpression"!=o.node.type||o.node.computed?"MethodDefinition"!=o.node.type||o.node.computed||(i=o.node.key.name):i=o.node.property.name),null!=n.depth&&"number"!=typeof n.depth)throw y(".query.depth must be a number");var f={guess:t.didGuess(),type:t.toString(a,n.depth),name:s&&s.name,exprName:i,doc:a.doc,url:a.url};return s&&B(n,s,f),C(f)}function G(e,t){if(!t)return null;if("full"==e.docFormat)return t;var n=/.\n[\s@\n]/.exec(t);if(n&&(t=t.slice(0,n.index+1)),t=t.replace(/\n\s*/g," "),t.length<100)return t;var r=/[\.!?] [A-Z]/g;r.lastIndex=80;var i=r.exec(t);return i&&(t=t.slice(0,i.index+1)),t}function $(e,n,r){var i=se(r,n),o=S(e,n,r,i),s={url:o.url,doc:G(n,o.doc),type:t.toString(o)},a=o.getType();return a&&B(n,a,s),C(s)}function B(e,n,r){r.url||(r.url=n.url),r.doc||(r.doc=G(e,n.doc)),r.origin||(r.origin=n.origin);var i,o=t.cx().protos;!r.url&&!r.doc&&n.proto&&(i=n.proto.hasCtor)&&n.proto!=o.Object&&n.proto!=o.Function&&n.proto!=o.Array&&(r.url=i.url,r.doc=G(e,i.doc))}function V(e,n,r){var i=se(r,n),o=S(e,n,r,i);if(t.didGuess())return{};var s=ae(o),a={url:o.url,doc:G(n,o.doc),origin:o.origin};if(o.types)for(var f=o.types.length-1;f>=0;--f){var l=o.types[f];B(n,l,a),s||(s=ae(l))}if(s&&s.node){var u=s.node.sourceFile||e.fileMap[s.origin],p=ne(n,u,s.node.start),c=ne(n,u,s.node.end);a.start=p,a.end=c,a.file=s.origin;var d=Math.max(0,s.node.start-50);a.contextOffset=s.node.start-d,a.context=u.text.slice(d,d+50)}else s&&(a.file=s.origin,fe(e,n,s,a));return C(a)}function K(e,n,r,i,o){function s(e){return function(t,r,i){var s={file:e.name,start:ne(n,e,t.start),end:ne(n,e,t.end)};if(o){for(var l=r;l!=f;l=l.prev){var p=l.hasProp(o);if(p)throw y("Renaming `"+a+"` to `"+o+"` would make a variable at line "+(k(e,t.start).line+1)+" point to the definition at line "+(k(e,p.name.start).line+1))}var c=i[i.length-2];c&&"Property"==c.type&&c.key==c.value&&(s.isShorthand=!0)}u.push(s)}}for(var a=i.node.name,f=i.state;f&&!(a in f.props);f=f.prev);if(!f)throw y("Could not find a definition for "+a);var l,u=[];if(f.originNode){if(l="local",o){for(var p=f.prev;p&&!(o in p.props);p=p.prev);p&&t.findRefs(f.originNode,f,o,p,function(e){throw y("Renaming `"+a+"` to `"+o+"` would shadow the definition used at line "+(k(r,e.start).line+1))})}t.findRefs(f.originNode,f,a,f,s(r))}else if(l="global",n.onlySourceFile)t.findRefs(r.ast,r.scope,a,f,s(r));else for(var c=0;c<e.files.length;++c){var d=e.files[c];t.findRefs(d.ast,d.scope,a,f,s(d))}return{refs:u,type:l,name:a}}function Z(e,n,r,i,o){function s(e){return function(t){l.push({file:e.name,start:ne(n,e,t.start),end:ne(n,e,t.end)})}}var a=t.expressionType(i);"MethodDefinition"==i.node.type&&(a=a.propertyOf);var f=a.getObjType();if(!f)throw y("Couldn't determine type of base object.");var l=[];if(n.onlySourceFile)t.findPropRefs(r.ast,r.scope,f,o.name,s(r));else for(var u=0;u<e.files.length;++u){var p=e.files[u];t.findPropRefs(p.ast,p.scope,f,o.name,s(p))}return{refs:l,name:o.name}}function H(e,t,n){var r=L(n,t,!0);if(r&&"Identifier"==r.node.type)return K(e,t,n,r);if(r&&"MemberExpression"==r.node.type&&!r.node.computed){var i=r.node.property;return r.node=r.node.object,Z(e,t,n,r,i)}if(r&&"ObjectExpression"==r.node.type)for(var o=te(n,t.end),s=0;s<r.node.properties.length;++s){var a=r.node.properties[s].key;if(a.start<=o&&a.end>=o)return Z(e,t,n,r,a)}else if(r&&"MethodDefinition"==r.node.type){var i=r.node.key;return Z(e,t,n,r,i)}throw y("Not at a variable or property name.")}function Q(e,t,n){if("string"!=typeof t.newName)throw y(".query.newName should be a string");var r=L(n,t);if(!r||"Identifier"!=r.node.type)throw y("Not at a variable.");var i=K(e,t,n,r,t.newName),o=i.refs;delete i.refs,i.files=e.files.map(function(e){return e.name});for(var s=i.changes=[],a=0;a<o.length;++a){var f=o[a];f.isShorthand?f.text=r.node.name+": "+t.newName:f.text=t.newName,s.push(f)}return i}function W(e){return{files:e.files.map(function(e){return e.name})}}var J=Object.create(null);e.registerPlugin=function(e,t){J[e]=t};var U=e.defaultOptions={debug:!1,async:!1,getFile:function(e,t){this.async&&t(null,null)},normalizeFilename:function(e){return e},defs:[],plugins:{},fetchTimeout:1e3,dependencyBudget:2e4,reuseInstances:!0,stripCRs:!1,ecmaVersion:6,projectDir:"/",parent:null},X={completions:{takesFile:!0,run:N},properties:{run:D},type:{takesFile:!0,run:z},documentation:{takesFile:!0,run:$},definition:{takesFile:!0,run:V},refs:{takesFile:!0,fullFile:!0,run:H},rename:{takesFile:!0,fullFile:!0,run:Q},files:{run:W}};e.defineQueryType=function(e,t){X[e]=t},o.prototype.asLineChar=function(e){return k(this,e)};var Y=/[\uD800-\uDBFF]/g,_=e.Server=function(e){this.cx=null,this.options=e||{};for(var t in U)e.hasOwnProperty(t)||(e[t]=U[t]);this.projectDir=e.projectDir.replace(/\\/g,"/"),/\/$/.test(this.projectDir)||(this.projectDir+="/"),this.parent=e.parent,this.handlers=Object.create(null),this.files=[],this.fileMap=Object.create(null),this.needsPurge=[],this.budgets=Object.create(null),this.uses=0,this.pending=0,this.asyncError=null,this.mod={},this.defs=e.defs.slice(0),this.plugins=Object.create(null);for(var n in e.plugins)e.plugins.hasOwnProperty(n)&&this.loadPlugin(n,e.plugins[n]);this.reset()};_.prototype=n.mixin({addFile:function(e,t,n){!n||n in this.fileMap||(n=null),e in this.fileMap||(e=this.normalizeFilename(e)),u(this,e,n,t)},delFile:function(e){var t=this.findFile(e);if(t){this.needsPurge.push(t.name);for(var n=0;n<this.files.length;n++)this.files[n]==t?this.files.splice(n--,1):this.files[n].parent==e&&(this.files[n].parent=null);delete this.fileMap[t.name]}},reset:function(){this.signal("reset"),this.cx=new t.Context(this.defs,this),this.uses=0,this.budgets=Object.create(null);for(var e=0;e<this.files.length;++e){var n=this.files[e];n.scope&&(t.clearScopes(n.ast),n.scope=null)}this.signal("postReset")},request:function(e,t){var n=O(e);if(n)return t(n);var r=this;f(this,e,function(e,n){t(e,n),r.uses>40&&(r.reset(),c(r,null,function(){}))})},findFile:function(e){return this.fileMap[this.normalizeFilename(e)]},flush:function(e){var n=this.cx;c(this,null,function(r){return r?e(r):void t.withContext(n,e)})},startAsyncAction:function(){++this.pending},finishAsyncAction:function(e){e&&(this.asyncError=e),0===--this.pending&&this.signal("everythingFetched")},addDefs:function(e,t){t?this.defs.unshift(e):this.defs.push(e),this.cx&&this.reset()},deleteDefs:function(e){for(var t=0;t<this.defs.length;t++)if(this.defs[t]["!name"]==e)return this.defs.splice(t,1),void(this.cx&&this.reset())},loadPlugin:function(e,t){if(1==arguments.length&&(t=this.options.plugins[e]||!0),!(e in this.plugins)&&e in J&&t){this.plugins[e]=!0;var n=J[e](this,t);if(n&&(n.defs&&this.addDefs(n.defs,n.loadFirst),n.passes))for(var r in n.passes)n.passes.hasOwnProperty(r)&&this.on(r,n.passes[r])}},normalizeFilename:function(e){var t=this.options.normalizeFilename(e).replace(/\\/g,"/");return 0==t.indexOf(this.projectDir)&&(t=t.slice(this.projectDir.length)),t}});var ee=25,te=e.resolvePos=function(e,t,n){if("number"!=typeof t){var r=j(e,t.line);if(null==r){if(!n)throw y("File doesn't contain a line "+t.line);t=e.text.length}else t=P(e,r,t.ch)}else t=P(e,0,t);if(t>e.text.length){if(!n)throw y("Position "+t+" is outside of file.");t=e.text.length}return t},ne=e.outputPos=function(e,t,n){if(e.lineCharPositions){var r=k(t,n);return"part"==t.type&&(r.line+=null!=t.offsetLines?t.offsetLines:k(t.backing,t.offset).line),r}return A(t,0,n)+("part"==t.type?t.offset:0)},re="break do instanceof typeof case else new var catch finally return void continue for switch while debugger function this with default if throw delete in try".split(" "),ie=re.concat("export class extends const super yield import let static".split(" ")),oe=e.addCompletion=function(e,n,r,i,o){for(var s=e.types||e.docs||e.urls||e.origins,a=s||e.depths,f=0;f<n.length;++f){var l=n[f];if((a?l.name:l)==r)return}var u=a?{name:r}:r;if(n.push(u),i&&s){t.resetGuessing();var p=i.getType();u.guess=t.didGuess(),e.types&&(u.type=t.toString(i)),e.docs&&T(u,"doc",G(e,i.doc||p&&p.doc)),e.urls&&T(u,"url",i.url||p&&p.url),e.origins&&T(u,"origin",i.origin||p&&p.origin)}return e.depths&&(u.depth=o||0),u},se=e.findQueryExpr=function(e,n,r){if(null==n.end)throw y("missing .query.end field");if(n.variable){var i=t.scopeAt(e.ast,te(e,n.end),e.scope);return{node:{type:"Identifier",name:n.variable,start:n.end,end:n.end+1},state:i}}var o=n.start&&te(e,n.start),s=te(e,n.end),a=t.findExpressionAt(e.ast,o,s,e.scope);if(!a){var f=t.findExpressionAround(e.ast,o,s,e.scope);f&&!I(f.node,s)&&("ObjectExpression"==f.node.type||r||(null==o?s:o)-f.node.start<20||f.node.end-s<20)&&(a=f)}return a},ae=e.getSpan=function(e){if(e.origin){if(e.originNode){var t=e.originNode;return/^Function/.test(t.type)&&t.id&&(t=t.id),{origin:e.origin,node:t}}return e.span?{origin:e.origin,span:e.span}:void 0}},fe=e.storeSpan=function(e,t,n,r){if(r.origin=n.origin,n.span){var i=/^(\d+)\[(\d+):(\d+)\]-(\d+)\[(\d+):(\d+)\]$/.exec(n.span);r.start=t.lineCharPositions?{line:Number(i[2]),ch:Number(i[3])}:Number(i[1]),r.end=t.lineCharPositions?{line:Number(i[5]),ch:Number(i[6])}:Number(i[4])}else{var o=e.fileMap[n.origin];r.start=ne(t,o,n.node.start),r.end=ne(t,o,n.node.end)}};e.version="0.21.0"});
//# sourceMappingURL=tern.min.js.map