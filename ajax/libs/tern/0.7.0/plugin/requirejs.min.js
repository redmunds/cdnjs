!function(e){return"object"==typeof exports&&"object"==typeof module?e(require("../lib/infer"),require("../lib/tern")):"function"==typeof define&&define.amd?define(["../lib/infer","../lib/tern"],e):void e(tern,tern)}(function(e,r){"use strict";function n(e){if(!/(^|\/)(\.\/|[^\/]+\/\.\.\/)/.test(e))return e;for(var r=e.split("/"),n=0;n<r.length;++n)"."!=r[n]&&r[n]?n&&".."==r[n]&&r.splice(n-- -1,2):r.splice(n--,1);return r.join("/")}function t(e,r){var t=e.indexOf("!");t>-1&&(e=e.slice(0,t));var i=r.options,o=/\.js$/.test(e);if(o||/^(?:\w+:|\/)/.test(e))return e+(o?"":".js");var u=i.baseURL||"";if(u&&"/"!=u.charAt(u.length-1)&&(u+="/"),i.paths){var s=i.paths[e];if(s)return n(u+s+".js");var a=e.match(/^([^\/]+)(\/.*)$/);if(a){var s=i.paths[a[1]];if(s)return n(u+s+a[2]+".js")}}return n(u+e+".js")}function i(r){return r.require||(r.require=new e.Fn("require",e.ANull,[e.cx().str],["module"],new e.AVal),r.require.computeRet=function(n,t,i){return i.length&&"Literal"==i[0].type&&"string"==typeof i[0].value?o(i[0].value,r):e.ANull}),r.require}function o(r,o){if("require"==r)return i(o);if("module"==r)return e.cx().definitions.requirejs.module;if(o.options.override&&Object.prototype.hasOwnProperty.call(o.options.override,r)){var l=o.options.override[r];if("string"==typeof l&&"="==l.charAt(0))return e.def.parsePath(l.slice(1));if("object"==typeof l){var f=u(r,o);if(f)return f;var p=o.interfaces[a(r)]=new e.Obj(null,a(r));return e.def.load(l,p),p}r=l}/^(https?:|\/)|\.js$/.test(r)||(r=t(r,o)),r=n(r);var f=u(r,o);return f||(f=s(r,o),o.server.addFile(r,null,o.currentFile)),f}function u(e,r){return r.interfaces[a(e)]}function s(r,n){var t=u(r,n);return t||(t=n.interfaces[a(r)]=new e.AVal,t.origin=r),t}function a(e){return e.replace(/\.js$/,"")}function l(e){switch(e.type){case"ArrayExpression":return e.elements.map(l);case"Literal":return e.value;case"ObjectExpression":var r={};return e.properties.forEach(function(e){var n=e.key.name||e.key.value;r[n]=l(e.value)}),r}}function f(r){var n=e.cx().parent._requireJS.interfaces,t=r.roots["!requirejs"]=new e.Obj(null);for(var i in n){var o=t.defProp(i.replace(/\./g,"`"));n[i].propagate(o),o.origin=n[i].origin}}function p(r){var n=e.cx(),t=n.definitions[r["!name"]]["!requirejs"],r=n.parent._requireJS;if(t)for(var i in t.props)t.props[i].propagate(o(i,r))}var c=50,v={dirname:function(e){var r=e.lastIndexOf("/");return r==-1?"":e.slice(0,r)},relative:function(e,r){return 0==r.indexOf(e)?r.slice(e.length):r},join:function(e,r){return r&&"."!=r.charAt(0)?r:e&&r?e+"/"+r:(e||"")+(r||"")}};e.registerFunction("requireJS",function(r,n,t){var i=e.cx().parent,u=i&&i._requireJS;if(!u||!n.length)return e.ANull;var a,l=u.currentFile,f=s(l,u),p=[];if(t&&n.length>1){var d=t[2==n.length?0:1],g=v.relative(i.options.projectDir,v.dirname(d.sourceFile.name));if("Literal"==d.type&&"string"==typeof d.value)p.push(o(v.join(g,d.value),u));else if("ArrayExpression"==d.type)for(var h=0;h<d.elements.length;++h){var j=d.elements[h];if("Literal"==j.type&&"string"==typeof j.value)if("exports"==j.value){var q=new e.Obj(!0);p.push(q),f.addType(q,c)}else p.push(o(v.join(g,j.value),u))}}else if(t&&1==n.length&&"FunctionExpression"==t[0].type&&t[0].params.length){var q=new e.Obj(!0);p.push(o("require",u),q),f.addType(q,c),a=n[0]}return a||(a=n[Math.min(n.length-1,2)],a.isEmpty()||a.getFunctionType()||(a=null)),a?a.propagate(new e.IsCallee(e.ANull,p,null,f)):n.length&&n[0].propagate(f),e.ANull}),e.registerFunction("requireJSConfig",function(r,n,t){var i=e.cx().parent,o=i&&i._requireJS;if(o&&t&&t.length&&"ObjectExpression"==t[0].type){var u=l(t[0]);for(var s in u)if(u.hasOwnProperty(s)){var a=u[s],f=o.options[s];if(f){if("paths"==s)for(var p in a)a.hasOwnProperty(p)&&!o.options.paths[p]&&(o.options.paths[p]=a[p])}else o.options[s]=a}}return e.ANull}),r.registerPlugin("requirejs",function(e,r){return e._requireJS={interfaces:Object.create(null),options:r||{},currentFile:null,server:e},e.on("beforeLoad",function(e){this._requireJS.currentFile=e.name}),e.on("reset",function(){this._requireJS.interfaces=Object.create(null),this._requireJS.require=null}),{defs:d,passes:{preCondenseReach:f,postLoadDef:p}}});var d={"!name":"requirejs","!define":{module:{id:"string",uri:"string",config:"fn() -> ?",exports:"?"}},requirejs:{"!type":"fn(deps: [string], callback: fn(), errback: fn()) -> !custom:requireJS",onError:"fn(err: +Error)",load:"fn(context: ?, moduleName: string, url: string)",config:"fn(config: ?) -> !custom:requireJSConfig",version:"string",isBrowser:"bool"},require:"requirejs",define:{"!type":"fn(deps: [string], callback: fn()) -> !custom:requireJS",amd:{jQuery:"bool"}}}});
//# sourceMappingURL=requirejs.min.js.map