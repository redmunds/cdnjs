!function(e){return"object"==typeof exports&&"object"==typeof module?e(require("../lib/infer"),require("../lib/tern"),require("acorn/dist/walk"),require("./modules")):"function"==typeof define&&define.amd?define(["../lib/infer","../lib/tern","acorn/dist/walk","./modules"],e):void e(tern,tern,acorn.walk)}(function(e,r,o){"use strict";function i(r,i){function t(o,t,n){a||(a=new e.Obj(!0),a.origin=r.name,a.originNode=r.ast,i.addType(a)),t.propagate(a.defProp(o,n))}var n=e.cx().parent.mod.modules,a=null;o.simple(r.ast,{ImportDeclaration:function(e){for(var o=n.resolveModule(e.source.value,r.name),i=0;i<e.specifiers.length;i++){var t=e.specifiers[i],a=r.scope.getProp(t.local.name);if("ImportNamespaceSpecifier"==t.type)o.propagate(a);else{var l="ImportDefaultSpecifier"==t.type?"default":t.imported.name;o.getProp(l).propagate(a)}}},ExportAllDeclaration:function(e){var o=n.resolveModule(e.source.value,r.name);o.forAllProps(function(e,r,o){o&&t(e,r,r.originNode)})},ExportDefaultDeclaration:function(o){var i=o.declaration.id||o.declaration;t("default",e.expressionType({node:i,state:r.scope}),i)},ExportNamedDeclaration:function(e){var o=e.declaration;if(o)if("VariableDeclaration"==o.type)for(var i=0;i<o.declarations.length;++i){var a=o.declarations[i];"Identifier"==a.id.type&&t(a.id.name,r.scope.getProp(a.id.name),a.id)}else t(o.id.name,r.scope.getProp(o.id.name),o.id);if(e.specifiers.length)for(var l=e.source?n.resolveModule(e.source.value,r.name):r.scope,i=0;i<e.specifiers.length;i++){var p=e.specifiers[i];t(p.exported.name,l.getProp(p.local.name),p.local)}}})}function t(r){if("Literal"==r.type&&"string"==typeof r.value){var o=e.findExpressionAround(r.sourceFile.ast,null,r.end,null,function(e,r){return"ImportDeclaration"==r.type||/Export(All|Named)Declaration/.test(r.type)});if(o&&o.node.source==r)return r.value}}function n(r){if("Identifier"==r.type){var o=e.findExpressionAround(r.sourceFile.ast,null,r.end,null,"ImportDeclaration");if(o)for(var i=o.node.specifiers,t=0;t<i.length;t++){var n=i[t];if(n.local==r){var a={name:o.node.source.value,prop:null};return"ImportDefaultSpecifier"==n.type?a.prop="default":"ImportSpecifier"==n.type&&(a.prop=n.imported.name),a}}}}r.registerPlugin("es_modules",function(e){e.loadPlugin("modules"),e.mod.modules.on("getExports",i),e.mod.modules.modNameTests.push(t),e.mod.modules.importTests.push(n)})});
//# sourceMappingURL=es_modules.min.js.map