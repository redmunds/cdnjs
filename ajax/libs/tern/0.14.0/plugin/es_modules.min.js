!function(e){return"object"==typeof exports&&"object"==typeof module?e(require("../lib/infer"),require("../lib/tern"),require("acorn/dist/walk"),require("./modules")):"function"==typeof define&&define.amd?define(["../lib/infer","../lib/tern","acorn/dist/walk","./modules"],e):void e(tern,tern,acorn.walk)}(function(e,r,o){"use strict";function t(r,t){function i(o,i,n){a||(a=new e.Obj(!0),a.origin=r.name,a.originNode=r.ast,t.addType(a)),i.propagate(a.defProp(o,n))}var n=e.cx().parent.mod.modules,a=null;o.simple(r.ast,{ImportDeclaration:function(e){for(var o=n.resolveModule(e.source.value,r.name),t=0;t<e.specifiers.length;t++){var i=e.specifiers[t],a=r.scope.getProp(i.local.name);if("ImportNamespaceSpecifier"==i.type)o.propagate(a);else{var l="ImportDefaultSpecifier"==i.type?"default":i.imported.name;o.getProp(l).propagate(a)}}},ExportAllDeclaration:function(e){var o=n.resolveModule(e.source.value,r.name);o.forAllProps(function(e,r,o){o&&i(e,r,r.originNode)})},ExportDefaultDeclaration:function(o){var t=o.declaration.id||o.declaration;i("default",e.expressionType({node:t,state:r.scope}),t)},ExportNamedDeclaration:function(e){var o=e.declaration;if(o)if("VariableDeclaration"==o.type)for(var t=0;t<o.declarations.length;++t){var a=o.declarations[t];"Identifier"==a.id.type&&i(a.id.name,r.scope.getProp(a.id.name),a.id)}else i(o.id.name,r.scope.getProp(o.id.name),o.id);if(e.specifiers.length)for(var l=e.source?n.resolveModule(e.source.value,r.name):r.scope,t=0;t<e.specifiers.length;t++){var p=e.specifiers[t];i(p.exported.name,l.getProp(p.local.name),p.local)}}})}function i(r){if("Literal"!=r.type||"string"!=typeof r.value)return!1;var o=e.findExpressionAround(r.sourceFile.ast,null,r.end,null,function(e,r){return"ImportDeclaration"==r.type||/Export(All|Named)Declaration/.test(r.type)});return!(!o||o.node.source!=r)&&r.value}function n(r){if("Identifier"==r.type){var o=e.findExpressionAround(r.sourceFile.ast,null,r.end,null,"ImportDeclaration");if(o)for(var t=o.node.specifiers,i=0;i<t.length;i++){var n=t[i];if(n.local==r){var a={name:o.node.source.value,prop:null};return"ImportDefaultSpecifier"==n.type?a.prop="default":"ImportSpecifier"==n.type&&(a.prop=n.imported.name),a}}}}r.registerPlugin("es_modules",function(e){e.loadPlugin("modules"),e.mod.modules.on("getExports",t),e.mod.modules.modNameTests.push(i),e.mod.modules.importTests.push(n)})});
//# sourceMappingURL=es_modules.min.js.map