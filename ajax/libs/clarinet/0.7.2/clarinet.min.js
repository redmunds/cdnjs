!function(e){function t(t){for(var n=Math.max(e.MAX_BUFFER_LENGTH,10),r=0,i=0,s=b.length;i<s;i++){var o=t[b[i]].length;if(o>n)switch(b[i]){case"text":closeText(t);break;default:l(t,"Max buffer length exceeded: "+b[i])}r=Math.max(r,o)}t.bufferCheckPosition=e.MAX_BUFFER_LENGTH-r+t.position}function n(e){for(var t=0,n=b.length;t<n;t++)e[b[t]]=""}function r(t){if(!(this instanceof r))return new r(t);var i=this;n(i),i.bufferCheckPosition=e.MAX_BUFFER_LENGTH,i.q=i.c=i.p="",i.opt=t||{},i.closed=i.closedRoot=i.sawRoot=!1,i.tag=i.error=null,i.state=L.BEGIN,i.stack=new p,i.position=i.column=0,i.line=1,i.slashed=!1,i.unicodeI=0,i.unicodeS=null,o(i,"onready")}function i(e){return new s(e)}function s(e){if(!(this instanceof s))return new s(e);this._parser=new r(e),this.writable=!0,this.readable=!0,this.bytes_remaining=0,this.bytes_in_sequence=0,this.temp_buffs={2:new Buffer(2),3:new Buffer(3),4:new Buffer(4)},this.string="";var t=this;_.apply(t),this._parser.onend=function(){t.emit("end")},this._parser.onerror=function(e){t.emit("error",e),t._parser.error=null},N.forEach(function(e){Object.defineProperty(t,"on"+e,{get:function(){return t._parser["on"+e]},set:function(n){return n?void t.on(e,n):(t.removeAllListeners(e),t._parser["on"+e]=n,n)},enumerable:!0,configurable:!1})})}function o(t,n,r){e.INFO&&console.log("-- emit",n,r),t[n]&&t[n](r)}function a(e,t,n){c(e),o(e,t,n)}function c(e,t){e.textNode=f(e.opt,e.textNode),e.textNode&&o(e,t?t:"onvalue",e.textNode),e.textNode=""}function u(e){e.numberNode&&o(e,"onvalue",parseFloat(e.numberNode)),e.numberNode=""}function f(e,t){return e.trim&&(t=t.trim()),e.normalize&&(t=t.replace(/\s+/g," ")),t}function l(e,t){return c(e),t+="\nLine: "+e.line+"\nColumn: "+e.column+"\nChar: "+e.c,t=new Error(t),e.error=t,o(e,"onerror",t),e}function E(e){return e.state!==L.VALUE&&l(e,"Unexpected end"),c(e),e.c="",e.closed=!0,o(e,"onend"),r.call(e,e.opt),e}function d(n){var r=this;if(this.error)throw this.error;if(r.closed)return l(r,"Cannot write after close. Assign an onready handler.");if(null===n)return E(r);var i=0,s=n[0],f=r.p;for(e.DEBUG&&console.log("write -> ["+n+"]");s&&(f=s,r.c=s=n.charAt(i++),f!==s?r.p=f:f=r.p,s);)switch(e.DEBUG&&console.log(i,s,e.STATE[r.state]),r.position++,"\n"===s?(r.line++,r.column=0):r.column++,r.state){case L.BEGIN:"{"===s?r.state=L.OPEN_OBJECT:"["===s?r.state=L.OPEN_ARRAY:"\r"!==s&&"\n"!==s&&" "!==s&&"\t"!==s&&l(r,"Non-whitespace before {[.");continue;case L.OPEN_KEY:case L.OPEN_OBJECT:if("\r"===s||"\n"===s||" "===s||"\t"===s)continue;if(r.state===L.OPEN_KEY)r.stack.push(L.CLOSE_KEY);else{if("}"===s){o(r,"onopenobject"),o(r,"oncloseobject"),r.state=r.stack.pop()||L.VALUE;continue}r.stack.push(L.CLOSE_OBJECT)}'"'===s?r.state=L.STRING:l(r,'Malformed object key should start with "');continue;case L.CLOSE_KEY:case L.CLOSE_OBJECT:if("\r"===s||"\n"===s||" "===s||"\t"===s)continue;r.state===L.CLOSE_KEY?"key":"object";":"===s?(r.state===L.CLOSE_OBJECT?(r.stack.push(L.CLOSE_OBJECT),c(r,"onopenobject")):c(r,"onkey"),r.state=L.VALUE):"}"===s?(a(r,"oncloseobject"),r.state=r.stack.pop()||L.VALUE):","===s?(r.state===L.CLOSE_OBJECT&&r.stack.push(L.CLOSE_OBJECT),c(r),r.state=L.OPEN_KEY):l(r,"Bad object");continue;case L.OPEN_ARRAY:case L.VALUE:if("\r"===s||"\n"===s||" "===s||"\t"===s)continue;if(r.state===L.OPEN_ARRAY){if(o(r,"onopenarray"),r.state=L.VALUE,"]"===s){o(r,"onclosearray"),r.state=r.stack.pop()||L.VALUE;continue}r.stack.push(L.CLOSE_ARRAY)}'"'===s?r.state=L.STRING:"{"===s?r.state=L.OPEN_OBJECT:"["===s?r.state=L.OPEN_ARRAY:"t"===s?r.state=L.TRUE:"f"===s?r.state=L.FALSE:"n"===s?r.state=L.NULL:"-"===s?r.numberNode+=s:"0"===s?(r.numberNode+=s,r.state=L.NUMBER_DIGIT):"123456789".indexOf(s)!==-1?(r.numberNode+=s,r.state=L.NUMBER_DIGIT):l(r,"Bad value");continue;case L.CLOSE_ARRAY:if(","===s)r.stack.push(L.CLOSE_ARRAY),c(r,"onvalue"),r.state=L.VALUE;else if("]"===s)a(r,"onclosearray"),r.state=r.stack.pop()||L.VALUE;else{if("\r"===s||"\n"===s||" "===s||"\t"===s)continue;l(r,"Bad array")}continue;case L.STRING:var d=i-1,h=r.slashed,p=r.unicodeI;e:for(;;){for(e.DEBUG&&console.log(i,s,e.STATE[r.state],h);p>0;)if(r.unicodeS+=s,s=n.charAt(i++),4===p?(r.textNode+=String.fromCharCode(parseInt(r.unicodeS,16)),p=0,d=i-1):p++,!s)break e;if('"'===s&&!h){r.state=r.stack.pop()||L.VALUE,r.textNode+=n.substring(d,i-1),r.textNode||o(r,"onvalue","");break}if("\\"===s&&!h&&(h=!0,r.textNode+=n.substring(d,i-1),s=n.charAt(i++),!s))break;if(h){if(h=!1,"n"===s?r.textNode+="\n":"r"===s?r.textNode+="\r":"t"===s?r.textNode+="\t":"f"===s?r.textNode+="\f":"b"===s?r.textNode+="\b":"u"===s?(p=1,r.unicodeS=""):r.textNode+=s,s=n.charAt(i++),d=i-1,s)continue;break}y.lastIndex=i;var _=y.exec(n);if(null===_){i=n.length+1,r.textNode+=n.substring(d,i-1);break}if(i=_.index+1,s=n.charAt(_.index),!s){r.textNode+=n.substring(d,i-1);break}}r.slashed=h,r.unicodeI=p;continue;case L.TRUE:if(""===s)continue;"r"===s?r.state=L.TRUE2:l(r,"Invalid true started with t"+s);continue;case L.TRUE2:if(""===s)continue;"u"===s?r.state=L.TRUE3:l(r,"Invalid true started with tr"+s);continue;case L.TRUE3:if(""===s)continue;"e"===s?(o(r,"onvalue",!0),r.state=r.stack.pop()||L.VALUE):l(r,"Invalid true started with tru"+s);continue;case L.FALSE:if(""===s)continue;"a"===s?r.state=L.FALSE2:l(r,"Invalid false started with f"+s);continue;case L.FALSE2:if(""===s)continue;"l"===s?r.state=L.FALSE3:l(r,"Invalid false started with fa"+s);continue;case L.FALSE3:if(""===s)continue;"s"===s?r.state=L.FALSE4:l(r,"Invalid false started with fal"+s);continue;case L.FALSE4:if(""===s)continue;"e"===s?(o(r,"onvalue",!1),r.state=r.stack.pop()||L.VALUE):l(r,"Invalid false started with fals"+s);continue;case L.NULL:if(""===s)continue;"u"===s?r.state=L.NULL2:l(r,"Invalid null started with n"+s);continue;case L.NULL2:if(""===s)continue;"l"===s?r.state=L.NULL3:l(r,"Invalid null started with nu"+s);continue;case L.NULL3:if(""===s)continue;"l"===s?(o(r,"onvalue",null),r.state=r.stack.pop()||L.VALUE):l(r,"Invalid null started with nul"+s);continue;case L.NUMBER_DECIMAL_POINT:"."===s?(r.numberNode+=s,r.state=L.NUMBER_DIGIT):l(r,"Leading zero not followed by .");continue;case L.NUMBER_DIGIT:"0123456789".indexOf(s)!==-1?r.numberNode+=s:"."===s?(r.numberNode.indexOf(".")!==-1&&l(r,"Invalid number has two dots"),r.numberNode+=s):"e"===s||"E"===s?(r.numberNode.indexOf("e")===-1&&r.numberNode.indexOf("E")===-1||l(r,"Invalid number has two exponential"),r.numberNode+=s):"+"===s||"-"===s?("e"!==f&&"E"!==f&&l(r,"Invalid symbol in number"),r.numberNode+=s):(u(r),i--,r.state=r.stack.pop()||L.VALUE);continue;default:l(r,"Unknown state: "+r.state)}return r.position>=r.bufferCheckPosition&&t(r),r}var h,p;if(h="object"==typeof process&&process.env?process.env:window,"function"==typeof FastList)p=FastList;else if("function"==typeof require)try{p=require("fast-list")}catch(e){p=Array}else p=Array;e.parser=function(e){return new r(e)},e.CParser=r,e.CStream=s,e.createStream=i,e.MAX_BUFFER_LENGTH=65536,e.DEBUG="debug"===h.CDEBUG,e.INFO="debug"===h.CDEBUG||"info"===h.CDEBUG,e.EVENTS=["value","string","key","openobject","closeobject","openarray","closearray","error","end","ready"];var _,b=["textNode","numberNode"],N=e.EVENTS.filter(function(e){return"error"!==e&&"end"!==e}),L=0;e.STATE={BEGIN:L++,VALUE:L++,OPEN_OBJECT:L++,CLOSE_OBJECT:L++,OPEN_ARRAY:L++,CLOSE_ARRAY:L++,TEXT_ESCAPE:L++,STRING:L++,BACKSLASH:L++,END:L++,OPEN_KEY:L++,CLOSE_KEY:L++,TRUE:L++,TRUE2:L++,TRUE3:L++,FALSE:L++,FALSE2:L++,FALSE3:L++,FALSE4:L++,NULL:L++,NULL2:L++,NULL3:L++,NUMBER_DECIMAL_POINT:L++,NUMBER_DIGIT:L++};for(var A in e.STATE)e.STATE[e.STATE[A]]=A;L=e.STATE,Object.create||(Object.create=function(e){function t(){this.__proto__=e}return t.prototype=e,new t}),Object.getPrototypeOf||(Object.getPrototypeOf=function(e){return e.__proto__}),Object.keys||(Object.keys=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t});var y=/[\\"\n]/g;r.prototype={end:function(){E(this)},write:d,resume:function(){return this.error=null,this},close:function(){return this.write(null)}};try{_=require("stream").Stream}catch(e){_=function(){}}s.prototype=Object.create(_.prototype,{constructor:{value:s}}),s.prototype.write=function(e){for(var e=new Buffer(e),t=0;t<e.length;t++){var n=e[t];if(this.bytes_remaining>0){for(var r=0;r<this.bytes_remaining;r++)this.temp_buffs[this.bytes_in_sequence][this.bytes_in_sequence-this.bytes_remaining+r]=e[r];return this.string=this.temp_buffs[this.bytes_in_sequence].toString(),this.bytes_in_sequence=this.bytes_remaining=0,t=t+r-1,this._parser.write(this.string),this.emit("data",this.string),!0}if(!(0===this.bytes_remaining&&n>=128))return this._parser.write(e.toString()),this.emit("data",e),!0;if(n>=194&&n<=223&&(this.bytes_in_sequence=2),n>=224&&n<=239&&(this.bytes_in_sequence=3),n>=240&&n<=244&&(this.bytes_in_sequence=4),!(this.bytes_in_sequence+t>e.length))return this.string=e.slice(t,t+this.bytes_in_sequence).toString(),t=t+this.bytes_in_sequence-1,this._parser.write(this.string),this.emit("data",this.string),!0;for(var i=0;i<=e.length-1-t;i++)this.temp_buffs[this.bytes_in_sequence][i]=e[t+i];this.bytes_remaining=t+this.bytes_in_sequence-e.length,t=e.length-1}},s.prototype.end=function(e){return e&&e.length&&this._parser.write(e.toString()),this._parser.end(),!0},s.prototype.on=function(e,t){var n=this;return n._parser["on"+e]||N.indexOf(e)===-1||(n._parser["on"+e]=function(){var t=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);t.splice(0,0,e),n.emit.apply(n,t)}),_.prototype.on.call(n,e,t)},s.prototype.destroy=function(){n(this._parser),this.emit("close")}}("undefined"==typeof exports?clarinet={}:exports);
//# sourceMappingURL=clarinet.min.js.map