/**
 * jQuery.scrollfire()
 *
 * (a) Wil Neeley, Trestle Media, LLC.
 * Code may be freely distributed under the MIT license.
 */
((function(d,f,h,b){var i="scrollfire",g=null,c={onScrollDown:function(){},onScrollUp:function(){},onScroll:function(){},onTopIn:function(){},onTopOut:function(){},onBottomIn:function(){},onBottomOut:function(){},offset:0,topInOffset:0,topOutOffset:0,bottomInOffset:0,bottomOutOffset:0},e={registry:{},guid:0,last_scroll_pos:0,scroll_handler:null};function j(l,k){this.element=l;this.options=d.extend({},c,k);this._defaults=c;this._name=i;this.init()}j.prototype.init=function(){var m=this;var k={_guid:e.guid,_element:m.element,_on_scroll_down:m.options.onScrollDown,_on_scroll_up:m.options.onScrollUp,_on_scroll:m.options.onScroll,_on_top_in:m.options.onTopIn,_on_top_in_once:true,_on_top_out:m.options.onTopOut,_on_top_out_once:true,_on_bottom_in:m.options.onBottomIn,_on_bottom_in_once:true,_on_bottom_out:m.options.onBottomOut,_on_bottom_out_once:true,_offset:m.options.offset,_top_in_offset:m.options.topInOffset,_top_out_offset:m.options.topOutOffset,_bottom_in_offset:m.options.bottomInOffset,_bottom_out_offset:m.options.bottomOutOffset};var n=function(q){var o=d(f).scrollTop();var p="";var r=Math.abs(e.last_scroll_pos-o);if(o>e.last_scroll_pos){p="down";d.each(e.registry,function(w,z){var y=d(z._element).offset().top;var v=o>=(y+(z._top_out_offset?z._top_out_offset:z._offset));var x=(o+d(f).outerHeight())>=(y+(z._bottom_in_offset?z._bottom_in_offset:z._offset));var s=(o<=(y+d(z._element).outerHeight()));var t=(o+d(f).outerHeight())>y;z._on_scroll(z._element,r,p);if(s&&t){var B=d(f).outerHeight();var u=(y+d(z._element).outerHeight())-o;var A=(u/B);A=(A>1)?1:A.toFixed(2);z._on_scroll_down(z._element,r,A)}if(v&&z._on_top_out_once){z._on_top_in_once=true;z._on_top_out_once=false;z._on_top_out(z._element,r)}if(x&&z._on_bottom_in_once){z._on_bottom_out_once=true;z._on_bottom_in_once=false;z._on_bottom_in(z._element,r)}})}else{p="up";d.each(e.registry,function(w,y){var x=d(y._element).offset().top+d(y._element).outerHeight();var v=o<=(x+(y._top_in_offset?y._top_in_offset:y._offset));var z=(o+d(f).outerHeight())<=(x+(y._bottom_out_offset?y._bottom_out_offset:y._offset));var s=o<x;var t=((o+d(f).outerHeight())+d(y._element).outerHeight())>x;y._on_scroll(y._element,r,p);if(s&&t){var B=d(f).outerHeight();var u=(x)-o;var A=(u/B);A=(A>1)?1:A.toFixed(2);y._on_scroll_up(y._element,r,A)}if(v&&y._on_top_in_once){y._on_top_out_once=true;y._on_top_in_once=false;y._on_top_in(y._element,r)}if(z&&y._on_bottom_out_once){y._on_bottom_in_once=true;y._on_bottom_out_once=false;y._on_bottom_out(y._element,r)}})}e.last_scroll_pos=o};k._scroll_handler=n;e.registry[e.guid]=k;if(!d.data(m.element,"uids")){d.data(m.element,"uids",[e.guid])}else{var l=d.data(m.element,"uids");l.push(e.guid);d.data(m.element,"uids",l)}e.guid++;if(!e.scroll_handler){e.scroll_handler=n;d(f).bind("scroll",n)}};var a={remove:function(k){k.each(function(l,n){var m=d(n).data("uids");if(m){delete e.registry[m]}});return g}};d.fn[i]=function(l){g=this;if(typeof l=="string"){var m=l;var k=d(arguments).toArray();k.shift();k.unshift(this);return a[m].apply(this,k)}else{return this.each(function(){d.data(this,"plugin_"+i,new j(this,l))})}}})(jQuery,window,document);