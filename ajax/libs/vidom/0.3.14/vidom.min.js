/**
 * Vidom
 * @author Filatov Dmitry <dfilatov@inbox.ru>
 * @version 0.3.14
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.vidom=t.vidom||{})}(this,function(t){"use strict";function e(t,e,n){if("type"===e&&"INPUT"===t.tagName){var o=t.value;t.setAttribute(e,""+n),t.value=o}else t.setAttribute(Jt[e]||e,""+n)}function n(t,n,o){o?e(t,n,o):s(t,n)}function o(t,e,n){t[e]=n}function r(t,e,n){var o=t[e];for(var r in n)o[r]=null==n[r]?"":n[r]}function i(t,e,n){"value"===e&&"SELECT"===t.tagName?u(t,n):t[e]!==n&&(t[e]=n)}function s(t,e){t.removeAttribute(Jt[e]||e)}function a(t,e){"style"===e?t[e].cssText="":"value"===e&&"SELECT"===t.tagName?c(t):t[e]=f(t.tagName,e)}function u(t,e){for(var n=Array.isArray(e),o=t.options,r=o.length,i=0,s=void 0;i<r;)s=o[i++],s.selected=null!=e&&(n?Bt(e,s.value):s.value==e)}function c(t){for(var e=t.options,n=e.length,o=0;o<n;)e[o++].selected=!1}function h(t,e){return(Jt[t]||t)+'="'+qt(e)+'"'}function d(t,e){return e?t:""}function l(t,e){var n="";for(var o in e)null!=e[o]&&(n+=Ht(o)+":"+e[o]+";");return n?t+'="'+n+'"':n}function f(t,e){var n=$t[t]||($t[t]={});return e in n?n[e]:n[e]=document.createElement(t)[e]}function p(t){return ee[t]||Qt}function v(t,e){if(Array.isArray(t))g(e,t[1]);else if(Array.isArray(e)){for(var n=e[0],o=void 0,r=e[1];n!==r;)o=n.nextSibling,t.appendChild(n),n=o;t.appendChild(r)}else t.appendChild(e)}function m(t){if(Array.isArray(t)){for(var e=t[0],n=void 0,o=t[1],r=o.parentNode;e!==o;)n=e.nextSibling,r.removeChild(e),e=n;r.removeChild(o)}else t.parentNode.removeChild(t)}function g(t,e){if(Array.isArray(e)&&(e=e[0]),Array.isArray(t)){for(var n=t[0],o=void 0,r=t[1],i=r.parentNode;n!==r;)o=n.nextSibling,i.insertBefore(n,e),n=o;i.insertBefore(r,e)}else e.parentNode.insertBefore(t,e)}function _(t,e,n){if(n){Array.isArray(e)&&(e=e[1]);var o=e.nextSibling;o?g(t,o):v(e.parentNode,t)}else g(t,e)}function y(t,e){Array.isArray(t)?(g(e,t),m(t)):t.parentNode.replaceChild(e,t)}function N(t){if(Array.isArray(t))for(var e=t[0].nextSibling,n=void 0,o=t[1],r=o.parentNode;e!==o;)n=e.nextSibling,r.removeChild(e),e=n;else t.textContent=""}function C(t){return Array.isArray(t)?D(t):t.namespaceURI===oe?null:t.namespaceURI}function D(t){return C((Array.isArray(t)?t[t.length-1]:t).parentNode)}function A(t){var e="on"+t;if(e in document)return!0;var n=document.createElement("div");return n.setAttribute(e,"return;"),"function"==typeof n[e]||"wheel"===t&&document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0&&document.implementation.hasFeature("Events.wheel","3.0")}function b(t,e){this.type=t,this.target=e.target,this.nativeEvent=e,this._isPropagationStopped=!1,this._isDefaultPrevented=!1,this._isSeized=!1}function x(t,e){var n=re[t];return n&&!n._isPersisted?(n.target=e.target,n.nativeEvent=e,n._isPropagationStopped=!1,n._isDefaultPrevented=!1,n):re[t]=new b(t,e)}function k(t,e){return t[ie]||(e?null:t[ie]=se++)}function S(t,e){e||(e=t.type);for(var n=le[e],o=t.target,r=n.listenersCounter,i=void 0,s=void 0,a=void 0,u=void 0;r>0&&o&&o!==document;)(u=k(o,!0))&&(i=de.get(u),i&&(s=i[e])&&(a?a.push(s):a=[s],--r)),o=o.parentNode;if(a)for(var c=x(e,t),h=a.length,d=0;d<h&&(a[d++](c),!c.isPropagationStopped()););}function w(t){de.get(k(t.target))[t.type](x(t.type,t))}function T(t,e,n){var o=le[e];if(o){o.set||(o.setup?o.setup():o.bubbles&&document.addEventListener(e,S,!1),o.set=!0);var r=k(t),i=de.get(r);i||de.set(r,i={}),i[e]||(o.bubbles?++o.listenersCounter:t.addEventListener(e,w,!1)),i[e]=n}}function R(t,e){var n=k(t,!0);if(n){var o=de.get(n);if(o&&o[e]){o[e]=null;var r=le[e];r&&(r.bubbles?--r.listenersCounter:t.removeEventListener(e,w))}}}function E(t){var e=k(t,!0);if(e){var n=de.get(e);if(n){de.delete(e);for(var o in n)R(t,o)}}}function M(t,e){var n=t.getDomNode();ne.append(n,e.renderToDom(C(n))),e.mount()}function I(t,e){var n=e.getDomNode();ne.insertBefore(t.renderToDom(D(n)),n),t.mount()}function P(t){var e=t.getDomNode();t.unmount(),ne.remove(e)}function L(t,e,n){var o=document.activeElement;ne.move(t.getDomNode(),e.getDomNode(),n),document.activeElement!==o&&o.focus()}function U(t){for(var e=t.getDomNode(),n=t._children,o=n.length,r=0;r<o;)n[r++].unmount();ne.removeChildren(e)}function O(t,e){var n=t.getDomNode();t.unmount(),ne.replace(n,e.renderToDom(D(n))),e.mount()}function j(t,e,n){var o=t.getDomNode();fe[e]?T(o,fe[e],n):p(e).set(o,e,n)}function F(t,e){var n=t.getDomNode();fe[e]?R(n,fe[e]):p(e).remove(n,e)}function q(t,e,n){var o=t.getDomNode();if(n){var r=o.firstChild;r?r.nodeValue=e:o.textContent=e}else o.innerHTML=e}function B(t){t.getDomNode().textContent=""}function z(t,e){var n=t._children,o=e._children,r=n.length,i=o.length;if(1===r&&1===i)return void n[0].patch(o[0]);for(var s=0,a=r-1,u=n[s],c=u._key,h=n[a],d=h._key,l=0,f=i-1,p=o[l],v=p._key,m=o[f],g=m._key,_=!1,y=!1,N=!1,C=!1,D={},A=void 0,b=void 0,x=void 0;s<=a&&l<=f;)D[s]?_=!0:D[a]?y=!0:c===v?(u.patch(p),_=!0,N=!0):d===g?(h.patch(m),y=!0,C=!0):null!=c&&c===g?(pe.moveChild(u,h,!0),u.patch(m),_=!0,C=!0):null!=d&&d===v?(pe.moveChild(h,u,!1),h.patch(p),y=!0,N=!0):null!=c&&null==v?(pe.insertChild(p,u),N=!0):null==c&&null!=v?(pe.removeChild(u),_=!0):(A||(A=H(n,s,a)),null==(b=A[v])?pe.insertChild(p,u):(x=n[b],D[b]=!0,pe.moveChild(x,u,!1),x.patch(p)),N=!0),_&&(_=!1,++s<=a&&(u=n[s],c=u._key)),y&&(y=!1,--a>=s&&(h=n[a],d=h._key)),N&&(N=!1,++l<=f&&(p=o[l],v=p._key)),C&&(C=!1,--f>=l&&(m=o[f],g=m._key));for(;s<=a;)D[s]||pe.removeChild(n[s]),++s;for(;l<=f;)f<i-1?pe.insertChild(o[l],o[f+1]):pe.appendChild(e,o[l]),++l}function H(t,e,n){for(var o={},r=void 0;e<n;)r=t[e],null!=r._key&&(o[r._key]=e),++e;return o}function V(t,e){var n=void 0;if(e){var o=e+":"+t;n=Ne[o]||(Ne[o]=document.createElementNS(e,t))}else n=Ne[t]||(Ne[t]="!"===t?document.createComment(""):document.createElement(t));return n.cloneNode()}function K(t,e,n){if(De||(De=document.createElement("div")),!n||!Ce[n]||Ce[n]===e)return De.innerHTML=t,De.removeChild(De.firstChild);var o=Ce[n];return De.innerHTML="<"+o+' xmlns="'+n+'">'+t+"</"+o+">",De.removeChild(De.firstChild).firstChild}function W(t){this.type=be,this._tag=t,this._domNode=null,this._key=null,this._ns=null,this._attrs=null,this._children=null,this._escapeChildren=!0,this._ctx=me}function G(t){if(null==t)return null;var e=typeof t;if("object"===e){var n=Array.isArray(t)?t:[t];return n}return"string"===e?t:t.toString()}function Z(t){this.type=ke,this._component=t,this._key=null,this._attrs=null,this._instance=null,this._children=null,this._ctx=me}function $(t){this.type=Se,this._component=t,this._key=null,this._attrs=me,this._rootNode=null,this._children=null,this._ctx=me}function J(){this.type=xe,this._domNode=null,this._key=null,this._children=null,this._ctx=me}function Q(t){if(null==t)return null;var e=Array.isArray(t)?t:[t];return e}function X(){for(var t=0;t<Ee.length;)Ee[t++]();Ee=[]}function Y(){this._listeners={}}function tt(t,e){this.type=Ae,this._childNode=t,this._ns=e}function et(t,e,n,o,r){var i=k(t),s=Ie.get(i),a=void 0;if(s&&s.tree){a=++s.id;var u=function(){if(s=Ie.get(i),s&&s.id===a){var t=s.tree,r=new tt(e,t._ns);t.patch(r),s.tree=r,ot(n,o)}};r?u():Me(u)}else if(Ie.set(i,s={tree:null,id:a=++Pe}),t.children.length){var c=s.tree=new tt(e,C(t));c.adoptDom(rt(t)),c.mount(),ot(n,o)}else{var h=function(){var r=Ie.get(i);if(r&&r.id===a){var s=r.tree=new tt(e,C(t));ne.append(t,s.renderToDom()),s.mount(),ot(n,o)}};r?h():Me(h)}}function nt(t,e,n,o){var r=k(t),i=Ie.get(r);i?!function(){var t=++i.id,s=function(){if(i=Ie.get(r),i&&i.id===t){Ie.delete(r);var o=i.tree;if(o){var s=o.getDomNode();o.unmount(),ne.remove(s)}ot(e,n)}};i.tree?o?s():Me(s):o||ot(e,n)}():o||ot(e,n)}function ot(t,e){t&&t.call(e||this)}function rt(t){for(var e=t.childNodes,n=e.length,o=[],r=0,i=void 0;r<n;)i=e[r].nodeType,i!==Node.ELEMENT_NODE&&i!==Node.COMMENT_NODE||o.push(e[r]),r++;return o}function it(t,e,n,o){et(t,e,n,o,!1)}function st(t,e){et(t,e,null,null,!0)}function at(t,e,n){nt(t,e,n,!1)}function ut(t){nt(t,null,null,!0)}function ct(){var t=[];return Ie.forEach(function(e){var n=e.tree;n&&t.push(n)}),t}function ht(){this._isMounted=!0,this.onMount(this._attrs)}function dt(){this._isMounted=!1,this._domRefs=null,this.onUnmount()}function lt(t,e,n){t=this._buildAttrs(t);var o=this._rootNode,r=this._attrs,i=this._children;if((r!==t||i!==e)&&(this._attrs=t,this.isMounted())){var s=this._isUpdating;this._isUpdating=!0,this.onAttrsReceive(t,r,e,i),this._isUpdating=s}if(this._children=e,this._ctx=n,!this._isUpdating){var a=this.shouldUpdate(t,r,e,i);a&&(this._rootNode=this.render(),o.patch(this._rootNode),this.isMounted()&&this.onUpdate(t,r,e,i))}}function ft(){return!0}function pt(t){return this._rootNode.renderToDom(t)}function vt(){return this._rootNode.renderToString()}function mt(t,e){return this._rootNode.adoptDom(t,e)}function gt(){return this._rootNode.getDomNode()}function _t(){return this._attrs}function yt(){return me}function Nt(){return me}function Ct(t){this._prevState=this._state,this._state=Ue({},this._state,t),this.update(Dt)}function Dt(){this._prevState=this._state}function At(){return this._state}function bt(){return this._prevState}function xt(){this._domRefs={};var t=this.onRender(this._attrs,this._children)||Lt("!"),e=this.onChildContextRequest(this._attrs);return t.ctx(e===me?this._ctx:this._ctx===me?e:Ue({},this._ctx,e)),t}function kt(t,e){var n=this;this._isUpdating?t&&Me(function(){return t.call(e||n)}):(this._isUpdating=!0,Me(function(){if(n.isMounted()){n._isUpdating=!1;n._rootNode;n.patch(n._attrs,n._children,n._ctx),t&&t.call(e||n)}}))}function St(){return this._rootNode}function wt(){return this._isMounted}function Tt(t,e){return this._domRefs[t]=e}function Rt(t){return this._domRefs[t]?this._domRefs[t].getDomNode():null}function Et(){return this._ctx}function Mt(){return me}function It(t){if(this._attrs&&t===this._attrs)return t;var e=this.constructor,n=e._defaultAttrs||(e._defaultAttrs=e.getDefaultAttrs());if(!t)return n;if(n===me)return t;var o={};for(var r in n)o[r]=n[r];for(var i in t)o[i]=t[i];return o}function Pt(t,e){var n=function(t,e,n){this._attrs=this._buildAttrs(t),this._children=e,this._ctx=n,this._domRefs=null,this._isMounted=!1,this._isUpdating=!1,this._state=this.onInitialStateRequest(this._attrs,e),this._prevState=this._state,this.onInit(this._attrs,e),this._rootNode=this.render()},o={constructor:n,onInitialStateRequest:Nt,onInit:Vt,mount:ht,unmount:dt,onMount:Vt,onUnmount:Vt,onAttrsReceive:Vt,shouldUpdate:ft,onUpdate:Vt,isMounted:wt,getState:At,getPrevState:bt,setState:Ct,renderToDom:pt,renderToString:vt,adoptDom:mt,getDomNode:gt,getRootNode:St,render:xt,onRender:Vt,update:kt,patch:lt,getDomRef:Rt,setDomRef:Tt,getAttrs:_t,onChildContextRequest:yt,getContext:Et,_buildAttrs:It};for(var r in t)o[r]=t[r];n.prototype=o,n.getDefaultAttrs=Mt;for(var i in e)n[i]=e[i];return n.__vidom__component__=!0,n}function Lt(t){switch(typeof t){case"string":return"fragment"===t?new J:qe[t]?new Z(qe[t]):new W(t);case"function":return t.__vidom__component__?new Z(t):new $(t)}}function Ut(t){if(null==t)return null;var e=typeof t;if("object"!==e)return"string"===e?t||null:""+t;if(!Array.isArray(t))return t;if(!t.length)return null;for(var n=t,o=0,r=t.length,i=!0,s=void 0,a=void 0;o<r;){if(s=Ut(t[o]),null===s)null!==n&&(i?n=null:n===t&&(n=t.slice(0,o)));else{if(null===n)n=s;else if(Array.isArray(s))n=i?s:(n===t?n.slice(0,o):Array.isArray(n)?n:[n]).concat(s);else if(a="object"==typeof s,a&&t[o]===s)n!==t&&(n=jt(n,s));else{if(n===t){if(i&&a){n=s,i=!1,++o;continue}n=n.slice(0,o)}n=jt(n,s)}i=!1}++o}return n}function Ot(t){return"object"==typeof t?t:Lt("span").children(t)}function jt(t,e){return Array.isArray(t)?(t.push(Ot(e)),t):[Ot(t),Ot(e)]}function Ft(t){var e=Ut(t);return null===e||"object"!=typeof e||Array.isArray(e)||(e=[e]),e}var qt=function(t){return(t+"").replace(/&/g,"&amp;").replace(/"/g,"&quot;")},Bt=function(t,e){for(var n=t.length,o=0;o<n;)if(t[o++]==e)return!0;return!1},zt=/([^A-Z]+)([A-Z])/g,Ht=function(t){return t.replace(zt,"$1-$2").toLowerCase()},Vt=function(){},Kt="undefined"==typeof console?null:console,Wt={},Gt={log:"",info:"",warn:"Warning!",error:"Error!"};["log","info","warn","error"].forEach(function(t){Wt[t]=Kt?Kt[t]?function(e,n,o,r,i){var s=Gt[t];switch(arguments.length){case 1:Kt[t](s,e);break;case 2:Kt[t](s,e,n);break;case 3:Kt[t](s,e,n,o);break;case 4:Kt[t](s,e,n,o,r);break;case 5:Kt[t](s,e,n,o,r,i)}}:function(){Kt.log.apply(Kt,arguments)}:Vt});var Zt="undefined"==typeof process||"production"!==process.env.NODE_ENV,$t={},Jt={acceptCharset:"accept-charset",className:"class",htmlFor:"for",httpEquiv:"http-equiv",autoCapitalize:"autocapitalize",autoComplete:"autocomplete",autoCorrect:"autocorrect",autoFocus:"autofocus",autoPlay:"autoplay",encType:"encoding",hrefLang:"hreflang",radioGroup:"radiogroup",spellCheck:"spellcheck",srcDoc:"srcdoc",srcSet:"srcset",tabIndex:"tabindex"},Qt={set:e,remove:s,toString:h},Xt={set:n,remove:s,toString:d},Yt={set:o,remove:a,toString:h},te={set:o,remove:a,toString:d},ee={checked:te,controls:Yt,disabled:Xt,id:Yt,ismap:Xt,loop:Yt,multiple:te,muted:Yt,open:Xt,readOnly:te,selected:te,srcDoc:Yt,style:{set:r,remove:a,toString:l},value:{set:i,remove:a,toString:h}},ne={append:v,remove:m,insertBefore:g,move:_,replace:y,removeChildren:N},oe="http://www.w3.org/1999/xhtml";b.prototype={stopPropagation:function(){this._isPropagationStopped=!0;var t=this.nativeEvent;t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},isPropagationStopped:function(){return this._isPropagationStopped},preventDefault:function(){this._isDefaultPrevented=!0;var t=this.nativeEvent;t.preventDefault?t.preventDefault():t.returnValue=!1},isDefaultPrevented:function(){return this._isDefaultPrevented},persist:function(){this._isPersisted=!0}};var re={},ie="__vidom__id__",se=1,ae=void 0;"undefined"==typeof Map?(ae=function(){this._storage={}},ae.prototype={has:function(t){return t in this._storage},get:function(t){return this._storage[t]},set:function(t,e){return this._storage[t]=e,this},delete:function(t){return delete this._storage[t]},forEach:function(t,e){var n=this._storage;for(var o in n)t.call(e,n[o],o,this)}}):ae=Map;var ue=ae,ce=["blur","change","click","contextmenu","copy","cut","dblclick","drag","dragend","dragenter","dragleave","dragover","dragstart","drop","focus","input","keydown","keypress","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","paste","submit","touchcancel","touchend","touchmove","touchstart","wheel"],he=["canplay","canplaythrough","complete","durationchange","emptied","ended","error","load","loadeddata","loadedmetadata","loadstart","mouseenter","mouseleave","pause","play","playing","progress","ratechange","scroll","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting"],de=new ue,le={};"undefined"!=typeof document&&!function(){for(var t={focus:"focusin",blur:"focusout"},e=0,n=void 0;e<ce.length;)n=ce[e++],le[n]={type:n,bubbles:!0,listenersCounter:0,set:!1,setup:t[n]?A(t[n])?function(){var e=this.type;document.addEventListener(t[e],function(t){S(t,e)})}:function(){document.addEventListener(this.type,S,!0)}:null};for(e=0;e<he.length;)le[he[e++]]={type:n,bubbles:!1,set:!1}}();var fe={onBlur:"blur",onCanPlay:"canplay",onCanPlayThrough:"canplaythrough",onChange:"change",onClick:"click",onComplete:"complete",onContextMenu:"contextmenu",onCopy:"copy",onCut:"cut",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragEnter:"dragenter",onDragLeave:"dragleave",onDragOver:"dragover",onDragStart:"dragstart",onDrop:"drop",onDurationChange:"durationchange",onEmptied:"emptied",onEnded:"ended",onError:"error",onFocus:"focus",onInput:"input",onKeyDown:"keydown",onKeyPress:"keypress",onKeyUp:"keyup",onLoad:"load",onLoadedData:"loadeddata",onLoadedMetadata:"loadedmetadata",onLoadStart:"loadstart",onMouseDown:"mousedown",onMouseEnter:"mouseenter",onMouseLeave:"mouseleave",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onPaste:"paste",onPause:"pause",onPlay:"play",onPlaying:"playing",onProgress:"progress",onRateChange:"ratechange",onScroll:"scroll",onSeeked:"seeked",onSeeking:"seeking",onStalled:"stalled",onSubmit:"submit",onSuspend:"suspend",onTimeUpdate:"timeupdate",onTouchCancel:"touchcancel",onTouchEnd:"touchend",onTouchMove:"touchmove",onTouchStart:"touchstart",onVolumeChange:"volumechange",onWaiting:"waiting",onWheel:"wheel"},pe={appendChild:M,insertChild:I,removeChild:P,moveChild:L,removeChildren:U,replace:O,updateAttr:j,removeAttr:F,updateText:q,removeText:B},ve=function(t){return(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},me={},ge="undefined"==typeof navigator?"":navigator.userAgent,_e=ge.indexOf("Trident")>-1,ye=ge.indexOf("Edge")>-1,Ne={},Ce={"http://www.w3.org/2000/svg":"svg","http://www.w3.org/1998/Math/MathML":"math"},De=void 0,Ae=1,be=2,xe=3,ke=4,Se=5,we={area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,menuitem:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},Te=_e||ye;W.prototype={getDomNode:function(){return this._domNode},key:function(t){return this._key=t,this},ns:function(t){return this._ns=t,this},attrs:function(t){return this._attrs=t,this},children:function(t){return this._children=G(t),this},ctx:function(t){if(t!==me){this._ctx=t;var e=this._children;if(e&&"string"!=typeof e)for(var n=e.length,o=0;o<n;)e[o++].ctx(t)}return this},html:function(t){return this._children=t,this._escapeChildren=!1,this},renderToDom:function(t){var e=this._ns||t,n=this._children;if(Te&&n&&"string"!=typeof n){var o=K(this.renderToString(),this._tag,e);return this.adoptDom([o],0),o}var r=this._domNode=V(this._tag,e),i=this._attrs;if(n)if("string"==typeof n)this._escapeChildren?r.textContent=n:r.innerHTML=n;else for(var s=0,a=n.length;s<a;)r.appendChild(n[s++].renderToDom(e));if(i){var u=void 0,c=void 0;for(u in i)null!=(c=i[u])&&(fe[u]?T(r,fe[u],c):p(u).set(r,u,c))}return r},renderToString:function(){var t=this._tag;if("!"===t)return"<!---->";var e=this._ns,n=this._attrs,o=this._children,r="<"+t;if(e&&(r+=' xmlns="'+e+'"'),n){var i=void 0,s=void 0,a=void 0;for(i in n)if(s=n[i],null!=s){if("value"===i)switch(t){case"textarea":o=s;continue;case"select":this.ctx({value:s,multiple:n.multiple});continue;case"option":(this._ctx.multiple?Bt(this._ctx.value,s):this._ctx.value===s)&&(r+=" "+p("selected").toString("selected",!0))}!fe[i]&&(a=p(i).toString(i,s))&&(r+=" "+a)}}if(we[t])r+="/>";else{if(r+=">",o)if("string"==typeof o)r+=this._escapeChildren?ve(o):o;else for(var u=0,c=o.length;u<c;)r+=o[u++].renderToString();r+="</"+t+">"}return r},adoptDom:function(t,e){var n=this._domNode=t[e],o=this._attrs,r=this._children;if(o){var i=void 0,s=void 0;for(i in o)null!=(s=o[i])&&fe[i]&&T(n,fe[i],s)}if(r&&"string"!=typeof r){var a=0,u=r.length;if(u)for(var c=n.childNodes,h=0;a<u;)h=r[a++].adoptDom(c,h)}return e+1},mount:function(){var t=this._children;if(t&&"string"!=typeof t)for(var e=0,n=t.length;e<n;)t[e++].mount()},unmount:function(){var t=this._children;if(t&&"string"!=typeof t)for(var e=0,n=t.length;e<n;)t[e++].unmount();E(this._domNode),this._domNode=null},patch:function(t){if(this!==t)switch(t.type){case be:this._tag!==t._tag||this._ns!==t._ns?pe.replace(this,t):(t._domNode=this._domNode,this._patchChildren(t),this._patchAttrs(t));break;case ke:var e=t._getInstance();this.patch(e.getRootNode()),e.mount();break;case Se:this.patch(t._getRootNode());break;default:pe.replace(this,t)}},_patchChildren:function(t){var e=this._children,n=t._children;if(e!==n){var o="string"==typeof e,r="string"==typeof n;if(r)return o?void pe.updateText(this,n,t._escapeChildren):(e&&e.length&&pe.removeChildren(this),void(n&&pe.updateText(this,n,t._escapeChildren)));if(!n||!n.length)return void(e&&(o?pe.removeText(this):e.length&&pe.removeChildren(this)));if(o&&e&&pe.removeText(this),!o&&e&&e.length)z(this,t);else for(var i=n.length,s=0;s<i;)pe.appendChild(t,n[s++])}},_patchAttrs:function(t){var e=this._attrs,n=t._attrs;if(e!==n){var o=void 0,r=void 0,i=void 0,s=void 0,a=void 0;if(n)for(o in n)i=n[o],e&&null!=(r=e[o])?null==i?pe.removeAttr(this,o):"object"==typeof i&&"object"==typeof r?(a=Array.isArray(i),s=Array.isArray(r),a||s?a&&s?this._patchAttrArr(o,r,i):pe.updateAttr(this,o,i):this._patchAttrObj(o,r,i)):r!==i&&pe.updateAttr(this,o,i):null!=i&&pe.updateAttr(this,o,i);if(e)for(o in e)n&&o in n||null==(r=e[o])||pe.removeAttr(this,o)}},_patchAttrArr:function(t,e,n){if(e!==n){var o=e.length,r=!1;if(o===n.length)for(var i=0;!r&&i<o;)e[i]!=n[i]&&(r=!0),++i;else r=!0;r&&pe.updateAttr(this,t,n)}},_patchAttrObj:function(t,e,n){if(e!==n){var o=!1,r={};for(var i in n)e[i]!=n[i]&&(o=!0,r[i]=n[i]);for(var s in e)null==e[s]||s in n||(o=!0,r[s]=null);o&&pe.updateAttr(this,t,r)}}},Z.prototype={getDomNode:function(){return this._instance&&this._instance.getDomNode()},key:function(t){return this._key=t,this},attrs:function(t){return this._attrs=t,this},children:function(t){return this._children=t,this},ctx:function(t){return this._ctx=t,this},renderToDom:function(t){return this._getInstance().renderToDom(t)},renderToString:function(){return this._getInstance().renderToString()},adoptDom:function(t,e){return this._getInstance().adoptDom(t,e)},mount:function(){this._instance.getRootNode().mount(),this._instance.mount()},unmount:function(){this._instance&&(this._instance.getRootNode().unmount(),this._instance.unmount(),this._instance=null)},patch:function(t){if(this!==t){var e=this._getInstance();if(this.type===t.type)if(this._component===t._component)e.patch(t._attrs,t._children,t._ctx),t._instance=e;else{e.unmount();var n=t._getInstance();e.getRootNode().patch(n.getRootNode()),n.mount()}else e.unmount(),e.getRootNode().patch(t)}},_getInstance:function(){return this._instance||(this._instance=new this._component(this._attrs,this._children,this._ctx))}},$.prototype={getDomNode:function(){return this._rootNode&&this._rootNode.getDomNode()},key:function(t){return this._key=t,this},attrs:function(t){return this._attrs=t,this},children:function(t){return this._children=t,this},ctx:function(t){return this._ctx=t,this},renderToDom:function(t){return this._getRootNode().renderToDom(t)},renderToString:function(){return this._getRootNode().renderToString()},adoptDom:function(t,e){return this._getRootNode().adoptDom(t,e)},mount:function(){this._getRootNode().mount()},unmount:function(){this._rootNode&&(this._rootNode.unmount(),this._rootNode=null)},patch:function(t){this!==t&&this._getRootNode().patch(this.type===t.type?t._getRootNode():t)},_getRootNode:function(){if(this._rootNode)return this._rootNode;var t=this._component(this._attrs,this._children,this._ctx)||Lt("!");return t.ctx(this._ctx),this._rootNode=t}},J.prototype={getDomNode:function(){return this._domNode},key:function(t){return this._key=t,this},children:function(t){return this._children=Q(t),this},ctx:function(t){if(t!==me){this._ctx=t;var e=this._children;if(e)for(var n=e.length,o=0;o<n;)e[o++].ctx(t)}return this},renderToDom:function(t){var e=this._children,n=[V("!"),V("!")],o=document.createDocumentFragment();if(o.appendChild(n[0]),e)for(var r=e.length,i=0;i<r;)o.appendChild(e[i++].renderToDom(t));return o.appendChild(n[1]),this._domNode=n,o},renderToString:function(){var t=this._children,e="<!---->";if(t)for(var n=t.length-1;n>=0;)e=t[n--].renderToString()+e;return"<!---->"+e},adoptDom:function(t,e){var n=[t[e++]],o=this._children;if(o)for(var r=o.length,i=0;i<r;)e=o[i++].adoptDom(t,e);return n.push(t[e]),this._domNode=n,e+1},mount:function(){var t=this._children;if(t)for(var e=0,n=t.length;e<n;)t[e++].mount()},unmount:function(){var t=this._children;if(t)for(var e=t.length,n=0;n<e;)t[n++].unmount()},patch:function(t){if(this!==t)switch(t.type){case xe:t._domNode=this._domNode,this._patchChildren(t);break;case ke:var e=t._getInstance();this.patch(e.getRootNode()),e.mount();break;case Se:this.patch(t._getRootNode());break;default:pe.replace(this,t)}},_patchChildren:function(t){var e=this._children,n=t._children;if(e!==n){if(!n||!n.length)return void(e&&e.length&&pe.removeChildren(this));if(e&&e.length)z(this,t);else for(var o=n.length,r=0;r<o;)pe.appendChild(t,n[r++])}}};var Re="undefined"!=typeof window&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame)||function(t){setTimeout(t,1e3/60)},Ee=[],Me=function(t){1===Ee.push(t)&&Re(X)};Y.prototype={on:function(t,e){var n=arguments.length<=2||void 0===arguments[2]?null:arguments[2];return(this._listeners[t]||(this._listeners[t]=[])).push({fn:e,fnCtx:n}),this},off:function(t,e){var n=arguments.length<=2||void 0===arguments[2]?null:arguments[2],o=this._listeners[t];if(o)for(var r=0,i=void 0;r<o.length;){if(i=o[r],i.fn===e&&i.fnCtx===n){o.splice(r,1);break}r++}return this},emit:function(t){var e=this._listeners[t];if(e){for(var n=0,o=arguments.length,r=Array(o>1?o-1:0),i=1;i<o;i++)r[i-1]=arguments[i];for(;n<e.length;){var s=e[n++],a=s.fn,u=s.fnCtx;a.call.apply(a,[u].concat(r))}}return this}},tt.prototype={getDomNode:function(){return this._childNode.getDomNode()},renderToDom:function(){return this._childNode.renderToDom(this._ns)},adoptDom:function(t){this._childNode.adoptDom(t,0)},patch:function(t){this._childNode.patch(t._childNode)},mount:function(){this._childNode.mount()},unmount:function(){this._childNode.unmount()}};var Ie=new ue,Pe=0,Le=new Y;Le.getRootNodes=ct;var Ue=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},Oe=Pt({onInit:function(){var t=this;this.onInput=function(e){var n=t.getAttrs();if(n.onInput&&n.onInput(e),n.onChange&&n.onChange(e),X(),t.isMounted()){n=t.getAttrs();var o=t.getDomRef("control");"undefined"!=typeof n.value&&o.value!==n.value&&(o.value=n.value)}},this.onClick=function(e){var n=t.getAttrs();if(n.onClick&&n.onClick(e),n.onChange&&n.onChange(e),X(),t.isMounted()){n=t.getAttrs();var o=t.getDomRef("control");"undefined"!=typeof n.checked&&o.checked!==n.checked&&(o.checked=n.checked)}}},onRender:function(t){var e=void 0;return"file"===t.type?e=t:(e=Ue({},t,{onChange:null}),"checkbox"===t.type||"radio"===t.type?e.onClick=this.onClick:e.onInput=this.onInput),this.setDomRef("control",new W("input").attrs(e))}}),je=Pt({onInit:function(){var t=this;this.onInput=function(e){var n=t.getAttrs();if(n.onInput&&n.onInput(e),n.onChange&&n.onChange(e),X(),t.isMounted()){n=t.getAttrs();var o=t.getDomRef("control");"undefined"!=typeof n.value&&o.value!==n.value&&(o.value=n.value)}}},onRender:function(t){var e=Ue({},t,{onInput:this.onInput,onChange:null});return this.setDomRef("control",new W("textarea").attrs(e))}}),Fe=Pt({onInit:function(){var t=this;this.onChange=function(e){var n=t.getAttrs();if(n.onChange&&n.onChange(e),X(),t.isMounted()){n=t.getAttrs();var o=t.getDomRef("control");"undefined"!=typeof n.value&&o.value!==n.value&&(o.value=n.value)}}},onRender:function(t,e){var n=Ue({},t,{onChange:this.onChange});return this.setDomRef("control",new W("select").attrs(n).children(e))}}),qe={input:Oe,textarea:je,select:Fe},Be=function(t){return t.renderToString()},ze=Pt();t.node=Lt,t.createComponent=Pt,t.renderToString=Be,t.normalizeChildren=Ft,t.IS_DEBUG=Zt,t.console=Wt,t.Component=ze,t.mountToDom=it,t.mountToDomSync=st,t.unmountFromDom=at,t.unmountFromDomSync=ut,t.getMountedRootNodes=ct,Object.defineProperty(t,"__esModule",{value:!0})});