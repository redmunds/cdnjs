/**
 * Vidom
 * @author Filatov Dmitry <dfilatov@inbox.ru>
 * @version 0.3.18
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.vidom=t.vidom||{})}(this,function(t){"use strict";function e(t){return(t+"").replace(/&/g,"&amp;").replace(/"/g,"&quot;")}function n(t,e){for(var n=t.length,o=0;o<n;)if(t[o++]==e)return!0;return!1}function o(t){return t.replace(Wt,"$1-$2").toLowerCase()}function r(){}function i(t,e,n){if("type"===e&&"INPUT"===t.tagName){var o=t.value;t.setAttribute(e,""+n),t.value=o}else t.setAttribute(Xt[e]||e,""+n)}function s(t,e,n){n?i(t,e,n):h(t,e)}function a(t,e,n){t[e]=n}function u(t,e,n){var o=t[e];for(var r in n)o[r]=null==n[r]?"":n[r]}function c(t,e,n){"value"===e&&"SELECT"===t.tagName?l(t,n):t[e]!==n&&(t[e]=n)}function h(t,e){t.removeAttribute(Xt[e]||e)}function d(t,e){"style"===e?t[e].cssText="":"value"===e&&"SELECT"===t.tagName?f(t):t[e]=_(t.tagName,e)}function l(t,e){for(var o=Array.isArray(e),r=t.options,i=r.length,s=0,a=void 0;s<i;)a=r[s++],a.selected=null!=e&&(o?n(e,a.value):a.value==e)}function f(t){for(var e=t.options,n=e.length,o=0;o<n;)e[o++].selected=!1}function p(t,n){return(Xt[t]||t)+'="'+e(n)+'"'}function v(t,e){return e?t:""}function m(t,e){var n="";for(var r in e)null!=e[r]&&(n+=o(r)+":"+e[r]+";");return n?t+'="'+n+'"':n}function _(t,e){var n=Qt[t]||(Qt[t]={});return e in n?n[e]:n[e]=document.createElement(t)[e]}function g(t){return oe[t]||Yt}function y(t,e){if(Array.isArray(t))C(e,t[1]);else if(Array.isArray(e)){for(var n=e[0],o=void 0,r=e[1];n!==r;)o=n.nextSibling,t.appendChild(n),n=o;t.appendChild(r)}else t.appendChild(e)}function N(t){if(Array.isArray(t)){for(var e=t[0],n=void 0,o=t[1],r=o.parentNode;e!==o;)n=e.nextSibling,r.removeChild(e),e=n;r.removeChild(o)}else t.parentNode.removeChild(t)}function C(t,e){if(Array.isArray(e)&&(e=e[0]),Array.isArray(t)){for(var n=t[0],o=void 0,r=t[1],i=r.parentNode;n!==r;)o=n.nextSibling,i.insertBefore(n,e),n=o;i.insertBefore(r,e)}else e.parentNode.insertBefore(t,e)}function D(t,e,n){if(n){Array.isArray(e)&&(e=e[1]);var o=e.nextSibling;o?C(t,o):y(e.parentNode,t)}else C(t,e)}function A(t,e){Array.isArray(t)?(C(e,t),N(t)):t.parentNode.replaceChild(e,t)}function x(t){if(Array.isArray(t))for(var e=t[0].nextSibling,n=void 0,o=t[1],r=o.parentNode;e!==o;)n=e.nextSibling,r.removeChild(e),e=n;else t.textContent=""}function b(t){return Array.isArray(t)?k(t):t.namespaceURI===ie?null:t.namespaceURI}function k(t){return b((Array.isArray(t)?t[t.length-1]:t).parentNode)}function S(t){var e="on"+t;if(e in document)return!0;var n=document.createElement("div");return n.setAttribute(e,"return;"),"function"==typeof n[e]||"wheel"===t&&document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0&&document.implementation.hasFeature("Events.wheel","3.0")}function w(t,e){this.type=t,this.target=e.target,this.nativeEvent=e,this._isPropagationStopped=!1,this._isDefaultPrevented=!1,this._isSeized=!1}function T(t,e){var n=se[t];return n&&!n._isPersisted?(n.target=e.target,n.nativeEvent=e,n._isPropagationStopped=!1,n._isDefaultPrevented=!1,n):se[t]=new w(t,e)}function R(t,e){return t[ae]||(e?null:t[ae]=ue++)}function E(t,e){e||(e=t.type);for(var n=ye[e],o=t.target,r=n.listenersCounter,i=void 0,s=void 0,a=void 0,u=void 0;r>0&&o&&o!==document;)(u=R(o,!0))&&(i=ge.get(u),i&&(s=i[e])&&(a?a.push(s):a=[s],--r)),o=o.parentNode;if(a)for(var c=T(e,t),h=a.length,d=0;d<h&&(a[d++](c),!c.isPropagationStopped()););}function M(t){ge.get(R(t.target))[t.type](T(t.type,t))}function I(t,e,n){var o=ye[e];if(o){o.set||(o.setup?o.setup():o.bubbles&&document.addEventListener(e,E,!1),o.set=!0);var r=R(t),i=ge.get(r);i||ge.set(r,i={}),i[e]||(o.bubbles?++o.listenersCounter:t.addEventListener(e,M,!1)),i[e]=n}}function P(t,e){var n=R(t,!0);if(n){var o=ge.get(n);if(o&&o[e]){o[e]=null;var r=ye[e];r&&(r.bubbles?--r.listenersCounter:t.removeEventListener(e,M))}}}function L(t){var e=R(t,!0);if(e){var n=ge.get(e);if(n){ge.delete(e);for(var o in n)P(t,o)}}}function U(t,e){var n=t.getDomNode();re.append(n,e.renderToDom(b(n))),e.mount()}function O(t,e){var n=e.getDomNode();re.insertBefore(t.renderToDom(k(n)),n),t.mount()}function F(t){var e=t.getDomNode();t.unmount(),re.remove(e)}function j(t,e,n){var o=document.activeElement;re.move(t.getDomNode(),e.getDomNode(),n),document.activeElement!==o&&o.focus()}function q(t){for(var e=t.getDomNode(),n=t._children,o=n.length,r=0;r<o;)n[r++].unmount();re.removeChildren(e)}function B(t,e){var n=t.getDomNode();t.unmount(),re.replace(n,e.renderToDom(k(n))),e.mount()}function z(t,e,n){var o=t.getDomNode();Ne[e]?I(o,Ne[e],n):g(e).set(o,e,n)}function H(t,e){var n=t.getDomNode();Ne[e]?P(n,Ne[e]):g(e).remove(n,e)}function V(t,e,n){var o=t.getDomNode();if(n){var r=o.firstChild;r?r.nodeValue=e:o.textContent=e}else o.innerHTML=e}function K(t){t.getDomNode().textContent=""}function W(t,e){var n=t._children,o=e._children,r=n.length,i=o.length;if(1===r&&1===i)return void n[0].patch(o[0]);for(var s=0,a=r-1,u=n[s],c=u._key,h=n[a],d=h._key,l=0,f=i-1,p=o[l],v=p._key,m=o[f],_=m._key,g=!1,y=!1,N=!1,C=!1,D={},A=void 0,x=void 0,b=void 0;s<=a&&l<=f;)D[s]?g=!0:D[a]?y=!0:c===v?(u.patch(p),g=!0,N=!0):d===_?(h.patch(m),y=!0,C=!0):null!=c&&c===_?(Ce.moveChild(u,h,!0),u.patch(m),g=!0,C=!0):null!=d&&d===v?(Ce.moveChild(h,u,!1),h.patch(p),y=!0,N=!0):null!=c&&null==v?(Ce.insertChild(p,u),N=!0):null==c&&null!=v?(Ce.removeChild(u),g=!0):(A||(A=G(n,s,a)),null==(x=A[v])?Ce.insertChild(p,u):(b=n[x],D[x]=!0,Ce.moveChild(b,u,!1),b.patch(p)),N=!0),g&&(g=!1,++s<=a&&(u=n[s],c=u._key)),y&&(y=!1,--a>=s&&(h=n[a],d=h._key)),N&&(N=!1,++l<=f&&(p=o[l],v=p._key)),C&&(C=!1,--f>=l&&(m=o[f],_=m._key));for(;s<=a;)D[s]||Ce.removeChild(n[s]),++s;for(;l<=f;)f<i-1?Ce.insertChild(o[l],o[f+1]):Ce.appendChild(e,o[l]),++l}function G(t,e,n){for(var o={},r=void 0;e<n;)r=t[e],null!=r._key&&(o[r._key]=e),++e;return o}function Z(t){return(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function $(t,e){var n=void 0;if(e){var o=e+":"+t;n=Ae[o]||(Ae[o]=document.createElementNS(e,t))}else n=Ae[t]||(Ae[t]="!"===t?document.createComment(""):document.createElement(t));return n.cloneNode()}function J(t,e,n){if(be||(be=document.createElement("div")),!n||!xe[n]||xe[n]===e)return be.innerHTML=t,be.removeChild(be.firstChild);var o=xe[n];return be.innerHTML="<"+o+' xmlns="'+n+'">'+t+"</"+o+">",be.removeChild(be.firstChild).firstChild}function Q(t){this.type=Se,this._tag=t,this._domNode=null,this._key=null,this._ns=null,this._attrs=null,this._children=null,this._escapeChildren=!0,this._ctx=De}function X(t){if(null==t)return null;var e=typeof t;if("object"===e){var n=Array.isArray(t)?t:[t];return n}return"string"===e?t:t.toString()}function Y(t){this.type=Te,this._component=t,this._key=null,this._attrs=null,this._instance=null,this._children=null,this._ctx=De}function tt(t){this.type=Re,this._component=t,this._key=null,this._attrs=De,this._rootNode=null,this._children=null,this._ctx=De}function et(){this.type=we,this._domNode=null,this._key=null,this._children=null,this._ctx=De}function nt(t){if(null==t)return null;var e=Array.isArray(t)?t:[t];return e}function ot(){for(var t=0;t<Pe.length;)Pe[t++]();Pe=[]}function rt(t,e){var n={};for(var o in t)n[o]=t[o];for(var r in e)n[r]=e[r];return n}function it(){this._listeners={}}function st(t,e){this.type=ke,this._childNode=t,this._ns=e}function at(t,e,n,o,r){var i=R(t),s=Ue.get(i),a=void 0;if(s&&s.tree){a=++s.id;var u=function(){if(s=Ue.get(i),s&&s.id===a){var t=s.tree,r=new st(e,t._ns);t.patch(r),s.tree=r,ct(n,o)}};r?u():Le(u)}else if(Ue.set(i,s={tree:null,id:a=++Oe}),t.children.length){var c=s.tree=new st(e,b(t));c.adoptDom(ht(t)),c.mount(),ct(n,o)}else{var h=function(){var r=Ue.get(i);if(r&&r.id===a){var s=r.tree=new st(e,b(t));re.append(t,s.renderToDom()),s.mount(),ct(n,o)}};r?h():Le(h)}}function ut(t,e,n,o){var r=R(t),i=Ue.get(r);i?!function(){var t=++i.id,s=function(){if(i=Ue.get(r),i&&i.id===t){Ue.delete(r);var o=i.tree;if(o){var s=o.getDomNode();o.unmount(),re.remove(s)}ct(e,n)}};i.tree?o?s():Le(s):o||ct(e,n)}():o||ct(e,n)}function ct(t,e){t&&t.call(e||this)}function ht(t){for(var e=t.childNodes,n=e.length,o=[],r=0,i=void 0;r<n;)i=e[r].nodeType,i!==Node.ELEMENT_NODE&&i!==Node.COMMENT_NODE||o.push(e[r]),r++;return o}function dt(t,e,n,o){at(t,e,n,o,!1)}function lt(t,e){at(t,e,null,null,!0)}function ft(t,e,n){ut(t,e,n,!1)}function pt(t){ut(t,null,null,!0)}function vt(){var t=[];return Ue.forEach(function(e){var n=e.tree;n&&t.push(n)}),t}function mt(){this._isMounted=!0,this.onMount(this._attrs)}function _t(){this._isMounted=!1,this._domRefs=null,this.onUnmount()}function gt(t,e,n){t=this._buildAttrs(t);var o=this._rootNode,r=this._attrs,i=this._children;if((r!==t||i!==e)&&(this._attrs=t,this.isMounted())){var s=this._isUpdating;this._isUpdating=!0,this.onAttrsReceive(t,r,e,i),this._isUpdating=s}if(this._children=e,this._ctx=n,!this._isUpdating){var a=this.shouldUpdate(t,r,e,i);a&&(this._rootNode=this.render(),o.patch(this._rootNode),this.isMounted()&&this.onUpdate(t,r,e,i))}}function yt(){return!0}function Nt(t){return this._rootNode.renderToDom(t)}function Ct(){return this._rootNode.renderToString()}function Dt(t,e){return this._rootNode.adoptDom(t,e)}function At(){return this._rootNode.getDomNode()}function xt(){return this._attrs}function bt(){return De}function kt(){return De}function St(t){this._prevState=this._state,this._state=rt(this._state,t),this.update(wt)}function wt(){this._prevState=this._state}function Tt(){return this._state}function Rt(){return this._prevState}function Et(){this._domRefs={};var t=this.onRender(this._attrs,this._children)||Bt("!"),e=this.onChildContextRequest(this._attrs);return t.ctx(e===De?this._ctx:this._ctx===De?e:rt(this._ctx,e)),t}function Mt(t){var e=this;this._isUpdating?t&&Le(function(){return t.call(e)}):(this._isUpdating=!0,Le(function(){if(e.isMounted()){e._isUpdating=!1;e._rootNode;e.patch(e._attrs,e._children,e._ctx),t&&t.call(e)}}))}function It(){return this._rootNode}function Pt(){return this._isMounted}function Lt(t,e){return this._domRefs[t]=e}function Ut(t){return this._domRefs[t]?this._domRefs[t].getDomNode():null}function Ot(){return this._ctx}function Ft(){return De}function jt(t){if(this._attrs&&t===this._attrs)return t;var e=this.constructor,n=e._defaultAttrs||(e._defaultAttrs=e.getDefaultAttrs());if(!t)return n;if(n===De)return t;var o={};for(var r in n)o[r]=n[r];for(var i in t)o[i]=t[i];return o}function qt(t,e){var n=function(t,e,n){this._attrs=this._buildAttrs(t),this._children=e,this._ctx=n,this._domRefs=null,this._isMounted=!1,this._isUpdating=!1,this._state=this.onInitialStateRequest(this._attrs,e),this._prevState=this._state,this.onInit(this._attrs,e),this._rootNode=this.render()},o={constructor:n,onInitialStateRequest:kt,onInit:r,mount:mt,unmount:_t,onMount:r,onUnmount:r,onAttrsReceive:r,shouldUpdate:yt,onUpdate:r,isMounted:Pt,getState:Tt,getPrevState:Rt,setState:St,renderToDom:Nt,renderToString:Ct,adoptDom:Dt,getDomNode:At,getRootNode:It,render:Et,onRender:r,update:Mt,patch:gt,getDomRef:Ut,setDomRef:Lt,getAttrs:xt,onChildContextRequest:bt,getContext:Ot,_buildAttrs:jt};for(var i in t)o[i]=t[i];n.prototype=o,n.getDefaultAttrs=Ft;for(var s in e)n[s]=e[s];return n.__vidom__component__=!0,n}function Bt(t){switch(typeof t){case"string":return"fragment"===t?new et:ze[t]?new Y(ze[t]):new Q(t);case"function":return t.__vidom__component__?new Y(t):new tt(t)}}function zt(t){if(null==t)return null;var e=typeof t;if("object"!==e)return"string"===e?t||null:""+t;if(!Array.isArray(t))return t;if(!t.length)return null;for(var n=t,o=0,r=t.length,i=!0,s=void 0,a=void 0;o<r;){if(s=zt(t[o]),null===s)null!==n&&(i?n=null:n===t&&(n=t.slice(0,o)));else{if(null===n)n=s;else if(Array.isArray(s))n=i?s:(n===t?n.slice(0,o):Array.isArray(n)?n:[n]).concat(s);else if(a="object"==typeof s,a&&t[o]===s)n!==t&&(n=Vt(n,s));else{if(n===t){if(i&&a){n=s,i=!1,++o;continue}n=n.slice(0,o)}n=Vt(n,s)}i=!1}++o}return n}function Ht(t){return"object"==typeof t?t:Bt("span").children(t)}function Vt(t,e){return Array.isArray(t)?(t.push(Ht(e)),t):[Ht(t),Ht(e)]}function Kt(t){var e=zt(t);return null===e||"object"!=typeof e||Array.isArray(e)||(e=[e]),e}var Wt=/([^A-Z]+)([A-Z])/g,Gt="undefined"==typeof console?null:console,Zt={},$t={log:"",info:"",warn:"Warning!",error:"Error!"};["log","info","warn","error"].forEach(function(t){Zt[t]=Gt?Gt[t]?function(e,n,o,r,i){var s=$t[t];switch(arguments.length){case 1:Gt[t](s,e);break;case 2:Gt[t](s,e,n);break;case 3:Gt[t](s,e,n,o);break;case 4:Gt[t](s,e,n,o,r);break;case 5:Gt[t](s,e,n,o,r,i)}}:function(){Gt.log.apply(Gt,arguments)}:r});var Jt="undefined"==typeof process||"production"!==process.env.NODE_ENV,Qt={},Xt={acceptCharset:"accept-charset",className:"class",htmlFor:"for",httpEquiv:"http-equiv",autoCapitalize:"autocapitalize",autoComplete:"autocomplete",autoCorrect:"autocorrect",autoFocus:"autofocus",autoPlay:"autoplay",encType:"encoding",hrefLang:"hreflang",radioGroup:"radiogroup",spellCheck:"spellcheck",srcDoc:"srcdoc",srcSet:"srcset",tabIndex:"tabindex"},Yt={set:i,remove:h,toString:p},te={set:s,remove:h,toString:v},ee={set:a,remove:d,toString:p},ne={set:a,remove:d,toString:v},oe={checked:ne,controls:ee,disabled:te,id:ee,ismap:te,loop:ee,multiple:ne,muted:ee,open:te,readOnly:ne,selected:ne,srcDoc:ee,style:{set:u,remove:d,toString:m},value:{set:c,remove:d,toString:p}},re={append:y,remove:N,insertBefore:C,move:D,replace:A,removeChildren:x},ie="http://www.w3.org/1999/xhtml";w.prototype={stopPropagation:function(){this._isPropagationStopped=!0;var t=this.nativeEvent;t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},isPropagationStopped:function(){return this._isPropagationStopped},preventDefault:function(){this._isDefaultPrevented=!0;var t=this.nativeEvent;t.preventDefault?t.preventDefault():t.returnValue=!1},isDefaultPrevented:function(){return this._isDefaultPrevented},persist:function(){this._isPersisted=!0}};var se={},ae="__vidom__id__",ue=1,ce=void 0;"undefined"==typeof Map?(ce=function(){this._storage={}},ce.prototype={has:function(t){return t in this._storage},get:function(t){return this._storage[t]},set:function(t,e){return this._storage[t]=e,this},delete:function(t){return delete this._storage[t]},forEach:function(t,e){var n=this._storage;for(var o in n)t.call(e,n[o],o,this)}}):ce=Map;var he=ce,de="undefined"==typeof navigator?"":navigator.userAgent,le=de.indexOf("Trident")>-1,fe=de.indexOf("Edge")>-1,pe=/iPad|iPhone|iPod/.test(de)&&"undefined"==typeof MSStream,ve=["click","mousedown","mousemove","mouseout","mouseover","mouseup"],me=["blur","change","click","contextmenu","copy","cut","dblclick","drag","dragend","dragenter","dragleave","dragover","dragstart","drop","focus","input","keydown","keypress","keyup","paste","submit","touchcancel","touchend","touchmove","touchstart","wheel"],_e=["canplay","canplaythrough","complete","durationchange","emptied","ended","error","load","loadeddata","loadedmetadata","loadstart","mouseenter","mouseleave","pause","play","playing","progress","ratechange","scroll","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting"];pe?_e=[].concat(_e,ve):me=[].concat(me,ve);var ge=new he,ye={};"undefined"!=typeof document&&!function(){for(var t={focus:"focusin",blur:"focusout"},e=0,n=void 0;e<me.length;)n=me[e++],ye[n]={type:n,bubbles:!0,listenersCounter:0,set:!1,setup:t[n]?S(t[n])?function(){var e=this.type;document.addEventListener(t[e],function(t){E(t,e)})}:function(){document.addEventListener(this.type,E,!0)}:null};for(e=0;e<_e.length;)ye[_e[e++]]={type:n,bubbles:!1,set:!1}}();var Ne={onBlur:"blur",onCanPlay:"canplay",onCanPlayThrough:"canplaythrough",onChange:"change",onClick:"click",onComplete:"complete",onContextMenu:"contextmenu",onCopy:"copy",onCut:"cut",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragEnter:"dragenter",onDragLeave:"dragleave",onDragOver:"dragover",onDragStart:"dragstart",onDrop:"drop",onDurationChange:"durationchange",onEmptied:"emptied",onEnded:"ended",onError:"error",onFocus:"focus",onInput:"input",onKeyDown:"keydown",onKeyPress:"keypress",onKeyUp:"keyup",onLoad:"load",onLoadedData:"loadeddata",onLoadedMetadata:"loadedmetadata",onLoadStart:"loadstart",onMouseDown:"mousedown",onMouseEnter:"mouseenter",onMouseLeave:"mouseleave",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onPaste:"paste",onPause:"pause",onPlay:"play",onPlaying:"playing",onProgress:"progress",onRateChange:"ratechange",onScroll:"scroll",onSeeked:"seeked",onSeeking:"seeking",onStalled:"stalled",onSubmit:"submit",onSuspend:"suspend",onTimeUpdate:"timeupdate",onTouchCancel:"touchcancel",onTouchEnd:"touchend",onTouchMove:"touchmove",onTouchStart:"touchstart",onVolumeChange:"volumechange",onWaiting:"waiting",onWheel:"wheel"},Ce={appendChild:U,insertChild:O,removeChild:F,moveChild:j,removeChildren:q,replace:B,updateAttr:z,removeAttr:H,updateText:V,removeText:K},De={},Ae={},xe={"http://www.w3.org/2000/svg":"svg","http://www.w3.org/1998/Math/MathML":"math"},be=void 0,ke=1,Se=2,we=3,Te=4,Re=5,Ee={area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,menuitem:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},Me=le||fe;Q.prototype={getDomNode:function(){return this._domNode},key:function(t){return this._key=t,this},ns:function(t){return this._ns=t,this},attrs:function(t){return this._attrs=t,this},children:function(t){return this._children=X(t),this},ctx:function(t){if(t!==De){this._ctx=t;var e=this._children;if(e&&"string"!=typeof e)for(var n=e.length,o=0;o<n;)e[o++].ctx(t)}return this},html:function(t){return this._children=t,this._escapeChildren=!1,this},renderToDom:function(t){var e=this._ns||t,n=this._children;if(Me&&n&&"string"!=typeof n){var o=J(this.renderToString(),this._tag,e);return this.adoptDom([o],0),o}var r=this._domNode=$(this._tag,e),i=this._attrs;if(n)if("string"==typeof n)this._escapeChildren?r.textContent=n:r.innerHTML=n;else for(var s=0,a=n.length;s<a;)r.appendChild(n[s++].renderToDom(e));if(i){var u=void 0,c=void 0;for(u in i)null!=(c=i[u])&&(Ne[u]?I(r,Ne[u],c):g(u).set(r,u,c))}return r},renderToString:function(){var t=this._tag;if("!"===t)return"<!---->";var e=this._ns,o=this._attrs,r=this._children,i="<"+t;if(e&&(i+=' xmlns="'+e+'"'),o){var s=void 0,a=void 0,u=void 0;for(s in o)if(a=o[s],null!=a){if("value"===s)switch(t){case"textarea":r=a;continue;case"select":this.ctx({value:a,multiple:o.multiple});continue;case"option":(this._ctx.multiple?n(this._ctx.value,a):this._ctx.value===a)&&(i+=" "+g("selected").toString("selected",!0))}!Ne[s]&&(u=g(s).toString(s,a))&&(i+=" "+u)}}if(Ee[t])i+="/>";else{if(i+=">",r)if("string"==typeof r)i+=this._escapeChildren?Z(r):r;else for(var c=0,h=r.length;c<h;)i+=r[c++].renderToString();i+="</"+t+">"}return i},adoptDom:function(t,e){var n=this._domNode=t[e],o=this._attrs,r=this._children;if(o){var i=void 0,s=void 0;for(i in o)null!=(s=o[i])&&Ne[i]&&I(n,Ne[i],s)}if(r&&"string"!=typeof r){var a=0,u=r.length;if(u)for(var c=n.childNodes,h=0;a<u;)h=r[a++].adoptDom(c,h)}return e+1},mount:function(){var t=this._children;if(t&&"string"!=typeof t)for(var e=0,n=t.length;e<n;)t[e++].mount()},unmount:function(){var t=this._children;if(t&&"string"!=typeof t)for(var e=0,n=t.length;e<n;)t[e++].unmount();L(this._domNode),this._domNode=null},patch:function(t){if(this===t)return void this._patchChildren(t);switch(t.type){case Se:this._tag!==t._tag||this._ns!==t._ns?Ce.replace(this,t):(t._domNode=this._domNode,this._patchChildren(t),this._patchAttrs(t));break;case Te:var e=t._getInstance();this.patch(e.getRootNode()),e.mount();break;case Re:this.patch(t._getRootNode());break;default:Ce.replace(this,t)}},_patchChildren:function(t){var e=this._children,n=t._children;if(e||n){var o="string"==typeof e,r="string"==typeof n;if(r)return o?void(e!==n&&Ce.updateText(this,n,t._escapeChildren)):(e&&e.length&&Ce.removeChildren(this),void(n&&Ce.updateText(this,n,t._escapeChildren)));if(!n||!n.length)return void(e&&(o?Ce.removeText(this):e.length&&Ce.removeChildren(this)));if(o&&e&&Ce.removeText(this),!o&&e&&e.length)W(this,t);else for(var i=n.length,s=0;s<i;)Ce.appendChild(t,n[s++])}},_patchAttrs:function(t){var e=this._attrs,n=t._attrs;if(e!==n){var o=void 0,r=void 0,i=void 0,s=void 0,a=void 0;if(n)for(o in n)i=n[o],e&&null!=(r=e[o])?null==i?Ce.removeAttr(this,o):"object"==typeof i&&"object"==typeof r?(a=Array.isArray(i),s=Array.isArray(r),a||s?a&&s?this._patchAttrArr(o,r,i):Ce.updateAttr(this,o,i):this._patchAttrObj(o,r,i)):r!==i&&Ce.updateAttr(this,o,i):null!=i&&Ce.updateAttr(this,o,i);if(e)for(o in e)n&&o in n||null==(r=e[o])||Ce.removeAttr(this,o)}},_patchAttrArr:function(t,e,n){if(e!==n){var o=e.length,r=!1;if(o===n.length)for(var i=0;!r&&i<o;)e[i]!=n[i]&&(r=!0),++i;else r=!0;r&&Ce.updateAttr(this,t,n)}},_patchAttrObj:function(t,e,n){if(e!==n){var o=!1,r={};for(var i in n)e[i]!=n[i]&&(o=!0,r[i]=n[i]);for(var s in e)null==e[s]||s in n||(o=!0,r[s]=null);o&&Ce.updateAttr(this,t,r)}}},Y.prototype={getDomNode:function(){return this._instance&&this._instance.getDomNode()},key:function(t){return this._key=t,this},attrs:function(t){return this._attrs=t,this},children:function(t){return this._children=t,this},ctx:function(t){return this._ctx=t,this},renderToDom:function(t){return this._getInstance().renderToDom(t)},renderToString:function(){return this._getInstance().renderToString()},adoptDom:function(t,e){return this._getInstance().adoptDom(t,e)},mount:function(){this._instance.getRootNode().mount(),this._instance.mount()},unmount:function(){this._instance&&(this._instance.getRootNode().unmount(),this._instance.unmount(),this._instance=null)},patch:function(t){var e=this._getInstance();if(this===t)e.patch(t._attrs,t._children,t._ctx);else{if(this.type===t.type)if(this._component===t._component)e.patch(t._attrs,t._children,t._ctx),t._instance=e;else{e.unmount();var n=t._getInstance();e.getRootNode().patch(n.getRootNode()),n.mount()}else e.unmount(),e.getRootNode().patch(t);this._instance=null}},_getInstance:function(){return this._instance||(this._instance=new this._component(this._attrs,this._children,this._ctx))}},tt.prototype={getDomNode:function(){return this._rootNode&&this._rootNode.getDomNode()},key:function(t){return this._key=t,this},attrs:function(t){return this._attrs=t,this},children:function(t){return this._children=t,this},ctx:function(t){return this._ctx=t,this},renderToDom:function(t){return this._getRootNode().renderToDom(t)},renderToString:function(){return this._getRootNode().renderToString()},adoptDom:function(t,e){return this._getRootNode().adoptDom(t,e)},mount:function(){this._getRootNode().mount()},unmount:function(){this._rootNode&&(this._rootNode.unmount(),this._rootNode=null)},patch:function(t){if(this===t){var e=this._getRootNode();this._rootNode=null,e.patch(this._getRootNode())}else this._getRootNode().patch(this.type===t.type?t._getRootNode():t),this._rootNode=null},_getRootNode:function(){if(this._rootNode)return this._rootNode;var t=this._component(this._attrs,this._children,this._ctx)||Bt("!");return t.ctx(this._ctx),this._rootNode=t}},et.prototype={getDomNode:function(){return this._domNode},key:function(t){return this._key=t,this},children:function(t){return this._children=nt(t),this},ctx:function(t){if(t!==De){this._ctx=t;var e=this._children;if(e)for(var n=e.length,o=0;o<n;)e[o++].ctx(t)}return this},renderToDom:function(t){var e=this._children,n=[$("!"),$("!")],o=document.createDocumentFragment();if(o.appendChild(n[0]),e)for(var r=e.length,i=0;i<r;)o.appendChild(e[i++].renderToDom(t));return o.appendChild(n[1]),this._domNode=n,o},renderToString:function(){var t=this._children,e="<!---->";if(t)for(var n=t.length-1;n>=0;)e=t[n--].renderToString()+e;return"<!---->"+e},adoptDom:function(t,e){var n=[t[e++]],o=this._children;if(o)for(var r=o.length,i=0;i<r;)e=o[i++].adoptDom(t,e);return n.push(t[e]),this._domNode=n,e+1},mount:function(){var t=this._children;if(t)for(var e=0,n=t.length;e<n;)t[e++].mount()},unmount:function(){var t=this._children;if(t)for(var e=t.length,n=0;n<e;)t[n++].unmount()},patch:function(t){if(this===t)return void this._patchChildren(t);switch(t.type){case we:t._domNode=this._domNode,this._patchChildren(t);break;case Te:var e=t._getInstance();this.patch(e.getRootNode()),e.mount();break;case Re:this.patch(t._getRootNode());break;default:Ce.replace(this,t)}},_patchChildren:function(t){var e=this._children,n=t._children;if(e||n){if(!n||!n.length)return void(e&&e.length&&Ce.removeChildren(this));if(e&&e.length)W(this,t);else for(var o=n.length,r=0;r<o;)Ce.appendChild(t,n[r++])}}};var Ie="undefined"!=typeof window&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame)||function(t){setTimeout(t,1e3/60)},Pe=[],Le=function(t){1===Pe.push(t)&&Ie(ot)};it.prototype={on:function(t,e){var n=arguments.length<=2||void 0===arguments[2]?null:arguments[2];return(this._listeners[t]||(this._listeners[t]=[])).push({fn:e,fnCtx:n}),this},off:function(t,e){var n=arguments.length<=2||void 0===arguments[2]?null:arguments[2],o=this._listeners[t];if(o)for(var r=0,i=void 0;r<o.length;){if(i=o[r],i.fn===e&&i.fnCtx===n){o.splice(r,1);break}r++}return this},emit:function(t){var e=this._listeners[t];if(e){for(var n=0,o=arguments.length,r=Array(o>1?o-1:0),i=1;i<o;i++)r[i-1]=arguments[i];for(;n<e.length;){var s=e[n++],a=s.fn,u=s.fnCtx;a.call.apply(a,[u].concat(r))}}return this}},st.prototype={getDomNode:function(){return this._childNode.getDomNode()},renderToDom:function(){return this._childNode.renderToDom(this._ns)},adoptDom:function(t){this._childNode.adoptDom(t,0)},patch:function(t){this._childNode.patch(t._childNode)},mount:function(){this._childNode.mount()},unmount:function(){this._childNode.unmount()}};var Ue=new he,Oe=0,Fe=new it;Fe.getRootNodes=vt;var je=qt({onInit:function(){var t=this;this.onInput=function(e){var n=t.getAttrs();if(n.onInput&&n.onInput(e),n.onChange&&n.onChange(e),ot(),t.isMounted()){n=t.getAttrs();var o=t.getDomRef("control");"undefined"!=typeof n.value&&o.value!==n.value&&(o.value=n.value)}},this.onClick=function(e){var n=t.getAttrs();if(n.onClick&&n.onClick(e),n.onChange&&n.onChange(e),ot(),t.isMounted()){n=t.getAttrs();var o=t.getDomRef("control");"undefined"!=typeof n.checked&&o.checked!==n.checked&&(o.checked=n.checked)}}},onRender:function(t){var e=void 0;return"file"===t.type?e=t:(e=rt(t,{onChange:null}),"checkbox"===t.type||"radio"===t.type?e.onClick=this.onClick:e.onInput=this.onInput),this.setDomRef("control",new Q("input").attrs(e))}}),qe=qt({onInit:function(){var t=this;this.onInput=function(e){var n=t.getAttrs();if(n.onInput&&n.onInput(e),n.onChange&&n.onChange(e),ot(),t.isMounted()){n=t.getAttrs();var o=t.getDomRef("control");"undefined"!=typeof n.value&&o.value!==n.value&&(o.value=n.value)}}},onRender:function(t){return this.setDomRef("control",new Q("textarea").attrs(rt(t,{onInput:this.onInput,onChange:null})))}}),Be=qt({onInit:function(){var t=this;this.onChange=function(e){var n=t.getAttrs();if(n.onChange&&n.onChange(e),ot(),t.isMounted()){n=t.getAttrs();var o=t.getDomRef("control");"undefined"!=typeof n.value&&o.value!==n.value&&(o.value=n.value)}}},onRender:function(t,e){return this.setDomRef("control",new Q("select").attrs(rt(t,{onChange:this.onChange})).children(e))}}),ze={input:je,textarea:qe,select:Be},He=function(t){return t.renderToString()},Ve=qt();t.node=Bt,t.createComponent=qt,t.renderToString=He,t.normalizeChildren=Kt,t.IS_DEBUG=Jt,t.console=Zt,t.Component=Ve,t.mountToDom=dt,t.mountToDomSync=lt,t.unmountFromDom=ft,t.unmountFromDomSync=pt,t.getMountedRootNodes=vt,Object.defineProperty(t,"__esModule",{value:!0})});