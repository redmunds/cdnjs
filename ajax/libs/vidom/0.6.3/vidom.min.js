/**
 * Vidom
 * @author Filatov Dmitry <dfilatov@inbox.ru>
 * @version 0.6.3
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.vidom=t.vidom||{})}(this,function(t){"use strict";function e(t){t+="";for(var e=t.length,n=0;e--;)switch(t[e]){case"&":n|=1;break;case'"':n|=2}return 1&n&&(t=t.replace(Yt,"&amp;")),2&n&&(t=t.replace(te,"&quot;")),t}function n(t,e){for(var n=t.length,i=0;i<n;)if(t[i++]==e)return!0;return!1}function i(t){return t.replace(ee,"$1-$2").toLowerCase()}function o(){}function r(t,e,n){if("type"===e&&"INPUT"===t.tagName){var i=t.value;t.setAttribute(e,""+n),t.value=i}else t.setAttribute(ae[e]||e,""+n)}function s(t,e,n){n?r(t,e,n):c(t,e)}function a(t,e,n){t[e]=n}function u(t,e,n){var i=t[e];for(var o in n)i[o]=null==n[o]?"":n[o]}function h(t,e,n){"value"===e&&"SELECT"===t.tagName?l(t,n):t[e]!==n&&(t[e]=n)}function c(t,e){t.removeAttribute(ae[e]||e)}function d(t,e){"style"===e?t[e].cssText="":"value"===e&&"SELECT"===t.tagName?f(t):t[e]=m(t.tagName,e)}function l(t,e){for(var i=Array.isArray(e),o=t.options,r=o.length,s=0,a=void 0;s<r;)a=o[s++],a.selected=null!=e&&(i?n(e,a.value):a.value==e)}function f(t){for(var e=t.options,n=e.length,i=0;i<n;)e[i++].selected=!1}function _(t,n){return n===!1?"":(ae[t]||t)+(n===!0?"":'="'+e(n)+'"')}function p(t,e){return e?t:""}function v(t,e){var n="",o=void 0;for(o in e)null!=e[o]&&(n+=i(o)+":"+e[o]+";");return n?t+'="'+n+'"':n}function m(t,e){var n=se[t]||(se[t]={});return e in n?n[e]:n[e]=document.createElement(t)[e]}function g(t,e){if(Array.isArray(t))N(e,t[1]);else if(Array.isArray(e)){for(var n=e[0],i=void 0,o=e[1];n!==o;)i=n.nextSibling,t.appendChild(n),n=i;t.appendChild(o)}else t.appendChild(e)}function y(t){if(Array.isArray(t)){for(var e=t[0],n=void 0,i=t[1],o=i.parentNode;e!==i;)n=e.nextSibling,o.removeChild(e),e=n;o.removeChild(i)}else t.parentNode.removeChild(t)}function N(t,e){if(Array.isArray(e)&&(e=e[0]),Array.isArray(t)){for(var n=t[0],i=void 0,o=t[1],r=o.parentNode;n!==o;)i=n.nextSibling,r.insertBefore(n,e),n=i;r.insertBefore(o,e)}else e.parentNode.insertBefore(t,e)}function C(t,e,n){if(n){Array.isArray(e)&&(e=e[1]);var i=e.nextSibling;i?N(t,i):g(e.parentNode,t)}else N(t,e)}function A(t,e){Array.isArray(t)?(N(e,t),y(t)):t.parentNode.replaceChild(e,t)}function x(t){if(Array.isArray(t))for(var e=t[0].nextSibling,n=void 0,i=t[1],o=i.parentNode;e!==i;)n=e.nextSibling,o.removeChild(e),e=n;else t.textContent=""}function D(t,e,n){if(Array.isArray(t)){var i=t[1],o=i.previousSibling;o===t[0]?i.parentNode.insertBefore(document.createTextNode(e),i):o.nodeValue=e}else if(n){var r=t.firstChild;r?r.nodeValue=e:t.textContent=e}else t.innerHTML=e}function k(t){if(Array.isArray(t)){var e=t[0].nextSibling;e.parentNode.removeChild(e)}else t.textContent=""}function b(t){var e="on"+t;if(e in document)return!0;var n=document.createElement("div");return n.setAttribute(e,"return;"),"function"==typeof n[e]||"wheel"===t&&document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0&&document.implementation.hasFeature("Events.wheel","3.0")}function w(t,e){this.type=t,this.target=e.target,this.nativeEvent=e,this._isPropagationStopped=!1,this._isDefaultPrevented=!1,this._isPersisted=!1}function S(t,e){var n=pe[t];return n&&!n._isPersisted?(n.target=e.target,n.nativeEvent=e,n._isPropagationStopped=!1,n._isDefaultPrevented=!1,n):pe[t]=new w(t,e)}function T(t,e){return t[ve]||(e?null:t[ve]=me++)}function R(t,e){if(Te){e||(e=t.type);for(var n=Se[e],i=t.target,o=n.listenersCounter,r=void 0,s=void 0,a=void 0,u=void 0;o>0&&i&&i!==document;){if((a=T(i,!0))&&(r=we.get(a),r&&(s=r[e]))){if(s(u||(u=S(e,t))),u.isPropagationStopped())break;--o}i=i.parentNode}}}function M(t){Te&&we.get(T(t.currentTarget))[t.type](S(t.type,t))}function E(t,e,n){var i=Se[e];if(i){i.set||(i.setup?i.setup():i.bubbles&&document.addEventListener(e,R,!1),i.set=!0);var o=T(t),r=we.get(o);r||we.set(o,r={}),r[e]||(i.bubbles?++i.listenersCounter:t.addEventListener(e,M,!1)),r[e]=n}}function P(t,e){var n=Se[e];n&&(n.bubbles?--n.listenersCounter:t.removeEventListener(e,M))}function I(t,e){var n=T(t,!0);if(n){var i=we.get(n);i&&i[e]&&(i[e]=null,P(t,e))}}function U(t){var e=T(t,!0);if(e){var n=we.get(e);if(n){for(var i in n)n[i]&&P(t,i);we.delete(e)}}}function q(){Te=!1}function L(){Te=!0}function O(t){return Array.isArray(t)?j(t):t.namespaceURI===Re?null:t.namespaceURI}function j(t){return O((Array.isArray(t)?t[t.length-1]:t).parentNode)}function F(t,e){var n=t.getDomNode();_e.append(n,e.renderToDom(O(n))),e.mount()}function B(t,e){var n=e.getDomNode();_e.insertBefore(t.renderToDom(j(n)),n),t.mount()}function V(t){var e=t.getDomNode();t.unmount(),_e.remove(e)}function z(t,e,n){var i=document.activeElement;q(),_e.move(t.getDomNode(),e.getDomNode(),n),document.activeElement!==i&&i.focus(),L()}function H(t){for(var e=t.getDomNode(),n=t._children,i=n.length,o=0;o<i;)n[o++].unmount();_e.removeChildren(e)}function K(t,e){var n=t.getDomNode();t.unmount(),_e.replace(n,e.renderToDom(j(n))),e.mount()}function W(t,e,n){var i=t.getDomNode();Me[e]?E(i,Me[e],n):fe(e).set(i,e,n)}function G(t,e){var n=t.getDomNode();Me[e]?I(n,Me[e]):fe(e).remove(n,e)}function Z(t,e,n){_e.updateText(t.getDomNode(),e,n)}function $(t){_e.removeText(t.getDomNode())}function J(t,e){var n=t._children,i=e._children,o=n.length,r=i.length;if(1===o&&1===r)return void n[0].patch(i[0]);for(var s=0,a=o-1,u=n[s],h=u._key,c=n[a],d=c._key,l=0,f=r-1,_=i[l],p=_._key,v=i[f],m=v._key,g=!1,y=!1,N=!1,C=!1,A=void 0,x=void 0,D=void 0,k={};s<=a&&l<=f;)k[s]?g=!0:k[a]?y=!0:h===p?(u.patch(_),g=!0,N=!0):d===m?(c.patch(v),y=!0,C=!0):null!=h&&h===m?(Ee.moveChild(u,c,!0),u.patch(v),g=!0,C=!0):null!=d&&d===p?(Ee.moveChild(c,u,!1),c.patch(_),y=!0,N=!0):null!=h&&null==p?(Ee.insertChild(_,u),N=!0):null==h&&null!=p?(Ee.removeChild(u),g=!0):(A||(A=Q(n,s,a)),null==(x=A[p])?Ee.insertChild(_,u):(D=n[x],k[x]=!0,Ee.moveChild(D,u,!1),D.patch(_)),N=!0),g&&(g=!1,++s<=a&&(u=n[s],h=u._key)),y&&(y=!1,--a>=s&&(c=n[a],d=c._key)),N&&(N=!1,++l<=f&&(_=i[l],p=_._key)),C&&(C=!1,--f>=l&&(v=i[f],m=v._key));for(;s<=a;)k[s]||Ee.removeChild(n[s]),++s;for(;l<=f;)f<r-1?Ee.insertChild(i[l],i[f+1]):Ee.appendChild(e,i[l]),++l}function Q(t,e,n){for(var i={},o=void 0;e<n;)o=t[e],null!=o._key&&(i[o._key]=e),++e;return i}function X(t){t+="";for(var e=t.length,n=0;e--;)switch(t[e]){case"&":n|=1;break;case"<":n|=2;break;case">":n|=4}return 1&n&&(t=t.replace(Pe,"&amp;")),2&n&&(t=t.replace(Ie,"&lt;")),4&n&&(t=t.replace(Ue,"&gt;")),t}function Y(t,e){var n={};for(var i in t)n[i]=t[i];for(var o in e)n[o]=e[o];return n}function tt(t,e){var n=void 0;if(e){var i=e+":"+t;n=Le[i]||(Le[i]=document.createElementNS(e,t))}else n=Le[t]||(Le[t]="!"===t?document.createComment(""):document.createElement(t));return n.cloneNode()}function et(t,e,n){var i=je[e]||"div",o=Fe[i]||(Fe[i]=document.createElement(i));if(!n||!Oe[n]||Oe[n]===e)return o.innerHTML=t,o.removeChild(o.firstChild);var r=Oe[n];return o.innerHTML="<"+r+' xmlns="'+n+'">'+t+"</"+r+">",o.removeChild(o.firstChild).firstChild}function nt(t){this.type=Ve,this._tag=t,this._domNode=null,this._key=null,this._attrs=null,this._children=null,this._ns=null,this._escapeChildren=!0,this._ctx=qe,this._ref=null}function it(t){if(null==t)return null;var e=typeof t;if("object"===e){var n=Array.isArray(t)?t:[t];return n}return"string"===e?t:t.toString()}function ot(){for(var t=0;t<Je.length;)Je[t++]();Je=[]}function rt(t){1===Je.push(t)&&$e(ot)}function st(){this._listeners={}}function at(t){this.type=Be,this._childNode=t,this._ns=null}function ut(t,e,n,i,o){var r=T(t),s=Qe.get(r),a=void 0;if(s&&s.tree){a=++s.id;var u=function(){if(s=Qe.get(r),s&&s.id===a){var t=s.tree,o=new at(e);o.ns(t._ns).ctx(n),t.patch(o),s.tree=o,ct(i)}};o?u():rt(u)}else{if(Qe.set(r,s={tree:null,id:a=++Xe}),t.childNodes.length){var h=dt(t);if(h){var c=s.tree=new at(e);return c.ns(O(t)).ctx(n),c.adoptDom(h),c.mount(),void ct(i)}t.textContent=""}var d=function(){var o=Qe.get(r);if(o&&o.id===a){var s=o.tree=new at(e);s.ns(O(t)).ctx(n),_e.append(t,s.renderToDom()),s.mount(),ct(i)}};o?d():rt(d)}}function ht(t,e,n){var i=T(t),o=Qe.get(i);o?!function(){var t=++o.id,r=function(){if(o=Qe.get(i),o&&o.id===t){Qe.delete(i);var n=o.tree;if(n){var r=n.getDomNode();n.unmount(),_e.remove(r)}ct(e)}};o.tree?n?r():rt(r):n||ct(e)}():n||ct(e)}function ct(t){t&&t()}function dt(t){for(var e=t.childNodes,n=e.length,i=0,o=void 0,r=void 0;i<n;)r=e[i++],o?o.push(r):r.nodeType===Node.COMMENT_NODE&&"vidom"===r.textContent&&(o=[]);return o}function lt(t,e,n,i){"function"==typeof n&&(i=n,n=this),ut(t,e,n,i,!1)}function ft(t,e,n){ut(t,e,n,null,!0)}function _t(t,e){ht(t,e,!1)}function pt(t){ht(t,null,!0)}function vt(){var t=[];return Qe.forEach(function(e){var n=e.tree;n&&t.push(n)}),t}function mt(){this.__isMounted=!0,this.onMount(this.__attrs,this.__children)}function gt(){this.__isMounted=!1,this.onUnmount()}function yt(t,e,n){t=this.__buildAttrs(t);var i=this.__rootNode,o=this.__attrs,r=this.__children;if((o!==t||r!==e)&&(this.__attrs=t,this.isMounted())){var s=this.__isUpdating;this.__isUpdating=!0,this.onAttrsReceive(t,o,e,r),this.__isUpdating=s}if(this.__children=e,this.__ctx=n,!this.__isUpdating){var a=this.shouldUpdate(t,o,e,r);a&&(this.__rootNode=this.render(),i.patch(this.__rootNode),this.isMounted()&&this.onUpdate(t,o,e,r))}}function Nt(){return!0}function Ct(t){return this.__rootNode.renderToDom(t)}function At(){return this.__rootNode.renderToString()}function xt(t,e){return this.__rootNode.adoptDom(t,e)}function Dt(){return this.__rootNode.getDomNode()}function kt(){return this.__attrs}function bt(){return this.__children}function wt(){return qe}function St(){return qe}function Tt(t){this.__prevState=this.__state,this.__state=Y(this.__state,t),this.update(Rt)}function Rt(){this.__prevState=this.__state}function Mt(){return this.__state}function Et(){return this.__prevState}function Pt(){var t=this.onRender(this.__attrs,this.__children)||Jt("!"),e=this.onChildContextRequest(this.__attrs);return t.ctx(e===qe?this.__ctx:this.__ctx===qe?e:Y(this.__ctx,e)),t}function It(t){var e=this;this.__isUpdating?t&&rt(function(){return t.call(e)}):(this.__isUpdating=!0,rt(function(){if(e.isMounted()){e.__isUpdating=!1;e.__rootNode;e.patch(e.__attrs,e.__children,e.__ctx),t&&t.call(e)}}))}function Ut(){return this.__rootNode}function qt(){return this.__isMounted}function Lt(){return this.__ctx}function Ot(){return this}function jt(){return qe}function Ft(t){if(this.__attrs&&t===this.__attrs)return t;var e=this.constructor,n=e.__defaultAttrs||(e.__defaultAttrs=e.onDefaultAttrsRequest());return t?n===qe?t:Y(n,t):n}function Bt(t,e){var n=function(t,e,n){this.__attrs=this.__buildAttrs(t),this.__children=e,this.__ctx=n,this.__isMounted=!1,this.__isUpdating=!1,this.__state=this.onInitialStateRequest(this.__attrs,e),this.__prevState=this.__state,this.onInit(this.__attrs,e),this.__rootNode=this.render()},i={constructor:n,onInitialStateRequest:St,onInit:o,mount:mt,unmount:gt,onMount:o,onUnmount:o,onAttrsReceive:o,shouldUpdate:Nt,onUpdate:o,isMounted:qt,getState:Mt,getPrevState:Et,setState:Tt,renderToDom:Ct,renderToString:At,adoptDom:xt,getDomNode:Dt,getRootNode:Ut,render:Pt,onRender:o,update:It,patch:yt,getAttrs:kt,getChildren:bt,onChildContextRequest:wt,getContext:Lt,onRefRequest:Ot,__buildAttrs:Ft};for(var r in t)i[r]=t[r];n.prototype=i,n.onDefaultAttrsRequest=jt;for(var s in e)n[s]=e[s];return n.__vidom__component__=!0,n}function Vt(t,e){var n=en.get(t);n?n.push(e):en.set(t,[e])}function zt(t,e){for(var n=en.get(t),i=n.length,o=0;o<i;){if(n[o]===e)return void(1===i?en.delete(t):n.splice(o,1));o++}}function Ht(t){this.type=Ke,this._component=t,this._key=null,this._attrs=null,this._children=null,this._instance=null,this._ctx=qe,this._ref=null}function Kt(t){this.type=We,this._component=t,this._key=null,this._attrs=null,this._children=null,this._rootNode=null,this._ctx=qe}function Wt(){this.type=He,this._domNode=null,this._key=null,this._children=null,this._ctx=qe}function Gt(t){if(null==t)return null;var e=Array.isArray(t)?t:[t];return e}function Zt(){this.type=ze,this._domNode=null,this._key=null,this._children=null}function $t(t){return null==t||"string"==typeof t?t:t.toString()}function Jt(t){switch(typeof t){case"string":switch(t){case"fragment":return new Wt;case"text":return new Zt;case"input":return new Ht(tn);case"textarea":return new Ht(sn);case"select":return new Ht(an);default:return new nt(t)}case"function":return t.__vidom__component__?new Ht(t):new Kt(t)}}function Qt(t){if(null==t)return null;var e=typeof t;if("object"!==e)return"string"===e?t||null:""+t;if(!Array.isArray(t))return t;if(!t.length)return null;for(var n=t,i=0,o=!1,r=void 0,s=t.length,a={};i<s;){if(r=i in a?a[i]:Qt(t[i]),null===r)null!==n&&(o?n===t&&(n=t.slice(0,i)):n=null);else if("object"==typeof r)Array.isArray(r)?n=o?(n===t?n.slice(0,i):Array.isArray(n)?n:[Xt(n)]).concat(r):r:n!==t?o?Array.isArray(n)?n.push(r):n=[Xt(n),r]:n=r:r!==t[i]&&(o?(n=n.slice(0,i),n.push(r)):n=r),o=!0;else{for(var u=void 0,h=i;++h<s;)if(u=a[h]=Qt(t[h]),"string"==typeof u)r+=u;else if(null!==u)break;o?Array.isArray(n)?(n===t&&(n=n.slice(0,i)),n.push(Xt(r))):n=[n,Xt(r)]:n=""+r,i=h-1,o=!0}++i}return n}function Xt(t){return"object"==typeof t?t:Jt("text").children(t)}var Yt=/&/g,te=/"/g,ee=/([^A-Z]+)([A-Z])/g,ne="undefined"==typeof console?null:console,ie={},oe={log:"",info:"",warn:"Warning!",error:"Error!"};["log","info","warn","error"].forEach(function(t){ie[t]=ne?ne[t]?function(e,n,i,o,r){var s=oe[t];switch(arguments.length){case 1:ne[t](s,e);break;case 2:ne[t](s,e,n);break;case 3:ne[t](s,e,n,i);break;case 4:ne[t](s,e,n,i,o);break;case 5:ne[t](s,e,n,i,o,r)}}:function(){ne.log.apply(ne,arguments)}:o});var re="undefined"==typeof process||"production"!==process.env.NODE_ENV,se={},ae={acceptCharset:"accept-charset",className:"class",htmlFor:"for",httpEquiv:"http-equiv",autoCapitalize:"autocapitalize",autoComplete:"autocomplete",autoCorrect:"autocorrect",autoFocus:"autofocus",autoPlay:"autoplay",encType:"encoding",hrefLang:"hreflang",radioGroup:"radiogroup",spellCheck:"spellcheck",srcDoc:"srcdoc",srcSet:"srcset",tabIndex:"tabindex"},ue={set:r,remove:c,toString:_},he={set:s,remove:c,toString:p},ce={set:a,remove:d,toString:_},de={set:a,remove:d,toString:p},le={checked:de,controls:ce,disabled:he,id:ce,ismap:he,loop:ce,multiple:de,muted:ce,open:he,readOnly:de,selected:de,srcDoc:ce,style:{set:u,remove:d,toString:v},value:{set:h,remove:d,toString:_}},fe=function(t){return le[t]||ue},_e={append:g,remove:y,insertBefore:N,move:C,replace:A,removeChildren:x,updateText:D,removeText:k};w.prototype={stopPropagation:function(){this._isPropagationStopped=!0;var t=this.nativeEvent;t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},isPropagationStopped:function(){return this._isPropagationStopped},preventDefault:function(){this._isDefaultPrevented=!0;var t=this.nativeEvent;t.preventDefault?t.preventDefault():t.returnValue=!1},isDefaultPrevented:function(){return this._isDefaultPrevented},persist:function(){this._isPersisted=!0}};var pe={},ve="__vidom__id__",me=1,ge=void 0;"undefined"==typeof Map?(ge=function(){this._storage={}},ge.prototype={has:function(t){return t in this._storage},get:function(t){return this._storage[t]},set:function(t,e){return this._storage[t]=e,this},delete:function(t){return delete this._storage[t]},forEach:function(t,e){var n=this._storage;for(var i in n)t.call(e,n[i],i,this)}}):ge=Map;var ye=ge,Ne="undefined"==typeof navigator?"":navigator.userAgent,Ce=Ne.indexOf("Trident")>-1,Ae=Ne.indexOf("Edge")>-1,xe=/iPad|iPhone|iPod/.test(Ne)&&"undefined"==typeof MSStream,De=["click","mousedown","mousemove","mouseout","mouseover","mouseup"],ke=["blur","change","contextmenu","copy","cut","dblclick","drag","dragend","dragenter","dragleave","dragover","dragstart","drop","focus","input","keydown","keypress","keyup","paste","submit","touchcancel","touchend","touchmove","touchstart","wheel"],be=["canplay","canplaythrough","complete","durationchange","emptied","ended","error","load","loadeddata","loadedmetadata","loadstart","mouseenter","mouseleave","pause","play","playing","progress","ratechange","scroll","seeked","seeking","select","stalled","suspend","timeupdate","volumechange","waiting"];xe?be=[].concat(be,De):ke=[].concat(ke,De);var we=new ye,Se={},Te=!0;"undefined"!=typeof document&&!function(){for(var t={focus:"focusin",blur:"focusout"},e=0,n=void 0;e<ke.length;)n=ke[e++],Se[n]={type:n,bubbles:!0,listenersCounter:0,set:!1,setup:t[n]?b(t[n])?function(){var e=this.type;document.addEventListener(t[e],function(t){R(t,e)})}:function(){document.addEventListener(this.type,R,!0)}:null};for(e=0;e<be.length;)Se[be[e++]]={type:n,bubbles:!1,set:!1}}();var Re="http://www.w3.org/1999/xhtml",Me={onBlur:"blur",onCanPlay:"canplay",onCanPlayThrough:"canplaythrough",onChange:"change",onClick:"click",onComplete:"complete",onContextMenu:"contextmenu",onCopy:"copy",onCut:"cut",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragEnter:"dragenter",onDragLeave:"dragleave",onDragOver:"dragover",onDragStart:"dragstart",onDrop:"drop",onDurationChange:"durationchange",onEmptied:"emptied",onEnded:"ended",onError:"error",onFocus:"focus",onInput:"input",onKeyDown:"keydown",onKeyPress:"keypress",onKeyUp:"keyup",onLoad:"load",onLoadedData:"loadeddata",onLoadedMetadata:"loadedmetadata",onLoadStart:"loadstart",onMouseDown:"mousedown",onMouseEnter:"mouseenter",onMouseLeave:"mouseleave",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onPaste:"paste",onPause:"pause",onPlay:"play",onPlaying:"playing",onProgress:"progress",onRateChange:"ratechange",onScroll:"scroll",onSeeked:"seeked",onSeeking:"seeking",onSelect:"select",onStalled:"stalled",onSubmit:"submit",onSuspend:"suspend",onTimeUpdate:"timeupdate",onTouchCancel:"touchcancel",onTouchEnd:"touchend",onTouchMove:"touchmove",onTouchStart:"touchstart",onVolumeChange:"volumechange",onWaiting:"waiting",onWheel:"wheel"},Ee={appendChild:F,insertChild:B,removeChild:V,moveChild:z,removeChildren:H,replace:K,updateAttr:W,removeAttr:G,updateText:Z,removeText:$},Pe=/&/g,Ie=/</g,Ue=/>/g,qe={},Le={},Oe={"http://www.w3.org/2000/svg":"svg","http://www.w3.org/1998/Math/MathML":"math"},je={thead:"table",tbody:"table",tfoot:"table",tr:"tbody",td:"tr"},Fe={},Be=1,Ve=2,ze=3,He=4,Ke=5,We=6,Ge={area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,menuitem:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},Ze=Ce||Ae;nt.prototype={getDomNode:function(){return this._domNode},key:function(t){return this._key=t,this},ns:function(t){return this._ns=t,this},attrs:function(t){return this._attrs=this._attrs?Y(this._attrs,t):t,this},children:function(t){return this._children=it(t),this},ctx:function(t){if(t!==qe){this._ctx=t;var e=this._children;if(e&&"string"!=typeof e)for(var n=e.length,i=0;i<n;)e[i++].ctx(t)}return this},html:function(t){return this._children=t,this._escapeChildren=!1,this},ref:function(t){return this._ref=t,this},renderToDom:function(t){var e=this._tag,n=this._ns||t,i=this._children;if(Ze&&i&&"string"!=typeof i){var o=et(this.renderToString(),e,n);return this.adoptDom([o],0),o}var r=this._domNode=tt(e,n),s=this._attrs;if(i)if("string"==typeof i)this._escapeChildren?r.textContent=i:r.innerHTML=i;else for(var a=0,u=i.length;a<u;)r.appendChild(i[a++].renderToDom(n));if(s){var h=void 0,c=void 0;for(h in s)null!=(c=s[h])&&(Me[h]?E(r,Me[h],c):fe(h).set(r,h,c))}return r},renderToString:function(){var t=this._tag;if("!"===t)return"<!---->";var e=this._ns,i=this._attrs,o=this._children,r="<"+t;if(e&&(r+=' xmlns="'+e+'"'),i){var s=void 0,a=void 0,u=void 0;for(s in i)if(a=i[s],null!=a){if("value"===s)switch(t){case"textarea":o=a;continue;case"select":this.ctx({value:a,multiple:i.multiple});continue;case"option":var h=this._ctx;(h.multiple?n(h.value,a):h.value===a)&&(r+=" "+fe("selected").toString("selected",!0))}!Me[s]&&(u=fe(s).toString(s,a))&&(r+=" "+u)}}if(Ge[t])r+="/>";else{if(r+=">",o)if("string"==typeof o)r+=this._escapeChildren?X(o):o;else for(var c=0,d=o.length;c<d;)r+=o[c++].renderToString();r+="</"+t+">"}return r},adoptDom:function(t,e){var n=this._domNode=t[e],i=this._attrs,o=this._children;if(i){var r=void 0,s=void 0;for(r in i)null!=(s=i[r])&&Me[r]&&E(n,Me[r],s)}if(o&&"string"!=typeof o){var a=0,u=o.length;if(u)for(var h=n.childNodes,c=0;a<u;)c=o[a++].adoptDom(h,c)}return e+1},mount:function(){var t=this._children;if(t&&"string"!=typeof t)for(var e=0,n=t.length;e<n;)t[e++].mount();this._ref&&this._ref(this._domNode)},unmount:function(){var t=this._children;if(t&&"string"!=typeof t)for(var e=0,n=t.length;e<n;)t[e++].unmount();U(this._domNode),this._domNode=null,this._ref&&this._ref(null)},clone:function(){var t=new nt(this._tag);return t._key=this._key,t._attrs=this._attrs,t._children=this._children,t._ns=this._ns,t._escapeChildren=this._escapeChildren,t._ctx=this._ctx,t._ref=this._ref,t},patch:function(t){this===t?this._patchChildren(t):this.type===t.type&&this._tag===t._tag&&this._ns===t._ns?(t._domNode=this._domNode,this._patchChildren(t),this._patchAttrs(t)):Ee.replace(this,t)},_patchChildren:function(t){var e=this._children,n=t._children;if(e||n){var i="string"==typeof e,o="string"==typeof n;if(o)return i?void(e!==n&&Ee.updateText(this,n,t._escapeChildren)):(e&&e.length&&Ee.removeChildren(this),void(n&&Ee.updateText(this,n,t._escapeChildren)));if(!n||!n.length)return void(e&&(i?Ee.removeText(this):e.length&&Ee.removeChildren(this)));if(i&&e&&Ee.removeText(this),!i&&e&&e.length)J(this,t);else for(var r=n.length,s=0;s<r;)Ee.appendChild(t,n[s++])}},_patchAttrs:function(t){var e=this._attrs,n=t._attrs;if(e!==n){var i=void 0;if(n){var o=void 0,r=void 0,s=void 0,a=void 0;for(i in n)r=n[i],e&&null!=(o=e[i])?null==r?Ee.removeAttr(this,i):"object"==typeof r&&"object"==typeof o?(a=Array.isArray(r),s=Array.isArray(o),a||s?a&&s?this._patchAttrArr(i,o,r):Ee.updateAttr(this,i,r):this._patchAttrObj(i,o,r)):o!==r&&Ee.updateAttr(this,i,r):null!=r&&Ee.updateAttr(this,i,r)}if(e)for(i in e)n&&i in n||null==e[i]||Ee.removeAttr(this,i)}},_patchAttrArr:function(t,e,n){if(e!==n){var i=e.length,o=!1;if(i===n.length)for(var r=0;!o&&r<i;)e[r]!=n[r]&&(o=!0),++r;else o=!0;o&&Ee.updateAttr(this,t,n)}},_patchAttrObj:function(t,e,n){if(e!==n){var i={},o=!1;for(var r in n)e[r]!=n[r]&&(o=!0,i[r]=n[r]);for(var s in e)null==e[s]||s in n||(o=!0,i[s]=null);o&&Ee.updateAttr(this,t,i)}}};var $e="undefined"!=typeof window&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame)||function(t){setTimeout(t,1e3/60)},Je=[];st.prototype={on:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return(this._listeners[t]||(this._listeners[t]=[])).push({fn:e,fnCtx:n}),this},off:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=this._listeners[t];if(i)for(var o=0,r=void 0;o<i.length;){if(r=i[o],r.fn===e&&r.fnCtx===n){i.splice(o,1);break}o++}return this},emit:function(t){var e=this._listeners[t];if(e){for(var n=0,i=arguments.length,o=Array(i>1?i-1:0),r=1;r<i;r++)o[r-1]=arguments[r];for(;n<e.length;){var s=e[n++],a=s.fn,u=s.fnCtx;a.call.apply(a,[u].concat(o))}}return this}},at.prototype={getDomNode:function(){return this._childNode.getDomNode()},ns:function(t){return t&&(this._ns=t),this},ctx:function(t){return t&&this._childNode.ctx(t),this},renderToDom:function(){return this._childNode.renderToDom(this._ns)},adoptDom:function(t){this._childNode.adoptDom(t,0)},patch:function(t){this._childNode.patch(t._childNode)},mount:function(){this._childNode.mount()},unmount:function(){this._childNode.unmount()}};var Qe=new ye,Xe=0,Ye=new st;Ye.getRootNodes=vt;var tn=Bt({onInit:function(){var t=this;this._addAttrs={onChange:null,onInput:function(e){t.onInput(e)}}},onRender:function(t){return new nt("input").attrs(Y(t,this._addAttrs))},onInput:function(t){var e=this.getAttrs(),n=e.onChange;if(n&&n(t),ot(),this.isMounted()){var i=this.getDomNode(),o=this.getAttrs(),r=o.value;"undefined"!=typeof r&&i.value!==r&&(i.value=r)}},onRefRequest:function(){return this.getDomNode()}}),en=new ye,nn=Bt({onInit:function(){var t=this;this._addAttrs={onChange:function(e){t.onChange(e)}}},onRender:function(t){return new nt("input").attrs(Y(t,this._addAttrs))},onMount:function(t){var e=t.name;e&&Vt(e,this)},onUpdate:function(t,e){var n=t.name,i=e.name;n!==i&&(i&&zt(i,this),n&&Vt(n,this))},onUnmount:function(){var t=this.getAttrs(),e=t.name;e&&zt(e,this)},onChange:function(t){var e=this.getAttrs(),n=e.onChange;if(n&&n(t),ot(),this.isMounted()){var i=this.getDomNode(),o=this.getAttrs(),r=o.name,s=o.checked;if("undefined"!=typeof s&&i.checked!==s)if(r){for(var a=en.get(r),u=a.length,h=0,c=void 0,d=void 0;h<u;)if(c=a[h++],d=c.getAttrs().checked,"undefined"!=typeof d){var l=c.getDomNode();d!==l.checked&&(l.checked=d)}}else i.checked=s}},onRefRequest:function(){return this.getDomNode()}}),on=Bt({onInit:function(){var t=this;this._addAttrs={onChange:function(e){t.onChange(e)}}},onRender:function(t){return new nt("input").attrs(Y(t,this._addAttrs))},onChange:function(t){var e=this.getAttrs(),n=e.onChange;if(n&&n(t),ot(),this.isMounted()){var i=this.getDomNode(),o=this.getAttrs(),r=o.checked;"undefined"!=typeof r&&i.checked!==r&&(i.checked=r)}},onRefRequest:function(){return this.getDomNode()}}),rn=Bt({onRender:function(t){return new nt("input").attrs(t)},onRefRequest:function(){return this.getDomNode()}});Ht.prototype={getDomNode:function(){return this._instance&&this._instance.getDomNode()},key:function(t){return this._key=t,this},attrs:function(t){if(this._attrs=this._attrs?Y(this._attrs,t):t,this._component===tn)switch(this._attrs.type){case"radio":this._component=nn;break;case"checkbox":this._component=on;break;case"file":this._component=rn}return this},children:function(t){return this._children=t,this},ctx:function(t){return this._ctx=t,this},ref:function(t){return this._ref=t,this},renderToDom:function(t){return this._getInstance().renderToDom(t)},renderToString:function(){return this._getInstance().renderToString()},adoptDom:function(t,e){return this._getInstance().adoptDom(t,e)},mount:function(){this._instance.getRootNode().mount(),this._instance.mount(),this._ref&&this._ref(this._instance.onRefRequest())},unmount:function(){this._instance&&(this._instance.getRootNode().unmount(),this._instance.unmount(),this._instance=null,this._ref&&this._ref(null))},clone:function(){var t=new Ht(this._component);return t._key=this._key,t._attrs=this._attrs,t._children=this._children,t._ctx=this._ctx,t._ref=this._ref,t},patch:function(t){var e=this._getInstance();this===t?e.patch(t._attrs,t._children,t._ctx):this.type===t.type&&this._component===t._component?(e.patch(t._attrs,t._children,t._ctx),t._instance=e):(Ee.replace(this,t),this._instance=null)},_getInstance:function(){return this._instance||(this._instance=new this._component(this._attrs,this._children,this._ctx))}},Kt.prototype={getDomNode:function(){return this._rootNode&&this._rootNode.getDomNode()},key:function(t){return this._key=t,this},attrs:function(t){return this._attrs=this._attrs?Y(this._attrs,t):t,this},children:function(t){return this._children=t,this},ctx:function(t){return this._ctx=t,this},renderToDom:function(t){return this._getRootNode().renderToDom(t)},renderToString:function(){return this._getRootNode().renderToString()},adoptDom:function(t,e){return this._getRootNode().adoptDom(t,e)},mount:function(){this._getRootNode().mount()},unmount:function(){this._rootNode&&(this._rootNode.unmount(),this._rootNode=null)},clone:function(){var t=new Kt(this._component);return t._key=this._key,t._attrs=this._attrs,t._children=this._children,t._ctx=this._ctx,t},patch:function(t){if(this===t){var e=this._getRootNode();this._rootNode=null,e.patch(this._getRootNode())}else this.type===t.type&&this._component===t._component?(this._getRootNode().patch(t._getRootNode()),this._rootNode=null):(Ee.replace(this,t),this._rootNode=null)},_getRootNode:function(){if(this._rootNode)return this._rootNode;var t=this._component(this._attrs,this._children,this._ctx)||Jt("!");return t.ctx(this._ctx),this._rootNode=t}},Wt.prototype={getDomNode:function(){return this._domNode},key:function(t){return this._key=t,this},children:function(t){return this._children=Gt(t),this},ctx:function(t){if(t!==qe){this._ctx=t;var e=this._children;if(e)for(var n=e.length,i=0;i<n;)e[i++].ctx(t)}return this},renderToDom:function(t){var e=this._children,n=[tt("!"),tt("!")],i=document.createDocumentFragment();if(i.appendChild(n[0]),e)for(var o=e.length,r=0;r<o;)i.appendChild(e[r++].renderToDom(t));return i.appendChild(n[1]),this._domNode=n,i},renderToString:function(){var t=this._children,e="<!---->";if(t)for(var n=t.length-1;n>=0;)e=t[n--].renderToString()+e;return"<!---->"+e},adoptDom:function(t,e){var n=[t[e++]],i=this._children;if(i)for(var o=i.length,r=0;r<o;)e=i[r++].adoptDom(t,e);return n.push(t[e]),this._domNode=n,e+1},mount:function(){var t=this._children;if(t)for(var e=0,n=t.length;e<n;)t[e++].mount()},unmount:function(){var t=this._children;if(t)for(var e=t.length,n=0;n<e;)t[n++].unmount()},clone:function(){var t=new Wt;return t._key=this._key,t._children=this._children,t._ctx=this._ctx,t},patch:function(t){this===t?this._patchChildren(t):this.type===t.type?(t._domNode=this._domNode,this._patchChildren(t)):Ee.replace(this,t)},_patchChildren:function(t){var e=this._children,n=t._children;if(e||n){if(!n||!n.length)return void(e&&e.length&&Ee.removeChildren(this));if(e&&e.length)J(this,t);else for(var i=n.length,o=0;o<i;)Ee.appendChild(t,n[o++])}}},Zt.prototype={getDomNode:function(){return this._domNode},key:function(t){return this._key=t,this},children:function(t){return this._children=$t(t),this},ctx:function(){return this},renderToDom:function(){var t=document.createDocumentFragment(),e=[tt("!"),tt("!")],n=this._children;return t.appendChild(e[0]),n&&t.appendChild(document.createTextNode(n)),t.appendChild(e[1]),this._domNode=e,t},renderToString:function(){return"<!---->"+(this._children||"")+"<!---->"},adoptDom:function(t,e){var n=[t[e++]];return this._children&&e++,n.push(t[e++]),this._domNode=n,e},mount:function(){},unmount:function(){},clone:function(){var t=new Zt;return t._key=this._key,t._children=this._children,t},patch:function(t){this!==t&&(this.type===t.type?(t._domNode=this._domNode,this._patchChildren(t)):Ee.replace(this,t))},_patchChildren:function(t){var e=this._children,n=t._children;e!==n&&(n?Ee.updateText(this,n,!1):e&&Ee.removeText(this))}};var sn=Bt({onInit:function(){var t=this;this._addAttrs={onChange:null,onInput:function(e){t.onInput(e)}}},onRender:function(t){return new nt("textarea").attrs(Y(t,this._addAttrs))},onInput:function(t){var e=this.getAttrs(),n=e.onChange;if(n&&n(t),ot(),this.isMounted()){var i=this.getDomNode(),o=this.getAttrs(),r=o.value;"undefined"!=typeof r&&i.value!==r&&(i.value=r)}},onRefRequest:function(){return this.getDomNode()}}),an=Bt({onInit:function(){var t=this;this._addAttrs={onChange:function(e){t.onChange(e)}}},onRender:function(t,e){return new nt("select").attrs(Y(t,this._addAttrs)).children(e)},onChange:function(t){var e=this.getAttrs(),n=e.onChange;if(n&&n(t),ot(),this.isMounted()){var i=this.getDomNode(),o=this.getAttrs(),r=o.value;"undefined"!=typeof r&&i.value!==r&&(i.value=r)}},onRefRequest:function(){return this.getDomNode()}}),un=function(t){return"<!--vidom-->"+t.renderToString()},hn=function(t){var e=Qt(t);return null===e||"object"!=typeof e||Array.isArray(e)||(e=[e]),e},cn=Bt();t.node=Jt,t.createComponent=Bt,t.renderToString=un,t.normalizeChildren=hn,t.IS_DEBUG=re,t.console=ie,t.Component=cn,t.mount=lt,t.mountSync=ft,t.unmount=_t,t.unmountSync=pt,t.getMountedRootNodes=vt,Object.defineProperty(t,"__esModule",{value:!0})});
