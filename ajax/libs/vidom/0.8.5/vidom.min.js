/**
 * Vidom
 * @author Filatov Dmitry <dfilatov@inbox.ru>
 * @version 0.8.5
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.vidom=t.vidom||{})}(this,function(t){"use strict";function e(t){t+="";for(var e=t.length,n=0;e--;)switch(t[e]){case"&":n|=1;break;case'"':n|=2}return 1&n&&(t=t.replace($t,"&amp;")),2&n&&(t=t.replace(Jt,"&quot;")),t}function n(t,e){for(var n=t.length,o=0;o<n;)if(t[o++]==e)return!0;return!1}function o(t){return t.replace(Qt,"$1-$2").toLowerCase()}function i(t,e,n){if("type"===e&&"INPUT"===t.tagName){var o=t.value;t.setAttribute(e,""+n),t.value=o}else t.setAttribute(te[e]||e,""+n)}function r(t,e,n){n?i(t,e,n):h(t,e)}function s(t,e,n){t[e]=n}function a(t,e,n){var o=t[e];for(var i in n)o[i]=null==n[i]?"":n[i]}function u(t,e,n){"value"===e&&"SELECT"===t.tagName?c(t,n):t[e]!==n&&(t[e]=n)}function h(t,e){t.removeAttribute(te[e]||e)}function d(t,e){"style"===e?t[e].cssText="":"value"===e&&"SELECT"===t.tagName?l(t):t[e]=m(t.tagName,e)}function c(t,e){var o=Array.isArray(e);if(o)for(var i=t.options,r=i.length,s=0,a=void 0;s<r;)a=i[s++],a.selected=null!=e&&n(e,a.value);else t.value=e}function l(t){for(var e=t.options,n=e.length,o=0;o<n;)e[o++].selected=!1}function f(t,n){return n===!1?"":(te[t]||t)+(n===!0?"":'="'+e(n)+'"')}function p(t,e){return e?t:""}function v(t,e){var n="",i=void 0;for(i in e)null!=e[i]&&(n+=o(i)+":"+e[i]+";");return n?t+'="'+n+'"':n}function m(t,e){var n=Yt[t]||(Yt[t]={});return e in n?n[e]:n[e]=document.createElement(t)[e]}function g(t,e){if(Array.isArray(t))y(e,t[1]);else if(Array.isArray(e)){for(var n=e[0],o=void 0,i=e[1];n!==i;)o=n.nextSibling,t.appendChild(n),n=o;t.appendChild(i)}else t.appendChild(e)}function _(t){if(Array.isArray(t)){for(var e=t[0],n=void 0,o=t[1],i=o.parentNode;e!==o;)n=e.nextSibling,i.removeChild(e),e=n;i.removeChild(o)}else t.parentNode.removeChild(t)}function y(t,e){if(Array.isArray(e)&&(e=e[0]),Array.isArray(t)){for(var n=t[0],o=void 0,i=t[1],r=i.parentNode;n!==i;)o=n.nextSibling,r.insertBefore(n,e),n=o;r.insertBefore(i,e)}else e.parentNode.insertBefore(t,e)}function C(t,e,n){if(n){Array.isArray(e)&&(e=e[1]);var o=e.nextSibling;o?y(t,o):g(e.parentNode,t)}else y(t,e)}function N(t,e){Array.isArray(t)?(y(e,t),_(t)):t.parentNode.replaceChild(e,t)}function A(t){if(Array.isArray(t))for(var e=t[0].nextSibling,n=void 0,o=t[1],i=o.parentNode;e!==o;)n=e.nextSibling,i.removeChild(e),e=n;else t.textContent=""}function x(t,e,n){if(Array.isArray(t)){var o=t[1],i=o.previousSibling;i===t[0]?o.parentNode.insertBefore(document.createTextNode(e),o):i.nodeValue=e}else if(n){var r=t.firstChild;r?r.nodeValue=e:t.textContent=e}else t.innerHTML=e}function D(t){if(Array.isArray(t)){var e=t[0].nextSibling;e.parentNode.removeChild(e)}else t.textContent=""}function b(t){var e="on"+t;if(e in document)return!0;var n=document.createElement("div");return n.setAttribute(e,"return;"),"function"==typeof n[e]||"wheel"===t&&document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0&&document.implementation.hasFeature("Events.wheel","3.0")}function k(t,e){this.type=t,this.target=e.target,this.nativeEvent=e,this._isPropagationStopped=!1,this._isDefaultPrevented=!1,this._isPersisted=!1}function w(t,e){var n=ue[t];return n&&!n._isPersisted?(n.target=e.target,n.nativeEvent=e,n._isPropagationStopped=!1,n._isDefaultPrevented=!1,n):ue[t]=new k(t,e)}function T(t,e){return t[he]||(e?null:t[he]=de++)}function S(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.type;if(Ae)for(var n=t.target,o=Ne[e].listenersCount,i=void 0,r=void 0,s=void 0,a=void 0;o&&n&&n!==document;){if((s=T(n,!0))&&(i=Ce.get(s),i&&(r=i[e])&&(r(a||(a=w(e,t))),!--o||a.isPropagationStopped())))return;n=n.parentNode}}function R(t){Ae&&Ce.get(T(t.currentTarget))[t.type](w(t.type,t))}function M(t,e,n){var o=Ne[e];if(o){o.set||(o.setup?o.setup():o.bubbles&&document.addEventListener(e,S,!1),o.set=!0);var i=T(t),r=Ce.get(i);r||Ce.set(i,r={}),r[e]||(o.bubbles?++o.listenersCount:t.addEventListener(e,R,!1)),r[e]=n}}function E(t,e){var n=Ne[e];n&&(n.bubbles?--n.listenersCount:t.removeEventListener(e,R))}function P(t,e){var n=T(t,!0);if(n){var o=Ce.get(n);o&&o[e]&&(o[e]=null,E(t,e))}}function I(t){var e=T(t,!0);if(e){var n=Ce.get(e);if(n){for(var o in n)n[o]&&E(t,o);Ce.delete(e)}}}function U(){Ae=!1}function L(){Ae=!0}function q(t){return Array.isArray(t)?F(t):t.namespaceURI===xe?null:t.namespaceURI}function F(t){return q((Array.isArray(t)?t[t.length-1]:t).parentNode)}function O(t,e){var n=t.getDomNode();ae.append(n,e.renderToDom(q(n))),e.mount()}function j(t,e){var n=e.getDomNode();ae.insertBefore(t.renderToDom(F(n)),n),t.mount()}function B(t){var e=t.getDomNode();t.unmount(),ae.remove(e)}function K(t,e,n){var o=document.activeElement;U(),ae.move(t.getDomNode(),e.getDomNode(),n),document.activeElement!==o&&o.focus(),L()}function H(t){for(var e=t.getDomNode(),n=t.children,o=n.length,i=0;i<o;)n[i++].unmount();ae.removeChildren(e)}function z(t,e){var n=t.getDomNode();t.unmount(),ae.replace(n,e.renderToDom(F(n))),e.mount()}function V(t,e,n){var o=t.getDomNode();De[e]?M(o,De[e],n):se(e).set(o,e,n)}function W(t,e){var n=t.getDomNode();De[e]?P(n,De[e]):se(e).remove(n,e)}function G(t,e,n){ae.updateText(t.getDomNode(),e,n)}function Z(t){ae.removeText(t.getDomNode())}function $(t,e){var n=void 0;if(e){var o=e+":"+t;n=ke[o]||(ke[o]=document.createElementNS(e,t))}else n=ke[t]||(ke[t]="!"===t?document.createComment(""):document.createElement(t));return n.cloneNode()}function J(t,e){var n=t.children,o=e.children,i=n.length,r=o.length;if(1===i&&1===r)return void n[0].patch(o[0]);for(var s=0,a=i-1,u=n[s],h=u.key,d=n[a],c=d.key,l=0,f=r-1,p=o[l],v=p.key,m=o[f],g=m.key,_=!1,y=!1,C=!1,N=!1,A=void 0,x=void 0,D=void 0,b={};s<=a&&l<=f;)b[s]?_=!0:b[a]?y=!0:h===v?(u.patch(p),_=!0,C=!0):c===g?(d.patch(m),y=!0,N=!0):null!=h&&h===g?(be.moveChild(u,d,!0),u.patch(m),_=!0,N=!0):null!=c&&c===v?(be.moveChild(d,u,!1),d.patch(p),y=!0,C=!0):null!=h&&null==v?(be.insertChild(p,u),C=!0):null==h&&null!=v?(be.removeChild(u),_=!0):(A||(A=Q(n,s,a)),null==(x=A[v])?be.insertChild(p,u):(D=n[x],b[x]=!0,be.moveChild(D,u,!1),D.patch(p)),C=!0),_&&(_=!1,++s<=a&&(u=n[s],h=u.key)),y&&(y=!1,--a>=s&&(d=n[a],c=d.key)),C&&(C=!1,++l<=f&&(p=o[l],v=p.key)),N&&(N=!1,--f>=l&&(m=o[f],g=m.key));for(;s<=a;)b[s]||be.removeChild(n[s]),++s;for(;l<=f;)f<r-1?be.insertChild(o[l],o[f+1]):be.appendChild(e,o[l]),++l}function Q(t,e,n){for(var o={},i=void 0;e<n;)i=t[e],null!=i.key&&(o[i.key]=e),++e;return o}function X(){}function Y(t){return this.key=t,this}function tt(t){return this._ref=t,this}function et(){this.type=Ie,this.key=null,this.children=null,this._domNode=null,this._ctx=we}function nt(t){if(null==t)return null;var e=Array.isArray(t)?t:[t];return e}function ot(t,e){var n={};for(var o in t)n[o]=t[o];for(var i in e)n[i]=e[i];return n}function it(t){this.type=Le,this.key=null,this.attrs=we,this.children=null,this._component=t,this._rootNode=null,this._ctx=we}function rt(){this.type=Pe,this.key=null,this.children=null,this._domNode=null}function st(t){return null==t||"string"==typeof t?t:t.toString()}function at(){for(var t=0;t<Fe.length;)Fe[t++]();Fe=[]}function ut(t){1===Fe.push(t)&&qe(at)}function ht(){this._listeners={}}function dt(t){this.type=Me,this._childNode=t,this._ns=null}function ct(t,e,n,o,i){var r=T(t),s=Oe.get(r),a=void 0;if(s&&s.tree){a=++s.id;var u=function(){if(s=Oe.get(r),s&&s.id===a){var t=s.tree,i=new dt(e);i.setNs(t._ns).setCtx(n),t.patch(i),s.tree=i,ft(o)}};i?u():ut(u)}else{if(Oe.set(r,s={tree:null,id:a=++je}),t.childNodes.length){var h=pt(t);if(h){var d=s.tree=new dt(e);return d.setNs(q(t)).setCtx(n),d.adoptDom(h),d.mount(),void ft(o)}t.textContent=""}var c=function(){var i=Oe.get(r);if(i&&i.id===a){var s=i.tree=new dt(e);s.setNs(q(t)).setCtx(n),ae.append(t,s.renderToDom()),s.mount(),ft(o)}};i?c():ut(c)}}function lt(t,e,n){var o=T(t),i=Oe.get(o);i?!function(){var t=++i.id,r=function(){if(i=Oe.get(o),i&&i.id===t){Oe.delete(o);var n=i.tree;if(n){var r=n.getDomNode();n.unmount(),ae.remove(r)}ft(e)}};i.tree?n?r():ut(r):n||ft(e)}():n||ft(e)}function ft(t){t&&t()}function pt(t){for(var e=t.childNodes,n=e.length,o=0,i=void 0,r=void 0;o<n;)r=e[o++],i?i.push(r):r.nodeType===Node.COMMENT_NODE&&"vidom"===r.textContent&&(i=[]);return i}function vt(t,e,n,o){"function"==typeof n&&(o=n,n=this),ct(t,e,n,o,!1)}function mt(t,e,n){ct(t,e,n,null,!0)}function gt(t,e){lt(t,e,!1)}function _t(t){lt(t,null,!0)}function yt(){var t=[];return Oe.forEach(function(e){var n=e.tree;n&&t.push(n)}),t}function Ct(){this.__isMounted=!0,this.onMount()}function Nt(){this.__isMounted=!1,this.onUnmount()}function At(t,e,n){if(this.isMounted()){t=this.__buildAttrs(t);var o=this.attrs,i=this.children;if(o!==t||i!==e){var r=this.__isUpdating;this.__isUpdating=!0,o!==t&&(this.attrs=t,this.onAttrsChange(o)),i!==e&&(this.children=e,this.onChildrenChange(i)),this.__isUpdating=r}if(this.context!==n&&(this.context=n),!this.__isUpdating){var s=this.shouldUpdate(o,i,this.__prevState);if(s){var a=this.__rootNode;this.__rootNode=this.render(),a.patch(this.__rootNode),this.onUpdate(o,i,this.__prevState)}}}}function xt(){return!0}function Dt(t){return this.__rootNode.renderToDom(t)}function bt(){return this.__rootNode.renderToString()}function kt(t,e){return this.__rootNode.adoptDom(t,e)}function wt(){return this.__rootNode.getDomNode()}function Tt(){return we}function St(t){var e=void 0;this.__rootNode?(this.update(this.state===this.__prevState?Rt:null),e=ot(this.state,t)):e=t===we?t:ot(this.state,t),this.state=e}function Rt(){this.__prevState=this.state}function Mt(){var t=this.onRender()||Vt("!"),e=this.onChildContextRequest(),n=e===we?this.context:this.context===we?e:ot(this.context,e);return t.setCtx(n),t}function Et(t){var e=this;this.__isUpdating?t&&ut(function(){return t.call(e)}):(this.__isUpdating=!0,ut(function(){if(e.isMounted()){e.__isUpdating=!1;e.__rootNode;e.patch(e.attrs,e.children,e.context),t&&t.call(e)}}))}function Pt(){return this.__rootNode}function It(){return this.__isMounted}function Ut(){return this}function Lt(t){if(t===this.attrs)return t;var e=this.constructor.defaultAttrs,n=t===we?e||t:e?ot(e,t):t;return n}function qt(t,e){var n=function(t,e,n){this.attrs=this.__buildAttrs(t),this.children=e,this.state=we,this.context=n,this.__isMounted=!1,this.__isUpdating=!1,this.onInit(),this.__prevState=this.state,this.__rootNode=this.render()},o={constructor:n,onInit:X,mount:Ct,unmount:Nt,onMount:X,onUnmount:X,onAttrsChange:X,onChildrenChange:X,shouldUpdate:xt,onUpdate:X,isMounted:It,setState:St,renderToDom:Dt,renderToString:bt,adoptDom:kt,getDomNode:wt,getRootNode:Pt,render:Mt,onRender:X,update:Et,patch:At,onChildContextRequest:Tt,onRefRequest:Ut,__buildAttrs:Lt};for(var i in t)o[i]=t[i];n.prototype=o;for(var r in e)n[r]=e[r];return n.__vidom__component__=!0,n}function Ft(t,e){var n=He.get(t);n?n.push(e):He.set(t,[e])}function Ot(t,e){for(var n=He.get(t),o=n.length,i=0;i<o;){if(n[i]===e)return void(1===o?He.delete(t):n.splice(i,1));i++}}function jt(t){this.type=Ue,this.key=null,this.attrs=we,this.children=null,this._component=t,this._instance=null,this._ctx=we,this._ref=null}function Bt(t){t+="";for(var e=t.length,n=0;e--;)switch(t[e]){case"&":n|=1;break;case"<":n|=2;break;case">":n|=4}return 1&n&&(t=t.replace(Ge,"&amp;")),2&n&&(t=t.replace(Ze,"&lt;")),4&n&&(t=t.replace($e,"&gt;")),t}function Kt(t,e,n){var o=Qe[e]||"div",i=Xe[o]||(Xe[o]=document.createElement(o));if(!n||!Je[n]||Je[n]===e)return i.innerHTML=t,i.removeChild(i.firstChild);var r=Je[n];return i.innerHTML="<"+r+' xmlns="'+n+'">'+t+"</"+r+">",i.removeChild(i.firstChild).firstChild}function Ht(t){this.type=Ee,this.tag=t,this.key=null,this.attrs=we,this.children=null,this._domNode=null,this._ns=null,this._escapeChildren=!0,this._ctx=we,this._ref=null}function zt(t){if(null==t)return null;var e=typeof t;if("object"===e){var n=Array.isArray(t)?t:[t];return n}return"string"===e?t:t.toString()}function Vt(t){switch(typeof t){case"string":switch(t){case"fragment":return new et;case"text":return new rt;case"input":return new jt(Ke);case"textarea":return new jt(nn);case"select":return new jt(on);default:return new Ht(t)}case"function":return t.__vidom__component__?new jt(t):new it(t)}}function Wt(t){return"<!--vidom-->"+t.renderToString()}function Gt(t){if(null==t)return null;var e=typeof t;if("object"!==e)return"string"===e?t||null:""+t;if(!Array.isArray(t))return t;if(!t.length)return null;for(var n=t,o=0,i=!1,r=void 0,s=t.length,a={};o<s;){if(r=o in a?a[o]:Gt(t[o]),null===r)null!==n&&(i?n===t&&(n=t.slice(0,o)):n=null);else if("object"==typeof r)Array.isArray(r)?n=i?(n===t?n.slice(0,o):Array.isArray(n)?n:[Zt(n)]).concat(r):r:n!==t?i?Array.isArray(n)?n.push(r):n=[Zt(n),r]:n=r:r!==t[o]&&(i?(n=n.slice(0,o),n.push(r)):n=r),i=!0;else{for(var u=void 0,h=o;++h<s;)if(u=a[h]=Gt(t[h]),"string"==typeof u)r+=u;else if(null!==u)break;i?Array.isArray(n)?(n===t&&(n=n.slice(0,o)),n.push(Zt(r))):n=[n,Zt(r)]:n=""+r,o=h-1,i=!0}++o}return n}function Zt(t){return"object"==typeof t?t:Vt("text").setChildren(t)}var $t=/&/g,Jt=/"/g,Qt=/([^A-Z]+)([A-Z])/g,Xt=!1,Yt={},te={acceptCharset:"accept-charset",className:"class",htmlFor:"for",httpEquiv:"http-equiv",autoCapitalize:"autocapitalize",autoComplete:"autocomplete",autoCorrect:"autocorrect",autoFocus:"autofocus",autoPlay:"autoplay",encType:"encoding",hrefLang:"hreflang",radioGroup:"radiogroup",spellCheck:"spellcheck",srcDoc:"srcdoc",srcSet:"srcset",tabIndex:"tabindex"},ee={set:i,remove:h,toString:f},ne={set:r,remove:h,toString:p},oe={set:s,remove:d,toString:f},ie={set:s,remove:d,toString:p},re={checked:ie,controls:oe,disabled:ne,id:oe,ismap:ne,loop:oe,multiple:ie,muted:oe,open:ne,readOnly:ie,selected:ie,srcDoc:oe,style:{set:a,remove:d,toString:v},value:{set:u,remove:d,toString:f}},se=function(t){return re[t]||ee},ae={append:g,remove:_,insertBefore:y,move:C,replace:N,removeChildren:A,updateText:x,removeText:D};k.prototype={stopPropagation:function(){this._isPropagationStopped=!0;var t=this.nativeEvent;t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},isPropagationStopped:function(){return this._isPropagationStopped},preventDefault:function(){this._isDefaultPrevented=!0;var t=this.nativeEvent;t.preventDefault?t.preventDefault():t.returnValue=!1},isDefaultPrevented:function(){return this._isDefaultPrevented},persist:function(){this._isPersisted=!0}};var ue={},he="__vidom__id__",de=1,ce=void 0;"undefined"==typeof Map?(ce=function(){this._storage={}},ce.prototype={has:function(t){return t in this._storage},get:function(t){return this._storage[t]},set:function(t,e){return this._storage[t]=e,this},delete:function(t){return delete this._storage[t]},forEach:function(t,e){var n=this._storage;for(var o in n)t.call(e,n[o],o,this)}}):ce=Map;var le=ce,fe="undefined"==typeof navigator?"":navigator.userAgent,pe=fe.indexOf("Trident")>-1,ve=fe.indexOf("Edge")>-1,me=/iPad|iPhone|iPod/.test(fe)&&"undefined"==typeof MSStream,ge=["click","mousedown","mousemove","mouseout","mouseover","mouseup"],_e=["blur","change","contextmenu","copy","cut","dblclick","drag","dragend","dragenter","dragleave","dragover","dragstart","drop","focus","input","keydown","keypress","keyup","paste","submit","touchcancel","touchend","touchmove","touchstart","wheel"],ye=["canplay","canplaythrough","complete","durationchange","emptied","ended","error","load","loadeddata","loadedmetadata","loadstart","mouseenter","mouseleave","pause","play","playing","progress","ratechange","scroll","seeked","seeking","select","stalled","suspend","timeupdate","volumechange","waiting"];me?ye=[].concat(ye,ge):_e=[].concat(_e,ge);var Ce=new le,Ne={},Ae=!0;"undefined"!=typeof document&&!function(){for(var t={focus:"focusin",blur:"focusout"},e=0,n=void 0;e<_e.length;)n=_e[e++],Ne[n]={type:n,bubbles:!0,listenersCount:0,set:!1,setup:t[n]?b(t[n])?function(){var e=this.type;document.addEventListener(t[e],function(t){S(t,e)})}:function(){document.addEventListener(this.type,S,!0)}:null};for(e=0;e<ye.length;)Ne[ye[e++]]={type:n,bubbles:!1,set:!1}}();var xe="http://www.w3.org/1999/xhtml",De={onBlur:"blur",onCanPlay:"canplay",onCanPlayThrough:"canplaythrough",onChange:"change",onClick:"click",onComplete:"complete",onContextMenu:"contextmenu",onCopy:"copy",onCut:"cut",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragEnter:"dragenter",onDragLeave:"dragleave",onDragOver:"dragover",onDragStart:"dragstart",onDrop:"drop",onDurationChange:"durationchange",onEmptied:"emptied",onEnded:"ended",onError:"error",onFocus:"focus",onInput:"input",onKeyDown:"keydown",onKeyPress:"keypress",onKeyUp:"keyup",onLoad:"load",onLoadedData:"loadeddata",onLoadedMetadata:"loadedmetadata",onLoadStart:"loadstart",onMouseDown:"mousedown",onMouseEnter:"mouseenter",onMouseLeave:"mouseleave",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onPaste:"paste",onPause:"pause",onPlay:"play",onPlaying:"playing",onProgress:"progress",onRateChange:"ratechange",onScroll:"scroll",onSeeked:"seeked",onSeeking:"seeking",onSelect:"select",onStalled:"stalled",onSubmit:"submit",onSuspend:"suspend",onTimeUpdate:"timeupdate",onTouchCancel:"touchcancel",onTouchEnd:"touchend",onTouchMove:"touchmove",onTouchStart:"touchstart",onVolumeChange:"volumechange",onWaiting:"waiting",onWheel:"wheel"},be={appendChild:O,insertChild:j,removeChild:B,moveChild:K,removeChildren:H,replace:z,updateAttr:V,removeAttr:W,updateText:G,removeText:Z},ke={},we={},Te="undefined"==typeof console?null:console,Se={},Re={log:"",info:"",warn:"Warning!",error:"Error!"};["log","info","warn","error"].forEach(function(t){Se[t]=Te?Te[t]?function(e,n,o,i,r){var s=Re[t];switch(arguments.length){case 1:Te[t](s,e);break;case 2:Te[t](s,e,n);break;case 3:Te[t](s,e,n,o);break;case 4:Te[t](s,e,n,o,i);break;case 5:Te[t](s,e,n,o,i,r)}}:function(){Te.log.apply(Te,arguments)}:X});var Me=1,Ee=2,Pe=3,Ie=4,Ue=5,Le=6;et.prototype={getDomNode:function(){return this._domNode},setKey:Y,setChildren:function(t){return this.children=nt(t),this},setCtx:function(t){if(t!==we){this._ctx=t;var e=this.children;if(e)for(var n=e.length,o=0;o<n;)e[o++].setCtx(t)}return this},renderToDom:function(t){var e=this.children,n=[$("!"),$("!")],o=document.createDocumentFragment();if(o.appendChild(n[0]),e)for(var i=e.length,r=0;r<i;)o.appendChild(e[r++].renderToDom(t));return o.appendChild(n[1]),this._domNode=n,o},renderToString:function(){var t=this.children,e="<!---->";if(t)for(var n=t.length-1;n>=0;)e=t[n--].renderToString()+e;return"<!---->"+e},adoptDom:function(t,e){var n=[t[e++]],o=this.children;if(o)for(var i=o.length,r=0;r<i;)e=o[r++].adoptDom(t,e);return n.push(t[e]),this._domNode=n,e+1},mount:function(){var t=this.children;if(t)for(var e=0,n=t.length;e<n;)t[e++].mount()},unmount:function(){var t=this.children;if(t)for(var e=t.length,n=0;n<e;)t[n++].unmount()},clone:function(){var t=new et;return t.key=this.key,t.children=this.children,t._ctx=this._ctx,t},patch:function(t){this===t?this._patchChildren(t):this.type===t.type?(t._domNode=this._domNode,this._patchChildren(t)):be.replace(this,t)},_patchChildren:function(t){var e=this.children,n=t.children;if(e||n){if(!n||!n.length)return void(e&&e.length&&be.removeChildren(this));if(e&&e.length)J(this,t);else for(var o=n.length,i=0;i<o;)be.appendChild(t,n[i++])}}};it.prototype={getDomNode:function(){return this._rootNode&&this._rootNode.getDomNode()},setKey:Y,setAttrs:function(t){return this.attrs=this.attrs===we?t:ot(this.attrs,t),this},setChildren:function(t){return this.children=t,this},setCtx:function(t){return this._ctx=t,this},renderToDom:function(t){return this._getRootNode().renderToDom(t)},renderToString:function(){return this._getRootNode().renderToString()},adoptDom:function(t,e){return this._getRootNode().adoptDom(t,e)},mount:function(){this._getRootNode().mount()},unmount:function(){this._rootNode&&(this._rootNode.unmount(),this._rootNode=null)},clone:function(){var t=new it(this._component);return t.key=this.key,t.attrs=this.attrs,t.children=this.children,t._ctx=this._ctx,t},patch:function(t){if(this===t){var e=this._getRootNode();this._rootNode=null,e.patch(this._getRootNode())}else this.type===t.type&&this._component===t._component?(this._getRootNode().patch(t._getRootNode()),this._rootNode=null):(be.replace(this,t),this._rootNode=null)},_getRootNode:function(){if(this._rootNode)return this._rootNode;var t=this._component(this.attrs,this.children,this._ctx)||Vt("!");return t.setCtx(this._ctx),this._rootNode=t}};rt.prototype={getDomNode:function(){return this._domNode},setKey:Y,setChildren:function(t){return this.children=st(t),this},setCtx:function(){return this},renderToDom:function(){var t=document.createDocumentFragment(),e=[$("!"),$("!")],n=this.children;return t.appendChild(e[0]),n&&t.appendChild(document.createTextNode(n)),t.appendChild(e[1]),this._domNode=e,t},renderToString:function(){return"<!---->"+(this.children||"")+"<!---->"},adoptDom:function(t,e){var n=[t[e++]];return this.children&&e++,n.push(t[e++]),this._domNode=n,e},mount:X,unmount:X,clone:function(){var t=new rt;return t.key=this.key,t.children=this.children,t},patch:function(t){this!==t&&(this.type===t.type?(t._domNode=this._domNode,this._patchChildren(t)):be.replace(this,t))},_patchChildren:function(t){var e=this.children,n=t.children;e!==n&&(n?be.updateText(this,n,!1):e&&be.removeText(this))}};var qe="undefined"!=typeof window&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame)||function(t){setTimeout(t,1e3/60)},Fe=[];ht.prototype={on:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return(this._listeners[t]||(this._listeners[t]=[])).push({fn:e,fnCtx:n}),this},off:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=this._listeners[t];if(o)for(var i=0,r=void 0;i<o.length;){if(r=o[i],r.fn===e&&r.fnCtx===n){o.splice(i,1);break}i++}return this},emit:function(t){var e=this._listeners[t];if(e){for(var n=0,o=arguments.length,i=Array(o>1?o-1:0),r=1;r<o;r++)i[r-1]=arguments[r];for(;n<e.length;){var s=e[n++],a=s.fn,u=s.fnCtx;a.call.apply(a,[u].concat(i))}}return this}},dt.prototype={getDomNode:function(){return this._childNode.getDomNode()},setNs:function(t){return t&&(this._ns=t),this},setCtx:function(t){return t&&this._childNode.setCtx(t),this},renderToDom:function(){return this._childNode.renderToDom(this._ns)},adoptDom:function(t){this._childNode.adoptDom(t,0)},patch:function(t){this._childNode.patch(t._childNode)},mount:function(){this._childNode.mount()},unmount:function(){this._childNode.unmount()}};var Oe=new le,je=0,Be=new ht;Be.getRootNodes=yt;var Ke=qt({onInit:function(){var t=this;this._addAttrs={onChange:null,onInput:function(e){t.onInput(e)}}},onRender:function(){return new Ht("input").setAttrs(ot(this.attrs,this._addAttrs))},onInput:function(t){var e=this.attrs.onChange;if(e&&e(t),at(),this.isMounted()){var n=this.getDomNode(),o=this.attrs.value;"undefined"!=typeof o&&n.value!==o&&(n.value=o)}},onRefRequest:function(){return this.getDomNode()}}),He=new le,ze=qt({onInit:function(){var t=this;this._addAttrs={onChange:function(e){t.onChange(e)}}},onRender:function(){return new Ht("input").setAttrs(ot(this.attrs,this._addAttrs))},onMount:function(){var t=this.attrs.name;t&&Ft(t,this)},onUpdate:function(t){var e=t.name,n=this.attrs.name;n!==e&&(e&&Ot(e,this),n&&Ft(n,this))},onUnmount:function(){var t=this.attrs.name;t&&Ot(t,this)},onChange:function(t){var e=this.attrs.onChange;if(e&&e(t),at(),this.isMounted()){var n=this.getDomNode(),o=this.attrs,i=o.name,r=o.checked;if("undefined"!=typeof r&&n.checked!==r)if(i){for(var s=He.get(i),a=s.length,u=0,h=void 0,d=void 0;u<a;)if(h=s[u++],d=h.attrs.checked,"undefined"!=typeof d){var c=h.getDomNode();d!==c.checked&&(c.checked=d)}}else n.checked=r}},onRefRequest:function(){return this.getDomNode()}}),Ve=qt({onInit:function(){var t=this;this._addAttrs={onChange:function(e){t.onChange(e)}}},onRender:function(){return new Ht("input").setAttrs(ot(this.attrs,this._addAttrs))},onChange:function(t){var e=this.attrs.onChange;if(e&&e(t),at(),this.isMounted()){var n=this.getDomNode(),o=this.attrs.checked;"undefined"!=typeof o&&n.checked!==o&&(n.checked=o)}},onRefRequest:function(){return this.getDomNode()}}),We=qt({onRender:function(){return new Ht("input").setAttrs(this.attrs)},onRefRequest:function(){return this.getDomNode()}});jt.prototype={getDomNode:function(){return this._instance&&this._instance.getDomNode()},setKey:Y,setRef:tt,setAttrs:function(t){if(this.attrs=this.attrs===we?t:ot(this.attrs,t),this._component===Ke)switch(this.attrs.type){case"radio":this._component=ze;break;case"checkbox":this._component=Ve;break;case"file":this._component=We}return this},setChildren:function(t){return this.children=t,this},setCtx:function(t){return this._ctx=t,this},renderToDom:function(t){return this._getInstance().renderToDom(t)},renderToString:function(){return this._getInstance().renderToString()},adoptDom:function(t,e){return this._getInstance().adoptDom(t,e)},mount:function(){this._instance.getRootNode().mount(),this._instance.mount(),this._ref&&this._ref(this._instance.onRefRequest())},unmount:function(){this._instance&&(this._instance.getRootNode().unmount(),this._instance.unmount(),this._instance=null,this._ref&&this._ref(null))},clone:function(){var t=new jt(this._component);return t.key=this.key,t.attrs=this.attrs,t.children=this.children,t._ctx=this._ctx,t._ref=this._ref,t},patch:function(t){var e=this._getInstance();this===t?e.patch(t.attrs,t.children,t._ctx):this.type===t.type&&this._component===t._component?(e.patch(t.attrs,t.children,t._ctx),t._instance=e,this._patchRef(t)):(be.replace(this,t),this._instance=null)},_patchRef:function(t){this._ref?this._ref!==t._ref&&(this._ref(null),t._ref&&t._ref(t._instance.onRefRequest())):t._ref&&t._ref(t._instance.onRefRequest())},_getInstance:function(){return this._instance||(this._instance=new this._component(this.attrs,this.children,this._ctx))}};var Ge=/&/g,Ze=/</g,$e=/>/g,Je={"http://www.w3.org/2000/svg":"svg","http://www.w3.org/1998/Math/MathML":"math"},Qe={thead:"table",tbody:"table",tfoot:"table",tr:"tbody",td:"tr"},Xe={},Ye={area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,menuitem:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},tn=pe||ve,en=16;Ht.prototype={getDomNode:function(){return this._domNode},setKey:Y,setRef:tt,setNs:function(t){return this._ns=t,this},setAttrs:function(t){return this.attrs=this.attrs===we?t:ot(this.attrs,t),this},setChildren:function(t){return this.children=zt(t),this},setHtml:function(t){return this.children=t,this._escapeChildren=!1,this},setCtx:function(t){if(t!==we){this._ctx=t;var e=this.children;if(e&&"string"!=typeof e)for(var n=e.length,o=0;o<n;)e[o++].setCtx(t)}return this},renderToDom:function(t){var e=this.tag,n=this.children,o=this._ns||t;if(tn&&n&&"string"!=typeof n){var i=Kt(this.renderToString(),e,o);return this.adoptDom([i],0),i}var r=this._domNode=$(e,o),s=this.attrs;if(n)if("string"==typeof n)this._escapeChildren?r.textContent=n:r.innerHTML=n;else for(var a=0,u=n.length;a<u;)r.appendChild(n[a++].renderToDom(o));if(s!==we){var h=void 0,d=void 0;for(h in s)null!=(d=s[h])&&(De[h]?M(r,De[h],d):se(h).set(r,h,d))}return r},renderToString:function(){var t=this.tag;if("!"===t)return"<!---->";var e=this._ns,o=this.attrs,i=this.children,r="<"+t;if(e&&(r+=' xmlns="'+e+'"'),o!==we){var s=void 0,a=void 0,u=void 0;for(s in o)if(a=o[s],null!=a){if("value"===s)switch(t){case"textarea":i=a;continue;case"select":this.setCtx({value:a,multiple:o.multiple});continue;case"option":var h=this._ctx;(h.multiple?n(h.value,a):h.value===a)&&(r+=" "+se("selected").toString("selected",!0))}!De[s]&&(u=se(s).toString(s,a))&&(r+=" "+u)}}if(Ye[t])r+="/>";else{if(r+=">",i)if("string"==typeof i)r+=this._escapeChildren?Bt(i):i;else for(var d=0,c=i.length;d<c;)r+=i[d++].renderToString();r+="</"+t+">"}return r},adoptDom:function(t,e){var n=this._domNode=t[e],o=this.attrs,i=this.children;if(o!==we){var r=void 0,s=void 0;for(r in o)null!=(s=o[r])&&De[r]&&M(n,De[r],s)}if(i&&"string"!=typeof i){var a=0,u=i.length;if(u)for(var h=n.childNodes,d=0;a<u;)d=i[a++].adoptDom(h,d)}return e+1},mount:function(){var t=this.children;if(t&&"string"!=typeof t)for(var e=0,n=t.length;e<n;)t[e++].mount();this._ref&&this._ref(this._domNode)},unmount:function(){var t=this.children;if(t&&"string"!=typeof t)for(var e=0,n=t.length;e<n;)t[e++].unmount();I(this._domNode),this._domNode=null,this._ref&&this._ref(null)},clone:function(){var t=new Ht(this.tag);return t.key=this.key,t.attrs=this.attrs,t.children=this.children,t._sets=en,t._ns=this._ns,t._escapeChildren=this._escapeChildren,t._ctx=this._ctx,t._ref=this._ref,t},patch:function(t){this===t?this._patchChildren(t):this.type===t.type&&this.tag===t.tag&&this._ns===t._ns?(t._domNode=this._domNode,this._patchAttrs(t),this._patchChildren(t),this._patchRef(t)):be.replace(this,t)},_patchChildren:function(t){var e=this.children,n=t.children;if(e||n){var o="string"==typeof e,i="string"==typeof n;if(i)return o?void(e!==n&&be.updateText(this,n,t._escapeChildren)):(e&&e.length&&be.removeChildren(this),void(n&&be.updateText(this,n,t._escapeChildren)));if(!n||!n.length)return void(e&&(o?be.removeText(this):e.length&&be.removeChildren(this)));if(o&&e&&be.removeText(this),!o&&e&&e.length)J(this,t);else for(var r=n.length,s=0;s<r;)be.appendChild(t,n[s++])}},_patchAttrs:function(t){var e=this.attrs,n=t.attrs;if(e!==n){var o=void 0;if(n!==we){var i=void 0,r=void 0,s=void 0,a=void 0;for(o in n)r=n[o],e===we||null==(i=e[o])?null!=r&&be.updateAttr(this,o,r):null==r?be.removeAttr(this,o):"object"==typeof r&&"object"==typeof i?(a=Array.isArray(r),s=Array.isArray(i),a||s?a&&s?this._patchAttrArr(o,i,r):be.updateAttr(this,o,r):this._patchAttrObj(o,i,r)):i!==r&&be.updateAttr(this,o,r)}if(e!==we)for(o in e)n!==we&&o in n||null==e[o]||be.removeAttr(this,o)}},_patchAttrArr:function(t,e,n){if(e!==n){var o=e.length,i=!1;if(o===n.length)for(var r=0;!i&&r<o;)e[r]!=n[r]&&(i=!0),++r;else i=!0;i&&be.updateAttr(this,t,n)}},_patchAttrObj:function(t,e,n){if(e!==n){var o={},i=!1;for(var r in n)e[r]!=n[r]&&(i=!0,o[r]=n[r]);for(var s in e)null==e[s]||s in n||(i=!0,o[s]=null);i&&be.updateAttr(this,t,o)}},_patchRef:function(t){this._ref?this._ref!==t._ref&&(this._ref(null),t._ref&&t._ref(t._domNode)):t._ref&&t._ref(t._domNode)}};var nn=qt({onInit:function(){var t=this;this._addAttrs={onChange:null,onInput:function(e){t.onInput(e)}}},onRender:function(){return new Ht("textarea").setAttrs(ot(this.attrs,this._addAttrs))},onInput:function(t){var e=this.attrs.onChange;if(e&&e(t),at(),this.isMounted()){var n=this.getDomNode(),o=this.attrs.value;"undefined"!=typeof o&&n.value!==o&&(n.value=o)}},onRefRequest:function(){return this.getDomNode()}}),on=qt({onInit:function(){var t=this;this._addAttrs={onChange:function(e){t.onChange(e)}}},onRender:function(){return new Ht("select").setAttrs(ot(this.attrs,this._addAttrs)).setChildren(this.children)},onChange:function(t){var e=t.target,o=this.attrs,i=o.onChange,r=o.multiple;if(i)if(r){for(var s=[],a=e.options,u=a.length,h=0,d=void 0;h<u;)d=a[h++],d.selected&&s.push(d.value);i(t,s)}else i(t);if(at(),this.isMounted()){var c=this.attrs,l=c.value,f=c.multiple;if("undefined"!=typeof l)if(f)for(var p=e.options,v=p.length,m=0,g=void 0;m<v;)g=p[m++],g.selected=n(l,g.value);else e.value!=l&&(e.value=l)}},onRefRequest:function(){return this.getDomNode()}}),rn=qt();t.node=Vt,t.createComponent=qt,t.renderToString=Wt,t.normalizeChildren=Gt,t.IS_DEBUG=Xt,t.console=Se,t.Component=rn,t.mount=vt,t.mountSync=mt,t.unmount=gt,t.unmountSync=_t,t.getMountedRootNodes=yt,Object.defineProperty(t,"__esModule",{value:!0})});
