function addElemClass(t,e,a){"SVG"==t?e.setAttribute("class",a):e.className+=" "+a}function strftime(t,e){return e.formatDate(t)}function getLeft(t){return parseInt(t.style.left)}function getEndDate(t){return t[t.length-1]}function isFifthDay(t){var e=t.getDate();return(1==e||e%5===0)&&30!=e}function isHalfMonth(t){var e=t.getDate();return 1==e||15==e}function prevMonth(t){var e=new Date(t.getTime()-DAY_IN_MILLISECONDS);return new Date(e.getFullYear(),e.getMonth(),1)}function nextMonth(t){return new Date(t.getFullYear(),t.getMonth()+1,1)}function prevQuarter(t){var e=new Date(t.getTime()-DAY_IN_MILLISECONDS),a=e.getMonth();return new Date(e.getFullYear(),a-a%3,1)}function nextQuarter(t){var e=t.getMonth();return new Date(t.getFullYear(),e-e%3+3,1)}function backWeek(t){return new Date(t.getTime()-7*DAY_IN_MILLISECONDS)}function forwardWeek(t){return new Date(t.getTime()+7*DAY_IN_MILLISECONDS)}function Chronoline(t,e,a){this.VERSION="0.1.2";var n={defaultStartDate:null,startDate:null,endDate:null,visibleSpan:2592e6,timelinePadding:0,fitVisibleSpan:!1,topMargin:40,eventHeight:5,eventMargin:4,dateLabelHeight:50,hashLength:4,minEventsHeight:40,maxEventsHeight:1e3,hashColor:"#b8b8b8",eventAttrs:{fill:"#0055e1",stroke:"#0055e1","stroke-width":2},hashInterval:null,labelInterval:null,labelFormat:"%d",subLabel:"month",subLabelMargin:2,subLabelAttrs:{"font-weight":"bold"},floatingSubLabels:!0,subSubLabel:"year",subSubLabelMargin:2,subSubLabelAttrs:{"font-weight":"bold"},floatingSubSubLabels:!0,fontAttrs:{"font-size":10,fill:"#000000"},scrollable:!0,scrollLeft:backWeek,scrollRight:forwardWeek,animated:!1,tooltips:!1,markToday:"line",todayAttrs:{stroke:"#484848"},sections:null,floatingSectionLabels:!0,sectionLabelAttrs:{},sectionLabelsOnHover:!0,draggable:!1,continuousScroll:!0,continuousScrollSpeed:1,eventClick:null,eventDblClick:null,sectionClick:null,sectionDblClick:null,backgroundClick:null,backgroundDblClick:null},r=this;for(var i in n)r[i]=n[i];for(var i in a)r[i]=a[i];r.floatingSectionLabels&=null!==r.sections,r.sectionLabelsOnHover&=null!==r.sections,r.originalStartDate=r.startDate,r.originalEndDate=r.endDate,r.originalDefaultStartDate=r.defaultStartDate,r.domElement=t,r.wrapper=document.createElement("div"),r.wrapper.className="chronoline-wrapper",r.domElement.appendChild(r.wrapper),r.sortEvents=function(t,e){t=t.dates,e=e.dates;var a=t[t.length-1].getTime(),n=e[e.length-1].getTime();return a!=n?a-n:t[0].getTime()-e[0].getTime()};for(var o=0;o<e.length;o++)for(var l=0;l<e[o].dates.length;l++)e[o].dates[l]=new Date(e[o].dates[l].getTime()),e[o].dates[l].stripTime();if(r.events=e,r.events.sort(r.sortEvents),null!==r.sections){for(var o=0;o<r.sections.length;o++)for(var l=0;l<r.sections[o].dates.length;l++)r.sections[o].dates[l]=new Date(r.sections[o].dates[l].getTime()),r.sections[o].dates[l].stripTime();r.sections.sort(r.sortEvents)}r.pxToMs=function(t){return r.startTime+t/r.pxRatio},r.msToPx=function(t){return(t-r.startTime)*r.pxRatio},r.resize=function(t){r.visibleSpan=t,r.init()},r.zoom=function(t){r.resize(r.visibleSpan/t)},r.init=function(){if(r.today=new Date(Date.now()),r.today.stripTime(),r.startDate=r.originalStartDate,r.endDate=r.originalEndDate,r.defaultStartDate=r.originalDefaultStartDate,null===r.defaultStartDate&&(r.defaultStartDate=r.today),null===r.startDate)if(r.events.length>0){r.startDate=r.events[0].dates[0];for(var t=1;t<r.events.length;t++)r.events[t].dates[0]<r.startDate&&(r.startDate=r.events[t].dates[0])}else{if(!(r.sections.length>0))return;r.startDate=r.sections[0].dates[0];for(var t=0;t<r.sections.length;t++)r.sections[t].dates[0]<r.startDate&&(r.startDate=r.sections[t].dates[0])}if(r.startDate.stripTime(),r.startDate>r.defaultStartDate&&(r.startDate=r.defaultStartDate),r.startDate=new Date(r.startDate.getTime()-r.timelinePadding),r.startTime=r.startDate.getTime(),null===r.endDate)if(r.events.length>0){r.endDate=getEndDate(r.events[0].dates);for(var t=1;t<r.events.length;t++)getEndDate(r.events[t].dates)>r.endDate&&(r.endDate=getEndDate(r.events[t].dates))}else{if(!(r.sections.length>0))return;r.endDate=r.sections[0].dates[1];for(var t=0;t<r.sections.length;t++)r.sections[t].dates[1]>r.endDate&&(r.endDate=r.sections[t].dates[1])}r.endDate<r.defaultStartDate&&(r.endDate=r.defaultStartDate),r.endDate=new Date(Math.max(r.endDate.getTime(),r.startDate.getTime()+r.visibleSpan)+r.timelinePadding),r.endDate.stripTime(),r.visibleWidth=r.domElement.clientWidth,r.fitVisibleSpan?(r.startDate=new Date(r.startDate.getTime()-DAY_IN_MILLISECONDS),r.endDate=new Date(r.endDate.getTime()+DAY_IN_MILLISECONDS),r.pxRatio=r.visibleWidth/(r.endDate-r.startDate)):r.pxRatio=r.visibleWidth/r.visibleSpan,r.totalWidth=r.pxRatio*(r.endDate.getTime()-r.startDate.getTime()),r.maxLeftPx=r.totalWidth-r.visibleWidth,r.circleRadius=r.eventHeight/2,r.eventRows=[[]],r.rowLastPxs=[0];for(var t=0;t<r.events.length;t++){for(var e=!1,a=r.msToPx(r.events[t].dates[0].getTime())-r.circleRadius,n=0;n<r.eventRows.length;n++)if(r.rowLastPxs[n]<a){r.eventRows[n].push(r.events[t]),r.rowLastPxs[n]=r.msToPx(getEndDate(r.events[t].dates).getTime())+r.circleRadius,e=!0;break}e||(r.eventRows.push([r.events[t]]),r.rowLastPxs.push(r.msToPx(getEndDate(r.events[t].dates).getTime())+r.circleRadius))}if(r.eventsHeight=Math.max(Math.min(r.eventRows.length*(r.eventMargin+r.eventHeight),r.maxEventsHeight),r.minEventsHeight),r.totalHeight=r.dateLabelHeight+r.eventsHeight+r.topMargin,r.myCanvas&&r.wrapper.removeChild(r.myCanvas),r.myCanvas=document.createElement("div"),r.myCanvas.className="chronoline-canvas",r.wrapper.appendChild(r.myCanvas),r.paper=Raphael(r.myCanvas,r.totalWidth,r.totalHeight),r.paperType=r.paper.raphael.type,r.paperElem=r.myCanvas.childNodes[0],r.floatingSet=r.paper.set(),r.sectionLabelSet=r.paper.set(),r.backgroundClick&&(r.myCanvas.onclick=function(t){if("circle"!=t.target.nodeName&&"rect"!=t.target.nodeName){var e=new Date(r.pxToMs(t.clientX));e.stripTime(),r.backgroundClick(e)}}),r.backgroundDblClick&&(r.myCanvas.ondblclick=function(t){if("circle"!=t.target.nodeName&&"rect"!=t.target.nodeName){var e=new Date(r.pxToMs(t.clientX));e.stripTime(),r.backgroundDblClick(e)}}),null!==r.sections)for(var t=0;t<r.sections.length;t++){var i=r.sections[t],o=(i.dates[0].getTime()-r.startTime)*r.pxRatio,l=(i.dates[1]-i.dates[0])*r.pxRatio,s=r.paper.rect(o,0,l,r.totalHeight);(r.sectionClick||r.sectionDblClick)&&s.data("sectionData",i),r.sectionClick&&s.click(function(t){t.preventDefault();var e=new Date(r.pxToMs(t.clientX));e.stripTime(),r.sectionClick(this.data("sectionData"),e)}),r.sectionDblClick&&s.dblclick(function(t){t.preventDefault();var e=new Date(r.pxToMs(t.clientX));e.stripTime(),r.sectionDblClick(this.data("sectionData"),e)}),addElemClass(r.paperType,s.node,"chronoline-section"),s.attr("stroke-width",0),s.attr("stroke","#ffffff"),"undefined"!=typeof i.attrs&&s.attr(i.attrs);var d=r.paper.text(o+10,10,i.title);d.attr("text-anchor","start"),d.attr(r.sectionLabelAttrs),r.floatingSectionLabels&&(d.data("left-bound",o+10),d.data("right-bound",o+l-d.attr("width")),r.floatingSet.push(d),r.sectionLabelSet.push(d)),s.data("label",d),r.sectionLabelsOnHover&&(s.hover(function(){this.data("label").animate({opacity:1},200)},function(){this.data("label").animate({opacity:0},200)}),d.hover(function(){this.animate({opacity:1},200)},function(){this.animate({opacity:0},200)}),d.attr("opacity",0))}r.sectionLabelSet.forEach(function(t){t.toFront()});for(var c=0;c<r.eventRows.length;c++)for(var u=r.totalHeight-r.dateLabelHeight-(c+1)*(r.eventMargin+r.eventHeight),g=0;g<r.eventRows[c].length;g++){var f=r.eventRows[c][g],o=(f.dates[0].getTime()-r.startTime)*r.pxRatio,s=null;if(1==f.dates.length)s=r.paper.circle(o,u+r.circleRadius,r.circleRadius).attr(r.eventAttrs);else{var l=(getEndDate(f.dates)-f.dates[0])*r.pxRatio,p=r.paper.circle(o,u+r.circleRadius,r.circleRadius).attr(r.eventAttrs);"undefined"!=typeof f.attrs&&p.attr(f.attrs),addElemClass(r.paperType,p.node,"chronoline-event");var m=r.paper.circle(o+l,u+r.circleRadius,r.circleRadius).attr(r.eventAttrs);"undefined"!=typeof f.attrs&&m.attr(f.attrs),addElemClass(r.paperType,m.node,"chronoline-event"),s=r.paper.rect(o,u,l,r.eventHeight).attr(r.eventAttrs)}if((r.eventClick||r.eventDblClick)&&s.data("eventData",f),r.eventClick&&s.click(function(t){t.preventDefault(),r.eventClick(this.data("eventData"))}),r.eventDblClick&&s.dblclick(function(t){t.preventDefault(),r.eventDblClick(this.data("eventData"))}),"undefined"!=typeof f.link&&(s.data("link",f.link),s.click(function(){window.location.href=this.data("link")})),"undefined"!=typeof f.attrs&&s.attr(f.attrs),addElemClass(r.paperType,s.node,"chronoline-event"),s.attr("title",f.title),r.tooltips){var h=f.description,v=f.title,D=jQuery(s.node);"undefined"!=typeof h&&""!==h||(h=v,v=""),"SVG"==Raphael.type&&(D=D.parent()),D.qtip({content:{title:v,text:h},position:{my:"top left",target:"mouse",viewport:jQuery(window),adjust:{x:10,y:10}},hide:{fixed:!0},style:{classes:"qtip-shadow qtip-dark qtip-rounded"}})}if(null!==r.sections&&r.sectionLabelsOnHover){var b=f.section;if("undefined"!=typeof b){for(var t=0;t<r.sections.length;t++)if(r.sections[t].section==b){s.data("sectionLabel",r.sectionLabelSet[t]);break}s.hover(function(){this.data("sectionLabel").animate({opacity:1},200)},function(){this.data("sectionLabel").animate({opacity:0},200)})}}}r.dateLineY=r.totalHeight-r.dateLabelHeight;var S=r.paper.path("M0,"+r.dateLineY+"L"+r.totalWidth+","+r.dateLineY);if(S.attr("stroke",r.hashColor),r.bottomHashY=r.dateLineY+r.hashLength,r.labelY=r.bottomHashY+r.fontAttrs["font-size"],r.subLabelY=r.bottomHashY+2*r.fontAttrs["font-size"]+r.subLabelMargin,r.subSubLabelY=r.subLabelY+r.fontAttrs["font-size"]+r.subSubLabelMargin,"year"==r.subSubLabel)for(var T=r.endDate.getFullYear(),w=r.startDate.getFullYear();T>=w;w++){var L=new Date(w,0,1);L.stripTime();var C=r.msToPx(L.getTime()),x=r.paper.text(C,r.subSubLabelY,L.formatDate("%Y").toUpperCase());if(x.attr(r.fontAttrs),x.attr(r.subSubLabelAttrs),r.floatingSubSubLabels){x.data("left-bound",C);var y=new Date(w,11,31);y.stripTime(),x.data("right-bound",Math.min((y.getTime()-r.startTime)*r.pxRatio-5,r.totalWidth)),r.floatingSet.push(x)}}r.scrollable&&r.initScrollable(),r.draggable&&r.initDraggable(),r.drawnStartMs=null,r.drawnEndMs=null,r.paperElem.style.left=-(r.defaultStartDate-r.startDate)*r.pxRatio+20+"px",r.goToPx(getLeft(r.paperElem)),r.myCanvas.style.height=r.totalHeight+"px"},r.drawLabelsHelper=function(t,e){for(var a=t;e>a;a+=DAY_IN_MILLISECONDS){var n=new Date(a),i=n.getDate(),o=r.msToPx(a);if(null===r.hashInterval||r.hashInterval(n)){var l=r.paper.path("M"+o+","+r.dateLineY+"L"+o+","+r.bottomHashY);l.attr("stroke",r.hashColor)}if(null===r.labelInterval||r.labelInterval(n)){var s=r.paper.text(o,r.labelY,n.formatDate(r.labelFormat));s.attr(r.fontAttrs)}if(r.markToday&&a==r.today.getTime())if("labelBox"==r.markToday){s.attr({text:s.attr("text")+"\n"+n.formatDate("%b").toUpperCase(),"font-size":r.fontAttrs["font-size"]+2,y:r.bottomHashY+r.fontAttrs["font-size"]+5});var d=s.getBBox(),c=r.paper.rect(d.x-2,d.y-2,d.width+4,d.height+4);c.attr("fill","90-#f4f4f4-#e8e8e8"),c.insertBefore(s)}else if("line"==r.markToday){var u=r.paper.path("M"+o+",0L"+o+","+r.dateLineY);u.attr(r.todayAttrs)}if(1==i&&"month"==r.subLabel){var g=r.paper.text(o,r.subLabelY,n.formatDate("%b").toUpperCase());if(g.attr(r.fontAttrs),g.attr(r.subLabelAttrs),r.floatingSubLabels){g.data("left-bound",o);var f=new Date(n.getFullYear(),n.getMonth()+1,0,CL_HOUR);g.data("right-bound",Math.min((f.getTime()-r.startTime)*r.pxRatio-5,r.totalWidth)),r.floatingSet.push(g)}}}},r.drawnStartMs=null,r.drawnEndMs=null,r.drawLabels=function(t){var e=Math.max(0,t-r.visibleWidth),a=(Math.min(r.totalWidth,t+2*r.visibleWidth),new Date(r.pxToMs(e)));a=new Date(a.getFullYear(),a.getMonth(),1,CL_HOUR);var n=a.getTime(),i=new Date(r.pxToMs(Math.min(r.totalWidth,t+2*r.visibleWidth)));i.stripTime();var o=i.getTime();null===r.drawnStartMs?(r.drawnStartMs=n,r.drawnEndMs=o,r.drawLabelsHelper(n,o)):n>r.drawnEndMs?(r.drawLabelsHelper(r.drawnEndMs,o),r.drawnEndMs=o):o<r.drawnStartMs?(r.drawLabelsHelper(n,r.drawnStartMs),r.drawnStartMs=n):(n<r.drawnStartMs&&(r.drawLabelsHelper(n,r.drawnStartMs),r.drawnStartMs=n),o>r.drawnEndMs&&(r.drawLabelsHelper(r.drawnEndMs,o),r.drawnEndMs=o))},r.isMoving=!1,r.goToPx=function(t,e,a){function n(e){null===s&&(s=e);var a=(e-s)/200,l=(t-i)*a+i;d.style.left=l+"px";for(var c=0;c<o.length;c++)o[c][0].attr("x",o[c][2]*a+o[c][1]);if(1>a)requestAnimationFrame(n);else{r.paperElem.style.left=t+"px";for(var c=0;c<o.length;c++)o[c][0].attr("x",o[c][2]+o[c][1]);r.isMoving=!1}}if(r.isMoving)return!1;e="undefined"!=typeof e?e:r.animated,a="undefined"!=typeof a?a:!0,t=Math.max(Math.min(t,0),-r.maxLeftPx),a&&r.drawLabels(-t);var i=getLeft(r.paperElem);r.scrollable&&(0===t?(r.leftControl.style.display="none",r.isScrolling=!1):r.leftControl.style.display="",t==r.visibleWidth-r.totalWidth?(r.rightControl.style.display="none",r.isScrolling=!1):r.rightControl.style.display="");var o=[],l=-t+5;if(r.floatingSet.forEach(function(t){t.data("left-bound")<l&&t.data("right-bound")>l?o.push([t,t.attr("x"),l-t.attr("x")+10]):t.attr("x")!=t.data("left-bound")&&o.push([t,t.attr("x"),t.data("left-bound")-t.attr("x")])}),e){r.isMoving=!0;var s=null,d=r.paperElem;requestAnimationFrame(n)}else{r.paperElem.style.left=t+"px";for(var c=0;c<o.length;c++)o[c][0].attr("x",o[c][2]+o[c][1])}return 0!==t&&t!=-r.maxLeftPx},r.goToDate=function(t,e){t=new Date(t.getTime()),t.stripTime(),0>e?r.goToPx(-r.msToPx(t.getTime())):e>0?r.goToPx(-r.msToPx(t.getTime())+r.visibleWidth):r.goToPx(-r.msToPx(t.getTime())+r.visibleWidth/2)},r.initScrollable=function(){r.leftControl&&r.wrapper.removeChild(r.leftControl),r.leftControl=document.createElement("div"),r.leftControl.className="chronoline-left",r.leftControl.style.marginTop=r.topMargin+"px";var t=document.createElement("div");t.className="chronoline-left-icon",r.leftControl.appendChild(t),r.wrapper.appendChild(r.leftControl);var e=Math.max(r.eventsHeight,r.leftControl.clientHeight);r.leftControl.style.height=e+"px",t.style.marginTop=(e-15)/2+"px",r.rightControl&&r.wrapper.removeChild(r.rightControl),r.rightControl=document.createElement("div"),r.rightControl.className="chronoline-right",r.rightControl.style.marginTop=r.topMargin+"px";var a=document.createElement("div");a.className="chronoline-right-icon",r.rightControl.appendChild(a),r.wrapper.appendChild(r.rightControl),r.rightControl.style.height=r.leftControl.style.height,a.style.marginTop=t.style.marginTop,r.scrollLeftDiscrete=function(t){return r.goToDate(r.scrollLeft(new Date(r.pxToMs(-getLeft(r.paperElem)))),-1),!1},r.scrollRightDiscrete=function(t){return r.goToDate(r.scrollRight(new Date(r.pxToMs(-getLeft(r.paperElem)))),-1),!1},r.continuousScroll?(r.isScrolling=!1,r.timeoutId=-1,r.scrollLeftContinuous=function(t){null===r.scrollStart&&(r.scrollStart=t),r.isScrolling&&requestAnimationFrame(r.scrollLeftContinuous);var e=r.continuousScrollSpeed*(t-r.scrollStart)+r.scrollPaperStart;r.goToPx(e,!1,e>-r.msToPx(r.drawnStartMs))},r.endScrollLeft=function(t){clearTimeout(r.scrollTimeoutId),r.toScrollDiscrete&&(r.toScrollDiscrete=!1,r.scrollLeftDiscrete()),r.isScrolling=!1},r.leftControl.onmousedown=function(t){r.toScrollDiscrete=!0,r.scrollPaperStart=getLeft(r.paperElem),r.scrollTimeoutId=setTimeout(function(){r.toScrollDiscrete=!1,r.scrollStart=null,r.isScrolling=!0,requestAnimationFrame(r.scrollLeftContinuous)},200)},r.leftControl.onmouseup=r.endScrollLeft,r.leftControl.onmouseleave=r.endScrollLeft,r.scrollRightContinuous=function(t){null===r.scrollStart&&(r.scrollStart=t),r.isScrolling&&requestAnimationFrame(r.scrollRightContinuous);var e=r.continuousScrollSpeed*(r.scrollStart-t)+r.scrollPaperStart;r.goToPx(e,!1,e-r.visibleWidth<-r.msToPx(r.drawnEndMs))},r.endScrollRight=function(t){clearTimeout(r.scrollTimeoutId),r.toScrollDiscrete&&(r.toScrollDiscrete=!1,r.scrollRightDiscrete()),r.isScrolling=!1},r.rightControl.onmousedown=function(t){r.toScrollDiscrete=!0,r.scrollPaperStart=getLeft(r.paperElem),r.scrollTimeoutId=setTimeout(function(){r.toScrollDiscrete=!1,r.scrollStart=null,r.isScrolling=!0,requestAnimationFrame(r.scrollRightContinuous)},500)},r.rightControl.onmouseup=r.endScrollRight,r.rightControl.onmouseleave=r.endScrollRight):(r.leftControl.onclick=r.scrollLeftDiscrete,r.rightControl.onclick=r.scrollLeftDiscrete)},r.initDraggable=function(){r.stopDragging=function(t){jQuery(r.wrapper).removeClass("dragging").unbind("mousemove",r.mouseMoved).unbind("mouseleave",r.stopDragging).unbind("mouseup",r.stopDragging),r.drawLabels(-getLeft(r.paperElem))},r.mouseMoved=function(t){r.goToPx(r.dragPaperStart-(r.dragMouseStart-t.pageX),!1,!1)},r.wrapper.className+=" chronoline-draggable",jQuery(r.paperElem).mousedown(function(t){t.preventDefault(),r.dragMouseStart=t.pageX,r.dragPaperStart=getLeft(r.paperElem),jQuery(r.wrapper).addClass("dragging").bind("mousemove",r.mouseMoved).bind("mouseleave",r.stopDragging).bind("mouseup",r.stopDragging)})},r.goToToday=function(){r.goToDate(r.today,0)},r.getLeftTime=function(){return Math.floor(r.startTime-getLeft(r.paperElem)/r.pxRatio)},r.getRightTime=function(){return Math.floor(r.startTime-(getLeft(r.paperElem)-r.visibleWidth)/r.pxRatio)},r.init()}Date.now||(Date.now=function(){return+new Date}),DAY_IN_MILLISECONDS=864e5,requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||function(t,e){return window.setTimeout(function(){t(+new Date)},1e3/60)},Date.prototype.stdTimezoneOffset=function(){var t=new Date(this.getFullYear(),0,1),e=new Date(this.getFullYear(),6,1);return Math.max(t.getTimezoneOffset(),e.getTimezoneOffset())},Date.prototype.dstHourAdjustment=function(){return(this.stdTimezoneOffset()-this.getTimezoneOffset())/60},CL_HOUR=12,Date.prototype.stripTime=function(){this.setHours(CL_HOUR+this.dstHourAdjustment()),this.setMinutes(0),this.setSeconds(0),this.setMilliseconds(0)},Date.MONTH_NAMES=["January","February","March","April","May","June","July","August","September","October","November","December"],Date.DAY_NAMES=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Date.prototype.formatDate=function(t){var e=t;if(-1!=t.indexOf("%d")){var a=this.getDate().toString();a.length<2&&(a="0"+a),e=e.replace("%d",a)}if(-1!=t.indexOf("%b")){var n=Date.MONTH_NAMES[this.getMonth()].substring(0,3);e=e.replace("%b",n)}if(-1!=t.indexOf("%Y")&&(e=e.replace("%Y",this.getFullYear())),-1!=t.indexOf("%a")){var r=Date.DAY_NAMES[this.getDay()].substring(0,3);e=e.replace("%a",r)}return e};