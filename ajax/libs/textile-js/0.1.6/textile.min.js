(function(){"use strict";function e(e){v={}}function t(e){var t=null,n=e+"",a=0;return{save:function(){t=a},load:function(){a=t,e=n.slice(a)},advance:function(t){return a+="string"==typeof t?t.length:t,e=n.slice(a)},lookbehind:function(e){return e=null==e?1:e,n.slice(a-e,a)},startsWith:function(t){return e.substring(0,t.length)===t},valueOf:function(){return e},toString:function(){return e}}}function n(e){var t=m(e)?e:[];return{add:function(e){if("string"==typeof e&&"string"==typeof t[t.length-1])t[t.length-1]+=e;else if(m(e)){var n=e.filter(function(e){return void 0!==e});t.push(n)}else e&&t.push(e);return this},merge:function(e){for(var t=0,n=e.length;t<n;t++)this.add(e[t]);return this},linebreak:function(){t.length&&this.add("\n")},get:function(){return t}}}function a(e,t){if(e){var n,a={};for(n in e)!(n in e)||t&&n in t||(a[n]=e[n]);return a}}function c(e){for(var t,n={};t=B.exec(e);)n[t[1]]="string"==typeof t[2]?t[2].replace(/^(["'])(.*)\1$/,"$2"):null,e=e.slice(t[0].length);return n}function r(e,n){var a,r,i=[],l=i,s=[],p=n?function(e){return e in n}:function(){return!0};e="string"==typeof e?t(e):e;do if((a=D.exec(e))&&p("!"))e.advance(a[0]),i.push(["!",a[1]]);else if((a=F.exec(e))&&p(a[1])){r=a[1];a[2];if(s.length)for(var o=s.length-1;o>=0;o--){var u=s[o];if(u[0]===r){s.splice(o),i=s[s.length-1]||l;break}}e.advance(a[0])}else if((a=C.exec(e))&&p(a[1])){e.advance(a[0]),r=a[1];var d=a[3]||a[1]in ue,f=a[4],h=[r];a[2]&&h.push(c(a[2])),d?(i.push(h),f&&i.push(f)):(f&&h.push(f),s.push(h),i.push(h),i=h)}else a=/([^<]+|[^\0])/.exec(e),a&&i.push(a[0]),e.advance(a?a[0].length||1:1);while(e.valueOf());return l}function i(e,t,n){if(e+="",e&&"notextile"!==t){var a,c={},r={style:c},i=e,l="table"===t||"td"===t||b.test(t),s="img"===t,p=!l&&!s&&"a"!==t,o=s?ae:ne;do if(a=le.exec(i))a[1].split(";").forEach(function(e){var t=e.match(se);t&&(c[t[1]]=t[2])}),i=i.slice(a[0].length);else if(a=pe.exec(i))r.lang=a[1],i=i.slice(a[0].length);else if(a=Y.exec(i)){var u=i.slice(a[0].length);if(!u&&p||n&&(" "===u[0]||n===u.slice(0,n.length))){a=null;continue}var d=a[1].split("#");d[0]&&(r.class=d[0]),d[1]&&(r.id=d[1]),i=u}else{if(l){if(a=ee.exec(i)){c["padding-left"]=a[1].length+"em",i=i.slice(a[0].length);continue}if(a=te.exec(i)){c["padding-right"]=a[1].length+"em",i=i.slice(a[0].length);continue}}if((s||l)&&(a=o.exec(i))){var f=de[a[1]];s?r.align=f:c["text-align"]=f,i=i.slice(a[0].length)}else if("td"!==t&&"tr"!==t||!(a=ce.exec(i))){if("td"===t){if(a=re.exec(i)){r.colspan=a[1],i=i.slice(a[0].length);continue}if(a=ie.exec(i)){r.rowspan=a[1],i=i.slice(a[0].length);continue}}}else c["vertical-align"]=fe[a[1]],i=i.slice(a[0].length)}while(a);var h=[];for(var g in c)h.push(g+":"+c[g]);return h.length?r.style=h.join(";"):delete r.style,i==e?void 0:[e.length-i.length,r]}}function l(e){return"string"!=typeof e?e:e.replace(/([^\-]|^)->/,"$1&#8594;").replace(G,"$1&#215;$2").replace(/([^.]?)\.{3}/g,"$1&#8230;").replace(I,"$1&#8212;$2").replace(/( )-( )/g,"$1&#8211;$2").replace(J,"$1&#8482;").replace(K,"$1&#174;").replace(N,"$1&#169;").replace(Q,"$1&#8243;").replace(V,"$1&#8221;").replace(/"/g,"&#8220;").replace(U,"$1&#8242;").replace(P,"$1&#8217;$2").replace(X,"$1&#8217;").replace(/'/g,"&#8216;")}function s(e){e=t(e.replace(/(^|\n)[\t ]+/,"$1"));for(var n,a,c=function(e){for(var t="\n";e--;)t+="\t";return t},r=[];n=S.exec(e);){var l=["li"],s=i(n[2],"li");s&&(n[2]=n[2].slice(s[0]),s=s[1]);for(var p,u,d,f=n[1].length,h="#"===n[1].substr(-1)?"ol":"ul",g=(r.length===f,null);r.length<f;)p=[h,c(r.length+1),g=["li"]],u=r[r.length-1],u&&(u.li.push(c(r.length)),u.li.push(p)),r.push({ul:p,li:g});for(;r.length>f;)d=r.pop(),d.ul.push(c(r.length));u=r[r.length-1],g||(u.ul.push(c(r.length),l),u.li=l),s&&u.li.push(s),Array.prototype.push.apply(u.li,o(n[2].trim())),e.advance(n[0])}for(;r.length;)a=r.pop(),a.ul.push(c(r.length));return a.ul}function p(e){e=t(e.trim());var n,a,c,r,l,s=["table"];for((l=j.exec(e))&&(e.advance(l[0]),c=i(l[2],"table"),c&&s.push(c[1]));l=k.exec(e);){n=["tr"],l[1]&&(c=i(l[1],"tr"))&&n.push(c[1]),s.push("\n\t",n),a=t(l[2]);do{a.save();var p=a.startsWith("_"),u=[p?"th":"td"];if(p&&a.advance(1),c=i(a,"td"),c&&(a.advance(c[0]),u.push(c[1])),c||p){var d=/^\.\s*/.exec(a);d?a.advance(d[0]):(u=["td"],a.load())}var f=/^(==.*?==|[^\|])*/.exec(a);u=u.concat(o(f[0])),n.push("\n\t\t",u),r="|"===a.valueOf().charAt(f[0].length),a.advance(f[0].length+1)}while(r);n.push("\n\t"),e.advance(l[0])}return s.push("\n"),s}function o(e){e=t(e);var a,r,s=n();do if(e.save(),e.startsWith("\n"))e.advance(1),s.add(["br"]),s.add("\n");else if(a=/^==(.*?)==/.exec(e))e.advance(a[0]),s.add(a[1]);else{var p=e.lookbehind(1),u=!p||/^[\s>.,"'?!;:()]$/.test(p);if((a=z.exec(e))&&(u||a[1])){e.advance(a[0]);var d=a[2],f=a[1],g=oe[d],v="code"===g;(r=!v&&i(e,g,d))&&(e.advance(r[0]),r=r[1]);var m,x;if("["===f)m="^(.*?)",x="(?:])";else if("{"===f)m="^(.*?)",x="(?:})";else{var b=h.escape(d.charAt(0));m=v?"^(\\S+|\\S+.*?\\S)":"^([^\\s"+b+"]+|[^\\s"+b+"].*?\\S("+b+"*))",x="(?=$|[\\s.,\"'!?;:()«»„“”‚‘’])"}var $=h.compile(m+"("+h.escape(d)+")"+x);if((a=$.exec(e))&&a[1]){e.advance(a[0]),v?s.add([g,a[1]]):s.add([g,r].concat(o(a[1])));continue}e.load()}if((a=O.exec(e))||(a=M.exec(e))){e.advance(a[0]),r=a[1]&&i(a[1],"img");var _=r?r[1]:{src:""},y=["img",_];_.src=a[2],_.alt=a[3]?_.title=a[3]:"",a[4]&&(y=["a",{href:a[4]},y]),s.add(y)}else if(a=D.exec(e))e.advance(a[0]),s.add(["!",a[1]]);else{if(a=C.exec(e)){e.advance(a[0]);var w=a[1],S=a[3]||a[1]in ue,A=[w],j=a[4];if(a[2]&&A.push(c(a[2])),S){s.add(A).add(j);continue}var k=h.compile("^(.*?)(</"+w+"\\s*>)","s");if(a=k.exec(e)){if(e.advance(a[0]),"code"===w)A.push(j,a[1]);else{if("notextile"===w){s.merge(o(a[1]));continue}A=A.concat(o(a[1]))}s.add(A);continue}e.load()}if(a=L.exec(e))e.advance(a[0]),s.add(["sup",{class:"footnote",id:"fnr"+a[1]},["a",{href:"#fn"+a[1]},a[1]]]);else if(a=T.exec(e)){e.advance(a[0]);var R=["span",{class:"caps"},a[1]];a[2]&&(R=["acronym",{title:a[2]},R]),s.add(R)}else if(u&&(a=Z.exec(e))||(a=E.exec(e))){e.advance(a[0].length);var H=a[1].match(q),W=H?a[1].slice(0,a[1].length-H[0].length):a[1];(r=i(W,"a"))?(W=W.slice(r[0]),r=r[1]):r={},H&&!W&&(W=H[0],H=""),r.href=a[2],H&&(r.title=H[1]),s.add(["a",r].concat(o(W.replace(/^(\.?\s*)/,""))))}else a=/([a-zA-Z0-9,.':]+|\s+|[^\0])/.exec(e),a&&s.add(a[0]),e.advance(a?a[0].length||1:1)}}while(e.valueOf());return s.get().map(l)}function u(e){var l,f=n(),g=function(e,t,n,a){t=t||"p";var c=[];return e.split(/\n\n+/).forEach(function(e,r){"p"===t&&/^\s/.test(e)?(e=e.replace(/\n[\t ]/g," ").trim(),c=c.concat(o(e))):(a&&r&&c.push(a),c.push(n?[t,n].concat(o(e)):[t].concat(o(e))))}),c},v={};for(e=t(e.replace(/^( *\n)+/,""));e.valueOf();)if(e.save(),l=R.exec(e))e.advance(l[0]),v[l[1]]=l[2];else{if(f.linebreak(),l=x.exec(e)){e.advance(l[0]);var m=l[0],b=i(e,m);if(b&&(e.advance(b[0]),b=b[1]),l=/\.(\.?)(?:\s|(?=:))/.exec(e)){var S=!!l[1];if(l=(S?_:$).exec(e.advance(l[0])),e.advance(l[0]),"bq"===m){var j=l[1];(l=/^:(\S+)\s+/.exec(j))&&(b||(b={}),b.cite=l[1],j=j.slice(l[0].length)),f.add(["blockquote",b,"\n"].concat(g(j,"p",a(b,{cite:1,id:1}),"\n")).concat(["\n"]))}else if("bc"===m){var k=b?a(b,{id:1}):null;f.add(["pre",b,k?["code",k,l[1]]:["code",l[1]]])}else if("notextile"===m)f.merge(r(l[1]));else if("###"===m);else if("pre"===m)f.add(["pre",b,l[1]]);else if(H.test(m)){var z=m.replace(/\D+/g,"");b||(b={}),b.class=(b.class?b.class+" ":"")+"footnote",b.id="fn"+z,f.add(["p",b,["a",{href:"#fnr"+z},["sup",z]]," ",l[1]])}else f.merge(g(l[1],m,b,"\n"));continue}e.load()}if(l=D.exec(e))e.advance(l[0]+(/(?:\s*\n+)+/.exec(e)||[])[0]),f.add(["!",l[1]]);else{if(l=W.exec(e)){var O=l[1],M=l[3]||O in ue,T=l[4];if(O in he){e.advance(l[0]);var Z=[O];if(l[2]&&Z.push(c(l[2])),M){f.add(Z);continue}var E=h.compile("^(.*?)(\\s*)(</"+O+"\\s*>)(\\s*)","s");if(l=E.exec(e)){e.advance(l[0]),"pre"===O?(Z.push(T),Z=Z.concat(r(l[1].replace(/\n+$/,""),{code:1})),l[2]&&Z.push(l[2]),f.add(Z)):"notextile"===O?(Z=r(l[1].trim()),f.merge(Z)):"script"===O||"noscript"===O?(Z.push(T+l[1]),f.add(Z)):(/\n/.test(T)&&Z.push("\n"),Z=/\n/.test(l[1])?Z.concat(u(l[1])):Z.concat(o(l[1].replace(/^ +/,""))),/\n/.test(l[2])&&Z.push("\n"),f.add(Z));continue}}e.load()}(l=y.exec(e))?(e.advance(l[0]),f.add(["hr"])):(l=w.exec(e))?(e.advance(l[0]),f.add(s(l[0]))):(l=A.exec(e))?(e.advance(l[0]),f.add(p(l[1]))):(l=$.exec(e),f.merge(g(l[1],"p",void 0,"\n")),e.advance(l[0]))}}return f.get().map(d,v)}function d(e){if(m(e)){if("a"===e[0]){var t=e[1];"object"==typeof t&&"href"in t&&t.href in this&&(t.href=this[t.href])}for(var n=1,a=e.length;n<a;n++)m(e[n])&&d.call(this,e[n])}return e}function f(t,n){e(n);var a=u(t).map(g.toHTML).join("");return a}var h={_cache:{},pattern:{punct:"[!-/:-@\\[\\\\\\]-`{-~]",space:"\\s"},escape:function(e){return e.replace(/[\-\[\]\{\}\(\)\*\+\?\.\,\\\^\$\|\#\s]/g,"\\$&")},collapse:function(e){return e.replace(/(?:#.*?(?:\n|$))/g,"").replace(/\s+/g,"")},expand_patterns:function(e){return e.replace(/\[\:\s*(\w+)\s*\:\]/g,function(e,t){return t in h.pattern?h.expand_patterns(h.pattern[t]):t})},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},compile:function(e,t){h.isRegExp(e)&&(1===arguments.length&&(t=(e.global?"g":"")+(e.ignoreCase?"i":"")+(e.multiline?"m":"")),e=e.source);var n=e+(t||"");if(n in h._cache)return h._cache[n];var a=h.expand_patterns(e);return t&&/x/.test(t)&&(a=h.collapse(a)),t&&/s/.test(t)&&(a=a.replace(/([^\\])\./g,"$1[^\\0]")),t=(t||"").replace(/[^gim]/g,""),h._cache[n]=new RegExp(a,t)}},g={escape:function(e,t){return e.replace(/&(?!(#\d{2,}|#x[\da-fA-F]{2,}|[a-zA-Z][a-zA-Z1-4]{1,6});)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,t?"&quot;":'"').replace(/'/g,t?"&#39;":"'")},toHTML:function(e){if(e=e.concat(),"string"==typeof e)return g.escape(e);var t,n=e.shift(),a={},c=[],r="";for(e.length&&"object"==typeof e[0]&&!m(e[0])&&(a=e.shift());e.length;)c.push(g.toHTML(e.shift()));for(t in a)r+=null==a[t]?" "+t:" "+t+'="'+g.escape(a[t],!0)+'"';return"!"==n?"<!--"+c.join("")+"-->":"img"===n||"br"===n||"hr"===n||"input"===n?"<"+n+r+" />":"<"+n+r+">"+c.join("")+"</"+n+">"}},v={},m=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};h.pattern.blocks="(?:b[qc]|div|notextile|pre|h[1-6]|fn\\d+|p|###)",h.pattern.pba_class="\\([^\\)]+\\)",h.pattern.pba_style="\\{[^\\}]+\\}",h.pattern.pba_lang="\\[[^\\[\\]]+\\]",h.pattern.pba_align="(?:<>|<|>|=)",h.pattern.pba_pad="[\\(\\)]+",h.pattern.pba_attr="(?:[:pba_class:]|[:pba_style:]|[:pba_lang:]|[:pba_align:]|[:pba_pad:])*",h.pattern.url_punct="[.,«»″‹›!?]",h.pattern.html_id="[a-zA-Z][a-zA-Z\\d:]*",h.pattern.html_attr="(?:\"[^\"]+\"|'[^']+'|[^>\\s]+)",h.pattern.tx_urlch='[\\w"$\\-_.+!*\'(),";\\/?:@=&%#{}|\\\\^~\\[\\]`]',h.pattern.tx_cite=":((?:[^\\s()]|\\([^\\s()]+\\)|[()])+?)(?=[!-\\.:-@\\[\\\\\\]-`{-~]+(?:$|\\s)|$|\\s)",h.pattern.ucaps="A-ZÀ-ÖØ-ÞĀĂĄĆĈĊČĎĐĒĔĖĘĚĜĞĠĢĤĦĨĪĬĮİĲĴĶĹĻĽĿŁŃŅŇŊŌŎŐŒŔŖŘŚŜŞŠŢŤŦŨŪŬŮŰŲŴŶŸŹŻŽƁƂƄƆƇƉ-ƋƎ-ƑƓƔƖ-ƘƜƝƟƠƢƤƦƧƩƬƮƯƱ-ƳƵƷƸƼǄǇǊǍǏǑǓǕǗǙǛǞǠǢǤǦǨǪǬǮǱǴǶ-ǸǺǼǾȀȂȄȆȈȊȌȎȐȒȔȖȘȚȜȞȠȢȤȦȨȪȬȮȰȲȺȻȽȾɁɃ-ɆɈɊɌɎḀḂḄḆḈḊḌḎḐḒḔḖḘḚḜḞḠḢḤḦḨḪḬḮḰḲḴḶḸḺḼḾṀṂṄṆṈṊṌṎṐṒṔṖṘṚṜṞṠṢṤṦṨṪṬṮṰṲṴṶṸṺṼṾẀẂẄẆẈẊẌẎẐẒẔẞẠẢẤẦẨẪẬẮẰẲẴẶẸẺẼẾỀỂỄỆỈỊỌỎỐỒỔỖỘỚỜỞỠỢỤỦỨỪỬỮỰỲỴỶỸỺỼỾⱠⱢ-ⱤⱧⱩⱫⱭ-ⱰⱲⱵⱾⱿꜢꜤꜦꜨꜪꜬꜮꜲꜴꜶꜸꜺꜼꜾꝀꝂꝄꝆꝈꝊꝌꝎꝐꝒꝔꝖꝘꝚꝜꝞꝠꝢꝤꝦꝨꝪꝬꝮꝹꝻꝽꝾꞀꞂꞄꞆꞋꞍꞐꞒꞠꞢꞤꞦꞨꞪ";var x=h.compile(/^([:blocks:])/),b=h.compile(/^[:blocks:]$/),$=h.compile(/^(.*?)($|\n(?:\s*\n|$)+)/,"s"),_=h.compile(/^(.*?)($|\n+(?=[:blocks:][:pba_attr:]\.))/,"s"),y=/^(\-\-\-+|\*\*\*+|___+)(\n\s+|$)/,w=h.compile(/^((?:[\t ]*[\#\*]+[:pba_attr:] .+?(?:\n|$))+)(\s*\n)?/),S=/^([\#\*]+)(.+?)(\n|$)/,A=h.compile(/^((?:table[:pba_attr:]\.\n)?(?:(?:[:pba_attr:]\.[^\n\S]*)?\|.*?\|[^\n\S]*(?:\n|$))+)([^\n\S]*\n)?/,"s"),j=/^table(_?)([^\n]+)\.\s?\n/,k=h.compile(/^([:pba_attr:]\.[^\n\S]*)?\|(.*?)\|[^\n\S]*(\n|$)/,"s"),z=/^([\[\{]?)(__?|\*\*?|\?\?|[\-\+\^~@%])/,O=(h.compile(/^.+?(?=[\\<!\[_\*`]|\n|$)/,"s"),h.compile(/^!(?!\s)([:pba_attr:](?:\.[^\n\S]|\.(?:[^\.\/]))?)([^!\s]+?) ?(?:\(((?:[^\(\)]+|\([^\(\)]+\))+)\))?!(?::([^\s]+?(?=[!-\.:-@\[\\\]-`{-~](?:$|\s)|\s|$)))?/)),M=h.compile(/^\[!(?!\s)([:pba_attr:](?:\.[^\n\S]|\.(?:[^\.\/]))?)([^!\s]+?) ?(?:\(((?:[^\(\)]+|\([^\(\)]+\))+)\))?!(?::([^\s]+?(?=[!-\.:-@\[\\\]-`{-~](?:$|\s)|\s|$)))?\]/),T=h.compile(/^((?!TM\)|tm\))[[:ucaps:]](?:[[:ucaps:]\d]{1,}(?=\()|[[:ucaps:]\d]{2,}))(?:\((.*?)\))?(?=\W|$)/),Z=h.compile(/^"(?!\s)((?:[^\n"]|"(?![\s:])[^\n"]+"(?!:))+)"[:tx_cite:]/),E=/^\["([^\n]+?)":((?:\[[a-z0-9]*\]|[^\]])+)\]/,R=h.compile(/^\[([^\]]+)\]((?:https?:\/\/|\/)\S+)(?:\s*\n|$)/),q=/\s*\(((?:\([^\(\)]*\)|[^\(\)]+)+)\)$/,H=/^fn\d+$/,L=/^\[(\d+)\]/,W=h.compile(/^\s*<([:html_id:](?::[a-zA-Z\d]+)*)((?:\s[^=\s\/]+(?:\s*=\s*[:html_attr:])?)+)?\s*(\/?)>(\n*)/),C=h.compile(/^<([:html_id:])((?:\s[^=\s\/]+(?:\s*=\s*[:html_attr:])?)+)?\s*(\/?)>(\n*)/),D=h.compile(/^<!--(.+?)-->/,"s"),F=h.compile(/^<\/([:html_id:])([^>]*)>/),B=h.compile(/^\s*([^=\s]+)(?:\s*=\s*("[^"]+"|'[^']+'|[^>\s]+))?/),G=/([\d\.,]+['"]? ?)x( ?)(?=[\d\.,]['"]?)/g,I=/(^|[\s\w])--([\s\w]|$)/g,J=/(\b ?|\s|^)(?:\((?:TM|tm)\)|\[(?:TM|tm)\])/g,K=/(\b ?|\s|^)(?:\(R\)|\[R\])/gi,N=/(\b ?|\s|^)(?:\(C\)|\[C\])/gi,P=/(\w)\'(\w)/g,Q=h.compile(/(\d*[\.,]?\d+)"(?=\s|$|[:punct:])/g),U=h.compile(/(\d*[\.,]?\d+)'(?=\s|$|[:punct:])/g),V=h.compile(/([^\s\[\(])"(?=$|\s|[:punct:])/g),X=h.compile(/([^\s\[\(])'(?=$|\s|[:punct:])/g),Y=/^\(([^\(\)\n]+)\)/,ee=/^([\(]+)/,te=/^([\)]+)/,ne=/^(<>|<|>|=)/,ae=/^(<|>|=)/,ce=/^(~|\^|\-)/,re=/^\\(\d+)/,ie=/^\/(\d+)/,le=/^\{([^\}]*)\}/,se=/^\s*([^:\s]+)\s*:\s*(.+)\s*$/,pe=/^\[([^\[\]]+)\]/,oe={"*":"strong","**":"b","??":"cite",_:"em",__:"i","-":"del","%":"span","+":"ins","~":"sub","^":"sup","@":"code"},ue={br:1,hr:1,img:1,link:1,meta:1,wbr:1,area:1,param:1,input:1,option:1,base:1},de={"<":"left","=":"center",">":"right","<>":"justify"},fe={"~":"bottom","^":"top","-":"middle"},he={p:0,hr:0,ul:1,ol:0,li:0,div:1,pre:0,object:1,script:0,noscript:0,blockquote:1,notextile:1};f.parse=f.convert=f,f.html_parser=r,f.jsonml=function(t,n){return e(n),["html"].concat(u(t))},f.serialize=g.toHTML,f.setOptions=f.set_options=e,"undefined"!=typeof module&&module.exports?module.exports=f:this.textile=f}).call(function(){return this||("undefined"!=typeof window?window:global)}());
//# sourceMappingURL=textile.min.js.map