(function(){"use strict";function e(e){v={}}function t(e){var t=null,n=e+"",a=0;return{save:function(){t=a},load:function(){a=t,e=n.slice(a)},advance:function(t){return a+="string"==typeof t?t.length:t,e=n.slice(a)},lookbehind:function(e){return e=null==e?1:e,n.slice(a-e,a)},startsWith:function(t){return e.substring(0,t.length)===t},valueOf:function(){return e},toString:function(){return e}}}function n(e){var t=m(e)?e:[];return{add:function(e){if("string"==typeof e&&"string"==typeof t[t.length-1])t[t.length-1]+=e;else if(m(e)){var n=e.filter(function(e){return void 0!==e});t.push(n)}else e&&t.push(e);return this},merge:function(e){for(var t=0,n=e.length;t<n;t++)this.add(e[t]);return this},linebreak:function(){t.length&&this.add("\n")},get:function(){return t}}}function a(e,t){if(e){var n,a={};for(n in e)!(n in e)||t&&n in t||(a[n]=e[n]);return a}}function c(e){for(var t,n={};t=B.exec(e);)n[t[1]]="string"==typeof t[2]?t[2].replace(/^(["'])(.*)\1$/,"$2"):null,e=e.slice(t[0].length);return n}function r(e,n){var a,e="string"==typeof e?t(e):e,r=[],i=r,s=[],l=n?function(e){return e in n}:function(){return!0};do if((a=D.exec(e))&&l("!"))e.advance(a[0]),r.push(["!",a[1]]);else if((a=F.exec(e))&&l(a[1])){var p=a[1];a[2];if(s.length)for(var o=s.length-1;o>=0;o--){var u=s[o];if(u[0]===p){s.splice(o),r=s[s.length-1]||i;break}}e.advance(a[0])}else if((a=C.exec(e))&&l(a[1])){e.advance(a[0]);var p=a[1],d=a[3]||a[1]in ue,f=a[4],h=[p];a[2]&&h.push(c(a[2])),d?(r.push(h),f&&r.push(f)):(f&&h.push(f),s.push(h),r.push(h),r=h)}else a=/([^<]+|[^\0])/.exec(e),a&&r.push(a[0]),e.advance(a?a[0].length||1:1);while(e.valueOf());return i}function i(e,t){if(e+="",e&&"notextile"!==t){var n,a={},c={style:a},r=e,i="table"===t||"td"===t||b.test(t),s="img"===t;do if(/^\([^\n\)]*\s[^\n\)]*\)/.test(r))n=null;else if(n=se.exec(r))n[1].split(";").forEach(function(e){var t=e.match(le);t&&(a[t[1]]=t[2])}),r=r.slice(n[0].length);else if(n=pe.exec(r))c.lang=n[1],r=r.slice(n[0].length);else if(n=Y.exec(r)){var l=n[1].split("#");l[0]&&(c.class=l[0]),l[1]&&(c.id=l[1]),r=r.slice(n[0].length)}else{if(i){if(n=ee.exec(r)){a["padding-left"]=n[1].length+"em",r=r.slice(n[0].length);continue}if(n=te.exec(r)){a["padding-right"]=n[1].length+"em",r=r.slice(n[0].length);continue}}if(s||i){var p=s?ae:ne;if(n=p.exec(r)){var o=de[n[1]];s?c.align=o:a["text-align"]=o,r=r.slice(n[0].length);continue}}if("td"!==t&&"tr"!==t||!(n=ce.exec(r))){if("td"===t){if(n=re.exec(r)){c.colspan=n[1],r=r.slice(n[0].length);continue}if(n=ie.exec(r)){c.rowspan=n[1],r=r.slice(n[0].length);continue}}}else a["vertical-align"]=fe[n[1]],r=r.slice(n[0].length)}while(n);var u=[];for(var d in a)u.push(d+":"+a[d]);return u.length?c.style=u.join(";"):delete c.style,r==e?void 0:[e.length-r.length,c]}}function s(e){return"string"!=typeof e?e:e.replace(/([^-]|^)->/,"$1&#8594;").replace(G,"$1&#215;$2").replace(/([^.]?)\.{3}/g,"$1&#8230;").replace(I,"$1&#8212;$2").replace(/( )-( )/g,"$1&#8211;$2").replace(J,"$1&#8482;").replace(K,"$1&#174;").replace(N,"$1&#169;").replace(Q,"$1&#8243;").replace(V,"$1&#8221;").replace(/"/g,"&#8220;").replace(U,"$1&#8242;").replace(P,"$1&#8217;$2").replace(X,"$1&#8217;").replace(/'/g,"&#8216;")}function l(e){for(var n,e=t(e.replace(/(^|\n)[\t ]+/,"$1")),a=function(e){return"\n"+Array(e+1).join("\t")},c=[];n=A.exec(e);){var r=["li"],s=i(n[2],"li");s&&(n[2]=n[2].slice(s[0]),s=s[1]);for(var l=n[1].length,p="#"===n[1].substr(-1)?"ol":"ul",u=(c.length===l,null);c.length<l;){var d=[p,a(c.length+1),u=["li"]],f=c[c.length-1];f&&(f.li.push(a(c.length)),f.li.push(d)),c.push({ul:d,li:u})}for(;c.length>l;){var h=c.pop();h.ul.push(a(c.length))}var f=c[c.length-1];u||(f.ul.push(a(c.length),r),f.li=r),s&&f.li.push(s),Array.prototype.push.apply(f.li,o(n[2].trim())),e.advance(n[0])}for(var g;c.length;)g=c.pop(),g.ul.push(a(c.length));return g.ul}function p(e){var n,a,c,r,e=t(e.trim()),s=["table"],r=S.exec(e);if(r){e.advance(r[0]);var c=i(r[2],"table");c&&s.push(c[1])}for(;r=k.exec(e);){n=["tr"],r[1]&&(c=i(r[1],"tr"))&&n.push(c[1]),s.push("\n\t",n),a=t(r[2]);do{a.save();var l=a.startsWith("_"),p=[l?"th":"td"];l&&a.advance(1);var c=i(a,"td");if(c&&(a.advance(c[0]),p.push(c[1])),c||l){var u=/^\.\s*/.exec(a);u?a.advance(u[0]):(p=["td"],a.load())}var d=/^(==.*?==|[^\|])*/.exec(a);p=p.concat(o(d[0])),n.push("\n\t\t",p);var f="|"===a.valueOf().charAt(d[0].length);a.advance(d[0].length+1)}while(f);n.push("\n\t"),e.advance(r[0])}return s.push("\n"),s}function o(e){var a,e=t(e),r=n();do if(e.save(),e.startsWith("\n"))e.advance(1),r.add(["br"]),r.add("\n");else if(a=/^==(.*?)==/.exec(e))e.advance(a[0]),r.add(a[1]);else{var l=e.lookbehind(1),p=!l||/[\s>.,"'?!;:()]$/.test(l);if((a=z.exec(e))&&(p||a[1])){e.advance(a[0]);var u=a[2],d=a[1],f=oe[u],g="code"===f,v=!g&&i(e,f);v&&(e.advance(v[0]),v=v[1]);var m,x;if("["===d)m="^(.*?)",x="(?:])";else if("{"===d)m="^(.*?)",x="(?:})";else{var b=h.escape(u.charAt(0));m="^([^\\s"+b+"]+|[^\\s"+b+"].*?\\S("+b+"*))",x="(?=$|[\\s.,\"'!?;:()«»„“”‚‘’])"}var $=h.compile(m+"("+h.escape(u)+")"+x);if(a=$.exec(e),a&&a[1]){e.advance(a[0]),g?r.add([f,a[1]]):r.add([f,v].concat(o(a[1])));continue}e.load()}if((a=O.exec(e))||(a=M.exec(e))){e.advance(a[0]);var v=a[1]&&i(a[1],"img"),_=v?v[1]:{src:""};_.src=a[2],_.alt=a[3]?_.title=a[3]:"";var y=["img",_];a[4]&&(y=["a",{href:a[4]},y]),r.add(y)}else if(a=D.exec(e))e.advance(a[0]),r.add(["!",a[1]]);else{if(a=C.exec(e)){e.advance(a[0]);var w=a[1],A=a[3]||a[1]in ue,j=[w],S=a[4];if(a[2]&&j.push(c(a[2])),A){r.add(j).add(S);continue}var k=h.compile("^(.*?)(</"+w+"\\s*>)","s");if(a=k.exec(e)){if(e.advance(a[0]),"code"===w)j.push(S,a[1]);else{if("notextile"===w){r.merge(o(a[1]));continue}j=j.concat(o(a[1]))}r.add(j);continue}e.load()}if(a=L.exec(e))e.advance(a[0]),r.add(["sup",{class:"footnote",id:"fnr"+a[1]},["a",{href:"#fn"+a[1]},a[1]]]);else if(a=T.exec(e)){e.advance(a[0]);var R=["span",{class:"caps"},a[1]];a[2]&&(R=["acronym",{title:a[2]},R]),r.add(R)}else if(p&&(a=Z.exec(e))||(a=E.exec(e))){e.advance(a[0].length);var H=a[1].match(q),W=H?a[1].slice(0,a[1].length-H[0].length):a[1],v=i(W,"a");v?(W=W.slice(v[0]),v=v[1]):v={},H&&!W&&(W=H[0],H=""),v.href=a[2],H&&(v.title=H[1]),r.add(["a",v].concat(o(W.replace(/^(\.?\s*)/,""))))}else{var a=/([a-zA-Z0-9,.':]+|\s+|[^\0])/.exec(e);a&&r.add(a[0]),e.advance(a?a[0].length||1:1)}}}while(e.valueOf());return r.get().map(s)}function u(e){for(var s,f=n(),g=function(e,t,n,a){t=t||"p";var c=[];return e.split(/\n\n+/).forEach(function(e,r){"p"===t&&/^\s/.test(e)?(e=e.replace(/\n[\t ]/g," ").trim(),c=c.concat(o(e))):(a&&r&&c.push(a),c.push(n?[t,n].concat(o(e)):[t].concat(o(e))))}),c},e=t(e.replace(/^( *\n)+/,"")),v={};e.valueOf();)if(e.save(),s=R.exec(e))e.advance(s[0]),v[s[1]]=s[2];else{if(f.linebreak(),s=x.exec(e)){e.advance(s[0]);var m=s[0],b=i(e,m);if(b&&(e.advance(b[0]),b=b[1]),s=/\.(\.?)\s?/.exec(e)){var A=!!s[1];if(s=(A?_:$).exec(e.advance(s[0])),e.advance(s[0]),"bq"===m){var S=s[1];(s=/^:(\S+)\s+/.exec(S))&&(b||(b={}),b.cite=s[1],S=S.slice(s[0].length)),f.add(["blockquote",b,"\n"].concat(g(S,"p",a(b,{cite:1,id:1}),"\n")).concat(["\n"]))}else if("bc"===m){var k=b?a(b,{id:1}):null;f.add(["pre",b,k?["code",k,s[1]]:["code",s[1]]])}else if("notextile"===m)f.merge(r(s[1]));else if("pre"===m)f.add(["pre",b,s[1]]);else if(H.test(m)){var z=m.replace(/\D+/g,"");b||(b={}),b.class=(b.class?b.class+" ":"")+"footnote",b.id="fn"+z,f.add(["p",b,["a",{href:"#fnr"+z},["sup",z]]," ",s[1]])}else f.merge(g(s[1],m,b,"\n"));continue}e.load()}if(s=D.exec(e))e.advance(s[0]+(/(?:\s*\n+)+/.exec(e)||[])[0]),f.add(["!",s[1]]);else{if(s=W.exec(e)){var O=s[1],M=s[3]||O in ue,T=s[4];if(O in he){e.advance(s[0]);var Z=[O];if(s[2]&&Z.push(c(s[2])),M){f.add(Z);continue}var E=h.compile("^(.*?)(\\s*)(</"+O+"\\s*>)(\\s*)","s");if(s=E.exec(e)){e.advance(s[0]),"pre"===O?(Z.push(T),Z=Z.concat(r(s[1].replace(/\n+$/,""),{code:1})),s[2]&&Z.push(s[2]),f.add(Z)):"notextile"===O?(Z=r(s[1].trim()),f.merge(Z)):"script"===O||"noscript"===O?(Z.push(T+s[1]),f.add(Z)):(/\n/.test(T)&&Z.push("\n"),Z=/\n/.test(s[1])?Z.concat(u(s[1])):Z.concat(o(s[1].replace(/^ +/,""))),/\n/.test(s[2])&&Z.push("\n"),f.add(Z));continue}}e.load()}if(s=y.exec(e))e.advance(s[0]),f.add(["hr"]);else if(s=w.exec(e))e.advance(s[0]),f.add(l(s[0]));else if(s=j.exec(e))e.advance(s[0]),f.add(p(s[1]));else{var s=$.exec(e);f.merge(g(s[1],"p",void 0,"\n")),e.advance(s[0])}}}return f.get().map(d,v)}function d(e){if(m(e)){if("a"===e[0]){var t=e[1];"object"==typeof t&&"href"in t&&t.href in this&&(t.href=this[t.href])}for(var n=1,a=e.length;n<a;n++)m(e[n])&&d.call(this,e[n])}return e}function f(t,n){e(n);var a=u(t).map(g.toHTML).join("");return a}var h={_cache:{},pattern:{punct:"[!-/:-@\\[\\\\\\]-`{-~]",space:"\\s"},escape:function(e){return e.replace(/[\-\[\]\{\}\(\)\*\+\?\.\,\\\^\$\|\#\s]/g,"\\$&")},collapse:function(e){return e.replace(/(?:#.*?(?:\n|$))/g,"").replace(/\s+/g,"")},expand_patterns:function(e){return e.replace(/\[\:\s*(\w+)\s*\:\]/g,function(e,t){return t in h.pattern?h.expand_patterns(h.pattern[t]):t})},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},compile:function(e,t){h.isRegExp(e)&&(1===arguments.length&&(t=(e.global?"g":"")+(e.ignoreCase?"i":"")+(e.multiline?"m":"")),e=e.source);var n=e+(t||"");if(n in h._cache)return h._cache[n];var a=h.expand_patterns(e);return t&&/x/.test(t)&&(a=h.collapse(a)),t&&/s/.test(t)&&(a=a.replace(/([^\\])\./g,"$1[^\\0]")),t=(t||"").replace(/[^gim]/g,""),h._cache[n]=new RegExp(a,t)}},g={escape:function(e,t){return e.replace(/&(?!(#\d{2,}|#x[\da-fA-F]{2,}|[a-zA-Z][a-zA-Z1-4]{1,6});)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,t?"&quot;":'"').replace(/'/g,t?"&#39;":"'")},toHTML:function(e){if(e=e.concat(),"string"==typeof e)return g.escape(e);var t=e.shift(),n={},a=[];for(e.length&&"object"==typeof e[0]&&!Array.isArray(e[0])&&(n=e.shift());e.length;)a.push(g.toHTML(e.shift()));var c="";for(var r in n)c+=" "+r+'="'+g.escape(n[r],!0)+'"';return"!"==t?"<!--"+a.join("")+"-->":"img"==t||"br"==t||"hr"==t?"<"+t+c+" />":"<"+t+c+">"+a.join("")+"</"+t+">"}},v={},m=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};h.pattern.blocks="(?:b[qc]|div|notextile|pre|h[1-6]|fn\\d+|p)",h.pattern.pba_class="\\([^\\)]+\\)",h.pattern.pba_style="\\{[^\\}]+\\}",h.pattern.pba_lang="\\[[^\\[\\]]+\\]",h.pattern.pba_align="(?:<>|<|>|=)",h.pattern.pba_pad="[\\(\\)]+",h.pattern.pba_attr="(?:[:pba_class:]|[:pba_style:]|[:pba_lang:]|[:pba_align:]|[:pba_pad:])*",h.pattern.url_punct="[.,«»″‹›!?]",h.pattern.html_id="[a-zA-Z][a-zA-Z\\d:]*",h.pattern.html_attr="(?:\"[^\"]+\"|'[^']+'|[^>\\s]+)",h.pattern.tx_urlch='[\\w"$\\-_.+!*\'(),";\\/?:@=&%#{}|\\\\^~\\[\\]`]',h.pattern.tx_cite=":((?:[^\\s()]|\\([^s()]+\\)|[()])+?)(?=[!-\\.:-@[\\\\\\]-`{-~]+(?:$|\\s)|$|\\s)",h.pattern.ucaps="A-ZÀ-ÖØ-ÞĀĂĄĆĈĊČĎĐĒĔĖĘĚĜĞĠĢĤĦĨĪĬĮİĲĴĶĹĻĽĿŁŃŅŇŊŌŎŐŒŔŖŘŚŜŞŠŢŤŦŨŪŬŮŰŲŴŶŸŹŻŽƁƂƄƆƇƉ-ƋƎ-ƑƓƔƖ-ƘƜƝƟƠƢƤƦƧƩƬƮƯƱ-ƳƵƷƸƼǄǇǊǍǏǑǓǕǗǙǛǞǠǢǤǦǨǪǬǮǱǴǶ-ǸǺǼǾȀȂȄȆȈȊȌȎȐȒȔȖȘȚȜȞȠȢȤȦȨȪȬȮȰȲȺȻȽȾɁɃ-ɆɈɊɌɎḀḂḄḆḈḊḌḎḐḒḔḖḘḚḜḞḠḢḤḦḨḪḬḮḰḲḴḶḸḺḼḾṀṂṄṆṈṊṌṎṐṒṔṖṘṚṜṞṠṢṤṦṨṪṬṮṰṲṴṶṸṺṼṾẀẂẄẆẈẊẌẎẐẒẔẞẠẢẤẦẨẪẬẮẰẲẴẶẸẺẼẾỀỂỄỆỈỊỌỎỐỒỔỖỘỚỜỞỠỢỤỦỨỪỬỮỰỲỴỶỸỺỼỾⱠⱢ-ⱤⱧⱩⱫⱭ-ⱰⱲⱵⱾⱿꜢꜤꜦꜨꜪꜬꜮꜲꜴꜶꜸꜺꜼꜾꝀꝂꝄꝆꝈꝊꝌꝎꝐꝒꝔꝖꝘꝚꝜꝞꝠꝢꝤꝦꝨꝪꝬꝮꝹꝻꝽꝾꞀꞂꞄꞆꞋꞍꞐꞒꞠꞢꞤꞦꞨꞪ";var x=h.compile(/^([:blocks:])/),b=h.compile(/^[:blocks:]$/),$=h.compile(/^(.+?)($|\n(?:\s*\n|$)+)/,"s"),_=h.compile(/^(.+?)($|\n+(?=[:blocks:][:pba_attr:]\.))/,"s"),y=/^(\-\-\-+|\*\*\*+|___+)(\n\s+|$)/,w=/^((?:[\t ]*[\#\*]+[\(\)\{\[\s\.]+.+?(?:\n|$))+)(\s*\n)?/,A=/^([\#\*]+)(.+?)(\n|$)/,j=h.compile(/^((?:table[:pba_attr:]\.\n)?(?:(?:[:pba_attr:]\.[^\n\S]*)?\|.*?\|[^\n\S]*(?:\n|$))+)([^\n\S]*\n)?/,"s"),S=/^table(_?)([^\n]+)\.\s?\n/,k=h.compile(/^([:pba_attr:]\.[^\n\S]*)?\|(.*?)\|[^\n\S]*(\n|$)/,"s"),z=/^([\[\{]?)(__?|\*\*?|\?\?|[\-\+\^~@%])/,O=(h.compile(/^.+?(?=[\\<!\[_\*`]|\n|$)/,"s"),h.compile(/^!(?!\s)([:pba_attr:](?:\.[^\n\S]|\.(?:[^\.\/]))?)([^!\s]+?) ?(?:\(((?:[^\(]+|\([^\(\)]+\))+)\))?!(?::([^\s]+?(?=[!-\.:-@\[\\\]-`{-~](?:$|\s)|\s|$)))?/)),M=h.compile(/^\[!(?!\s)([:pba_attr:](?:\.[^\n\S]|\.(?:[^\.\/]))?)([^!\s]+?) ?(?:\(((?:[^\(]+|\([^\(\)]+\))+)\))?!(?::([^\s]+?(?=[!-\.:-@\[\\\]-`{-~](?:$|\s)|\s|$)))?\]/),T=h.compile(/^((?!TM\)|tm\))[[:ucaps:]](?:[[:ucaps:]\d]{1,}(?=\()|[[:ucaps:]\d]{2,}))(?:\((.*?)\))?(?=\W|$)/),Z=h.compile(/^"(?!\s)((?:[^\n"]|"(?![\s:])[^\n"]+"(?!:))+)"[:tx_cite:]/),E=/^\["([^\n]+?)":((?:\[[a-z0-9]*\]|[^\]])+)\]/,R=h.compile(/^\[([^\]]+)\]((?:https?:\/\/|\/)\S+)(?:\s*\n|$)/),q=/\s*\(((?:\([^\(\)]*\)|[^\(\)]+)+)\)$/,H=/^fn\d+$/,L=/^\[(\d+)\]/,W=h.compile(/^\s*<([:html_id:](?::[a-zA-Z\d]+)*)((?:\s[^=\s\/]+(?:\s*=\s*[:html_attr:])?)+)?\s*(\/?)>(\n*)/),C=h.compile(/^<([:html_id:])((?:\s[^=\s\/]+(?:\s*=\s*[:html_attr:])?)+)?\s*(\/?)>(\n*)/),D=h.compile(/^<!--(.+?)-->/,"s"),F=h.compile(/^<\/([:html_id:])([^>]*)>/),B=h.compile(/^\s*([^=\s]+)(?:\s*=\s*("[^"]+"|'[^']+'|[^>\s]+))?/),G=/([\d\.,]+['"]? ?)x( ?)(?=[\d\.,]['"]?)/g,I=/(^|[\s\w])--([\s\w]|$)/g,J=/(\b ?|\s|^)(?:\((?:TM|tm)\)|\[(?:TM|tm)\])/g,K=/(\b ?|\s|^)(?:\(R\)|\[R\])/gi,N=/(\b ?|\s|^)(?:\(C\)|\[C\])/gi,P=/(\w)\'(\w)/g,Q=h.compile(/(\d*[\.,]?\d+)"(?=\s|$|[:punct:])/g),U=h.compile(/(\d*[\.,]?\d+)'(?=\s|$|[:punct:])/g),V=h.compile(/([^\s\[\(])"(?=$|\s|[:punct:])/g),X=h.compile(/([^\s\[\(])'(?=$|\s|[:punct:])/g),Y=/^\(([^\(\)\s]+)\)/,ee=/^([\(]+)/,te=/^([\)]+)/,ne=/^(<>|<|>|=)/,ae=/^(<|>|=)/,ce=/^(~|\^|\-)/,re=/^\\(\d+)/,ie=/^\/(\d+)/,se=/^\{([^\}]*)\}/,le=/^\s*([^:\s]+)\s*:\s*(.+)\s*$/,pe=/^\[([^\[\]]+)\]/,oe={"*":"strong","**":"b","??":"cite",_:"em",__:"i","-":"del","%":"span","+":"ins","~":"sub","^":"sup","@":"code"},ue={br:1,hr:1,img:1,link:1,meta:1,wbr:1,area:1,param:1,input:1,option:1,base:1},de={"<":"left","=":"center",">":"right","<>":"justify"},fe={"~":"bottom","^":"top","-":"middle"},he={p:0,hr:0,ul:1,ol:0,li:0,div:1,pre:0,object:1,script:0,noscript:0,blockquote:1,notextile:1};f.parse=f.convert=f,f.html_parser=r,f.jsonml=function(t,n){return e(n),["html"].concat(u(t))},f.serialize=g.toHTML,f.setOptions=f.set_options=e,"undefined"!=typeof module&&module.exports?module.exports=f:this.textile=f}).call(function(){return this||("undefined"!=typeof window?window:global)}());
//# sourceMappingURL=textile.min.js.map