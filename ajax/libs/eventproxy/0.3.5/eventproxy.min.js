!function(t,e){var n="function"==typeof define,r="undefined"!=typeof module&&module.exports;n?(define("eventproxy_debug",function(){return function(){}}),define(["eventproxy_debug"],e)):r?module.exports=e(require("debug")("eventproxy")):this[t]=e()}("EventProxy",function(t){t=t||function(){};var e=Array.prototype.slice,n=Array.prototype.concat,r="__all__",i=function(){return this instanceof i?(this._callbacks={},void(this._fired={})):new i};i.prototype.addListener=function(e,n){return t("Add listener for %s",e),this._callbacks[e]=this._callbacks[e]||[],this._callbacks[e].push(n),this},i.prototype.bind=i.prototype.addListener,i.prototype.on=i.prototype.addListener,i.prototype.subscribe=i.prototype.addListener,i.prototype.headbind=function(e,n){return t("Add listener for %s",e),this._callbacks[e]=this._callbacks[e]||[],this._callbacks[e].unshift(n),this},i.prototype.removeListener=function(e,n){var r=this._callbacks;if(e)if(n){var i=r[e];if(i)for(var o=i.length,l=0;o>l;l++)n===i[l]&&(t("Remove a listener of %s",e),i[l]=null)}else t("Remove all listeners of %s",e),r[e]=[];else t("Remove all listeners"),this._callbacks={};return this},i.prototype.unbind=i.prototype.removeListener,i.prototype.removeAllListeners=function(t){return this.unbind(t)},i.prototype.bindForAll=function(t){this.bind(r,t)},i.prototype.unbindForAll=function(t){this.unbind(r,t)},i.prototype.trigger=function(e,n){var i,o,l,p,s,a=2,u=this._callbacks;for(t("Emit event %s with data %j",e,n);a--;)if(o=a?e:r,i=u[o])for(p=0,s=i.length;s>p;p++)if(l=i[p]){for(var f=[],c=a?1:0,d=c;d<arguments.length;d++)f.push(arguments[d]);l.apply(this,f)}else i.splice(p,1),p--,s--;return this},i.prototype.emit=i.prototype.trigger,i.prototype.fire=i.prototype.trigger,i.prototype.once=function(t,e){var n=this,r=function(){e.apply(n,arguments),n.unbind(t,r)};return this.bind(t,r),this};var o="undefined"!=typeof setImmediate&&setImmediate||"undefined"!=typeof process&&process.nextTick||function(t){setTimeout(t,0)};i.prototype.emitLater=function(){var t=this,e=arguments;o(function(){t.trigger.apply(t,e)})},i.prototype.immediate=function(t,e,n){return this.bind(t,e),this.trigger(t,n),this},i.prototype.asap=i.prototype.immediate;var l=function(n,r,i,o){var l=this,p=arguments.length,s=0,a={};if(3>p)return this;var u=e.call(arguments,0,-2),f=arguments[p-2],c=arguments[p-1];if("function"!=typeof f)return this;t("Assign listener for events %j, once is %s",u,!!c);for(var d=function(t){var e=c?"once":"bind";l[e](t,function(e){l._fired[t]=l._fired[t]||{},l._fired[t].data=e,a[t]||(a[t]=!0,s++)})},y=u.length,h=0;y>h;h++)d(u[h]);var v=function(e){if(!(y>s)&&a[e]){for(var n=[],r=0;y>r;r++)n.push(l._fired[u[r]].data);c&&l.unbindForAll(v),t("Events %j all emited with data %j",u,n),f.apply(null,n)}};l.bindForAll(v)};return i.prototype.all=function(t,e,r){var i=n.apply([],arguments);return i.push(!0),l.apply(this,i),this},i.prototype.assign=i.prototype.all,i.prototype.fail=function(t){var e=this;return e.once("error",function(){e.unbind(),t.apply(null,arguments)}),this},i.prototype["throw"]=function(){var t=this;t.emit.apply(t,["error"].concat(e.call(arguments)))},i.prototype.tail=function(){var t=n.apply([],arguments);return t.push(!1),l.apply(this,t),this},i.prototype.assignAll=i.prototype.tail,i.prototype.assignAlways=i.prototype.tail,i.prototype.after=function(e,n,r){if(0===n)return r.call(null,[]),this;var i=this,o=[];this._after=this._after||{};var l=e+"_group";this._after[l]={index:0,results:[]},t("After emit %s times, event %s's listenner will execute",n,e);var p=function(s,a){s===e&&(n--,o.push(a),1>n&&(t("Event %s was emit %s, and execute the listenner",e,n),i.unbindForAll(p),r.apply(null,[o]))),s===l&&(n--,i._after[l].results[a.index]=a.result,1>n&&(t("Event %s was emit %s, and execute the listenner",e,n),i.unbindForAll(p),r.call(null,i._after[l].results)))};return i.bindForAll(p),this},i.prototype.group=function(t,n){var r=this,i=t+"_group",o=r._after[i].index;return r._after[i].index++,function(t,l){return t?r.emit.apply(r,["error"].concat(e.call(arguments))):void r.emit(i,{index:o,result:n?n.apply(null,e.call(arguments,1)):l})}},i.prototype.any=function(){var n=this,r=arguments[arguments.length-1],i=e.call(arguments,0,-1),o=i.join("_");t("Add listenner for Any of events %j emit",i),n.once(o,r);for(var l=function(e){n.bind(e,function(r){t("One of events %j emited, execute the listenner"),n.trigger(o,{data:r,eventName:e})})},p=0;p<i.length;p++)l(i[p])},i.prototype.not=function(e,n){var r=this;t("Add listenner for not event %s",e),r.bindForAll(function(r,i){r!==e&&(t("listenner execute of event %s emit, but not event %s.",r,e),n(i))})},i.prototype.done=function(t,n){var r=this;return function(i,o){if(i)return r.emit.apply(r,["error"].concat(e.call(arguments)));var l=e.call(arguments,1);return"string"==typeof t?n?r.emit(t,n.apply(null,l)):r.emit.apply(r,[t].concat(l)):arguments.length<=2?t(o):void t.apply(null,l)}},i.prototype.doneLater=function(t,e){var n=this.done(t,e);return function(t,e){var r=arguments;o(function(){n.apply(null,r)})}},i.create=function(){var t=new i,e=n.apply([],arguments);if(e.length){var r=e[e.length-1],o=e[e.length-2];"function"==typeof r&&"function"==typeof o&&(e.pop(),t.fail(r)),t.assign.apply(t,e)}return t},i.EventProxy=i,i});
//# sourceMappingURL=eventproxy.min.js.map