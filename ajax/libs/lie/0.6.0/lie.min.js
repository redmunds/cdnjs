/*! lie 0.6.0 2013-08-17*/
/*! (c)2013 Ruben Verborgh & Calvin Metcalf @license MIT https://github.com/calvinmetcalf/lie*/!function(){var a=function(a,b){function Deferred(){function Promise(){this.then=function(b,c){return a(b,c)}}var a=function(g,h,i){var j;if(g!==a)return j=c(),a.queue.push({deferred:j,resolve:g,reject:h}),j.promise;for(var k,l,m,n=h?"resolve":"reject",o=0,p=a.queue.length;p>o;o++)k=a.queue[o],l=k.deferred,m=k[n],typeof m!==f?l[n](i):e(m,i,l);a=d(b,i,h)},b=new Promise;this.promise=b,a.queue=[],this.resolve=function(b){a.queue&&a(a,!0,b)},this.fulfill=this.resolve,this.reject=function(b){a.queue&&a(a,!1,b)}}function c(){return new Deferred}function d(a,b,d){return function(g,h){var i,j=d?g:h;return typeof j!==f?a:(e(j,b,i=c()),i.promise)}}function e(b,c,d){a(function(){var a;try{a=b(c),a&&typeof a.then===f?a.then(d.resolve,d.reject):d.resolve(a)}catch(e){d.reject(e)}})}var f="function";return b.resolve=function(a){var b={};return b.then=d(b,a,!0),b},b.reject=function(a){var b={};return b.then=d(b,a,!1),b},b.deferred=c,b};"function"==typeof define?define(["setImmediate"],function(b){return a(b,{})}):"undefined"!=typeof module&&"exports"in module?a(process.nextTick,exports):a("function"==typeof setImmediate?setImmediate:setTimeout,window)}();