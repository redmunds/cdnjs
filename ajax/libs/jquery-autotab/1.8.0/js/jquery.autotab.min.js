/**
 * Autotab - jQuery plugin 1.8.0
 * https://github.com/Mathachew/jquery-autotab
 * 
 * Copyright (c) 2008, 2014 Matthew Miller
 * 
 * Licensed under the MIT licensing:
 *   http://www.opensource.org/licenses/mit-license.php
 */

(function(d){var t=navigator.platform,n=null,r="iPad"===t||"iPhone"===t||"iPod"===t,v="undefined"!==typeof InstallTrigger,g=function(a,e){if(null!==e&&"undefined"!==typeof e)for(var b in e)d(a).data("autotab-"+b,e[b])},m=function(a){var e={format:"all",loaded:!1,disabled:!1,pattern:null,uppercase:!1,lowercase:!1,nospace:!1,maxlength:2147483647,target:null,previous:null,trigger:null,originalValue:"",changed:!1,editable:"text"==a.type||"password"==a.type||"textarea"==a.type,tabOnSelect:!1};if(!0===
d.autotab.selectFilterByClass&&"undefined"===typeof d(a).data("autotab-format")){var b="all text alpha number numeric alphanumeric hex hexadecimal custom".split(" "),c;for(c in b)if(d(a).hasClass(b[c])){e.format=b[c];break}}for(c in e)"undefined"!==typeof d(a).data("autotab-"+c)&&(e[c]=d(a).data("autotab-"+c));e.loaded||(null!==e.trigger&&"string"===typeof e.trigger&&(e.trigger=e.trigger.toString()),g(a,e));return e},p=function(a){return"undefined"!==typeof a&&("string"===typeof a||!(a instanceof
jQuery))};d.autotab=function(a){"object"!==typeof a&&(a={});d(":input").autotab(a)};d.autotab.selectFilterByClass=!1;d.autotab.next=function(){var a=d(document.activeElement);a.length&&a.trigger("autotab-next")};d.autotab.previous=function(){var a=d(document.activeElement);a.length&&a.trigger("autotab-previous")};d.autotab.remove=function(a){p(a)?d(a).autotab("remove"):d(":input").autotab("remove")};d.autotab.restore=function(a){p(a)?d(a).autotab("restore"):d(":input").autotab("restore")};d.autotab.refresh=
function(a){p(a)?d(a).autotab("refresh"):d(":input").autotab("refresh")};d.fn.autotab=function(a,e){if(!this.length)return this;var b=d.grep(this,function(a,b){return"hidden"!=a.type});if("filter"==a){if("string"===typeof e||"function"===typeof e)e={format:e};for(var c=0,h=b.length;c<h;c++){var f=m(b[c]),k=e;k.target=f.target;k.previous=f.previous;d.extend(f,k);f.loaded?g(b[c],f):(f.disabled=!0,s(b[c],k))}}else if("remove"==a||"destroy"==a||"disable"==a)for(c=0,h=b.length;c<h;c++)f=m(b[c]),f.disabled=
!0,g(b[c],f);else if("restore"==a||"enable"==a)for(c=0,h=b.length;c<h;c++)f=m(b[c]),f.disabled=!1,g(b[c],f);else if("refresh"==a)for(c=0,h=b.length;c<h;c++){var f=m(b[c]),q=c+1,l=c-1;null===f.target||"undefined"===typeof f.target||""===f.target.selector?f.target=0<c&&q<h?b[q]:0<c?null:b[q]:console.log("target selector!");null===f.previous||"undefined"===typeof f.previous||""===f.previous.selector?f.previous=0<c&&q<h?b[l]:0<c?b[l]:null:console.log("previous selector!");f.loaded?(p(f.target)&&(f.target=
d(f.target)),p(f.previous)&&(f.previous=d(f.previous)),g(b[c],f)):s(b[c],f)}else if(null===a||"undefined"===typeof a?e={}:"string"===typeof a||"function"===typeof a?e={format:a}:"object"===typeof a&&(e=a),1<b.length)for(c=0,h=b.length;c<h;c++)q=c+1,l=c-1,k=e,0<c&&q<h?(k.target=b[q],k.previous=b[l]):0<c?(k.target=null,k.previous=b[l]):(k.target=b[q],k.previous=null),s(b[c],k);else s(b[0],e);return this};var u=function(a,d,b){if("function"===typeof b.format)return b.format(d,a);a=null;switch(b.format){case "text":a=
RegExp("[0-9]+","g");break;case "alpha":a=RegExp("[^a-zA-Z]+","g");break;case "number":case "numeric":a=RegExp("[^0-9]+","g");break;case "alphanumeric":a=RegExp("[^0-9a-zA-Z]+","g");break;case "hex":case "hexadecimal":a=RegExp("[^0-9A-Fa-f]+","g");break;case "custom":a=new RegExp(b.pattern,"g")}null!==a&&(d=d.replace(a,""));b.nospace&&(a=RegExp("[ ]+","g"),d=d.replace(a,""));b.uppercase&&(d=d.toUpperCase());b.lowercase&&(d=d.toLowerCase());return d},s=function(a,e){var b=m(a);b.disabled&&(b.disabled=
!1,b.target=null,b.previous=null);d.extend(b,e);p(b.target)&&(b.target=d(b.target));p(b.previous)&&(b.previous=d(b.previous));var c=a.maxLength;"undefined"===typeof a.maxLength&&"textarea"==a.type&&(c=a.maxLength=a.getAttribute("maxlength"));2147483647==b.maxlength&&2147483647!=c&&-1!=c?b.maxlength=c:0<b.maxlength?a.maxLength=b.maxlength:b.target=null;if(b.loaded)g(a,b);else{b.loaded=!0;g(a,b);if("select-one"==a.type)d(a).on("change",function(a){m(this).tabOnSelect&&d(this).trigger("autotab-next")});
d(a).on("autotab-next",function(a,b){var d=this;setTimeout(function(){b||(b=m(d));var a=b.target;b.disabled||!a.length||r||(a.prop("disabled")||a.prop("readonly")?a.trigger("autotab-next"):a.focus().select(),n=new Date)},1)}).on("autotab-previous",function(a,b){var d=this;setTimeout(function(){b||(b=m(d));var a=b.previous;if(!b.disabled&&a.length){var c=a.val();a.prop("disabled")||a.prop("readonly")?a.trigger("autotab-previous"):c.length&&a.data("autotab-editable")?(a.focus().val(c.substring(0,c.length-
1)),g(a,{changed:!0})):a.focus();n=null}},1)}).on("focus",function(){g(this,{originalValue:this.value})}).on("blur",function(){var a=m(this);a.changed&&this.value!=a.originalValue&&(g(this,{changed:!1}),d(this).change())}).on("keydown",function(a){var b=m(this);if(!b||b.disabled)return!0;var c=a.which||a.charCode;if(8==c){if("select-one"===this.type||"checkbox"===this.type||"radio"===this.type||"button"===this.type||"submit"===this.type||"range"===this.type)return d(this).trigger("autotab-previous",
b),!1;0===this.value.length?d(this).trigger("autotab-previous",b):g(this,{changed:this.value!==b.originalValue})}else if(9==c&&null!==n)if(a.shiftKey)n=null;else if(800>(new Date).getTime()-n.getTime())return n=null,!1}).on("keypress",function(a){var b=m(this),c=a.which||a.keyCode;if(!b||b.disabled||v&&0===a.charCode||a.ctrlKey||a.altKey||13==c||"text"!=this.type&&"password"!=this.type&&"textarea"!=this.type||this.disabled)return!0;c=String.fromCharCode(c);if(null!==b.trigger&&0<=b.trigger.indexOf(c))return null!==
n&&800>(new Date).getTime()-n.getTime()?n=null:d(this).trigger("autotab-next",b),!1;n=null;a=document.selection&&document.selection.createRange?!0:0<a.charCode;c=u(this,c,b);if(a&&(null===c||""===c))return!1;if(a&&this.value.length<=this.maxLength){var e,l;a=0;if("number"===typeof this.selectionStart&&"number"===typeof this.selectionEnd)e=this.selectionStart,l=this.selectionEnd,a=1;else if(document.selection&&document.selection.createRange){l=document.selection.createRange();e=this.createTextRange();
a=this.createTextRange();var p=l.getBookmark();e.moveToBookmark(p);a.setEndPoint("EndToStart",e);e=a.text.length;l=e+l.text.length;a=2}if(0===e&&l==this.value.length)this.value=c;else{if(this.value.length==this.maxLength&&e===l)return d(this).trigger("autotab-next",b),!1;this.value=this.value.slice(0,e)+c+this.value.slice(l)}g(this,{changed:this.value!=b.originalValue});this.value.length!=b.maxlength&&(e++,1==a?this.selectionStart=this.selectionEnd=e:2==a&&(c=this.createTextRange(),c.collapse(!0),
c.moveEnd("character",e),c.moveStart("character",e),c.select()))}this.value.length==b.maxlength&&d(this).trigger("autotab-next",b);return!1}).on("paste",function(a){var b=m(this);if(!b)return!0;this.maxLength=2147483647;(function(a,c){setTimeout(function(){var e=-1,g=document.createElement("input");g.type="hidden";g.value=a.value.toLowerCase();g.originalValue=a.value;a.maxLength=c.maxlength;a.value=u(a,a.value,c).substr(0,c.maxlength);var h=function(a,b){if(a){var c=m(a);if(d(a).prop("disabled")||
d(a).prop("readonly"))d(a).trigger("autotab-next"),r||h(c.target[0],b);else{for(var f=0,k=b.length;f<k;f++)e=g.value.indexOf(b.charAt(f).toLowerCase(),e)+1;f=g.originalValue.substr(e);(f=u(a,f,c).substr(0,c.maxlength))?(a.value=f,f.length==c.maxlength&&(d(a).trigger("autotab-next",c),r||h(c.target[0],f))):a.value=""}}};a.value.length==c.maxlength&&(d(a).trigger("autotab-next",b),r||h(c.target[0],a.value.toLowerCase()))},1)})(this,b)})}};d.fn.autotab_magic=function(a){return d(this).autotab()};d.fn.autotab_filter=
function(a){var e={};"string"===typeof a||"function"===typeof a?e.format=a:d.extend(e,a);return d(this).autotab("filter",e)}})(jQuery);
