// SVG Plugin for KUTE.js | dnp_theme | MIT License
!function(t){if("function"==typeof define&&define.amd)define(["./kute.js"],function(e){return t(e),e});else if("object"==typeof module&&"function"==typeof require){var e=require("./kute.js");module.exports=t(e)}else{if("undefined"==typeof window.KUTE)throw new Error("SVG Plugin require KUTE.js.");window.KUTE.svg=window.KUTE.svg||t(e)}}(function(t){"use strict";var e,r=window.KUTE,n=n||{},i=r.selector("path")||r.selector("svg"),o=i&&i.ownerSVGElement&&i.ownerSVGElement.namespaceURI||"http://www.w3.org/2000/svg",a=["strokeWidth","strokeOpacity","fillOpacity","stopOpacity"],s=["fill","stroke","stopColor"],h=/(m[^(h|v|l)]*|[vhl][^(v|h|l|z)]*)/gim;if(!i||i.ownerSVGElement){n.gPt=function(t){var e={},r="object"==typeof t?t:/^\.|^\#/.test(t)?document.querySelector(t):null;if(r&&/path|glyph/.test(r.tagName))e.e=n.fPt(r),e.o=r.getAttribute("d");else if(!r&&/[a-z][^a-z]*/gi.test(t)){var i=n.cP(t.trim());e.e=i,e.o=t}return e},n.pCr=function(t){this._mpr=t.morphPrecision||25,this._midx=t.morphIndex,this._smi=t.showMorphInfo,this._rv1=t.reverseFirstPath,this._rv2=t.reverseSecondPath;var e,r=n.gOp(t._vS.path.o),i=n.gOp(t._vE.path.o);this._isp=!/[CSQTA]/i.test(r)&&!/[CSQTA]/i.test(i),e=n._pCr(r,i,t._el.parentNode),t._vS.path.d=e[0],t._vE.path.d=e[1]},n._pCr=function(t,e,r){var i,o,a,s,h,p,l,u,f,c,v,d,g=[];if(this._sp=!1,this._isp){t=n.pTA(t),e=n.pTA(e),h=Math.max(t.length,e.length),h===e.length?(p=t,l=e):(p=e,l=t),f=p.length,u=n.cP("M"+p.join("L")+"z"),c=u.getTotalLength()/h;for(var _=0;h>_;_++)v=u.getPointAtLength(c*_),d=n.gCP(c,v,p),g.push([d[0],d[1]]);h===e.length?(o=l,i=g):(i=l,o=g)}else t=n.cP(t),e=n.cP(e),a=n.gSegs(t,e,this._mpr),i=a[0],o=a[1],h=o.length;if(this._rv1&&i.reverse(),this._rv2&&o.reverse(),this._smi&&(s=n.gBi(i,o)),this._midx){var m=o.splice(this._midx,h-this._midx);o=m.concat(o)}if(this._smi){n.shP(i,o,r);var y=this._isp?"the polygon with the most points.\n":(25===this._mpr?"the default":"your")+" morphPrecision value of "+this._mpr+".\n";console.log("KUTE.js Path Morph Log\nThe morph used "+h+" points to draw both paths based on "+y+(this._midx?"You've configured the morphIndex to "+this._midx+" while the recommended is "+s+".\n":"You may also consider a morphIndex for the second path. Currently the best index seems to be "+s+".\n")+(this._rv1||this._rv2?"You've chosen that the first path to have "+(this._rv1?"REVERSED draw direction, ":"UNCHANGED draw direction, ")+"while second path is to be "+(this._rv2?"REVERSED.\n":"UNCHANGED.\n"):"If the current animation is not satisfactory, consider reversing one of the paths. Maybe the paths do not intersect or they really have different draw directions."))}return t=e=null,[i,o]},n.gSegs=function(t,e,r){for(var n=[],i=[],o=t.getTotalLength(),a=e.getTotalLength(),s=Math.max(o,a),h=s/r,p=0,l=h*r;(p+=r)<l;)n.push([t.getPointAtLength(p).x,t.getPointAtLength(p).y]),i.push([e.getPointAtLength(p).x,e.getPointAtLength(p).y]);return[n,i]},n.gCP=function(t,e,r){var n,i,o,a,s,h=[],l=r.length;for(p=0;l>p;p++)n=Math.abs(r[p][0]-e.x),i=Math.abs(r[p][1]-e.y),h.push(Math.sqrt(n*n+i*i));return o=h.indexOf(Math.min.apply(null,h)),s=r[o-1]?o-1:l-1,a=r[o+1]?o+1:0,Math.abs(r[s][0]-e.x)<t&&Math.abs(r[s][1]-e.y)<t?r[s]:Math.abs(r[a][0]-e.x)<t&&Math.abs(r[a][1]-e.y)<t?r[a]:Math.abs(r[o][0]-e.x)<t&&Math.abs(r[o][1]-e.y)<t?r[o]:[e.x,e.y]},n.shP=function(t,e,r){if(!this._sp){for(var n,i,a,s,h=arguments,p=0;2>p;p++){a=h[p],s=a.length,i=0===p?{f:"DeepPink",o:"HotPink"}:{f:"Lime",o:"LimeGreen"};for(var l=0;s>l;l++)n=document.createElementNS(o,"circle"),n.setAttribute("cx",a[l][0]),n.setAttribute("cy",a[l][1]),n.setAttribute("r",0===l?20:10),n.setAttribute("fill",0===l?i.f:i.o),this._isp?r.appendChild(n):this._isp||0!==l||r.appendChild(n)}this._sp=!0,n=null}},n.gBi=function(t,e){var r,i,o,a,s=n.clone(t),h=n.clone(e),p=[],l=e.length;for(r=0;l>r;r++)i=h.splice(r,l-r),h=i.concat(h),o=Math.abs(s[r][0]-h[r][0]),a=Math.abs(s[r][1]-h[r][1]),p.push(Math.sqrt(o*o+a*a)),h=[],h=n.clone(e),i=null;return p.indexOf(Math.min.apply(null,p))},n.gOp=function(t){var e=t.split(/z/i);return e.length>2?e[0].trim()+"z":t.trim()},n.cP=function(t){var e=document.createElementNS(o,"path"),r="object"==typeof t?t.getAttribute("d"):t;return e.setAttribute("d",r),e},n.fPt=function(t){if("glyph"===t.tagName){var e=n.cP(t);return t.parentNode.appendChild(e),e}return t},n.clone=function(t){var e;if(t instanceof Array){e=[];for(var r=0,i=t.length;i>r;r++)e[r]=n.clone(t[r]);return e}return t},n.pTA=function(t){for(var e,r,n=t.match(h),i=n.length,o=0,a=0,s=0;i>s;s++)n[s]=n[s],e=n[s][0],r=new RegExp(e+"[^\\d|\\-]*","i"),n[s]=n[s].replace(/(^|[^,])\s*-/g,"$1,-").replace(/(\s+\,|\s|\,)/g,",").replace(r,"").split(","),n[s][0]=parseFloat(n[s][0]),n[s][1]=parseFloat(n[s][1]),0===s?(o+=n[s][0],a+=n[s][1]):(o=n[s-1][0],a=n[s-1][1],/l/i.test(e)?(n[s][0]="l"===e?n[s][0]+o:n[s][0],n[s][1]="l"===e?n[s][1]+a:n[s][1]):/h/i.test(e)?(n[s][0]="h"===e?n[s][0]+o:n[s][0],n[s][1]=a):/v/i.test(e)&&(n[s][0]=o,n[s][1]="v"===e?n[s][0]+a:n[s][0]));return n},r.svq=function(t){t._vE.path&&n.pCr(t)},r.pp.path=function(t,e,i){return"path"in r.dom||(r.dom.path=function(t,e,r){var n,i,o=[];for(n=0,i=t._vE.path.d.length;i>n;n++){o[n]=[];for(var a=0;2>a;a++)o[n].push(t._vS.path.d[n][a]+(t._vE.path.d[n][a]-t._vS.path.d[n][a])*r)}t._el.setAttribute("d",1===r?t._vE.path.o:"M"+o.join("L")+"Z")}),n.gPt(e)},r.prS.path=function(t,e,r){return t.getAttribute("d")},n.gDr=function(t,e){var i,o,a,s,h=t.getTotalLength();return e instanceof Object?e:("string"==typeof e?(e=e.split(/\,|\s/),i=/%/.test(e[0])?n.pc(e[0].trim(),h):parseFloat(e[0]),o=/%/.test(e[1])?n.pc(e[1].trim(),h):parseFloat(e[1])):"undefined"==typeof e&&(s=parseFloat(r.gCS(t,"strokeDashoffset")),a=r.gCS(t,"strokeDasharray").split(/\,/),i=0-s,o=parseFloat(a[0])+i||h),{s:i,e:o,l:h})},n.pc=function(t,e){return parseFloat(t)/100*e},r.pp.draw=function(t,e,i){return"draw"in r.dom||(r.dom.draw=function(t,e,r){var n,i,o,a;n=t._vS.draw.l,i=t._vS.draw.s+(t._vE.draw.s-t._vS.draw.s)*r,o=t._vS.draw.e+(t._vE.draw.e-t._vS.draw.e)*r,a=0-i,t._el.style.strokeDashoffset=a+"px",t._el.style.strokeDasharray=1>o+a?"0px, "+n+"px":o+a+"px, "+n+"px"}),n.gDr(i,e)},r.prS.draw=function(t,e,r){return n.gDr(t)};for(var p=0,l=s.length;l>p;p++)e=s[p],r.pp[e]=function(t,e){return t in r.dom||(r.dom[t]=function(t,e,n){var i={};for(var o in t._vE[e])"a"!==o?i[o]=parseInt(t._vS[e][o]+(t._vE[e][o]-t._vS[e][o])*n)||0:i[o]=t._vS[e][o]&&t._vE[e][o]?parseFloat(t._vS[e][o]+(t._vE[e][o]-t._vS[e][o])*n):null;t._hex?t._el.style[e]=r.rth(i.r,i.g,i.b):t._el.style[e]=i.a?"rgba("+i.r+","+i.g+","+i.b+","+i.a+")":"rgb("+i.r+","+i.g+","+i.b+")"}),r.truC(e)},r.prS[e]=function(t,e,n){return r.gCS(t,e)||"rgba(0,0,0,0)"};for(var p=0,l=a.length;l>p;p++)e=a[p],"strokeWidth"===e?r.pp[e]=function(t,e){return t in r.dom||(r.dom[t]=function(t,e,r){t._el.style[e]=t._vS[e].value+(t._vE[e].value-t._vS[e].value)*r+t._vS[e].unit}),r.pp.box(t,e)}:r.pp[e]=function(t,e){return t in r.dom||(r.dom[t]=function(t,e,r){t._el.style[e]=t._vS[e].value+(t._vE[e].value-t._vS[e].value)*r}),r.pp.unl(t,e)},r.prS[e]=function(t,e,n){return r.gCS(t,e)||0};return n}});