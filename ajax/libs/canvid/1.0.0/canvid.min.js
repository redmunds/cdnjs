!function(e,o){"undefined"!=typeof module&&module.exports?module.exports=o(require("queue-async")):"function"==typeof define&&define.amd?define(["queue"],o):e.canvid=o(e.queue)}(this,function(e){function o(o){function t(e,o,t){var n=images[e]=new Image;n.onload=function(){t(null)},n.src=o}function n(){var e=document.createElement("canvas");return e.width=_opts.width,e.height=_opts.height,e.classList.add("canvid"),el.appendChild(e),e.getContext("2d")}function r(){var e=[].slice.call(el.children);e.forEach(function(e){e.classList.contains("canvid")||(e.style.display="none")})}function i(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return setTimeout(e,1e3/60)}}function a(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))}function s(e){return"function"==typeof e||!!(e&&e.constructor&&e.call&&e.apply)}function c(){for(var e,o={},t=0;t<arguments.length;t++)for(e in arguments[t])arguments[t].hasOwnProperty(e)&&(o[e]=arguments[t][e]);return o}var l={width:800,height:450,selector:".canvid-wrapper"};if(images={},firstPlay=!0,control={play:function(){console.log("cannot play before images are loaded")}},_opts=c(l,o),el=document.querySelector(_opts.selector),!el)return console.warn("Error. No element found for selector",_opts.selector);if(a()){var u=e(4);for(var f in _opts.videos){var d=_opts.videos[f];u.defer(t,f,d.src)}u.awaitAll(function(e){if(e)return console.warn("error while loading video sources",e);var o=n(),t=i();control.play=function(e,n){function i(){d||(a(f),f=+f+(n?-1:1),f<0&&(f+=+c.frames),f>=c.frames&&(f-=c.frames),(n?f!=c.frames-1:f)||m++,c.loops&&m>=c.loops&&(p=!1)),d=(d+1)%((n?.5:1)*h),p&&c.frames>1&&t(i)}function a(e){var t=Math.floor(e%c.cols)*l,n=Math.floor(e/c.cols)*u;o.clearRect(0,0,_opts.width,_opts.height),o.drawImage(s,t,n,l,u,0,0,_opts.width,_opts.height)}control.pause&&control.pause();var s=images[e],c=_opts.videos[e],l=s.width/c.cols,u=s.height/Math.ceil(c.frames/c.cols),f=n?c.frames-1:0,d=0,p=!0,m=0,h=4;t(i),control.resume=function(){p=!0,t(i)},control.pause=function(){p=!1,t(i)},firstPlay&&(firstPlay=!1,r())},s(_opts.loaded)&&_opts.loaded(control)})}else if(opts.srcGif){var p=new Image;p.src=opts.srcGif,el.appendChild(p)}return control}return o});
//# sourceMappingURL=canvid.min.js.map