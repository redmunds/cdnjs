angular.module("angularValidator",[]),angular.module("angularValidator").directive("angularValidator",function(){return{restrict:"A",link:function(a,b){function c(a){for(var b=0;b<a.length;b++)b in a&&d(a[b])}function d(b){"validate-on"in b.attributes&&"blur"===b.attributes["validate-on"].value&&angular.element(b).on("blur",function(){h(b),k(b)});var c=a.$watch(function(){return b.value+b.required+o.submitted+g(b)+e(o[b.name])+f(o[b.name])},function(){if(o.submitted)h(b),k(b);else{var a="validate-on"in b.attributes&&"dirty"===b.attributes["validate-on"].value;a?(h(b),k(b)):o[b.name]&&o[b.name].$pristine&&(h(b),k(b))}});m.push(c)}function e(a){return a&&"$dirty"in a?a.$dirty:void 0}function f(a){return a&&"$valid"in a?a.$valid:void 0}function g(b){if("validator"in b.attributes){var c=a.$eval(b.attributes.validator.value);return o[b.name].$setValidity("angularValidator",c),c}}function h(b){var c=function(){return"<i class='fa fa-times'></i> Required"},d=function(){return"<i class='fa fa-times'></i> Invalid"};if(b.name in o){var e=o[b.name],f=j(b);f&&f.remove(),(e.$dirty||a[b.form.name]&&a[b.form.name].submitted)&&(e.$error.required?angular.element(b).after("required-message"in b.attributes?i(b.attributes["required-message"].value):i(c)):e.$valid||angular.element(b).after("invalid-message"in b.attributes?i(b.attributes["invalid-message"].value):i(d)))}}function i(b){return"<label class='control-label has-error validationMessage'>"+a.$eval(b)+"</label>"}function j(a){for(var b=angular.element(a).parent().children(),c=0;c<b.length;c++)if(angular.element(b[c]).hasClass("validationMessage"))return angular.element(b[c]);return!1}function k(b){if(b.name in o){var c=o[b.name];angular.element(b).removeClass("has-error"),angular.element(b.parentNode).removeClass("has-error"),(c.$dirty||a[b.form.name]&&a[b.form.name].submitted)&&c.$invalid&&(angular.element(b.parentNode).addClass("has-error"),angular.element(b).addClass("has-error"))}}var l=angular.element(b)[0],m=[],n=l.attributes.name.value,o=a[n];o.submitted=!1,a.$watch(function(){return Object.keys(o).length},function(){angular.forEach(m,function(a){a()}),c(l)}),b.on("submit",function(b){b.preventDefault(),a.$apply(function(){o.submitted=!0}),o.$valid&&a.$apply(function(){a.$eval(l.attributes["angular-validator-submit"].value)})}),o.reset=function(){for(var a=0;a<l.length;a++)l[a].name&&(o[l[a].name].$setViewValue(""),o[l[a].name].$render());o.submitted=!1,o.$setPristine()},c(l)}}});