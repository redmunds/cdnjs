!function(t){t.paramquery=t.paramquery||{},t.paramquery.pqgrid=t.paramquery.pqgrid||{},t.paramquery.xmlToArray=function(e,i){var r=i.itemParent,o=i.itemNames,n=[],a=t(e).find(r);return a.each(function(e,i){var r=t(i),a=[];t(o).each(function(t,e){a.push(r.find(e).text())}),n.push(a)}),n},t.paramquery.xmlToJson=function(e,i){var r=i.itemParent,o=i.itemNames,n=[],a=t(e).find(r);return a.each(function(e,i){for(var r=t(i),a={},l=0,s=o.length;s>l;l++){var d=o[l];a[d]=r.find(d).text()}n.push(a)}),n},t.paramquery.tableToArray=function(e){var i=t(e),r=[],o=[],n=i.find("tr:first"),a=i.find("tr:eq(1)");return n.find("th,td").each(function(e,i){var o=t(i),n=o.html(),l=o.width(),s="string",d=a.find("td:eq("+e+")"),h=d.text(),c=d.attr("align");h=h.replace(/,/g,""),parseInt(h)==h&&(parseInt(h)+"").length==h.length?s="integer":parseFloat(h)==h&&(s="float");var u={title:n,width:l,dataType:s,align:c,dataIndx:e};r.push(u)}),i.find("tr").each(function(e,i){if(0!=e){var r=t(i),n=[];r.find("td").each(function(e,i){n.push(t.trim(t(i).html()))}),o.push(n)}}),{data:o,colModel:r}},t.paramquery.formatCurrency=function(t){t=Math.round(10*t)/10,t+="",-1==t.indexOf(".")&&(t+=".0");for(var e=t.length,i=t.substring(0,e-2),r=t.substring(e-2,e),o=i.match(/\d/g).reverse(),n=[],a=0;a<o.length;a++)a>0&&a%3==0&&n.push(","),n.push(o[a]);return n=n.reverse(),i=n.join(""),i+r},t.paramquery.validation={is:function(t,e){return"string"!=t&&t?(t=t.substring(0,1).toUpperCase()+t.substring(1,t.length),this["is"+t](e)):!0},isFloat:function(t){var e=parseFloat(t);return!isNaN(e)&&e==t},isInteger:function(t){var e=parseInt(t);return!isNaN(e)&&e==t},isDate:function(t){var e=Date.parse(t);return!isNaN(e)}}}(jQuery),function(t){var e={};e.options={curPage:0,totalPages:0,totalRecords:0,msg:"",rPPOptions:[10,20,30,40,50,100],rPP:20},e._regional={strDisplay:"Displaying {0} to {1} of {2} items.",strFirstPage:"First Page",strLastPage:"Last Page",strNextPage:"Next Page",strPage:"Page {0} of {1}",strPrevPage:"Previous Page",strRefresh:"Refresh",strRpp:"Records per page:{0}"},t.extend(e.options,e._regional),e._create=function(){var e=this,i=this.options;this.element.addClass("pq-pager"),this.first=t("<button type='button' title='"+i.strFirstPage+"'></button>",{}).appendTo(this.element).button({icons:{primary:"ui-icon-seek-first"},text:!1}).bind("click.paramquery",function(t){e.options.curPage>1&&e._trigger("change",t,{curPage:1})!==!1&&e.option({curPage:1})}),this.prev=t("<button type='button' title='"+i.strPrevPage+"'></button>").appendTo(this.element).button({icons:{primary:"ui-icon-seek-prev"},text:!1}).bind("click",function(t){if(e.options.curPage>1){var i=e.options.curPage-1;e._trigger("change",t,{curPage:i})!==!1&&e.option({curPage:i})}}),t("<span class='pq-separator'></span>").appendTo(this.element),this.pageHolder=t("<span class='pq-page-placeholder'></span>").appendTo(this.element),t("<span class='pq-separator'></span>").appendTo(this.element),this.next=t("<button type='button' title='"+this.options.strNextPage+"'></button>").appendTo(this.element).button({icons:{primary:"ui-icon-seek-next"},text:!1}).bind("click",function(t){var i=e.options.curPage+1;e._trigger("change",t,{curPage:i})!==!1&&e.option({curPage:i})}),this.last=t("<button type='button' title='"+this.options.strLastPage+"'></button>").appendTo(this.element).button({icons:{primary:"ui-icon-seek-end"},text:!1}).bind("click",function(t){var i=e.options.totalPages;e._trigger("change",t,{curPage:i})!==!1&&e.option({curPage:i})}),t("<span class='pq-separator'></span>").appendTo(this.element),this.rPPHolder=t("<span class='pq-page-placeholder'></span>").appendTo(this.element),this.$refresh=t("<button type='button' title='"+this.options.strRefresh+"'></button>").appendTo(this.element).button({icons:{primary:"ui-icon-refresh"},text:!1}).bind("click",function(t){e._trigger("refresh",t)!==!1}),t("<span class='pq-separator'></span>").appendTo(this.element),this.$msg=t("<span class='pq-pager-msg'></span>").appendTo(this.element),this._refresh()},e._refreshPage=function(){var e=this;this.pageHolder.empty();for(var i=this.options,r=i.strPage,o=r.split(" "),n=[],a=0,l=o.length;l>a;a++){var s=o[a];"{0}"==s?n.push("<input type='text' tabindex='0' class='ui-corner-all' />"):"{1}"==s?n.push("<span class='total'></span>"):n.push("<span>",s,"</span>")}var d=n.join(""),h=t(d).appendTo(this.pageHolder);this.page=h.filter("input").bind("change",function(r){var o=t(this),n=o.val();return isNaN(n)||1>n?(o.val(i.curPage),!1):(n=parseInt(n),n>i.totalPages?(o.val(i.curPage),!1):e._trigger("change",r,{curPage:n})===!1?(o.val(i.curPage),!1):void e.option({curPage:n}))}),this.$total=h.filter("span.total")},e._refresh=function(){this._refreshPage();var e=(this.$rPP,this),i=this.options;if(this.first.attr("title",i.strFirstPage),this.prev.attr("title",i.strPrevPage),this.next.attr("title",i.strNextPage),this.last.attr("title",i.strLastPage),this.$refresh.attr("title",i.strRefresh),this.rPPHolder.empty(),i.strRpp){var r=i.rPPOptions,o=i.strRpp;if(-1!=o.indexOf("{0}")){for(var n=["<select class='ui-corner-all'>"],a=0,l=r.length;l>a;a++){var s=r[a];n.push('<option value="',s,'">',s,"</option>")}n.push("</select>");var d=n.join("");o=o.replace("{0}","</span>"+d),o="<span>"+o+"<span class='pq-separator'></span>"}else o="<span>"+o+"</span><span class='pq-separator'></span>";this.$rPP=t(o).appendTo(this.rPPHolder).filter("select").val(i.rPP).change(function(i){var r=t(this).val();return e._trigger("change",i,{rPP:r})!==!1?(e.options.rPP=r,!1):void 0})}if(i.curPage>=i.totalPages?(this.next.button({disabled:!0}),this.last.button({disabled:!0})):(this.next.button({disabled:!1}),this.last.button({disabled:!1})),i.curPage<=1?(this.first.button({disabled:!0}),this.prev.button({disabled:!0})):(this.first.button({disabled:!1}),this.prev.button({disabled:!1})),this.page.val(i.curPage),this.$total.text(i.totalPages),this.options.totalRecords>0){var h=i.rPP,c=i.curPage,u=i.totalRecords,f=(c-1)*h,p=c*h;p>u&&(p=u);var g=i.strDisplay;g=g.replace("{0}",f+1),g=g.replace("{1}",p),g=g.replace("{2}",u),this.$msg.html(g)}else this.$msg.html("")},e._destroy=function(){this.element.empty().removeClass("pq-pager").enableSelection()},e._setOption=function(e,i){"curPage"!=e&&"totalPages"!=e||(i=parseInt(i)),t.Widget.prototype._setOption.call(this,e,i)},e._setOptions=function(){t.Widget.prototype._setOptions.apply(this,arguments),this._refresh()},t.widget("paramquery.pqPager",e),t.paramquery.pqPager.regional={},t.paramquery.pqPager.regional.en=e._regional,t.paramquery.pqPager.setDefaults=function(i){for(var r in i)e.options[r]=i[r];t.widget("paramquery.pqPager",e),t(".pq-pager").each(function(e,r){t(r).pqPager("option",i)})}}(jQuery),function(t){var e={};e.options={length:200,num_eles:3,cur_pos:0,timeout:350,pace:"optimum",direction:"vertical",theme:!1},e._destroy=function(){this.element.removeClass("pq-sb-vert pq-sb-vert-t pq-sb-vert-wt").enableSelection().removeClass("pq-sb-horiz pq-sb-horiz-t pq-sb-horiz-wt").unbind("click.pq-scrollbar").empty(),this.element.removeData()},e._create=function(){this._createLayout()},e._createLayout=function(){var e=this,i=this.options,r=i.direction,o=i.theme,n=this.element.empty();"vertical"==r?(n.removeClass("pq-sb-vert-t pq-sb-vert-wt").addClass("pq-sb-vert"),o?(n.addClass("pq-sb-vert-t"),n.html(["<div class='top-btn pq-sb-btn ui-state-default ui-corner-top'>","<div class='ui-icon ui-icon-triangle-1-n'></div></div>","<div class='pq-sb-slider ui-corner-all ui-state-default'>","</div>","<div class='bottom-btn pq-sb-btn ui-state-default ui-corner-bottom'>","<div class='ui-icon ui-icon-triangle-1-s'></div></div>"].join(""))):(n.addClass("pq-sb-vert-wt"),n.html(["<div class='top-btn pq-sb-btn'></div>","<div class='pq-sb-slider'>","<div class='vert-slider-top'></div>","<div class='vert-slider-bg'></div>","<div class='vert-slider-center'></div>","<div class='vert-slider-bg'></div>","<div class='vert-slider-bottom'></div>","</div>","<div class='bottom-btn pq-sb-btn'></div>"].join("")))):(n.removeClass("pq-sb-horiz-t pq-sb-horiz-wt").addClass("pq-sb-horiz"),o?(n.addClass("pq-sb-horiz-t"),n.html(["<div class='left-btn pq-sb-btn ui-state-default ui-corner-left'>","<div class='ui-icon ui-icon-triangle-1-w'></div></div>","<div class='pq-sb-slider pq-sb-slider-h ui-state-default ui-corner-all'>","</div>","<div class='right-btn pq-sb-btn ui-state-default ui-corner-right'>","<div class='ui-icon ui-icon-triangle-1-e'></div></div>"].join(""))):(n.addClass("pq-sb-horiz-wt"),n.width(this.width),n.html(["<div class='left-btn pq-sb-btn'></div>","<div class='pq-sb-slider pq-sb-slider-h'>","<span class='horiz-slider-left'></span>","<span class='horiz-slider-bg'></span>","<span class='horiz-slider-center'></span>","<span class='horiz-slider-bg'></span>","<span class='horiz-slider-right'></span>","</div>","<div class='right-btn pq-sb-btn'></div>"].join("")))),n.disableSelection().on("mouseup.pq-scrollbar",function(t){e.sbmouseup=!0}).on("mousedown.pq-scrollbar",function(t){if(e.sbmouseup=!1,!i.disabled&&!e.$slider.is(":hidden"))if("vertical"==r){var o=t.pageY,n=e.element.offset().top,a=n+i.length,l=e.$slider,s=l.offset().top,d=l.height(),h=s+d;s>o&&o>n+17?e.mousedownInterval=window.setInterval(function(){e.sbmouseup||o>=l.offset().top?(window.clearInterval(e.mousedownInterval),e.mousedownInterval=null):e._pageUp(t)},0):o>h&&a-17>o&&(e.mousedownInterval=window.setInterval(function(){e.sbmouseup||o<=l.offset().top+d?(window.clearInterval(e.mousedownInterval),e.mousedownInterval=null):e._pageDown(t)},0))}else{var c=t.pageX,n=e.element.offset().left,a=n+i.length,s=e.$slider.offset().left,h=s+e.$slider.width();s>c&&c>n+17?(e.$slider.css("left",c-e.element.offset().left),e._updateCurPosAndTrigger(t)):c>h&&a-17>c&&(e.$slider.css("left",c-e.element.offset().left-e.$slider.width()),e._updateCurPosAndTrigger(t))}});var a=this.$slider=t("div.pq-sb-slider",this.element);o&&a.attr("tabindex","0"),this._bindSliderEvents(a),this.$top_btn=t("div.top-btn,div.left-btn",this.element).click(function(t){return e.options.disabled?void 0:(e.decr_cur_pos(t),t.preventDefault(),!1)}).mousedown(function(t){e.options.disabled||(e.mousedownTimeout=window.setTimeout(function(){e.mousedownInterval=window.setInterval(function(){e.decr_cur_pos(t)},0)},e.options.timeout))}).bind("mouseup mouseout",function(t){e.options.disabled||e._mouseup(t)}),this.$bottom_btn=t("div.bottom-btn,div.right-btn",this.element).click(function(t){return e.options.disabled?void 0:(e.incr_cur_pos(t),t.preventDefault(),!1)}).mousedown(function(t){e.options.disabled||(e.mousedownTimeout=window.setTimeout(function(){e.mousedownInterval=window.setInterval(function(){e.incr_cur_pos(t)},0)},e.options.timeout))}).bind("mouseup mouseout",function(t){e.options.disabled||e._mouseup(t)}),this._refresh()},e._bindSliderEvents=function(e){var i=this,r=this.options.direction,o="x";"vertical"==r&&(o="y"),e.draggable({axis:o,helper:function(t,e){return i._setDragLimits(),this},start:function(t){i.topWhileDrag=null},drag:function(t){i.dragging=!0;var e=i.options.pace;"optimum"==e?i._setNormalPace(t):"fast"==e&&i._updateCurPosAndTrigger(t)},stop:function(t){i._updateCurPosAndTrigger(t),i.dragging=!1,i._refresh()}}).on("keydown",function(e){var r=e.keyCode,o=i.options,n=o.cur_pos,a=o.num_eles,l=t.ui.keyCode;return null==i.keydownTimeout&&(i.keydownTimeout=window.setTimeout(function(){r==l.DOWN||r==l.RIGHT?i.incr_cur_pos(e):r==l.UP||r==l.LEFT?i.decr_cur_pos(e):r==l.HOME?n>0&&(o.cur_pos=0,i.updateSliderPos(),i.scroll(e)):r==l.END?a>n&&(o.cur_pos=a,i.updateSliderPos(),i.scroll(e)):"vertical"==o.direction&&(r==l.PAGE_DOWN?i._pageDown(e):r==l.PAGE_UP&&i._pageUp(e)),i.keydownTimeout=null},0)),r==l.DOWN||r==l.RIGHT||r==l.UP||r==l.LEFT||r==l.PAGE_DOWN||r==l.PAGE_UP||r==l.HOME||r==l.END?(e.preventDefault(),!1):void 0})},e.decr_cur_pos=function(t){var e=this,i=e.options;i.cur_pos>0&&(i.cur_pos--,e.updateSliderPos(),e.scroll(t))},e.incr_cur_pos=function(t){var e=this,i=e.options;i.cur_pos<i.num_eles-1&&i.cur_pos++,e.updateSliderPos(),e.scroll(t)},e._mouseup=function(t){if(!this.options.disabled){var e=this;window.clearTimeout(e.mousedownTimeout),e.mousedownTimeout=null,window.clearInterval(e.mousedownInterval),e.mousedownInterval=null}},e._setDragLimits=function(){var t=this.options;if("vertical"==t.direction){var e=this.element.offset().top+17,i=e+t.length-34-this.slider_length;this.$slider.draggable("option","containment",[0,e,0,i])}else e=this.element.offset().left+17,i=e+t.length-34-this.slider_length,this.$slider.draggable("option","containment",[e,0,i,0])},e._refresh=function(){var t=this.options;t.num_eles<=1?this.element.css("display","none"):this.element.css("display",""),this._validateCurPos(),this.$slider.css("display",""),"vertical"==t.direction?(this.element.height(t.length),this._setSliderBgLength(),this.scroll_space=t.length-34-this.slider_length,(this.scroll_space<4||t.num_eles<=1)&&this.$slider.css("display","none"),this.updateSliderPos(t.cur_pos)):(this.element.width(t.length),this._setSliderBgLength(),this.scroll_space=t.length-34-this.slider_length,(this.scroll_space<4||t.num_eles<=1)&&this.$slider.css("display","none"),this.updateSliderPos(t.cur_pos))},e._setSliderBgLength=function(){var e=this.options,i=e.theme,r=e.length,o=40*e.num_eles+r,n=r-34,a=n*r/o,l=Math.round((a-14)/2);1>l&&(l=1),this.slider_length=14+2*l,"vertical"==e.direction?i?this.$slider.height(this.slider_length-2):(t("div.vert-slider-bg",this.element).height(l),this.$slider.height(this.slider_length)):i?this.$slider.width(this.slider_length-2):(t(".horiz-slider-bg",this.element).width(l),this.$slider.width(this.slider_length))},e._updateCurPosAndTrigger=function(t,e){var i=this,r=this.options,o=r.direction,n=i.$slider;null==e&&(e="vertical"==o?parseInt(n[0].style.top,10):parseInt(n[0].style.left,10));var a=r.length-34-("vertical"==o?n[0].offsetHeight:n[0].offsetWidth),l=(e-17)*(r.num_eles-1)/a;if(l=Math.round(l),r.cur_pos!=l){if(this.dragging){if(null!=this.topWhileDrag){if(this.topWhileDrag<e&&r.cur_pos>l)return;if(this.topWhileDrag>e&&r.cur_pos<l)return}this.topWhileDrag=e}i.options.cur_pos=l,this.scroll(t)}},e._setNormalPace=function(t){this.timer&&(window.clearInterval(this.timer),this.timer=null);var e=this,i=this.options,r=i.direction;e.timer=window.setInterval(function(){var i=e.$slider,o="vertical"==r?parseInt(i[0].style.top,10):parseInt(i[0].style.left,10);e.prev_top==o&&(e._updateCurPosAndTrigger(t,o),window.clearInterval(e.timer),e.timer=null),e.prev_top=o},20)},e.setNumEles=function(t){this.options.num_eles=t,this.updateSliderPos()},e._validateCurPos=function(){var t=this.options;t.cur_pos>=t.num_eles&&(t.cur_pos=t.num_eles-1),t.cur_pos<0&&(t.cur_pos=0)},e.updateSliderPos=function(){var t=this.options,e=this.scroll_space*t.cur_pos/(t.num_eles-1);"vertical"==t.direction?this.$slider.css("top",17+e):this.$slider.css("left",17+e)},e.scroll=function(t){var e=this.options;this._trigger("scroll",t,{cur_pos:e.cur_pos,num_eles:e.num_eles})},e._pageDown=function(t){this._trigger("pageDown",t,null)},e._pageUp=function(t){this._trigger("pageUp",t,null)},e._setOption=function(e,i){t.Widget.prototype._setOption.call(this,e,i),"disabled"==e?1==i?this.$slider.draggable("disable"):this.$slider.draggable("enable"):"theme"==e&&this._createLayout()},e._setOptions=function(){t.Widget.prototype._setOptions.apply(this,arguments),this._refresh()},t.widget("paramquery.pqScrollBar",e)}(jQuery),function(t){t("body").delegate(".pq-editor-focus","focus",function(){t(".pq-grid").find(".pq-cont").enableSelection()}),t("body").delegate(".pq-editor-focus","blur",function(){t(".pq-grid").find(".pq-cont").disableSelection()});var e=function(){};e.prototype.belongs=function(t){return t.target==this.that.element[0]?!0:void 0},t.paramquery.cClass=e;var i=function(t){this.that=t,this.hidearrHS1=[],this.offset=null};t.paramquery.cGenerateView=i;var r=i.prototype;r.generateView=function(e){var i,r,o=this.that,n=o.options,a=n.virtualX,s=n.numberCell,d=o.colModel,h=o.initH,c=o.finalH,u=n.groupModel,f=parseInt(n.freezeCols);parseInt(n.freezeRows);if(e){var p=this._generateTables(null,null,e);e.$cont.empty();var g=t(p);e.$cont.append(g),o.tables||(o.tables=[]);for(var v=-1,w=0;w<o.tables.length;w++){var x=o.tables[w].cont;x==e.$cont[0]&&(v=w)}-1==v?o.tables.push({$tbl:g,cont:e.$cont[0]}):o.tables[v].$tbl=g}else{o._bufferObj_calcInitFinal();var I=o.init;this.init=o.init;var m=o["final"];this["final"]=o["final"];var _=this._generateTables(I,m,e);null!=o.$td_edit&&o.quitEditMode({silent:!0}),o.$cont.empty(),0===o.totalVisibleRows?o.$cont.append("<div class='pq-cont-inner pq-grid-norows' >"+n.strNoRows+"</div>"):a||!f&&!s.show?o.$cont.append("<div class='pq-cont-inner'>"+_+"</div>"):o.$cont.append("<div class='pq-cont-inner'>"+_+"</div><div class='pq-cont-inner'>"+_+"</div>");var b=o.$cont.children("div");if(2==b.length){var q=t(b[0]),y=t(b[1]);g=o.$cont.children().children("table"),o.$tbl=g;var C=t(g[1]);i=l.call(o,-1,f),q.css({width:i,zIndex:1}),r=l.call(o,f,h),y.css({left:i+"px",width:o.$tbl[0].scrollWidth,position:"absolute"}),C.css({left:-1*(r+i)+"px"})}else{g=o.$tbl=o.$cont.children().children("table");t(b[0]);r=l.call(o,f,h),a||g.css({left:"-"+r+"px"})}o._fixTableViewPort(),o._trigger("refresh",null,{dataModel:n.dataModel,colModel:d,pageData:u?o.dataGM:o.data,initV:o.init,finalV:o["final"],initH:h,finalH:c})}},r._generateTables=function(e,i,r){var o=this.that,n=o.colModel,a=(n.length,o.options),l=a.virtualX,s=o.initH,d=o.finalH,h=a.numberCell,c=a.columnBorders,u=a.rowBorders,f=(a.scrollModel,a.groupModel),p=o.hidearrHS,g=(a.freezeCols,parseInt(a.freezeRows)),v=!1,w=o.outerWidths,x=0,I=r?r.data.length-1:i,m=!!f,_=(a.treeModel,r&&r.data?r.data:m?o.dataGM:o.data),b=o.rowIndxOffset;if(!r&&(null==e||null==I))return o.$cont.empty(),void(o.$tbl=null);r||o._trigger("beforeTableView",null,{pageData:_,initV:e,finalV:i,initH:s,finalH:d,colModel:n});var q="pq-grid-table ";c&&(q+="pq-grid-td-border-right "),u&&(q+="pq-grid-td-border-bottom ");var y=["<table class='"+q+"' cellpadding=0 cellspacing=0 >"];if(this.hidearrHS1=[],y.push("<tr class='pq-row-hidden'>"),h.show){var C=h.width+1;y.push("<td style='width:"+C+"px;' ></td>")}for(var $=0;d>=$;$++)if((l||r)&&p[$])this.hidearrHS1.push($);else{var D=n[$];D.hidden||(C=w[$],y.push("<td style='width:"+C+"px;' pq-top-col-indx="+$+"></td>"))}y.push("</tr>"),this.offsetRow=null;for(var x=0;I>=x;x++){e>x&&x>=g&&(x=e);var M=_[x],P=M,R=m?M.rowIndx-b:x,S=M?M.pq_hidden:!1;if(!S)if(v=!1,g&&o.lastFrozenRow==x&&(v=!0),null==this.offsetRow&&null!=R&&(o.offsetRow=x-R),f&&M.groupTitle)this._generateTitleRow(f,M,y,v);else if(f&&M.groupSummary)this._generateSummaryRow(M.data,n,y,v);else{var T=P.pq_detail,k=!1;T&&T.show&&(k=!0),this._generateRow(P,R,n,y,r,v,k),k&&this._generateDetailRow(P,R,n,y,r,v)}}o.scrollMode=!1,y.push("</table>");var H=y.join("");if(r){r.$cont.empty();var E=t(H);r.$cont.append(E),o.tables||(o.tables=[]);for(var V=-1,O=0;O<o.tables.length;O++){var F=o.tables[O].cont;F==r.$cont[0]&&(V=O)}-1==V?o.tables.push({$tbl:E,cont:r.$cont[0]}):o.tables[V].$tbl=E}return H},r._renderCell=function(t){var e=this.that,i=e.options,r=i.dataModel,o=t.rowIndxPage,n=t.rowIndx,a=t.rowData,l=t.colIndx,s=t.$td,d=t.column,h=d.type,c=d.dataIndx,u=a[c],f=t.wrap;if(a){var p;if("checkBoxSelection"==h)p="<input type='checkbox' "+(u?"checked='checked'":"")+" />";else if("detail"==h){var g=i.detailModel,v=u&&u.show?g.expandIcon:g.collapseIcon;p="<div class='ui-icon "+v+"'></div>"}else p=d.render?d.render.call(e.element,{data:e.data,dataModel:r,rowData:a,cellData:u,rowIndxPage:o,rowIndx:n,colIndx:l,column:d,dataIndx:c}):u;""!==p&&void 0!=p||(p="&nbsp;");var w="pq-td-div";0==f&&(w+=" pq-wrap-text");var x,I="";if(t.tree&&(x=i.treeModel)&&x.labelIndx==c){var m=a.pq_leaf,_=a.pq_level,b=!a.pq_collapse,q=(_+1)*x.indent,y="";y=m?x.leafIcon:b?x.expandIcon+" pq-tree-expand-icon":x.collapseIcon+" pq-tree-expand-icon";var C=["<div class='pq-tree-icon-container' style='width:",q,"px;'>","<div class='ui-icon ",y," pq-tree-icon' ></div></div>"].join("");I="<div class='"+w+"'>"+C+p+"</div>"}else I="<div class='"+w+"'>"+p+"</div>";return void 0!=s&&s.html(I),I}},r._generateRow=function(t,e,i,r,o,n,a){var l="pq-grid-row";n&&(l+=" pq-last-freeze-row"),a&&(l+=" pq-detail-master");var s=this.that,d=s.options,h=d.freezeCols,c=d.numberCell,u=d.treeModel,f=!!u.labelIndx,p=d.columnBorders,g=d.wrap,v=(i.length,d.virtualX),w=s.initH,x=s.finalH,I=this.offset,m=(s.hidearrHS,d.customData),_="pq-grid-cell ";d.wrap&&!o||(_+="pq-wrap-text ");var b={rowIndx:e+I,rowIndxPage:e,rowData:t,wrap:g,customData:m};d.stripeRows&&e/2==parseInt(e/2)&&(l+=" pq-grid-oddRow"),t.pq_rowselect&&(l+=" pq-row-select ui-state-highlight");var q,y=t.pq_rowcls,C=t.pq_cellcls;null!=y&&(l+=" "+y),r.push("<tr pq-row-indx='"+e+"' class='"+l+"' >"),c.show&&r.push(["<td class='pq-grid-number-cell ui-state-default'>","<div class='pq-td-div'>",o?"&nbsp;":e+1,"</div></td>"].join(""));for(var $=0;x>=$;$++){if(w>$&&$>=h&&(v||o)&&($=w,$>x))throw"initH>finalH";var D=i[$],M=D.dataIndx;if(!D.hidden){b.column=D,b.colIndx=$,b.dataIndx=M;var P=!1,R=t.pq_cellselect;R&&(P=R[M]);var S="",T=_;if("right"==D.align?T+=" pq-align-right":"center"==D.align&&(T+=" pq-align-center"),$==h-1&&p&&(T+=" pq-last-freeze-col"),D.cls&&(T=T+" "+D.cls),P&&(T+=" pq-cell-select ui-state-highlight"),C){var q=C[M];q&&(T+=" "+q)}var k="pq-col-indx='"+$+"'";o&&(k+=" pq-dataIndx='"+M+"'");var H="";b.tree=f;var E=["<td ",H," class='",T,"' style='",S,"' ",k," >",this._renderCell(b),"</td>"].join("");r.push(E)}}return r.push("</tr>"),r};var o={widgetEventPrefix:"pqgrid"};o.options={collapsible:!0,colModel:null,columnBorders:!0,customData:null,dataModel:{cache:!1,dataType:"JSON",location:"local",sorting:"local",sortDir:"up",method:"GET"},direction:"",draggable:!1,editable:!0,editModel:{cellBorderWidth:1,clicksToEdit:1,filterKeys:!0,keyUpDown:!0,saveKey:"",select:!1},editor:{type:"contenteditable"},validation:{icon:"ui-icon-alert",cls:"ui-state-error"},flexHeight:!1,flexWidth:!1,freezeCols:0,freezeRows:0,getDataIndicesFromColIndices:!0,height:400,hoverMode:"row",minWidth:50,numberCell:{width:30,title:"",resizable:!1,minWidth:30,show:!0},pageModel:{curPage:1,totalPages:0,rPP:10,rPPOptions:[10,20,50,100]},resizable:!1,roundCorners:!0,rowBorders:!0,scrollModel:{pace:"fast",horizontal:!0,lastColumn:"auto",autoFit:!1,theme:!1},selectionModel:{type:"row",mode:"range"},showBottom:!0,showHeader:!0,showTitle:!0,showToolbar:!0,showTop:!0,sortable:!0,sql:!1,stripeRows:!0,title:"&nbsp;",treeModel:null,width:600,wrap:!0},o._regional={strAdd:"Add",strDelete:"Delete",strEdit:"Edit",strLoading:"Loading",strNextResult:"Next Result",strNoRows:"No rows to display.",strNothingFound:"Nothing found",strPrevResult:"Previous Result",strSearch:"Search",strSelectedmatches:"Selected {0} of {1} match(es)"},t.extend(o.options,o._regional),o._destroyResizable=function(){this.element.data("resizable")&&this.element.resizable("destroy")},o._destroyDraggable=function(){this.element.data("draggable")&&this.element.draggable("destroy")},o._disable=function(){null==this.$disable&&(this.$disable=t("<div class='pq-grid-disable'></div>").css("opacity",.2).appendTo(this.element))},o._enable=function(){this.$disable&&(this.element[0].removeChild(this.$disable[0]),this.$disable=null)},o._destroy=function(){this._destroyResizable(),this._destroyDraggable(),this.element.empty(),this.element.css("height",""),this.element.css("width",""),this.element.removeClass("pq-grid ui-widget ui-widget-content ui-corner-all").removeData()},o._findCellFromEvtCoords=function(t){throw"not in use"},o._createSlidingTop=function(){var e=this,i=this.$top,r=!1,o=0,n=t(["<div class='pq-slider-icon' style='z-index:5;' >","<span class='ui-icon ui-icon-circle-triangle-n'></span>","</div>"].join("")).appendTo(i),a=n.children("span");n.mouseover(function(t){n.addClass("ui-state-hover")}).mouseout(function(t){n.removeClass("ui-state-hover")}).click(function(t){var i=e.element,n=e.options;r?(i.animate({height:o},function(){e.refresh(),a.addClass("ui-icon-circle-triangle-n").removeClass("ui-icon-circle-triangle-s"),e.$toolbar.pqToolbar("enable")}),r=!1):(o=n.flexHeight?i[0].offsetHeight:n.height,o=parseInt(o)+"px",i.animate({height:"23px"},function(){a.addClass("ui-icon-circle-triangle-s").removeClass("ui-icon-circle-triangle-n"),i.hasClass("ui-resizable")&&i.resizable("destroy"),e.$toolbar.pqToolbar("disable")}),r=!0)}),this.$collapsible=n},null==t.paramquery.pqg_incr&&(t.paramquery.pqg_incr=0),o._create=function(){var e=this;this.iGenerateView=new i(this),this.iKeyNav=new n(this),this.cols=[],this.widths=[],this.outerWidths=[],this.rowHeight=22,this.hidearr=[],this.hidearrHS=[],this.tables=[];var e=this,r=this.options;this.$tbl=null,this._calcThisColModel(),this.iSort=new t.paramquery.cSort(this),this.iSort._refreshSorters(),this._initTypeColumns(),t.paramquery.pqg_incr++;var o=t.paramquery.pqg_incr;this.element.empty().addClass("pq-grid ui-widget ui-widget-content"+(r.roundCorners?" ui-corner-all":"")).append(["<div class='pq-grid-top ui-widget-header",r.roundCorners?" ui-corner-top":"","'>","<div class='pq-grid-title",r.roundCorners?" ui-corner-top":"","'>&nbsp;</div></div>","<div class='pq-grid-inner' ><div class='pq-grid-right'>","<div class='pq-header-outer ui-widget-header'>","<span class='pq-grid-header ui-state-default'></span><span class='pq-grid-header ui-state-default'></span>","</div>","<div class='pq-cont-right' >","<div class='pq-cont pq-cont-",o,"'></div>","</div>","</div></div>","<div class='pq-grid-bottom ui-widget-header",r.roundCorners?" ui-corner-bottom":"","'>","<div class='pq-grid-footer'>&nbsp;</div>","</div>"].join("")),this._trigger("render",null,{dataModel:this.options.dataModel,colModel:this.colModel}),this.$top=t("div.pq-grid-top",this.element),this.$title=t("div.pq-grid-title",this.element),r.showTitle||this.$title.css("display","none"),r.collapsible&&this._createSlidingTop(),this.$toolbar=t("div.pq-grid-toolbar",this.element),this.$grid_inner=t("div.pq-grid-inner",this.element),this.$grid_right=t(".pq-grid-right",this.element),this.$header_o=t("div.pq-header-outer",this.$grid_right),r.showTop||this.$top.css("display","none"),this.$header=t(".pq-grid-header",this.$grid_right),this.$header_left=t(this.$header[0]),this.$header_right=t(this.$header[1]),this.$bottom=t("div.pq-grid-bottom",this.element),r.showBottom||this.$bottom.css("display","none"),this.$footer=t("div.pq-grid-footer",this.element),this.$cont_o=t("div.pq-cont-right",this.$grid_right),this.$cont_fixed=t("div.pq-cont-fixed",this.$grid_right),this.$cont=t("div.pq-cont",this.$grid_right),this.$cont.on("click",function(t){e._onClickCont(t)}),this.$cont.on("click","td.pq-grid-cell",function(i){return t(i.target).closest(".pq-grid")[0]==e.element[0]?e._onClickCell(i):void 0}),this.$cont.on("click","tr.pq-grid-row",function(i){return t(i.target).closest(".pq-grid")[0]==e.element[0]?e._onClickRow(i):void 0}),this.$cont.on("contextmenu","td.pq-grid-cell",function(i){return t(i.target).closest(".pq-grid")[0]==e.element[0]?e._onRightClickCell(i):void 0}),this.$cont.on("contextmenu","tr.pq-grid-row",function(i){return t(i.target).closest(".pq-grid")[0]==e.element[0]?e._onRightClickRow(i):void 0}),this.$cont.on("dblclick","td.pq-grid-cell",function(i){return t(i.target).closest(".pq-grid")[0]==e.element[0]?e._onDblClickCell(i):void 0}),this.$cont.on("dblclick","tr.pq-grid-row",function(i){return t(i.target).closest(".pq-grid")[0]==e.element[0]?e._onDblClickRow(i):void 0}),this.$cont.on("mousedown","td.pq-grid-cell",function(i){return t(i.target).closest(".pq-grid")[0]==e.element[0]?e._onCellMouseDown(i):void 0}),this.$cont.on("mousedown","tr.pq-grid-row",function(i){return t(i.target).closest(".pq-grid")[0]==e.element[0]?e._onRowMouseDown(i):void 0}),this.$cont.on("mousemove","td.pq-grid-cell",function(i){return t(i.target).closest(".pq-grid")[0]==e.element[0]?e._onCellMouseMove(i):void 0}),this.$cont.on("mousemove","tr.pq-grid-row",function(i){return t(i.target).closest(".pq-grid")[0]==e.element[0]?e._onRowMouseMove(i):void 0}),this.$cont.on("mouseup","td.pq-grid-cell",function(i){return t(i.target).closest(".pq-grid")[0]==e.element[0]?e._onCellMouseUp(i):void 0}),this.element.on("mouseup",function(t){return 0==e._trigger("mouseUp",t,{dataModel:e.options.dataModel})?!1:void 0}),this.$cont.on("mouseenter","td.pq-grid-cell",function(i){return t(i.target).closest(".pq-grid")[0]==e.element[0]?e._onCellMouseEnter(i,t(this)):void 0}),this.$cont.on("mouseenter","tr.pq-grid-row",function(i){return t(i.target).closest(".pq-grid")[0]==e.element[0]?e._onRowMouseEnter(i,t(this)):void 0}),this.$cont.on("mouseleave","td.pq-grid-cell",function(i){return t(i.target).closest(".pq-grid")[0]==e.element[0]?e._onCellMouseLeave(i,t(this)):void 0}),this.$cont.on("mouseleave","tr.pq-grid-row",function(i){return t(i.target).closest(".pq-grid")[0]==e.element[0]?e._onRowMouseLeave(i,t(this)):void 0}),this.$cont.bind("mousewheel DOMMouseScroll",function(t){return e._onMouseWheel(t)});this.$hvscroll=t("<div class='pq-hvscroll-square ui-widget-content'></div>").appendTo(this.$grid_inner),this.$vscroll=t("<div class='pq-vscroll'></div>").appendTo(this.$grid_inner),this.prevVScroll=0;var a=r.scrollModel;this.$vscroll.pqScrollBar({pace:a.pace,theme:a.theme,direction:"vertical",cur_pos:0,pageDown:function(t,i){e.iKeyNav.pageDown()},pageUp:function(t,i){e.iKeyNav.pageUp()},scroll:function(t,i){e.scrollMode=!0,e.setFlexWHCallback(function(){e.iGenerateView.generateView()});var r;r=t.originalEvent&&"drag"==t.originalEvent.type?e._setScrollVNumEles():e._setScrollVNumEles(!0),1>=r&&(e._setScrollHLength(),e._setScrollHVLength())}});this.$hscroll=t("<div class='pq-hscroll'></div>").appendTo(this.$grid_inner),this.$hscroll.pqScrollBar({direction:"horizontal",pace:a.pace,theme:a.theme,cur_pos:0,scroll:function(t,i){e.refresh()}}),this._refreshGridWidth(),this.element.height(r.height),this.disableSelection(),window.opera?this.$grid_inner.bind("keypress.pq-grid",{that:this},function(i){t(i.target).closest(".pq-grid")[0]==e.element[0]&&e._onKeyPressDown(i)}):this.$grid_inner.bind("keydown.pq-grid",{that:this},function(i){t(i.target).closest(".pq-grid")[0]==e.element[0]&&e._onKeyPressDown(i)}),this._refreshOptions(),this._refreshTitle(),this._refreshDataIndices(),this.iRows=new t.paramquery.cRows(this),this.iCells=new t.paramquery.cCells(this),this.generateLoading(),this._initPager()},o._refreshGridWidth=function(){var e,i=this.options,r=this.element;if(-1!=(i.width+"").indexOf("%")){var o=r.parent(),n=o.width(),a=null;if(0==n){for(;"BODY"!=o[0].tagName.toUpperCase();){var l=o.parent();if(null==l[0]){a=o;break}o=l}if(a){var s=a.css("position"),d=a.css("left"),h=a.css("top");a.css({position:"absolute",left:"-2000",top:"-2000"}).appendTo(t(document.body)),n=r.parent().width(),a.css({position:s,left:d,top:h})}}var e=parseInt(i.width)*n/100}else e=i.width;r.width(e),r.width(r.width())},o._onMouseWheel=function(t){if(this.options.flexHeight)return!0;var e=this,i=0,t=t.originalEvent;t.wheelDelta?i=t.wheelDelta/120:t.detail&&(i=-1*t.detail/3);var r=parseInt(e.$vscroll.pqScrollBar("option","cur_pos")),o=r-i;return o>=0&&e.$vscroll.pqScrollBar("option","cur_pos",r-i).pqScrollBar("scroll"),!1},o._onDblClickCell=function(e){var i=this,r=t(e.currentTarget),o=i.getCellIndices({$td:r}),n=o.rowIndxPage,a=i.rowIndxOffset,l=n+a,s=o.colIndx;return null!=s?0==i._trigger("cellDblClick",e,{$td:r,rowIndxPage:n,rowIndx:l,colIndx:s,column:i.colModel[s],rowData:i.data[n]})?!1:void(i.options.editModel.clicksToEdit>1&&this.isEditableRow({rowIndx:l})&&this.isEditableCell({colIndx:s,rowIndx:l})&&i._editCell(r)):void 0},o._onClickCont=function(t){},o._onClickRow=function(e){var i=this,r=t(e.currentTarget),o=parseInt(r.attr("pq-row-indx")),n=i.rowIndxOffset,a=o+n;if(!isNaN(o)){this.options;return 0==i._trigger("rowClick",e,{$tr:r,rowIndxPage:o,rowIndx:a,rowData:i.data[o]})?!1:void 0}},o._onRightClickRow=function(e){var i=this,r=t(e.currentTarget),o=parseInt(r.attr("pq-row-indx")),n=i.rowIndxOffset,a=o+n;
if(!isNaN(o)){this.options;return 0==i._trigger("rowRightClick",e,{$tr:r,rowIndxPage:o,rowIndx:a,rowData:i.data[o]})?!1:void 0}},o._onDblClickRow=function(e){var i=this,r=t(e.currentTarget),o=parseInt(r.attr("pq-row-indx")),n=i.getRowIndxOffset(),a=o+n;return 0==i._trigger("rowDblClick",e,{$tr:r,rowIndxPage:o,rowIndx:a,rowData:i.data[o]})?!1:void 0},o._isValid=function(e){var i=this,r=e.rowData,o=t.trim(e.value),n=e.column,a=n.dataIndx,l=this.options.validation,s=n.validations;if(s&&s.length>0)for(var d=0;d<s.length;d++){var h=s[d],h=t.extend({},l,h),c=h.type,u=h.msg,u=u?u:"&nbsp;",f=h.icon,p=h.cls,p=p?p:"",g="padding:3px 10px;"+h.style,v=h.css,w=!0,x={valid:!1,msg:u,dataIndx:a},I=h.value;if("minLen"==c&&o.length<I)w=!1;else if("maxLen"==c&&o.length>I)w=!1;else if("gt"==c&&I>=o)w=!1;else if("gte"==c&&I>o)w=!1;else if("lt"==c&&o>=I)w=!1;else if("lte"==c&&o>I)w=!1;else if("regexp"==c&&0==new RegExp(I).test(o))w=!1;else if("function"==typeof c){var m={column:n,value:o,rowData:r,msg:u};0==c.call(i.element,m)&&(w=!1,m.msg!=u&&(u=m.msg))}if(!w){var _=this.getRowIndx({rowData:r}).rowIndx;null!=_&&(this.goToPage({rowIndx:_}),this.scrollRow({rowIndx:_}),this.editCell({rowIndx:_,dataIndx:a}));var b=this.getEditCell();if(b&&b.$cell){var q=b.$cell;q.attr("title",u);try{q.tooltip("destroy")}catch(y){}q.tooltip({position:{my:"left top",at:"right top"},content:function(){var e=(t(this),""==f?"":"<span class='ui-icon "+f+" pq-tooltip-icon'></span>");return e+u},open:function(t,e){if(p&&e.tooltip.addClass(p),g){var i=e.tooltip.attr("style");e.tooltip.attr("style",i+";"+g)}v&&e.tooltip.css(v)}}).tooltip("open"),q.find(".pq-editor-focus").focus()}return x}}return{valid:!0}},o.isValid=function(t){var e=(t.rowList,this.getRowData(t)),i=t.dataIndx;if(null==i)for(var r=this.colModel,o=0,n=r.length;n>o;o++){var a=r[o],l=a.hidden;if(!l){var i=a.dataIndx,s=e[i],d=this._isValid({rowData:e,value:s,column:a});if(!d.valid)return d}}else{var a=this.getColumn({dataIndx:i}),s=void 0===t.value?e[i]:t.value,d=this._isValid({rowData:e,value:s,column:a});if(!d.valid)return d}return{valid:!0}},o.isEditableRow=function(t){var e=this.options,i=e.editable;if(null!=i){if("function"==typeof i){var r=t.rowIndx,o=e.dataModel.data[r];return i.call(this.element,{rowData:o,rowIndx:r})}return i}return!0},o.isEditableCell=function(t){var e=t.colIndx,i=t.dataIndx,e=null==e?this.getColIndx({dataIndx:i}):e,r=this.colModel[e],i=null==i?r.dataIndx:i,o=r.editable;if(t.checkVisible&&r.hidden)return!1;if(null!=o){if("function"==typeof o){var n=t.rowIndx,a=this.getRowData(t);return o.call(this.element,{rowIndx:n,rowData:a,column:r,dataIndx:i})}return o}return!0},o._getRowPQData=function(t,e,i){var i=null==i?this.data[t]:i;return i?i[e]:null},o._setRowPQData=function(t,e,i){var i=null==i?this.data[t]:i;if(i)for(var r in e)i[r]=e[r]},o._onCellMouseDown=function(e){var i=this,r=t(e.currentTarget),o=i.getCellIndices({$td:r});return o.$td=r,o.dataModel=i.options.dataModel,0!=i._trigger("cellMouseDown",e,o)},o._onRowMouseDown=function(e){var i=this,r=t(e.currentTarget),o=i.getRowIndx({$tr:r});return o.$tr=r,o.dataModel=i.options.dataModel,0!=i._trigger("rowMouseDown",e,o)},o._onCellMouseEnter=function(t,e){var i=e,r=this;return 0==r._trigger("cellMouseEnter",t,{$td:i,dataModel:r.options.dataModel})?!1:("cell"==r.options.hoverMode&&r.highlightCell(i),!0)},o._onRowMouseEnter=function(t,e){var i=e,r=this,o=r.getRowIndx({$tr:i}),n=o.rowIndxPage;return 0==r._trigger("rowMouseEnter",t,{$tr:i,dataModel:r.options.dataModel})?!1:("row"==r.options.hoverMode&&r.highlightRow(n),!0)},o._onCellMouseLeave=function(t,e){var i=e,r=this;return 0==r._trigger("cellMouseLeave",t,{$td:i,dataModel:r.options.dataModel})?!1:("cell"==r.options.hoverMode&&r.unHighlightCell(i),!0)},o._onRowMouseLeave=function(t,e){var i=e,r=this,o=r.getRowIndx({$tr:i}),n=o.rowIndxPage;return 0==r._trigger("rowMouseLeave",t,{$tr:i,dataModel:r.options.dataModel})?!1:("row"==r.options.hoverMode&&r.unHighlightRow(n),!0)},o._onCellMouseMove=function(e){var i=this,r=t(e.currentTarget),o=i.getCellIndices({$td:r});return o.$td=r,o.dataModel=i.options.dataModel,0!=i._trigger("cellMouseMove",e,o)},o._onRowMouseMove=function(e){var i=this,r=t(e.currentTarget),o=i.getRowIndx({$tr:r});return o.$tr=r,o.dataModel=i.options.dataModel,0!=i._trigger("rowMouseMove",e,o)},o._onCellMouseUp=function(e){var i=this,r=t(e.currentTarget),o=i.getCellIndices({$td:r});return o.$td=r,o.dataModel=i.options.dataModel,0!=i._trigger("cellMouseUp",e,o)},o._onClickCell=function(e){var i=this,r=this.options,o=this.colModel,n=r.editModel,a=(r.selectionModel,t(e.currentTarget)),l=i.getCellIndices({$td:a}),s=l.rowIndxPage,d=i.rowIndxOffset,h=s+d,c=l.colIndx;if(l.rowIndx=h,null!=c){var u=o[c],f=u.dataIndx;return l.dataIndx=f,l.evt=e,0==i._trigger("cellClick",e,{$td:a,rowIndxPage:s,rowIndx:h,colIndx:c,dataIndx:f,column:u,rowData:i.data[s]})?!1:1==n.clicksToEdit&&this.isEditableRow({rowIndx:h})&&this.isEditableCell({colIndx:c,rowIndx:h})?void window.setTimeout(function(){i.editCell(l)},0):void 0}},o._onRightClickCell=function(e){var i=t(e.currentTarget),r=this.getCellIndices({$td:i}),o=this,n=r.rowIndxPage,a=this.rowIndxOffset,l=n+a,s=r.colIndx,d=this.colModel,h=this.options;h.DM;if(null!=s){var c=d[s],u=c.dataIndx;return 0==this._trigger("cellRightClick",e,{$td:i,rowIndxPage:n,rowIndx:l,colIndx:s,dataIndx:u,column:c,rowData:o.data[n]})?!1:void 0}},o.highlightCell=function(t){t.addClass("pq-grid-cell-hover ui-state-hover")},o.unHighlightCell=function(t){t.removeClass("pq-grid-cell-hover ui-state-hover")},o.highlightRow=function(t){if(isNaN(t));else{var e=this.getRow({rowIndxPage:t});e&&e.addClass("pq-grid-row-hover ui-state-hover")}},o.unHighlightRow=function(t){if(isNaN(t));else{var e=this.getRow({rowIndxPage:t});e&&e.removeClass("pq-grid-row-hover ui-state-hover")}},o._getCreateEventData=function(){return{dataModel:this.options.dataModel,data:this.data,colModel:this.options.colModel}},o._refreshOptions=function(){this._refreshDataOptions()},o._refreshDataOptions=function(){},o.enableSelection=function(){this.$cont.enableSelection()},o.disableSelection=function(){this.$cont.disableSelection(),this.$header.find("tr.pq-grid-title-row").disableSelection()},o._isEditCell=function(e){var i=t(e.target),r=i.closest("div.pq-editor-border-edit");return!!(r&&r.length>0)},o._findCellFromEvt=function(e){var i=t(e.target),r=i.closest(".pq-grid-cell");if(null==r||0==r.length)return{rowIndxPage:null,colIndx:null,$td:null};var o=this.getCellIndices({$td:r});return o.$td=r,o},o._initPager=function(){var t=this.options.pageModel,e=this,i={rPP:t.rPP,rPPOptions:t.rPPOptions,change:function(t,i){e.quitEditMode();var r=e.options.pageModel;void 0!=i.curPage&&(r.prevPage=r.curPage,r.curPage=i.curPage),void 0!=i.rPP&&(r.rPP=i.rPP),"remote"==r.type?e.remoteRequest({callback:function(){e._onDataAvailable({apply:!0})}}):e.refreshView()},refresh:function(t){e.refreshDataAndView()}};t.type&&this.$footer.pqPager(i)},o._refreshHideArrHS=function(){for(var t=this,e=this.colModel,i=t.hidearrHS,r=t.initH,o=t.finalH,n=parseInt(this.options.freezeCols),a=0;n>a;a++)i[a]=!1;for(var a=n;r>a;a++)i[a]=!0;for(var a=r;o>=a;a++)i[a]=!1;for(var a=o+1,l=e.length;l>a;a++)i[a]=!0},o.generateLoading=function(){this.$loading&&this.$loading.remove(),this.$loading=t("<div class='pq-loading'></div>").appendTo(this.element),t(["<div class='pq-loading-bg'></div><div class='pq-loading-mask ui-state-highlight'><div>",this.options.strLoading,"...</div></div>"].join("")).appendTo(this.$loading),this.$loading.find("div.pq-loading-bg").css("opacity",.2)},o._refreshLoadingString=function(){this.$loading.find("div.pq-loading-mask").children("div").html(this.options.strLoading)},o.showLoading=function(){null==this.showLoadingCounter&&(this.showLoadingCounter=0),this.showLoadingCounter++,this.$loading.show()},o.hideLoading=function(){this.showLoadingCounter>0&&this.showLoadingCounter--,this.showLoadingCounter||this.$loading.hide()},o.refreshDataFromDataModel=function(){this._trigger("beforeRefreshData",null,{});var t=this.options,e=t.dataModel,i=t.pageModel,r=e.data,o=i.type;if(this.rowIndxOffset=0,null==r||0==r.length)return o&&(i.curPage=0,i.totalPages=0,i.totalRecords=0),void(this.data=r);if(o&&"local"==o){i.totalRecords=r.length,i.totalPages=Math.ceil(r.length/i.rPP),i.curPage>i.totalPages&&(i.curPage=i.totalPages),i.curPage<1&&i.totalPages>0&&(i.curPage=1);var n=(i.curPage-1)*i.rPP,a=i.curPage*i.rPP;a>r.length&&(a=r.length),this.data=r.slice(n,a)}else if("remote"==o){var l=Math.ceil(i.totalRecords/i.rPP);i.totalPages=l,l&&!i.curPage&&(i.curPage=1);var a=i.rPP;a>r.length&&(a=r.length),this.data=r.slice(0,a)}else this.data=r.slice(0);"local"!=o&&"remote"!=o||(this.rowIndxOffset=i.rPP*(i.curPage-1))},t.paramquery.filter=function(){var t={begin:{text:"Begins With",TR:!0,string:!0},between:{text:"Between",TR:!0,string:!0,date:!0,number:!0},notbegin:{text:"Does not begin with",TR:!0,string:!0},contain:{text:"Contains",TR:!0,string:!0},notcontain:{text:"Does not contain",TR:!0,string:!0},equal:{text:"Equal To",TR:!0,string:!0,bool:!0},notequal:{text:"Not Equal To",TR:!0,string:!0},empty:{text:"Empty",TR:!1,string:!0,bool:!0},notempty:{text:"Not Empty",TR:!1,string:!0,bool:!0},end:{text:"Ends With",TR:!0,string:!0},notend:{text:"Does not end with",TR:!0,string:!0},less:{text:"Less Than",TR:!0,number:!0,date:!0},lte:{text:"Less than or equal",TR:!0,number:!0,date:!0},range:{TR:!0,string:!0,number:!0,date:!0},regexp:{TR:!0,string:!0,number:!0,date:!0},great:{text:"Great Than",TR:!0,number:!0,date:!0},gte:{text:"Greater than or equal",TR:!0,number:!0,date:!0}};return{conditions:t,getAllConditions:function(){var e=[];for(var i in t)e.push(i);return e}(),getConditions:function(e){var i=[];for(var r in t)t[r][e]&&i.push(r);return i},getTRConditions:function(){var e=[];for(var i in t)t[i].TR&&e.push(i);return e}(),getWTRConditions:function(){var e=[];for(var i in t)t[i].TR||e.push(i);return e}()}}(),t.paramquery.filter.rules={},t.paramquery.filter.rules.en={begin:"Begins With",between:"Between",notbegin:"Does not begin with",contain:"Contains",notcontain:"Does not contain",equal:"Equal To",notequal:"Not Equal To",empty:"Empty",notempty:"Not Empty",end:"Ends With",notend:"Does not end with",less:"Less Than",lte:"Less than or equal",great:"Great Than",gte:"Greater than or equal"},o.getQueryStringSort=function(){var t=this.iSort.sorters,e="",i=this.options,r=i.sql,o=i.stringify;if(r){for(var n=0;n<t.length;n++){var a=t[n],l=a.dataIndx,s="up"==a.dir?"asc":"desc";e+=(n>0?", ":"")+l+" "+s}return e}return t.length?o===!1?t:JSON.stringify(t):""},o.getQueryStringCRUD=function(){return""},o.getQueryStringFilter=function(){var e=this.options,i=e.sql,r=e.stringify,o=e.filterModel,n=o.mode,a=this.colModel,l=this.getFilterData({CM:a,location:"remote"}),s="";if(o&&o.on&&l)if(i){s=[];for(var d=0;d<l.length;d++){var h=l[d],c=h.condition,u=h.dataIndx,f=t.trim(h.value);"contain"===c?s.push(u+" like '%"+f+"%'"):"notcontain"===c?s.push(u+" not like '%"+f+"%'"):"begin"===c?s.push(u+" like '"+f+"%'"):"end"===c?s.push(u+" like '%"+f+"'"):"equal"===c?s.push(u+"='"+f+"'"):"notequal"===c?s.push(u+"!='"+f+"'"):"empty"===c?s.push("isnull("+u+",'')=''"):"notempty"===c?s.push("isnull("+u+",'')!=''"):"less"===c?s.push(u+"<'"+f+"'"):"great"===c&&s.push(u+">'"+f+"'")}s=s.join(" "+n+" ")}else if(l.length){var p={mode:n,data:l};s=r===!1?p:JSON.stringify(p)}else s="";return s},o.remoteRequest=function(e){this.loading&&this.xhr.abort();var i=this,r="",o="",n=this.options,a=!1,l=this.colModel,s=n.dataModel,d=n.filterModel,h=n.pageModel;if("function"==typeof s.getUrl){var c={colModel:l,dataModel:s,groupModel:n.groupModel,pageModel:h,filterModel:d},u=s.getUrl.call(this.element,c);u&&u.url&&(r=u.url),u&&u.data&&(o=u.data)}else if("string"==typeof s.url){r=s.url;var f={},p={},g={};if("remote"==s.sorting){var v=this.getQueryStringSort();v&&(f={pq_sort:v})}"remote"==h.type&&(g={pq_curpage:h.curPage,pq_rpp:h.rPP});var w;"local"!=d.type&&(w=this.getQueryStringFilter(),w&&(a=!0,p={pq_filter:w}));var x=s.postData,I=s.postDataOnce;x&&"function"==typeof x&&(x=x.call(this.element,{colModel:l,dataModel:s})),o=t.extend({pq_datatype:s.dataType},p,g,f,x,I)}r&&(this.loading=!0,this.showLoading(),this.xhr=t.ajax({url:r,dataType:s.dataType,async:null==s.async?!0:s.async,cache:s.cache,contentType:s.contentType,type:s.method,data:o,beforeSend:function(t,e){return"function"==typeof s.beforeSend?s.beforeSend.call(i.element,t,e):void 0},success:function(t,r,o){if("function"==typeof s.getData){var n=s.getData.call(i.element,t,r,o);s.data=n.data,h.type&&"remote"==h.type&&(n.curPage&&(h.curPage=n.curPage),n.totalRecords&&(h.totalRecords=n.totalRecords))}else s.data=t.data,h.type&&"remote"==h.type&&(t.curPage&&(h.curPage=t.curPage),t.totalRecords&&(h.totalRecords=t.totalRecords));i.hideLoading(),i.loading=!1,i._trigger("load",null,{dataModel:s,colModel:l}),a&&i._trigger("filter",null,{type:"remote",dataModel:s,colModel:l,filterModel:d}),e&&e.callback&&e.callback()},error:function(t,e,r){if(i.hideLoading(),i.loading=!1,"function"==typeof s.error)s.error.call(i.element,t,e,r);else if("abort"!=r)throw"Error : "+r}}))},o._fixFireFoxContentEditableIssue=function(){window.postMessage},o.setFlexWHCallback=function(t){var e=this;t.call(e),this.options.flexHeight&&this.setGridHeightFromTable(),this.options.flexWidth&&this._setGridWidthFromTable()},o._refreshTitle=function(){this.$title.html(this.options.title)},o._refreshDraggable=function(){this.options.draggable?(this.$title.addClass("draggable"),this.element.draggable({handle:this.$title,start:function(t,e){}})):this._destroyDraggable()},o._refreshResizable=function(){var e=this;this.options.resizable?this.element.resizable({helper:"ui-state-highlight",delay:0,start:function(e,i){t(i.helper).css({opacity:.5,background:"#ccc",border:"1px solid steelblue"})},resize:function(t,e){},stop:function(t,i){e.options.height=e.element.height(),e.options.width=e.element.width(),e._refresh(),e.element.css("position","relative")}}):this._destroyResizable()},o.refresh=function(t){this._refresh(t)},o._refreshDataIndices=function(){if(0!=this.options.getDataIndicesFromColIndices)for(var t=this.colModel,e=t.length,i=0;e>i;i++){var r=t[i];null==r.dataIndx&&(r.dataIndx=i)}},o.refreshView=function(t){null!=this.$td_edit&&this.quitEditMode({silent:!0}),this.refreshDataFromDataModel(),this._refresh(t)},o._refresh=function(t){var e=this;this._refreshGridWidth(),this._refreshDataIndices(),this._refreshResizable(),this._refreshDraggable(),this._refreshColumnWidths(),this._computeOuterWidths(),this._setScrollHNumEles(),this._bufferObj_calcInitFinalH(),this._refreshHideArrHS(),t&&t.header===!1||this._createHeader(),this._refreshHeaderSortIcons(),this._setInnerGridHeight(),this._setRightGridHeight(),this.setFlexWHCallback(function(){e.iGenerateView.generateView(),e._computeOuterWidths()}),this._setScrollHLength(),this._setScrollVLength(),this._setScrollVNumEles(!0),this._setScrollHLength(),this._setScrollHVLength(),this._refreshPager(),this._refreshFreezeLine(),this.disableSelection(),this.options.dataModel.postDataOnce=void 0},o._setScrollHVLength=function(){var t=this.options;(this.$hscroll.is(":hidden")||t.flexHeight||t.flexWidth)&&this.$hvscroll.css("visibility","hidden")},o._refreshPager=function(){var t=this.options,e=t.pageModel,i=this.$footer,r=!!e.type,o=e.rPP,n=e.totalRecords;if(r){var a=t.pageModel;0==i.hasClass("pq-pager")&&this._initPager(),i.pqPager("option",a),n>o&&this.$bottom.css("display","")}else i.hasClass("pq-pager")&&i.pqPager("destroy"),t.showBottom?this.$bottom.css("display",""):this.$bottom.css("display","none")},o._refreshViewAfterDataSort=function(){this._refresh()},o.refreshSortingDataAndView=function(){this._refreshSortingDataAndView({sorting:!0})},o.getThis=function(){return{that:this}},o._addRowsData=function(t){var e=t.data,i=this.options.dataModel.data,r=t.rowIndx;if(null==i&&(i=[]),null==r)for(var o=0,n=e.length;n>o;o++){var a=e[o];i.push(a)}else{if(!(r<i.length))return!1;for(var o=0,n=e.length;n>o;o++){var a=e[o];i.splice(r,0,a),r++}}return!0},o.addRows=function(t){return this._addRowsData(t)?(this.refreshDataFromDataModel(),this.refresh(),!0):!1},o.refreshDataAndView=function(t){var e=this.options.dataModel;if(this.iSort._refreshSorters(),"remote"==e.location){var i=this;this.remoteRequest({callback:function(){i._onDataAvailable(t)}})}else this._onDataAvailable(t)},o.getColIndx=function(t){var e=t.dataIndx;if(void 0===e)throw"dataIndx NA";for(var i=this.colModel,r=0,o=i.length;o>r;r++)if(i[r].dataIndx==e)return r},o.getColumn=function(t){if(void 0===t.dataIndx)throw"dataIndx N/A";for(var e=t.dataIndx,i=this.colModel,r=0,o=i.length;o>r;r++){var n=i[r];if(n.dataIndx==e)return n}return null},o._onDataAvailable=function(){},o._computeOuterWidths=function(){for(var t=this.options,e=t.columnBorders,i=t.numberCell,r=this.colModel,o=this.outerWidths,n=r.length,a=0;n>a;a++){var l=r[a];o[a]=parseInt(l.width)+(e?1:0)}i.show&&(this.numberCell_outerWidth=i.width+1)},o._setOption=function(t,e){var i=this.options;if("height"==t)this.element.height(e),this._super.call(this,t,e);else if("width"==t)this._super.call(this,t,e),this._refreshGridWidth();else if("title"==t)this._super.call(this,t,e),this._refreshTitle();else if("roundCorners"==t)e?(this.element.addClass("ui-corner-all"),this.$top.addClass("ui-corner-top"),this.$bottom.addClass("ui-corner-bottom")):(this.element.removeClass("ui-corner-all"),this.$top.removeClass("ui-corner-top"),this.$bottom.removeClass("ui-corner-bottom"));else if("freezeCols"==t)!isNaN(e)&&e>=0&&parseInt(e)<=this.colModel.length-2&&(i.freezeCols=parseInt(e),this._refreshFreezeLine(),this._setScrollHLength(),this._super.call(this,t,e));else if("resizable"==t)this._super.call(this,t,e);else if("scrollModel"==t)this._super.call(this,t,e);else if("dataModel"==t)this._super.call(this,t,e);else if("pageModel"==t)this._super.call(this,t,e);else if("selectionModel"===t){var r=e;for(var t in r)this.options.selectionModel[t]=r[t]}else"colModel"===t?(this._super.call(this,t,e),this._calcThisColModel(),this._refresh()):"disabled"===t?e===!0?this._disable():this._enable():"numberCell"===t?this._super.call(this,t,e):"customData"===t?this._super.call(this,t,e):"strLoading"===t?(this._super.call(this,t,e),this._refreshLoadingString()):"showTop"===t?e===!0?this.$top.css("display",""):this.$top.css("display","none"):"showTitle"===t?e===!0?this.$title.css("display",""):this.$title.css("display","none"):"showToolbar"===t?e===!0?this.$toolbar.css("display",""):this.$toolbar.css("display","none"):"toolbar"==t?(this.$toolbar.remove(),this._super.call(this,t,e),this._createToolbar()):"collapsible"===t?e===!0?(this.$collapsible||this._createSlidingTop(),this.$collapsible.css("display","")):this.$collapsible&&this.$collapsible.css("display","none"):"showBottom"===t?e===!0?this.$bottom.css("display",""):this.$bottom.css("display","none"):this._super.call(this,t,e)},o._setOptions=function(){this._super.apply(this,arguments)},o._generateCellRowOutline=function(e){var i=e.$td,r=e.$tr,o=(e.rowIndxStart,this.options.editModel.cellBorderWidth),n=(e.colIndxStart,e.rowIndxEnd,e.colIndxEnd,this);if(r){var a=n._calcRightEdgeCol(n.colModel.length-1);a-=4;var l=r[0].offsetHeight-4,s=t(r[0].offsetParent),d=s[0].offsetParent,h=r[0].offsetLeft+s[0].offsetLeft,c=r[0].offsetTop+s[0].offsetTop;n._generateCellHighlighter(d,h,c,a,l)}else if(i){var s=t(i[0].offsetParent),d=s[0].offsetParent,a=i[0].offsetWidth-(o?2*o:1),l=i[0].offsetHeight-(o?2*o:1),h=i[0].offsetLeft+s[0].offsetLeft+d.offsetLeft,c=i[0].offsetTop+s[0].offsetTop-this.$cont.scrollTop();n._generateCellHighlighter(d,h,c,a,l,i)}},o._removeCellRowOutline=function(t){if(t&&t.old&&this.$div_focus_old){var e=this.$div_focus_old.find(".pq-editor-focus");if(e[0]&&e[0]==document.activeElement&&this.options.debug)throw"assert failed";this.$div_focus_old.remove(),this.$div_focus_old=null}else if(this.$div_focus){var e=this.$div_focus.find(".pq-editor-focus");e[0]==document.activeElement&&e.blur(),this.$div_focus.remove(),this.$div_focus=null}},o._generateCellHighlighter=function(e,i,r,o,n,a){var l=this.options.editModel.cellBorderWidth,s=this.$div_focus;s&&(this.$div_focus_old=s),this.$div_focus=t("<div class='pq-editor-border'></div>").appendTo(this.$cont_o),this.$div_focus.css({left:i,top:r,height:n,width:o,borderWidth:l})},o._onHeaderCellClick=function(t,e){var i=this,r=i.colModel[t],o=this.options,n=(o.dataModel,r.dataIndx);r.dataType;i._trigger("headerCellClick",e,{column:r,colIndx:t,dataIndx:n})!==!1&&o.sortable&&0!=r.sortable&&this.sort({colIndx:t,column:r,dataIndx:n})},o._selectRow=function(t,e){this.selectRow(t,e)},o._findfirstUnhiddenColIndx=function(){for(var t=0;t<this.colModel.length;t++)if(!this.colModel[t].hidden)return t},o.selectRow=function(t){var e=(t.rowIndx,t.evt);t.offset;if(!e||"keydown"!=e.type&&"keypress"!=e.type){if(0==this.iRows.add(t))return!1}else if(0==this.iRows.replace(t))return!1;return!0},o.scrollY=function(t){this.$vscroll.pqScrollBar("option","cur_pos",t).pqScrollBar("scroll")},o._get$Tbl=function(t,e){return this.$tbl},o.scrollCell=function(t){this.scrollRow(t),this.scrollColumn(t)},o.scrollRow=function(t){var e=t.rowIndxPage,i=!!this.iHierarchy,r=t.rowIndx,o=this.scrollCurPos,e=null==e?r-this.rowIndxOffset:e,n=this.options,a=parseInt(n.freezeRows);if(!(a>e)){var l=this._calcCurPosFromRowIndxPage(e);if(null!=l){o>l&&this.$vscroll.pqScrollBar("option","cur_pos",l).pqScrollBar("scroll");var s=this._get$Tbl(e),d=s.children("tbody").children("tr[pq-row-indx="+e+"]"),h=d.last(),c=h;if(d.length>1&&(c=d.first()),void 0==h[0])this.$vscroll.pqScrollBar("option","cur_pos",l).pqScrollBar("scroll");else{var u=h[0].offsetTop+h[0].offsetHeight,f=this.$cont[0].offsetHeight,p=parseInt(s.css("marginTop")),g=this._getScollBarHorizontalHeight(),v=c.prev("tr");if(v.hasClass("pq-row-hidden")||v.hasClass("pq-last-freeze-row"))return;if(u>f-g-p){var w,x=u-(f-g-p),d=s.children().children("tr"),I=0,m=0;for(a?(w=d.filter("tr.pq-last-freeze-row").last().next(),0==w.length&&(w=d.filter("tr.pq-row-hidden").next())):w=d.filter("tr.pq-row-hidden").next();;){if(I+=w[0].offsetHeight,w[0]==h[0])break;if(i&&0!=w.hasClass("pq-detail-child")){if(I>=x)break}else if(m++,I>=x)break;w=w.next()}var _=o+m;_>l&&(_=l);var b=this.$vscroll.pqScrollBar("option","num_eles");_+1>b&&(b=_+1),this.$vscroll.pqScrollBar("option",{num_eles:b,cur_pos:_}).pqScrollBar("scroll")}}}}},o._bringCellToView=function(t){if(null==t.rowIndxPage||null==t.colIndx)throw"rowIndxPage/colIndx NA";var e,i=t.rowIndxPage,r=t.colIndx,o=!1,n=this.options.freezeCols;if(this.hidearrHS[r]){this.hidearrHS[r]=!1;var a=r-n-this._calcNumHiddenUnFrozens(r);this.$hscroll.pqScrollBar("option","cur_pos",a).pqScrollBar("scroll"),o=!0}else{var e=this.getCell(t);if(null==e||0==e.length)return!1;var s=this._calcRightEdgeCol(r).width,d=this._getScollBarVerticalWidth();if(s>this.$cont[0].offsetWidth-d){for(var h=l.call(this,-1,r+1)-(this.$cont[0].offsetWidth-d),c=(e.parent("tr").children("td"),this.colModel),u=this.outerWidths,f=c.length,p=0,g=0,v=n;f>v;v++){if(c[v].hidden||(p+=u[v]),v==r){g=v-n-this._calcNumHiddenUnFrozens(v);break}if(p>=h){g=v-n-this._calcNumHiddenUnFrozens(v)+1;break}}this.$hscroll.pqScrollBar("option","cur_pos",g).pqScrollBar("scroll"),o=!0}}if(o){var e=this.getCell({rowIndxPage:i,colIndx:r});return e}return e},o.scrollColumn=function(t){var e=t.colIndx,e=null==e?this.getColIndx({dataIndx:t.dataIndx}):e,i=this.options.freezeCols,r=this._calcRightEdgeCol(e).width,o=this._getScollBarVerticalWidth(),n=this.$cont[0].offsetWidth;if(r>n-o){for(var a=l.call(this,-1,e+1)-(n-o),s=this.colModel,d=this.outerWidths,h=s.length,c=0,u=0,f=i;h>f;f++){if(s[f].hidden||(c+=d[f]),f==e){u=f-i-this._calcNumHiddenUnFrozens(f);break}if(c>=a){u=f-i-this._calcNumHiddenUnFrozens(f)+1;break}}return this.$hscroll.pqScrollBar("option","cur_pos",u).pqScrollBar("scroll"),!0}if(this.hidearrHS[e]){this.hidearrHS[e]=!1;var p=e-i-this._calcNumHiddenUnFrozens(e);return this.$hscroll.pqScrollBar("option","cur_pos",p).pqScrollBar("scroll"),!0}return!1},o.selection=function(t){var e=(t.rowIndx,t.colIndx,t.method),i=t.type;return"row"==i?this.iRows[e](t):"cell"==i?this.iCells[e](t):void 0},o._bringPageIntoView=function(t){var e=t.rowIndx,i=this.options.pageModel;if("local"==i.type&&e>=0){var r=i.curPage,o=i.rPP,n=(r-1)*o,a=r*o;e>=n&&a>e||(i.curPage=Math.ceil((e+1)/o),this.refreshDataFromDataModel(),this._refreshViewAfterDataSort())}},o.goToPage=function(t){var e=this.options.pageModel;if("local"==e.type||"remote"==e.type){var i=t.rowIndx,r=e.rPP,o=null==t.page?Math.ceil((i+1)/r):t.page,n=e.curPage;o!=n&&(e.curPage=o,"local"==e.type?(this.refreshDataFromDataModel(),this._refresh()):this.refreshDataAndView())}},o.setSelection=function(t){if(null==t)return this.iRows.removeAll({raiseEvent:!0}),this.iCells.removeAll({raiseEvent:!0}),!1;var e,i,r=this.data;if(t.rowData){var o=this.getRowIndx(t);e=o.rowIndx}else var n=this.rowIndxOffset,e=t.rowIndx,i=t.rowIndxPage,e=null==e?i+n:e;var a=null==t.colIndx&&void 0!==t.dataIndx?this.getColIndx({dataIndx:t.dataIndx}):t.colIndx;t.evt;return 0>e||0>a||a>=this.colModel.length?!1:null==r||0==r.length?!1:(t.rowIndx=e,t.colIndx=a,this._bringPageIntoView(t),i=e-this.rowIndxOffset,t.rowIndxPage=i,this.scrollRow({rowIndxPage:i}),null==a?this._selectRow(t):(this._bringCellToView({rowIndxPage:i,colIndx:a}),this.selectCell(t)))},o.getColModel=function(){return this.colModel},o.saveEditCell=function(t){if(null!=this.$td_edit){var e,i=this.$td_edit,r=t?t.evt:null,o=this.getCellIndices({$td:i}),n=this.rowIndxOffset,a=o.colIndx,l=o.rowIndxPage,s=l+n,d=this.colModel,h=d[a],c=h.dataIndx,u=this.data[l],f=this.options,p=f.dataModel;if(null!=u&&(e=u[c],o.rowIndx=s,o.column=h,o.dataIndx=c,null!=l)){var g=this._getEditCellData(o);"<br>"==g&&(g=""),null==e&&""===g&&(g=null);var v={rowIndx:s,dataIndx:c,column:h,newVal:g,value:g,oldVal:e,rowData:u,dataModel:p};if(this._trigger("cellBeforeSave",r,v)===!1)return!1;if(g!=e){if(u[c]=g,this._trigger("cellSave",r,v),f.track){var u=this.getRowData({rowIndx:s});this.iUCData.update({rowData:u,dataIndx:c,oldVal:e,newVal:g})}this.refreshCell(o),this._fixTableViewPort();var w=this;f.flexHeight?(w.setGridHeightFromTable(),w._fixIEFooterIssue()):t&&w.scrollRow({rowIndxPage:l})}return!0}}},o._fixTableViewPort=function(){var t=this.$cont[0];t.scrollTop=0,t.scrollLeft=0},o._fixIEFooterIssue=function(){t(".pq-grid-footer").css({position:"absolute"}),t(".pq-grid-footer").css({position:"relative"})},o.refreshColumn=function(t){var e=this.options.customData,i=null==t.colIndx?this.getColIndx({dataIndx:t.dataIndx}):t.colIndx,r=this.getRowIndxOffset();t.colIndx=i;for(var o=this.init;o<=this["final"];o++){var n=o;t.rowIndx=n+r,t.rowIndxPage=n;var a=this.colModel[i];t.$td=this.getCell(t),t.rowData=this.data[n],t.customData=e,t.column=a,this.iGenerateView._renderCell(t)}},o.refreshCell=function(t){if(this.data){var e=this.rowIndxOffset,i=t.rowIndx,r=t.rowIndxPage,i=t.rowIndx=null==i?r+e:i,r=t.rowIndxPage=null==r?i-e:r,o=t.dataIndx,n=t.colIndx,n=t.colIndx=null==n?this.getColIndx({dataIndx:o}):n,a=t.$td=null==t.$td?this.getCell(t):t.$td,l=(t.column=this.colModel[n],this.options.treeModel),s=this.data[r];if(s){var d=t;d.tree=!!l.labelIndx,d.rowData=s,d.customData=this.options.customData,a&&a.length>0&&this.iGenerateView._renderCell(d)}}},o.refreshRow=function(t){if(this.data){var e=this.options,i=this.rowIndxOffset,r=t.rowIndx,o=t.rowIndxPage,r=null==r?o+i:r,o=null==o?r-i:o,n=null==t.$tr?this.getRow(t):t.$tr,a=this.colModel,l=this.data[o];if(l){var s=[];this.iGenerateView._generateRow(l,o,a,s,null);var d=s.join("");n.replaceWith(d),this._trigger("refresh",null,{type:"row",dataModel:e.dataModel,colModel:a,rowData:l,rowIndx:r,rowIndxPage:o})}}},o.quitEditMode=function(t){var e=this,i=!1,r=!1,o=!1,n=this.options.selectionModel,a=void 0;t&&(i=t.old,r=t.silent,o=t.fireOnly,a=t.evt);var l=i?this.$td_edit_old:this.$td_edit;if(l){var s,d,h,c,u,f=function(){i?e.$td_edit_old=null:e.$td_edit=null};i||this.disableSelection();var p=this.getCellIndices({$td:l});if(!p||null==p.rowIndx)return void f();s=p.rowIndx,d=s-this.offsetRowIndx,h=p.colIndx,c=this.colModel[h],u=c.dataIndx,i||o||("cell"==n.type?l.attr("tabindex","0").focus():"row"==n.type&&l.parent("tr.pq-grid-row").attr("tabindex","0").focus()),r||i||this._trigger("quitEditMode",a,{$td:l,rowIndx:s,rowIndxPage:d,colIndx:h,column:c,dataIndx:u,rowData:this.data[d]}),o||(this._removeCellRowOutline(t),f())}},o.getData=function(){return this.data},o.getViewPortRowsIndx=function(){return{beginIndx:this.init,endIndx:this["final"]}},o.getRowIndxOffset=function(){return this.rowIndxOffset},o.selectCell=function(t){var e=(t.rowIndx,t.colIndx,t.evt);if(!e||"keydown"!=e.type&&"keypress"!=e.type){if(0==this.iCells.add(t))return!1}else if(0==this.iCells.replace(t))return!1;return!0},o._setGridFocus=function(){var t=this,e=!0;window.setTimeout(function(){null==t.$td_edit&&e&&(e=!1)},0)},o.getEditCell=function(){return this.$td_edit?{$td:this.$td_edit,$cell:this.$div_focus}:null},o.editCell=function(t){var e=this.getCell(t);return null!=e&&e.length>0?(this._editCell(e),e):void 0},o.getFirstEditableColIndx=function(t){if(null==t.rowIndx)throw"rowIndx NA";if(!this.isEditableRow(t))return-1;for(var e=this.colModel,i=0;i<e.length;i++)if(t.colIndx=i,this.isEditableCell(t)&&!e[i].hidden)return i;return-1},o.editFirstCellInRow=function(t){var e=this.rowIndxOffset,i=t.rowIndx,r=t.rowIndxPage,i=null==i?r+e:i,r=null==r?i-e:r,o=this.getFirstEditableColIndx({rowIndx:i});if(-1!=o){this.scrollRow({rowIndxPage:r});var n=this._bringCellToView({colIndx:o,rowIndxPage:r});n&&n.length>0&&this._editCell(n)}},o._editCell=function(e){var i=this,r=i.getCellIndices({$td:e}),o=r.rowIndxPage,n=this.rowIndxOffset,a=o+n,l=r.colIndx,s=this.colModel[l],d=s.editor,h=this.options.editor,c=d?t.extend({},h,d):h,u=i.data[o],f=!1,p=s.dataIndx;if(this.$td_edit){if(this.$td_edit[0]==e[0])return!1;this.$td_edit_old=this.$td_edit,this.quitEditMode({fireOnly:!0})}this.$td_edit=e,this._generateCellRowOutline({$td:e});var g=this.$div_focus.addClass("pq-editor-border-edit");"right"==s.align?g.addClass("pq-align-right"):"center"==s.align?g.addClass("pq-align-center"):g.addClass("pq-align-left");var v,w=g.width()-8,x=u[p],I=c.type,m=c.select,_=c.cls?c.cls:"",b="pq-editor-focus "+_,q=b+" pq-cell-editor ",y=c.attr?c.attr:"",C=c.style,C=C?C:"",$=C?"style='"+C+"'":"",D="style='width:"+w+"px;"+C+"'",M=C?"style='"+C+"'":"";if("function"==typeof I)v=I.call(i.element,{$cell:g,cellData:x,rowData:u,cls:b,dataIndx:p,data:c.data,column:s});else if("checkbox"==I){var P=c.subtype,R=x?"checked='checked'":"";v="<input "+R+" class='"+q+"' "+y+" "+M+" type=checkbox name='"+p+"' />",g.html(v);var S=g.children("input");"triple"==P&&(S.pqval({val:x}),g.click(function(e){t(this).children("input").pqval({incr:!0})}))}else if("textarea"==I||"select"==I||"textbox"==I){if("textarea"==I)v="<textarea class='"+q+"' "+y+" "+D+" name='"+p+"' ></textarea>";else if("select"==I){var T=c.options,T=T?T:[];"function"==typeof T&&(T=T.call(i.element,{column:s,rowData:u}));var k=[y," class='",q,"' ",D," name='",p,"'"].join("");v=t.paramquery.select({options:T,attr:k,labelIndx:c.labelIndx,valueIndx:c.valueIndx,groupIndx:c.groupIndx})}else v="<input class='"+q+"' "+y+" "+D+" type=text name='"+p+"' />";g.html(v),g.children().val(x)}else v="<div contenteditable='true' tabindx='0' "+$+" "+y+" class='pq-grid-editor-default "+b+"'></div>",g.html(v),g.children().html(x),f=!0;var i=this;if(null!=i.$td_edit){var g=i.$div_focus,H=g.children(".pq-editor-focus");if(H.focus(),H.bind("keydown",function(t){i.iKeyNav._bodyKeyPressDownInEdit(t)}),0==i._trigger("cellEditFocus",null,{$cell:g,$editor:H,dataIndx:p,column:s,rowIndx:a,rowData:u}))return!1;if(m)if(f)try{var E=H[0],V=document.createRange();V.selectNodeContents(E);var O=window.getSelection();O.removeAllRanges(),O.addRange(V)}catch(F){}else H.select()}i.$td_edit_old&&i.quitEditMode({
old:!0})},o.getRow=function(t){var e,i=t.rowIndxPage,r=t.rowIndx,o=this.rowIndxOffset,n=(this.options.dataModel,this.$tbl);if(void 0!=n){var a=n.children("tbody");null!=i?e=a.children("tr[pq-row-indx="+i+"]"):null!=r&&(e=a.children("tr[pq-row-indx="+(r-o)+"]"))}return e},o.getCell=function(e){var i,r=e.rowIndxPage,o=e.rowIndx,r=null==r?o-this.rowIndxOffset:r,n=e.colIndx,a=e.dataIndx,n=null==n?this.getColIndx({dataIndx:a}):n,l=this.$tbl,s=this.options,d=s.freezeCols;if(void 0!=l){l.length>1&&(l=t(n>=d?l[1]:l[0]));var i=l.children().children("tr[pq-row-indx="+r+"]").children("td[pq-col-indx="+n+"]")}return 0==i.length||"hidden"==i[0].style.visibility?null:i},o.getCellHeader=function(e){var i,r=e.colIndx,o=e.dataIndx,r=null==r?this.getColIndx({dataIndx:o}):r,n=this.$tbl_header,a=this.options,l=a.freezeCols;if(void 0!=n){n.length>1&&(n=t(r>=l?n[1]:n[0]));var i=n.children().children("tr:last").children("td[pq-col-indx="+r+"]")}return 0==i.length||"hidden"==i[0].style.visibility?null:i},o.getEditCellData=function(){if(this.$td_edit){var t=this.getCellIndices({$td:this.$td_edit});return this._getEditCellData(t)}return null},o._getEditCellData=function(e){if(void 0==e.colIndx||void 0==e.rowIndxPage)throw"colIndx, rowIndxpage N/A";var i,r=e.colIndx,o=e.rowIndxPage,n=null!=e.rowIndx?e.rowIndx:o+this.rowIndxOffset,a=e.column?e.column:this.colModel[r],l=a.editor,s=this.options.editor,d=l?t.extend({},s,l):s,h=a.dataIndx,c=e.$cell?e.$cell:this.$div_focus,u=d.getData;if("function"==typeof u)i=d.getData.call(this.element,{$cell:c,dataIndx:h,rowIndx:n,rowIndxPage:o,column:a});else{var f=d.type;if("checkbox"==f){var p=c.children();i="triple"==d.subtype?p.pqval():!!p.is(":checked")}else if("contenteditable"==f)i=c.children().html();else{var g=c.find('*[name="'+h+'"]');if(g&&g.length)i=g.val();else{var g=c.find(".pq-editor-focus");g&&g.length&&(i=g.val())}}}return i},o.getCellIndices=function(t){var e=t.$td;if(null==e||0==e.length||e.closest(".pq-grid")[0]!=this.element[0])return{rowIndxPage:null,colIndx:null};var i=e.parent("tr"),r=i.attr("pq-row-indx");if(null==r)return{rowIndxPage:null,colIndx:null};r=parseInt(r);var o=e.attr("pq-col-indx");return null==o?{rowIndxPage:r,colIndx:null}:(o=parseInt(o),{rowIndxPage:r,rowIndx:r+this.rowIndxOffset,colIndx:o,dataIndx:this.colModel[o].dataIndx})},o.getRowsByClass=function(t){var e=this.options,i=e.dataModel,r=e.pageModel,o=r.type,n="remote"==o,a=this.rowIndxOffset,l=i.data,s=[];if(null==l)return s;for(var d=0,h=l.length;h>d;d++){var c=l[d];if(t.rowData=c,this.hasClass(t)){var u={rowData:c};n?u.rowIndx=d+a:u.rowIndx=d,s.push(u)}}return s},o.addClass=function(e){var i=e.rowIndx,r=e.dataIndx,o=e.cls,n=this.rowIndxOffset,a=this.getRowData(e);if(a){null==i&&(i=this.getRowIndx({rowData:a}).rowIndx);for(var l=o.split(" "),s=0;s<l.length;s++){var d=l[s];if(null==r&&this.hasClass({rowData:a,cls:d})===!1){var h=a.pq_rowcls;if(h?a.pq_rowcls=t.trim(h)+" "+d:a.pq_rowcls=d,null!=i&&e.refresh!==!1){var c=this.getRow({rowIndxPage:i-n});c&&c.addClass(d)}}else if(this.hasClass({rowData:a,dataIndx:r,cls:d})===!1){var u=a.pq_cellcls;if(u){var f=u[r];f?u[r]=t.trim(f)+" "+d:u[r]=d}else{var u={};u[r]=d,a.pq_cellcls=u}if(null!=i&&e.refresh!==!1){var p=this.getCell({rowIndxPage:i-n,dataIndx:r});p&&p.addClass(d)}}}}},o.removeClass=function(t){var e=t.rowIndx,i=this.getRowData(t),r=t.dataIndx,o=t.cls,n=null!=r&&i?i.pq_cellcls:null,a=i?i.pq_rowcls:null;if(null!=i)if(null==e&&(e=this.getRowIndx({rowData:i}).rowIndx),null==r){if(a&&(i.pq_rowcls=this._removeClass(a,o)),null!=e&&t.refresh!==!1){var l=this.getRow({rowIndx:e});l&&l.removeClass(o)}}else if(n){var s=n[r];if(s&&(i.pq_cellcls[r]=this._removeClass(s,o)),null!=e&&t.refresh!==!1){var d=this.getCell({rowIndx:e,dataIndx:r});d&&d.removeClass(o)}}},o.hasClass=function(t){var e,i=t.dataIndx,r=t.cls,o=this.getRowData(t),n=new RegExp("\\b"+r+"\\b");if(o){if(null==i)return e=o.pq_rowcls,!(!e||!n.test(e));var a=o.pq_cellcls;return!!(a&&a[i]&&n.test(a[i]))}return null},o._removeClass=function(t,e){if(t){for(var i=t.split(" "),r=e.split(" "),o=[],n=0,a=i.length;a>n;n++){for(var l=i[n],s=!1,d=0,h=r.length;h>d;d++){var c=r[d];if(l===c){s=!0;break}}s||o.push(l)}return o.length>1?o.join(" "):1===o.length?o[0]:null}},o.getRowIndx=function(t){var e=t.$tr,i=t.rowData;if(i){var r=this.options,o=r.dataModel,n=r.pageModel,a=n.type,l="remote"==a,s=o.data,d=!1;if(s)for(var h=0,c=s.length;c>h;h++)if(s[h]==i){d=!0;break}if(d){var u=this.rowIndxOffset,f=l?h:h-u,p=l?h+u:h;return{rowIndxPage:f,rowIndx:p}}return{}}if(null==e||0==e.length)return{rowIndxPage:null};var f=e.attr("pq-row-indx");return null==f?{rowIndxPage:null}:(f=parseInt(f),{rowIndxPage:f,rowIndx:f+this.rowIndxOffset})};var n=function(t){this.options=t.options,this.that=t;var e=this,i=t.widgetEventPrefix.toLowerCase();t.element.on(i+"celleditkeydown",function(t,i){return e.filterKeys(t,i)})},a=n.prototype;a._incrRowIndx=function(t,e){for(var i=this.that,r=t,e=null==e?1:e,o=i.data,n=0,a=t+1,l=o.length;l>a;a++){var s=o[a].pq_hidden;if(!s&&(n++,r=a,n==e))return r}return r},a._decrRowIndx=function(t,e){for(var i=this.that,r=t,o=i.data,e=null==e?1:e,n=0,a=t-1;a>=0;a--){var l=o[a].pq_hidden;if(!l&&(n++,r=a,n==e))return r}return r},o.addColumn=function(t,e){var i=this.options,r=i.colModel,o=i.dataModel.data;r.push(t),this._calcThisColModel();for(var n=0;n<o.length;n++){var a=o[n];a.push("")}},o.rowNextSelect=function(){var t,e,i=this.selection({type:"row",method:"getSelection"}),r=this.rowIndxOffset;return i&&i[0]&&(t=i[0].rowIndx,e=t-r,e=this.iKeyNav._incrRowIndx(e)),null!=e&&(this.setSelection(null),this._setSelection({rowIndxPage:e})),e},o.rowPrevSelect=function(){var t,e,i=this.selection({type:"row",method:"getSelection"}),r=this.rowIndxOffset;return i&&i[0]&&(t=i[0].rowIndx,e=t-r,e=this.iKeyNav._decrRowIndx(e)),null!=e&&(this.setSelection(null),this.setSelection({rowIndxPage:e})),e},a._incrIndx=function(t,e){var i=this.that,r=i._getLastVisibleRowIndxPage(i.data),o=i.colModel,n=o.length;if(null==e)return t==r?null:(t=this._incrRowIndx(t),{rowIndxPage:t});var a;do{if(e++,e>=n){if(t==r)return null;t=this._incrRowIndx(t),e=0}a=o[e]}while(a&&a.hidden);return{rowIndxPage:t,colIndx:e}},a._decrIndx=function(t,e){var i=this.that,r=i.colModel,o=r.length,n=i._getFirstVisibleRowIndxPage(i.data);if(null==e)return t==n?null:(t=this._decrRowIndx(t),{rowIndxPage:t});var a;do{if(e--,0>e){if(t==n)return null;t=this._decrRowIndx(t),e=o-1}a=r[e]}while(a&&a.hidden);return{rowIndxPage:t,colIndx:e}},a._incrEditIndx=function(t,e){var i,r=this.that,o=r.colModel,n=o.length,a=r.rowIndxOffset,l=r._getLastVisibleRowIndxPage(r.data);do{if(e++,e>=n){if(t==l)return null;do{t=this._incrRowIndx(t);var s=t+a,d=r.isEditableRow({rowIndx:s});if(t==l&&0==d)return null}while(0==d);e=0}i=o[e];var s=t+a,h=r.isEditableCell({rowIndx:s,colIndx:e,checkVisible:!0})}while(i&&(i.hidden||0==h));return{rowIndxPage:t,colIndx:e}},a._decrEditIndx=function(t,e){var i,r=this.that,o=r.colModel,n=o.length,a=r.rowIndxOffset,l=r._getFirstVisibleRowIndxPage(r.data);do{if(e--,0>e){if(t==l)return null;do{t=this._decrRowIndx(t);var s=t+a,d=r.isEditableRow({rowIndx:s});if(t==l&&0==d)return null}while(0==d);e=n-1}i=o[e];var s=t+a,h=r.isEditableCell({rowIndx:s,colIndx:e,checkVisible:!0})}while(i&&(i.hidden||0==h));return{rowIndxPage:t,colIndx:e}},a._incrEditRowIndx=function(t,e){var i=this.that,r=i.rowIndxOffset,o=i._getLastVisibleRowIndxPage(i.data);if(t==o)return null;do{t=this._incrRowIndx(t);var n=t+r,a=i.isEditableRow({rowIndx:n}),l=i.isEditableCell({rowIndx:n,colIndx:e}),s=a&&l;if(t==o&&!s)return null}while(!s);return{rowIndxPage:t,colIndx:e}},a._decrEditRowIndx=function(t,e){var i=this.that,r=i.rowIndxOffset,o=i._getFirstVisibleRowIndxPage(i.data);if(t==o)return null;do{t=this._decrRowIndx(t);var n=t+r,a=i.isEditableRow({rowIndx:n}),l=i.isEditableCell({rowIndx:n,colIndx:e}),s=a&&l;if(t==o&&!s)return null}while(!s);return{rowIndxPage:t,colIndx:e}},o._onKeyPressDown=function(e){var i=t(e.target).closest(".pq-grid-header");if(i.length>0)return 0!=this._trigger("headerKeyDown",e,{dataModel:this.options.dataModel});var r=this.iKeyNav._bodyKeyPressDown(e);return r===!1?!1:0==this._trigger("keyDown",e,{dataModel:this.options.dataModel})?!1:void 0},a._saveAndMove=function(t,e){var i=this.that,r=this.options,o=r.selectionModel;if(0==i.saveEditCell({evt:e}))return e.preventDefault(),!1;if(null==t)return e.preventDefault(),!1;var n=t.rowIndxPage,a=t.colIndx;"row"==o.type?(i.setSelection(null),i.setSelection({rowIndxPage:n}),i._bringCellToView({rowIndxPage:n,colIndx:a})):"cell"==o.type?(i.setSelection(null),i.setSelection({rowIndxPage:n,colIndx:a})):(i.scrollRow({rowIndxPage:n}),i._bringCellToView({rowIndxPage:n,colIndx:a}));var l=i.getCell({rowIndxPage:n,colIndx:a});return l&&l.length>0&&i._editCell(l),e.preventDefault(),!1},a._bodyKeyPressDownInEdit=function(e){var i=this.that;if(i.$td_edit){var r=this.options,o=i.rowIndxOffset,n=t.ui.keyCode,a=i.colModel,l=r.editModel,s=t(i.$td_edit[0]),d=i.getCellIndices({$td:s}),h=d.rowIndxPage,c=h+o,u=d.colIndx,f=a[u],p=f.editModel,g=p?t.extend({},l,p):l;if(0==i._trigger("cellEditKeyDown",e,{rowData:i.data[h],$cell:i.$div_focus,rowIndx:c,rowIndxPage:h,colIndx:u,$td:s,dataIndx:f.dataIndx,column:f}))return!1;if(e.keyCode==n.TAB){var d;return d=e.shiftKey?this._decrEditIndx(h,u):this._incrEditIndx(h,u),this._saveAndMove(d,e)}if(e.keyCode==g.saveKey){var d=this._incrEditIndx(h,u);return this._saveAndMove(d,e)}if(e.keyCode==n.ESCAPE)return i.quitEditMode({evt:e}),e.preventDefault(),!1;if(e.keyCode==n.PAGE_UP||e.keyCode==n.PAGE_DOWN)return e.preventDefault(),!1;if(g.keyUpDown){if(e.keyCode==n.DOWN){var d=this._incrEditRowIndx(h,u);return this._saveAndMove(d,e)}if(e.keyCode==n.UP){var d=this._decrEditRowIndx(h,u);return this._saveAndMove(d,e)}}}},a.filterKeys=function(e,i){var r=(this.that,this.options.editModel.filterKeys),o=i.column,n=o.dataType,a=o.editModel;if(a&&void 0!=a.filterKeys&&(r=a.filterKeys),r&&("float"==n||"integer"==n)){var l=t(e.originalEvent.target),s=l[0].nodeName.toLowerCase(),d="integer"==n?/^[\-]?[0-9]*$/:/^[\-]?[0-9]*\.?[0-9]*$/,h=["input","textarea","select"],c="text";-1!=t.inArray(s,h)&&(c="val");var u=l[c]();window.setTimeout(function(){var t=l[c]();0==d.test(t)&&l[c](u)},0)}},a.select=function(t){var e=this.that,i=t.rowIndx,r=t.colIndx,o=e.options.selectionModel,n=t.evt;n.shiftKey&&"single"!=o.mode?"row"==o.type?(e.scrollRow({rowIndx:i}),e.iRows.extendSelection({rowIndx:i,evt:n})):"cell"==o.type&&(e.scrollCell({rowIndx:i,colIndx:r}),e.iCells.extendSelection({rowIndx:i,colIndx:r,evt:n})):e.setSelection({rowIndx:i,colIndx:r,evt:n,setFirst:!0})},a.createTextbox=function(){var e=t("textarea#pq-grid-excel");0==e.length&&(e=t("<textarea id='pq-grid-excel' />").appendTo(document.body))},a._bodyKeyPressDown=function(e){var i,r,o,n,a=this.that,l=a.rowIndxOffset,s=this.options,d=a.colModel,h=s.selectionModel,c=t.ui.keyCode;if(a.$td_edit)return void a.$td_edit.find(".pq-cell-focus").focus();if("row"==h.type){if(r=e.ctrlKey?a.iRows.getFocusSelection({old:!0}):a.iRows.getFocusSelection({old:!1}),null==r)return;var o=r.rowIndx,u=o-l;if(null==o)return;if(0==a._trigger("rowKeyDown",e,{rowData:a.data[u],rowIndx:o,rowIndxPage:u}))return!1}else{if("cell"!=h.type)return;if(i=e.ctrlKey?a.iCells.getFocusSelection({old:!0}):a.iCells.getFocusSelection({old:!1}),null==i)return;var f=i,o=f.rowIndx,u=o-l,p=f.dataIndx,n=a.getColIndx({dataIndx:p});if(null==o||null==n)return;if(0==a._trigger("cellKeyDown",e,{rowData:a.data[u],rowIndx:o,rowIndxPage:u,colIndx:n,dataIndx:p,column:d[n]}))return!1;if(e.cancelBubble)return}if(e.keyCode==c.LEFT){var f=this._decrIndx(u,n);return f&&(o=f.rowIndxPage+l,this.select({rowIndx:o,colIndx:f.colIndx,evt:e})),void e.preventDefault()}if(e.keyCode==c.RIGHT){var f=this._incrIndx(u,n);return f&&(o=f.rowIndxPage+l,this.select({rowIndx:o,colIndx:f.colIndx,evt:e})),void e.preventDefault()}if(e.keyCode==c.UP)return u=this._decrRowIndx(u),null!=u&&(o=u+l,this.select({rowIndx:o,colIndx:n,evt:e})),void e.preventDefault();if(e.keyCode==c.DOWN)return u=this._incrRowIndx(u),null!=u&&(o=u+l,this.select({rowIndx:o,colIndx:n,evt:e})),void e.preventDefault();if(e.keyCode==c.PAGE_DOWN||e.keyCode==c.SPACE){var g=this.pageDown();return g&&(u=g.rowIndxPage,null!=u&&(o=u+l,this.select({rowIndx:o,colIndx:n,evt:e}))),void e.preventDefault()}if(e.keyCode==c.PAGE_UP){var v=this.pageUp();return v&&(u=v.rowIndxPage,null!=u&&(o=u+l,this.select({rowIndx:o,colIndx:n,evt:e}))),void e.preventDefault()}if(e.keyCode==c.HOME)return"row"==h.type||e.ctrlKey?(o=a._getFirstVisibleRowIndxPage(a.data)+l,this.select({rowIndx:o,colIndx:n,evt:e})):"cell"==h.type&&(n=a._getFirstVisibleColIndx(),this.select({rowIndx:o,colIndx:n,evt:e})),void e.preventDefault();if(e.keyCode==c.END)return"row"==h.type||e.ctrlKey?(o=a._getLastVisibleRowIndxPage(a.data)+l,this.select({rowIndx:o,colIndx:n,evt:e})):"cell"==h.type&&(n=a._getLastVisibleColIndx(),this.select({rowIndx:o,colIndx:n,evt:e})),void e.preventDefault();if(e.keyCode==c.ENTER){if("row"==h.type){var w;null!=r&&a.editFirstCellInRow({rowIndx:u+l})}else if(null!=i){var w=a.getCell({rowIndxPage:u,colIndx:n});if(w&&w.length>0){var o=u+l,x=a.isEditableRow({rowIndx:o}),I=a.isEditableCell({rowIndx:o,colIndx:n});x&&I&&a._editCell(w)}}return void e.preventDefault()}return e.ctrlKey&&"65"==e.keyCode?("row"==h.type&&"single"!=h.mode?a.iRows.selectAll({all:h.all}):"cell"==h.type&&"single"!=h.mode&&a.iCells.selectAll({all:h.all}),void e.preventDefault()):void 0},a.incrPageSize=function(){for(var e=this.that,i=e.$tbl,r=i.children("tbody").children("tr.pq-grid-row").not(".pq-group-row,.pq-summary-row"),o=e.$cont[0].offsetHeight,n=parseInt(i.css("marginTop")),a=e._getScollBarHorizontalHeight(),l=o-a-n,s=r.length-1;s>=0;s--){var d=r[s];if(d.offsetTop<l)break}var h=e.getRowIndx({$tr:t(d)}).rowIndxPage;return{rowIndxPage:h}},a.pageDown=function(){var t=this.that,e=this.incrPageSize().rowIndxPage,i=t._calcCurPosFromRowIndxPage(e);if(null!=i){var r=t.$vscroll.pqScrollBar("option"),o=r.cur_pos,n=r.num_eles;return n-1>o&&t.$vscroll.pqScrollBar("option","cur_pos",i).pqScrollBar("scroll"),{rowIndxPage:e,curPos:i}}},a.pageUp=function(){var t=this.that,e=this.decrPageSize().rowIndxPage,i=t._calcCurPosFromRowIndxPage(e);if(null!=i){var r=t.$vscroll.pqScrollBar("option"),o=r.cur_pos;r.num_eles;return o>0&&t.$vscroll.pqScrollBar("option","cur_pos",i).pqScrollBar("scroll"),{rowIndxPage:e,curPos:i}}},a.decrPageSize=function(){var e=this.that,i=e.$tbl,r=i.children("tbody").children("tr.pq-grid-row").not(".pq-group-row,.pq-summary-row"),o=e.options.freezeRows,n=0;if(r.length){var a;if(o?(a=r.filter("tr.pq-last-freeze-row"),a.length&&(a=a.next())):r.length>=2&&(a=t(r[1])),a&&a.length){var n=e.getRowIndx({$tr:a}).rowIndxPage;n=n-e.pageSize+4,0>n&&(n=0)}}return{rowIndxPage:n}},o._calcNumHiddenFrozens=function(){for(var t=0,e=this.options.freezeCols,i=0;e>i;i++)this.colModel[i].hidden&&t++;return t},o._calcNumHiddenUnFrozens=function(t){for(var e=0,i=this.options.freezeCols,r=null!=t?t:this.colModel.length,o=i;r>o;o++)this.colModel[o].hidden&&e++;return e},o._setScrollHLength=function(){var t=this.options;if(!t.scrollModel.horizontal)return this.$hscroll.css("visibility","hidden"),void this.$hvscroll.css("visibility","hidden");this.$hscroll.css("visibility",""),this.$hvscroll.css("visibility","");var e=this.$cont[0].offsetWidth,i=(this.colModel,this._getScollBarVerticalWidth());0==i?this.$hscroll.css("right",0):this.$hscroll.css("right",""),e-=i,this.$hscroll.pqScrollBar("option","length",e)},o._setScrollHNumEles=function(){var t=this.options,e=t.scrollModel,i=0;t.flexWidth||(i="fullScroll"==e.lastColumn?this.colModel.length-t.freezeCols-this._calcNumHiddenUnFrozens():this.calcColsOutsideCont(this.colModel)+1),this.$hscroll.pqScrollBar("option","num_eles",i)},o.calcColsOutsideCont=function(t){var e=this.options.numberCell,i=this.$tbl?this.$tbl[this.$tbl.length-1]:null,r=i?i.scrollWidth:0,o=this.options.freezeCols,n=this.outerWidths,a=this.$cont[0].offsetWidth-this._getScollBarVerticalWidth();r=0,e.show&&(r+=this.numberCell_outerWidth);for(var l=0;l<t.length;l++){var s=t[l];s.hidden||(r+=n[l])}var d=0,h=0,c=r;for(c>a&&h++,l=o;l<t.length;l++)if(s=t[l],!s.hidden){if(d+=n[l],c=r-d,!(c>a))break;h++}return h},o._getScollBarHorizontalHeight=function(){var t=17,e=this.$hscroll;return"hidden"!=e.css("visibility")&&0!=this.options.scrollModel.horizontal&&"none"!=e.css("display")||(t=0),t},o._getScollBarVerticalWidth=function(){var t=17,e=this.$vscroll;return(null==this.init||"hidden"==e.css("visibility")||this.options.flexHeight||"none"==e.css("display"))&&(t=0),t},o._setScrollVNumEles=function(e){var i,r,o=this,n=this.$vscroll,a=!!this.iHierarchy,l=n.pqScrollBar("option"),s=parseInt(l.num_eles),d=parseInt(l.cur_pos),h=this.options,c=this._getScollBarHorizontalHeight(),u=this.$cont[0].offsetHeight,f=u-c+1,p=h.groupModel,g=p?this.dataGM:this.data,v=g?this.totalVisibleRows:0,w=0;if(this.$tbl&&this.$tbl.length>0&&(i=this.$tbl[this.$tbl.length-1],w=i.offsetHeight,r=t(i)),w>0&&w>f){for(var x=r.children().children("tr"),I=0,m=0,_=0;_<x.length;_++){var b=x[_];if(I+=b.offsetHeight,I>=f){a&&t(b).hasClass("pq-detail-child")?(m--,m=m>1?m-1:1):m=m>1?m-1:0;break}a?0==t(b).hasClass("pq-detail-child")&&m++:m++}0==m&&(m=x.length-1),s=v-m+1}else s=d+1;return s>v&&(s=v),e?o.$vscroll.pqScrollBar("option","num_eles",s):o.$vscroll.pqScrollBar("setNumEles",s),s},o._getFirstVisibleRowIndxPage=function(t){for(var e=0,i=t.length;i>e;e++){var r=t[e].pq_hidden;if(!r)return e}},o._getLastVisibleRowIndxPage=function(t){for(var e=t.length-1;e>=0;e--){var i=t[e].pq_hidden;if(!i)return e}return null},o._getFirstVisibleColIndx=function(){for(var t=this.colModel,e=t.length,i=0;e>i;i++){var r=t[i].hidden;if(!r)return i}return null},o._getLastVisibleColIndx=function(){for(var t=this.colModel,e=t.length,i=e-1;i>=0;i--){var r=t[i].hidden;if(!r)return i}return null},o.getTotalVisibleColumns=function(){for(var t=this.colModel,e=t.length,i=0,r=0;e>r;r++){var o=t[r],n=o.hidden;n||i++}return i},o._getTotalVisibleRows=function(t,e,i,r){var o=0,n=r?r.length:0,a=e,l=0,s=0,d=null,h=!1,c=!1,u=!!this.iHierarchy,f=this.options.detailModel.offset,p=0,g=22,v=u?this.$cont[0].offsetHeight:void 0;if(null==r||0==n)return{init:d,_final:d,tvRows:o};for(var w=0,x=n>e?e:n;x>w;w++){var I=r[w],m=I.pq_hidden;if(!m&&(d=w,o++,u)){var _=I.pq_detail;if(_&&_.show){var b=_.height||0;b>f&&(b=f),p+=b+g}else p+=g}}if(this.lastFrozenRow=d,e>n)return{init:d,_final:d,tvRows:o};i-=o;for(var w=e,x=n;x>w;w++){var I=r[w],m=I.pq_hidden;if(h?c||(m?l++:s==i?c=!0:(l++,s++)):m?a++:s==t?(h=!0,l=a,s=0):(a++,s++),!m&&(o++,u&&h)){var _=I.pq_detail;if(_&&_.show){var b=_.height||0;b>f&&(b=f),p+=b+g}else p+=g;p>v&&(c=!0)}}return a>=n&&(a=n-1),a>l&&(l=a),{init:a,_final:l,tvRows:o}},o._setScrollVLength=function(){var t=this.$cont.height(),e=this._getScollBarHorizontalHeight();this.$vscroll.css("bottom",e);var i=t-e;this.$vscroll.pqScrollBar("option","length",i)},o._setInnerGridHeight=function(){var t=this.options;if(!t.flexHeight){var e=this.element.height()-(t.showTop?this.$top[0].offsetHeight:0)-this.$bottom[0].offsetHeight;this.$grid_inner.height(e+"px")}},o._setRightGridHeight=function(){var t=this.options,e=this.$header[0].offsetHeight;if(this.$header_o.height(e-2),!t.flexHeight){this.$vscroll.css("visibility",""),this.$tbl&&this.$tbl.css("marginBottom",0);var i=this.element.height()-this.$header_o[0].offsetHeight-(t.showTop?this.$top[0].offsetHeight:0)-this.$bottom[0].offsetHeight,r=0;this.$cont.height(i-r+"px")}},o.setGridHeightFromTable=function(){var t=0,e=this._getScollBarHorizontalHeight(),i=this.$tbl;i&&i.length?(t=i[0].offsetHeight-1,i.css("marginBottom",e)):t=22;this.$cont.height(""),this.element.height(""),this.$grid_inner.height(""),this.$vscroll.css("visibility","hidden")},o._setGridWidthFromTable=function(){var t,e=this._getScollBarVerticalWidth();this.$tbl&&this.$tbl[0]&&this.$tbl[0].scrollWidth>0?(t=this.$tbl[0].scrollWidth,this.element.width(t+e+"px")):(t=l.call(this,-1,this.colModel.length),this.element.width(t+"px"))},o._setRightGridWidth=function(){},o._bufferObj_getInit=function(){return this.init},o._bufferObj_getFinal=function(){return this["final"]},o._bufferObj_minRowsPerGrid=function(){var t=this.$cont[0].offsetHeight;return Math.ceil(t/this.rowHeight)},o._calcCurPosFromRowIndxPage=function(t){var e=this.options,i=e.groupModel,r=i?this.dataGM:this.data,o=e.freezeRows;if(o>t)return 0;for(var n=0,a=o,l=o,s=r.length;s>l;l++){var d=r[l];if(i&&(d.groupSummary||d.groupTitle));else{if(a==t)break;a++}var h=d.pq_hidden;h||n++}return n>=s?null:n},o._bufferObj_calcInitFinal=function(){var t=this.options,e=t.freezeRows,i=t.flexHeight,r=t.groupModel,o=!!r,n=o?this.dataGM:this.data;t.treeModel;if(null==n||0==n.length){var a=this._getTotalVisibleRows(s,e,d,n);this.totalVisibleRows=a.tvRows,this.init=a.init,this["final"]=a._final}else{var l=this.$vscroll.pqScrollBar("option"),s=parseInt(l.cur_pos);if(isNaN(s)||0>s)throw"cur_pos NA";this.scrollCurPos=s;var d=this._bufferObj_minRowsPerGrid();this.pageSize=d;var a=this._getTotalVisibleRows(s,e,d,n);this.totalVisibleRows=a.tvRows,this.init=a.init,i?this["final"]=n.length-1:this["final"]=a._final}},o._bufferObj_calcInitFinalH=function(){for(var t=parseInt(this.$hscroll.pqScrollBar("option","cur_pos")),e=this.options,i=parseInt(e.freezeCols),r=e.flexWidth,o=e.virtualX,n=i,a=0,s=this.colModel,d=this.outerWidths,h=s.length,c=i;h>c;c++)if(s[c].hidden)n++;else{if(a==t)break;n++,a++}if(n>h-1&&(n=h-1),this.initH=n,r||!o)this.finalH=h-1;else{for(var u=l.call(this,-1,i),f=this.$cont[0].offsetWidth-this._getScollBarVerticalWidth(),c=n;h>c;c++){var p=s[c];if(!p.hidden){var g=d[c];if(!g)throw"width N/A";if(u+=g,u>f)break}}var v=c;v>h-1&&(v=h-1),this.finalH=v}};var l=function(t,e,i){var r=0,o=this.options,n=o.columnBorders,a=o.numberCell,l=this.outerWidths,s=this.colModel;if(-1==t&&(a.show&&(r+=i?parseInt(a.width)+1:this.numberCell_outerWidth),t=0),i)for(var d=t;e>d;d++){var h=s[d],c=h.hidden;c||(r+=parseInt(h.width)+(n?1:0))}else for(var d=t;e>d;d++)s[d].hidden||(r+=l[d]);return r};t.paramquery.pqgrid.calcWidthCols=l,o._calcHeightRows=function(t,e){for(var i=0,r=t;;){if(r>=e)break;var o=this.getRow({rowIndxPage:r});o&&o[0]&&(i+=o[0].offsetHeight),r++}return i},o._calcRightEdgeCol=function(t){var e=0,i=0,r=this.colModel,o=this.hidearrHS,n=this.outerWidths,a=this.options.numberCell;a.show&&(e+=this.numberCell_outerWidth,i++);for(var l=0;t>=l;l++)r[l].hidden||0!=o[l]||(e+=n[l],i++);return{width:e,cols:i}},o._refreshFreezeLine=function(){var e=this.options,i=e.numberCell,r=this.$cont_o,o=e.freezeCols;if(this.$freezeLine&&this.$freezeLine.remove(),o){var n=l.call(this,-1,o)-1;if(isNaN(n)||0==n);else if(n>0&&i.show&&n==i.width);else{this.$freezeLine=t("<div class='pq-grid-vert-freezeline' ></div>").appendTo(r);var a=r[0].offsetHeight;this.$freezeLine.css({height:a,left:n})}}},o._getDragHelper=function(e){var i=t(e.currentTarget);this.$cl=t("<div class='pq-grid-drag-bar'></div>").appendTo(this.$grid_inner),this.$clleft=t("<div class='pq-grid-drag-bar'></div>").appendTo(this.$grid_inner);var r=parseInt(i.attr("pq-grid-col-indx")),o=this.$grid_inner.outerHeight();this.$cl.height(o),this.$clleft.height(o);var n=t("td[pq-grid-col-indx="+r+"]",this.$header)[0],a=n.offsetLeft+(r>this.options.freezeCols?parseInt(this.$header[1].offsetLeft):0);this.$clleft.css({left:a}),a+=n.offsetWidth,this.$cl.css({left:a})},o._setDragLimits=function(t){var e=this,i=this.options,r=i.numberCell,o=e.$header_left;t>=i.freezeCols&&(o=e.$header_right);var n=o.find("div.pq-grid-col-resize-handle[pq-grid-col-indx="+t+"]"),a=o.find("td[pq-grid-col-indx='"+t+"']"),l=a.offset().left+i.minWidth;-1==t&&(l=a.offset().left+r.minWidth);var s=17;(i.flexHeight||"hidden"==this.$vscroll.css("visibility"))&&(s=0);var d=e.$cont.offset().left+e.$cont[0].offsetWidth-s+20;n.draggable("option","containment",[l,0,d,0])},o._getOrderIndx=function(t){var e=this.options.columnOrder;return null!=e?e[t]:t},o.nestedCols=function(t,e,i){var r=t.length,o=[];null==e&&(e=1);for(var n=e,a=0,l=0,s=0,d=0;r>d;d++){var h=t[d];if(1==i&&(h.hidden=i),null!=h.colModel&&h.colModel.length>0){var c=this.nestedCols(h.colModel,e+1,h.hidden);o=o.concat(c.colModel),c.colSpan>0?(c.depth>n&&(n=c.depth),h.colSpan=c.colSpan,a+=c.colSpan):(h.colSpan=0,h.hidden=!0),h.childCount=c.childCount,s+=c.childCount}else h.hidden?h.colSpan=0:(h.colSpan=1,a++),h.childCount=0,s++,o.push(h)}return{depth:n,colModel:o,colSpan:a,width:l,childCount:s}},o.getHeadersCells=function(){for(var t=this.options.colModel,e=this.colModel.length,i=this.depth,r=[],o=0;i>o;o++){r[o]=[];for(var n=0,a=0,l=0;e>l;l++){var s;if(0==o)s=t[n];else{var d=r[o-1][l],h=d.colModel;if(null==h||0==h.length)s=d;else{for(var c=l-d.leftPos,u=0,f=0,p=0;p<h.length;p++)if(u+=h[p].childCount>0?h[p].childCount:1,u>c){f=p;break}s=h[f]}}var g=s.childCount?s.childCount:1;l==a?(s.leftPos=l,r[o][l]=s,a+=g,t[n+1]&&n++):r[o][l]=r[o][l-1]}}return this.headerCells=r,r},o.getDataType=function(){var t=this.colModel;if(t&&t[0]){var e=t[0].dataIndx;if("string"==typeof e)return"JSON";if("number"==typeof e)return"ARRAY"}throw"dataType unknown"},o.assignRowSpan=function(){for(var t=(this.options.colModel,this.colModel.length),e=this.headerCells,i=this.depth,r=0;t>r;r++)for(var o=0;i>o;o++){var n=e[o][r];if(!(r>0&&n==e[o][r-1]||o>0&&n==e[o-1][r])){for(var a=1,l=o+1;i>l;l++){var s=e[l][r];n==s&&a++}n.rowSpan=a}}return e},o._calcThisColModel=function(){var t=this.nestedCols(this.options.colModel);this.colModel=t.colModel,this.depth=t.depth,this.getHeadersCells(),this.assignRowSpan(),this._refreshColumnWidths(),this._computeOuterWidths()},o._refreshWidthsAutoFit=function(){var t=this.options,e=this.colModel,i=this.$cont,r=e.length,o=t.minWidth,n=l.call(this,-1,r,!0),a=i[0].offsetWidth-this._getScollBarVerticalWidth();if(n!=a){for(var s=n-a,d=[],h=0;r>h;h++){var c=e[h],u=c.hidden;if(!u){var f=c.minWidth,f=f?parseInt(f):o,p=parseInt(c.width)-f;(p>0||0>s)&&d.push({availWd:p,colIndx:h})}}d.sort(function(t,e){return t.availWd>e.availWd?1:t.availWd<e.availWd?-1:0});for(var h=0,g=d.length;g>h;h++){var v=d[h],p=v.availWd,w=v.colIndx,x=Math.round(s/(g-h)),c=e[w],I=c.width;if(p>x){var m=I-x;s-=x,c.width=m}else{var m=I-p;s-=p,c.width=m}}}},o._refreshColumnWidths=function(){var t=this.options,e=t.numberCell,i=t.freezeCols,r=t.flexWidth,o=t.columnBorders,n=this.colModel,a=t.scrollModel,s=a.lastColumn,d=a.autoFit,h=this.$cont,c=n.length,u=t.minWidth;e.show&&e.width<e.minWidth&&(e.width=e.minWidth);for(var f=0;c>f;f++){var p=n[f],g=p.hidden;if(!g){var v=p.width,w=p.minWidth,w=w?parseInt(w):u;if(void 0!=v){var x=parseInt(v);w>x&&(x=w),p.width=x}else p.width=w}}if(h&&0==r&&(d&&this._refreshWidthsAutoFit(),"auto"==s)){var I=h[0].offsetWidth-this._getScollBarVerticalWidth(),m=l.call(this,-1,i,!0),_=I-m,b=!1,q=this._getLastVisibleColIndx();if(null==q)return;for(var y=n[q],C=parseInt(y.width),$=y.minWidth,$=$?parseInt($):u,f=c-1;f>=i;f--){var p=n[f];if(!p.hidden){var D=p.width+(o?1:0);if(_-=D,0>_){if(b=!0,C+_>=$)y.width=C+_;else{var M=C+D+_;M>=$&&(y.width=M)}break}}}b||(C+_>=$?y.width=C+_:y.width=$)}},o._createHeader=function(){var e=this,i=this.options,r=parseInt(i.freezeCols),o=i.numberCell,n=this.colModel,a=this.outerWidths,s=(n.length,this.depth),d=i.virtualX,h=e.initH,c=e.finalH,u=(i.columnBorders,this.headerCells),f=(this.hidearrHS,this.$header);if(i.showHeader===!1)return f.empty(),void this.$header_o.css("display","none");this.$header_o.css("display","");var p=["<table class='pq-grid-header-table' cellpadding=0 cellspacing=0>"];if(s>=1){p.push("<tr>"),o.show&&p.push("<td style='width:"+(o.width+1)+"px;' ></td>");for(var g=0;c>=g;g++){if(h>g&&g>=r&&d&&(g=h,g>c))throw"initH>finalH";var v=n[g];if(!v.hidden){var w=a[g];p.push("<td style='width:"+w+"px;'></td>")}}p.push("</tr>")}for(var x="pq-grid-col "+(i.hwrap===!1?" pq-wrap-text ":""),I=0;s>I;I++){p.push("<tr class='pq-grid-title-row'>"),0==I&&o.show&&p.push(["<td pq-grid-col-indx='-1' class='pq-grid-number-col' rowspan='",s,"'>","<div class='pq-td-div'>",o.title?o.title:"&nbsp;","</div></td>"].join(""));for(var g=0;c>=g;g++){if(h>g&&g>=r&&d&&(g=h,g>c))throw"initH>finalH";var v=u[I][g],m=v.colSpan,_=v.halign,b=v.align,q=v.title,q=q?q:"";if(!(I>0&&v==u[I-1][g]||g>0&&v==u[I][g-1]||v.hidden)){var y=x;null!=_?y+=" pq-align-"+_:null!=b&&(y+=" pq-align-"+b),g==r-1&&1==s&&(y+=" pq-last-freeze-col"),r-1>=g?y+=" pq-left-col":g>=h&&(y+=" pq-right-col");var C="",$="";null!=v.colModel&&0!=v.colModel.length||(C="pq-grid-col-indx='"+g+"'");var D="pq-row-indx="+I,M="pq-col-indx="+g;p.push(["<td ",C," ",M," ",D," ",$," class='",y,"' rowspan=",v.rowSpan," colspan=",m,">                    <div class='pq-td-div'>",q,"<span class='pq-col-sort-icon'>&nbsp;</span></div></td>"].join(""))}}p.push("</tr>")}this.ovCreateHeader(p,x),p.push("</table>");var P=p.join("");f.empty(),f.append(P),this.$tbl_header=f.children("table");var R=t(f[0]),S=t(f[1]),w=l.call(this,-1,r);if(R.css({width:w,zIndex:1}),!d){var T=l.call(this,r,h);S.css({left:-1*T+"px"})}f.click(function(i){if(!e.iDragColumns||"stop"==e.iDragColumns.status){var r=t(i.target),o=r.closest(".pq-g-ficon");if(o.length){var n=o.attr("pq-col-indx");return i.stopImmediatePropagation(),e.iHeaderIconSearch.createDOM(n,o,i)}var a=r.closest("td.pq-grid-col");if(a.length){i.stopImmediatePropagation();var n=a.attr("pq-grid-col-indx");if(null!=n)return e._onHeaderCellClick(n,i)}}}),this._refreshResizeColumn(h,c,n),this._trigger("refreshHeader",null,null)},o.ovCreateHeader=function(){},o._refreshResizeColumn=function(e,i,r){var o=this,n=this.options,a=!!n.filterModel.ficon,l=n.numberCell,s=o.$header.height(),d=parseInt(n.freezeCols);if(l.show&&l.resizable){var h=t("<div pq-grid-col-indx='-1' class='pq-grid-col-resize-handle'>&nbsp;</div>").appendTo(o.$header_left),c=o.$header_left.find("td.pq-grid-number-col")[0];v=parseInt(c.offsetLeft)+(c.offsetWidth-10),h.css({left:v,height:s})}for(var u=0;i>=u;u++){if(e>u&&u>=d&&(u=e,u>i))throw"initH>finalH";var f=r[u];if(!f.hidden){var p,c,g,v,w=f.ficon,x=w||null==w&&a;if((f.resizable!==!1||x)&&(p=o.$header_left,u>=d&&(p=o.$header_right),c=p.find("td[pq-grid-col-indx="+u+"]")[0],g=parseInt(c.offsetLeft),v=g+(c.offsetWidth-5)),f.resizable!==!1){var h=t("<div pq-grid-col-indx='"+u+"' class='pq-grid-col-resize-handle'>&nbsp;</div>").appendTo(p);h.css({left:v,height:s})}if(x){var I=f.filterModel,m="";I&&I.on&&(m="ui-state-error");var _=v-12;(!f.halign&&"right"==f.align||"right"==f.halign)&&(_=g),t("<div class='"+m+" pq-g-ficon' pq-col-indx='"+u+"' tabindex=1><div class='ui-icon ui-icon-search'></div></div>").css({left:_,height:s}).appendTo(p)}}}var b,q,y;o.$header.find(".pq-grid-col-resize-handle").draggable({axis:"x",helper:function(e,i){var r=t(e.target),n=parseInt(r.attr("pq-grid-col-indx"));return o._setDragLimits(n),o._getDragHelper(e,i),r},start:function(t,e){b=e.position.left,y=parseInt(o.$cl[0].style.left)},drag:function(t,e){q=e.position.left;var i=q-b;o.$cl[0].style.left=y+i+"px"},stop:function(t,e){return o._refreshResizeColumnStop(t,e,r,b)}})},o._refreshResizeColumnStop=function(e,i,r,o){var n=this,a=this.options,l=a.numberCell;n.$clleft.remove(),n.$cl.remove();var s,d=i.position.left,h=d-o,c=t(i.helper),u=parseInt(c.attr("pq-grid-col-indx"));if(-1==u){s=null;var f=parseInt(l.width),p=f+h;l.width=p}else{s=r[u];var f=parseInt(s.width),p=f+h;s.width=p}n._refresh(),n._trigger("columnResize",e,{colIndx:u,column:s,dataIndx:s?s.dataIndx:null,oldWidth:f,newWidth:s?s.width:l.width})},o._refreshHeaderSortIcons=function(){var t=this.options.dataModel;if(void 0!=t.sortIndx){var e=this.$header,i=e.find(".pq-grid-col");i.removeClass("pq-col-sort-asc pq-col-sort-desc ui-state-active"),e.find(".pq-col-sort-icon").removeClass("ui-icon ui-icon-triangle-1-n ui-icon-triangle-1-s");var r=t.sortIndx,o=this.getColIndx({dataIndx:r}),n="ui-state-active pq-col-sort-"+("up"==t.sortDir?"asc":"desc"),a="ui-icon ui-icon-triangle-1-"+("up"==t.sortDir?"n":"s");e.find(".pq-grid-col[pq-grid-col-indx="+o+"]").addClass(n),
e.find(".pq-grid-col[pq-grid-col-indx="+o+"] .pq-col-sort-icon").addClass(a)}},o.createTable=function(t){this.iGenerateView.generateView(t)},o._refreshOtherTables=function(){return},t.widget("paramquery._pqGrid",o),t.measureTime=function(t,e){(new Date).getTime();t();(new Date).getTime()}}(jQuery),function($){function cMouseSelection(t){this.that=t;var e=this,i=t.widgetEventPrefix.toLowerCase();t.element.on(i+"cellmousedown",function(i,r){return i.target==t.element[0]?e._onCellMouseDown(i,r):void 0}),t.element.on(i+"rowmousedown",function(i,r){return i.target==t.element[0]?e._onRowMouseDown(i,r):void 0}),t.element.on(i+"cellmousemove",function(i,r){return i.target==t.element[0]?e._onCellMouseMoveSheet(i,r):void 0}),t.element.on(i+"rowmousemove",function(i,r){return i.target==t.element[0]?e._onRowMouseMoveSheet(i,r):void 0}),t.element.on(i+"beforetableview",function(i,r){return i.target==t.element[0]?e._beforeTableView(i,r):void 0}),t.element.on(i+"refresh",function(i,r){return i.target==t.element[0]?e._onRefresh(i,r):void 0}),$(document).bind("mouseup.cMouseSelection",function(t,i){return e._onDocumentMouseUp(t,i)})}function cHierarchy(t){var e=this;this.that=t,this.type="detail",this.refreshComplete=!0,this.detachView=!1;var i=t.widgetEventPrefix.toLowerCase();t.element.on(i+"cellclick",function(i,r){return i.target==t.element[0]?e.cellClick(i,r):void 0}),t.element.on(i+"cellkeydown",function(i,r){return i.target==t.element[0]&&i.keyCode==$.ui.keyCode.ENTER?e.cellClick(i,r):void 0}),t.element.on(i+"refresh",function(i,r){return i.target==t.element[0]?e.refresh(i,r):void 0}),t.element.on(i+"beforetableview",function(i,r){return i.target==t.element[0]?e.beforeTableView(i,r):void 0}),t.element.on(i+"beforerefreshdata",function(i,r){return i.target==t.element[0]?e.beforeRefreshData(i,r):void 0})}var cClass=$.paramquery.cClass,calcWidthCols=$.paramquery.pqgrid.calcWidthCols,fn={},_pMouseSelection=cMouseSelection.prototype;fn.getFocusElement=function(){var t=document.activeElement;if(t){var e=$(t),i=e.closest(".pq-grid");if(i.length)return i[0]==this.element[0]?{$ae:e,$grid:i}:{$ae:e,$childGrid:i}}},fn.inViewPort=function(t){var e=this,i=e.$cont[0],r=i.offsetHeight-e._getScollBarHorizontalHeight()+1,o=i.offsetWidth-e._getScollBarVerticalWidth()+1,n=t[0];if(r>=n.offsetTop+n.offsetHeight){if("TD"!=n.nodeName.toUpperCase())return!0;if(o>=n.offsetLeft+n.offsetWidth)return!0}},_pMouseSelection._beforeTableView=function(t,e){var i=this.that,r=i.getFocusElement();if(this.lastFocus=null,r&&r.$grid){var o=r.$ae;if(o.hasClass("pq-grid-row")){var n=i.getRowIndx({$tr:o});this.lastFocus=n}else if(o.hasClass("pq-grid-cell")){var n=i.getCellIndices({$td:o});this.lastFocus=n}}},_pMouseSelection._onRefresh=function(t,e){var i,r=this.that,o=this.lastFocus;return o&&(i=null!=o.dataIndx?r.getCell(o):r.getRow(o),i&&i.length)?void(r.inViewPort(i)&&i.attr("tabindex","0").focus()):void 0},_pMouseSelection._onCellMouseDown=function(t,e){var i=this.that,r=e.rowIndx,o=e.colIndx,n=i.options.selectionModel,a=n.type,l=n.mode;if("cell"==a&&null!=o)return t.shiftKey?(i.iCells.extendSelection({rowIndx:r,colIndx:o,mode:l,evt:t}),t.preventDefault()):t.ctrlKey&&"single"!=l?i.iCells.isSelected({rowIndx:r,colIndx:o})?i.iCells.remove({rowIndx:r,colIndx:o}):i.setSelection({rowIndx:r,colIndx:o}):(this.mousedown={rowIndx:r,colIndx:o},i.setSelection(null),i.iCells.add({rowIndx:r,colIndx:o,setFirst:!0})),!0},_pMouseSelection._onRowMouseDown=function(t,e){var i=this.that,r=e.rowIndx,o=i.options.selectionModel,n=o.mode,a=o.type;if("row"==a&&null!=r)return t.shiftKey?(i.iRows.extendSelection({rowIndx:r,evt:t}),t.preventDefault()):t.ctrlKey&&"single"!=n?i.iRows.isSelected({rowIndx:r})?i.iRows.remove({rowIndx:r}):i.setSelection({rowIndx:r}):(this.mousedown={r1:r,y1:t.pageY},i.setSelection(null),i.iRows.add({rowIndx:r,setFirst:!0})),!0},_pMouseSelection._onCellMouseMoveSheet=function(t,e){var i=this.that,r=i.options.selectionModel,o=r.type;r.mode;if("cell"==o&&this.mousedown){var n=this.mousedown,a=n.r1,l=n.c1,s=e.rowIndx,d=e.colIndx;if(a==s&&l==d)return;if(n.r2==s&&n.c2==d)return;this.mousedown.r2=s,this.mousedown.c2=d,i.iCells.extendSelection({rowIndx:s,colIndx:d,evt:t})}},_pMouseSelection._onRowMouseMoveSheet=function(t,e){var i=this.that,r=i.options.selectionModel,o=r.type;r.mode;if(r.swipe&&this.mousedown){var n=this.mousedown,a=i.$vscroll.pqScrollBar("option"),l=a.num_eles,s=a.cur_pos,d=i.init,h=n.y1,c=t.pageY;if(c-h>22&&d>0){var u=i.iKeyNav._decrRowIndx(d),f=i._calcCurPosFromRowIndxPage(u);if(null==f)return;i.$vscroll.pqScrollBar("option","cur_pos",f).pqScrollBar("scroll"),n.y1=c}else if(h-c>22&&l>s){var u=i.iKeyNav._incrRowIndx(i.init),f=i._calcCurPosFromRowIndxPage(u);if(null==f)return;i.$vscroll.pqScrollBar("option","cur_pos",f).pqScrollBar("scroll"),n.y1=c}}else if("row"==o&&this.mousedown){var n=this.mousedown,p=this.mousedown.r1,g=e.rowIndx;if(p==g)return;if(this.mousedown.r2==g)return;this.mousedown.r2=g,i.iRows.extendSelection({rowIndx:g,evt:t})}},_pMouseSelection._onDocumentMouseUp=function(t,e){return this.mousedown=null,!0};var _pHierarchy=cHierarchy.prototype;_pHierarchy.refresh=function(t,e){var i=this.that,r=i.options.detailModel.init,o=i.data;if(this.refreshComplete){this.refreshComplete=!1;for(var n=i.$tbl.children("tbody").children("tr.pq-detail-child"),a=0;a<n.length;a++){var l=n[a],s=$(l),d=s.attr("pq-row-indx"),h=o[d],c=h.pq_detail.child;c||"function"==typeof r&&(c=r.call(i.element,{rowData:h}),h.pq_detail.child=c);var u=c.find(".pq-header-outer");if(s.children("td.pq-detail-child").append(c),0==u.height())try{c.pqGrid("refresh")}catch(f){}}this.refreshComplete=!0,this.detachView=!1}},_pHierarchy.beforeTableView=function(t,e){this.detachView||this.detachInitView(t,e)},_pHierarchy.beforeRefreshData=function(t,e){this.detachView||this.detachInitView(t,e)},_pHierarchy.detachInitView=function(t,e){for(var i,r,o,n=this.that,a=n.data,l=n.$tbl.children("tbody").children("tr.pq-grid-row"),s=0;s<l.length;s++){var d=l[s],h=$(d),c=h.attr("pq-row-indx"),u=a[c];if(null!=c&&c!=i&&(i=c,u.pq_detail)){if(r=null,o=0,u.pq_detail.child){var f=h.next();if(f.hasClass("pq-detail-child")){var p=f.children("td.pq-detail-child").children();p.length&&(o=p[0].offsetHeight,r=p.detach())}}r&&r.length&&(u.pq_detail.child=r,u.pq_detail.height=o)}}this.detachView=!0},_pHierarchy.cellClick=function(t,e){var i=this.that,r=e.column,o=e.rowData,n=e.rowIndx,a=this.type;if(r&&r.type===a){var l="pq_detail";null==o[l]?i.rowExpand({rowIndx:n,scrollRow:!0}):o[l].show===!1?i.rowExpand({rowIndx:n,scrollRow:!0}):i.rowCollapse({rowIndx:n,scrollRow:!0})}},fn.rowExpand=function(t){var e=this.getRowData(t),i=this.options.detailModel,r="pq_detail";if(null!=e){if(null==e[r]?e[r]={show:!0}:e[r].show===!1&&(e[r].show=!0),!i.cache){var o=e[r].child;o&&(o.remove(),e[r].child=null,e[r].height=0)}if(this.refresh(),t.scrollRow){var n=t.rowIndx;this.scrollRow({rowIndx:n})}}},fn.rowInvalidate=function(t){var e=this.getRowData(t),i="pq_detail",r=e[i].child;r.remove(),e[i].child=null},fn.rowCollapse=function(t){var e=this.getRowData(t),i=this.options.detailModel,r="pq_detail";if(null!=e&&null!=e[r]&&e[r].show===!0){if(!i.cache){var o=e[r].child;o&&(o.remove(),e[r].child=null,e[r].height=0)}if(e[r].show=!1,this.refresh(),t.scrollRow){var n=t.rowIndx;this.scrollRow({rowIndx:n})}}};var cHeaderSearch=function(t){function e(e,i,r){t.filter({data:[{dataIndx:e,value:i,value2:r}]})}this.that=t;var i=this;this.dataHS={};var r=t.widgetEventPrefix.toLowerCase();t.element.on(r+"headerkeydown",function(t,e){if(i.belongs(t)){var r=$(t.originalEvent.target);return r.hasClass("pq-search-hd-field")?i.onKeyDown(t,e,r):!0}}),t.element.on(r+"createheader",function(t,e){return i.belongs(t)?i._onCreateHeader():void 0}),this.changeListener={change:function(t,i){e(i.dataIndx,i.value,i.value2)}},this.keyupListener={keyup:function(t,i){e(i.dataIndx,i.value,i.value2)}},this.clickListener={click:function(t,i){e(i.dataIndx,i.value)}}},_pHeaderSearch=cHeaderSearch.prototype=new cClass;_pHeaderSearch.get$Ele=function(t,e){var i,r=this.that,o=r.options.freezeCols,n=$(r.$tbl_header[0]),a=".pq-search-hd-field[name='"+e+"']",l=$(r.$tbl_header[2==r.$tbl_header.length?1:0]);return i=t>=o?l.find(a):n.find(a)},_pHeaderSearch.onKeyDown=function(t,e,i){var r=this.that,o=t.keyCode,n=$.ui.keyCode;if(o!==n.TAB)return!0;var a,l=i.attr("name"),s=r.getColIndx({dataIndx:l}),d=r.colModel,h=t.shiftKey,c=d[s];if("between"==c.filter.condition){r.scrollColumn({colIndx:s});var u=this.get$Ele(s,l);if(u[0]==i[0]?h||(a=u[1]):h&&(a=u[0]),a)return a.focus(),t.preventDefault(),!1}for(;;){if(h?s--:s++,0>s||s>=d.length)break;var c=d[s],f=c.filter;if(!c.hidden&&f){r.scrollColumn({colIndx:s});var a,l=c.dataIndx,a=this.get$Ele(s,l);if("between"==f.condition&&(a=$(h?a[1]:a[0])),a)return a.focus(),t.preventDefault(),!1;break}}},_pHeaderSearch._bindFocus=function(){function t(t){var e=$(t.target),o=e.attr("name");if(i.scrollColumn({dataIndx:o})){var n=i.getColIndx({dataIndx:o}),a=r.get$Ele(n,o);a.focus()}}function e(e){e.addEventListener?e.addEventListener("focus",t,!0):e.onfocusin=function(){var e=window.event;e.target=e.srcElement,t(e)}}for(var i=this.that,r=this,o=this.that.$header.find(".pq-grid-header-search"),n=0;n<o.length;n++)e(o[n])},_pHeaderSearch._onCreateHeader=function(){var t=this,e=this.that,i=e.options,r=i.columnBorders,o=i.filterModel;if(o.header){this._bindFocus();var n=e.colModel,a=e.initH,l=e.finalH,s=i.freezeCols,d=i.virtualX,h=e.$tbl_header,c=$(h[0]),u=$(h[1]),f="input,select";c.find(f).css("visibility","hidden");for(var p=0;s>p;p++){var g=n[p],v=g.dataIndx,f="*[name='"+v+"']";c.find(f).css("visibility","visible"),u.find(f).css("visibility","hidden")}for(var p=0;l>=p;p++){if(a>p&&p>=s&&d&&(p=a,p>l))throw"initH>finalH";var g=n[p];if(!g.hidden){var w=g.filter;if(w){var x,I=g.dataIndx;x=s>p?c:u;var m=x.find("*[name='"+I+"']");if(0!=m.length){var _=w.type,b=w.value,q=w.value2;if("checkbox"==_&&"triple"==w.subtype)m.pqval({val:b});else if("select"==_){m.val(b);var y=this.getWidth(g,r);m.css({width:y})}var C=w.init;C&&C.call(m,{dataIndx:I,column:g});var D=w.listeners;if(D)for(var M=0;M<D.length;M++){var P=D[M];"string"==typeof P&&(P=t[P+"Listener"]);for(var R in P){var S=P[R];!function(t,i,r){t.bind(R,function(o){var n=e.getColumn({dataIndx:r}),a=n.filter;return"checkbox"==a.type?b="triple"==a.subtype?t.pqval({incr:!0}):!!t.is(":checked"):"between"==a.condition?(b=$(t[0]).val(),q=$(t[1]).val()):b=t.val(),i.call(this,o,{column:n,dataIndx:r,value:b,value2:q})})}(m,S,I)}}}}}}}},_pHeaderSearch.getWidth=function(t,e){var i=parseInt(t.width)+(e?1:0),i=i-15;return i},_pHeaderSearch.createDOM=function(t,e){var i=this.that,r=i.initH,o=i.finalH,n=i.options,a=n.freezeCols,l=n.virtualX,s=i.colModel,d=n.columnBorders,h=(this.dataHS,n.numberCell);t.push("<tr class='pq-grid-header-search'>"),h.show&&t.push(["<td pq-grid-col-indx='-1' class='pq-grid-number-col' rowspan='1'>","<div class='pq-grid-header-table-div'>&nbsp;</div></td>"].join(""));for(var c=0;o>=c;c++){if(r>c&&c>=a&&l&&(c=r,c>o))throw"initH>finalH";var u=s[c];if(!u.hidden){var f=e,p=u.halign;p||(p=u.align),"right"==p?f+=" pq-align-right":"center"==p&&(f+=" pq-align-center");var g=u.filter;if(g){var v,w=u.dataIndx,x=g.type,I=g.value,m=g.condition,_=this.getWidth(u,d),b=g.cls,b="pq-search-hd-field "+(b?b:""),q=g.style,q=q?q:"",y=g.attr,y=y?y:"",C="";if("between"==m)var D=g.value2,D=null!=D?D:"",v=_/2-9;if("textbox"===x)I=I?I:"",b+=" ui-corner-all pq-search-txt","between"==m?(C=this._input(w,I,v,b+" pq-from",q,y),C+="-"+this._input(w,D,v,b+" pq-to",q,y)):C=this._input(w,I,_,b,q,y);else if("textarea"===x)I=I?I:"",b+=" ui-corner-all pq-search-txt","between"==m?(C=this._textarea(w,I,v,b,q,y),C+="-"+this._textarea(w,D,v,b,q,y)):C=this._textarea(w,I,_,b,q,y);else if("select"===x)if(g.cache)C=g.cache;else{var M=g.options;"function"==typeof M&&(M=M.call(i,{column:u,value:I,dataIndx:w,cls:b,style:q,attr:y})),b+=" ui-corner-all";var P=["name='",w,"' class='",b,"' style='width:",_,"px;",q,"' ",y].join("");C=$.paramquery.select({options:M,attr:P,prepend:g.prepend,valueIndx:g.valueIndx,labelIndx:g.labelIndx,groupIndx:g.groupIndx}),g.cache=C}else if("checkbox"==x){var R=null==I||0==I?"":"checked=checked";C=["<input ",R," name='",w,"' type=checkbox class='"+b+"' style='"+q+"' "+y+"/>"].join("")}else"string"==typeof x?C=x:"function"==typeof x&&(C=x.call(i,{width:_,value:I,value2:D,column:u,dataIndx:w,cls:b,attr:y,style:q}));t.push(["<td class='",f,"'><div class='pq-grid-header-table-div' style='padding:0px 2px;' >","",C,"</div></td>"].join(""))}else t.push(["<td class='",f,"'><div class='pq-grid-header-table-div' >","&nbsp;","</div></td>"].join(""))}}t.push("</tr>")},_pHeaderSearch._input=function(t,e,i,r,o,n){return['<input value="',e,"\" name='",t,"' type=text style='width:",i,"px;"+o+"' class='"+r+"' "+n+" />"].join("")},_pHeaderSearch._textarea=function(t,e,i,r,o,n){return["<textarea name='",t,"' style='width:",i,"px;"+o+"' class='"+r+"' "+n+" >",e,"</textarea>"].join("")},$.paramquery.select=function(t){var e,i,r=t.attr,o=t.options,n=t.groupIndx,a=t.labelIndx,l=t.valueIndx,s=t.prepend,d=["<select ",r," >"];if(s)for(var h in s)d.push('<option value="',h,'">',s[h],"</option>");if(n){if(o&&o.length){for(var c=0,u=o.length;u>c;c++){var f=o[c],p=f[l];if(null!=p&&""!=p)if(e=f[n],i!=e&&(null!=i&&d.push("</optgroup>"),d.push('<optgroup label="',e,'">'),i=e),l!=a){var g=f[a];d.push('<option value="',p,'">',g,"</option>")}else d.push("<option>",p,"</option>")}d.push("</optgroup>")}}else if(o&&o.length)for(var c=0,u=o.length;u>c;c++){var f=o[c];if(null!=a&&null!=l){var p=f[l];if(""==p||null==p)continue;if(a==l)d.push("<option>",p,"</option>");else{var g=f[a];d.push('<option value="',p,'">',g,"</option>")}}else if("object"==typeof f)for(var h in f)d.push('<option value="',h,'">',f[h],"</option>");else d.push("<option>",f,"</option>")}return d.push("</select>"),d.join("")},$.fn.pqval=function(t){if(t){if(t.incr){var e=this.data("pq_value");return this.prop("indeterminate",!1),e?(e=!1,this.removeAttr("checked")):e===!1?(e=null,this.prop("indeterminate",!0),this.removeAttr("checked")):(e=!0,this.attr("checked","checked")),this.data("pq_value",e),e}var e=t.val;return this.data("pq_value",e),this.prop("indeterminate",!1),null==e?(this.prop("indeterminate",!0),this.removeAttr("checked")):e?this.attr("checked","checked"):this.removeAttr("checked"),this}return this.data("pq_value")};var _pGenerateView={};_pGenerateView._generateTitleRow=function(t,e,i,r){var o=this.that,n=o.options,a=n.numberCell,l=e.groupTitle,s=t.title,d=e.level,h=e.GMRowIndx,c=t.icon,c=c?c[d]:null,c=c&&c.length&&2==c.length&&"function"==typeof c.push?c:["ui-icon-minus","ui-icon-plus"];if(s&&null!=s[d]){if(s[d]===!1)return;l=s[d].replace("{0}",l),l=l.replace("{1}",e.items)}else l=l+" - "+e.items+" item(s)";i.push(["<tr class='pq-group-row pq-grid-row",r?" pq-last-freeze-row":"","' title=\"",e.groupTitle,"\" level='",d,"' GMRowIndx='",h,"'>"].join("")),a.show&&i.push("<td class='pq-grid-number-cell ui-state-default'><div class='pq-td-div'></div></td>");var u=c[0];e.collapsed&&(u=c[1]),i.push("<td class='pq-grid-cell' colSpan='100' >","<div class='pq-td-div' style='margin-left:",16*d,"px;'>","<span class='ui-icon ",u,"'></span>",l,"</div></td>"),i.push("</tr>")},_pGenerateView._generateSummaryRow=function(t,e,i,r){var o="pq-summary-row pq-grid-row"+(r?" pq-last-freeze-row":""),n=this.that,a=n.options,l=a.virtualX,s=n.initH,d=n.finalH,h=a.freezeCols,c=a.numberCell,u=a.columnBorders,f=(a.wrap,this.offset,"pq-grid-cell "),p="<tr class='"+o+"'>";i.push(p),c.show&&i.push(["<td class='pq-grid-number-cell ui-state-default'>","<div class='pq-td-div'>&nbsp;</div></td>"].join(""));for(var g=0;d>=g;g++){if(s>g&&g>=h&&l&&(g=s,g>d))throw"initH>finalH";var v=e[g],w=v.dataIndx;if(!v.hidden){var x="",I=f;"right"==v.align?I+=" pq-align-right":"center"==v.align&&(I+=" pq-align-center"),g==h-1&&u&&(I+=" pq-last-freeze-col"),v.cls&&(I=I+" "+v.cls);var m=null==t[w]?"&nbsp;":t[w],_=["<td class='",I,"' style='",x,"' >","<div class='pq-td-div'>",m,"</div></td>"].join("");i.push(_)}}return i.push("</tr>"),i},_pGenerateView._generateDetailRow=function(t,e,i,r,o,n){var a="pq-grid-row pq-detail-child";n&&(a+=" pq-last-freeze-row");var l=this.that,s=l.options,d=s.numberCell,h=(i.length,this.offset,"pq-grid-cell ");s.wrap&&!o||(h+="pq-wrap-text "),s.stripeRows&&e/2==parseInt(e/2)&&(a+=" pq-grid-oddRow"),t.pq_rowselect&&(a+=" pq-row-select ui-state-highlight");var c=t.pq_rowcls;return null!=c&&(a+=" "+c),r.push("<tr pq-row-indx='"+e+"' class='"+a+"' >"),d.show&&r.push(["<td class='pq-grid-number-cell ui-state-default'>","<div class='pq-td-div'>&nbsp;</div></td>"].join("")),r.push("<td class='"+h+" pq-detail-child' colSpan='20'></td>"),r.push("</tr>"),r};var cGroupView=function(t){this.that=t},_pGroupView=cGroupView.prototype;_pGroupView._refreshDataFromDataModel=function(){this._groupData(),this.initcollapsed()},_pGroupView.bindEvents=function(){var t=this;this.that.$cont.on("click","tr.pq-group-row",function(e){return t.onClickGroupRow(e)})},_pGroupView.showHideRows=function(t,e,i){for(var r=[],o=this.that,n=o.dataGM,a=t,l=n.length;l>a;a++){var s=n[a],d=s;if(d.groupSummary){if(s.level<e)break;s.pq_hidden=i}else if(d.groupTitle){if(s.collapsed&&r.push({indx:a,level:s.level}),s.level<=e)break;s.pq_hidden=i}else s.pq_hidden=i}return r},_pGroupView.onClickGroupRow=function(t){var e=$(t.currentTarget),i=this.that,r=parseInt(e.attr("level")),o=parseInt(e.attr("GMRowIndx")),n=i.dataGM,a=!0,l=n[o];if(l.collapsed?(l.collapsed=!1,a=!1):(l.collapsed=!0,a=!0),a)this.showHideRows(o+1,r,!0);else for(var s=this.showHideRows(o+1,r,!1),d=0;d<s.length;d++){var h=s[d].indx,r=s[d].level;this.showHideRows(h+1,r,!0)}i._refresh()},_pGroupView.initcollapsed=function(){var t=this.that,e=t.dataGM;if(e)for(var i=0,r=e.length;r>i;i++){var o=e[i],n=o.groupTitle;if(void 0!==n){var a=o.level,l=o.collapsed;l&&this.showHideRows(i+1,a,!0)}}},_pGroupView.max=function(t,e){var i;return"integer"==e||"float"==e?(i=Math.max.apply(Math,t),"float"===e&&(i=i.toFixed(2))):"date"==e?(t=t.sort(function(t,e){return t=Date.parse(t),e=Date.parse(e),t-e}),i=t[t.length-1]):(t=t.sort(),i=t[t.length-1]),i},_pGroupView.min=function(t,e){var i;return"integer"==e||"float"==e?(i=Math.min.apply(Math,t),"float"===e&&(i=i.toFixed(2))):"date"==e?(t=t.sort(function(t,e){return t=Date.parse(t),e=Date.parse(e),t-e}),i=t[0]):(t=t.sort(),i=t[0]),i},_pGroupView.count=function(t){return t.length},_pGroupView.sum=function(t,e){var i,r=0;i="float"===e?parseFloat:"integer"===e?parseInt:function(t){return t};for(var o=0,n=t.length;n>o;o++)r+=i(t[o]);return"float"===e&&(r=r.toFixed(2)),r},_pGroupView._groupData=function(){for(var t=this.that,e=t.data,i=t.options,r=i.groupModel,o=i.pageModel,n=t.colModel,a=o.type?(o.curPage-1)*o.rPP:0,l=n.length,s=r.dataIndx,d=s.length,h=r.collapsed,c=[],u=0;d>u;u++){c[u]=!1;for(var f=0;l>f;f++){var p=n[f],g=p.summary;if(g){var v=g.type;if(v&&"function"==typeof v.push&&v[u]){c[u]=!0;break}}}}if(r&&e&&e.length>0){for(var w=[],x=[],I=[],m=[],_=[],u=0;d>u;u++)m[u]="",I[u]="",_[u]={};for(var b=0,q=e.length;q>=b;b++){for(var y=e[b],C=!1,D=null,u=0;d>u;u++)I[u]=q>b?$.trim(y[s[u]]):"",m[u]!=I[u]&&(C=!0),C&&null==D&&(D=u);if(C){for(var M=0;d>M;M++)m[M]=I[M];if(b>0){for(var u=d-1;u>=D;u--)if(c[u]){for(var P=[],R=0;l>R;R++){var p=n[R],g=p.summary,v=g&&g.type?g.type[u]:null;if(v){var S=p.dataIndx,T="",k=g.title?g.title[u]:null,H="{0}";"function"==typeof v?T=v(_[u][S],p.dataType):(H=v+": {0}",T=this[v](_[u][S],p.dataType)),k&&(H=k),P[S]=H.replace("{0}",T)}}w.push({groupSummary:!0,level:u,data:P})}for(var E=D;d>E;E++)w[x[E]].items=_[E][n[0].dataIndx].length}if(b==q)break;for(var V=d-1;V>=D;V--)for(var O=0;l>O;O++){var p=n[O];_[V][p.dataIndx]=[]}for(var E=D;d>E;E++)w.push({groupTitle:I[E],level:E,GMRowIndx:w.length,collapsed:h&&null!=h[E]?h[E]:!1}),x[E]=w.length-1}y.rowIndx=b+a,y.pq_hidden=!1,w.push(y);for(var F=0;l>F;F++)for(var p=n[F],S=p.dataIndx,u=0;d>u;u++)_[u][S].push(y[S])}t.dataGM=w}};var cDragColumns=function(t){this.that=t,this.$drag_helper=null;var e=t.options.dragColumns,i=e.topIcon,r=e.bottomIcon,o=this;this.status="stop",this.$arrowTop=$("<div class='pq-arrow-down ui-icon "+i+"'></div>").appendTo(t.element),this.$arrowBottom=$("<div class='pq-arrow-up ui-icon "+r+"' ></div>").appendTo(t.element),this.hideArrows(),e&&e.enabled&&t.$header.on("touchstart mousedown","td.pq-grid-col",function(t,e){if($.support.touch){if("touchstart"==t.type){var i=t.originalEvent.touches[0];if(i.pq_composed)return;t.preventDefault(),o.setDraggables(t,e);var r=document.createEvent("UIEvent");r.initUIEvent("touchstart",!0,!0),r.view=window,r.altKey=!1,r.ctrlKey=!1,r.shiftKey=!1,r.metaKey=!1,r.touches=[{pageX:t.pageX,pageY:t.pageY,pq_composed:!0}],r.changedTouches=[{pageX:t.pageX,pageY:t.pageY,pq_composed:!0}],t.target.dispatchEvent(r)}}else if(!t.pq_composed){o.setDraggables(t,e),t.pq_composed=!0;var n=$.Event("mousedown",t);$(t.target).trigger(n)}})},_pDragColumns=cDragColumns.prototype;_pDragColumns.showFeedback=function(t,e){var i=this.that,r=t[0],o=r.offsetParent.offsetParent,n=r.offsetLeft+o.offsetLeft+(e?0:r.offsetWidth)-8,a=i.$grid_inner[0].offsetTop+r.offsetTop-16,l=i.$grid_inner[0].offsetTop+i.$header[0].offsetHeight;this.$arrowTop.css({left:n,top:a,display:""}),this.$arrowBottom.css({left:n,top:l,display:""})},_pDragColumns.showArrows=function(){this.$arrowTop.show(),this.$arrowBottom.show()},_pDragColumns.hideArrows=function(){this.$arrowTop.hide(),this.$arrowBottom.hide()},_pDragColumns.updateDragHelper=function(t){var e=this.that,i=e.options.dragColumns,r=i.acceptIcon,o=i.rejectIcon,n=this.$drag_helper;n&&(t?(n.children("span.pq-drag-icon").addClass(r).removeClass(o),n.removeClass("ui-state-error")):(n.children("span.pq-drag-icon").removeClass(r).addClass(o),n.addClass("ui-state-error")))},_pDragColumns.setDraggables=function(t,e){var i=$(t.currentTarget),r=this.that,o=r.options.dragColumns,n=o.rejectIcon,a=this;i.hasClass("ui-draggable")||r.getHeaderColumnFromTD(i)&&i.draggable({distance:10,cursorAt:{top:-18,left:-10},helper:function(){var t=$(this);a.status="helper",a._setupDroppables(t),r.$header.find(".pq-grid-col-resize-handle").hide();var e=t.attr("pq-col-indx"),i=t.attr("pq-row-indx");t.droppable("destroy");var o=r.headerCells[i][e],l=$("<div class='pq-col-drag-helper ui-widget-content ui-corner-all' ><span class='pq-drag-icon ui-icon "+n+"'></span>"+o.title+"</div>");return a.$drag_helper=l,l[0]},zIndex:"1000",appendTo:r.element,revert:"invalid",drag:function(t,e){a.status="drag";var i=$("td.pq-drop-hover",r.$header);if(i.length>0){a.showArrows(),a.updateDragHelper(!0);var o=i.width(),n=t.clientX-i.offset().left+$(document).scrollLeft();o/2>n?(a.leftDrop=!0,a.showFeedback(i,!0)):(a.leftDrop=!1,a.showFeedback(i,!1))}else a.hideArrows(),r.$toolbar.hasClass("pq-drop-hover")?a.updateDragHelper(!0):a.updateDragHelper()},stop:function(t,e){a.status="stop",r.$header.find(".pq-grid-col-resize-handle").show(),a.hideArrows()}})},_pDragColumns._columnIndexOf=function(t,e){for(var i=0,r=t.length;r>i;i++)if(t[i]==e)return i;return-1},_pDragColumns.refreshSorting=function(){var that=this.that;window.setTimeout(function(){var arr=that.$toolbar.sortable("toArray",{attribute:"sorter"});that.sorters=[];for(var i=0,len=arr.length;len>i;i++)that.sorters.push(eval("("+arr[i]+")"));that.sortLocalData(that.sorters,that.data),that.refresh()},0)},_pDragColumns._setupDroppables=function(t){var e=this.that,i=this,r={hoverClass:"pq-drop-hover ui-state-highlight",tolerance:"pointer",drop:function(t,r){if(!e.dropPending){var o,n,a=parseInt(r.draggable.attr("pq-col-indx"),10),l=parseInt(r.draggable.attr("pq-row-indx"),10),s=parseInt($(this).attr("pq-col-indx"),10),d=$(this).attr("pq-row-indx"),h=e.options.colModel,c=e.headerCells,u=c[l][a];o=0==l?h:c[l-1][a].colModel,n=0==d?h:c[d-1][s].colModel;var f=c[d][s],p=i._columnIndexOf(o,u),g=o.splice(p,1)[0],v=i._columnIndexOf(n,f),w=i.leftDrop?1:0;n.splice(v+1-w,0,g),e.dropPending=!0,window.setTimeout(function(){e._calcThisColModel(),e._refresh(),e.dropPending=!1},0)}}},o=e.$header_left.find("td.pq-left-col"),n=e.$header_right.find("td.pq-right-col");return o=o.add(n),void o.each(function(t,e){var i=$(e);i.hasClass("ui-droppable")||i.droppable(r)});var a,l},fn.options={detailModel:{cache:!0,offset:100,expandIcon:"ui-icon-triangle-1-se",collapseIcon:"ui-icon-triangle-1-e"},dragColumns:{enabled:!0,acceptIcon:"ui-icon-check",rejectIcon:"ui-icon-closethick",topIcon:"ui-icon-circle-arrow-s",bottomIcon:"ui-icon-circle-arrow-n"},track:!1,treeModel:{collapsed:!0,indent:15,leafIcon:"ui-icon-radio-off",expandIcon:"ui-icon-triangle-1-se",collapseIcon:"ui-icon-triangle-1-e"},virtualX:!0,filterModel:{on:!0,mode:"AND",header:!1}},fn._create=function(){$.extend($.paramquery.cGenerateView.prototype,_pGenerateView);var t=this;this.options;this.iGroupView=new cGroupView(this),this.iHeaderSearch=new cHeaderSearch(this),this.iUCData=new $.paramquery.cUCData(this),this.pqSheet={},new cMouseSelection(this),this._super.apply(this),this.iGroupView.bindEvents(),this.pqSheet={},this.iDragColumns=new cDragColumns(this),this._createToolbar(),this.refreshHeader(),this.refreshDataAndView({header:!1}),this.refresh();var e=t.widgetEventPrefix.toLowerCase();t.element.one(e+"load",function(e,i){t._refresh({header:!1})})},fn._createToolbar=function(){var t=this.options,e=t.toolbar;if(e){var i=e,r=i.cls,r=r?r:"",o=i.style,o=o?o:"",n=i.attr,n=n?n:"",a=i.items,l=$("<div class='"+r+"' style='"+o+"' "+n+" ></div>").appendTo($(".pq-grid-top",this.element));l.pqToolbar({items:a,gridInstance:this}),t.showToolbar||l.css("display","none"),this.$toolbar=l}},fn.isLeftOrRight=function(t){var e=(this.options,this.freezeCols);return t>e?"right":"left"},fn.ovCreateHeader=function(t,e){this.options.filterModel.header&&this.iHeaderSearch.createDOM(t,e)},fn._createHeader=function(){this._super.apply(this),this.options.showHeader&&this._trigger("createHeader")},fn.exportExcel=function(t){return t.format="xml",$.paramquery.pqgrid.exportToExcel.call(this,t)},fn.exportCsv=function(t){return t.format="csv",$.paramquery.pqgrid.exportToExcel.call(this,t)},fn.filter=function(t){var e=this,i=this.options,r=void 0===t.apply?!0:t.apply,o=void 0===t.sort?!0:t.sort,n=i.dataModel,a=i.filterModel;if(void 0!=t)for(var l="replace"==t.oper,s=t.data,d=this.colModel,d=r?d:$.extend(!0,[],d),h=0,c=d.length,u=s.length,f=0;c>f;f++){for(var p=d[f],g=!1,v=0;u>v&&h!=u;v++){var w=s[v];if(w.dataIndx==p.dataIndx){g=!0,h++;var x=p.filter,I=w.condition,m=w.value;if(x?x.on=!0:x=p.filter={on:!0},I&&(x.condition=I),I=x.condition,x.value=m,"between"==I)x.value2=w.value2;else if("range"==I){var _=[];if(m)if("string"==typeof m){var b=x.options,q=m.indexOf('"'),y=m.lastIndexOf('"');if(m=m.substr(q,y+1),m=JSON.parse("["+m+"]"),b)for(var C=0,D=b.length;D>C;C++){var M=b[C];-1!=$.inArray(M,m)&&_.push(M)}else _=m.split(",s*")}else"function"==typeof m.push&&(_=m);x.value=_}break}}l&&!g&&p.filter&&(p.filter.on=!1)}var P={header:!1,apply:r,sort:o,CM:d};return"remote"!=n.location||"local"==a.type?e._onDataAvailable(P):void this.remoteRequest({apply:r,CM:d,callback:function(){return e._onDataAvailable(P)}})},fn._initTypeColumns=function(){for(var t=this.colModel,e=0,i=t.length;i>e;e++){var r=t[e];"checkBoxSelection"===r.type?new $.paramquery.cCheckBoxColumn(this,r.dataIndx):"detail"===r.type&&(r.dataIndx="pq_detail",this.iHierarchy=new cHierarchy(this))}},fn.refreshHeader=function(){this._createHeader()},fn.refreshDataFromDataModel=function(){this._super.apply(this);var t=this.options,e=t.groupModel,i=!!e;i&&this.iGroupView._refreshDataFromDataModel()};var cSort=$.paramquery.cSort=function(t){this.that=t},_pSort=cSort.prototype;_pSort._refreshSorters=function(t){var e=this.that,i=e.options,r=i.dataModel,o=r.sortIndx,n=$.isArray(o),a=i.groupModel,l=a?a.dataIndx:null,s=a?a.dir:null,d=-1,h=[];if(a)for(var c=0;c<l.length;c++){var u=l[c];u==t&&(d=c),h.push({dataIndx:u,dir:s&&s[c]?s[c]:"up"})}if(-1!==d){var f=h[d].dir,p="up"===f?"down":"up";h[d].dir=p,s[d]=p}else if(null!=t)if(n){var g=$.inArray(t,r.sortIndx);if(-1!=g)"up"==r.sortDir[g]?r.sortDir[g]="down":1==o.length?r.sortDir[g]="up":(r.sortIndx.splice(g,1),r.sortDir.splice(g,1));else{var v=r.sortIndx.length;r.sortIndx[v]=t,r.sortDir[v]="up"}}else r.sortIndx==t?r.sortDir="up"==r.sortDir?"down":"up":(r.sortIndx=t,r.sortDir="up");if(null!=r.sortIndx)if(n)for(var c=0;c<o.length;c++){var w=o[c];-1==this.inSorters(h,w)&&h.push({dataIndx:w,dir:r.sortDir[c]})}else-1==this.inSorters(h,r.sortIndx)&&h.push({dataIndx:r.sortIndx,dir:r.sortDir});this.sorters=h},_pSort.inSorters=function(t,e){for(var i=-1,r=0;r<t.length;r++){var o=t[r];if(o.dataIndx==e){i=r;break}}return i},_pSort._sortLocalData=function(t){for(var e=this.that,i=e.options,r=(i.dataModel,e.colModel),o=this.sorters,n=0;n<o.length;n++){var a=o[n],l=a.dataIndx,s=e.getColIndx({dataIndx:l}),d=r[s].dataType;a.dataType=d}return this.__sortLocalData(o,t)},_pSort.__sortLocalData=function(t,e){function i(t,e,i,r){var o=t[i],n=e[i];return o=o?parseInt(o,10):0,n=n?parseInt(n,10):0,(o-n)*r}function r(t,e,i,r){var o=t[i],n=e[i];return o=o?Date.parse(o):0,n=n?Date.parse(n):0,(o-n)*r}function o(t,e,i,r,o){var n=t[i],a=e[i];return o(n,a)*r}function n(t,e,i,r){var o=(t[i]+"").replace(/,/g,""),n=(e[i]+"").replace(/,/g,"");return o=o?parseFloat(o):0,n=n?parseFloat(n):0,(o-n)*r}function a(t,e,i,r){var o=t[i],n=e[i];o=o?o:"",n=n?n:"";var a=0;return o>n?a=1:n>o&&(a=-1),a*r}function l(t,e,i,r){var o=t[i],n=e[i];o=o?o.toUpperCase():"",n=n?n.toUpperCase():"";var a=0;return o>n?a=1:n>o&&(a=-1),a*r}function s(t,e,i,r){var o=t[i],n=e[i],a=0;return o&&!n||o===!1&&null===n?a=1:(n&&!o||n===!1&&null===o)&&(a=-1),a*r}function d(){function d(t,e){for(var i=0,r=0;f>r&&(i=h[r](t,e,c[r],u[r]),0==i);r++);return i}for(var h=[],c=[],u=[],f=t.length,p=0;f>p;p++){var g=t[p],v=g.dataIndx,w="up"==g.dir?1:-1,x=g.dataType;c[p]=v,u[p]=w,"integer"==x?h[p]=i:"float"==x?h[p]=n:"function"==typeof x?h[p]=function(t){return function(e,i,r,n){return o(e,i,r,n,t)}}(x):"date"==x?h[p]=r:"stringi"==x?h[p]=l:"bool"==x?h[p]=s:h[p]=a}e=e.sort(d)}if(null!=e&&0!=e.length)return t&&t.length?($.measureTime(d,"innerSort"),e):e},fn._refreshHeaderSortIcons=function(){var t=this.options,e=(t.dataModel,this.iSort.sorters),i=(this.colModel,this.$header),r=i.find(".pq-grid-col");r.removeClass("pq-col-sort-asc pq-col-sort-desc ui-state-active"),i.find(".pq-col-sort-icon").removeClass("ui-icon ui-icon-triangle-1-n ui-icon-triangle-1-s");for(var o=0;o<e.length;o++){var n=e[o],a=n.dataIndx,l=this.getColIndx({dataIndx:a}),s=n.dir,d="ui-state-active pq-col-sort-"+("up"==s?"asc":"desc"),h="ui-icon ui-icon-triangle-1-"+("up"==s?"n":"s");i.find(".pq-grid-col[pq-grid-col-indx="+l+"]").addClass(d),i.find(".pq-grid-col[pq-grid-col-indx="+l+"] .pq-col-sort-icon").addClass(h)}},fn.getHeaderColumnFromTD=function(t){var e=t.attr("pq-grid-col-indx");if(null!=e){var i=this.colModel[e];return i}},fn.getIndxInSorters=function(t){for(var e=this.sorters,i=0,r=e.length;r>i;i++)if(e[i].dataIndx==t)return i;return-1},fn._simulateEvent=function(t,e){if(!(t.originalEvent.touches.length>1)){t.preventDefault();var i=t.originalEvent.changedTouches[0],r=document.createEvent("MouseEvents");r.initMouseEvent(e,!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null),t.target.dispatchEvent(r)}},fn._getTblSingle=function(t,e){var i=this.$tbl,e=null!=e?e:0,r=this.options,o=r.freezeCols,n=r.freezeRows;return void 0!=i&&(i=$(4==i.length?t>=n&&e>=o?i[3]:t>=n&&o>e?i[2]:n>t&&e>=o?i[1]:i[0]:2==i.length?t>=n&&e>=o?i[1]:i[0]:i[0])),i},fn.getLargestRowCol=function(t){for(var e,i=0;i<t.length;i++){var r=t[i],o=r.rowIndx;null==e?e=r.rowIndx:o>e&&(e=o),e=r.rowIndx}},fn._onLoad=function(){this.options.dataModel.postData=""},fn._onRefreshSheet=function(){var t=this.$dragSeries.data();if(t){var e=t.rowIndx,i=t.colIndx;t.left,t.top;this.bb(e,i)}},fn.bringCellToView=function(t){this._bringCellToView(t)},fn._setUrl=function(t){
this.options.dataModel.getUrl=function(){return{url:this.url+(null!=t?t:"")}}},fn.getDataPage=function(){return this.data},fn.getData=function(t){var e=t.dataIndx,i=e.length,r=t.data,o=this.options.dataModel,n=o.data,a=o.dataUF,l=[],s=function(t){for(var r=0,o=t.length;o>r;r++){for(var n=t[r],a={},s=0;i>s;s++){var d=e[s];a[d]=n[d]}l.push(a)}};r?s(r):(n&&s(n),a&&s(a));for(var d=[],h=0;i>h;h++){var c=e[h],u=this.getColumn({dataIndx:c});d.push({dataIndx:c,dir:"up",dataType:u.dataType})}l=this.iSort.__sortLocalData(d,l);for(var f=[],p=void 0,g=0;g<l.length;g++){var v=l[g],w=JSON.stringify(v);w!==p&&(f.push(v),p=w)}return f},fn.getFilterData=function(t){var e=t.CM;if(!e)throw"CM N/A";for(var i=e.length,r=t.location,o=this.options.filterModel,n=o.multiple,a=$.paramquery.filter.getAllConditions,l=$.paramquery.filter.getTRConditions,s=[],d=function(t,e,i){return"between"==t?null!=e&&""!==e||null!=i&&""!==i:-1!=$.inArray(t,a)?null!=e&&""!==e||-1==$.inArray(t,l):!0},h=function(t,e){return"remote"==r?(t=null==t?"":t,t.toString()):cFilterData.convert(t,e)},c=0;i>c;c++){var u=e[c],f=u.dataIndx,p=u.dataType,p=p&&"function"!=typeof p?p:"string",g=u.filter;if(n){var v=u.filterModel;if(v&&v.on){for(var w=[],x=v.mode,I=v.filters,m=0;m<I.length;m++){var g=I[m],_=g.value,b=g.condition;d(b,_)&&(_=h(_,p),w.push({value:_,condition:b}))}s.push({dataIndx:f,mode:x,dataType:p,filters:w})}}else if(g&&g.on){var _=g.value,q=g.value2,b=g.condition;if(d(b,_,q)){if("between"==b)""===_||null==_?(b="lte",_=h(q,p)):""===q||null==q?(b="gte",_=h(_,p)):(_=h(_,p),q=h(q,p));else if("regexp"==b){if("remote"==r)_=_.toString();else if("string"==typeof _)try{var y=g.modifiers,y=y?y:"gi";_=new RegExp(_,y)}catch(C){_=/.*/}}else if("range"==b){if(null==_)continue;if("string"==typeof _)_=h(_,p),_=_.split(/\s*,\s*/);else if(_&&"function"==typeof _.push){if(0==_.length)continue;_=_.slice();for(var m=0,D=_.length;D>m;m++)_[m]=h(_[m],p)}}else _=h(_,p);s.push({dataIndx:f,value:_,value2:q,condition:b,dataType:p,cbFn:"remote"==r?"":cFilterData.conditions[b]})}}}return s};var cFilterData=function(t){this.that=t},_pFilterData=cFilterData.prototype;cFilterData.conditions={equal:function(t,e){return t==e?!0:void 0},contain:function(t,e){return-1!=t.indexOf(e)?!0:void 0},notcontain:function(t,e){return-1==t.indexOf(e)?!0:void 0},empty:function(t){return 0==t.length?!0:void 0},notempty:function(t){return t.length>0?!0:void 0},begin:function(t,e){return 0==t.indexOf(e)?!0:void 0},notbegin:function(t,e){return 0!=t.indexOf(e)?!0:void 0},end:function(t,e){var i=t.lastIndexOf(e);return-1!=i&&i+e.length==t.length?!0:void 0},notend:function(t,e){var i=t.lastIndexOf(e);return-1==i||i+e.length!=t.length?!0:void 0},regexp:function(t,e){return e.test(t)?(e.lastIndex=0,!0):void 0},notequal:function(t,e){return t!=e?!0:void 0},great:function(t,e){return t>e?!0:void 0},gte:function(t,e){return t>=e?!0:void 0},between:function(t,e,i){return t>=e&&i>=t?!0:void 0},range:function(t,e){return-1!=$.inArray(t,e)?!0:void 0},less:function(t,e){return e>t?!0:void 0},lte:function(t,e){return e>=t?!0:void 0}},cFilterData.convert=function(t,e){return t=null==t?"":t,"string"==e?t=$.trim(t).toUpperCase():"date"==e?t=Date.parse(t):"integer"==e?t=parseInt(t):"float"==e?t=parseFloat(t):"bool"==e&&(t=String(t).toLowerCase()),t},_pFilterData.isMatchCellSingle=function(t,e){var i=t.dataIndx,r=t.dataType,o=t.value,n=t.value2,a=t.condition,l=t.cbFn,s=e[i];s="regexp"==a?null==s?"":s:cFilterData.convert(s,r);var d=!!l(s,o,n);return d},_pFilterData.isMatchCellMultiple=function(t,e){var i=t.dataIndx,r=t.dataType,o=t.mode,n=t.filters,a=n.length;if(0==a)return!0;for(var l=0;a>l;l++){var s=n[l],d=s.value,h=s.condition,c=e[i],u=this.isMatchRule(c,h,d,r);if("OR"==o&&u)return!0;if("AND"==o&&!u)return!1}return 1===a?u:"AND"==o?!0:"OR"==o?!1:void 0},_pFilterData.isMatchRow=function(t,e,i){if(0==e.length)return!0;for(var r=0;r<e.length;r++){var o=e[r],n=this.isMatchCell(o,t);if("OR"==i&&n)return!0;if("AND"==i&&!n)return!1}return"AND"==i?!0:"OR"==i?!1:void 0},fn.filterLocalData=function(t){t=t?t:{};var e=t.apply,i=e===!1?t.CM:this.colModel,r=this.getFilterData({CM:i}),o=this.options,n=o.dataModel,a=n.data,l=n.dataUF,s=[],d=[],h=o.filterModel,c=h.multiple,u=h?h.mode:null,f=new cFilterData;if(c?f.isMatchCell=f.isMatchCellMultiple:f.isMatchCell=f.isMatchCellSingle,h.on&&u){if(a)for(var p=0,g=a.length;g>p;p++){var v=a[p];f.isMatchRow(v,r,u)?s.push(v):d.push(v)}if(l)for(var p=0,g=l.length;g>p;p++){var v=l[p];f.isMatchRow(v,r,u)?s.push(v):d.push(v)}}else{if(a)for(var p=0,g=a.length;g>p;p++){var v=a[p];s.push(v)}if(l)for(var p=0,g=l.length;g>p;p++){var v=l[p];s.push(v)}}return e&&(n.data=s,n.dataUF=d,this._trigger("filter",null,{type:"local",dataModel:n,colModel:i,filterModel:h})),{data:s,dataUF:d}},fn._onDataAvailable=function(t){t=t?t:{};var e=this.options,i=t.apply,r=t.sort,o=[],n=e.filterModel,a=e.dataModel,l=a.location;return i!==!1&&this._trigger("dataAvailable",t.evt,{dataModel:a}),o=n&&n.on&&("local"==l&&"remote"!=n.type||"remote"==l&&"local"==n.type)?this.filterLocalData(t).data:a.data,a.sorting&&"local"==a.sorting&&r!==!1&&(o=this.iSort._sortLocalData(o)),i===!1?o:(a.data=o,void this.refreshView(t))},fn.sort=function(t){var e=this,i=this.options,r=t.colIndx,o=t.dataIndx,n=t.evt,a=i.dataModel;if(null!=r||null!=o||(o=a.sortIndx,null!=o)){r=null==r?this.getColIndx({dataIndx:o}):r;var l=this.colModel[r];o=null==o?l.dataIndx:o,0!=e._trigger("beforeSort",n,{dataModel:a,column:l,dataIndx:o})&&(null!=e.$td_edit&&e.quitEditMode(),this.iSort._refreshSorters(o),"local"==a.sorting?(this.iSort._sortLocalData(a.data),this.refreshView()):"remote"==a.sorting&&this.remoteRequest({callback:function(){e._trigger("sort",n,{dataModel:a,column:l,dataIndx:o}),e._onDataAvailable()}}))}},fn._setScrollVLength=function(t){var e=this.options.groupModel;t=e?this.dataGM:t,this._super.call(this,t)},$.widget("paramquery.pqGrid",$.paramquery._pqGrid,fn),$.paramquery.pqGrid.regional={},$.paramquery.pqGrid.regional.en=fn._regional}(jQuery),function(t){t.paramquery=null==t.paramquery?{}:t.paramquery,t.paramquery.pqgrid=null==t.paramquery.pqgrid?{}:t.paramquery.pqgrid,t.paramquery.pqgrid.exportToExcel=function(e){var i=this,r=void 0===e.urlPost?e.url:e.urlPost,o=e.url,n=null==e.sheetName?"pqGrid":e.sheetName,a=e.format,l=function(){for(var t=i.colModel,e=t.length,r=i.options,o=r.dataModel,a=o.data,l=a.length,s=[],d=[],h=0;e>h;h++){var c=t[h];c.hidden||d.push('<Column ss:AutoFitWidth="1"  ss:Width="'+c.width+'" />')}d.push("<Row>");for(var h=0;e>h;h++){var c=t[h];c.hidden||d.push('<Cell><Data ss:Type="String">'+c.title+"</Data></Cell>")}d.push("</Row>"),d=d.join("\n");for(var h=0;l>h;h++){var u=a[h];s.push("<Row>");for(var f=0;e>f;f++){var c=t[f];if(!c.hidden){var p=c.dataIndx;s.push('<Cell><Data ss:Type="String"><![CDATA['+u[p]+"]]></Data></Cell>")}}s.push("</Row>")}s=s.join("\n");var g=['<?xml version="1.0"?>','<?mso-application progid="Excel.Sheet"?>','<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"',' xmlns:o="urn:schemas-microsoft-com:office:office"',' xmlns:x="urn:schemas-microsoft-com:office:excel"',' xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"',' xmlns:html="http://www.w3.org/TR/REC-html40">','<Worksheet ss:Name="',n,'">',"<Table>",d,s,"</Table>","</Worksheet>","</Workbook>"];return g.join("\n")},s=function(){for(var t=i.colModel,e=t.length,r=i.options,o=r.dataModel,n=o.data,a=n.length,l=[],s=[],d=[],h=0;e>h;h++){var c=t[h];if(!c.hidden){var u=c.title.replace(/\"/g,'""');s.push('"'+u+'"')}}l.push(s.join(","));for(var h=0;a>h;h++){for(var f=n[h],p=0;e>p;p++){var c=t[p];if(!c.hidden){var g=c.dataIndx,v=f[g]+"";v=v.replace(/\"/g,'""'),d.push('"'+v+'"')}}l.push(d.join(",")),d=[]}return l.join("\n")},d="xml"==a?l():s();t.ajax({url:r,type:"POST",cache:!1,data:{extension:a,excel:d},success:function(e){var i=o+((o.indexOf("?")>0?"&":"?")+"filename="+e);t(document.body).append("<iframe height='0' width='0' frameborder='0'  src="+i+"></iframe>")}})}}(jQuery),function(t){var e=t.paramquery.cUCData=function(t){this.that=t,this.udata=[],this.ddata=[],this.adata=[]},i=e.prototype;i.add=function(t){for(var e=this.that,i=this.adata,r=t.rowData,o=e.getRecId({rowData:r}),n=0,a=i.length;a>n;n++){var l=i[n];if(null!=o&&l.recId==o)throw"primary key violation";if(l.rowData==r)throw"same data can't be added twice."}var t={recId:o,rowData:r};i.push(t)},i.update=function(t){var e=this.that,i=e.getRowData(t),r=e.getRecId({rowData:i}),o=t.dataIndx,n=t.oldVal,a=t.newVal,l=this.udata,s=!1;if(null!=r){for(var d=0,h=l.length;h>d;d++){var c=l[d];if(c.rowData==i&&c.dataIndx==o){if(s=!0,c.oldVal==a){l.splice(d,1);var u={rowData:i,dataIndx:o,cls:"pq-cell-dirty"};e.removeClass(u)}else c.newVal=a;break}}if(!s){var u={rowData:i,recId:r,dataIndx:o,newVal:a,oldVal:n};l.push(u);var u={rowData:i,dataIndx:o,cls:"pq-cell-dirty"};e.addClass(u)}}},i["delete"]=function(t){for(var e=this.that,i=t.rowIndx,r=t.rowIndxPage,o=e.rowIndxOffset,i=null==i?r+o:i,r=null==r?i-o:r,n=e.options.pageModel.type,a="remote"==n?r:i,l=this.adata,s=this.ddata,d=e.getRowData(t),h=0,c=l.length;c>h;h++)if(l[h].rowData==d)return void l.splice(h,1);s.push({indx:a,rowData:d})},i.isDirty=function(){var t=(this.that,this.udata),e=this.adata,i=this.ddata;return!!(t.length||e.length||i.length)},i.getChangesValue=function(){for(var e=(this.that,this.udata),i=this.adata,r=this.ddata,o={updateList:[],addList:[],deleteList:[]},n=[],a=[],l=[],s=[],d=[],h=0,c=r.length;c>h;h++){var u=r[h],f=u.rowData,p={};s.push(f);for(var g in f)0!=g.indexOf("pq_")&&(p[g]=f[g]);d.push(p)}for(var h=0;h<e.length;h++){var u=e[h],f=u.rowData;if(-1==t.inArray(f,s)&&-1==t.inArray(f,n)){var p={};for(var g in f)0!=g.indexOf("pq_")&&(p[g]=f[g]);n.push(f),a.push(p)}}for(var h=0;h<i.length;h++){var u=i[h],f=u.rowData,p={};for(var g in f)0!=g.indexOf("pq_")&&(p[g]=f[g]);l.push(p)}return o.updateList=a,o.addList=l,o.deleteList=d,o},i.getChanges=function(){for(var e=(this.that,this.udata),i=this.adata,r=this.ddata,o={updateList:[],addList:[],deleteList:[]},n=[],a=[],l=[],s=0,d=r.length;d>s;s++){var h=r[s],c=h.rowData;l.push(c)}for(var s=0;s<e.length;s++){var h=e[s],c=h.rowData;-1==t.inArray(c,l)&&-1==t.inArray(c,n)&&n.push(c)}for(var s=0;s<i.length;s++){var h=i[s],c=h.rowData;a.push(c)}return o.updateList=n,o.addList=a,o.deleteList=l,o},i.getChangesRaw=function(){var t=(this.that,this.udata),e=this.adata,i=this.ddata,r={updateList:[],addList:[],deleteList:[]};return r.updateList=t,r.addList=e,r.deleteList=i,r},i.commitAdd=function(e,i){for(var r=this.that.colModel,o=r.length,n=this.adata,a=n.length,l=e.length,s=[],d=0;l>d;d++)for(var h=e[d],c=0;a>c;c++){for(var u=n[c].rowData,f=!0,p=0;o>p;p++){var g=r[p],v=g.hidden,w=g.dataIndx;if(!v&&w!=i){var x=u[w],x=null==x?"":x+"",I=h[w],I=null==I?"":I+"";if(x!=I){f=!1;break}}}f&&(u[i]=h[i],s.push(u))}for(var m=[],c=0;a>c;c++){var u=n[c].rowData;-1==t.inArray(u,s)&&m.push(n[c])}this.adata=m},i.commitUpdate=function(e,i){for(var r=this.that,o=r.colModel,n=o.length,a=this.udata,l=a.length,s=e.length,d=[],h=0;l>h;h++){var c=a[h].rowData;if(-1==t.inArray(c,d))for(var u=0;s>u;u++){var f=e[u];if(c[i]==f[i]){d.push(c);for(var p=0;n>p;p++){var g=o[p],v=(g.hidden,g.dataIndx);void 0!==f[v]&&(c[v]=f[v]),r.removeClass({rowData:c,dataIndx:v,cls:"pq-cell-dirty",refresh:!1})}}}}for(var w=[],h=0;l>h;h++){var c=a[h].rowData;-1==t.inArray(c,d)&&w.push(a[h])}this.udata=w},i.commitDelete=function(e,i){for(var r=this.ddata,o=r.length,n=e.length,a=[],l=0;o>l;l++)for(var s=r[l].rowData,d=0;n>d;d++){var h=e[d];s[i]==h[i]&&a.push(s)}for(var c=[],l=0;o>l;l++){var s=r[l].rowData;-1==t.inArray(s,a)&&c.push(r[l])}this.ddata=c},i.commitUpdateAll=function(){for(var t=this.that,e=this.udata,i=0,r=e.length;r>i;i++){var o=e[i],n=o.dataIndx,a=o.rowData;t.removeClass({rowData:a,dataIndx:n,cls:"pq-cell-dirty"})}this.udata=[]},i.commitAddAll=function(){this.adata=[]},i.commitDeleteAll=function(){this.ddata=[]},i.commit=function(t){var e=this.that,i=e.options.dataModel,r=i.recIndx;if(null==t)this.commitAddAll(),this.commitUpdateAll(),this.commitDeleteAll();else{var o=t.type,n=t.rows;"add"==o?n?this.commitAdd(n,r):this.commitAddAll():"update"==o?n?this.commitUpdate(n,r):this.commitUpdateAll():"delete"==o&&(n?this.commitDelete(n,r):this.commitDeleteAll())}e.refreshView()},i.rollbackAdd=function(t,e){for(var i=this.adata,r=t.type,o=0,n=i.length;n>o;o++)for(var a=i[o],l=a.rowData,s=0,d=e.length;d>s;s++)if(e[s]==l){var h=e.splice(s,1);h&&h.length&&"remote"==r&&t.totalRecords--;break}this.adata=[]},i.rollbackDelete=function(t,e){for(var i=this.ddata,r=t.type,o=i.length-1;o>=0;o--){var n=i[o],a=n.indx,l=n.rowData;e.splice(a,0,l),"remote"==r&&t.totalRecords++}this.ddata=[]},i.rollbackUpdate=function(t,e){for(var i=this.that,r=this.udata,o=0,n=r.length;n>o;o++){var a=r[o],l=a.recId,s=a.rowData,d=a.dataIndx;null!=l&&(s[d]=a.oldVal,i.removeClass({rowData:s,dataIndx:d,cls:"pq-cell-dirty",refresh:!1}))}this.udata=[]},i.rollback=function(t){var e=this.that,i=e.options.dataModel,r=e.options.pageModel,o=t&&null!=t.refresh?t.refresh:!0,n=t&&null!=t.type?t.type:null,a=i.data;null!=n&&"update"!=n||this.rollbackUpdate(r,a),null!=n&&"delete"!=n||this.rollbackDelete(r,a),null!=n&&"add"!=n||this.rollbackAdd(r,a),o&&e.refreshView()};var r=t.paramquery.pqGrid.prototype;r.getChanges=function(t){if(this.quitEditMode(),t){var e=t.format;if(e){if("byVal"==e)return this.iUCData.getChangesValue();if("raw"==e)return this.iUCData.getChangesRaw()}}return this.iUCData.getChanges()},r.rollback=function(t){this.quitEditMode(),this.iUCData.rollback(t)},r.isDirty=function(){return this.iUCData.isDirty()},r.commit=function(t){this.quitEditMode(),this.iUCData.commit(t)},r._getRowIndx=function(){var t=this,e=t.selection({type:"row",method:"getSelection"});if(!(e&&e.length>0))return null;var i=e[0].rowIndx,r=t.rowIndxOffset,o=t.options.pageModel,n=o.type,a=i-r,l=o.rPP;return n?a>=0&&l>a?i:void 0:i},r.updateRow=function(t){var e=this,i=e.options,r=i.track,r=null!=t.track?t.track:r,o=t.rowIndx,n=t.row,a=!1,l=e.getRowData({rowIndx:o}),s={rowData:l};for(var d in n){var h=l[d],c=n[d];c!==h&&(a=!0,r&&(s.dataIndx=d,s.oldVal=h,s.newVal=c,this.iUCData.update(s)),l[d]=c)}a&&e.refreshRow({rowIndx:o})},r._fillForm=function(t){var e=this,i=e.options.dataModel,r=e.options.pageModel,o=r.type,n=i.data,a=e.colModel,l=e.rowIndxOffset,s=null==t.rowIndxPage?t.rowIndx-l:t.rowIndxPage,d=null==t.rowIndx?s+l:t.rowIndx,h="remote"==o?s:d,c=n[h];this.rowData=c,this.$crudDialog.dialog("option","title","Edit Record ("+(d+1)+")");for(var u=this.$crudForm,f=0;f<a.length;f++){var p=a[f],g=p.dataIndx,v=c[g];u.find("*[name='"+g+"']").val(v)}},r.getRecId=function(t){var e=this,i=e.options.dataModel;t.dataIndx=i.recIndx;var r=e.getCellData(t);return r},r.getCellData=function(t){var e=this.getRowData(t),i=t.dataIndx;return e[i]},r.getRowData=function(t){var e=t.rowData;if(null!=e)return e;var i=this.options,r=i.dataModel,o=i.pageModel,n=o.type,a=r.recIndx,l=t.recId,s=r.data;if(null==l){var d=t.rowIndx,h=t.rowIndxPage,c=this.rowIndxOffset,d=null!=d?d:h+c,h=null!=h?h:d-c,u="remote"==n?h:d,f=s[u];return f}for(var p=0,g=s.length;g>p;p++){var f=s[p];if(f[a]==l)return f}},r.deleteRow=function(t){var e=this,i=t.rowIndx,r=t.effect,o=e.options,n=o.dataModel,a=o.pageModel,l=a.type;if(null!=i){var s="remote"==l?i-this.rowIndxOffset:i,d=n.data,h=o.track,h=null!=t.track?t.track:h;if(h&&this.iUCData["delete"]({rowIndx:i}),r){var e=this,c=this.getRow({rowIndx:i});c&&c.effect("fade",null,350,function(){var i=t.complete;i&&"function"==typeof i&&i.call(e);var r=d.splice(s,1);r&&r.length&&"remote"==l&&a.totalRecords--,e.refreshView()})}else{var u=d.splice(s,1);u&&u.length&&"remote"==l&&a.totalRecords--,this.refreshView()}}},r._onDialogOpen=function(){var e=this,i=this,r=this.$crudDialog.parent(".ui-dialog");if(t(".pq-dialog-buttonset",r).remove(),0!=this.crudEditMode){var o=t("<div style='' class='pq-dialog-buttonset'></div>").prependTo(t(".ui-dialog-buttonpane",r));this.prev=t("<button type='button' class='ui-corner-left'></button>").appendTo(o).button({icons:{primary:"ui-icon-circle-triangle-w"},text:!1}).bind("click",function(t){var r=e.rowPrevSelect();i._fillForm({rowIndxPage:r})}),this.prev.removeClass("ui-corner-all"),this.next=t("<button type='button' class='ui-corner-right'></button>").appendTo(o).button({icons:{primary:"ui-icon-circle-triangle-e"},text:!1}).bind("click",function(t){var r=e.rowNextSelect();i._fillForm({rowIndxPage:r})}),this.next.removeClass("ui-corner-all")}},r.getFormData=function(t){for(var e=this,i={},r=e.colModel,o=0;o<r.length;o++){var n=r[o],a=n.dataIndx,l=t.find("*[name='"+a+"']");i[a]=l.val()}return i},r.addRow=function(t){var e=this;return e._addLocal(t)},r._addLocal=function(t){var e=this,i=t.rowData,r=t.rowIndx,o=t.rowIndxPage,n=e.options,a=n.dataModel,l=n.pageModel,s=l.type,d=n.track,d=null!=t.track?t.track:d,h=a.data;if(null==i)return null;if(null==h&&(a.data=[],h=a.data),d&&this.iUCData.add({rowData:i}),null==r&&null==o)h.push(i);else{var c=this.rowIndxOffset,r=null==r?o+c:r,o=null==o?r-c:o,u="remote"==s?o:r;h.splice(u,0,i)}return"remote"==s&&l.totalRecords++,!t.refresh!=!1&&this.refreshView(),null==r?h.length-1:r},r._addRemote=function(t){var e=this,i=t.rowData;i.pq_oper="add",e.options.dataModel.postDataOnce=i}}(jQuery),function(t){var e={};e.options={items:[],gridInstance:null},e._create=function(){var e=this.options,i=e.gridInstance,r=i.colModel,o=e.items,n=this.element;n.closest(".pq-grid");n.addClass("pq-toolbar");for(var a=0,l=o.length;l>a;a++){var s,d=o[a],h=d.type,c=d.icon,e=d.options,u=d.label,f=d.listeners,p=d.cls,g="ui-corner-all "+(p?p:""),v=d.style,w=v?'style="'+v+'"':"",x=d.attr,I=x?x:"";if("textbox"==h)s=t("<input type='text' class='"+g+"' "+I+" "+w+">").appendTo(n);else if("checkbox"==h)s=t("<input type='checkbox' class='"+g+"' "+I+" "+w+">").appendTo(n);else if("separator"==h)t("<span class='pq-separator '"+g+"' "+I+" "+w+"></span>").appendTo(n);else if("button"==h)s=t("<button type='button' class='"+g+"' "+I+" "+w+">"+u+"</button>").button({text:!!u,icons:{primary:c}}).appendTo(n);else if("select"==h){var e=d.options?d.options:[];"function"==typeof e&&(e=e.call(i.element,{colModel:r})),m=t.paramquery.select({options:e,attr:" class='"+g+"' "+I+" "+w,prepend:d.prepend,groupIndx:d.groupIndx,valueIndx:d.valueIndx,labelIndx:d.labelIndx}),s=t(m).appendTo(n)}else if("string"==typeof h)s=t(h).appendTo(n);else if("function"==typeof h){var m=h.call(i,{colModel:r,cls:g});s=t(m).appendTo(n)}if(f)for(var _=0;_<f.length;_++){var b=f[_];for(var q in b)s.bind(q,b[q])}}},e._destroy=function(){this.element.empty().removeClass("pq-toolbar").enableSelection()},e._disable=function(){null==this.$disable&&(this.$disable=t("<div class='pq-grid-disable'></div>").css("opacity",.2).appendTo(this.element))},e._enable=function(){this.$disable&&(this.element[0].removeChild(this.$disable[0]),this.$disable=null)},e._setOption=function(t,e){"disabled"==t&&(1==e?this._disable():this._enable())},t.widget("paramquery.pqToolbar",e)}(jQuery),function(t){var e=function(){this.focusSelection=null},i=e.prototype;i.getOldRowSel=function(){var t,e=this.that;if((t=this.focusSelection)&&this.isSelected(t)){var i=e.getRowIndx(t);return i.rowData=t.rowData,i}},i.getOldCellSel=function(){var t,e=this.that;if((t=this.focusSelection)&&this.isSelected(t)){var i=t.rowData,r=e.getRowIndx({rowData:i});return r.rowData=i,r.dataIndx=t.dataIndx,r}},i.getNewRowSel=function(){var e=this.that,i=document.activeElement?t(document.activeElement):null;if(i&&i.hasClass("pq-grid-row")){var r=i.closest(".pq-grid");if(r[0]==e.element[0]){var o=e.getRowIndx({$tr:i});return o.$tr=i,o}}},i.getNewCellSel=function(){var e=this.that,i=document.activeElement?t(document.activeElement):null;if(i&&i.hasClass("pq-grid-cell")){var r=i.closest(".pq-grid");if(r[0]==e.element[0]){var o=e.getCellIndices({$td:i});return o.$td=i,o}}},i.getFocusSelection=function(t){return this instanceof r?t&&t.old===!0?this.getOldRowSel():this.getNewRowSel():this instanceof o?t&&t.old===!0?this.getOldCellSel():this.getNewCellSel():void 0},i.getFirstSelection=function(){var t=this.firstSelection;if(t&&this.isSelected(t))return t;this.refresh();var e=this.selection;return e.length?(this.firstSelection=e[0],e[0]):void 0},i.getLastSelection=function(){var t=this.lastSelection;if(t){var e=this.that,i=t.rowData,r=e.getRowData({rowIndx:rowIndx});return i==r&&this.isSelected(t)?t:!1}return null},i.getLastSelectionCurPage=function(){var t=this.lastSelection;if(t&&this.isSelected(t)){var e=t.rowIndx,i=this.that.options.pageModel;if(i.type){var r=i.curPage,o=i.rPP;return Math.ceil((e+1)/o)==r?t:null}return t}return null},i.getSelection=function(){return this.refresh(),this.selection},i.getSelectionCurPage=function(){var t=this.that,e=this.getSelection(),i=[],r=t.options,o=r.dataModel,n=r.pageModel;if(n.type){for(var a=o.curPage,l=o.rPP,s=0;s<e.length;s++){var d=e[s],h=d.rowIndx;Math.ceil((h+1)/l)==a&&i.push(d)}return i}return e},i.setDirty=function(){};var r=function(t){this.that=t,this.options=t.options,this.selection=[]};t.paramquery.cRows=r;var o=function(t){this.options=t.options,this.that=t,this.selection=[]};t.paramquery.cCells=o;var n=o.prototype=new e,a=r.prototype=new e;a.extendSelection=function(t){var e=this.that,i=t.rowIndx,r=e.options.selectionModel.mode,o=t.evt,n=this.getFirstSelection();if(null==n)return void e.setSelection({rowIndx:i});if("single"!=r){var a=n.rowIndx,l=a,s=i;a>i&&(l=i,s=a),this.selectRange({initRowIndx:l,finalRowIndx:s,evt:o}),this.add({rowIndx:i})}},a.refresh=function(){this.selection=[];var t=this.that,e=t.options,i=e.dataModel,r=e.pageModel,o=r.type,n="remote"==o,a=t.rowIndxOffset,l=i.data;if(l)for(var s=0,d=l.length;d>s;s++){var h=l[s];if(h.pq_rowselect){var c=n?s+a:s;this.selection.push({rowIndx:c,rowData:h})}}},a.replace=function(t){var e=t.rowIndx,i=null==t.offset?this.that.getRowIndxOffset():t.offset,r=e-i;t.$tr,t.evt;t.offset=i,t.rowIndxPage=r,this.removeAll({raiseEvent:!0}),this.add(t)},a.indexOf=function(t){this.refresh();for(var e=t.rowIndx,i=this.selection,r=0;r<i.length;r++)if(i[r].rowIndx==e)return r;return-1},a.isSelected=function(t){var e=this.that,i=e.getRowData(t);return i?null==i.pq_rowselect?!1:i.pq_rowselect:null},a._boundRow=function(t){var e=t.rowIndxPage,i=this.that,r=null==t.$tr?i.getRow({rowIndxPage:e}):t.$tr;return null==r||0==r.length?!1:(r.addClass("pq-row-select ui-state-highlight"),r)},a.selectRange=function(t){for(var e=(this.that,t.initRowIndx),i=t.finalRowIndx,r=(t.evt,this.getSelection()),o=r.slice(0),n=0;n<o.length;n++){var a=o[n],l=a.rowIndx;(e>l||l>i)&&this.remove({rowIndx:l})}if(e>i){var s=e;e=i,i=s}for(var l=e;i>=l;l++)this.add({rowIndx:l,focus:!1})},n._addToData=function(t){var e=t.dataIndx,i=this.that.getRowData(t);i.pq_cellselect||(i.pq_cellselect={}),i.pq_cellselect[e]=!0},n.extendSelection=function(t){var e=this.that,i=this.getFirstSelection(),r=t.rowIndx,o=t.colIndx,n=e.options.selectionModel.mode,a=t.evt;if(null==i)return void e.setSelection({rowIndx:r,colIndx:o});var l=i.rowIndx,s=e.getColIndx({dataIndx:i.dataIndx}),d=l,h=r,c=s,u=o;l>r&&(d=r,h=l),"range"==n?(l>r&&(c=o,u=s),r==l&&s>o&&(c=o,u=s),this.selectRange({initRowIndx:d,initColIndx:c,finalRowIndx:h,finalColIndx:u,evt:a}),this.add({rowIndx:r,colIndx:o})):"block"==n&&(s>o&&(c=o,u=s),this.selectBlock({initRowIndx:d,initColIndx:c,finalRowIndx:h,finalColIndx:u,evt:a}),this.add({rowIndx:r,colIndx:o}))},n._removeFromData=function(t){var e=t.rowData;e&&e.pq_cellselect&&delete e.pq_cellselect[t.dataIndx]},n.removeAll=function(){this.refresh();var t=this.selection.slice(0);this.remove({cells:t}),this.lastSelection=null},a.removeAll=function(t){var e=this.that,i=t?t.page:!1;this.refresh();var r=this.selection.slice(0);if(i){for(var o=[],n=e.rowIndxOffset,a=e.data,l=a?a.length:0,s=0,d=r.length;d>s;s++){var h=r[s],c=h.rowIndx,u=c-n;if(u>=0){if(!(l>u))break;o.push(h)}}this.remove({rows:o})}else this.remove({rows:r}),this.lastSelection=null},n.isSelected=function(t){var e=this.that,i=e.getRowData(t),r=t.dataIndx,r=null==r?e.colModel[t.colIndx].dataIndx:r;return null==i?null:!(!i.pq_cellselect||!i.pq_cellselect[r])},n.refresh=function(){this.selection=[];var t=this.that,e=t.options.dataModel,i=t.options.pageModel,r=e.data,o=i.type,n="remote"==o,a=t.rowIndxOffset;if(r){for(var l=0,s=r.length;s>l;l++){var d=r[l],h=d.pq_cellselect;if(h){var c=n?l+a:l;for(var u in h)h[u]&&this.selection.push({rowIndx:c,rowData:d,dataIndx:u})}}this.isDirty=!1}},n.replace=function(t){var e=t.rowIndx,i=(t.colIndx,null==t.offset?this.that.getRowIndxOffset():t.offset),r=e-i;t.$td,t.evt;t.rowIndxPage=r,t.offset=i,this.removeAll({raiseEvent:!0}),this.add(t)},n.inView=function(t,e){var i=this.that,r=this.options,o=r.freezeRows,n=r.freezeCols;return(o>t||t>=i.init&&t<=i["final"])&&(n>e||e>=i.initH&&e<=i.finalH)},n._add=function(t){var e,i=this.that,r=t.rowIndx,o=t.rowIndxPage,n=t.rowData,a=i.rowIndxOffset,r=null==r?o+a:r,o=null==o?r-a:o,n=null==n?i.getRowData(t):n,l=t.colIndx,s=t.dataIndx,l=null==l?i.getColIndx({dataIndx:s}):l,d=i.colModel[l],s=null==s?d.dataIndx:s,h=t.evt,c=this.isSelected({rowData:n,dataIndx:s});if(null==c)return!1;var u=this.inView(o,l);if(c===!1){if(u){var f=i.getCell({rowIndxPage:o,colIndx:l});f&&f.addClass("pq-cell-select ui-state-highlight")}this._addToData({rowData:n,dataIndx:s}),t.trigger!==!1&&i._trigger("cellSelect",h,{rowIndx:r,rowIndxPage:o,colIndx:l,dataIndx:s,column:d,rowData:n}),e=!0}return this.lastSelection={rowIndx:r,dataIndx:s,rowData:n},t.focus!==!1&&u&&(f&&f.length||(f=i.getCell({rowIndxPage:o,dataIndx:s})),f&&f.length&&(f.attr("tabindex","0"),f.focus(),i._fixTableViewPort(),this.focusSelection={rowData:n,rowIndx:r,dataIndx:s})),t.setFirst&&(this.firstSelection={rowIndx:r,rowData:n,dataIndx:s}),e?{rowIndx:r,rowData:n,dataIndx:s,colIndx:l,column:d}:void 0},a.inView=function(t){var e=this.that,i=this.options,r=i.freezeRows;return r>t||t>=e.init&&t<=e["final"]},a._add=function(e){var i,r=this.that,o=e.rowIndx,n=e.rowIndxPage,a=r.rowIndxOffset,o=null==o?n+a:o,n=null==n?o-a:n,l=null==l?r.getRowData(e):l,s=e.$tr,d=e.evt,h=this.isSelected({rowData:l});if(e.rowIndxPage=n,null==h)return!1;var c=this.inView(n);if(h===!1){if(c)var u=this._boundRow(e),s=u;l.pq_rowselect=!0,e.trigger!==!1&&r._trigger("rowSelect",d,{rowIndx:o,rowIndxPage:n,rowData:l,$tr:s}),i=!0}return this.lastSelection={rowIndx:o,rowData:l},e.focus!==!1&&c&&(s&&s.length||(s=r.getRow({rowIndxPage:n})),s&&(s=t(s[0]),s.attr("tabindex","0"),s.focus(),r._fixTableViewPort(),this.focusSelection={rowData:l,rowIndx:o})),e.setFirst&&(this.firstSelection={rowIndx:o,rowData:l}),i?{rowIndx:o,rowData:l}:void 0},n.add=function(t){var e=this.that,i=t.evt,r=t.cells,o=[];if(r&&"function"==typeof r.push){for(var n=0,a=r.length;a>n;n++){var l=r[n];l.trigger=!1;var s=this._add(l);s&&o.push(s)}o.length&&e._trigger("cellSelect",i,{cells:o})}else this._add(t)},a.add=function(t){var e=this.that,i=t.evt,r=t.rows,o=[];if(r&&"function"==typeof r.push){for(var n=0,a=r.length;a>n;n++){var l=r[n];l.trigger=!1;var s=this._add(l);s&&o.push(s)}o.length&&e._trigger("rowSelect",i,{rows:o})}else this._add(t)},n._remove=function(t){var e=this.that,i=t.rowIndx,r=t.rowIndxPage,o=e.rowIndxOffset,i=null==i?r+o:i,r=null==r?i-o:r,n=null==n?e.getRowData(t):n,a=t.colIndx,l=t.dataIndx,a=null==a?e.getColIndx({dataIndx:l}):a,s=e.colModel[a],l=null==l?s.dataIndx:l,d=t.evt,h=this.isSelected({rowData:n,dataIndx:l});if(h){if(this.inView(r,a)){var c=e.getCell({rowIndxPage:r,colIndx:a});c&&(c.removeClass("pq-cell-select ui-state-highlight"),c.removeAttr("tabindex"))}return this._removeFromData({rowData:n,dataIndx:l}),t.trigger!==!1&&e._trigger("cellUnSelect",d,{rowIndx:i,colIndx:a,dataIndx:l,rowData:n}),{rowIndx:i,rowData:n,dataIndx:l,colIndx:a,column:s}}},a._remove=function(t){var e=this.that,i=t.rowIndx,r=t.rowIndxPage,o=e.rowIndxOffset,i=null==i?r+o:i,r=null==r?i-o:r,n=null==n?e.getRowData(t):n,a=t.$tr,l=t.evt,s=this.isSelected({rowData:n});if(s){if(this.inView(r)){var a=e.getRow({rowIndxPage:r});a&&(a.removeClass("pq-row-select ui-state-highlight"),a.removeAttr("tabindex"))}return n.pq_rowselect=!1,t.trigger!==!1&&e._trigger("rowUnSelect",l,{rowIndx:i,rowData:n,$tr:a}),{rowIndx:i,rowData:n}}},n.remove=function(t){var e=t.cells;if(e&&"function"==typeof e.push){for(var i=[],r=0,o=e.length;o>r;r++){var n=e[r];n.trigger=!1;var a=this._remove(n);a&&i.push(a)}i.length&&this.that._trigger("cellUnSelect",t.evt,{cells:i})}else this._remove(t)},a.remove=function(t){var e=t.rows;if(e&&"function"==typeof e.push){for(var i=[],r=0,o=e.length;o>r;r++){var n=e[r];n.trigger=!1;var a=this._remove(n);a&&i.push(a)}i.length&&this.that._trigger("rowUnSelect",t.evt,{rows:i})}else this._remove(t)},n.indexOf=function(t){this.refresh();var e=t.rowIndx,i=this.that,r=null==t.dataIndx?i.colModel[t.colIndx].dataIndx:t.dataIndx;t.dataIndx=r;for(var o=this.selection,n=0;n<o.length;n++){var a=o[n];if(a.rowIndx==e&&a.dataIndx==r)return n}return-1},n.selectAll=function(t){var e=this.that,i=!(!t||!t.all),r=i?this.options.dataModel.data:e.data,o=e.rowIndxOffset,n=e.colModel,a=n.length,l=[],s=function(t,e){for(var i=0;a>i;i++){var r=n[i];if(!r.hidden){var o={rowIndx:e,rowData:t,colIndx:i,dataIndx:r.dataIndx,focus:!1};l.push(o)}}};if(r){for(var d=0,h=r.length;h>d;d++)var c=r[d];if(i)for(var u=this.options.pageModel.type,f="remote"==u,d=0,h=r.length;h>d;d++){var c=r[d],p=d;f&&(p=d+o),s(c,p)}else for(var d=0,h=r.length;h>d;d++){var c=r[d],g=d,p=g+o;s(c,p)}this.add({cells:l})}},a.selectAll=function(t){var e=this.that,i=!(!t||!t.all),r=i?this.options.dataModel.data:e.data,o=[];if(r){if(i)for(var n=this.options.pageModel.type,a="remote"==n,l=0,s=r.length;s>l;l++){var d={rowData:r[l],focus:!1};a?d.rowIndxPage=l:d.rowIndx=l,o.push(d)}else for(var l=0,s=r.length;s>l;l++){var h=r[l];o.push({rowIndxPage:l,rowData:h,focus:!1})}this.add({rows:o})}},n.selectRange=function(t){for(var e=this.that,i=t.initRowIndx,r=t.initColIndx,o=t.finalRowIndx,n=t.finalColIndx,a=this.getSelection(),l=a.slice(0),s=0;s<l.length;s++){var d=l[s],h=d.rowIndx,c=d.dataIndx,u=e.getColIndx({dataIndx:c});i>h||h>o?this.remove({rowIndx:h,colIndx:u,dataIndx:c}):h==i&&r>u?this.remove({rowIndx:h,colIndx:u,dataIndx:c}):h==o&&u>n&&this.remove({rowIndx:h,colIndx:u,dataIndx:c})}for(var u=0;u<e.colModel.length;u++){var f=e.colModel[u];if(!f.hidden){var c=f.dataIndx,h=i;do{if(h==i&&r>u);else{if(h==o&&u>n)break;this.add({rowIndx:h,colIndx:u,dataIndx:c,focus:!1})}h++}while(o>=h)}}},n.selectBlock=function(t){for(var e=this.that,i=t.initRowIndx,r=t.initColIndx,o=t.finalRowIndx,n=t.finalColIndx,a=this.getSelection(),l=a.slice(0),s=0;s<l.length;s++){var d=l[s],h=d.rowIndx,c=d.dataIndx,u=e.getColIndx({dataIndx:c});r>u||u>n?this.remove({rowIndx:h,dataIndx:c,colIndx:u}):(i>h||h>o)&&this.remove({rowIndx:h,dataIndx:c,colIndx:u})}for(var f=[],p=e.colModel,u=r;n>=u;u++){var g=p[u],c=g.dataIndx;if(!g.hidden){var h=i;do f.push({rowIndx:h,colIndx:u,dataIndx:c,focus:!1}),h++;while(o>=h);this.add({cells:f})}}}}(jQuery),function(t){var e=t.paramquery.cCheckBoxColumn=function(t,e){var i=this;this.that=t,this.options=t.options,this.type="checkBoxSelection",this.cbDataIndx=e;var r=t.widgetEventPrefix.toLowerCase();t.element.on(r+"dataavailable",function(t,e){return i.belongs(t)?i._onDataAvailable(t,e):void 0}),t.element.on(r+"cellclick",function(t,e){return i.belongs(t)?i.cellClick(t,e):void 0}),t.element.on(r+"rowselect",function(t,e){return i.belongs(t)?i.rowSelect(t,e):void 0}),t.element.on(r+"rowunselect",function(t,e){return i.belongs(t)?i.rowUnSelect(t,e):void 0}),t.element.on(r+"cellkeydown",function(t,e){return i.belongs(t)?i.cellKeyDown(t,e):void 0}),t.element.on(r+"refreshheader",function(t,e){return i.belongs(t)?i.refreshHeader(t,e):void 0})},i=e.prototype=new t.paramquery.cClass;i.hasHeaderChkBox=function(){var t=this.options.selectionModel;return t.cbHeader!==!1},i.setValCBox=function(){if(this.hasHeaderChkBox()){for(var t=this.that,e=this.options,i=e.selectionModel.cbAll,r=i?e.dataModel.data:t.data,o=null,n=0,a=0,l=0,s=r.length;s>l;l++){
var d=r[l];d.pq_rowselect?n++:a++}n==s?o=!0:a==s&&(o=!1),this.$inp.pqval({val:o})}},i.refreshHeader=function(e,i){if(this.hasHeaderChkBox()){var r=this.that,o=r.data;if(o){var n=this,a=r.getCellHeader({dataIndx:this.cbDataIndx});a.html("<input type='checkbox'/>");this.$inp=a.find("input").click(function(e){t(this).is(":checked")?n.selectAllRows():n.unSelectAllRows(),e.stopPropagation()});this.setValCBox()}}},i.selectAllRows=function(){var t=this.that,e=this.options.selectionModel.cbAll;t.iRows.selectAll({all:e})},i.unSelectAllRows=function(){var t=this.that,e=this.options.selectionModel.cbAll;e?t.iRows.removeAll():t.iRows.removeAll({page:!0})},i._onDataAvailable=function(){var t=(this.that,this.options.dataModel.data),e=this._findSelectionIndx();if(null!=e&&t)for(var i=0,r=t.length;r>i;i++){var o=t[i];o[e]&&(o.pq_rowselect=!0)}},i._findSelectionIndx=function(){return this.cbDataIndx?this.cbDataIndx:void 0},i.cellClick=function(t,e){var i=this.that,r=e.rowIndx,o=e.rowData,n=e.column,a=this.type;if(n&&n.type===a){var l=n.dataIndx;return o[l]?i.iRows.remove({rowIndx:r}):i.iRows.add({rowIndx:r}),t.stopPropagation(),!1}},i.rowSelect=function(t,e){var i=this.that,r=e.rows,o=e.rowData,n=this._findSelectionIndx();if(r)for(var a=0,l=r.length;l>a;a++){var s=r[a],d=s.rowIndx,o=s.rowData;o[n]=!0,i.refreshCell({rowIndx:d,dataIndx:n})}else o&&(o[n]=!0,d=e.rowIndx,i.refreshCell({rowIndx:d,dataIndx:n}));this.setValCBox()},i.rowUnSelect=function(t,e){var i=this.that,r=e.rows,o=e.rowData,n=this._findSelectionIndx();if(r)for(var a=0,l=r.length;l>a;a++){var s=r[a],d=s.rowIndx,o=s.rowData;o[n]=!1,i.refreshCell({rowIndx:d,dataIndx:n})}else o&&(o[n]=!1,d=e.rowIndx,i.refreshCell({rowIndx:d,dataIndx:n}));this.setValCBox()},i.cellKeyDown=function(t,e){var i=this.that,r=e.rowIndx,o=e.column,n=n,a=this.type;if(o&&o.type===a){var l=o.dataIndx,r=e.rowIndx;if(13==t.keyCode||32==t.keyCode)return n[l]?i.selection({type:"row",method:"remove",rowIndx:r}):i.selection({type:"row",method:"add",rowIndx:r}),t.stopPropagation(),t.preventDefault(),!1}}}(jQuery),function(t){var e=function(t,e){this.that=t,this.$ae=e},i=e.prototype;i.createClipBoard=function(){var e=this.$ae,i=t("textarea#pq-grid-excel");0==i.length&&(i=t("<textarea id='pq-grid-excel' />").appendTo(document.body));var r=e.offset(),o=r.left,n=r.top;i.css({position:"absolute",left:o,top:n,display:"",height:1,width:1,borderWidth:0}),i.focus()},i.destroyClipBoard=function(){var e=t("textarea#pq-grid-excel");if(e.length){var i=document.activeElement;i==e[0]&&this.$ae.focus(),e.css("display","none")}},i.clearClipBoard=function(){var e=t("textarea#pq-grid-excel");e.val("")},i.copy=function(){var e=t("textarea#pq-grid-excel"),i=this.that,r=i.colModel,o=r.length,n=(i.options.selectionModel.type,[]),a=[];n=i.iRows.getSelection();for(var l=0,s=n.length;s>l;l++){for(var d=n[l],h=i.getRowData(d),c=[],u=0;o>u;u++){var f=r[u];f.hidden||c.push(h[f.dataIndx])}var p=c.join("	");a.push(p)}n=i.iCells.getSelection();for(var h=null,g=null,v=null,c=[],l=0,s=n.length;s>l;l++){var d=n[l],g=d.rowIndx;if(g!=v){for(var h=i.getRowData(d),u=0;o>u;u++){var f=r[u];if(!f.hidden){var w=f.dataIndx;i.iCells.isSelected({rowData:h,dataIndx:w})&&c.push(h[w])}}var p=c.join("	");c=[],a.push(p),v=g}}e.val(a.join("\n")),e.select()};var r=null;t(window).unbind(".pqExcel").bind("keydown.pqExcel",function(i){if(i.ctrlKey){var o=t(document.activeElement);if(!o.hasClass("pq-grid-row")&&!o.hasClass("pq-grid-cell")&&!o.is("textarea#pq-grid-excel"))return;var n=o.closest(".pq-grid");if(r||o.length&&n.length){if(!r){try{var a=n.pqGrid("getThis").that}catch(l){return!0}r=new e(a,o),r.createClipBoard()}if("67"==i.keyCode||"99"==i.keyCode)r.copy();else{var s=t("textarea#pq-grid-excel");if(s.length){var d=document.activeElement;d==s[0]&&r.that._onKeyPressDown(i)}}}}}).bind("keyup.pqExcel",function(t){r&&!t.ctrlKey&&17==t.keyCode&&(r.destroyClipBoard(),r=null)})}(jQuery);
//# sourceMappingURL=pqgrid.dev.min.js.map