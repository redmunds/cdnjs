d3.parcoords=function(n){function e(n,e,t){d3.keys(e).forEach(function(r){n[r]=function(i){if(!arguments.length)return e[r];var s=e[r];return e[r]=i,S[r].call(v,{value:i,previous:s}),t[r].call(v,{value:i,previous:s}),n}})}function t(n,e){for(key in e)n[key]=e[key];return n}function r(n){var e=d3.map(),t=d3.map();return m.data.forEach(function(e){var r=k[n](e[n]);t.has(r)||t.set(r,0);var i=t.get(r);t.set(r,i+1)}),m.data.forEach(function(r){m.dimensions.map(function(i,s){var a=k[n](r[n]);if(!e.has(a)){var o=d3.map();e.set(a,o)}e.get(a).has(i)||e.get(a).set(i,0);var u=e.get(a).get(i);u+=k[i](r[i])/t.get(a),e.get(a).set(i,u)})}),e}function i(n){for(var e=[],t=m.dimensions,r=t.length,i=.5,s=0;s<r;++s){var a=g(t[s]),o=k[t[s]](n[t[s]]);if(e.push($V([a,o])),s<r-1){var u=a+i*(g(t[s+1])-a),d=o+i*(k[t[s+1]](n[t[s+1]])-o);if(null!==m.bundleDimension){var l=m.clusterCentroids.get(k[m.bundleDimension](n[m.bundleDimension])).get(t[s]),c=m.clusterCentroids.get(k[m.bundleDimension](n[m.bundleDimension])).get(t[s+1]),h=.5*(l+c);d=h+(1-m.bundlingStrength)*(d-h)}e.push($V([u,d]))}}return e}function s(n){var e=n.length,t=m.smoothness,r=[];r.push(n[0]),r.push($V([n[0].e(1)+2*t*(n[1].e(1)-n[0].e(1)),n[0].e(2)]));for(var i=1;i<e-1;++i){var s=n[i],a=n[i-1],o=n[i+1],u=a.subtract(o);r.push(s.add(u.x(t))),r.push(s),r.push(s.subtract(u.x(t)))}return r.push($V([n[e-1].e(1)+2*t*(n[e-2].e(1)-n[e-1].e(1)),n[e-1].e(2)])),r.push(n[e-1]),r}function a(n,e){var t=i(n),r=s(t);e.moveTo(r[0].e(1),r[0].e(2));for(var a=1;a<r.length;a+=3){if(m.showControlPoints)for(var o=0;o<3;o++)e.fillRect(r[a+o].e(1),r[a+o].e(2),2,2);e.bezierCurveTo(r[a].e(1),r[a].e(2),r[a+1].e(1),r[a+1].e(2),r[a+2].e(1),r[a+2].e(2))}}function o(n,e){e.strokeStyle=d3.functor(m.color)(n),e.beginPath(),null===m.bundleDimension||0===m.bundlingStrength&&0==m.smoothness?d(n,e):a(n,e),e.stroke()}function u(n,e){e.clearRect(-1,-1,x()+2,y()+2),e.beginPath(),n.forEach(function(n){null===m.bundleDimension||0===m.bundlingStrength&&0==m.smoothness?d(n,e):a(n,e)}),e.stroke()}function d(n,e){m.dimensions.map(function(t,r){0==r?e.moveTo(g(t),k[t](n[t])):e.lineTo(g(t),k[t](n[t]))})}function l(n){return o(n,T.foreground)}function c(n){return o(n,T.highlight)}function h(n){return!k[n].brush.empty()}function f(){var n=m.dimensions.filter(h),e=n.map(function(n){return k[n].brush.extent()}),t={date:function(n,t,r){return e[r][0]<=n[t]&&n[t]<=e[r][1]},number:function(n,t,r){return e[r][0]<=n[t]&&n[t]<=e[r][1]},string:function(n,t,r){return e[r][0]<=k[t](n[t])&&k[t](n[t])<=e[r][1]}};return m.data.filter(function(e){return n.every(function(n,r){return t[m.types[n]](e,n,r)})})}function g(n){var e=D[n];return null==e?A(n):e}var m={data:[],dimensions:[],dimensionTitles:{},types:{},brushed:!1,mode:"default",rate:20,width:600,height:300,margin:{top:24,right:0,bottom:12,left:0},color:"#069",composite:"source-over",alpha:.7,bundlingStrength:.5,bundleDimension:null,smoothness:.25,showControlPoints:!1,hideAxis:[]};t(m,n);var b,v=function(n){return n=v.selection=d3.select(n),m.width=n[0][0].clientWidth,m.height=n[0][0].clientHeight,["shadows","marks","foreground","highlight"].forEach(function(e){C[e]=n.append("canvas").attr("class",e)[0][0],T[e]=C[e].getContext("2d")}),v.svg=n.append("svg").attr("width",m.width).attr("height",m.height).append("svg:g").attr("transform","translate("+m.margin.left+","+m.margin.top+")"),v},p=d3.dispatch.apply(this,["render","resize","highlight","brush","brushend"].concat(d3.keys(m))),x=function(){return m.width-m.margin.right-m.margin.left},y=function(){return m.height-m.margin.top-m.margin.bottom},w={brushable:!1,reorderable:!1,axes:!1,interactive:!1,shadows:!1,debug:!1},A=d3.scale.ordinal(),k={},D={},E=(d3.svg.line(),d3.svg.axis().orient("left").ticks(5)),T={},C={},S=d3.dispatch.apply(this,d3.keys(m)).on("composite",function(n){T.foreground.globalCompositeOperation=n.value}).on("alpha",function(n){T.foreground.globalAlpha=n.value}).on("width",function(n){v.resize()}).on("height",function(n){v.resize()}).on("margin",function(n){v.resize()}).on("rate",function(n){z.rate(n.value)}).on("data",function(n){w.shadows&&u(m.data,T.shadows)}).on("dimensions",function(n){A.domain(m.dimensions),w.interactive&&v.render().updateAxes()}).on("bundleDimension",function(n){m.dimensions.length||v.detectDimensions(),m.dimensions[0]in k||v.autoscale(),"number"==typeof n.value?n.value<m.dimensions.length?m.bundleDimension=m.dimensions[n.value]:n.value<m.hideAxis.length&&(m.bundleDimension=m.hideAxis[n.value]):m.bundleDimension=n.value,m.clusterCentroids=r(m.bundleDimension)}).on("hideAxis",function(n){m.dimensions.length||v.detectDimensions(),v.dimensions(_.without(m.dimensions,n.value))});v.state=m,v.flags=w,e(v,m,p),d3.rebind(v,p,"on"),d3.rebind(v,E,"ticks","orient","tickValues","tickSubdivide","tickSize","tickPadding","tickFormat"),v.autoscale=function(){var n={date:function(n){return d3.time.scale().domain(d3.extent(m.data,function(e){return e[n]?e[n].getTime():null})).range([y()+1,1])},number:function(n){return d3.scale.linear().domain(d3.extent(m.data,function(e){return+e[n]})).range([y()+1,1])},string:function(n){return d3.scale.ordinal().domain(m.data.map(function(e){return e[n]})).rangePoints([y()+1,1])}};return m.dimensions.forEach(function(e){k[e]=n[m.types[e]](e)}),m.hideAxis.forEach(function(e){k[e]=n[m.types[e]](e)}),v.dimensions(v.dimensions().filter(function(n,e){var t=k[n].domain().length;return"string"!=m.types[n]||!(t>60||t<2)})),A.rangePoints([0,x()],1),v.selection.selectAll("canvas").style("margin-top",m.margin.top+"px").style("margin-left",m.margin.left+"px").attr("width",x()+2).attr("height",y()+2),T.foreground.strokeStyle=m.color,T.foreground.lineWidth=1.4,T.foreground.globalCompositeOperation=m.composite,T.foreground.globalAlpha=m.alpha,T.highlight.lineWidth=3,T.shadows.strokeStyle="#dadada",this},v.scale=function(n,e){return k[n].domain(e),this},v.flip=function(n){return k[n].domain(k[n].domain().reverse()),this},v.commonScale=function(n,e){var t=e||"number";"undefined"==typeof n&&(n=!0);var r=m.dimensions.concat(m.hideAxis).filter(function(n){return m.types[n]==t});if(n){var i=d3.extent(r.map(function(n,e){return k[n].domain()}).reduce(function(n,e){return n.concat(e)}));r.forEach(function(n){k[n].domain(i)})}else r.forEach(function(n){k[n].domain(d3.extent(m.data,function(e){return+e[n]}))});return null!==m.bundleDimension&&v.bundleDimension(m.bundleDimension),this},v.detectDimensions=function(){return v.types(v.detectDimensionTypes(m.data)),v.dimensions(d3.keys(v.types())),this},v.toType=function(n){return{}.toString.call(n).match(/\s([a-zA-Z]+)/)[1].toLowerCase()},v.toTypeCoerceNumbers=function(n){return parseFloat(n)==n&&null!=n?"number":v.toType(n)},v.detectDimensionTypes=function(n){var e={};return d3.keys(n[0]).forEach(function(t){e[t]=v.toTypeCoerceNumbers(n[0][t])}),e},v.render=function(){return m.dimensions.length||v.detectDimensions(),m.dimensions[0]in k||v.autoscale(),v.render[m.mode](),p.render.call(this),this},v.render.default=function(){v.clear("foreground"),m.brushed?m.brushed.forEach(l):m.data.forEach(l)};var z=d3.renderQueue(l).rate(50).clear(function(){v.clear("foreground")});return v.render.queue=function(){z(m.brushed?m.brushed:m.data)},v.shadows=function(){return w.shadows=!0,m.data.length>0&&u(m.data,T.shadows),this},v.axisDots=function(){var n=v.ctx.marks;return n.globalAlpha=d3.min([1/Math.pow(data.length,.5),1]),m.data.forEach(function(e){m.dimensions.map(function(t,r){n.fillRect(g(t)-.75,k[t](e[t])-.75,1.5,1.5)})}),this},v.clear=function(n){return T[n].clearRect(0,0,x()+2,y()+2),this},v.createAxes=function(){return b&&v.removeAxes(),b=v.svg.selectAll(".dimension").data(m.dimensions,function(n){return n}).enter().append("svg:g").attr("class","dimension").attr("transform",function(n){return"translate("+A(n)+")"}),b.append("svg:g").attr("class","axis").attr("transform","translate(0,0)").each(function(n){d3.select(this).call(E.scale(k[n]))}).append("svg:text").attr({"text-anchor":"middle",y:0,transform:"translate(0,-12)",x:0,class:"label"}).text(function(n){return n in m.dimensionTitles?m.dimensionTitles[n]:n}),w.axes=!0,this},v.removeAxes=function(){return b.remove(),this},v.updateAxes=function(){var n=v.svg.selectAll(".dimension").data(m.dimensions,function(n){return n});return n.enter().append("svg:g").attr("class","dimension").attr("transform",function(n){return"translate("+g(n)+")"}).style("opacity",0).append("svg:g").attr("class","axis").attr("transform","translate(0,0)").each(function(n){d3.select(this).call(E.scale(k[n]))}).append("svg:text").attr({"text-anchor":"middle",y:0,transform:"translate(0,-12)",x:0,class:"label"}).text(String),n.exit().remove(),b=v.svg.selectAll(".dimension"),b.transition().duration(1100).attr("transform",function(n){return"translate("+g(n)+")"}).style("opacity",1),v.svg.selectAll(".axis").transition().duration(1100).each(function(n){d3.select(this).call(E.scale(k[n]))}),w.shadows&&u(m.data,T.shadows),w.brushable&&v.brushable(),w.reorderable&&v.reorderable(),this},v.brushable=function(){return b||v.createAxes(),b.append("svg:g").attr("class","brush").each(function(n){d3.select(this).call(k[n].brush=d3.svg.brush().y(k[n]).on("brushstart",function(){d3.event.sourceEvent.stopPropagation()}).on("brush",v.brush).on("brushend",function(){p.brushend.call(v,m.brushed)}))}).selectAll("rect").style("visibility",null).attr("x",-15).attr("width",30),w.brushable=!0,this},v.brushExtents=function(){var n={};return m.dimensions.forEach(function(e){var t=k[e].brush;if(!t.empty()){var r=t.extent();r.sort(d3.ascending),n[e]=r}}),n},v.reorderable=function(){return b||v.createAxes(),b.style("cursor","move").call(d3.behavior.drag().on("dragstart",function(n){D[n]=this.__origin__=A(n)}).on("drag",function(n){D[n]=Math.min(x(),Math.max(0,this.__origin__+=d3.event.dx)),m.dimensions.sort(function(n,e){return g(n)-g(e)}),A.domain(m.dimensions),v.render(),b.attr("transform",function(n){return"translate("+g(n)+")"})}).on("dragend",function(n){delete this.__origin__,delete D[n],d3.select(this).transition().attr("transform","translate("+A(n)+")"),v.render()})),w.reorderable=!0,this},v.adjacent_pairs=function(n){for(var e=[],t=0;t<n.length-1;t++)e.push([n[t],n[t+1]]);return e},v.interactive=function(){return w.interactive=!0,this},v.brush=function(){m.brushed=f(),p.brush.call(v,m.brushed),v.render()},v.xscale=A,v.yscale=k,v.ctx=T,v.canvas=C,v.g=function(){return b},v.brushReset=function(n){return m.brushed=!1,b&&(b.selectAll(".brush").each(function(n){d3.select(this).call(k[n].brush.clear())}),v.render()),this},v.resize=function(){return v.selection.select("svg").attr("width",m.width).attr("height",m.height),v.svg.attr("transform","translate("+m.margin.left+","+m.margin.top+")"),w.brushable&&v.brushReset(),v.autoscale(),b&&v.createAxes(),w.shadows&&u(m.data,T.shadows),w.brushable&&v.brushable(),w.reorderable&&v.reorderable(),p.resize.call(this,{width:m.width,height:m.height,margin:m.margin}),this},v.highlight=function(n){return v.clear("highlight"),d3.select(C.foreground).classed("faded",!0),n.forEach(c),p.highlight.call(this,n),this},v.unhighlight=function(n){return v.clear("highlight"),d3.select(C.foreground).classed("faded",!1),this},v.intersection=function(n,e,t,r){return{x:((n.x*e.y-n.y*e.x)*(t.x-r.x)-(n.x-e.x)*(t.x*r.y-t.y*r.x))/((n.x-e.x)*(t.y-r.y)-(n.y-e.y)*(t.x-r.x)),y:((n.x*e.y-n.y*e.x)*(t.y-r.y)-(n.y-e.y)*(t.x*r.y-t.y*r.x))/((n.x-e.x)*(t.y-r.y)-(n.y-e.y)*(t.x-r.x))}},v.toString=function(){return"Parallel Coordinates: "+m.dimensions.length+" dimensions ("+d3.keys(m.data[0]).length+" total) , "+m.data.length+" rows"},v.version="0.3.1",v},d3.renderQueue=function(n){var e=[],t=10,r=function(){},i=0,s=function(n){n&&s.data(n),s.invalidate(),r(),s.render()};return s.render=function(){function r(){if(!a)return!0;if(i>e.length)return!0;var r=e.slice(i,i+t);i+=t,r.map(n)}i=0;var a=!0;s.invalidate=function(){a=!1},d3.timer(r)},s.data=function(n){return s.invalidate(),e=n.slice(0),s},s.rate=function(n){return arguments.length?(t=n,s):t},s.remaining=function(){return e.length-i},s.clear=function(n){return arguments.length?(r=n,s):(r(),s)},s.invalidate=function(){},s};
//# sourceMappingURL=d3.parcoords.min.js.map