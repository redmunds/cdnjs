d3.parcoords=function(e){function n(e,n,t){d3.keys(n).forEach(function(r){e[r]=function(i){if(!arguments.length)return n[r];var s=n[r];return n[r]=i,O[r].call(b,{value:i,previous:s}),t[r].call(b,{value:i,previous:s}),e}})}function t(e,n){for(key in n)e[key]=n[key];return e}function r(e,n){return e.filter(function(e){return n.indexOf(e)===-1})}function i(e){var n=d3.map(),t=d3.map();return v.data.forEach(function(n){var r=k[e](n[e]);t.has(r)||t.set(r,0);var i=t.get(r);t.set(r,i+1)}),v.data.forEach(function(r){v.dimensions.map(function(i,s){var a=k[e](r[e]);if(!n.has(a)){var o=d3.map();n.set(a,o)}n.get(a).has(i)||n.get(a).set(i,0);var u=n.get(a).get(i);u+=k[i](r[i])/t.get(a),n.get(a).set(i,u)})}),n}function s(e){for(var n=[],t=v.dimensions,r=t.length,i=.5,s=0;s<r;++s){var a=g(t[s]),o=k[t[s]](e[t[s]]);if(n.push($V([a,o])),s<r-1){var u=a+i*(g(t[s+1])-a),d=o+i*(k[t[s+1]](e[t[s+1]])-o);if(null!==v.bundleDimension){var c=v.clusterCentroids.get(k[v.bundleDimension](e[v.bundleDimension])).get(t[s]),l=v.clusterCentroids.get(k[v.bundleDimension](e[v.bundleDimension])).get(t[s+1]),h=.5*(c+l);d=h+(1-v.bundlingStrength)*(d-h)}n.push($V([u,d]))}}return n}function a(e){var n=e.length,t=v.smoothness,r=[];r.push(e[0]),r.push($V([e[0].e(1)+2*t*(e[1].e(1)-e[0].e(1)),e[0].e(2)]));for(var i=1;i<n-1;++i){var s=e[i],a=e[i-1],o=e[i+1],u=a.subtract(o);r.push(s.add(u.x(t))),r.push(s),r.push(s.subtract(u.x(t)))}return r.push($V([e[n-1].e(1)+2*t*(e[n-2].e(1)-e[n-1].e(1)),e[n-1].e(2)])),r.push(e[n-1]),r}function o(e,n){var t=s(e),r=a(t);n.moveTo(r[0].e(1),r[0].e(2));for(var i=1;i<r.length;i+=3){if(v.showControlPoints)for(var o=0;o<3;o++)n.fillRect(r[i+o].e(1),r[i+o].e(2),2,2);n.bezierCurveTo(r[i].e(1),r[i].e(2),r[i+1].e(1),r[i+1].e(2),r[i+2].e(1),r[i+2].e(2))}}function u(e,n,t){t.strokeStyle=d3.functor(v.color)(e,n),t.beginPath(),null===v.bundleDimension||0===v.bundlingStrength&&0==v.smoothness?c(e,t):o(e,t),t.stroke()}function d(e,n){n.clearRect(-1,-1,y()+2,w()+2),n.beginPath(),e.forEach(function(e){null===v.bundleDimension||0===v.bundlingStrength&&0==v.smoothness?c(e,n):o(e,n)}),n.stroke()}function c(e,n){v.dimensions.map(function(t,r){0==r?n.moveTo(g(t),k[t](e[t])):n.lineTo(g(t),k[t](e[t]))})}function l(e,n){return u(e,n,P.foreground)}function h(e,n){return u(e,n,P.highlight)}function f(e){v.brushed=e,x.brush.call(b,v.brushed),b.render()}function m(e){if(!arguments.length)return S.predicate;if(e=String(e).toUpperCase(),"AND"!==e&&"OR"!==e)throw"Invalid predicate "+e;return S.predicate=e,v.brushed=S.currentMode().selected(),b.render(),b}function g(e){var n=E[e];return null==n?D(e):n}var v={data:[],dimensions:[],dimensionTitles:{},types:{},brushed:!1,mode:"default",rate:20,width:600,height:300,margin:{top:24,right:0,bottom:12,left:0},color:"#069",composite:"source-over",alpha:.7,bundlingStrength:.5,bundleDimension:null,smoothness:.25,showControlPoints:!1,hideAxis:[]};t(v,e);var p,b=function(e){return e=b.selection=d3.select(e),v.width=e[0][0].clientWidth,v.height=e[0][0].clientHeight,["shadows","marks","foreground","highlight"].forEach(function(n){M[n]=e.append("canvas").attr("class",n)[0][0],P[n]=M[n].getContext("2d")}),b.svg=e.append("svg").attr("width",v.width).attr("height",v.height).append("svg:g").attr("transform","translate("+v.margin.left+","+v.margin.top+")"),b},x=d3.dispatch.apply(this,["render","resize","highlight","brush","brushend","axesreorder"].concat(d3.keys(v))),y=function(){return v.width-v.margin.right-v.margin.left},w=function(){return v.height-v.margin.top-v.margin.bottom},A={brushable:!1,reorderable:!1,axes:!1,interactive:!1,shadows:!1,debug:!1},D=d3.scale.ordinal(),k={},E={},N=(d3.svg.line(),d3.svg.axis().orient("left").ticks(5)),P={},M={},O=d3.dispatch.apply(this,d3.keys(v)).on("composite",function(e){P.foreground.globalCompositeOperation=e.value}).on("alpha",function(e){P.foreground.globalAlpha=e.value}).on("width",function(e){b.resize()}).on("height",function(e){b.resize()}).on("margin",function(e){b.resize()}).on("rate",function(e){C.rate(e.value)}).on("data",function(e){A.shadows&&d(v.data,P.shadows)}).on("dimensions",function(e){D.domain(v.dimensions),A.interactive&&b.render().updateAxes()}).on("bundleDimension",function(e){v.dimensions.length||b.detectDimensions(),v.dimensions[0]in k||b.autoscale(),"number"==typeof e.value?e.value<v.dimensions.length?v.bundleDimension=v.dimensions[e.value]:e.value<v.hideAxis.length&&(v.bundleDimension=v.hideAxis[e.value]):v.bundleDimension=e.value,v.clusterCentroids=i(v.bundleDimension)}).on("hideAxis",function(e){v.dimensions.length||b.detectDimensions(),b.dimensions(r(v.dimensions,e.value))});b.state=v,b.flags=A,n(b,v,x),d3.rebind(b,x,"on"),d3.rebind(b,N,"ticks","orient","tickValues","tickSubdivide","tickSize","tickPadding","tickFormat"),b.autoscale=function(){var e={date:function(e){return d3.time.scale().domain(d3.extent(v.data,function(n){return n[e]?n[e].getTime():null})).range([w()+1,1])},number:function(e){return d3.scale.linear().domain(d3.extent(v.data,function(n){return+n[e]})).range([w()+1,1])},string:function(e){return d3.scale.ordinal().domain(v.data.map(function(n){return n[e]})).rangePoints([w()+1,1])}};return v.dimensions.forEach(function(n){k[n]=e[v.types[n]](n)}),v.hideAxis.forEach(function(n){k[n]=e[v.types[n]](n)}),b.dimensions(b.dimensions().filter(function(e,n){var t=k[e].domain().length;return"string"!=v.types[e]||!(t>60||t<2)})),D.rangePoints([0,y()],1),b.selection.selectAll("canvas").style("margin-top",v.margin.top+"px").style("margin-left",v.margin.left+"px").attr("width",y()+2).attr("height",w()+2),P.foreground.strokeStyle=v.color,P.foreground.lineWidth=1.4,P.foreground.globalCompositeOperation=v.composite,P.foreground.globalAlpha=v.alpha,P.highlight.lineWidth=3,P.shadows.strokeStyle="#dadada",this},b.scale=function(e,n){return k[e].domain(n),this},b.flip=function(e){return k[e].domain(k[e].domain().reverse()),this},b.commonScale=function(e,n){var t=n||"number";"undefined"==typeof e&&(e=!0);var r=v.dimensions.concat(v.hideAxis).filter(function(e){return v.types[e]==t});if(e){var i=d3.extent(r.map(function(e,n){return k[e].domain()}).reduce(function(e,n){return e.concat(n)}));r.forEach(function(e){k[e].domain(i)})}else r.forEach(function(e){k[e].domain(d3.extent(v.data,function(n){return+n[e]}))});return null!==v.bundleDimension&&b.bundleDimension(v.bundleDimension),this},b.detectDimensions=function(){return b.types(b.detectDimensionTypes(v.data)),b.dimensions(d3.keys(b.types())),this},b.toType=function(e){return{}.toString.call(e).match(/\s([a-zA-Z]+)/)[1].toLowerCase()},b.toTypeCoerceNumbers=function(e){return parseFloat(e)==e&&null!=e?"number":b.toType(e)},b.detectDimensionTypes=function(e){var n={};return d3.keys(e[0]).forEach(function(t){n[t]=b.toTypeCoerceNumbers(e[0][t])}),n},b.render=function(){return v.dimensions.length||b.detectDimensions(),v.dimensions[0]in k||b.autoscale(),b.render[v.mode](),x.render.call(this),this},b.render.default=function(){b.clear("foreground"),v.brushed?v.brushed.forEach(l):v.data.forEach(l)};var C=d3.renderQueue(l).rate(50).clear(function(){b.clear("foreground")});b.render.queue=function(){C(v.brushed?v.brushed:v.data)},b.shadows=function(){return A.shadows=!0,v.data.length>0&&d(v.data,P.shadows),this},b.axisDots=function(){var e=b.ctx.marks;return e.globalAlpha=d3.min([1/Math.pow(data.length,.5),1]),v.data.forEach(function(n){v.dimensions.map(function(t,r){e.fillRect(g(t)-.75,k[t](n[t])-.75,1.5,1.5)})}),this},b.clear=function(e){return P[e].clearRect(0,0,y()+2,w()+2),this},b.createAxes=function(){return p&&b.removeAxes(),p=b.svg.selectAll(".dimension").data(v.dimensions,function(e){return e}).enter().append("svg:g").attr("class","dimension").attr("transform",function(e){return"translate("+D(e)+")"}),p.append("svg:g").attr("class","axis").attr("transform","translate(0,0)").each(function(e){d3.select(this).call(N.scale(k[e]))}).append("svg:text").attr({"text-anchor":"middle",y:0,transform:"translate(0,-12)",x:0,class:"label"}).text(function(e){return e in v.dimensionTitles?v.dimensionTitles[e]:e}),A.axes=!0,this},b.removeAxes=function(){return p.remove(),this},b.updateAxes=function(){var e=b.svg.selectAll(".dimension").data(v.dimensions,function(e){return e});return e.enter().append("svg:g").attr("class","dimension").attr("transform",function(e){return"translate("+g(e)+")"}).style("opacity",0).append("svg:g").attr("class","axis").attr("transform","translate(0,0)").each(function(e){d3.select(this).call(N.scale(k[e]))}).append("svg:text").attr({"text-anchor":"middle",y:0,transform:"translate(0,-12)",x:0,class:"label"}).text(String),e.exit().remove(),p=b.svg.selectAll(".dimension"),p.transition().duration(1100).attr("transform",function(e){return"translate("+g(e)+")"}).style("opacity",1),b.svg.selectAll(".axis").transition().duration(1100).each(function(e){d3.select(this).call(N.scale(k[e]))}),A.shadows&&d(v.data,P.shadows),A.brushable&&b.brushable(),A.reorderable&&b.reorderable(),this},b.reorderable=function(){p||b.createAxes();var e;return p.style("cursor","move").call(d3.behavior.drag().on("dragstart",function(n){E[n]=this.__origin__=D(n),e=v.dimensions.slice()}).on("drag",function(e){E[e]=Math.min(y(),Math.max(0,this.__origin__+=d3.event.dx)),v.dimensions.sort(function(e,n){return g(e)-g(n)}),D.domain(v.dimensions),b.render(),p.attr("transform",function(e){return"translate("+g(e)+")"})}).on("dragend",function(n){var t=e.some(function(e,n){return e!==v.dimensions[n]});t&&x.axesreorder.call(b,v.dimensions),delete this.__origin__,delete E[n],d3.select(this).transition().attr("transform","translate("+D(n)+")"),b.render()})),A.reorderable=!0,this},b.adjacent_pairs=function(e){for(var n=[],t=0;t<e.length-1;t++)n.push([e[t],e[t+1]]);return n};var S={modes:{None:{install:function(e){},uninstall:function(e){},selected:function(){return[]}}},mode:"None",predicate:"AND",currentMode:function(){return this.modes[this.mode]}};return b.brushModes=function(){return Object.getOwnPropertyNames(S.modes)},b.brushMode=function(e){if(0===arguments.length)return S.mode;if(b.brushModes().indexOf(e)===-1)throw"pc.brushmode: Unsupported brush mode: "+e;return e!==S.mode&&("None"!==S.mode&&b.brushReset(),S.modes[S.mode].uninstall(b),S.mode=e,S.modes[S.mode].install(),"None"===e?delete b.brushPredicate:b.brushPredicate=m),b},function(){function e(e){return!a[e].empty()}function n(){var n=v.dimensions.filter(e),t=n.map(function(e){return a[e].extent()});if(0===n.length)return v.data;var r={date:function(e,n,r){return t[r][0]<=e[n]&&e[n]<=t[r][1]},number:function(e,n,r){return t[r][0]<=e[n]&&e[n]<=t[r][1]},string:function(e,n,r){return t[r][0]<=k[n](e[n])&&k[n](e[n])<=t[r][1]}};return v.data.filter(function(e){switch(S.predicate){case"AND":return n.every(function(n,t){return r[v.types[n]](e,n,t)});case"OR":return n.some(function(n,t){return r[v.types[n]](e,n,t)});default:throw"Unknown brush predicate "+v.brushPredicate}})}function t(){var e={};return v.dimensions.forEach(function(n){var t=a[n];if(!t.empty()){var r=t.extent();r.sort(d3.ascending),e[n]=r}}),e}function r(e){var t=d3.svg.brush();return t.y(k[e]).on("brushstart",function(){d3.event.sourceEvent.stopPropagation()}).on("brush",function(){f(n())}).on("brushend",function(){x.brushend.call(b,v.brushed)}),a[e]=t,t}function i(e){return v.brushed=!1,p&&(p.selectAll(".brush").each(function(e){d3.select(this).call(a[e].clear())}),b.render()),this}function s(){return p||b.createAxes(),p.append("svg:g").attr("class","brush").each(function(e){d3.select(this).call(r(e))}).selectAll("rect").style("visibility",null).attr("x",-15).attr("width",30),b.brushExtents=t,b.brushReset=i,b}var a={};S.modes["1D-axes"]={install:s,uninstall:function(){p.selectAll(".brush").remove(),a={},delete b.brushExtents,delete b.brushReset},selected:n}}(),function(){function e(e){var n=b.selection.select("svg").select("g#strums"),t=e.dims.i,r=n.selectAll("line#strum-"+t).data([e]);r.enter().append("line").attr("id","strum-"+t).attr("class","strum"),r.attr("x1",function(e){return e.p1[0]}).attr("y1",function(e){return e.p1[1]}).attr("x2",function(e){return e.p2[0]}).attr("y2",function(e){return e.p2[1]}).attr("stroke","black").attr("stroke-width",2)}function n(e){var n={i:-1,left:void 0,right:void 0};return v.dimensions.some(function(t,r){if(D(t)<e[0]){var i=v.dimensions[r+1];return n.i=r,n.left=t,n.right=i,!1}return!0}),void 0===n.left?(n.i=0,n.left=v.dimensions[0],n.right=v.dimensions[1]):void 0===n.right&&(n.i=v.dimensions.length-1,n.right=n.left,n.left=v.dimensions[v.dimensions.length-2]),n}function t(){return function(){var e=d3.mouse(c),t=n(e),r={p1:e,dims:t,minX:D(t.left),maxX:D(t.right)};l[t.i]=r,l.active=t.i,r.p1[0]=Math.min(Math.max(r.minX,e[0]),r.maxX),r.p1[1]=e[1],r.p2=r.p1.slice()}}function r(){return function(){var n=d3.event,t=l[l.active];t.p2[0]=Math.min(Math.max(t.minX+1,n.x),t.maxX),t.p2[1]=n.y-v.margin.top,e(t)}}function i(e,n){var t=[e.p1[0]-e.minX,e.p1[1]-e.minX],r=[e.p2[0]-e.minX,e.p2[1]-e.minX],i=1-n/t[0],s=t[1]*(1-i),a=1-n/r[0],o=r[1]*(1-a);return function(e){var n=e[0],t=e[1],r=i*n+s,u=a*n+o;return t>Math.min(r,u)&&t<Math.max(r,u)}}function s(){function e(e,n){var t=l[n],r=i(t,l.width(n)),s=t.dims.left,a=t.dims.right,o=k[s],u=k[a],d=[o(e[s])-t.minX,u(e[a])-t.minX];return r(d)}var n=Object.getOwnPropertyNames(l),t=v.data;return n=n.filter(function(e){return!isNaN(e)}),0===n.length?t:t.filter(function(t){switch(S.predicate){case"AND":return n.every(function(n){return e(t,n)});case"OR":return n.some(function(n){return e(t,n)});default:throw"Unknown brush predicate "+v.brushPredicate}})}function a(){var e=l[l.active],n=b.selection.select("svg").select("g#strums");delete l[l.active],l.active=void 0,n.selectAll("line#strum-"+e.dims.i).remove()}function o(){return function(){var e=v.data,n=l[l.active];n&&n.p1[0]===n.p2[0]&&n.p1[1]===n.p2[1]&&a(l),e=s(l),l.active=void 0,v.brushed=e.length!==v.data.length&&e,x.brushend.call(b,v.brushed),b.render()}}function u(e){return function(){var n=Object.getOwnPropertyNames(e).filter(function(e){return!isNaN(e)});n.forEach(function(n){e.active=n,a(e)}),o(e)()}}function d(){var e=d3.behavior.drag();c=b.selection.insert("canvas","svg").attr("class","strums").style("margin-top",v.margin.top+"px").style("margin-left",v.margin.left+"px").attr("width",y()+2).attr("height",w()+2)[0][0],l.active=void 0,l.width=function(e){var n=l[e];if(void 0!==n)return n.maxX-n.minX},b.on("axesreorder.strums",function(){function e(e,n){var t=v.dimensions.length;return v.dimensions.some(function(r,i){return r===e&&(i+i<t&&v.dimensions[i+1]===n)})}var n=Object.getOwnPropertyNames(l).filter(function(e){return!isNaN(e)});n.length>0&&(n.forEach(function(n){var t=l[n].dims;l.active=n,e(t.left,t.right)||a(l)}),o(l)())}),b.selection.select("svg").append("g").attr("id","strums").attr("transform","translate("+v.margin.left+","+v.margin.top+")"),b.brushReset=u(l),e.on("dragstart",t(l)).on("drag",r(l)).on("dragend",o(l)),d3.select(c).style("pointer-events","auto").style("z-index",1e3).call(e)}var c,l={};S.modes["2D-strums"]={install:d,uninstall:function(){b.selection.select("canvas.strums").remove(),b.selection.select("svg").select("g#strums").remove(),b.on("axesreorder.strums",void 0),delete b.brushReset,c=void 0},selected:s}}(),b.interactive=function(){return A.interactive=!0,this},b.xscale=D,b.yscale=k,b.ctx=P,b.canvas=M,b.g=function(){return p},b.resize=function(){return b.selection.select("svg").attr("width",v.width).attr("height",v.height),b.svg.attr("transform","translate("+v.margin.left+","+v.margin.top+")"),A.brushable&&b.brushReset(),b.autoscale(),p&&b.createAxes(),A.shadows&&d(v.data,P.shadows),A.brushable&&b.brushable(),A.reorderable&&b.reorderable(),x.resize.call(this,{width:v.width,height:v.height,margin:v.margin}),this},b.highlight=function(e){return b.clear("highlight"),d3.select(M.foreground).classed("faded",!0),e.forEach(h),x.highlight.call(this,e),this},b.unhighlight=function(e){return b.clear("highlight"),d3.select(M.foreground).classed("faded",!1),this},b.intersection=function(e,n,t,r){return{x:((e.x*n.y-e.y*n.x)*(t.x-r.x)-(e.x-n.x)*(t.x*r.y-t.y*r.x))/((e.x-n.x)*(t.y-r.y)-(e.y-n.y)*(t.x-r.x)),y:((e.x*n.y-e.y*n.x)*(t.y-r.y)-(e.y-n.y)*(t.x*r.y-t.y*r.x))/((e.x-n.x)*(t.y-r.y)-(e.y-n.y)*(t.x-r.x))}},b.version="0.5.0",b.toString=function(){return"Parallel Coordinates: "+v.dimensions.length+" dimensions ("+d3.keys(v.data[0]).length+" total) , "+v.data.length+" rows"},b},d3.renderQueue=function(e){var n=[],t=10,r=function(){},i=0,s=function(e){e&&s.data(e),s.invalidate(),r(),s.render()};return s.render=function(){function r(){if(!a)return!0;if(i>n.length)return!0;for(var r=Math.min(i+t,n.length),s=i;s<r;s++)e(n[s],s);i+=t}i=0;var a=!0;s.invalidate=function(){a=!1},d3.timer(r)},s.data=function(e){return s.invalidate(),n=e.slice(0),s},s.rate=function(e){return arguments.length?(t=e,s):t},s.remaining=function(){return n.length-i},s.clear=function(e){return arguments.length?(r=e,s):(r(),s)},s.invalidate=function(){},s};
//# sourceMappingURL=d3.parcoords.min.js.map