/*
 *  Vide - v0.2.0
 *  Easy as hell jQuery plugin for video backgrounds.
 *  http://vodkabears.github.io/vide/
 *
 *  Made by Ilya Makarov
 *  Under MIT License
 */
!function(a,b,c,d){"use strict";function e(a){var b,c,d,e,f,g,h,i={};for(b=a.replace(/\s*:\s*/g,":").replace(/\s*,\s*/g,",").split(","),c=0,d=b.length;d>c&&(h=b[c],-1===h.search(/^(http|https|ftp):\/\//)&&-1!==h.search(":"));c++)g=h.indexOf(":"),e=h.substring(0,g),f=h.substring(g+1),f||(f=void 0),"string"==typeof f&&(f="true"===f||("false"===f?!1:f)),"string"==typeof f&&(f=isNaN(f)?f:+f),i[e]=f;return null==e&&null==f?a:i}function f(a){a=""+a;var b,c,d,e=a.split(/\s+/),f="50%",g="50%";for(b=0,c=e.length;c>b;b++)d=e[b],"left"===d?f="0%":"right"===d?f="100%":"top"===d?g="0%":"bottom"===d?g="100%":"center"===d?0===b?f="50%":g="50%":0===b?f=d:g=d;return{x:f,y:g}}function g(b,c){var d=function(){c(this.src)};a("<img src='"+b+".gif'>").load(d),a("<img src='"+b+".jpg'>").load(d),a("<img src='"+b+".jpeg'>").load(d),a("<img src='"+b+".png'>").load(d)}function h(b,c,d){if(this.element=a(b),this._defaults=j,this._name=i,"string"==typeof c&&(c=e(c)),d?"string"==typeof d&&(d=e(d)):d={},"string"==typeof c)c=c.replace(/\.\w*$/,"");else if("object"==typeof c)for(var f in c)c.hasOwnProperty(f)&&(c[f]=c[f].replace(/\.\w*$/,""));this.settings=a.extend({},j,d),this.path=c,this.init()}var i="vide",j={volume:1,playbackRate:1,muted:!0,loop:!0,autoplay:!0,position:"50% 50%",posterType:"detect"},k=/iPad|iPhone|iPod/i.test(d.userAgent),l=/Android/i.test(d.userAgent);h.prototype.init=function(){var b,c,d=this,e=f(this.settings.position);this.wrapper=a("<div>").css({position:"absolute","z-index":-1,top:0,left:0,bottom:0,right:0,overflow:"hidden","-webkit-background-size":"cover","-moz-background-size":"cover","-o-background-size":"cover","background-size":"cover","background-repeat":"no-repeat","background-position":e.x+" "+e.y}),b=this.path,"object"==typeof this.path&&(this.path.poster?b=this.path.poster:this.path.mp4?b=this.path.mp4:this.path.webm?b=this.path.webm:this.path.ogv&&(b=this.path.ogv)),"detect"===this.settings.posterType?g(b,function(a){d.wrapper.css("background-image","url("+a+")")}):"none"!==this.settings.posterType&&this.wrapper.css("background-image","url("+b+"."+this.settings.posterType+")"),"static"===this.element.css("position")&&this.element.css("position","relative"),this.element.prepend(this.wrapper),k||l||(c="","object"==typeof this.path?(this.path.mp4&&(c+="<source src='"+this.path.mp4+".mp4' type='video/mp4'>"),this.path.webm&&(c+="<source src='"+this.path.webm+".webm' type='video/webm'>"),this.path.ogv&&(c+="<source src='"+this.path.ogv+".ogv' type='video/ogv'>"),this.video=a("<video>"+c+"</video>")):this.video=a("<video><source src='"+this.path+".mp4' type='video/mp4'><source src='"+this.path+".webm' type='video/webm'><source src='"+this.path+".ogv' type='video/ogg'></video>"),this.video.css("visibility","hidden"),this.video.prop({autoplay:this.settings.autoplay,loop:this.settings.loop,volume:this.settings.volume,muted:this.settings.muted,playbackRate:this.settings.playbackRate}),this.wrapper.append(this.video),this.video.css({margin:"auto",position:"absolute","z-index":-1,top:e.y,left:e.x,"-webkit-transform":"translate(-"+e.x+", -"+e.y+")","-ms-transform":"translate(-"+e.x+", -"+e.y+")",transform:"translate(-"+e.x+", -"+e.y+")"}),this.video.bind("loadedmetadata."+i,function(){d.video.css("visibility","visible"),d.resize()}),a(this.element).bind("resize."+i,function(){d.resize()}))},h.prototype.getVideoObject=function(){return this.video?this.video[0]:null},h.prototype.resize=function(){if(this.video){var a=this.video[0].videoHeight,b=this.video[0].videoWidth,c=this.wrapper.height(),d=this.wrapper.width();this.video.css(d/b>c/a?{width:d+2,height:"auto"}:{width:"auto",height:c+2})}},h.prototype.destroy=function(){this.element.unbind(i),this.video&&this.video.unbind(i),delete a[i].lookup[this.index],this.element.removeData(i),this.wrapper.remove()},a[i]={lookup:[]},a.fn[i]=function(b,c){var d;return this.each(function(){d=a.data(this,i),d&&d.destroy(),d=new h(this,b,c),d.index=a[i].lookup.push(d)-1,a.data(this,i,d)}),this},a(c).ready(function(){a(b).bind("resize."+i,function(){for(var b,c=a[i].lookup.length,d=0;c>d;d++)b=a[i].lookup[d],b&&b.resize()}),a(c).find("[data-"+i+"-bg]").each(function(b,c){var d=a(c),e=d.data(i+"-options"),f=d.data(i+"-bg");d[i](f,e)})})}(window.jQuery,window,document,navigator);