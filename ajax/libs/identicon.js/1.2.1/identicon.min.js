!function(){var t;t="undefined"!=typeof module&&"undefined"!=typeof module.exports?require("./pnglib"):window.PNGlib;var n=function(t,n){this.defaults={background:[240,240,240,255],hash:this.createHashFromString((new Date).toISOString()),margin:.08,size:64},this.options="object"==typeof n?n:this.defaults,arguments[1]&&"number"==typeof arguments[1]&&(this.options.size=arguments[1]),arguments[2]&&(this.options.margin=arguments[2]),this.hash=t||this.defaults.hash,this.background=this.options.background||this.defaults.background,this.margin=this.options.margin||this.defaults.margin,this.size=this.options.size||this.defaults.size};n.prototype={background:null,hash:null,margin:null,size:null,render:function(){var n,e,i=this.hash,r=this.size,o=Math.floor(r*this.margin),s=Math.floor((r-2*o)/5),a=Math.floor((r-5*s)/2),h=new t(r,r,256),u=h.color(this.background[0],this.background[1],this.background[2],this.background[3]),d=this.hsl2rgb(parseInt(i.substr(-7),16)/268435455,.5,.7),l=h.color(255*d[0],255*d[1],255*d[2]);for(n=0;n<15;n++)e=parseInt(i.charAt(n),16)%2?u:l,n<5?this.rectangle(2*s+a,n*s+a,s,s,e,h):n<10?(this.rectangle(1*s+a,(n-5)*s+a,s,s,e,h),this.rectangle(3*s+a,(n-5)*s+a,s,s,e,h)):n<15&&(this.rectangle(0*s+a,(n-10)*s+a,s,s,e,h),this.rectangle(4*s+a,(n-10)*s+a,s,s,e,h));return h},rectangle:function(t,n,e,i,r,o){var s,a;for(s=t;s<t+e;s++)for(a=n;a<n+i;a++)o.buffer[o.index(s,a)]=r},hsl2rgb:function(t,n,e){return t*=6,n=[e+=n*=e<.5?e:1-e,e-t%1*n*2,e-=n*=2,e,e+t%1*n,e+n],[n[~~t%6],n[(16|t)%6],n[(8|t)%6]]},toString:function(){return this.render().getBase64()},createHashFromString:function(t){var n,e,i,r="0",o="identicon";if(!t)return r;for(t+=o+t,n=0,i=t.length;n<i;n++)e=t.charCodeAt(n),r=(r<<5)-r+e,r|=0;return r.toString()}},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=n:window.Identicon=n}();