!function(){var t;t="undefined"!=typeof module&&"undefined"!=typeof module.exports?require("./pnglib"):window.PNGlib;var i=function(t,i){this.defaults={background:[240,240,240,255],hash:this.createHashFromString((new Date).toISOString()),margin:.08,size:64,format:"png"},this.options="object"==typeof i?i:this.defaults,"number"==typeof arguments[1]&&(this.options.size=arguments[1]),arguments[2]&&(this.options.margin=arguments[2]),this.hash=t||this.defaults.hash,this.background=this.options.background||this.defaults.background,this.margin=this.options.margin||this.defaults.margin,this.size=this.options.size||this.defaults.size,this.format=this.options.format||this.defaults.format;var r=parseInt(this.hash.substr(-7),16)/268435455;this.foreground=this.options.foreground||this.hsl2rgb(r,.5,.7)};i.prototype={background:null,foreground:null,hash:null,margin:null,size:null,format:null,image:function(){return this.isSvg()?new r(this.size,this.foreground,this.background):new t(this.size,this.size,256)},render:function(){var t=this.image(),i=this.size,r=Math.floor(i*this.margin),s=Math.floor((i-2*r)/5),e=Math.floor((i-5*s)/2);bg=t.color.apply(t,this.background),fg=t.color.apply(t,this.foreground);var n,o;for(n=0;n<15;n++)o=parseInt(this.hash.charAt(n),16)%2?bg:fg,n<5?this.rectangle(2*s+e,n*s+e,s,s,o,t):n<10?(this.rectangle(1*s+e,(n-5)*s+e,s,s,o,t),this.rectangle(3*s+e,(n-5)*s+e,s,s,o,t)):n<15&&(this.rectangle(0*s+e,(n-10)*s+e,s,s,o,t),this.rectangle(4*s+e,(n-10)*s+e,s,s,o,t));return t},rectangle:function(t,i,r,s,e,n){if(this.isSvg())n.rectangles.push({x:t,y:i,w:r,h:s,color:e});else{var o,h;for(o=t;o<t+r;o++)for(h=i;h<i+s;h++)n.buffer[n.index(o,h)]=e}},hsl2rgb:function(t,i,r){return t*=6,i=[r+=i*=r<.5?r:1-r,r-t%1*i*2,r-=i*=2,r,r+t%1*i,r+i],[255*i[~~t%6],255*i[(16|t)%6],255*i[(8|t)%6]]},toString:function(){return this.render().getBase64()},createHashFromString:function(t){var i,r,s,e="0",n="identicon";if(!t)return e;for(t+=n+t,i=0,s=t.length;i<s;i++)r=t.charCodeAt(i),e=(e<<5)-e+r,e|=0;return e.toString()},isSvg:function(){return this.format.match(/svg/i)}};var r=function(t,i,r){this.size=t,this.foreground=this.color.apply(this,i),this.background=this.color.apply(this,r),this.rectangles=[]};r.prototype={size:null,foreground:null,background:null,rectangles:null,color:function(t,i,r,s){var e=[t,i,r,s?s/255:1].map(Math.round);return"rgba("+e.join(",")+")"},getBase64:function(){var t,i,r,s=this.foreground,e=this.background,n=.005*this.size;for(i='<svg xmlns="http://www.w3.org/2000/svg" width="'+this.size+'" height="'+this.size+'" style="background-color:'+e+';"><g style="fill:'+s+"; stroke:"+s+"; stroke-width:"+n+';">',t=0;t<this.rectangles.length;t++)r=this.rectangles[t],r.color!=e&&(i+='<rect  x="'+r.x+'" y="'+r.y+'" width="'+r.w+'" height="'+r.h+'"/>');return i+="</g></svg>",btoa(i)}},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=i:window.Identicon=i}();