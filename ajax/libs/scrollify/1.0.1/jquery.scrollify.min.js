/*!
 * jQuery Scrollify
 * Version 1.0.0
 *
 * Requires:
 * - jQuery 1.6 or higher
 *
 * https://github.com/lukehaas/Scrollify
 *
 * Copyright 2016, Luke Haas
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of
 * the Software, and to permit persons to whom the Software is furnished to do so,
 * subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
 * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
 * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
 * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
 * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */
!function(e,t){"use strict";"function"==typeof define&&define.amd?define(["jquery"],function(o){return t(o,e,e.document)}):"object"==typeof module&&module.exports?module.exports=function(o,n){return void 0===n&&(n="undefined"!=typeof window?require("jquery"):require("jquery")(o)),t(n,e,e.document),n}:t(jQuery,e,e.document)}("undefined"!=typeof window?window:this,function(e,t,o,n){"use strict";function i(o,n,i){if(H===!0)return!0;if(f[o]){if(S=!1,i&&I.before(o,p),m=1,I.sectionName&&(D!==!0||0!==o))if(history.pushState)try{history.replaceState(null,null,f[o])}catch(s){t.console&&console.warn("Scrollify warning: This needs to be hosted on a server to manipulate the hash value.")}else t.location.hash=f[o];if(n)e(I.target).stop().scrollTop(d[o]),i&&I.after(o,p);else{if(E=!0,jQuery().velocity?e(I.target).stop().velocity("scroll",{duration:I.scrollSpeed,easing:I.easing,offset:d[o],mobileHA:!1}):e(I.target).stop().animate({scrollTop:d[o]},I.scrollSpeed,I.easing),t.location.hash.length&&I.sectionName&&t.console)try{e(t.location.hash).length&&console.warn("Scrollify warning: There are IDs on the page that match the hash value - this will cause the page to anchor.")}catch(s){console.warn("Scrollify warning:",t.location.hash,"is not a valid jQuery expression.")}e(I.target).promise().done(function(){E=!1,D=!1,i&&I.after(o,p)})}}}function s(e){function t(t){for(var o=0,n=e.slice(Math.max(e.length-t,1)),i=0;i<n.length;i++)o+=n[i];return Math.ceil(o/t)}var o=t(10),n=t(70);return o>=n?!0:!1}function r(e,t){for(var o=f.length;o>=0;o--)"string"==typeof e?f[o]===e&&(y=o,i(o,t,!0)):o===e&&(y=o,i(o,t,!0))}var c,a,u,l,h,d=[],f=[],p=[],g=[],y=0,m=1,v=!1,w=e(t),b=w.scrollTop(),S=!1,E=!1,M=!1,H=!1,x=[],T=(new Date).getTime(),D=!0,j=!1,I={section:".section",sectionName:"section-name",interstitialSection:"",easing:"easeOutExpo",scrollSpeed:1100,offset:0,scrollbars:!0,axis:"y",target:"html,body",standardScrollElements:!1,setHeights:!0,overflowScroll:!0,before:function(){},after:function(){},afterResize:function(){},afterRender:function(){}};e.scrollify=function(n){function r(t){jQuery().velocity?e(I.target).stop().velocity("scroll",{duration:I.scrollSpeed,easing:I.easing,offset:t,mobileHA:!1}):e(I.target).stop().animate({scrollTop:t},I.scrollSpeed,I.easing)}function D(){var t=I.section;g=[],I.interstitialSection.length&&(t+=","+I.interstitialSection),e(t).each(function(t){I.setHeights?e(this).is(I.interstitialSection)?g[t]=!1:e(this).css("height","auto").outerHeight()<w.height()||"hidden"===e(this).css("overflow")?(e(this).css({height:w.height()}),g[t]=!1):(e(this).css({height:e(this).height()}),I.overflowScroll?g[t]=!0:g[t]=!1):e(this).outerHeight()<w.height()||I.overflowScroll===!1?g[t]=!1:g[t]=!0})}function L(o){var n=I.section;I.interstitialSection.length&&(n+=","+I.interstitialSection),d=[],f=[],p=[],e(n).each(function(o){o>0?d[o]=parseInt(e(this).offset().top)+I.offset:d[o]=parseInt(e(this).offset().top),I.sectionName&&e(this).data(I.sectionName)?f[o]="#"+e(this).data(I.sectionName).replace(/ /g,"-"):e(this).is(I.interstitialSection)===!1?f[o]="#"+(o+1):f[o]="#",p[o]=e(this),e(f[o]).length&&t.console&&console.warn("Scrollify warning: Section names can't match IDs on the page - this will cause the browser to anchor."),t.location.hash===f[o]&&(y=o,v=!0)}),!0===o?i(y,!1,!1):I.afterRender()}function N(){return g[y]?(b=w.scrollTop(),b>parseInt(d[y])?!1:!0):!0}function k(){return g[y]?(b=w.scrollTop(),b<parseInt(d[y])+(p[y].outerHeight()-w.height())-28?!1:!0):!0}j=!0,e.easing.easeOutExpo=function(e,t,o,n,i){return t==i?o+n:n*(-Math.pow(2,-10*t/i)+1)+o},u={handleMousedown:function(){return H===!0?!0:(S=!1,void(M=!1))},handleMouseup:function(){return H===!0?!0:(S=!0,void(M&&u.calculateNearest()))},handleScroll:function(){return H===!0?!0:(c&&clearTimeout(c),void(c=setTimeout(function(){return M=!0,S===!1?!1:(S=!1,void u.calculateNearest())},200)))},calculateNearest:function(){b=w.scrollTop();for(var e,t=1,o=d.length,n=0,s=Math.abs(d[0]-b);o>t;t++)e=Math.abs(d[t]-b),s>e&&(s=e,n=t);(k()||N())&&(y=n,i(n,!1,!0))},wheelHandler:function(t,o){if(H===!0)return!0;if(I.standardScrollElements&&(e(t.target).is(I.standardScrollElements)||e(t.target).closest(I.standardScrollElements).length))return!0;g[y]||t.preventDefault();var n=(new Date).getTime();if(o=o||-t.originalEvent.detail/3||t.originalEvent.wheelDelta/120,x.length>149&&x.shift(),x.push(Math.abs(10*o)),n-T>200&&(x=[]),T=n,E)return!1;if(0>o){if(y<d.length-1&&k()){if(!s(x))return!1;t.preventDefault(),y++,E=!0,i(y,!1,!0)}}else if(o>0&&y>0&&N()){if(!s(x))return!1;t.preventDefault(),y--,E=!0,i(y,!1,!0)}},keyHandler:function(e){return H===!0?!0:E===!0?!1:void(38==e.keyCode?y>0&&N()&&(y--,i(y,!1,!0)):40==e.keyCode&&y<d.length-1&&k()&&(y++,i(y,!1,!0)))},init:function(){I.scrollbars?(w.bind("mousedown",u.handleMousedown),w.bind("mouseup",u.handleMouseup),w.bind("scroll",u.handleScroll)):e("body").css({overflow:"hidden"}),e(o).bind("DOMMouseScroll mousewheel",u.wheelHandler),e(o).bind("keydown",u.keyHandler)}},l={touches:{touchstart:{y:-1,x:-1},touchmove:{y:-1,x:-1},touchend:!1,direction:"undetermined"},options:{distance:30,timeGap:800,timeStamp:(new Date).getTime()},touchHandler:function(t){if(H===!0)return!0;if(I.standardScrollElements&&(e(t.target).is(I.standardScrollElements)||e(t.target).closest(I.standardScrollElements).length))return!0;var o;if("undefined"!=typeof t&&"undefined"!=typeof t.touches)switch(o=t.touches[0],t.type){case"touchstart":l.touches.touchstart.y=o.pageY,l.touches.touchmove.y=-1,l.touches.touchstart.x=o.pageX,l.touches.touchmove.x=-1,l.options.timeStamp=(new Date).getTime(),l.touches.touchend=!1;case"touchmove":l.touches.touchmove.y=o.pageY,l.touches.touchmove.x=o.pageX,l.touches.touchstart.y!==l.touches.touchmove.y&&Math.abs(l.touches.touchstart.y-l.touches.touchmove.y)>Math.abs(l.touches.touchstart.x-l.touches.touchmove.x)&&(t.preventDefault(),l.touches.direction="y",l.options.timeStamp+l.options.timeGap<(new Date).getTime()&&0==l.touches.touchend&&(l.touches.touchend=!0,l.touches.touchstart.y>-1&&Math.abs(l.touches.touchmove.y-l.touches.touchstart.y)>l.options.distance&&(l.touches.touchstart.y<l.touches.touchmove.y?l.up():l.down())));break;case"touchend":l.touches[t.type]===!1&&(l.touches[t.type]=!0,l.touches.touchstart.y>-1&&l.touches.touchmove.y>-1&&"y"===l.touches.direction&&(Math.abs(l.touches.touchmove.y-l.touches.touchstart.y)>l.options.distance&&(l.touches.touchstart.y<l.touches.touchmove.y?l.up():l.down()),l.touches.touchstart.y=-1,l.touches.touchstart.x=-1,l.touches.direction="undetermined"))}},down:function(){y<=d.length-1&&(k()&&y<d.length-1?(y++,i(y,!1,!0)):Math.floor(p[y].height()/w.height())>m?(r(parseInt(d[y])+w.height()*m),m+=1):r(parseInt(d[y])+(p[y].height()-w.height())))},up:function(){y>=0&&(N()&&y>0?(y--,i(y,!1,!0)):m>2?(m-=1,r(parseInt(d[y])+w.height()*m)):(m=1,r(parseInt(d[y]))))},init:function(){o.addEventListener&&(o.addEventListener("touchstart",l.touchHandler,!1),o.addEventListener("touchmove",l.touchHandler,!1),o.addEventListener("touchend",l.touchHandler,!1))}},h={refresh:function(e){clearTimeout(a),a=setTimeout(function(){D(),L(!0),e&&I.afterResize()},400)},handleUpdate:function(){h.refresh(!1)},handleResize:function(){h.refresh(!0)}},I=e.extend(I,n),D(),L(!1),!0===v?i(y,!1,!0):setTimeout(function(){i(0,!1,!0)},200),d.length&&(u.init(),l.init(),w.bind("resize",h.handleResize),o.addEventListener&&t.addEventListener("orientationchange",h.handleResize,!1))},e.scrollify.move=function(t){return t===n?!1:(t.originalEvent&&(t=e(this).attr("href")),void r(t,!1))},e.scrollify.instantMove=function(e){return e===n?!1:void r(e,!0)},e.scrollify.next=function(){y<f.length&&(y+=1,i(y,!1,!0))},e.scrollify.previous=function(){y>0&&(y-=1,i(y,!1,!0))},e.scrollify.instantNext=function(){y<f.length&&(y+=1,i(y,!0,!0))},e.scrollify.instantPrevious=function(){y>0&&(y-=1,i(y,!0,!0))},e.scrollify.destroy=function(){return j?(I.setHeights&&e(I.section).each(function(){e(this).css("height","auto")}),w.unbind("resize",h.handleResize),I.scrollbars&&(w.unbind("mousedown",u.handleMousedown),w.unbind("mouseup",u.handleMouseup),w.unbind("scroll",u.handleScroll)),e(o).unbind("DOMMouseScroll mousewheel",u.wheelHandler),e(o).unbind("keydown",u.keyHandler),o.addEventListener&&(o.removeEventListener("touchstart",l.touchHandler,!1),o.removeEventListener("touchmove",l.touchHandler,!1),o.removeEventListener("touchend",l.touchHandler,!1)),d=[],f=[],p=[],void(g=[])):!1},e.scrollify.update=function(){return j?void h.handleUpdate():!1},e.scrollify.current=function(){return p[y]},e.scrollify.disable=function(){H=!0},e.scrollify.enable=function(){H=!1},e.scrollify.isDisabled=function(){return H},e.scrollify.setOptions=function(o){return j?void("object"==typeof o?(I=e.extend(I,o),h.handleUpdate()):t.console&&console.warn("Scrollify warning: Options need to be in an object.")):!1}});
