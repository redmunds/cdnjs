{"version":3,"sources":["../../../src/Layers/HeatMapFeatureLayer/HeatMapFeatureLayer.js"],"names":[],"mappings":"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","file":"esri-leaflet-heatmap-feature-layer-src.js","sourcesContent":["L.esri.Layers.HeatmapFeatureLayer = L.esri.Layers.FeatureManager.extend({\n\n  /**\n   * Constructor\n   */\n\n  initialize: function (url, options) {\n    L.esri.Layers.FeatureManager.prototype.initialize.call(this, url, options);\n\n    options = L.setOptions(this, options);\n\n    this._cache = {};\n    this._active = {};\n\n    this.heat = new window.L.heatLayer([], options);\n  },\n\n  /**\n   * Layer Interface\n   */\n\n  onAdd: function(map){\n    L.esri.Layers.FeatureManager.prototype.onAdd.call(this, map);\n    this._map.addLayer(this.heat);\n  },\n\n  onRemove: function(map){\n    L.esri.Layers.FeatureManager.prototype.onRemove.call(this, map);\n    this._map.removeLayer(this.heat);\n  },\n\n  /**\n   * Feature Managment Methods\n   */\n\n  createLayers: function(features){\n    for (var i = features.length - 1; i >= 0; i--) {\n      var geojson = features[i];\n      var id = geojson.id;\n      var latlng = new L.LatLng(geojson.geometry.coordinates[1], geojson.geometry.coordinates[0]);\n      this._cache[id] = latlng;\n\n      // add the layer if it is within the time bounds or our layer is not time enabled\n      if(!this._active[id] && (!this.options.timeField || (this.options.timeField && this._featureWithinTimeRange(geojson)))){\n        this._active[id] = latlng;\n        this.heat._latlngs.push(latlng);\n      }\n    }\n\n    this.heat.redraw();\n  },\n\n  addLayers: function(ids){\n    for (var i = ids.length - 1; i >= 0; i--) {\n      var id = ids[i];\n      if(!this._active[id]){\n        var latlng = this._cache[id];\n        this.heat._latlngs.push(latlng);\n        this._active[id] = latlng;\n      }\n    }\n    this.heat.redraw();\n  },\n\n  removeLayers: function(ids, permanent){\n    var newLatLngs = [];\n    for (var i = ids.length - 1; i >= 0; i--) {\n      var id = ids[i];\n      if(this._active[id]){\n        delete this._active[id];\n      }\n      if(this._cache[id] && permanent){\n        delete this._cache[id];\n      }\n    }\n\n    for (var latlng in this._active){\n      newLatLngs.push(this._active[latlng]);\n    }\n\n    this.heat.setLatLngs(newLatLngs);\n  }\n\n});\n\nL.esri.HeatmapFeatureLayer = L.esri.Layers.HeatmapFeatureLayer;\n\nL.esri.Layers.heatmapFeatureLayer = function(url, options){\n  return new L.esri.Layers.HeatmapFeatureLayer(url, options);\n};\n\nL.esri.heatmapFeatureLayer = function(url, options){\n  return new L.esri.Layers.heatmapFeatureLayer(url, options);\n};\n"]}