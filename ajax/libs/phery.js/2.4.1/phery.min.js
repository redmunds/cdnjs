!function(e,t){"use strict";"function"==typeof define&&"undefined"!=typeof define.amd?define("phery",["jquery"],function(n){return t(e,n)}):e.phery=t(e,jQuery)}(this,function(window,$,undefined){"use strict";function debug(e,t){options.debug.enable&&"undefined"!=typeof console&&"function"==typeof console.dir&&"undefined"!=typeof options.debug.display[t]&&options.debug.display[t]===!0&&console.dir(e)}function do_cursor(e){options.cursor&&(e?$body_html.css("cursor",e):$body_html.css("cursor",$original_cursor))}function clean_up(e){e.phery("data","temp")&&(e.off(),$.removeData(e),e.remove())}function set_events(){$document.off(".phery"),$document.on(options.delegate.confirm.join(".phery,")+".phery",":phery-confirm:not(form)",function(e){confirm($(this).phery("data","confirm"))?e.preventDefault():e.stopImmediatePropagation()}),$document.on(options.delegate.form.join(".phery,")+".phery","form:phery-remote",function(){var e=$(this);return functions.form_submit(e),!1}),$document.on(options.delegate.tags.join(".phery,")+".phery",":phery-remote:not(form,select)",function(e){var t=$(this);return!(!options.enable.clickable_structure&&"number"==typeof structural_html[this.tagName]&&!t.phery("data","clickable"))&&(functions.ajax_call.call(t),t.is('input[type="text"],input[type="checkbox"],input[type="radio"],input[type="image"]')||e.preventDefault(),!0)}),$document.on(options.delegate.select.join(".phery,")+".phery","select:phery-remote:not([multiple])",function(e){functions.ajax_call.call($(e.currentTarget))}),$document.on(options.delegate.select_multiple.join(".phery,")+".phery","select:phery-remote[multiple]",function(e){functions.ajax_call.call($(e.currentTarget))})}function _apply(e,t,n){t=t||!1;for(var r in e)if(e.hasOwnProperty(r))if("object"==typeof e[r]&&e[r].constructor!==Array){if(_apply(e[r],t,r)===!1)return!1}else switch(debug(["config",{group:n,name:r,value:e[r]}],"config"),n){case"inline":switch(r){case"enabled":break;case"once":vars.inline_load=!0}break;case"delegate":switch(r){case"confirm":case"form":case"select_multiple":case"select":case"tags":if(!functions.compare_array(e[r],options.delegate[r])||t)return set_events(),!1}}return!0}function refresh_changes(e,t){var n=$.extend(!0,{},options);if(!vars.locked_config){if(t===undefined)for(var r in e)e.hasOwnProperty(r)&&functions.dot_notation_option(r,options,e[r]);else functions.dot_notation_option(e,options,t);_apply(n)}}var functions={},vars={},$document=$(document),structural_html={HTML:1,BODY:1,DIV:1,BLOCKQUOTE:1,BR:1,HR:1,HEAD:1,H1:1,H2:1,H3:1,H4:1,H5:1,H6:1,P:1,HEADER:1,FOOTER:1,NAV:1,SECTION:1,ASIDE:1,ARTICLE:1,HGROUP:1,FIGURE:1},phery=function(){return phery};vars.locked_config=!1,vars.inline_load=!0,vars.special_match=/\{([#~\+\-=!])[\d]+\}/,vars.$version=$().jquery,vars.has_formdata="FormData"in window,vars.has_file=vars.has_formdata&&"File"in window,vars.FormData=vars.has_formdata?FormData:null,vars.call_cache=[],phery.version="2.4.0",functions.assign_object=function(e,t,n,r,a,i,o){if(!t||!t.length)return!1;if("array"!==$.type(t)){if("number"!==$.type(t)&&"string"!==$.type(t))return!1;t=[t]}var s,c=t.length-1;r=r===undefined||r,a=a!==undefined&&a,i=i!==undefined&&i,o=o!==undefined&&o,n!==undefined&&i&&(i=!1);for(var f=0;f<c;f++)if(s=t[f],s in e)e=e[s];else{if(!r)return!1;e[s]={},e=e[s]}return"undefined"!=typeof e[t[c]]&&n!==undefined?"array"!==$.type(e[t[c]])||a||o?o?e[t[c]]=e[t[c]].concat(n):e[t[c]]=n:"array"===$.type(n)?e[t[c]].concat(n):e[t[c]].push(n):n!==undefined&&(e[t[c]]=n),i?e[t[c]]:[e,t[c]]},functions.obj_to_str=function(e,t,n){n="object"==typeof n?n:{};var r,a,i;for(r in e)e.hasOwnProperty(r)&&(a=e[r],i=t?t+"["+r+"]":r,"object"!=typeof a||vars.has_file&&a instanceof window.File?n[i]=a:functions.obj_to_str(a,i,n));return n},functions.files_to_array=function(e){var t=[];if(vars.has_file)if(e instanceof window.File)t.push(e);else if(e instanceof window.FileList&&e.length)t.push(e[0]);else if(e.files instanceof window.FileList&&e.files.length)if(e.files.length>1)for(var n=0;n<e.files.length;n++)t.push(e.files[n]);else t.push(e.files[0]);return t},functions.to_formdata=function(e){e="object"===$.type(e)?functions.obj_to_str(e):e;var t,n=new vars.FormData;for(t in e)e.hasOwnProperty(t)&&n.append(t,e[t]);return n},functions.per_data=function(e,t){var n,r,a=$.type(e),i=$.type(t);switch(a){case"array":switch(i){case"array":e.concat(t);break;case"object":case"string":case"null":case"boolean":case"number":e.push(t)}break;case"object":switch(i){case"object":e=$.extend(e,t);break;case"array":for(r=0,n=0;n<t.length;n++){for(;"undefined"!=typeof e[r];)r++;e[r]=t[n]}break;case"number":case"string":case"null":case"boolean":for(r=0;"undefined"!=typeof e[r];)r++;e[r]=t}break;case"string":case"number":case"null":case"boolean":e=[].concat(e,t);break;case"undefined":e="object"===i?t:[].concat(t)}return e},functions.filter_prop=function(e){return function(){return $(this).prop(e)}},functions.form_element=function(e){var t,n,r=e.prop("name")||null,a=null,i=e.prop("tagName").toLowerCase();return e.is('[type="radio"]')||e.is('[type="checkbox"]')?e.is('[type="radio"]')?(t=e.prop("form")?$(e.prop("form")).find('[type="radio"][name="'+e.prop("name")+'"]'):$('[type="radio"][name="'+e.prop("name")+'"]'),t.filter(functions.filter_prop("checked")).length&&(a=t.filter(functions.filter_prop("checked")).val())):e.prop("checked")&&(a=!e.is("[value]")||e.val()):e.is("select")?(n=e.find("option").filter(functions.filter_prop("selected")),a=e.prop("multiple")?n.map(function(){return this.value||this.innerHTML}).get():n.val(),r=r||""):e.is('[type="file"]')?vars.has_file?(r&&(r=r.replace("[]","")),a=functions.files_to_array(e[0]),i="file"):r=null:a=e.val(),{name:r,value:a,type:i}},functions.append_args=function(e){var t,n;"undefined"!=typeof e[0]&&e[0].constructor===Array&&(e=e[0]);for(n in e)e.hasOwnProperty(n)&&(t=this.phery("data","args"),this.phery("data","args",functions.per_data(t,e[n])))},functions.set_args=function(e){"function"!==$.type(e)&&this.phery("data","args",functions.per_data(undefined,e[0]))},functions.compare_array=function(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0},functions.str_is_function=function(e,t){if(!e||"function"!=typeof e.toString)return!1;e=e.toString();var n=e.search(/^[\s;]*function\(/im)!==-1&&e.search(/\};?$/m);if(n&&t){var r,a=vars.call_cache.length,i=null;for(r=0;r<a;r++)if(vars.call_cache[r].str===e){i=vars.call_cache[r].fn;break}if("function"!=typeof i){var o=e.match(/function\s*\(([^\)]*)\)/im)[1],s=e.slice(e.indexOf("{")+1,e.lastIndexOf("}"));if(!s)return!1;i=new Function(o,s),vars.call_cache.push({str:e,fn:i})}return i}return n},vars.defaults={cursor:!0,default_href:!1,ajax:{retries:0},enable:{log:!1,autolock:!1,file_uploads:!1,log_history:!1,per_element:{events:!0},clickable_structure:!1},inline:{enabled:!1,once:!0},debug:{enable:!1,display:{events:!0,remote:!0,config:!0}},delegate:{confirm:["click"],form:["submit"],select_multiple:["blur"],select:["change"],tags:["click"]}};var options={},callbacks=$("<div></div>"),_log=[],$original_cursor,$body_html,_callbacks={before:function(){return!0},beforeSend:function(){return!0},params:function(){return!0},always:function(){return!0},fail:function(){return!0},progress:function(){return!0},done:function(){return!0},after:function(){return!0},exception:function(){return!0},json:function(){return!0}};return functions.trigger_and_return=function(e,t,n,r,a){r=r||null;var i,o=$.Event(t);return r&&(o.target=r),e.trigger(o,"array"===$.type(n)?n:[n]),i=o.result!==!1,a&&(o.target=e,$document.trigger(o,"array"===$.type(n)?n:[n])),debug(["event triggered",{name:t,"event result":i,element:e,data:n}],"events"),i},functions.trigger_phery_event=function(e,t,n,r){return n=n||[],r=r||!1,r?(functions.trigger_and_return(callbacks,t,n,e),e&&options.enable.per_element.events&&functions.trigger_and_return(e,"phery:"+t,n,null,!0),!0):functions.trigger_and_return(callbacks,t,n,e)!==!1&&(!e||!options.enable.per_element.events||functions.trigger_and_return(e,"phery:"+t,n,null,!0))},functions.countProperties=function(e){var t=0;if("object"==typeof e)for(var n in e)e.hasOwnProperty(n)&&++t;else"undefined"!=typeof e.length&&(t=e.length);return t},functions.form_submit=function(e){var t=e.phery("data","confirm");return!(t&&!confirm(t))&&functions.ajax_call.call(e)},functions.ajax_call=function(e,t){var n;if(n=this.phery("data","proxy")instanceof $?this.phery("data","proxy"):t?t:this,functions.trigger_phery_event(n,"before")===!1)return functions.trigger_phery_event(n,"always",[null]),clean_up(this),!1;if(!this.phery("data","remote")&&!this.phery("data","view"))return functions.trigger_phery_event(n,"exception",[phery.log("Current element have no remote data information")]),functions.trigger_phery_event(n,"always",[null]),clean_up(this),!1;var r,a,i,o,s,c,f={"X-Requested-With":"XMLHttpRequest","X-Phery":1},p=t||this,u=this,l=u.attr("action")||u.attr("href")||u.phery("data","target")||p.attr("action")||p.attr("href")||p.phery("data","target")||options.default_href||window.location.href,h=u.phery("data","type")||p.phery("data","type")||"json",d=u.attr("method")||p.attr("method")||p.phery("data","method")||"GET",y=p.attr("id")||p.parent().attr("id")||null,g=!!u.phery("data","cache")||!!p.phery("data","cache")||!1,_={},v={args:undefined,phery:{method:d}};if((c=$("head meta#csrf-token")).length&&(v.phery.csrf=c.prop("content")),p.phery("data","args"))try{v.args=functions.per_data({},p.phery("data","args"))}catch(e){functions.trigger_phery_event(n,"exception",[phery.log(e)])}if(e&&(v.args=functions.per_data(v.args,e)),p.is("form"))try{r=p.serializeForm(p.phery("data","submit")?$.extend({},p.phery("data","submit"),{files_apart:!0}):{files_apart:!0}),v.args=functions.per_data(v.args,r.inputs),$.extend(_,r.files)}catch(e){functions.trigger_phery_event(n,"exception",[phery.log(e)])}if(p.is('textarea,input[type!="file"]')&&(r=p.serializeForm(),v.args=functions.per_data(v.args,r)),p.is('input[type="file"]')&&vars.has_file&&(r=p.serializeForm(),$.extend(_,r)),p.is("select")){var m=functions.form_element(p);if(m.name){var b={};b[m.name]=m.value,v.args=functions.per_data(v.args,b)}else v.args=functions.per_data(v.args,m.value)}if(p.phery("data","related"))try{var w,x,j=p.phery("data","related"),k=$();switch(typeof j){case"string":if(j.indexOf(",")>-1)for(w=j.split(","),s=0;s<w.length;s++)x=p.find(w[s]),x.length||(x=$(w[s])),x.length&&(k=k.add(x));else x=p.find(j),x.length||(x=$(j)),x.length&&(k=k.add(x));break;case"object":k=j;break;default:k=!1}if(k!==!1)if(k.length){var O={},P=0;k.each(function(){var e=$(this);e.is("form")?(r=e.serializeForm({files_apart:!0}),O=functions.per_data(O,r.inputs),$.extend(_,r.files)):e.attr("name")?O[e.attr("name")]=e.val():e.attr("id")?O[e.attr("id")]=e.val():O[P++]=e.val()}),v.args=functions.per_data(v.args,O)}else functions.trigger_phery_event(n,"exception",[phery.log("related selector found no elements",p.phery("data","related"))])}catch(e){functions.trigger_phery_event(n,"exception",[phery.log(e,"invalid data-phery-related info")])}y&&(v.phery.submit_id=y),p.phery("data","view")?v.phery.view="#"+p.attr("id"):(u.phery("data","remote")||p.phery("data","remote"))&&(v.phery.remote=u.phery("data","remote")||p.phery("data","remote"));var D={};functions.trigger_phery_event(n,"params",D,!0),v.phery=$.extend(D,v.phery),a=new Date,debug(["remote call",{data:v,timestamp:a.getTime(),time:a.toLocaleString()}],"remote"),a=a.getTime(),o=functions.countProperties(_)>0;var F={url:g?l:l.indexOf("_=")===-1?l+(l.indexOf("?")>-1?"&":"?")+"_="+a:l.replace(/_=(\d+)/,"_="+a),data:o?functions.to_formdata($.extend(_,v)):v,contentType:!o&&"application/x-www-form-urlencoded",processData:!o,dataType:h,type:"POST",el:u,global:!1,try_count:0,retry_limit:options.ajax.retries,cache:g,headers:f,xhr:function(){var e=$.ajaxSettings.xhr();return"undefined"!=typeof e.upload&&(e.upload.onprogress=function(e){functions.trigger_phery_event(n,"progress",[e])}),e},beforeSend:function(e,t){return do_cursor("wait"),functions.trigger_phery_event(n,"beforeSend",[e,t])!==!1}},q=function(e,t,r){return this.retry_limit>0&&"timeout"===t&&(this.try_count++,this.try_count<=this.retry_limit)?(functions.trigger_phery_event(n,"before"),this.dataType="text "+h,this.url=this.url.indexOf("_try_count=")===-1?this.url+"&_try_count="+this.try_count:this.url.replace(/_try_count=(\d+)/,"_try_count="+this.try_count),g||(this.url=this.url.replace(/_=(\d+)/,"_="+(new Date).getTime())),i=T(this),!1):(do_cursor(!1),functions.trigger_phery_event(n,"fail",[e,t,r])===!1?(clean_up(this.el),!1):(clean_up(this.el),!0))},H=function(e,t,r){return functions.trigger_phery_event(n,"done",[e,t,r])!==!1&&(functions.process_request.call(n,e,n!==u),!0)},S=function(e,t,r){return"timeout"===t&&4!==e.readyState&&this.try_count>0&&this.try_count<=this.retry_limit?(functions.trigger_phery_event(n,"always",[e]),!1):(do_cursor(!1),functions.trigger_phery_event(n,"always",["timeout"===t?e:r])===!1?(clean_up(this.el),!1):(clean_up(this.el),!0))},T=function(e){var t=$.ajax(e);return t.done(H).always(S).fail(q),t};return i=T(F)},functions.convert_special=function(e,t){var n,r,a;if("object"===$.type(t))if("undefined"!=typeof t.PF)t=(n=functions.str_is_function(t.PF,!0))?n:null;else if("undefined"!=typeof t.PR){a=t.PR;for(r in a)a.hasOwnProperty(r)&&(t=functions.process(e,functions.selector(e,r,a),a[r]))}return t},functions.selector=function(e,t,n,r){var a,i,o=!1,s=t.match(vars.special_match);if(null!==s&&(s=s[1]),"="===s||"!"===s){if(a=n[t].shift(),i=functions.process_parameters(e,a.a[0]),i!==a.a[0])if("function"===$.type(i))"="===s&&i.call(r||e)?o=r||e:"!"!==s||i.call(r||e)||(o=r||e);else if("boolean"===$.type(i))"="===s&&i?o=r||e:"!"!==s||i||(o=r||e);else if("object"===$.type(i)||"string"===$.type(i))try{"="===s?i instanceof $&&i.length?o=r||e:$(i).length&&(o=r||e):"!"===s&&(i instanceof $&&!i.length?o=r||e:$(i).length||(o=r||e))}catch(t){functions.trigger_phery_event(e,"exception",[phery.log(t)])}}else if("+"===s){a=n[t].shift();var c=functions.assign_object("string"==typeof a.a[1]&&a.a[1].match(vars.special_match)?functions.selector(e,a.a[1],n,r):window,a.c,undefined,!1,!1,!0);c?o=a.a[0]?new c:c:functions.trigger_phery_event(e,"exception",[phery.log("failed access to object","window."+a.c.join("."))])}else"~"===s?o=e:"-"===s?(a=n[t].shift(),a=a.a,o=phery.remote(a[0],a[1],a[2],a[3])):o="#"===s?$:$("window"===t.toLowerCase()?window:"document"===t.toLowerCase()?document:t);return o},functions.process_parameters=function(e,t){if(t=functions.convert_special(e,t),"object"===$.type(t)||"array"===$.type(t)){var n,r;for(n in t)if(t.hasOwnProperty(n))switch($.type(t[n])){case"array":for(r in t[n])t[n].hasOwnProperty(r)&&(t[n][r]=functions.process_parameters(e,t[n][r]));break;case"object":t[n]=functions.process_parameters(e,t[n])}}return t},functions.process=function(e,t,n){var r,a,i;for(r in n)if(n.hasOwnProperty(r)){a=n[r].a;try{if(i=n[r].c,"function"!=typeof t[i])throw'no function "'+i+'" found in object';"undefined"!=typeof a[0]?(a=functions.process_parameters(e,a[0]),t="array"===$.type(a)&&"undefined"!=typeof a[0]?t[i].apply(t,a):t[i].call(t,a)):t=t[i].apply(t,a)}catch(t){functions.trigger_phery_event(e,"exception",[phery.log(t,a)])}}return t},functions.process_request=function(data,proxied){if(!this.phery("data","remote")&&!this.phery("data","view")&&!proxied)return void functions.trigger_phery_event(this,"after",[]);if("object"!==$.type(data))return void functions.trigger_phery_event(this,"after",[]);var $jq,argv,argc,$this=this,is_selector,funct,_data,_argv,special=null;if(data&&functions.countProperties(data)){var x;for(x in data)if(data.hasOwnProperty(x))if(special=x.match(vars.special_match),null!==special&&(special=special[1]),is_selector=special||"<"===x.toString().charAt(0)||x.toString().search(/^[0-9]+$/)===-1)data[x].length?($jq=functions.selector($this,x,data,$jq),("#"===special||"+"===special&&$jq!==!1||$jq&&"number"==typeof $jq.length&&$jq.length)&&($jq=functions.process($this,$jq,data[x]))):functions.trigger_phery_event($this,"exception",[phery.log("no commands to issue, 0 length")]);else switch(argc=data[x].a.length,argv=data[x].a,Number(data[x].c)){case 1:"undefined"!=typeof argv[0]?alert(argv[0].toString()):functions.trigger_phery_event($this,"exception",[phery.log("missing message for alert()",argv)]);break;case 2:try{if(funct=argv.shift(),funct=functions.assign_object(window,funct,undefined,!1),funct===!1||"function"!=typeof funct[0][funct[1]])throw'no global function "'+funct+'" found';funct[0][funct[1]].apply(null,argv[0]||[])}catch(e){functions.trigger_phery_event($this,"exception",[phery.log(e,argv)])}break;case 3:try{eval("(function(){ "+argv[0]+" })();")}catch(e){functions.trigger_phery_event($this,"exception",[phery.log(e,argv[0])])}break;case 4:try{functions.trigger_phery_event($this,"json",[$.parseJSON(argv[0])])}catch(e){functions.trigger_phery_event($this,"exception",[phery.log(e,argv[0])])}break;case 5:_data=$this.phery("data","view"),_argv=$.extend(!0,{},{url:$this.phery("data","target")},argv[1]);var _pass;$this.phery("data","passdata")?(_pass=$this.phery("data","passdata"),$.removeData($this[0],"phery-passdata")):_pass={},"function"==typeof _data.beforeHtml&&_data.beforeHtml.call($this,_argv,_pass),"function"!=typeof _data.render?$this.html("").html(argv[0]):_data.render.call($this,argv[0],_argv,_pass),"function"==typeof _data.afterHtml&&_data.afterHtml.call($this,_argv,_pass);break;case 6:try{if("undefined"!=typeof console&&"undefined"!=typeof console.log)for(var l=0;l<argc;l++)console.log(argv[l][0])}catch(e){functions.trigger_phery_event($this,"exception",[phery.log(e,argv[0])])}break;case 7:if(argc>1){_argv=[argv.shift()];do _argv.push(argv.shift());while(argv.length);functions.trigger_phery_event($this,"exception",_argv)}else functions.trigger_phery_event($this,"exception",[argv[0]]);break;case 8:2===argc&&(argv[1]?phery.view(argv[1]).navigate_to(argv[0]):window.location.assign(argv[0]));break;case 9:var _obj=functions.assign_object(window,argv[0],undefined,2===argc,!0);_obj&&_obj.length>0?2===argc?_obj[0][_obj[1]]=functions.process_parameters($this,argv[1][0]):1===argc&&delete _obj[0][_obj[1]]:functions.trigger_phery_event($this,"exception",[phery.log("object path not found in window"+argv[0].join("."))]);break;case 10:var head=$("head"),file=null,i;switch(argv[0]){case"j":for(i in argv[1])argv[1].hasOwnProperty(i)&&(file=$("<script></script>",{type:"text/javascript",src:argv[1][i],id:i}),head.find("script#"+i).length?argv[2]&&head.find("script#"+i).replaceWith(file):head[0].appendChild(file[0]));break;case"c":for(i in argv[1])argv[1].hasOwnProperty(i)&&(file=$("<link/>",{type:"text/css",rel:"stylesheet",href:argv[1][i],id:i}),head.find("link#"+i).length?argv[2]&&head.find("link#"+i).replaceWith(file):head[0].appendChild(file[0]))}break;default:functions.trigger_phery_event($this,"exception",[phery.log('invalid command "'+data[x].c+'" issued')])}}functions.trigger_phery_event(this,"after",[])},functions.dot_notation_option=function(e,t,n){if(e.indexOf(".")!==-1){var r=e.split(".");if(r&&r[0]&&"undefined"!=typeof t[r[0]])return functions.dot_notation_option(r.slice(1).join("."),t[r[0]],n)}else if("undefined"!=typeof t[e])return"undefined"!=typeof n?(t[e].constructor===Array&&"string"==typeof n?t[e].push(n):t[e]=n,t):t[e];return null},options=$.extend(!0,{},vars.defaults,options),$(function(){$body_html=$("body,html"),$original_cursor=$body_html.css("cursor"),_apply(options,!0)}),$(window).on({load:function(){options.enable.autolock&&(vars.locked_config=!0),options.inline.enabled&&options.inline.once&&(vars.inline_load=!1)}}),phery.config=function(e,t){return"object"==typeof e&&e.constructor===Object?(refresh_changes(e),phery):"string"==typeof e&&t!==undefined?(refresh_changes(e,t),phery):"string"==typeof e&&t===undefined?e in options?options[e]:functions.dot_notation_option(e,options):0===arguments.length?$.extend(!0,{},options):phery},phery.lock_config=function(){return vars.locked_config=!0,phery},phery.reset_to_defaults=function(){return options=$.extend(!0,{},vars.defaults),_apply(options,!0),phery},phery.log=function(){var e=Array.prototype.slice.call(arguments);return e.length?(options.enable.log&&(options.enable.log_history&&_log.push(e),"undefined"!=typeof console&&"undefined"!=typeof console.log&&("object"==typeof console.log?console.log(e):console.log.apply(console,e))),e.join("\n")):options.enable.log_history?_log:[]},phery.remote=function(e,t,n,r){if(!this)return!1;if(this===phery&&!e)return phery.log('first argument "function_name" on phery.remote() must be specified when calling directly'),!1;if(r!==!1&&(r=!0),this!==phery)return functions.ajax_call.call(this);var a=$("<a></a>"),i=[t];if(a.phery("data","remote",e),r&&a.phery("data","temp",!0),n!==undefined&&"object"===$.type(n)){if("undefined"!=typeof n.proxy)if(n.proxy instanceof $)n.proxy=n.proxy;else if("string"===$.type(n.proxy)){var o=$(n.proxy);o.length?n.proxy=o:delete n.proxy}else delete n.proxy;"undefined"!=typeof n.el&&(n.el instanceof $&&i.push(n.el),delete n.el);for(var s in n)n.hasOwnProperty(s)&&("target method type proxy cache".indexOf(s.toLowerCase())!==-1?a.phery("data",s,n[s]):a.attr(n))}return r?functions.ajax_call.apply(a,i):a},phery.remotes=function(e){var t=$.Deferred(),n=[],r=0,a=function(){var i=e instanceof $?e.eq(r++):e.shift();if(i&&i.length){var o=e instanceof $?phery.remote.apply(i):phery.remote.apply(phery,i);o instanceof $.Deferred?(n.push(o),t.notifyWith(i,o),o.always(a)):a()}else t.resolve(n)};if("array"===$.type(e)&&e.length)for(var i=0;i<e.length;i++)"array"===$.type(e[i])?e[i].length>3&&(e[i]=e[i].slice(0,3)):e.splice(i,1);else if(!(e instanceof $))return t.resolve([]),t.promise();return a(),t.promise()},phery.on=function(e,t){if("object"==typeof e)for(var n in e)e.hasOwnProperty(n)&&phery.on(n,e[n]);else"string"==typeof e&&"function"==typeof t&&e in _callbacks&&(debug(["phery.on",{event:e,callback:t}],"events"),callbacks.on(e+".phery",t));return phery},phery.off=function(e){return debug(["phery.off",{event:e}],"events"),callbacks.off(e+".phery"),phery},phery.load=function(e,t){if(options.inline.enabled){if(!vars.inline_load)return phery;t||(t=$("<a></a>"),t.phery("data","temp",!0)),"string"===$.type(e)&&t instanceof $&&functions.process_request.call(t,$.parseJSON(e),!0)}return phery},vars._containers={},functions.excluded_url=function(e,t){if("#"===e)return!0;for(var n=0;n<t.length;n++)switch(typeof t[n]){case"string":if(e.indexOf(t[n])!==-1)return!0;break;case"object":if(e.search(t[n])!==-1)return!0;break;case"function":if(t[n].call(null,e)===!0)return!0}return!1},functions.phery_view=function(e){this.container=e,this.data=$.extend({},this.container.phery("data","view")),this.is_excluded_url=function(e){var t=this.container.phery("data","view").exclude||!1;return!(!t||!e)&&functions.excluded_url(e,t)},this.navigate_to=function(e,t,n){e&&this.container.phery("data","target",e);var r;return n!==undefined&&this.container.phery("data","passdata",n),r=t!==undefined&&null!==t?functions.ajax_call.call(this.container,t):functions.ajax_call.call(this.container)}},phery.view=function(e){if("string"==typeof e)return"undefined"!=typeof vars._containers[e]?vars._containers[e]:phery;if("object"==typeof e&&$.isEmptyObject(e))return debug(["phery.view needs config"],"config"),phery;var t,n,r,a,i=function(e){var t=$(this),n=t.attr("href");return!(2!==e.which&&!e.metaKey)||(!!e.data.is_excluded_url(n)||(debug(["phery.view link clicked, loading content",e.data.container,t.attr("href")],"events"),e.data.navigate_to(t.attr("href")),e.stopPropagation(),e.preventDefault(),!1))};$document.off("click.view");for(t in e)if(e.hasOwnProperty(t))if(r=$(t),1===r.length){if(n=t.replace(/[#\.\s>:,~=\+\-_\*]/g,""),e[t]===!1){r.off(".phery.view"),$document.off("click.view."+n),debug(["phery.view uninstalled and events unbound",r],"config");continue}a="string"==typeof e[t].selector&&e[t].selector.search(/(^|\s)a($|\s|\.)/i)!==-1?t+" "+e[t].selector:'a[href]:not(.no-phery,[target],[data-phery-remote],[href*=":"],[rel~="nofollow"])',a=a+',a[href][rel="'+t+'"]',r.phery("data","view",$.extend(!0,{},e[t],{selector:a})),vars._containers[t]=new functions.phery_view(r),$document.on("click.view."+n,a,vars._containers[t],i);for(var o in e[t])e[t].hasOwnProperty(o)&&"undefined"!=typeof _callbacks[o]&&r.on("phery:"+o+".phery.view",e[t][o]);debug(["phery.view installed",r],"config")}else debug(["phery.view container",r,"isnt unique or does not exist"],"config");return phery},functions.reset=function(){return this.each(function(){$(this).is("form")&&this.reset()})},functions.phery=function(e){var t=this,n={exception:function(e,n){return t.each(function(){var t=$(this);functions.trigger_phery_event(t,"exception",[e,n])})},data:function(e,n){var r;if(n!==undefined)return t.data("phery-"+e,n),t;if(e!==undefined){if("object"===$.type(e)){for(r in e)e.hasOwnProperty(r)&&t.data("phery-"+r,e[r]);return t}return t.data("phery-"+e)}n=t.data();for(r in n)n.hasOwnProperty(r)&&!/^phery\-/.test(r)&&delete n[r];return n},proxy:function(e){return t.each(function(){var t=$(this);if(e instanceof $)e.length&&t.phery("data","proxy",e);else if("string"===$.type(e))try{e=$(e),e.length&&t.phery("data","proxy",e)}catch(e){}else $.removeData(this,"phery-proxy")})},remote:function(){return t.each(function(){var e=$(this);e.is(":phery-remote")&&(e.is("form")?functions.form_submit(e):functions.ajax_call.call(e))})},append_args:function(){var e=Array.prototype.slice.call(arguments);return t.each(function(){var t=$(this);functions.append_args.apply(t,[e])}),n},set_args:function(e){return t.each(function(){var t=$(this);functions.set_args.call(t,[e])}),n},get_args:function(){return t.phery("data","args")},remove:function(){t.each(function(){var e=$(this);e.phery("data","temp",!0),clean_up(e)})},make:function(e,n){return"string"===$.type(e)?t.each(function(){var t=$(this);t.attr("data-phery-remote",e).phery("data","remote",e),n&&functions.set_args.call(t,[n])}):t},unmake:function(e){return t.each(function(){var t=$(this);e&&t.off(".phery"),$.removeData(this,"remote"),t.removeAttr("data-phery-remote").removeAttr("data-phery-args").removeAttr("data-phery-confirm")})}};if(e&&"object"===$.type(e)){var r;for(var a in e)e.hasOwnProperty(a)&&a in n&&(r=n[a].apply(t,e[a]));return r}return e&&e in n?n[e].apply(t,Array.prototype.slice.call(arguments,1)):n},functions.serializeForm=function(e){e=$.extend({disabled:!1,all:!1,empty:!0,files_apart:!1},e||{});var t=$(this),n=e.files_apart?{inputs:{},files:{}}:{},r=function(){var e=$(this);return!vars.has_file&&e.is('input[type="file"]')?null:functions.form_element(e)},a=t.is("form")?t.find("input,textarea,select").filter(function(){var t=!0;return e.disabled||(t=!this.disabled),t&&""!==$.trim(this.name)}).map(r).get():t.is("select,textarea,input")?[functions.form_element(t)]:[];if(a.length){var i,o,s,c,f,p,u,l,h;for(i=0;i<a.length;i++){if(s=a[i].name,o=a[i].value,l=a[i].type,e.all)null===o&&(o="");else if(null===o)continue;if((""!==o||e.empty)&&("file"!==l||0!==o.length)&&s){for(c=s.split(/\[/),f=c.length,u=1;u<f;u++)c[u]=c[u].replace(/\]/g,"");for(h=[],u=0;u<f;u++)(c[u]||u<f-1)&&h.push(c[u].replace(/['"]+/g,""));""===c[f-1]?(p=functions.assign_object(e.files_apart?"file"===l?n.files:n.inputs:n,h,[],!0,!1,!1),"array"===$.type(o)?p[0][p[1]].concat(o):p[0][p[1]].push(o)):functions.assign_object(e.files_apart?"file"===l?n.files:n.inputs:n,h,o,!0,!1,!1,"file"===l)}}}return n},$.extend($.expr[":"],{"phery-remote":function(e){return e instanceof $?e.phery("data","remote"):$(e).phery("data","remote")},"phery-confirm":function(e){return e instanceof $?e.phery("data","confirm"):$(e).phery("data","confirm")}}),$.fn.extend({reset:functions.reset,phery:functions.phery,serializeForm:functions.serializeForm}),"vars"in phery||"functions"in phery||"function"==typeof Object.freeze&&Object.freeze(phery),phery});