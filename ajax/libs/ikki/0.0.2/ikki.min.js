!function(t){var e=t&&t.riot?t.riot:require("riot");e.tag("route",' <section if="{ show }"><yield ></yield></section>',function(t){function e(t,e){if(t=t.replace(/^\//,""),"*"==t)return{};var n=[],o=t.replace(/(^|\/):([^\/]+)/g,function(t,e,o){return n.push(o),e+"([^/]+)"}),i=e.match(new RegExp("^"+o+"$"));if(!i)return null;var r={};return n.map(function(t,e){r[t]=i[e+1]}),r}var n=this;n.show=!1,n.param={},n.on("update",function(){var o;n.show=!n.parent.found&&(o=e(t.path,n.parent.path)),n.param=o||{},n.show&&(n.parent.found=!0,t.redirect&&(/^http/.test(t.redirect)?location.href=t.redirect:location.hash=t.redirect))})}),e.tag("router"," <yield ></yield>",function(e){var n=this,o=t,i="hashchange";n.path="",n.query={},n.found=!1,this.emit=function(t){var e=location.href.split("#")[1]||"",o=e.split("?")[0].replace(/^\/|\/$/g,""),i={};e.replace(/[?&](.+?)=([^&]*)/g,function(t,e,n){i[e]=n}),n.path=o,n.query=i,n.found=!1,t&&n.update()}.bind(this),n.on("mount",function(){o.addEventListener?o.addEventListener(i,n.emit,!1):o.attachEvent("on"+i,n.emit)}),n.on("unmount",function(){o.removeEventListener?o.removeEventListener(i,n.emit,!1):o.detachEvent("on"+i,n.emit)}),this.emit()}),e.mixin("ikki",{init:function(){function t(t){if(!i)return t;var e=i.query,n=i.param;return Object.keys(e).map(function(n){t=t.replace(new RegExp("^\\?"+n+"$"),e[n])}),Object.keys(n).map(function(e){t=t.replace(new RegExp("^\\$"+e+"$"),n[e])}),t}function e(t,e){Object.keys(e).map(function(n){t[n]=e[n]})}function n(t){var i=t.next().value;i&&i.then(function(i){e(o.opts,i),o.update(),setTimeout(function(){n(t)},0)})}var o=this,i=null,r={},a={};o.on("update",function(){o.opts.listeners&&o.opts.listeners.length&&(o.opts.listeners.map(function(t){o.on(t.key,t.callback)}),o.opts.listeners=[]),i=o.getRouteInfo(),Object.keys(o.opts).map(function(e){"opts"!=e&&(r[e]&&a[e]==o.opts[e]||(r[e]=o.opts[e]),o.opts[e]=t(r[e]),a[e]=o.opts[e])})});var s=o.opts.opts;"object"!=typeof s||s.then?"object"==typeof s?s.then(function(t){e(o.opts,t),o.update()}):s&&"GeneratorFunction"==s.constructor.name&&n(s()):e(o.opts,s)},getRouteInfo:function(){for(tag=this;tag&&"route"!=tag.root.tagName.toLowerCase();)tag=tag.parent;return tag?{path:tag.parent.path||"",query:tag.parent.query||{},param:tag.param||{}}:null}}),e.mixin("parentScope",{init:function(){this._ownPropKeys=[],this._ownOptsKeys=[];for(var t in this)this._ownPropKeys[t]=!0;for(var t in this.opts)this._ownOptsKeys[t]=!0;this.on("update",function(){for(var t in this.parent)this._ownPropKeys[t]||(this[t]=this.parent[t]);for(var t in this.parent.opts)this._ownOptsKeys[t]||(this.opts[t]=this.parent.opts[t])})},updateCaller:function(t){var e=[];for(var n in this.parent._ownPropKeys||this.parent)e.push(n);for(var o=0;o<e.length;o++)if(this.parent[e[o]]===t)return void this.parent.update();this.parent.updateCaller&&this.parent.updateCaller(t)}})}("undefined"!=typeof window?window:void 0);