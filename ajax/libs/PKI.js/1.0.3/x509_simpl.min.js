!function(e){if("undefined"==typeof e.org)e.org={};else if("object"!=typeof e.org)throw new Error("Name org already exists and it's not an object");if("undefined"==typeof e.org.pkijs)e.org.pkijs={};else if("object"!=typeof e.org.pkijs)throw new Error("Name org.pkijs already exists and it's not an object but "+typeof e.org.pkijs);if("undefined"==typeof e.org.pkijs.simpl)e.org.pkijs.simpl={};else if("object"!=typeof e.org.pkijs.simpl)throw new Error("Name org.pkijs.simpl already exists and it's not an object but "+typeof e.org.pkijs.simpl);if("undefined"==typeof e.org.pkijs.simpl.x509)e.org.pkijs.simpl.x509={};else if("object"!=typeof e.org.pkijs.simpl.x509)throw new Error("Name org.pkijs.simpl.x509 already exists and it's not an object but "+typeof e.org.pkijs.simpl.x509);e.org.pkijs.simpl.TIME=function(){this.type=0,this.value=new Date(0,0,0),arguments[0]instanceof Object&&"schema"in arguments[0]?e.org.pkijs.simpl.TIME.prototype.fromSchema.call(this,arguments[0].schema):arguments[0]instanceof Object&&(this.type=arguments[0].type||0,this.value=arguments[0].value||new Date(0,0,0))},e.org.pkijs.simpl.TIME.prototype.fromSchema=function(i){var t=e.org.pkijs.compareSchema(i,i,e.org.pkijs.schema.TIME({names:{utcTimeName:"utcTimeName",generalTimeName:"generalTimeName"}}));if(t.verified===!1)throw new Error("Object's schema was not verified against input data for TIME");"utcTimeName"in t.result&&(this.type=0,this.value=t.result.utcTimeName.toDate()),"generalTimeName"in t.result&&(this.type=1,this.value=t.result.generalTimeName.toDate())},e.org.pkijs.simpl.TIME.prototype.toSchema=function(){var i={};return 0===this.type&&(i=new e.org.pkijs.asn1.UTCTIME({value_date:this.value})),1===this.type&&(i=new e.org.pkijs.asn1.GENERALIZEDTIME({value_date:this.value})),i},e.org.pkijs.simpl.TIME.prototype.toJSON=function(){return{type:this.type,value:this.value}},e.org.pkijs.simpl.GENERAL_NAME=function(){this.NameType=9,this.Name={},arguments[0]instanceof Object&&"schema"in arguments[0]?e.org.pkijs.simpl.GENERAL_NAME.prototype.fromSchema.call(this,arguments[0].schema):arguments[0]instanceof Object&&(this.NameType=arguments[0].NameType||9,this.Name=arguments[0].Name||{})},e.org.pkijs.simpl.GENERAL_NAME.prototype.fromSchema=function(i){var t=e.org.pkijs.compareSchema(i,i,e.org.pkijs.schema.GENERAL_NAME({names:{block_name:"block_name",otherName:"otherName",rfc822Name:"rfc822Name",dNSName:"dNSName",x400Address:"x400Address",directoryName:{names:{block_name:"directoryName"}},ediPartyName:"ediPartyName",uniformResourceIdentifier:"uniformResourceIdentifier",iPAddress:"iPAddress",registeredID:"registeredID"}}));if(t.verified===!1)throw new Error("Object's schema was not verified against input data for GENERAL_NAME");switch(this.NameType=t.result.block_name.id_block.tag_number,this.NameType){case 0:this.Name=t.result.block_name;break;case 1:case 2:case 6:var s=t.result.block_name;s.id_block.tag_class=1,s.id_block.tag_number=22;var r=s.toBER(!1);this.Name=e.org.pkijs.fromBER(r).result.value_block.value;break;case 3:this.Name=t.result.block_name;break;case 4:this.Name=new e.org.pkijs.simpl.RDN({schema:t.result.directoryName});break;case 5:this.Name=t.result.ediPartyName;break;case 7:this.Name=new e.org.pkijs.asn1.OCTETSTRING({value_hex:t.result.block_name.value_block.value_hex});break;case 8:var s=t.result.block_name;s.id_block.tag_class=1,s.id_block.tag_number=6;var r=s.toBER(!1);this.Name=e.org.pkijs.fromBER(r).result.value_block.toString()}},e.org.pkijs.simpl.GENERAL_NAME.prototype.toSchema=function(i){switch(this.NameType){case 0:case 3:case 5:return new e.org.pkijs.asn1.ASN1_CONSTRUCTED({id_block:{tag_class:3,tag_number:this.NameType},value:[this.Name]});case 1:case 2:case 6:var t=new e.org.pkijs.asn1.IA5STRING({value:this.Name});return t.id_block.tag_class=3,t.id_block.tag_number=this.NameType,t;case 4:return new e.org.pkijs.asn1.ASN1_CONSTRUCTED({id_block:{tag_class:3,tag_number:4},value:[this.Name.toSchema()]});case 7:var t=this.Name;return t.id_block.tag_class=3,t.id_block.tag_number=this.NameType,t;case 8:var t=new e.org.pkijs.asn1.OID({value:this.Name});return t.id_block.tag_class=3,t.id_block.tag_number=this.NameType,t;default:return e.org.pkijs.schema.GENERAL_NAME()}},e.org.pkijs.simpl.GENERAL_NAME.prototype.toJSON=function(){var e={NameType:this.NameType};return"string"==typeof this.Name?e.Name=this.Name:e.Name=this.Name.toJSON(),e},e.org.pkijs.simpl.GENERAL_NAMES=function(){this.names=new Array,arguments[0]instanceof Object&&"schema"in arguments[0]?e.org.pkijs.simpl.GENERAL_NAMES.prototype.fromSchema.call(this,arguments[0].schema):arguments[0]instanceof Object&&(this.names=arguments[0].names||new Array)},e.org.pkijs.simpl.GENERAL_NAMES.prototype.fromSchema=function(i){var t=e.org.pkijs.compareSchema(i,i,new e.org.pkijs.asn1.SEQUENCE({value:[new e.org.pkijs.asn1.REPEATED({name:"names",value:n_window.org.pkijs.schema.GENERAL_NAME()})]}));if(t.verified===!1)throw new Error("Object's schema was not verified against input data for GENERAL_NAMES");for(var s=t.result.names,r=0;r<s.length;r++)this.names.push(new e.org.pkijs.simpl.GENERAL_NAME({schema:s[r]}))},e.org.pkijs.simpl.GENERAL_NAMES.prototype.toSchema=function(i){for(var t=new Array,s=0;s<this.names.length;s++)t.push(this.names[s].toSchema());return new e.org.pkijs.asn1.SEQUENCE({value:t})},e.org.pkijs.simpl.GENERAL_NAMES.prototype.toJSON=function(){for(var e=new Array,i=0;i<this.names.length;i++)e.push(this.names[i].toJSON());return{names:e}},e.org.pkijs.simpl.ALGORITHM_IDENTIFIER=function(){this.algorithm_id="",arguments[0]instanceof Object&&"schema"in arguments[0]?e.org.pkijs.simpl.ALGORITHM_IDENTIFIER.prototype.fromSchema.call(this,arguments[0].schema):arguments[0]instanceof Object&&(this.algorithm_id=arguments[0].algorithm_id||"","algorithm_params"in arguments[0]&&(this.algorithm_params=arguments[0].algorithm_params))},e.org.pkijs.simpl.ALGORITHM_IDENTIFIER.prototype.fromSchema=function(i){var t=e.org.pkijs.compareSchema(i,i,e.org.pkijs.schema.ALGORITHM_IDENTIFIER({names:{algorithmIdentifier:"algorithm",algorithmParams:"params"}}));if(t.verified===!1)throw new Error("Object's schema was not verified against input data for ALGORITHM_IDENTIFIER");this.algorithm_id=t.result.algorithm.value_block.toString(),"params"in t.result&&(this.algorithm_params=t.result.params)},e.org.pkijs.simpl.ALGORITHM_IDENTIFIER.prototype.toSchema=function(){var i=new Array;return i.push(new e.org.pkijs.asn1.OID({value:this.algorithm_id})),"algorithm_params"in this&&i.push(this.algorithm_params),new e.org.pkijs.asn1.SEQUENCE({value:i})},e.org.pkijs.simpl.ALGORITHM_IDENTIFIER.prototype.getCommonName=function(){},e.org.pkijs.simpl.ALGORITHM_IDENTIFIER.prototype.toJSON=function(){var e={algorithm_id:this.algorithm_id};return"algorithm_params"in this&&(e.algorithm_params=this.algorithm_params.toJSON()),e},e.org.pkijs.simpl.x509.RSAPublicKey=function(){this.modulus=new e.org.pkijs.asn1.INTEGER,this.publicExponent=new e.org.pkijs.asn1.INTEGER,arguments[0]instanceof Object&&"schema"in arguments[0]?e.org.pkijs.simpl.x509.RSAPublicKey.prototype.fromSchema.call(this,arguments[0].schema):arguments[0]instanceof Object&&(this.modulus=arguments[0].modulus||new e.org.pkijs.asn1.INTEGER,this.publicExponent=arguments[0].publicExponent||new e.org.pkijs.asn1.INTEGER)},e.org.pkijs.simpl.x509.RSAPublicKey.prototype.fromSchema=function(i){var t=e.org.pkijs.compareSchema(i,i,e.org.pkijs.schema.x509.RSAPublicKey({names:{modulus:"modulus",publicExponent:"publicExponent"}}));if(t.verified===!1)throw new Error("Object's schema was not verified against input data for RSAPublicKey");this.modulus=t.result.modulus,this.publicExponent=t.result.publicExponent},e.org.pkijs.simpl.x509.RSAPublicKey.prototype.toSchema=function(){return new e.org.pkijs.asn1.SEQUENCE({value:[this.modulus,this.publicExponent]})},e.org.pkijs.simpl.x509.RSAPublicKey.prototype.toJSON=function(){return{modulus:this.modulus.toJSON(),publicExponent:this.publicExponent.toJSON()}},e.org.pkijs.simpl.x509.OtherPrimeInfo=function(){this.prime=new e.org.pkijs.asn1.INTEGER,this.exponent=new e.org.pkijs.asn1.INTEGER,this.coefficient=new e.org.pkijs.asn1.INTEGER,arguments[0]instanceof Object&&"schema"in arguments[0]?e.org.pkijs.simpl.x509.OtherPrimeInfo.prototype.fromSchema.call(this,arguments[0].schema):arguments[0]instanceof Object&&(this.prime=arguments[0].prime||new e.org.pkijs.asn1.INTEGER,this.exponent=arguments[0].exponent||new e.org.pkijs.asn1.INTEGER,this.coefficient=arguments[0].coefficient||new e.org.pkijs.asn1.INTEGER)},e.org.pkijs.simpl.x509.OtherPrimeInfo.prototype.fromSchema=function(i){var t=e.org.pkijs.compareSchema(i,i,e.org.pkijs.schema.x509.OtherPrimeInfo({names:{prime:"prime",exponent:"exponent",coefficient:"coefficient"}}));if(t.verified===!1)throw new Error("Object's schema was not verified against input data for OtherPrimeInfo");this.prime=t.result.prime,this.exponent=t.result.exponent,this.coefficient=t.result.coefficient},e.org.pkijs.simpl.x509.OtherPrimeInfo.prototype.toSchema=function(){return new e.org.pkijs.asn1.SEQUENCE({value:[this.prime,this.exponent,this.coefficient]})},e.org.pkijs.simpl.x509.OtherPrimeInfo.prototype.toJSON=function(){return{prime:this.prime.toJSON(),exponent:this.exponent.toJSON(),coefficient:this.coefficient.toJSON()}},e.org.pkijs.simpl.x509.RSAPrivateKey=function(){this.version=0,this.modulus=new e.org.pkijs.asn1.INTEGER,this.publicExponent=new e.org.pkijs.asn1.INTEGER,this.privateExponent=new e.org.pkijs.asn1.INTEGER,this.prime1=new e.org.pkijs.asn1.INTEGER,this.prime2=new e.org.pkijs.asn1.INTEGER,this.exponent1=new e.org.pkijs.asn1.INTEGER,this.exponent2=new e.org.pkijs.asn1.INTEGER,this.coefficient=new e.org.pkijs.asn1.INTEGER,arguments[0]instanceof Object&&"schema"in arguments[0]?e.org.pkijs.simpl.x509.RSAPrivateKey.prototype.fromSchema.call(this,arguments[0].schema):arguments[0]instanceof Object&&(this.version=arguments[0].version||0,this.modulus=arguments[0].modulus||new e.org.pkijs.asn1.INTEGER,this.publicExponent=arguments[0].publicExponent||new e.org.pkijs.asn1.INTEGER,this.privateExponent=arguments[0].privateExponent||new e.org.pkijs.asn1.INTEGER,this.prime1=arguments[0].prime1||new e.org.pkijs.asn1.INTEGER,this.prime2=arguments[0].prime2||new e.org.pkijs.asn1.INTEGER,this.exponent1=arguments[0].exponent1||new e.org.pkijs.asn1.INTEGER,this.exponent2=arguments[0].exponent2||new e.org.pkijs.asn1.INTEGER,this.coefficient=arguments[0].coefficient||new e.org.pkijs.asn1.INTEGER,"otherPrimeInfos"in arguments[0]&&(this.otherPrimeInfos=arguments[0].otherPrimeInfos||new Array))},e.org.pkijs.simpl.x509.RSAPrivateKey.prototype.fromSchema=function(i){var t=e.org.pkijs.compareSchema(i,i,e.org.pkijs.schema.x509.RSAPrivateKey({names:{version:"version",modulus:"modulus",publicExponent:"publicExponent",privateExponent:"privateExponent",prime1:"prime1",prime2:"prime2",exponent1:"exponent1",exponent2:"exponent2",coefficient:"coefficient",otherPrimeInfos:"otherPrimeInfos"}}));if(t.verified===!1)throw new Error("Object's schema was not verified against input data for RSAPrivateKey");if(this.version=t.result.version.value_block.value_dec,this.modulus=t.result.modulus,this.publicExponent=t.result.publicExponent,this.privateExponent=t.result.privateExponent,this.prime1=t.result.prime1,this.prime2=t.result.prime2,this.exponent1=t.result.exponent1,this.exponent2=t.result.exponent2,this.coefficient=t.result.coefficient,"otherPrimeInfos"in t.result)for(var s=t.result.otherPrimeInfos,r=0;r<s.length;r++)this.otherPrimeInfos.push(new e.org.pkijs.simpl.x509.OtherPrimeInfo({schema:s[r]}))},e.org.pkijs.simpl.x509.RSAPrivateKey.prototype.toSchema=function(){var i=new Array;if(i.push(new e.org.pkijs.asn1.INTEGER({value:this.version})),i.push(this.modulus),i.push(this.publicExponent),i.push(this.privateExponent),i.push(this.prime1),i.push(this.prime2),i.push(this.exponent1),i.push(this.exponent2),i.push(this.coefficient),"otherPrimeInfos"in this){for(var t=new Array,s=0;s<this.otherPrimeInfos.length;s++)t.push(this.otherPrimeInfos[s].toSchema());i.push(new e.org.pkijs.asn1.SEQUENCE({value:t}))}return new e.org.pkijs.asn1.SEQUENCE({value:i})},e.org.pkijs.simpl.x509.RSAPrivateKey.prototype.toJSON=function(){var e={version:this.version,modulus:this.modulus.toJSON(),publicExponent:this.publicExponent.toJSON(),privateExponent:this.privateExponent.toJSON(),prime1:this.prime1.toJSON(),prime2:this.prime2.toJSON(),exponent1:this.exponent1.toJSON(),exponent2:this.exponent2.toJSON(),coefficient:this.coefficient.toJSON()};if("otherPrimeInfos"in this){e.otherPrimeInfos=new Array;for(var i=0;i<this.otherPrimeInfos.length;i++)e.otherPrimeInfos.push(this.otherPrimeInfos[i].toJSON())}return e},e.org.pkijs.simpl.PUBLIC_KEY_INFO=function(){this.algorithm=new e.org.pkijs.simpl.ALGORITHM_IDENTIFIER,this.subjectPublicKey=new e.org.pkijs.asn1.BITSTRING,arguments[0]instanceof Object&&"schema"in arguments[0]?e.org.pkijs.simpl.PUBLIC_KEY_INFO.prototype.fromSchema.call(this,arguments[0].schema):arguments[0]instanceof Object&&(this.algorithm=arguments[0].algorithm||new e.org.pkijs.simpl.ALGORITHM_IDENTIFIER,this.subjectPublicKey=arguments[0].subjectPublicKey||new e.org.pkijs.asn1.BITSTRING)},e.org.pkijs.simpl.PUBLIC_KEY_INFO.prototype.fromSchema=function(i){var t=e.org.pkijs.compareSchema(i,i,e.org.pkijs.schema.PUBLIC_KEY_INFO({names:{algorithm:{names:{block_name:"algorithm"}},subjectPublicKey:"subjectPublicKey"}}));if(t.verified===!1)throw new Error("Object's schema was not verified against input data for PUBLIC_KEY_INFO");this.algorithm=new e.org.pkijs.simpl.ALGORITHM_IDENTIFIER({schema:t.result.algorithm}),this.subjectPublicKey=t.result.subjectPublicKey},e.org.pkijs.simpl.PUBLIC_KEY_INFO.prototype.toSchema=function(){return new e.org.pkijs.asn1.SEQUENCE({value:[this.algorithm.toSchema(),this.subjectPublicKey]})},e.org.pkijs.simpl.PUBLIC_KEY_INFO.prototype.importKey=function(i){var t=Promise.resolve(),s=this;if("undefined"==typeof i)return new Promise(function(e,i){i("Need to provide publicKey input parameter")});var r=e.org.pkijs.getCrypto();return"undefined"==typeof r?new Promise(function(e,i){i("Unable to create WebCrypto object")}):(t=t.then(function(){return r.exportKey("spki",i)}),t=t.then(function(i){var t=e.org.pkijs.fromBER(i);try{e.org.pkijs.simpl.PUBLIC_KEY_INFO.prototype.fromSchema.call(s,t.result)}catch(r){return new Promise(function(e,i){i("Error during initializing object from schema")})}},function(e){return new Promise(function(i,t){t("Error during exporting public key: "+e)})}))},e.org.pkijs.simpl.PUBLIC_KEY_INFO.prototype.toJSON=function(){return{algorithm:this.algorithm.toJSON(),subjectPublicKey:this.subjectPublicKey.toJSON()}},e.org.pkijs.simpl.ATTR_TYPE_AND_VALUE=function(){this.type="",this.value={},arguments[0]instanceof Object&&"schema"in arguments[0]?e.org.pkijs.simpl.ATTR_TYPE_AND_VALUE.prototype.fromSchema.call(this,arguments[0].schema):arguments[0]instanceof Object&&(this.type=arguments[0].type||"",this.value=arguments[0].value||{})},e.org.pkijs.simpl.ATTR_TYPE_AND_VALUE.prototype.fromSchema=function(i){var t=e.org.pkijs.compareSchema(i,i,e.org.pkijs.schema.ATTR_TYPE_AND_VALUE({names:{type:"type",value:"typeValue"}}));if(t.verified===!1)throw new Error("Object's schema was not verified against input data for ATTR_TYPE_AND_VALUE");this.type=t.result.type.value_block.toString(),this.value=t.result.typeValue},e.org.pkijs.simpl.ATTR_TYPE_AND_VALUE.prototype.toSchema=function(){return new e.org.pkijs.asn1.SEQUENCE({value:[new e.org.pkijs.asn1.OID({value:this.type}),this.value]})},e.org.pkijs.simpl.ATTR_TYPE_AND_VALUE.prototype.isEqual=function(){if(arguments[0]instanceof e.org.pkijs.simpl.ATTR_TYPE_AND_VALUE){if(this.type!==arguments[0].type)return!1;if(this.value instanceof e.org.pkijs.asn1.UTF8STRING&&arguments[0].value instanceof e.org.pkijs.asn1.UTF8STRING||this.value instanceof e.org.pkijs.asn1.BMPSTRING&&arguments[0].value instanceof e.org.pkijs.asn1.BMPSTRING||this.value instanceof e.org.pkijs.asn1.UNIVERSALSTRING&&arguments[0].value instanceof e.org.pkijs.asn1.UNIVERSALSTRING||this.value instanceof e.org.pkijs.asn1.NUMERICSTRING&&arguments[0].value instanceof e.org.pkijs.asn1.NUMERICSTRING||this.value instanceof e.org.pkijs.asn1.PRINTABLESTRING&&arguments[0].value instanceof e.org.pkijs.asn1.PRINTABLESTRING||this.value instanceof e.org.pkijs.asn1.TELETEXSTRING&&arguments[0].value instanceof e.org.pkijs.asn1.TELETEXSTRING||this.value instanceof e.org.pkijs.asn1.VIDEOTEXSTRING&&arguments[0].value instanceof e.org.pkijs.asn1.VIDEOTEXSTRING||this.value instanceof e.org.pkijs.asn1.IA5STRING&&arguments[0].value instanceof e.org.pkijs.asn1.IA5STRING||this.value instanceof e.org.pkijs.asn1.GRAPHICSTRING&&arguments[0].value instanceof e.org.pkijs.asn1.GRAPHICSTRING||this.value instanceof e.org.pkijs.asn1.VISIBLESTRING&&arguments[0].value instanceof e.org.pkijs.asn1.VISIBLESTRING||this.value instanceof e.org.pkijs.asn1.GENERALSTRING&&arguments[0].value instanceof e.org.pkijs.asn1.GENERALSTRING||this.value instanceof e.org.pkijs.asn1.CHARACTERSTRING&&arguments[0].value instanceof e.org.pkijs.asn1.CHARACTERSTRING){var i=e.org.pkijs.stringPrep(this.value.value_block.value),t=e.org.pkijs.stringPrep(arguments[0].value.value_block.value);if(0!==i.localeCompare(t))return!1}else if(e.org.pkijs.isEqual_buffer(this.value.value_before_decode,arguments[0].value.value_before_decode)===!1)return!1;return!0}return!1},e.org.pkijs.simpl.ATTR_TYPE_AND_VALUE.prototype.toJSON=function(){var e={type:this.type};return 0!==Object.keys(this.value).length?e.value=this.value.toJSON():e.value=this.value,e},e.org.pkijs.simpl.RDN=function(){this.types_and_values=new Array,this.value_before_decode=new ArrayBuffer(0),arguments[0]instanceof Object&&"schema"in arguments[0]?e.org.pkijs.simpl.RDN.prototype.fromSchema.call(this,arguments[0].schema):arguments[0]instanceof Object&&(this.types_and_values=arguments[0].types_and_values||new Array,this.value_before_decode=arguments[0].value_before_decode||new ArrayBuffer(0))},e.org.pkijs.simpl.RDN.prototype.fromSchema=function(i){var t=e.org.pkijs.compareSchema(i,i,e.org.pkijs.schema.RDN({names:{block_name:"RDN",repeated_set:"types_and_values"}}));if(t.verified===!1)throw new Error("Object's schema was not verified against input data for RDN");if("types_and_values"in t.result)for(var s=t.result.types_and_values,r=0;r<s.length;r++)this.types_and_values.push(new e.org.pkijs.simpl.ATTR_TYPE_AND_VALUE({schema:s[r]}));this.value_before_decode=t.result.RDN.value_before_decode},e.org.pkijs.simpl.RDN.prototype.toSchema=function(){if(0===this.value_before_decode.byteLength){for(var i=new Array,t=0;t<this.types_and_values.length;t++)i.push(this.types_and_values[t].toSchema());return new e.org.pkijs.asn1.SEQUENCE({value:[new e.org.pkijs.asn1.SET({value:i})]})}var s=e.org.pkijs.fromBER(this.value_before_decode);return s.result},e.org.pkijs.simpl.RDN.prototype.isEqual=function(){if(arguments[0]instanceof e.org.pkijs.simpl.RDN){if(this.types_and_values.length!=arguments[0].types_and_values.length)return!1;for(var i=0;i<this.types_and_values.length;i++)if(this.types_and_values[i].isEqual(arguments[0].types_and_values[i])===!1)return!1;return!0}return arguments[0]instanceof ArrayBuffer?e.org.pkijs.isEqual_buffer(this.value_before_decode,arguments[0]):!1},e.org.pkijs.simpl.RDN.prototype.toJSON=function(){for(var e={types_and_values:new Array},i=0;i<this.types_and_values.length;i++)e.types_and_values.push(this.types_and_values[i].toJSON());return e},e.org.pkijs.simpl.x509.AuthorityKeyIdentifier=function(){arguments[0]instanceof Object&&"schema"in arguments[0]?e.org.pkijs.simpl.x509.AuthorityKeyIdentifier.prototype.fromSchema.call(this,arguments[0].schema):arguments[0]instanceof Object&&("keyIdentifier"in arguments[0]&&(this.keyIdentifier=arguments[0].keyIdentifier),"authorityCertIssuer"in arguments[0]&&(this.authorityCertIssuer=arguments[0].authorityCertIssuer),"authorityCertSerialNumber"in arguments[0]&&(this.authorityCertSerialNumber=arguments[0].authorityCertSerialNumber))},e.org.pkijs.simpl.x509.AuthorityKeyIdentifier.prototype.fromSchema=function(i){var t=e.org.pkijs.compareSchema(i,i,e.org.pkijs.schema.x509.AuthorityKeyIdentifier({names:{keyIdentifier:"keyIdentifier",authorityCertIssuer:"authorityCertIssuer",authorityCertSerialNumber:"authorityCertSerialNumber"}}));if(t.verified===!1)throw new Error("Object's schema was not verified against input data for AuthorityKeyIdentifier");if("keyIdentifier"in t.result&&(t.result.keyIdentifier.id_block.tag_class=1,t.result.keyIdentifier.id_block.tag_number=4,this.keyIdentifier=t.result.keyIdentifier),"authorityCertIssuer"in t.result){this.authorityCertIssuer=new Array;for(var s=t.result.authorityCertIssuer,r=0;r<s.length;r++)this.authorityCertIssuer.push(new e.org.pkijs.simpl.GENERAL_NAME({schema:s[r]}))}"authorityCertSerialNumber"in t.result&&(t.result.authorityCertSerialNumber.id_block.tag_class=1,t.result.authorityCertSerialNumber.id_block.tag_number=2,this.authorityCertSerialNumber=t.result.authorityCertSerialNumber)},e.org.pkijs.simpl.x509.AuthorityKeyIdentifier.prototype.toSchema=function(){var i=new Array;if("keyIdentifier"in this){var t=this.keyIdentifier;t.id_block.tag_class=3,t.id_block.tag_number=0,i.push(t)}if("authorityCertIssuer"in this){for(var s=new Array,r=0;r<this.authorityCertIssuer.length;r++)s.push(this.authorityCertIssuer[r].toSchema());i.push(new e.org.pkijs.asn1.ASN1_CONSTRUCTED({optional:!0,id_block:{tag_class:3,tag_number:1},value:[new e.org.pkijs.asn1.SEQUENCE({value:s})]}))}if("authorityCertSerialNumber"in this){var t=this.authorityCertSerialNumber;t.id_block.tag_class=3,t.id_block.tag_number=2,i.push(t)}return new e.org.pkijs.asn1.SEQUENCE({value:i})},e.org.pkijs.simpl.x509.AuthorityKeyIdentifier.prototype.toJSON=function(){var e={};if("keyIdentifier"in this&&(e.keyIdentifier=this.keyIdentifier.toJSON()),"authorityCertIssuer"in this){e.authorityCertIssuer=new Array;for(var i=0;i<this.authorityCertIssuer.length;i++)e.authorityCertIssuer.push(this.authorityCertIssuer[i].toJSON())}return"authorityCertSerialNumber"in this&&(e.authorityCertSerialNumber=this.authorityCertSerialNumber.toJSON()),e},e.org.pkijs.simpl.x509.PrivateKeyUsagePeriod=function(){arguments[0]instanceof Object&&"schema"in arguments[0]?e.org.pkijs.simpl.x509.PrivateKeyUsagePeriod.prototype.fromSchema.call(this,arguments[0].schema):arguments[0]instanceof Object&&("notBefore"in arguments[0]&&(this.notBefore=arguments[0].notBefore),"notAfter"in arguments[0]&&(this.notAfter=arguments[0].notAfter))},e.org.pkijs.simpl.x509.PrivateKeyUsagePeriod.prototype.fromSchema=function(i){var t=e.org.pkijs.compareSchema(i,i,e.org.pkijs.schema.x509.PrivateKeyUsagePeriod({names:{notBefore:"notBefore",notAfter:"notAfter"}}));if(t.verified===!1)throw new Error("Object's schema was not verified against input data for PrivateKeyUsagePeriod");if("notBefore"in t.result){var s=new e.org.pkijs.asn1.GENERALIZEDTIME;s.fromBuffer(t.result.notBefore.value_block.value_hex),this.notBefore=s.toDate()}if("notAfter"in t.result){var r=new e.org.pkijs.asn1.GENERALIZEDTIME({value_hex:t.result.notAfter.value_block.value_hex});r.fromBuffer(t.result.notAfter.value_block.value_hex),this.notAfter=r.toDate()}},e.org.pkijs.simpl.x509.PrivateKeyUsagePeriod.prototype.toSchema=function(){var i=new Array;return"notBefore"in this&&i.push(new e.org.pkijs.asn1.ASN1_PRIMITIVE({id_block:{tag_class:3,tag_number:0},value_hex:new e.org.pkijs.asn1.GENERALIZEDTIME({value_date:this.notBefore}).value_block.value_hex})),"notAfter"in this&&i.push(new e.org.pkijs.asn1.ASN1_PRIMITIVE({id_block:{tag_class:3,tag_number:1},value_hex:new e.org.pkijs.asn1.GENERALIZEDTIME({value_date:this.notAfter}).value_block.value_hex})),new e.org.pkijs.asn1.SEQUENCE({value:i})},e.org.pkijs.simpl.x509.PrivateKeyUsagePeriod.prototype.toJSON=function(){var e={};return"notBefore"in this&&(e.notBefore=this.notBefore),"notAfter"in this&&(e.notAfter=this.notAfter),e},e.org.pkijs.simpl.x509.AltName=function(){this.altNames=new Array,arguments[0]instanceof Object&&"schema"in arguments[0]?e.org.pkijs.simpl.x509.AltName.prototype.fromSchema.call(this,arguments[0].schema):arguments[0]instanceof Object&&(this.altNames=arguments[0].altNames||new Array)},e.org.pkijs.simpl.x509.AltName.prototype.fromSchema=function(i){var t=e.org.pkijs.compareSchema(i,i,e.org.pkijs.schema.x509.AltName({names:{altNames:"altNames"}}));if(t.verified===!1)throw new Error("Object's schema was not verified against input data for AltName");if("altNames"in t.result)for(var s=t.result.altNames,r=0;r<s.length;r++)this.altNames.push(new e.org.pkijs.simpl.GENERAL_NAME({schema:s[r]}))},e.org.pkijs.simpl.x509.AltName.prototype.toSchema=function(){for(var i=new Array,t=0;t<this.altNames.length;t++)i.push(this.altNames[t].toSchema());return new e.org.pkijs.asn1.SEQUENCE({value:i})},e.org.pkijs.simpl.x509.AltName.prototype.toJSON=function(){for(var e={altNames:new Array},i=0;i<this.altNames.length;i++)e.altNames.push(this.altNames[i].toJSON());return e},e.org.pkijs.simpl.x509.SubjectDirectoryAttributes=function(){this.attributes=new Array,arguments[0]instanceof Object&&"schema"in arguments[0]?e.org.pkijs.simpl.x509.SubjectDirectoryAttributes.prototype.fromSchema.call(this,arguments[0].schema):arguments[0]instanceof Object&&(this.attributes=arguments[0].attributes||new Array)},e.org.pkijs.simpl.x509.SubjectDirectoryAttributes.prototype.fromSchema=function(i){var t=e.org.pkijs.compareSchema(i,i,e.org.pkijs.schema.x509.SubjectDirectoryAttributes({names:{attributes:"attributes"}}));if(t.verified===!1)throw new Error("Object's schema was not verified against input data for SubjectDirectoryAttributes");for(var s=t.result.attributes,r=0;r<s.length;r++)this.attributes.push(new e.org.pkijs.simpl.ATTRIBUTE({schema:s[r]}))},e.org.pkijs.simpl.x509.SubjectDirectoryAttributes.prototype.toSchema=function(){for(var i=new Array,t=0;t<this.attributes.length;t++)i.push(this.attributes[t].toSchema());return new e.org.pkijs.asn1.SEQUENCE({value:i})},e.org.pkijs.simpl.x509.SubjectDirectoryAttributes.prototype.toJSON=function(){for(var e={attributes:new Array},i=0;i<this.attributes.length;i++)e.attributes.push(this.attributes[i].toJSON());return e},e.org.pkijs.simpl.x509.PolicyMapping=function(){this.issuerDomainPolicy="",this.subjectDomainPolicy="",arguments[0]instanceof Object&&"schema"in arguments[0]?e.org.pkijs.simpl.x509.PolicyMapping.prototype.fromSchema.call(this,arguments[0].schema):arguments[0]instanceof Object&&(this.issuerDomainPolicy=arguments[0].issuerDomainPolicy||"",this.subjectDomainPolicy=arguments[0].subjectDomainPolicy||"")},e.org.pkijs.simpl.x509.PolicyMapping.prototype.fromSchema=function(i){var t=e.org.pkijs.compareSchema(i,i,e.org.pkijs.schema.x509.PolicyMapping({names:{issuerDomainPolicy:"issuerDomainPolicy",subjectDomainPolicy:"subjectDomainPolicy"}}));if(t.verified===!1)throw new Error("Object's schema was not verified against input data for PolicyMapping");this.issuerDomainPolicy=t.result.issuerDomainPolicy.value_block.toString(),this.subjectDomainPolicy=t.result.subjectDomainPolicy.value_block.toString()},e.org.pkijs.simpl.x509.PolicyMapping.prototype.toSchema=function(){return new e.org.pkijs.asn1.SEQUENCE({value:[new e.org.pkijs.asn1.OID({value:this.issuerDomainPolicy}),new e.org.pkijs.asn1.OID({value:this.subjectDomainPolicy})]})},e.org.pkijs.simpl.x509.PolicyMapping.prototype.toJSON=function(){return{issuerDomainPolicy:this.issuerDomainPolicy,subjectDomainPolicy:this.subjectDomainPolicy}},e.org.pkijs.simpl.x509.PolicyMappings=function(){this.mappings=new Array,arguments[0]instanceof Object&&"schema"in arguments[0]?e.org.pkijs.simpl.x509.PolicyMappings.prototype.fromSchema.call(this,arguments[0].schema):arguments[0]instanceof Object&&(this.mappings=arguments[0].mappings||new Array)},e.org.pkijs.simpl.x509.PolicyMappings.prototype.fromSchema=function(i){var t=e.org.pkijs.compareSchema(i,i,e.org.pkijs.schema.x509.PolicyMappings({names:{mappings:"mappings"}}));if(t.verified===!1)throw new Error("Object's schema was not verified against input data for PolicyMappings");for(var s=t.result.mappings,r=0;r<s.length;r++)this.mappings.push(new e.org.pkijs.simpl.x509.PolicyMapping({schema:s[r]}))},e.org.pkijs.simpl.x509.PolicyMappings.prototype.toSchema=function(){for(var i=new Array,t=0;t<this.mappings.length;t++)i.push(this.mappings.toSchema());return new e.org.pkijs.asn1.SEQUENCE({value:i})},e.org.pkijs.simpl.x509.PolicyMappings.prototype.toJSON=function(){for(var e={mappings:new Array},i=0;i<this.mappings.length;i++)e.mappings.push(this.mappings[i].toJSON());return e},e.org.pkijs.simpl.x509.GeneralSubtree=function(){this.base=new e.org.pkijs.simpl.GENERAL_NAME,arguments[0]instanceof Object&&"schema"in arguments[0]?e.org.pkijs.simpl.x509.GeneralSubtree.prototype.fromSchema.call(this,arguments[0].schema):arguments[0]instanceof Object&&(this.base=arguments[0].base||new e.org.pkijs.simpl.GENERAL_NAME,"minimum"in arguments[0]&&(this.minimum=arguments[0].minimum),"maximum"in arguments[0]&&(this.maximum=arguments[0].maximum))},e.org.pkijs.simpl.x509.GeneralSubtree.prototype.fromSchema=function(i){var t=e.org.pkijs.compareSchema(i,i,e.org.pkijs.schema.x509.GeneralSubtree({names:{base:{names:{block_name:"base"}},minimum:"minimum",maximum:"maximum"}}));if(t.verified===!1)throw new Error("Object's schema was not verified against input data for ");this.base=new e.org.pkijs.simpl.GENERAL_NAME({schema:t.result.base}),"minimum"in t.result&&(t.result.minimum.value_block.is_hex_only?this.minimum=t.result.minimum:this.minimum=t.result.minimum.value_block.value_dec),"maximum"in t.result&&(t.result.maximum.value_block.is_hex_only?this.maximum=t.result.maximum:this.maximum=t.result.maximum.value_block.value_dec)},e.org.pkijs.simpl.x509.GeneralSubtree.prototype.toSchema=function(){var i=new Array;if(i.push(this.base.toSchema()),"minimum"in this){var t=0;t=this.minimum instanceof e.org.pkijs.asn1.INTEGER?this.minimum:new e.org.pkijs.asn1.INTEGER({value:this.minimum}),i.push(new e.org.pkijs.asn1.ASN1_CONSTRUCTED({optional:!0,id_block:{tag_class:3,tag_number:0},value:[t]}))}if("maximum"in this){var s=0;s=this.maximum instanceof e.org.pkijs.asn1.INTEGER?this.maximum:new e.org.pkijs.asn1.INTEGER({value:this.maximum}),i.push(new e.org.pkijs.asn1.ASN1_CONSTRUCTED({optional:!0,id_block:{tag_class:3,tag_number:1},value:[s]}))}return new e.org.pkijs.asn1.SEQUENCE({value:i})},e.org.pkijs.simpl.x509.GeneralSubtree.prototype.toJSON=function(){var e={base:this.base.toJSON()};return"minimum"in this&&("number"==typeof this.minimum?e.minimum=this.minimum:e.minimum=this.minimum.toJSON()),"maximum"in this&&("number"==typeof this.maximum?e.maximum=this.maximum:e.maximum=this.maximum.toJSON()),e},e.org.pkijs.simpl.x509.NameConstraints=function(){arguments[0]instanceof Object&&"schema"in arguments[0]?e.org.pkijs.simpl.x509.NameConstraints.prototype.fromSchema.call(this,arguments[0].schema):arguments[0]instanceof Object&&("permittedSubtrees"in arguments[0]&&(this.permittedSubtrees=arguments[0].permittedSubtrees),"excludedSubtrees"in arguments[0]&&(this.excludedSubtrees=arguments[0].excludedSubtrees))},e.org.pkijs.simpl.x509.NameConstraints.prototype.fromSchema=function(i){var t=e.org.pkijs.compareSchema(i,i,e.org.pkijs.schema.x509.NameConstraints({names:{permittedSubtrees:"permittedSubtrees",excludedSubtrees:"excludedSubtrees"}}));if(t.verified===!1)throw new Error("Object's schema was not verified against input data for NameConstraints");if("permittedSubtrees"in t.result){this.permittedSubtrees=new Array;for(var s=t.result.permittedSubtrees,r=0;r<s.length;r++)this.permittedSubtrees.push(new e.org.pkijs.simpl.x509.GeneralSubtree({schema:s[r]}))}if("excludedSubtrees"in t.result){this.excludedSubtrees=new Array;for(var n=t.result.excludedSubtrees,r=0;r<n.length;r++)this.excludedSubtrees.push(new e.org.pkijs.simpl.x509.GeneralSubtree({schema:n[r]}))}},e.org.pkijs.simpl.x509.NameConstraints.prototype.toSchema=function(){var i=new Array;if("permittedSubtrees"in this){for(var t=new Array,s=0;s<this.permittedSubtrees.length;s++)t.push(this.permittedSubtrees[s].toSchema());
i.push(new e.org.pkijs.asn1.ASN1_CONSTRUCTED({optional:!0,id_block:{tag_class:3,tag_number:0},value:[new e.org.pkijs.asn1.SEQUENCE({value:t})]}))}if("excludedSubtrees"in this){for(var r=new Array,s=0;s<this.excludedSubtrees.length;s++)r.push(this.excludedSubtrees[s].toSchema());i.push(new e.org.pkijs.asn1.ASN1_CONSTRUCTED({optional:!0,id_block:{tag_class:3,tag_number:1},value:[new e.org.pkijs.asn1.SEQUENCE({value:r})]}))}return new e.org.pkijs.asn1.SEQUENCE({value:i})},e.org.pkijs.simpl.x509.NameConstraints.prototype.toJSON=function(){var e={};if("permittedSubtrees"in this){e.permittedSubtrees=new Array;for(var i=0;i<this.permittedSubtrees.length;i++)e.permittedSubtrees.push(this.permittedSubtrees[i].toJSON())}if("excludedSubtrees"in this){e.excludedSubtrees=new Array;for(var i=0;i<this.excludedSubtrees.length;i++)e.excludedSubtrees.push(this.excludedSubtrees[i].toJSON())}return e},e.org.pkijs.simpl.x509.BasicConstraints=function(){arguments[0]instanceof Object&&"schema"in arguments[0]?e.org.pkijs.simpl.x509.BasicConstraints.prototype.fromSchema.call(this,arguments[0].schema):arguments[0]instanceof Object&&("cA"in arguments[0]&&(this.cA=arguments[0].cA),"pathLenConstraint"in arguments[0]&&(this.pathLenConstraint=arguments[0].pathLenConstraint))},e.org.pkijs.simpl.x509.BasicConstraints.prototype.fromSchema=function(i){var t=e.org.pkijs.compareSchema(i,i,e.org.pkijs.schema.x509.BasicConstraints({names:{cA:"cA",pathLenConstraint:"pathLenConstraint"}}));if(t.verified===!1)throw new Error("Object's schema was not verified against input data for BasicConstraints");"cA"in t.result&&(this.cA=t.result.cA.value_block.value),"pathLenConstraint"in t.result&&(this.pathLenConstraint=t.result.pathLenConstraint.value_block.value_dec)},e.org.pkijs.simpl.x509.BasicConstraints.prototype.toSchema=function(){var i=new Array;return"cA"in this&&i.push(new e.org.pkijs.asn1.BOOLEAN({value:this.cA})),"pathLenConstraint"in this&&i.push(new e.org.pkijs.asn1.INTEGER({value:this.pathLenConstraint})),new e.org.pkijs.asn1.SEQUENCE({value:i})},e.org.pkijs.simpl.x509.BasicConstraints.prototype.toJSON=function(){var e={};return"cA"in this&&(e.cA=this.cA),"pathLenConstraint"in this&&(e.pathLenConstraint=this.pathLenConstraint),e},e.org.pkijs.simpl.x509.PolicyQualifierInfo=function(){this.policyQualifierId="",this.qualifier=new e.org.pkijs.asn1.ANY,arguments[0]instanceof Object&&"schema"in arguments[0]?e.org.pkijs.simpl.x509.PolicyQualifierInfo.prototype.fromSchema.call(this,arguments[0].schema):arguments[0]instanceof Object&&(this.policyQualifierId=arguments[0].policyQualifierId||"",this.qualifier=arguments[0].qualifier||new e.org.pkijs.asn1.ANY)},e.org.pkijs.simpl.x509.PolicyQualifierInfo.prototype.fromSchema=function(i){var t=e.org.pkijs.compareSchema(i,i,e.org.pkijs.schema.x509.PolicyQualifierInfo({names:{policyQualifierId:"policyQualifierId",qualifier:"qualifier"}}));if(t.verified===!1)throw new Error("Object's schema was not verified against input data for PolicyQualifierInfo");this.policyQualifierId=t.result.policyQualifierId.value_block.toString(),this.qualifier=t.result.qualifier},e.org.pkijs.simpl.x509.PolicyQualifierInfo.prototype.toSchema=function(){return new e.org.pkijs.asn1.SEQUENCE({value:[new e.org.pkijs.asn1.OID({value:this.policyQualifierId}),this.qualifier]})},e.org.pkijs.simpl.x509.PolicyQualifierInfo.prototype.toJSON=function(){return{policyQualifierId:this.policyQualifierId,qualifier:this.qualifier.toJSON()}},e.org.pkijs.simpl.x509.PolicyInformation=function(){this.policyIdentifier="",arguments[0]instanceof Object&&"schema"in arguments[0]?e.org.pkijs.simpl.x509.PolicyInformation.prototype.fromSchema.call(this,arguments[0].schema):arguments[0]instanceof Object&&(this.policyIdentifier=arguments[0].policyIdentifier||"","policyQualifiers"in arguments[0]&&(this.policyQualifiers=arguments[0].policyQualifiers))},e.org.pkijs.simpl.x509.PolicyInformation.prototype.fromSchema=function(i){var t=e.org.pkijs.compareSchema(i,i,e.org.pkijs.schema.x509.PolicyInformation({names:{policyIdentifier:"policyIdentifier",policyQualifiers:"policyQualifiers"}}));if(t.verified===!1)throw new Error("Object's schema was not verified against input data for PolicyInformation");if(this.policyIdentifier=t.result.policyIdentifier.value_block.toString(),"policyQualifiers"in t.result){this.policyQualifiers=new Array;for(var s=t.result.policyQualifiers,r=0;r<s.length;r++)this.policyQualifiers.push(new e.org.pkijs.simpl.x509.PolicyQualifierInfo({schema:s[r]}))}},e.org.pkijs.simpl.x509.PolicyInformation.prototype.toSchema=function(){var i=new Array;if(i.push(new e.org.pkijs.asn1.OID({value:this.policyIdentifier})),"policyQualifiers"in this){for(var t=new Array,s=0;s<this.policyQualifiers.length;s++)t.push(this.policyQualifiers[s].toSchema());i.push(new e.org.pkijs.asn1.SEQUENCE({value:t}))}return new e.org.pkijs.asn1.SEQUENCE({value:i})},e.org.pkijs.simpl.x509.PolicyInformation.prototype.toJSON=function(){var e={policyIdentifier:this.policyIdentifier};if("policyQualifiers"in this){e.policyQualifiers=new Array;for(var i=0;i<this.policyQualifiers.length;i++)e.policyQualifiers.push(this.policyQualifiers[i].toJSON())}return e},e.org.pkijs.simpl.x509.CertificatePolicies=function(){this.certificatePolicies=new Array,arguments[0]instanceof Object&&"schema"in arguments[0]?e.org.pkijs.simpl.x509.CertificatePolicies.prototype.fromSchema.call(this,arguments[0].schema):arguments[0]instanceof Object&&(this.certificatePolicies=arguments[0].certificatePolicies||new Array)},e.org.pkijs.simpl.x509.CertificatePolicies.prototype.fromSchema=function(i){var t=e.org.pkijs.compareSchema(i,i,e.org.pkijs.schema.x509.CertificatePolicies({names:{certificatePolicies:"certificatePolicies"}}));if(t.verified===!1)throw new Error("Object's schema was not verified against input data for CertificatePolicies");for(var s=t.result.certificatePolicies,r=0;r<s.length;r++)this.certificatePolicies.push(new e.org.pkijs.simpl.x509.PolicyInformation({schema:s[r]}))},e.org.pkijs.simpl.x509.CertificatePolicies.prototype.toSchema=function(){for(var i=new Array,t=0;t<this.certificatePolicies.length;t++)i.push(this.certificatePolicies[t].toSchema());return new e.org.pkijs.asn1.SEQUENCE({value:i})},e.org.pkijs.simpl.x509.CertificatePolicies.prototype.toJSON=function(){for(var e={certificatePolicies:new Array},i=0;i<this.certificatePolicies.length;i++)e.certificatePolicies.push(this.certificatePolicies[i].toJSON());return e},e.org.pkijs.simpl.x509.PolicyConstraints=function(){arguments[0]instanceof Object&&"schema"in arguments[0]?e.org.pkijs.simpl.x509.PolicyConstraints.prototype.fromSchema.call(this,arguments[0].schema):arguments[0]instanceof Object&&(this.requireExplicitPolicy=arguments[0].requireExplicitPolicy||0,this.inhibitPolicyMapping=arguments[0].inhibitPolicyMapping||0)},e.org.pkijs.simpl.x509.PolicyConstraints.prototype.fromSchema=function(i){var t=e.org.pkijs.compareSchema(i,i,e.org.pkijs.schema.x509.PolicyConstraints({names:{requireExplicitPolicy:"requireExplicitPolicy",inhibitPolicyMapping:"inhibitPolicyMapping"}}));if(t.verified===!1)throw new Error("Object's schema was not verified against input data for PolicyConstraints");if("requireExplicitPolicy"in t.result){var s=t.result.requireExplicitPolicy;s.id_block.tag_class=1,s.id_block.tag_number=2;var r=s.toBER(!1),n=e.org.pkijs.fromBER(r);this.requireExplicitPolicy=n.result.value_block.value_dec}if("inhibitPolicyMapping"in t.result){var o=t.result.inhibitPolicyMapping;o.id_block.tag_class=1,o.id_block.tag_number=2;var a=o.toBER(!1),u=e.org.pkijs.fromBER(a);this.inhibitPolicyMapping=u.result.value_block.value_dec}},e.org.pkijs.simpl.x509.PolicyConstraints.prototype.toSchema=function(){var i=new Array;if("requireExplicitPolicy"in this){var t=new e.org.pkijs.asn1.INTEGER({value:this.requireExplicitPolicy});t.id_block.tag_class=3,t.id_block.tag_number=0,i.push(t)}if("inhibitPolicyMapping"in this){var s=new e.org.pkijs.asn1.INTEGER({value:this.inhibitPolicyMapping});t.id_block.tag_class=3,t.id_block.tag_number=1,i.push(s)}return new e.org.pkijs.asn1.SEQUENCE({value:i})},e.org.pkijs.simpl.x509.PolicyConstraints.prototype.toJSON=function(){var e={};return"requireExplicitPolicy"in this&&(e.requireExplicitPolicy=this.requireExplicitPolicy),"inhibitPolicyMapping"in this&&(e.inhibitPolicyMapping=this.inhibitPolicyMapping),e},e.org.pkijs.simpl.x509.ExtKeyUsage=function(){this.keyPurposes=new Array,arguments[0]instanceof Object&&"schema"in arguments[0]?e.org.pkijs.simpl.x509.ExtKeyUsage.prototype.fromSchema.call(this,arguments[0].schema):arguments[0]instanceof Object&&(this.keyPurposes=arguments[0].keyPurposes||new Array)},e.org.pkijs.simpl.x509.ExtKeyUsage.prototype.fromSchema=function(i){var t=e.org.pkijs.compareSchema(i,i,e.org.pkijs.schema.x509.ExtKeyUsage({names:{keyPurposes:"keyPurposes"}}));if(t.verified===!1)throw new Error("Object's schema was not verified against input data for ExtKeyUsage");for(var s=t.result.keyPurposes,r=0;r<s.length;r++)this.keyPurposes.push(s[r].value_block.toString())},e.org.pkijs.simpl.x509.ExtKeyUsage.prototype.toSchema=function(){for(var i=new Array,t=0;t<this.keyPurposes.length;t++)i.push(new e.org.pkijs.asn1.OID({value:this.keyPurposes[t]}));return new e.org.pkijs.asn1.SEQUENCE({value:i})},e.org.pkijs.simpl.x509.ExtKeyUsage.prototype.toJSON=function(){for(var e={keyPurposes:new Array},i=0;i<this.keyPurposes.length;i++)e.keyPurposes.push(this.keyPurposes[i]);return e},e.org.pkijs.simpl.x509.DistributionPoint=function(){arguments[0]instanceof Object&&"schema"in arguments[0]?e.org.pkijs.simpl.x509.DistributionPoint.prototype.fromSchema.call(this,arguments[0].schema):arguments[0]instanceof Object&&("distributionPoint"in arguments[0]&&(this.distributionPoint=arguments[0].distributionPoint),"reasons"in arguments[0]&&(this.reasons=arguments[0].reasons),"cRLIssuer"in arguments[0]&&(this.cRLIssuer=arguments[0].cRLIssuer))},e.org.pkijs.simpl.x509.DistributionPoint.prototype.fromSchema=function(i){var t=e.org.pkijs.compareSchema(i,i,e.org.pkijs.schema.x509.DistributionPoint({names:{distributionPoint:"distributionPoint",distributionPoint_names:"distributionPoint_names",reasons:"reasons",cRLIssuer:"cRLIssuer",cRLIssuer_names:"cRLIssuer_names"}}));if(t.verified===!1)throw new Error("Object's schema was not verified against input data for DistributionPoint");if("distributionPoint"in t.result){if(0==t.result.distributionPoint.id_block.tag_number){this.distributionPoint=new Array;for(var s=t.result.distributionPoint_names,r=0;r<s.length;r++)this.distributionPoint.push(new e.org.pkijs.simpl.GENERAL_NAME({schema:s[r]}))}1==t.result.distributionPoint.id_block.tag_number&&(t.result.distributionPoint.id_block.tag_class=1,t.result.distributionPoint.id_block.tag_number=16,this.distributionPoint=new e.org.pkijs.simpl.RDN({schema:t.result.distributionPoint}))}if("reasons"in t.result&&(this.reasons=new e.org.pkijs.asn1.BITSTRING({value_hex:t.result.reasons.value_block.value_hex})),"cRLIssuer"in t.result){this.cRLIssuer=new Array;for(var n=t.result.cRLIssuer_names,r=0;n>r;r++)this.cRLIssuer.push(new e.org.pkijs.simpl.GENERAL_NAME({schema:n[r]}))}},e.org.pkijs.simpl.x509.DistributionPoint.prototype.toSchema=function(){var i=new Array;if("distributionPoint"in this){var t;if(this.distributionPoint instanceof Array){t=new e.org.pkijs.asn1.ASN1_CONSTRUCTED({id_block:{tag_class:3,tag_number:0}});for(var s=0;s<this.distributionPoint.length;s++)t.value_block.value.push(this.distributionPoint[s].toSchema())}else t=this.distributionPoint.toSchema(),t.id_block.tag_class=3,t.id_block.tag_number=1;i.push(t)}if("reasons"in this&&i.push(new e.org.pkijs.asn1.ASN1_PRIMITIVE({id_block:{tag_class:3,tag_number:1},value_hex:this.reasons.value_block.value_hex})),"cRLIssuer"in this){for(var t=new e.org.pkijs.asn1.ASN1_CONSTRUCTED({name:names.cRLIssuer||"",optional:!0,id_block:{tag_class:3,tag_number:2}}),s=0;s<this.cRLIssuer.length;s++)t.value_block.value.push(this.cRLIssuer[s].toSchema());i.push(t)}return new e.org.pkijs.asn1.SEQUENCE({value:i})},e.org.pkijs.simpl.x509.DistributionPoint.prototype.toJSON=function(){var e={};if("distributionPoint"in this)if(this.distributionPoint instanceof Array){e.distributionPoint=new Array;for(var i=0;i<this.distributionPoint.length;i++)e.distributionPoint.push(this.distributionPoint[i].toJSON())}else e.distributionPoint=this.distributionPoint.toJSON();if("reasons"in this&&(e.reasons=this.reasons.toJSON()),"cRLIssuer"in this){e.cRLIssuer=new Array;for(var i=0;i<this.cRLIssuer.length;i++)e.cRLIssuer.push(this.cRLIssuer[i].toJSON())}return e},e.org.pkijs.simpl.x509.CRLDistributionPoints=function(){this.distributionPoints=new Array,arguments[0]instanceof Object&&"schema"in arguments[0]?e.org.pkijs.simpl.x509.CRLDistributionPoints.prototype.fromSchema.call(this,arguments[0].schema):arguments[0]instanceof Object&&(this.distributionPoints=arguments[0].distributionPoints||new Array)},e.org.pkijs.simpl.x509.CRLDistributionPoints.prototype.fromSchema=function(i){var t=e.org.pkijs.compareSchema(i,i,e.org.pkijs.schema.x509.CRLDistributionPoints({names:{distributionPoints:"distributionPoints"}}));if(t.verified===!1)throw new Error("Object's schema was not verified against input data for CRLDistributionPoints");for(var s=t.result.distributionPoints,r=0;r<s.length;r++)this.distributionPoints.push(new e.org.pkijs.simpl.x509.DistributionPoint({schema:s[r]}))},e.org.pkijs.simpl.x509.CRLDistributionPoints.prototype.toSchema=function(){for(var i=new Array,t=0;t<this.distributionPoints.length;t++)i.push(this.distributionPoints[t].toSchema());return new e.org.pkijs.asn1.SEQUENCE({value:i})},e.org.pkijs.simpl.x509.CRLDistributionPoints.prototype.toJSON=function(){for(var e={distributionPoints:new Array},i=0;i<this.distributionPoints.length;i++)e.distributionPoints.push(this.distributionPoints[i].toJSON());return e},e.org.pkijs.simpl.x509.AccessDescription=function(){this.accessMethod="",this.accessLocation=new e.org.pkijs.simpl.GENERAL_NAME,arguments[0]instanceof Object&&"schema"in arguments[0]?e.org.pkijs.simpl.x509.AccessDescription.prototype.fromSchema.call(this,arguments[0].schema):arguments[0]instanceof Object&&(this.accessMethod=arguments[0].accessMethod||"",this.accessLocation=arguments[0].accessLocation||new e.org.pkijs.simpl.GENERAL_NAME)},e.org.pkijs.simpl.x509.AccessDescription.prototype.fromSchema=function(i){var t=e.org.pkijs.compareSchema(i,i,e.org.pkijs.schema.x509.AccessDescription({names:{accessMethod:"accessMethod",accessLocation:{names:{block_name:"accessLocation"}}}}));if(t.verified===!1)throw new Error("Object's schema was not verified against input data for AccessDescription");this.accessMethod=t.result.accessMethod.value_block.toString(),this.accessLocation=new e.org.pkijs.simpl.GENERAL_NAME({schema:t.result.accessLocation})},e.org.pkijs.simpl.x509.AccessDescription.prototype.toSchema=function(){return new e.org.pkijs.asn1.SEQUENCE({value:[new e.org.pkijs.asn1.OID({value:this.accessMethod}),this.accessLocation.toSchema()]})},e.org.pkijs.simpl.x509.AccessDescription.prototype.toJSON=function(){return{accessMethod:this.accessMethod,accessLocation:this.accessLocation.toJSON()}},e.org.pkijs.simpl.x509.InfoAccess=function(){this.accessDescriptions=new Array,arguments[0]instanceof Object&&"schema"in arguments[0]?e.org.pkijs.simpl.x509.InfoAccess.prototype.fromSchema.call(this,arguments[0].schema):arguments[0]instanceof Object&&(this.accessDescriptions=arguments[0].accessDescriptions||new Array)},e.org.pkijs.simpl.x509.InfoAccess.prototype.fromSchema=function(i){var t=e.org.pkijs.compareSchema(i,i,e.org.pkijs.schema.x509.InfoAccess({names:{accessDescriptions:"accessDescriptions"}}));if(t.verified===!1)throw new Error("Object's schema was not verified against input data for InfoAccess");for(var s=t.result.accessDescriptions,r=0;r<s.length;r++)this.accessDescriptions.push(new e.org.pkijs.simpl.x509.AccessDescription({schema:s[r]}))},e.org.pkijs.simpl.x509.InfoAccess.prototype.toSchema=function(){for(var i=new Array,t=0;t<this.accessDescriptions.length;t++)i.push(this.accessDescriptions[t].toSchema());return new e.org.pkijs.asn1.SEQUENCE({value:i})},e.org.pkijs.simpl.x509.InfoAccess.prototype.toJSON=function(){for(var e={accessDescriptions:new Array},i=0;i<this.accessDescriptions.length;i++)e.accessDescriptions.push(this.accessDescriptions[i].toJSON());return e},e.org.pkijs.simpl.x509.IssuingDistributionPoint=function(){arguments[0]instanceof Object&&"schema"in arguments[0]?e.org.pkijs.simpl.x509.IssuingDistributionPoint.prototype.fromSchema.call(this,arguments[0].schema):arguments[0]instanceof Object&&("distributionPoint"in arguments[0]&&(this.distributionPoint=arguments[0].distributionPoint),"onlyContainsUserCerts"in arguments[0]&&(this.onlyContainsUserCerts=arguments[0].onlyContainsUserCerts),"onlyContainsCACerts"in arguments[0]&&(this.onlyContainsCACerts=arguments[0].onlyContainsCACerts),"onlySomeReasons"in arguments[0]&&(this.onlySomeReasons=arguments[0].onlySomeReasons),"indirectCRL"in arguments[0]&&(this.indirectCRL=arguments[0].indirectCRL),"onlyContainsAttributeCerts"in arguments[0]&&(this.onlyContainsAttributeCerts=arguments[0].onlyContainsAttributeCerts))},e.org.pkijs.simpl.x509.IssuingDistributionPoint.prototype.fromSchema=function(i){var t=e.org.pkijs.compareSchema(i,i,e.org.pkijs.schema.x509.IssuingDistributionPoint({names:{distributionPoint:"distributionPoint",onlyContainsUserCerts:"onlyContainsUserCerts",onlyContainsCACerts:"onlyContainsCACerts",onlySomeReasons:"onlySomeReasons",indirectCRL:"indirectCRL",onlyContainsAttributeCerts:"onlyContainsAttributeCerts"}}));if(t.verified===!1)throw new Error("Object's schema was not verified against input data for IssuingDistributionPoint");if("distributionPoint"in t.result){if(0==t.result.distributionPoint.id_block.tag_number){this.distributionPoint=new Array;for(var s=t.result.distributionPoint_names,r=0;r<s.length;r++)this.distributionPoint.push(new e.org.pkijs.simpl.GENERAL_NAME({schema:s[r]}))}1==t.result.distributionPoint.id_block.tag_number&&(t.result.distributionPoint.id_block.tag_class=1,t.result.distributionPoint.id_block.tag_number=16,this.distributionPoint=new e.org.pkijs.simpl.RDN({schema:t.result.distributionPoint}))}if("onlyContainsUserCerts"in t.result){var n=new Uint8Array(t.result.onlyContainsUserCerts.value_block.value_hex);this.onlyContainsUserCerts=0!==n[0]}if("onlyContainsCACerts"in t.result){var n=new Uint8Array(t.result.onlyContainsCACerts.value_block.value_hex);this.onlyContainsCACerts=0!==n[0]}if("onlySomeReasons"in t.result){var n=new Uint8Array(t.result.onlySomeReasons.value_block.value_hex);this.onlySomeReasons=n[0]}if("indirectCRL"in t.result){var n=new Uint8Array(t.result.indirectCRL.value_block.value_hex);this.indirectCRL=0!==n[0]}if("onlyContainsAttributeCerts"in t.result){var n=new Uint8Array(t.result.onlyContainsAttributeCerts.value_block.value_hex);this.onlyContainsAttributeCerts=0!==n[0]}},e.org.pkijs.simpl.x509.IssuingDistributionPoint.prototype.toSchema=function(){var i=new Array;if("distributionPoint"in this){var t;if(this.distributionPoint instanceof Array){t=new e.org.pkijs.asn1.ASN1_CONSTRUCTED({id_block:{tag_class:3,tag_number:0}});for(var s=0;s<this.distributionPoint.length;s++)t.value_block.value.push(this.distributionPoint[s].toSchema())}else t=this.distributionPoint.toSchema(),t.id_block.tag_class=3,t.id_block.tag_number=1;i.push(t)}if("onlyContainsUserCerts"in this){var r=new ArrayBuffer(1),n=new Uint8Array(r);n[0]=this.onlyContainsUserCerts===!1?0:255,i.push(new e.org.pkijs.asn1.ASN1_PRIMITIVE({name:names.onlyContainsUserCerts||"",optional:!0,id_block:{tag_class:3,tag_number:1},value_hex:r}))}if("onlyContainsCACerts"in this){var r=new ArrayBuffer(1),n=new Uint8Array(r);n[0]=this.onlyContainsCACerts===!1?0:255,i.push(new e.org.pkijs.asn1.ASN1_PRIMITIVE({name:names.onlyContainsUserCerts||"",optional:!0,id_block:{tag_class:3,tag_number:2},value_hex:r}))}if("onlySomeReasons"in this){var r=new ArrayBuffer(1),n=new Uint8Array(r);n[0]=this.onlySomeReasons,i.push(new e.org.pkijs.asn1.ASN1_PRIMITIVE({name:names.onlyContainsUserCerts||"",optional:!0,id_block:{tag_class:3,tag_number:3},value_hex:r}))}if("indirectCRL"in this){var r=new ArrayBuffer(1),n=new Uint8Array(r);n[0]=this.indirectCRL===!1?0:255,i.push(new e.org.pkijs.asn1.ASN1_PRIMITIVE({name:names.onlyContainsUserCerts||"",optional:!0,id_block:{tag_class:3,tag_number:4},value_hex:r}))}if("onlyContainsAttributeCerts"in this){var r=new ArrayBuffer(1),n=new Uint8Array(r);n[0]=this.onlyContainsAttributeCerts===!1?0:255,i.push(new e.org.pkijs.asn1.ASN1_PRIMITIVE({name:names.onlyContainsUserCerts||"",optional:!0,id_block:{tag_class:3,tag_number:5},value_hex:r}))}return new e.org.pkijs.asn1.SEQUENCE({value:i})},e.org.pkijs.simpl.x509.IssuingDistributionPoint.prototype.toJSON=function(){var e={};if("distributionPoint"in this)if(this.distributionPoint instanceof Array){e.distributionPoint=new Array;for(var i=0;i<this.distributionPoint.length;i++)e.distributionPoint.push(this.distributionPoint[i].toJSON())}else e.distributionPoint=this.distributionPoint.toJSON();return"onlyContainsUserCerts"in this&&(e.onlyContainsUserCerts=this.onlyContainsUserCerts),"onlyContainsCACerts"in this&&(e.onlyContainsCACerts=this.onlyContainsCACerts),"onlySomeReasons"in this&&(e.onlySomeReasons=this.onlySomeReasons.toJSON()),"indirectCRL"in this&&(e.indirectCRL=this.indirectCRL),"onlyContainsAttributeCerts"in this&&(e.onlyContainsAttributeCerts=this.onlyContainsAttributeCerts),e},e.org.pkijs.simpl.EXTENSION=function(){this.extnID="",this.critical=!1,this.extnValue=new e.org.pkijs.asn1.OCTETSTRING,arguments[0]instanceof Object&&"schema"in arguments[0]?e.org.pkijs.simpl.EXTENSION.prototype.fromSchema.call(this,arguments[0].schema):arguments[0]instanceof Object&&(this.extnID=arguments[0].extnID||"",this.critical=arguments[0].critical||!1,"extnValue"in arguments[0]?this.extnValue=new e.org.pkijs.asn1.OCTETSTRING({value_hex:arguments[0].extnValue}):this.extnValue=new e.org.pkijs.asn1.OCTETSTRING,"parsedValue"in arguments[0]&&(this.parsedValue=arguments[0].parsedValue))},e.org.pkijs.simpl.EXTENSION.prototype.fromSchema=function(i){var t=e.org.pkijs.compareSchema(i,i,e.org.pkijs.schema.EXTENSION({names:{extnID:"extnID",critical:"critical",extnValue:"extnValue"}}));if(t.verified===!1)throw new Error("Object's schema was not verified against input data for EXTENSION");this.extnID=t.result.extnID.value_block.toString(),"critical"in t.result&&(this.critical=t.result.critical.value_block.value),this.extnValue=t.result.extnValue;var t=e.org.pkijs.fromBER(this.extnValue.value_block.value_hex);if(-1!==t.offset)switch(this.extnID){case"2.5.29.9":this.parsedValue=new e.org.pkijs.simpl.x509.SubjectDirectoryAttributes({schema:t.result});break;case"2.5.29.14":this.parsedValue=t.result;break;case"2.5.29.15":this.parsedValue=t.result;break;case"2.5.29.16":this.parsedValue=new e.org.pkijs.simpl.x509.PrivateKeyUsagePeriod({schema:t.result});break;case"2.5.29.17":case"2.5.29.18":this.parsedValue=new e.org.pkijs.simpl.x509.AltName({schema:t.result});break;case"2.5.29.19":this.parsedValue=new e.org.pkijs.simpl.x509.BasicConstraints({schema:t.result});break;case"2.5.29.20":case"2.5.29.27":this.parsedValue=t.result;break;case"2.5.29.21":this.parsedValue=t.result;break;case"2.5.29.24":this.parsedValue=t.result;break;case"2.5.29.28":this.parsedValue=new e.org.pkijs.simpl.x509.IssuingDistributionPoint({schema:t.result});break;case"2.5.29.29":this.parsedValue=new e.org.pkijs.simpl.GENERAL_NAMES({schema:t.result});break;case"2.5.29.30":this.parsedValue=new e.org.pkijs.simpl.x509.NameConstraints({schema:t.result});break;case"2.5.29.31":case"2.5.29.46":this.parsedValue=new e.org.pkijs.simpl.x509.CRLDistributionPoints({schema:t.result});break;case"2.5.29.32":this.parsedValue=new e.org.pkijs.simpl.x509.CertificatePolicies({schema:t.result});break;case"2.5.29.33":this.parsedValue=new e.org.pkijs.simpl.x509.PolicyMappings({schema:t.result});break;case"2.5.29.35":this.parsedValue=new e.org.pkijs.simpl.x509.AuthorityKeyIdentifier({schema:t.result});break;case"2.5.29.36":this.parsedValue=new e.org.pkijs.simpl.x509.PolicyConstraints({schema:t.result});break;case"2.5.29.37":this.parsedValue=new e.org.pkijs.simpl.x509.ExtKeyUsage({schema:t.result});break;case"2.5.29.54":this.parsedValue=t.result;break;case"1.3.6.1.5.5.7.1.1":case"1.3.6.1.5.5.7.1.11":this.parsedValue=new e.org.pkijs.simpl.x509.InfoAccess({schema:t.result})}},e.org.pkijs.simpl.EXTENSION.prototype.toSchema=function(){return new e.org.pkijs.asn1.SEQUENCE({value:[new e.org.pkijs.asn1.OID({value:this.extnID}),new e.org.pkijs.asn1.BOOLEAN({value:this.critical}),this.extnValue]})},e.org.pkijs.simpl.EXTENSION.prototype.toJSON=function(){var e={extnID:this.extnID,critical:this.critical,extnValue:this.extnValue.toJSON()};return"parsedValue"in this&&(e.parsedValue=this.parsedValue.toJSON()),e},e.org.pkijs.simpl.EXTENSIONS=function(){this.extensions_array=new Array,arguments[0]instanceof Object&&"schema"in arguments[0]?e.org.pkijs.simpl.EXTENSIONS.prototype.fromSchema.call(this,arguments[0].schema):arguments[0]instanceof Object&&(this.extensions_array=arguments[0].extensions_array||new Array)},e.org.pkijs.simpl.EXTENSIONS.prototype.fromSchema=function(i){var t=e.org.pkijs.compareSchema(i,i,e.org.pkijs.schema.EXTENSIONS({names:{extensions:"extensions"}}));if(t.verified===!1)throw new Error("Object's schema was not verified against input data for EXTENSIONS");for(var s=0;s<t.result.extensions.length;s++)this.extensions_array.push(new e.org.pkijs.simpl.EXTENSION({schema:t.result.extensions[s]}))},e.org.pkijs.simpl.EXTENSIONS.prototype.toSchema=function(){for(var i=new Array,t=0;t<this.extensions_array.length;t++)i.push(this.extensions_array.toSchema());return new e.org.pkijs.asn1.SEQUENCE({value:i})},e.org.pkijs.simpl.EXTENSIONS.prototype.toJSON=function(){for(var e={extensions_array:new Array},i=0;i<this.extensions_array.length;i++)e.extensions_array.push(this.extensions_array[i].toJSON());return e},e.org.pkijs.simpl.CERT=function(){this.tbs=new ArrayBuffer(0),this.serialNumber=new e.org.pkijs.asn1.INTEGER,this.signature=new e.org.pkijs.simpl.ALGORITHM_IDENTIFIER,this.issuer=new e.org.pkijs.simpl.RDN,this.notBefore=new e.org.pkijs.simpl.TIME,this.notAfter=new e.org.pkijs.simpl.TIME,this.subject=new e.org.pkijs.simpl.RDN,this.subjectPublicKeyInfo=new e.org.pkijs.simpl.PUBLIC_KEY_INFO,this.signatureAlgorithm=new e.org.pkijs.simpl.ALGORITHM_IDENTIFIER,this.signatureValue=new e.org.pkijs.asn1.BITSTRING,arguments[0]instanceof Object&&"schema"in arguments[0]?e.org.pkijs.simpl.CERT.prototype.fromSchema.call(this,arguments[0].schema):arguments[0]instanceof Object&&(this.tbs=arguments[0].tbs||new ArrayBuffer(0),"version"in arguments[0]&&(this.version=arguments[0].version),this.serialNumber=arguments[0].serialNumber||new e.org.pkijs.asn1.INTEGER,this.signature=arguments[0].signature||new e.org.pkijs.simpl.ALGORITHM_IDENTIFIER,this.issuer=arguments[0].issuer||new e.org.pkijs.simpl.RDN,this.notBefore=arguments[0].not_before||new e.org.pkijs.simpl.TIME,this.notAfter=arguments[0].not_after||new e.org.pkijs.simpl.TIME,this.subject=arguments[0].subject||new e.org.pkijs.simpl.RDN,this.subjectPublicKeyInfo=arguments[0].subjectPublicKeyInfo||new e.org.pkijs.simpl.PUBLIC_KEY_INFO,"issuerUniqueID"in arguments[0]&&(this.issuerUniqueID=arguments[0].issuerUniqueID),"subjectUniqueID"in arguments[0]&&(this.subjectUniqueID=arguments[0].subjectUniqueID),"extensions"in arguments[0]&&(this.extensions=arguments[0].extensions),this.signatureAlgorithm=new e.org.pkijs.simpl.ALGORITHM_IDENTIFIER,this.signatureValue=new e.org.pkijs.asn1.BITSTRING)},e.org.pkijs.simpl.CERT.prototype.fromSchema=function(i){var t=e.org.pkijs.compareSchema(i,i,e.org.pkijs.schema.CERT({names:{tbsCertificate:{names:{extensions:{names:{extensions:"tbsCertificate.extensions"}}}}}}));if(t.verified===!1)throw new Error("Object's schema was not verified against input data for CERT");if(this.tbs=t.result.tbsCertificate.value_before_decode,"tbsCertificate.version"in t.result&&(this.version=t.result["tbsCertificate.version"].value_block.value_dec),this.serialNumber=t.result["tbsCertificate.serialNumber"],this.signature=new e.org.pkijs.simpl.ALGORITHM_IDENTIFIER({schema:t.result["tbsCertificate.signature"]}),this.issuer=new e.org.pkijs.simpl.RDN({schema:t.result["tbsCertificate.issuer"]}),this.notBefore=new e.org.pkijs.simpl.TIME({schema:t.result["tbsCertificate.notBefore"]}),this.notAfter=new e.org.pkijs.simpl.TIME({schema:t.result["tbsCertificate.notAfter"]}),this.subject=new e.org.pkijs.simpl.RDN({schema:t.result["tbsCertificate.subject"]}),this.subjectPublicKeyInfo=new e.org.pkijs.simpl.PUBLIC_KEY_INFO({schema:t.result["tbsCertificate.subjectPublicKeyInfo"]}),"tbsCertificate.issuerUniqueID"in t.result&&(this.issuerUniqueID=t.result["tbsCertificate.issuerUniqueID"].value_block.value_hex),"tbsCertificate.subjectUniqueID"in t.result&&(this.issuerUniqueID=t.result["tbsCertificate.subjectUniqueID"].value_block.value_hex),"tbsCertificate.extensions"in t.result){this.extensions=new Array;for(var s=t.result["tbsCertificate.extensions"],r=0;r<s.length;r++)this.extensions.push(new e.org.pkijs.simpl.EXTENSION({schema:s[r]}))}this.signatureAlgorithm=new e.org.pkijs.simpl.ALGORITHM_IDENTIFIER({schema:t.result.signatureAlgorithm}),this.signatureValue=t.result.signatureValue},e.org.pkijs.simpl.CERT.prototype.encodeTBS=function(){var i=new Array;if("version"in this&&i.push(new e.org.pkijs.asn1.ASN1_CONSTRUCTED({optional:!0,id_block:{tag_class:3,tag_number:0},value:[new e.org.pkijs.asn1.INTEGER({value:this.version})]})),i.push(this.serialNumber),i.push(this.signature.toSchema()),i.push(this.issuer.toSchema()),i.push(new e.org.pkijs.asn1.SEQUENCE({value:[this.notBefore.toSchema(),this.notAfter.toSchema()]})),i.push(this.subject.toSchema()),i.push(this.subjectPublicKeyInfo.toSchema()),"issuerUniqueID"in this&&i.push(new e.org.pkijs.asn1.ASN1_PRIMITIVE({optional:!0,id_block:{tag_class:3,tag_number:1},value_hex:this.issuerUniqueID})),"subjectUniqueID"in this&&i.push(new e.org.pkijs.asn1.ASN1_PRIMITIVE({optional:!0,id_block:{tag_class:3,tag_number:2},value_hex:this.subjectUniqueID})),"subjectUniqueID"in this&&i.push(new e.org.pkijs.asn1.ASN1_CONSTRUCTED({optional:!0,id_block:{tag_class:3,tag_number:3},value:[this.extensions.toSchema()]})),"extensions"in this){for(var t=new Array,s=0;s<this.extensions.length;s++)t.push(this.extensions[s].toSchema());i.push(new e.org.pkijs.asn1.ASN1_CONSTRUCTED({optional:!0,id_block:{tag_class:3,tag_number:3},value:[new e.org.pkijs.asn1.SEQUENCE({value:t})]}))}return new e.org.pkijs.asn1.SEQUENCE({value:i})},e.org.pkijs.simpl.CERT.prototype.toSchema=function(i){"undefined"==typeof i&&(i=!1);var t={};if(i===!1){if(0===this.tbs.length)return e.org.pkijs.schema.CERT().value[0];var s=e.org.pkijs.fromBER(this.tbs);t=s.result}else t=e.org.pkijs.simpl.CERT.prototype.encodeTBS.call(this);return new e.org.pkijs.asn1.SEQUENCE({value:[t,this.signatureAlgorithm.toSchema(),this.signatureValue]})},e.org.pkijs.simpl.CERT.prototype.verify=function(){var i=Promise.resolve(),t={},s=this.signatureValue,r=this.tbs,n=this;if(this.issuer.isEqual(this.subject))t=this.subjectPublicKeyInfo;else if(arguments[0]instanceof Object&&"issuerCertificate"in arguments[0]&&(t=arguments[0].issuerCertificate.subjectPublicKeyInfo),t instanceof e.org.pkijs.simpl.PUBLIC_KEY_INFO==!1)return new Promise(function(e,i){i("Please provide issuer certificate as a parameter")});var o=e.org.pkijs.getCrypto();if("undefined"==typeof o)return new Promise(function(e,i){i("Unable to create WebCrypto object")});var a="";switch(this.signatureAlgorithm.algorithm_id){case"1.2.840.113549.1.1.5":a="sha-1";break;case"1.2.840.113549.1.1.11":a="sha-256";break;case"1.2.840.113549.1.1.12":a="sha-384";break;case"1.2.840.113549.1.1.13":a="sha-512";break;default:return new Promise(function(e,i){i("Unsupported signature algorithm: "+n.signatureAlgorithm.algorithm_id)})}return i=i.then(function(){var e=t.toSchema(),i=e.toBER(!1),s=new Uint8Array(i);
return o.importKey("spki",s,{name:"RSASSA-PKCS1-v1_5",hash:{name:a}},!0,["verify"])}),i=i.then(function(e){return o.verify({name:e.algorithm.name,hash:{name:a}},e,new Uint8Array(s.value_block.value_hex),new Uint8Array(r))})},e.org.pkijs.simpl.CERT.prototype.sign=function(i){var t=this;if("undefined"==typeof i)return new Promise(function(e,i){i("Need to provide a private key for signing")});var s="";switch(this.signatureAlgorithm.algorithm_id){case"1.2.840.113549.1.1.5":s="sha-1";break;case"1.2.840.113549.1.1.11":s="sha-256";break;case"1.2.840.113549.1.1.12":s="sha-384";break;case"1.2.840.113549.1.1.13":s="sha-512";break;default:return new Promise(function(e,i){i("Unsupported signature algorithm: "+t.signature.signatureAlgorithm.algorithm_id)})}t.tbs=e.org.pkijs.simpl.CERT.prototype.encodeTBS.call(this).toBER(!1);var r=e.org.pkijs.getCrypto();return"undefined"==typeof r?new Promise(function(e,i){i("Unable to create WebCrypto object")}):r.sign({name:i.algorithm.name,hash:{name:s}},i,new Uint8Array(t.tbs)).then(function(i){t.signatureValue=new e.org.pkijs.asn1.BITSTRING({value_hex:i})},function(e){return new Promise(function(i,t){t("Signing error: "+e)})})},e.org.pkijs.simpl.CERT.prototype.getPublicKey=function(){var i=e.org.pkijs.getCrypto();if("undefined"==typeof i)return new Promise(function(e,i){i("Unable to create WebCrypto object")});var t=this.subjectPublicKeyInfo.toSchema(),s=t.toBER(!1),r=new Uint8Array(s);return i.importKey("spki",r,{name:"RSASSA-PKCS1-v1_5",hash:{name:sha_algorithm}},!0,["verify"])},e.org.pkijs.simpl.CERT.prototype.getKeyHash=function(){var i=e.org.pkijs.getCrypto();return"undefined"==typeof i?new Promise(function(e,i){i("Unable to create WebCrypto object")}):i.digest({name:"sha-1"},new Uint8Array(this.subjectPublicKeyInfo.subjectPublicKey.value_block.value_hex))},e.org.pkijs.simpl.CERT.prototype.toJSON=function(){var i={tbs:e.org.pkijs.bufferToHexCodes(this.tbs,0,this.tbs.byteLength),serialNumber:this.serialNumber.toJSON(),signature:this.signature.toJSON(),issuer:this.issuer.toJSON(),notBefore:this.notBefore.toJSON(),notAfter:this.notAfter.toJSON(),subject:this.subject.toJSON(),subjectPublicKeyInfo:this.subjectPublicKeyInfo.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()};if("version"in this&&(i.version=this.version),"issuerUniqueID"in this&&(i.issuerUniqueID=e.org.pkijs.bufferToHexCodes(this.issuerUniqueID,0,this.issuerUniqueID.byteLength)),"subjectUniqueID"in this&&(i.subjectUniqueID=e.org.pkijs.bufferToHexCodes(this.subjectUniqueID,0,this.subjectUniqueID.byteLength)),"extensions"in this){i.extensions=new Array;for(var t=0;t<this.extensions.length;t++)i.extensions.push(this.extensions[t].toJSON())}return i},e.org.pkijs.simpl.REV_CERT=function(){this.userCertificate=new e.org.pkijs.asn1.INTEGER,this.revocationDate=new e.org.pkijs.simpl.TIME,arguments[0]instanceof Object&&"schema"in arguments[0]?e.org.pkijs.simpl.REV_CERT.prototype.fromSchema.call(this,arguments[0].schema):arguments[0]instanceof Object&&(this.userCertificate=arguments[0].userCertificate||new e.org.pkijs.asn1.INTEGER,this.revocationDate=arguments[0].revocationDate||new e.org.pkijs.simpl.TIME,"crlEntryExtensions"in arguments[0]&&(this.crlEntryExtensions=arguments[0].crlEntryExtensions))},e.org.pkijs.simpl.REV_CERT.prototype.fromSchema=function(i){var t=e.org.pkijs.compareSchema(i,i,new e.org.pkijs.asn1.SEQUENCE({value:[new e.org.pkijs.asn1.INTEGER({name:"userCertificate"}),e.org.pkijs.schema.TIME({names:{utcTimeName:"revocationDate",generalTimeName:"revocationDate"}}),e.org.pkijs.schema.EXTENSIONS({names:{block_name:"crlEntryExtensions"}},!0)]}));if(t.verified===!1)throw new Error("Object's schema was not verified against input data for REV_CERT");if(this.userCertificate=t.result.userCertificate,this.revocationDate=new e.org.pkijs.simpl.TIME({schema:t.result.revocationDate}),"crlEntryExtensions"in t.result){this.crlEntryExtensions=new Array;for(var s=t.result.crlEntryExtensions.value_block.value,r=0;r<s.length;r++)this.crlEntryExtensions.push(new e.org.pkijs.simpl.EXTENSION({schema:s[r]}))}},e.org.pkijs.simpl.REV_CERT.prototype.toSchema=function(){var i=new Array;if(i.push(this.userCertificate),i.push(this.revocationDate.toSchema()),"crlEntryExtensions"in this){for(var t=new Array,s=0;s<this.crlEntryExtensions.length;s++)t.push(this.crlEntryExtensions[s].toSchema());i.push(new e.org.pkijs.asn1.SEQUENCE({value:t}))}return new e.org.pkijs.asn1.SEQUENCE({value:i})},e.org.pkijs.simpl.REV_CERT.prototype.toJSON=function(){var e={userCertificate:this.userCertificate.toJSON(),revocationDate:this.revocationDate.toJSON};if("crlEntryExtensions"in this){e.crlEntryExtensions=new Array;for(var i=0;i<this.crlEntryExtensions.length;i++)e.crlEntryExtensions.push(this.crlEntryExtensions[i].toJSON())}return e},e.org.pkijs.simpl.CRL=function(){this.tbs=new ArrayBuffer(0),this.signature=new e.org.pkijs.simpl.ALGORITHM_IDENTIFIER,this.issuer=new e.org.pkijs.simpl.RDN,this.thisUpdate=new e.org.pkijs.simpl.TIME,this.signatureAlgorithm=new e.org.pkijs.simpl.ALGORITHM_IDENTIFIER,this.signatureValue=new e.org.pkijs.asn1.BITSTRING,arguments[0]instanceof Object&&"schema"in arguments[0]?e.org.pkijs.simpl.CRL.prototype.fromSchema.call(this,arguments[0].schema):arguments[0]instanceof Object&&(this.tbs=arguments[0].tbs||new ArrayBuffer(0),"version"in arguments[0]&&(this.version=arguments[0].version),this.signature=arguments[0].signature||new e.org.pkijs.simpl.ALGORITHM_IDENTIFIER,this.issuer=arguments[0].issuer||new e.org.pkijs.simpl.RDN,this.thisUpdate=arguments[0].thisUpdate||new e.org.pkijs.simpl.TIME,"nextUpdate"in arguments[0]&&(this.nextUpdate=arguments[0].nextUpdate),"revokedCertificates"in arguments[0]&&(this.revokedCertificates=arguments[0].revokedCertificates),"crlExtensions"in arguments[0]&&(this.crlExtensions=arguments[0].crlExtensions),this.signatureAlgorithm=arguments[0].signatureAlgorithm||new e.org.pkijs.simpl.ALGORITHM_IDENTIFIER,this.signatureValue=arguments[0].signatureValue||new e.org.pkijs.asn1.BITSTRING)},e.org.pkijs.simpl.CRL.prototype.fromSchema=function(i){var t=e.org.pkijs.compareSchema(i,i,e.org.pkijs.schema.CRL());if(t.verified===!1)throw new Error("Object's schema was not verified against input data for CRL");if(this.tbs=t.result.tbsCertList.value_before_decode,"tbsCertList.version"in t.result&&(this.version=t.result["tbsCertList.version"].value_block.value_dec),this.signature=new e.org.pkijs.simpl.ALGORITHM_IDENTIFIER({schema:t.result["tbsCertList.signature"]}),this.issuer=new e.org.pkijs.simpl.RDN({schema:t.result["tbsCertList.issuer"]}),this.thisUpdate=new e.org.pkijs.simpl.TIME({schema:t.result["tbsCertList.thisUpdate"]}),"tbsCertList.nextUpdate"in t.result&&(this.nextUpdate=new e.org.pkijs.simpl.TIME({schema:t.result["tbsCertList.nextUpdate"]})),"tbsCertList.revokedCertificates"in t.result){this.revokedCertificates=new Array;for(var s=t.result["tbsCertList.revokedCertificates"],r=0;r<s.length;r++)this.revokedCertificates.push(new e.org.pkijs.simpl.REV_CERT({schema:s[r]}))}if("tbsCertList.extensions"in t.result){this.crlExtensions=new Array;for(var n=t.result["tbsCertList.extensions"].value_block.value,r=0;r<n.length;r++)this.crlExtensions.push(new e.org.pkijs.simpl.EXTENSION({schema:n[r]}))}this.signatureAlgorithm=new e.org.pkijs.simpl.ALGORITHM_IDENTIFIER({schema:t.result.signatureAlgorithm}),this.signatureValue=t.result.signatureValue},e.org.pkijs.simpl.CRL.prototype.encodeTBS=function(){var i=new Array;if("version"in this&&i.push(new e.org.pkijs.asn1.INTEGER({value:this.version})),i.push(this.signature.toSchema()),i.push(this.issuer.toSchema()),i.push(this.thisUpdate.toSchema()),"nextUpdate"in this&&i.push(this.nextUpdate.toSchema()),"revokedCertificates"in this){for(var t=new Array,s=0;s<this.revokedCertificates.length;s++)t.push(this.revokedCertificates[s].toSchema());i.push(new e.org.pkijs.asn1.SEQUENCE({value:t}))}if("crlExtensions"in this){for(var r=new Array,n=0;n<this.crlExtensions.length;n++)r.push(this.crlExtensions[n].toSchema());i.push(new e.org.pkijs.asn1.ASN1_CONSTRUCTED({optional:!0,id_block:{tag_class:3,tag_number:0},value:[new e.org.pkijs.asn1.SEQUENCE({value:r})]}))}return new e.org.pkijs.asn1.SEQUENCE({value:i})},e.org.pkijs.simpl.CRL.prototype.toSchema=function(i){"undefined"==typeof i&&(i=!1);var t;if(i===!1){if(0===this.tbs.length)return e.org.pkijs.schema.CRL();t=e.org.pkijs.fromBER(this.tbs).result}else t=e.org.pkijs.simpl.CRL.prototype.encodeTBS.call(this);return new e.org.pkijs.asn1.SEQUENCE({value:[t,this.signatureAlgorithm.toSchema(),this.signatureValue]})},e.org.pkijs.simpl.CRL.prototype.verify=function(){var i=Promise.resolve(),t=this.signatureValue,s=this.tbs,r=-1,n=this;if(arguments[0]instanceof Object&&("issuerCertificate"in arguments[0]&&(r=arguments[0].issuerCertificate.subjectPublicKeyInfo),"publicKeyInfo"in arguments[0]&&(r=arguments[0].publicKeyInfo)),r instanceof e.org.pkijs.simpl.PUBLIC_KEY_INFO==!1)return new Promise(function(e,i){i("Issuer's certificate must be provided as an input parameter")});var o=e.org.pkijs.getCrypto();if("undefined"==typeof o)return new Promise(function(e,i){i("Unable to create WebCrypto object")});var a="";switch(this.signatureAlgorithm.algorithm_id){case"1.2.840.113549.1.1.5":a="sha-1";break;case"1.2.840.113549.1.1.11":a="sha-256";break;case"1.2.840.113549.1.1.12":a="sha-384";break;case"1.2.840.113549.1.1.13":a="sha-512";break;default:return new Promise(function(e,i){i("Unsupported signature algorithm: "+n.signatureAlgorithm.algorithm_id)})}return i=i.then(function(){var e=r.toSchema(),i=e.toBER(!1),t=new Uint8Array(i);return o.importKey("spki",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:a}},!0,["verify"])}),i=i.then(function(e){return o.verify({name:e.algorithm.name,hash:{name:a}},e,new Uint8Array(t.value_block.value_hex),new Uint8Array(s))})},e.org.pkijs.simpl.CRL.prototype.sign=function(i){var t=this;if("undefined"==typeof i)return new Promise(function(e,i){i("Need to provide a private key for signing")});var s="";switch(this.signatureAlgorithm.algorithm_id){case"1.2.840.113549.1.1.5":s="sha-1";break;case"1.2.840.113549.1.1.11":s="sha-256";break;case"1.2.840.113549.1.1.12":s="sha-384";break;case"1.2.840.113549.1.1.13":s="sha-512";break;default:return new Promise(function(e,i){i("Unsupported signature algorithm: "+t.signature.signatureAlgorithm.algorithm_id)})}t.tbs=e.org.pkijs.simpl.CRL.prototype.encodeTBS.call(this).toBER(!1);var r=e.org.pkijs.getCrypto();return"undefined"==typeof r?new Promise(function(e,i){i("Unable to create WebCrypto object")}):r.sign({name:i.algorithm.name,hash:{name:s}},i,new Uint8Array(t.tbs)).then(function(i){t.signatureValue=new e.org.pkijs.asn1.BITSTRING({value_hex:i})},function(e){return new Promise(function(i,t){t("Signing error: "+e)})})},e.org.pkijs.simpl.CRL.prototype.isCertificateRevoked=function(){var i={};if(arguments[0]instanceof Object&&"certificate"in arguments[0]&&(i=arguments[0].certificate),i instanceof e.org.pkijs.simpl.CERT==!1)return!1;if(this.issuer.isEqual(i.issuer)===!1)return!1;if("revokedCertificates"in this==!1)return!1;for(var t=0;t<this.revokedCertificates.length;t++)if(this.revokedCertificates[t].userCertificate.isEqual(i.serialNumber))return!0;return!1},e.org.pkijs.simpl.CRL.prototype.toJSON=function(){var i={tbs:e.org.pkijs.bufferToHexCodes(this.tbs,0,this.tbs.byteLength),signature:this.signature.toJSON(),issuer:this.issuer.toJSON(),thisUpdate:this.thisUpdate.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()};if("version"in this&&(i.version=this.version),"nextUpdate"in this&&(i.nextUpdate=this.nextUpdate.toJSON()),"revokedCertificates"in this){i.revokedCertificates=new Array;for(var t=0;t<this.revokedCertificates.length;t++)i.revokedCertificates.push(this.revokedCertificates[t].toJSON())}if("crlExtensions"in this){i.crlExtensions=new Array;for(var t=0;t<this.crlExtensions.length;t++)i.crlExtensions.push(this.crlExtensions[t].toJSON())}return i},e.org.pkijs.simpl.ATTRIBUTE=function(){this.type="",this.values=new Array,arguments[0]instanceof Object&&"schema"in arguments[0]?e.org.pkijs.simpl.ATTRIBUTE.prototype.fromSchema.call(this,arguments[0].schema):arguments[0]instanceof Object&&(this.type=arguments[0].type||"",this.values=arguments[0].values||new Array)},e.org.pkijs.simpl.ATTRIBUTE.prototype.fromSchema=function(i){var t=e.org.pkijs.compareSchema(i,i,e.org.pkijs.schema.ATTRIBUTE({names:{type:"type",values:"values"}}));if(t.verified===!1)throw new Error("Object's schema was not verified against input data for ATTRIBUTE");this.type=t.result.type.value_block.toString(),this.values=t.result.values},e.org.pkijs.simpl.ATTRIBUTE.prototype.toSchema=function(){return new e.org.pkijs.asn1.SEQUENCE({value:[new e.org.pkijs.asn1.OID({value:this.type}),new e.org.pkijs.asn1.SET({values:this.values})]})},e.org.pkijs.simpl.ATTRIBUTE.prototype.toJSON=function(){for(var e={type:this.type,values:new Array},i=0;i<this.values.length;i++)e.values.push(this.values[i].toJSON());return e},e.org.pkijs.simpl.PKCS10=function(){this.tbs=new ArrayBuffer(0),this.version=0,this.subject=new e.org.pkijs.simpl.RDN,this.subjectPublicKeyInfo=new e.org.pkijs.simpl.PUBLIC_KEY_INFO,this.signatureAlgorithm=new e.org.pkijs.simpl.ALGORITHM_IDENTIFIER,this.signatureValue=new e.org.pkijs.asn1.BITSTRING,arguments[0]instanceof Object&&"schema"in arguments[0]?e.org.pkijs.simpl.PKCS10.prototype.fromSchema.call(this,arguments[0].schema):arguments[0]instanceof Object&&(this.tbs=arguments[0].tbs||new ArrayBuffer(0),this.version=arguments[0].version||0,this.subject=arguments[0].subject||new e.org.pkijs.simpl.RDN,this.subjectPublicKeyInfo=arguments[0].subjectPublicKeyInfo||new e.org.pkijs.simpl.PUBLIC_KEY_INFO,"attributes"in arguments[0]&&(this.attributes=arguments[0].attributes),this.signatureAlgorithm=arguments[0].signatureAlgorithm||new e.org.pkijs.simpl.ALGORITHM_IDENTIFIER,this.signatureValue=arguments[0].signatureValue||new e.org.pkijs.asn1.BITSTRING)},e.org.pkijs.simpl.PKCS10.prototype.fromSchema=function(i){var t=e.org.pkijs.compareSchema(i,i,e.org.pkijs.schema.PKCS10());if(t.verified===!1)throw new Error("Object's schema was not verified against input data for PKCS10");if(this.tbs=t.result.CertificationRequestInfo.value_before_decode,this.version=t.result["CertificationRequestInfo.version"].value_block.value_dec,this.subject=new e.org.pkijs.simpl.RDN({schema:t.result["CertificationRequestInfo.subject"]}),this.subjectPublicKeyInfo=new e.org.pkijs.simpl.PUBLIC_KEY_INFO({schema:t.result["CertificationRequestInfo.subjectPublicKeyInfo"]}),"CertificationRequestInfo.attributes"in t.result){this.attributes=new Array;for(var s=t.result["CertificationRequestInfo.attributes"],r=0;r<s.length;r++)this.attributes.push(new e.org.pkijs.simpl.ATTRIBUTE({schema:s[r]}))}this.signatureAlgorithm=new e.org.pkijs.simpl.ALGORITHM_IDENTIFIER({schema:t.result.signatureAlgorithm}),this.signatureValue=t.result.signatureValue},e.org.pkijs.simpl.PKCS10.prototype.encodeTBS=function(){var i=new Array;if(i.push(new e.org.pkijs.asn1.INTEGER({value:this.version})),i.push(this.subject.toSchema()),i.push(this.subjectPublicKeyInfo.toSchema()),"attributes"in this){for(var t=new Array,s=0;s<this.attributes.length;s++)t.push(this.attributes[s].toSchema());i.push(new e.org.pkijs.asn1.ASN1_CONSTRUCTED({id_block:{tag_class:3,tag_number:0},value:t}))}return new e.org.pkijs.asn1.SEQUENCE({value:i})},e.org.pkijs.simpl.PKCS10.prototype.toSchema=function(i){"undefined"==typeof i&&(i=!1);var t;if(i===!1){if(0===this.tbs.length)return e.org.pkijs.schema.PKCS10();t=e.org.pkijs.fromBER(this.tbs).result}else t=e.org.pkijs.simpl.PKCS10.prototype.encodeTBS.call(this);return new e.org.pkijs.asn1.SEQUENCE({value:[t,this.signatureAlgorithm.toSchema(),this.signatureValue]})},e.org.pkijs.simpl.PKCS10.prototype.verify=function(){var i="",t=Promise.resolve(),s=this.subjectPublicKeyInfo,r=this.signatureValue,n=this.tbs,o=e.org.pkijs.getCrypto();if("undefined"==typeof o)return new Promise(function(e,i){i("Unable to create WebCrypto object")});switch(this.signatureAlgorithm.algorithm_id){case"1.2.840.113549.1.1.5":i="sha-1";break;case"1.2.840.113549.1.1.11":i="sha-256";break;case"1.2.840.113549.1.1.12":i="sha-384";break;case"1.2.840.113549.1.1.13":i="sha-512";break;default:return new Promise(function(e,i){i("Unsupported signature algorithm: "+this.signature.signatureAlgorithm.algorithm_id)})}return t=t.then(function(){var e=s.toSchema(),t=e.toBER(!1),r=new Uint8Array(t);return o.importKey("spki",r,{name:"RSASSA-PKCS1-v1_5",hash:{name:i}},!0,["verify"])}),t=t.then(function(e){return o.verify({name:e.algorithm.name,hash:{name:i}},e,new Uint8Array(r.value_block.value_hex),new Uint8Array(n))})},e.org.pkijs.simpl.PKCS10.prototype.sign=function(i){var t=this;if("undefined"==typeof i)return new Promise(function(e,i){i("Need to provide a private key for signing")});var s="";switch(this.signatureAlgorithm.algorithm_id){case"1.2.840.113549.1.1.5":s="sha-1";break;case"1.2.840.113549.1.1.11":s="sha-256";break;case"1.2.840.113549.1.1.12":s="sha-384";break;case"1.2.840.113549.1.1.13":s="sha-512";break;default:return new Promise(function(e,i){i("Unsupported signature algorithm: "+this.signature.signatureAlgorithm.algorithm_id)})}t.tbs=e.org.pkijs.simpl.PKCS10.prototype.encodeTBS.call(this).toBER(!1);var r=e.org.pkijs.getCrypto();return"undefined"==typeof r?new Promise(function(e,i){i("Unable to create WebCrypto object")}):r.sign({name:i.algorithm.name,hash:{name:s}},i,new Uint8Array(t.tbs)).then(function(i){t.signatureValue=new e.org.pkijs.asn1.BITSTRING({value_hex:i})},function(e){return new Promise(function(i,t){t("Signing error: "+e)})})},e.org.pkijs.simpl.PKCS10.prototype.toJSON=function(){var i={tbs:e.org.pkijs.bufferToHexCodes(this.tbs,0,this.tbs.byteLength),version:this.version,subject:this.subject.toJSON(),subjectPublicKeyInfo:this.subjectPublicKeyInfo.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()};if("attributes"in this){i.attributes=new Array;for(var t=0;t<this.attributes.length;t++)i.attributes.push(this.attributes[t].toJSON())}return i},e.org.pkijs.simpl.PKCS8=function(){this.version=0,this.privateKeyAlgorithm=new e.org.pkijs.simpl.ALGORITHM_IDENTIFIER,this.privateKey=new e.org.pkijs.asn1.OCTETSTRING,arguments[0]instanceof Object&&"schema"in arguments[0]?e.org.pkijs.simpl.PKCS8.prototype.fromSchema.call(this,arguments[0].schema):arguments[0]instanceof Object&&(this.version=arguments[0].version||0,this.privateKeyAlgorithm=arguments[0].privateKeyAlgorithm||new e.org.pkijs.simpl.ALGORITHM_IDENTIFIER,this.privateKey=arguments[0].privateKey||new e.org.pkijs.asn1.OCTETSTRING,"attributes"in arguments[0]&&(this.attributes=arguments[0].attributes))},e.org.pkijs.simpl.PKCS8.prototype.fromSchema=function(i){var t=e.org.pkijs.compareSchema(i,i,e.org.pkijs.schema.PKCS8({names:{version:"version",privateKeyAlgorithm:{names:{block_name:"privateKeyAlgorithm"}},privateKey:"privateKey",attributes:"attributes"}}));if(t.verified===!1)throw new Error("Object's schema was not verified against input data for PKCS8");if(this.version=t.result.version.value_block.value_dec,this.privateKeyAlgorithm=new e.org.pkijs.simpl.ALGORITHM_IDENTIFIER({schema:t.result.privateKeyAlgorithm}),this.privateKey=t.result.privateKey,"attributes"in t.result){this.attributes=new Array;for(var s=t.result.attributes,r=0;r<s.length;r++)this.attributes.push(new e.org.pkijs.simpl.ATTRIBUTE({schema:s[r]}))}},e.org.pkijs.simpl.PKCS8.prototype.toSchema=function(){var i=new Array;if(i.push(new e.org.pkijs.asn1.INTEGER({value:this.version})),i.push(this.privateKeyAlgorithm.toSchema()),i.push(this.privateKey),"attributes"in this){for(var t=new Array,s=0;s<this.attributes.length;s++)t.push(this.attributes[s].toSchema());i.push(new e.org.pkijs.asn1.ASN1_CONSTRUCTED({optional:!0,id_block:{tag_class:3,tag_number:0},value:t}))}return new e.org.pkijs.asn1.SEQUENCE({value:i})},e.org.pkijs.simpl.PKCS8.prototype.toJSON=function(){var e={version:this.version,privateKeyAlgorithm:this.privateKeyAlgorithm.toJSON(),privateKey:this.privateKey.toJSON()};if("attributes"in this){e.attributes=new Array;for(var i=0;i<this.attributes.length;i++)e.attributes.push(this.attributes[i].toJSON())}return e},e.org.pkijs.simpl.CERT_CHAIN=function(){this.trusted_certs=new Array,this.certs=new Array,this.crls=new Array,arguments[0]instanceof Object&&(this.trusted_certs=arguments[0].trusted_certs||new Array,this.certs=arguments[0].certs||new Array,this.crls=arguments[0].crls||new Array)},e.org.pkijs.simpl.CERT_CHAIN.prototype.sort=function(){function e(e,i){function t(e){return o.crls[e].verify({issuerCertificate:i}).then(function(i){return i===!0?new Promise(function(i,t){i(o.crls[e])}):(e++,e<o.crls.length?t(e):new Promise(function(e,i){i({result:!1,result_code:9,result_message:"Unable to find CRL for issuer's certificate"})}))},function(e){return new Promise(function(e,i){i({result:!1,result_code:10,result_message:"Unable to find CRL for issuer's certificate"})})})}var s=Promise.resolve();return s=s.then(function(){return e.notBefore.value>n||e.notAfter.value<n?new Promise(function(e,i){i({result:!1,result_code:8,result_message:"Certificate validity period is out of checking date"})}):void 0}),0===o.crls.length?s.then(function(){return new Promise(function(e,i){e()})}):(s=s.then(function(){return t(0)}),s=s.then(function(i){return i.isCertificateRevoked({certificate:e})===!0?new Promise(function(e,i){i({result:!1,result_code:11,result_message:"Subject certificate was revoked"})}):new Promise(function(e,i){e()})},function(e){return new Promise(function(e,i){e()})}))}function i(){return t(g,0).then(function(t){if(s.push(r[t]),g=r[t],r.splice(t,1),g.issuer.isEqual(g.subject)===!0){for(var n=0===o.trusted_certs.length,a=0;a<o.trusted_certs.length;a++)if(g.issuer.isEqual(o.trusted_certs[a].issuer)===!0&&g.subject.isEqual(o.trusted_certs[a].subject)===!0&&g.serialNumber.isEqual(o.trusted_certs[a].serialNumber)===!0){n=!0;break}return n===!1?new Promise(function(e,i){i({result:!1,result_code:22,result_message:'Self-signed root certificate not in "trusted certificates" array'})}):g.verify().then(function(i){return i===!0?e(g,g).then(function(){return new Promise(function(e,i){e(s)})},function(e){return new Promise(function(i,t){t({result:!1,result_code:12,result_message:e})})}):new Promise(function(e,i){i({result:!1,result_code:13,result_message:"Unable to build certificate chain - signature of root certificate is invalid"})})},function(e){return new Promise(function(i,t){t({result:!1,result_code:14,result_message:e})})})}return r.length>0?i():0!==o.trusted_certs.length?(r=o.trusted_certs.splice(0),i()):new Promise(function(e,i){i({result:!1,result_code:23,result_message:"Root certificate not found"})})},function(e){return new Promise(function(i,t){t(e)})})}function t(i,s){return r[s].subject.isEqual(i.issuer)===!0?i.verify({issuerCertificate:r[s]}).then(function(n){return n===!0?e(i,r[s]).then(function(){return new Promise(function(e,i){e(s)})},function(e){return new Promise(function(i,t){t({result:!1,result_code:16,result_message:e})})}):s<r.length-1?t(i,s+1):new Promise(function(e,i){i({result:!1,result_code:17,result_message:"Unable to build certificate chain - incomplete certificate chain or signature of some certificate is invalid"})})},function(e){return new Promise(function(e,i){i({result:!1,result_code:18,result_message:"Unable to build certificate chain - error during certificate signature verification"})})}):s<r.length-1?t(i,s+1):new Promise(function(e,i){i({result:!1,result_code:19,result_message:"Unable to build certificate chain - incomplete certificate chain"})})}var s=new Array,r=this.certs.slice(0),n=new Date,o=this;if(0===r.length)return new Promise(function(e,i){i({result:!1,result_code:2,result_message:"Certificate's array can not be empty"})});for(var a=-1,u=0;u<r.length;u++){var c=!1;if("extensions"in r[u]){for(var l=!1,p=!1,h=!1,m=0;m<r[u].extensions.length;m++){if(r[u].extensions[m].critical===!0&&"parsedValue"in r[u].extensions[m]==!1)return new Promise(function(e,i){i({result:!1,result_code:6,result_message:"Unable to parse critical certificate extension: "+r[u].extensions[m].extnID})});if("2.5.29.15"===r[u].extensions[m].extnID){p=!0;var f=new Uint8Array(r[u].extensions[m].parsedValue.value_block.value_hex);4===(4&f[0])&&(l=!0),2===(2&f[0])&&(h=!0)}"2.5.29.19"===r[u].extensions[m].extnID&&"cA"in r[u].extensions[m].parsedValue&&r[u].extensions[m].parsedValue.cA===!0&&(c=!0)}if(l===!0&&c===!1)return new Promise(function(e,i){i({result:!1,result_code:3,result_message:'Unable to build certificate chain - using "keyCertSign" flag set without BasicConstaints'})});if(p===!0&&c===!0&&l===!1)return new Promise(function(e,i){i({result:!1,result_code:4,result_message:'Unable to build certificate chain - "keyCertSign" flag was not set'})});if(c===!0&&p===!0&&h===!1)return new Promise(function(e,i){i({result:!1,result_code:5,result_message:'Unable to build certificate chain - intermediate certificate must have "cRLSign" key usage flag'})})}if(c===!1){if(0!==s.length)return new Promise(function(e,i){i({result:!1,result_code:7,result_message:"Unable to build certificate chain - more than one possible end-user certificate"})});s.push(r[u]),a=u}}if(r.splice(a,1),0===s.length)return new Promise(function(e,i){i({result:!1,result_code:1,result_message:"Can't find end-user certificate"})});if(0===r.length){if(s[0].issuer.isEqual(s[0].subject)===!0)return new Promise(function(e,i){e(s)});if(0===this.trusted_certs.length)return new Promise(function(e,i){i({result:!1,result_code:70,result_message:"Can't find root certificate"})});r=o.trusted_certs.splice(0)}var g=s[0];return i()},e.org.pkijs.simpl.CERT_CHAIN.prototype.verify=function(){if(0===this.certs.length)return new Promise(function(e,i){i("Empty certificate array")});var i=Promise.resolve(),t=this,s=new Array;s.push("2.5.29.32.0");var r=!1,n=!1,o=!1,a=new Array,u=new Array,c=new Array;new Date;arguments[0]instanceof Object&&("initial_policy_set"in arguments[0]&&(s=arguments[0].initial_policy_set),"initial_explicit_policy"in arguments[0]&&(r=arguments[0].initial_explicit_policy),"initial_policy_mapping_inhibit"in arguments[0]&&(n=arguments[0].initial_policy_mapping_inhibit),"initial_inhibit_policy"in arguments[0]&&(o=arguments[0].initial_inhibit_policy),"initial_permitted_subtrees_set"in arguments[0]&&(a=arguments[0].initial_permitted_subtrees_set),"initial_excluded_subtrees_set"in arguments[0]&&(u=arguments[0].initial_excluded_subtrees_set),"initial_required_name_forms"in arguments[0]&&(c=arguments[0].initial_required_name_forms));var l=r,p=n,h=o,m=new Array(3);m[0]=!1,m[1]=!1,m[2]=!1;var f=0,g=0,b=0,y=a,k=u,j=c,v=1;return i=e.org.pkijs.simpl.CERT_CHAIN.prototype.sort.call(this).then(function(e){t.certs=e}),i=i.then(function(){var e=new Array;e.push("2.5.29.32.0");for(var i=new Array,r=new Array(t.certs.length-1),n=0;n<t.certs.length-1;n++)r[n]=!0;i.push(r);for(var o=new Array(t.certs.length-1),a=new Array(t.certs.length-1),u=t.certs.length-2;u>=0;u--,v++)if("extensions"in t.certs[u]){for(var c=0;c<t.certs[u].extensions.length;c++){if("2.5.29.32"===t.certs[u].extensions[c].extnID){a[u]=t.certs[u].extensions[c].parsedValue;for(var y=0;y<t.certs[u].extensions[c].parsedValue.certificatePolicies.length;y++){for(var k=-1,j=0;j<e.length;j++)if(t.certs[u].extensions[c].parsedValue.certificatePolicies[y].policyIdentifier===e[j]){k=j;break}if(-1===k){e.push(t.certs[u].extensions[c].parsedValue.certificatePolicies[y].policyIdentifier);var d=new Array(t.certs.length-1);d[u]=!0,i.push(d)}else i[k][u]=!0}}"2.5.29.33"===t.certs[u].extensions[c].extnID&&(o[u]=t.certs[u].extensions[c].parsedValue),"2.5.29.36"===t.certs[u].extensions[c].extnID&&0==l&&(0===t.certs[u].extensions[c].parsedValue.requireExplicitPolicy?l=!0:m[0]===!1?(m[0]=!0,f=t.certs[u].extensions[c].parsedValue.requireExplicitPolicy):f=f>t.certs[u].extensions[c].parsedValue.requireExplicitPolicy?t.certs[u].extensions[c].parsedValue.requireExplicitPolicy:f,0===t.certs[u].extensions[c].parsedValue.inhibitPolicyMapping?p=!0:m[1]===!1?(m[1]=!0,g=t.certs[u].extensions[c].parsedValue.requireExplicitPolicy):g=g>t.certs[u].extensions[c].parsedValue.requireExplicitPolicy?t.certs[u].extensions[c].parsedValue.requireExplicitPolicy:g),"2.5.29.54"===t.certs[u].extensions[c].extnID&&h===!1&&(0===t.certs[u].extensions[c].parsedValue.value_block.value_dec?h=!0:m[2]===!1?(m[2]=!0,b=t.certs[u].extensions[c].parsedValue.value_block.value_dec):b=b>t.certs[u].extensions[c].parsedValue.value_block.value_dec?t.certs[u].extensions[c].parsedValue.value_block.value_dec:b)}if(h===!0&&delete i[0][u],"undefined"!=typeof a[u]&&"undefined"!=typeof o[u]&&p===!1)for(var E=0;E<a[u].certificatePolicies.length;E++){for(var _="",S=0;S<o[u].mappings.length;S++){if(o[u].mappings[S].subjectDomainPolicy===a[u].certificatePolicies[E].policyIdentifier){_=o[u].mappings[S].issuerDomainPolicy;break}if(o[u].mappings[S].issuerDomainPolicy===a[u].certificatePolicies[E].policyIdentifier){_=o[u].mappings[S].subjectDomainPolicy;break}}if(""!==_){for(var N=-1,w=0;w<e.length;w++)if(e[w]===_){N=w;break}-1!==N&&(i[N][u]=!0)}}l===!1&&m[0]===!0&&(f--,0===f&&(l=!0,m[0]=!1)),p===!1&&m[1]===!0&&(g--,0===g&&(p=!0,m[1]=!1)),h===!1&&m[2]===!0&&(b--,0===b&&(h=!0,m[2]=!1))}for(var I=new Array,u=0;u<i.length;u++){for(var A=!0,c=0;c<t.certs.length-1;c++)if("undefined"==typeof i[u][c]){A=!1;break}A===!0&&I.push(e[u])}for(var x=new Array,u=0;u<I.length;u++)for(var c=0;c<s.length;c++)if(s[c]===I[u]){x.push(s[c]);break}return{result:x.length>0,result_code:0,result_message:x.length>0?"":'Zero "user_constr_policies" array, no intersections with "auth_constr_policies"',auth_constr_policies:I,user_constr_policies:x,explicit_policy_indicator:l,policy_mappings:o}}),i=i.then(function(i){function s(i,t){var s=e.org.pkijs.stringPrep(i),r=e.org.pkijs.stringPrep(t),n=s.split("."),o=r.split("."),a=n.length,u=o.length;if(0===a||0===u||u>a)return!1;for(var c=0;a>c;c++)if(0===n[c].length)return!1;for(var c=0;u>c;c++)if(0===o[c].length){if(0===c){if(1===u)return!1;continue}return!1}for(var c=0;u>c;c++)if(0!==o[u-1-c].length&&0!==n[a-1-c].localeCompare(o[u-1-c]))return!1;return!0}function r(i,t){var r=e.org.pkijs.stringPrep(i),n=e.org.pkijs.stringPrep(t),o=r.split("@"),a=n.split("@");if(0===o.length||0===a.length||o.length<a.length)return!1;if(1===a.length){var u=s(o[1],a[0]);if(u){var c=o[1].split("."),l=a[0].split(".");return 0===l[0].length?!0:c.length===l.length}return!1}return 0===r.localeCompare(n)}function n(i,t){var r=e.org.pkijs.stringPrep(i),n=e.org.pkijs.stringPrep(t),o=r.split("/"),a=n.split("/");if(a.length>1)return!1;if(o.length>1)for(var u=0;u<o.length;u++)if(o[u].length>0&&":"!==o[u].charAt(o[u].length-1)){var c=o[u].split(":");r=c[0];break}var l=s(r,n);if(l){var p=r.split("."),h=n.split(".");return 0===h[0].length?!0:p.length===h.length}return!1}function o(e,i){var t=new Uint8Array(e.value_block.value_hex),s=new Uint8Array(i.value_block.value_hex);if(4===t.length&&8===s.length){for(var r=0;4>r;r++)if((t[r]^s[r])&s[r+4])return!1;return!0}if(16===t.length&&32===s.length){for(var r=0;16>r;r++)if((t[r]^s[r])&s[r+16])return!1;return!0}return!1}function a(e,i){if(0===e.types_and_values.length||0===i.types_and_values.length)return!0;if(e.types_and_values.length<i.types_and_values.length)return!1;for(var t=!0,s=0,r=0;r<i.types_and_values.length;r++){for(var n=!1,o=s;o<e.types_and_values.length;o++)if(n=e.types_and_values[o].isEqual(i.types_and_values[r]),e.types_and_values[o].type===i.types_and_values[r].type&&(t=t&&n),n===!0){if(0===s||s===o){s=o+1;break}return!1}if(n===!1)return!1}return 0===s?!1:t}if(i.result===!1)return i;v=1;for(var u=t.certs.length-2;u>=0;u--,v++){var c=new Array,l=new Array,p=new Array;if("extensions"in t.certs[u])for(var h=0;h<t.certs[u].extensions.length;h++)"2.5.29.30"===t.certs[u].extensions[h].extnID&&("permittedSubtrees"in t.certs[u].extensions[h].parsedValue&&(l=l.concat(t.certs[u].extensions[h].parsedValue.permittedSubtrees)),
"excludedSubtrees"in t.certs[u].extensions[h].parsedValue&&(p=p.concat(t.certs[u].extensions[h].parsedValue.excludedSubtrees))),"2.5.29.17"===t.certs[u].extensions[h].extnID&&(c=c.concat(t.certs[u].extensions[h].parsedValue.altNames)),"1.2.840.113549.1.9.1"===t.certs[u].extensions[h].extnID&&email_addresses.push(t.certs[u].extensions[h].parsedValue.value);for(var m=!(j.length>0),h=0;h<j.length;h++)switch(j[h].base.NameType){case 4:if(j[h].base.Name.types_and_values.length!==t.certs[u].subject.types_and_values.length)continue;m=!0;for(var f=0;f<t.certs[u].subject.types_and_values.length;f++)if(t.certs[u].subject.types_and_values[f].type!==j[h].base.Name.types_and_values[f].type){m=!1;break}if(m===!0)break}if(m===!1)return i.result=!1,i.result_code=21,i.result_message="No neccessary name form found",new Promise(function(e,t){t(i)});var g=new Array;g[0]=new Array,g[1]=new Array,g[2]=new Array,g[3]=new Array,g[4]=new Array;for(var h=0;h<y.length;h++)switch(y[h].base.NameType){case 1:g[0].push(y[h]);break;case 2:g[1].push(y[h]);break;case 4:g[2].push(y[h]);break;case 6:g[3].push(y[h]);break;case 7:g[4].push(y[h])}for(var b=0;5>b;b++){for(var d=!1,E=g[b],h=0;h<E.length;h++){switch(b){case 0:if(c.length>=0)for(var f=0;f<c.length;f++)1===c[f].NameType&&(d=d||r(c[f].Name,E[h].base.Name));else for(var f=0;f<t.certs[u].subject.types_and_values.length;f++)"1.2.840.113549.1.9.1"!==t.certs[u].subject.types_and_values[f].type&&"0.9.2342.19200300.100.1.3"!==t.certs[u].subject.types_and_values[f].type||(d=d||r(t.certs[u].subject.types_and_values[f].value.value_block.value,E[h].base.Name));break;case 1:if(c.length>0)for(var f=0;f<c.length;f++)2===c[f].NameType&&(d=d||s(c[f].Name,E[h].base.Name));break;case 2:d=a(t.certs[u].subject,E[h].base.Name);break;case 3:if(c.length>0)for(var f=0;f<c.length;f++)6===c[f].NameType&&(d=d||n(c[f].Name,E[h].base.Name));break;case 4:if(c.length>0)for(var f=0;f<c.length;f++)7===c[f].NameType&&(d=d||o(c[f].Name,E[h].base.Name))}if(d)break}if(d===!1&&E.length>0)return i.result=!1,i.result_code=41,i.result_message='Failed to meet "permitted sub-trees" name constraint',new Promise(function(e,t){t(i)})}for(var _=!1,h=0;h<k.length;h++){switch(k[h].base.NameType){case 1:if(c.length>=0)for(var f=0;f<c.length;f++)1===c[f].NameType&&(_=_||r(c[f].Name,k[h].base.Name));else for(var f=0;f<t.subject.types_and_values.length;f++)"1.2.840.113549.1.9.1"!==t.subject.types_and_values[f].type&&"0.9.2342.19200300.100.1.3"!==t.subject.types_and_values[f].type||(_=_||r(t.subject.types_and_values[f].value.value_block.value,k[h].base.Name));break;case 2:if(c.length>0)for(var f=0;f<c.length;f++)2===c[f].NameType&&(_=_||s(c[f].Name,k[h].base.Name));break;case 4:_=_||a(t.certs[u].subject,k[h].base.Name);break;case 6:if(c.length>0)for(var f=0;f<c.length;f++)6===c[f].NameType&&(_=_||n(c[f].Name,k[h].base.Name));break;case 7:if(c.length>0)for(var f=0;f<c.length;f++)7===c[f].NameType&&(_=_||o(c[f].Name,k[h].base.Name))}if(_)break}if(_===!0)return i.result=!1,i.result_code=42,i.result_message='Failed to meet "excluded sub-trees" name constraint',new Promise(function(e,t){t(i)});y=y.concat(l),k=k.concat(p)}return i})}}("undefined"!=typeof exports?exports:window);