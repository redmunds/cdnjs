!function(e){if("undefined"==typeof e.org)e.org={};else if("object"!=typeof e.org)throw new Error("Name org already exists and it's not an object");if("undefined"==typeof e.org.pkijs)e.org.pkijs={};else if("object"!=typeof e.org.pkijs)throw new Error("Name org.pkijs already exists and it's not an object but "+typeof e.org.pkijs);e.org.pkijs.emptyObject=function(){this.toJSON=function(){return{}},this.toSchema=function(){return{}}},e.org.pkijs.getNames=function(e){var a={};return e instanceof Object&&(a=e.names||{}),a},e.org.pkijs.getValue=function(e,a,r){return a in e?e[a]:r},e.org.pkijs.isEqual_view=function(e,a){if(e.length!==a.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!=a[r])return!1;return!0},e.org.pkijs.isEqual_buffer=function(a,r){if(a.byteLength!=r.byteLength)return!1;var t=new Uint8Array(a),s=new Uint8Array(r);return e.org.pkijs.isEqual_view(t,s)},e.org.pkijs.concat_buffers=function(e,a){for(var r=new Uint8Array(e),t=new Uint8Array(a),s=new ArrayBuffer(e.byteLength+a.byteLength),n=new Uint8Array(s),i=0;i<e.byteLength;i++)n[i]=r[i];for(var o=0;o<a.byteLength;o++)n[e.byteLength+o]=t[o];return s},e.org.pkijs.copyBuffer=function(e){for(var a=new ArrayBuffer(e.byteLength),r=new Uint8Array(a),t=new Uint8Array(e),s=0;s<t.length;s++)r[s]=t[s];return a},e.org.pkijs.getCrypto=function(){var e={};return e=window.crypto.subtle},e.org.pkijs.stringPrep=function(e){var a=e.replace(/^\s+|\s+$/g,"");return a=a.replace(/\s+/g," "),a=a.toLowerCase()},e.org.pkijs.bufferToHexCodes=function(e,a,r){for(var t="",s=new Uint8Array(e,a,r),n=0;n<s.length;n++){var i=s[n].toString(16).toUpperCase();t=t+(1===i.length?"0":"")+i}return t},e.org.pkijs.getRandomValues=function(e){var a={};return a=window.crypto,a.getRandomValues(e)},e.org.pkijs.getAlgorithmParameters=function(a,r){var t={algorithm:{},usages:[]};switch(a.toUpperCase()){case"RSASSA-PKCS1-V1_5":switch(r.toLowerCase()){case"generatekey":t={algorithm:{name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},usages:["sign","verify"]};break;case"verify":case"sign":case"importkey":t={algorithm:{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},usages:["verify"]};break;case"exportkey":default:return{algorithm:{name:"RSASSA-PKCS1-v1_5"},usages:[]}}break;case"RSA-PSS":switch(r.toLowerCase()){case"sign":case"verify":t={algorithm:{name:"RSA-PSS",hash:{name:"SHA-1"},saltLength:20},usages:["sign","verify"]};break;case"generatekey":t={algorithm:{name:"RSA-PSS",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-1"}},usages:["sign","verify"]};break;case"importkey":t={algorithm:{name:"RSA-PSS",hash:{name:"SHA-1"}},usages:["verify"]};break;case"exportkey":default:return{algorithm:{name:"RSA-PSS"},usages:[]}}break;case"RSA-OAEP":switch(r.toLowerCase()){case"encrypt":case"decrypt":t={algorithm:{name:"RSA-OAEP"},usages:["encrypt","decrypt"]};break;case"generatekey":t={algorithm:{name:"RSA-OAEP",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"importkey":t={algorithm:{name:"RSA-OAEP",hash:{name:"SHA-256"}},usages:["encrypt"]};break;case"exportkey":default:return{algorithm:{name:"RSA-OAEP"},usages:[]}}break;case"ECDSA":switch(r.toLowerCase()){case"generatekey":t={algorithm:{name:"ECDSA",namedCurve:"P-256"},usages:["sign","verify"]};break;case"importkey":t={algorithm:{name:"ECDSA",namedCurve:"P-256"},usages:["verify"]};break;case"verify":case"sign":t={algorithm:{name:"ECDSA",hash:{name:"SHA-256"}},usages:["sign"]};break;default:return{algorithm:{name:"ECDSA"},usages:[]}}break;case"ECDH":switch(r.toLowerCase()){case"exportkey":case"importkey":case"generatekey":t={algorithm:{name:"ECDH",namedCurve:"P-256"},usages:["deriveKey","deriveBits"]};break;case"derivekey":case"derivebits":t={algorithm:{name:"ECDH",namedCurve:"P-256","public":[]},usages:["encrypt","decrypt"]};break;default:return{algorithm:{name:"ECDH"},usages:[]}}break;case"AES-CTR":switch(r.toLowerCase()){case"importkey":case"exportkey":case"generatekey":t={algorithm:{name:"AES-CTR",length:256},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"decrypt":case"encrypt":t={algorithm:{name:"AES-CTR",counter:new Uint8Array(16),length:10},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};default:return{algorithm:{name:"AES-CTR"},usages:[]}}break;case"AES-CBC":switch(r.toLowerCase()){case"importkey":case"exportkey":case"generatekey":t={algorithm:{name:"AES-CBC",length:256},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"decrypt":case"encrypt":t={algorithm:{name:"AES-CBC",iv:e.org.pkijs.getRandomValues(new Uint8Array(16))},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};default:return{algorithm:{name:"AES-CBC"},usages:[]}}break;case"AES-GCM":switch(r.toLowerCase()){case"importkey":case"exportkey":case"generatekey":t={algorithm:{name:"AES-GCM",length:256},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"decrypt":case"encrypt":t={algorithm:{name:"AES-GCM",iv:e.org.pkijs.getRandomValues(new Uint8Array(16))},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};default:return{algorithm:{name:"AES-GCM"},usages:[]}}break;case"AES-KW":switch(r.toLowerCase()){case"importkey":case"exportkey":case"generatekey":case"wrapkey":case"unwrapkey":t={algorithm:{name:"AES-KW",length:256},usages:["wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-KW"},usages:[]}}break;case"HMAC":switch(r.toLowerCase()){case"sign":case"verify":t={algorithm:{name:"HMAC"},usages:["sign","verify"]};break;case"importkey":case"exportkey":case"generatekey":t={algorithm:{name:"HMAC",length:10,hash:{name:"SHA-256"}},usages:["sign","verify"]};break;default:return{algorithm:{name:"HMAC"},usages:[]}}break;case"HKDF":switch(r.toLowerCase()){case"derivekey":t={algorithm:{name:"HKDF",hash:"SHA-256",salt:new Uint8Array,info:new Uint8Array},usages:["encrypt","decrypt"]};break;default:return{algorithm:{name:"HKDF"},usages:[]}}break;case"PBKDF2":switch(r.toLowerCase()){case"derivekey":t={algorithm:{name:"PBKDF2",hash:{name:"SHA-256"},salt:new Uint8Array,iterations:1e3},usages:["encrypt","decrypt"]};break;default:return{algorithm:{name:"PBKDF2"},usages:[]}}}return t},e.org.pkijs.getHashAlgorithmByOID=function(e){var a="";switch(e){case"1.3.14.3.2.26":a="sha-1";break;case"2.16.840.1.101.3.4.2.1":a="sha-256";break;case"2.16.840.1.101.3.4.2.2":a="sha-384";break;case"2.16.840.1.101.3.4.2.3":a="sha-512"}return a},e.org.pkijs.getHashAlgorithmOID=function(e){var a="";switch(e.toUpperCase()){case"SHA-1":a="1.3.14.3.2.26";break;case"SHA-256":a="2.16.840.1.101.3.4.2.1";break;case"SHA-384":a="2.16.840.1.101.3.4.2.2";break;case"SHA-512":a="2.16.840.1.101.3.4.2.3"}return a},e.org.pkijs.getHashAlgorithm=function(a){var r="";switch(a.algorithm_id){case"1.2.840.10045.4.1":case"1.2.840.113549.1.1.5":r="SHA-1";break;case"1.2.840.10045.4.3.2":case"1.2.840.113549.1.1.11":r="SHA-256";break;case"1.2.840.10045.4.3.3":case"1.2.840.113549.1.1.12":r="SHA-384";break;case"1.2.840.10045.4.3.4":case"1.2.840.113549.1.1.13":r="SHA-512";break;case"1.2.840.113549.1.1.10":var t;try{t=new e.org.pkijs.simpl.x509.RSASSA_PSS_params({schema:a.algorithm_params}),r="hashAlgorithm"in t?e.org.pkijs.getHashAlgorithmByOID(t.hashAlgorithm.algorithm_id):"SHA-1"}catch(s){}}return r},e.org.pkijs.getSignatureAlgorithm=function(e){var a="";switch(e.name.toUpperCase()){case"RSASSA-PKCS1-V1_5":switch(e.hash.name.toUpperCase()){case"SHA-1":a="1.2.840.113549.1.1.5";break;case"SHA-256":a="1.2.840.113549.1.1.11";break;case"SHA-384":a="1.2.840.113549.1.1.12";break;case"SHA-512":a="1.2.840.113549.1.1.13"}break;case"RSA-PSS":a="1.2.840.113549.1.1.10";break;case"ECDSA":switch(e.hash.name.toUpperCase()){case"SHA-1":a="1.2.840.10045.4.1";break;case"SHA-256":a="1.2.840.10045.4.3.2";break;case"SHA-384":a="1.2.840.10045.4.3.3";break;case"SHA-512":a="1.2.840.10045.4.3.4"}}return a},e.org.pkijs.getAlgorithmNameBySignature=function(e){var a="";switch(e){case"1.2.840.113549.1.1.5":case"1.2.840.113549.1.1.11":case"1.2.840.113549.1.1.12":case"1.2.840.113549.1.1.13":a="RSASSA-PKCS1-v1_5";break;case"1.2.840.113549.1.1.10":a="RSA-PSS";break;case"1.2.840.10045.4.1":case"1.2.840.10045.4.3.2":case"1.2.840.10045.4.3.3":case"1.2.840.10045.4.3.4":a="ECDSA"}return a},e.org.pkijs.createCMSECDSASignature=function(a){if(a.byteLength%2!=0)return new ArrayBuffer(0);for(var r,t,s,n,i=0,o=a.byteLength/2,c=new Uint8Array(a),g=new ArrayBuffer(o),u=new Uint8Array(g),y=new ArrayBuffer(o),h=new Uint8Array(y);o>i;i++)u[i]=c[i];if(128&u[0]){r=new ArrayBuffer(o+1),t=new Uint8Array(r),t[0]=0;for(var p=0;o>p;p++)t[p+1]=u[p]}else r=g,t=u;for(;i<a.byteLength;i++)h[i-o]=c[i];if(128&h[0]){s=new ArrayBuffer(o+1),n=new Uint8Array(s),n[0]=0;for(var p=0;o>p;p++)n[p+1]=h[p]}else s=y,n=h;var l=new e.org.pkijs.asn1.INTEGER;l.value_block.is_hex_only=!0,l.value_block.value_hex=e.org.pkijs.copyBuffer(r);var k=new e.org.pkijs.asn1.INTEGER;k.value_block.is_hex_only=!0,k.value_block.value_hex=e.org.pkijs.copyBuffer(s);var m=new e.org.pkijs.asn1.SEQUENCE({value:[l,k]});return m.toBER(!1)},e.org.pkijs.createECDSASignatureFromCMS=function(e){var a=0,r=0,t=0,s=e.value_block.value[0].value_block.value_hex.byteLength,n=e.value_block.value[1].value_block.value_hex.byteLength,i=new Uint8Array(e.value_block.value[0].value_block.value_hex);0===i[0]&&128&i[1]?(a=s-1,r=1):a=s;var o=new Uint8Array(e.value_block.value[1].value_block.value_hex);0===o[0]&&128&o[1]?(a+=n-1,t=1):a+=n;for(var c=new ArrayBuffer(a),g=new Uint8Array(c),u=r;s>u;u++)g[u-r]=i[u];for(var u=t;n>u;u++)g[u-t+s-r]=o[u];return c},e.org.pkijs.getEncryptionAlgorithm=function(e){var a="";switch(e.name.toUpperCase()){case"AES-CBC":switch(e.length){case 128:a="2.16.840.1.101.3.4.1.2";break;case 192:a="2.16.840.1.101.3.4.1.22";break;case 256:a="2.16.840.1.101.3.4.1.42"}break;case"AES-GCM":switch(e.length){case 128:a="2.16.840.1.101.3.4.1.6";break;case 192:a="2.16.840.1.101.3.4.1.26";break;case 256:a="2.16.840.1.101.3.4.1.46"}}return a},e.org.pkijs.getAlgorithmByEncryptionOID=function(e){var a="";switch(e){case"2.16.840.1.101.3.4.1.2":case"2.16.840.1.101.3.4.1.22":case"2.16.840.1.101.3.4.1.42":a="AES-CBC";break;case"2.16.840.1.101.3.4.1.6":case"2.16.840.1.101.3.4.1.26":case"2.16.840.1.101.3.4.1.46":a="AES-GCM"}return a}}("undefined"!=typeof exports?exports:window);