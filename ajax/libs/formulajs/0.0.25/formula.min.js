(function(){function exportModule(numeric,numeral,jStatLib,moment,_,_s,md5Lib){var Formula={},jStat=jStatLib.jStat,md5=md5Lib.md5,MEMOIZED_FACT=[],SQRT2PI=2.5066282746310002,WEEK_STARTS=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],WEEK_TYPES=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],WEEKEND_TYPES=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0],[1],[2],[3],[4],[5],[6]];return Formula.UNIQUE=function(){return _.unique(arguments)},Formula.FLATTEN=function(){return _.flatten(arguments)},Formula.FUNCTION=function(){var r=Array.prototype.slice.call(arguments),t=r[r.length-1],n=/(\w+)\(/g,e=t.replace(n,function(){return"Formulae."+arguments[0]});return r[r.length-1]="return "+e+";",e!==t&&r.unshift("Formulae"),Function.apply(null,r)},Formula.MOMENT=function(r,t){return moment(r).format(t)},Formula.MOMENTADD=function(r,t,n){return moment(r).add(t,n)},Formula.MOMENTDIFF=function(r,t,n){return moment(t).diff(moment.utc(r),n)},Formula.MOMENTSUB=function(r,t,n){return moment(r).subtract(t,n)},Formula.MOMENTUTC=function(r,t){return moment.utc(r).format(t)},Formula.MOMENTUTCADD=function(r,t,n){return moment.utc(r).add(t,n)},Formula.MOMENTUTCDIFF=function(r,t,n){return moment.utc(t).diff(moment.utc(r),n)},Formula.MOMENTUTCSUB=function(r,t,n){return moment.utc(r).subtract(t,n)},Formula.MOMENTUNIX=function(r){return moment.unix(r).toDate()},Formula.MOMENTFORMAT=function(r,t){return moment(r).format(t)},Formula.MOMENTISLEAPYEAR=function(r,t){return moment(r,t).isLeapYear()},Formula.MOMENTISDST=function(r,t){return moment(r,t).isDST()},Formula.MOMENTSTARTOF=function(r,t,n){return moment(r,n).startOf(t).toDate()},Formula.MOMENTENDOF=function(r,t,n){return moment(r,n).endOf(t).toDate()},Formula.MOMENTISAFTER=function(r,t,n){return moment(r,n).isAfter(moment(t,n))},Formula.MOMENTISBEFORE=function(r,t,n){return moment(r,n).isBefore(moment(t,n))},Formula.INTERVAL=function(r){var t=Math.floor(r/94608e4);r%=94608e4;var n=Math.floor(r/2592e3);r%=2592e3;var e=Math.floor(r/86400);r%=86400;var a=Math.floor(r/3600);r%=3600;var u=Math.floor(r/60);r%=60;var o=r;return t=t>0?t+"Y":"",n=n>0?n+"M":"",e=e>0?e+"D":"",a=a>0?a+"H":"",u=u>0?u+"M":"",o=o>0?o+"S":"","P"+t+n+e+"T"+a+u+o},Formula.ARGSCONCAT=function(r){for(var t=[],n=0;n<r.length;n++)t=t.concat(r[n]);return t},Formula.ARGSTOARRAY=function(r){return Array.prototype.slice.call(r,0)},Formula.CLEANFLOAT=function(r){var t=Math.pow(10,14);return Math.round(r*t)/t},Formula.COUNTIN=function(r,t){for(var n=0,e=0;e<r.length;e++)r[e]===t&&n++;return n},Formula.FINDFIELD=function(r,t){for(var n=null,e=0;e<r.length;e++)if(r[e][0]===t){n=e;break}return null==n?"#VALUE!":n},Formula.FINDRESULTINDEX=function(database,criteria){for(var maxCriteriaLength=criteria[0].length,i=1;i<criteria.length;i++)criteria[i].length>maxCriteriaLength&&(maxCriteriaLength=criteria[i].length);var columnResultIndexes=[];for(i=1;i<maxCriteriaLength;i++){for(var rowResultIndexes=[],j=0;j<criteria.length;j++)if(!(criteria[j].length<maxCriteriaLength)){for(var criteriaTitle=criteria[j][0],criteriaIndex=Formula.FINDFIELD(database,criteriaTitle),criteriaValues=_.rest(database[criteriaIndex]),count=0,singleResultIndexes=[],k=0;k<criteriaValues.length;k++)eval(criteriaValues[k]+criteria[j][i])&&(singleResultIndexes[count++]=k);rowResultIndexes[j]=singleResultIndexes}columnResultIndexes[i-1]=_.intersection.apply(_,rowResultIndexes)}var resultIndexes=_.union.apply(_,columnResultIndexes);return resultIndexes},Formula.DAVERAGE=function(r,t,n){if(isNaN(t)&&"string"!=typeof t)return"#VALUE!";var e=Formula.FINDRESULTINDEX(r,n),a=[];if("string"==typeof t){var u=Formula.FINDFIELD(r,t);a=_.rest(r[u])}else a=_.rest(r[t]);for(var o=0,l=0;l<e.length;l++)o+=a[e[l]];var i=Formula.IF(0===e.length,"#DIV/0!",o/e.length);return i},Formula.DCOUNT=function(r,t,n){if(isNaN(t)&&"string"!=typeof t)return"#VALUE!";var e=Formula.FINDRESULTINDEX(r,n),a=[];if("string"==typeof t){var u=Formula.FINDFIELD(r,t);a=_.rest(r[u])}else a=_.rest(r[t]);for(var o=[],l=0;l<e.length;l++)o[l]=a[e[l]];return Formula.COUNT(o)},Formula.DCOUNTA=function(r,t,n){if(isNaN(t)&&"string"!=typeof t)return"#VALUE!";var e=Formula.FINDRESULTINDEX(r,n),a=[];if("string"==typeof t){var u=Formula.FINDFIELD(r,t);a=_.rest(r[u])}else a=_.rest(r[t]);for(var o=[],l=0;l<e.length;l++)o[l]=a[e[l]];return Formula.COUNTA(o)},Formula.DGET=function(r,t,n){if(isNaN(t)&&"string"!=typeof t)return"#VALUE!";var e=Formula.FINDRESULTINDEX(r,n),a=[];if("string"==typeof t){var u=Formula.FINDFIELD(r,t);a=_.rest(r[u])}else a=_.rest(r[t]);return 0===e.length?"#VALUE!":e.length>1?"#NUM!":a[e[0]]},Formula.DMAX=function(r,t,n){if(isNaN(t)&&"string"!=typeof t)return"#VALUE!";var e=Formula.FINDRESULTINDEX(r,n),a=[];if("string"==typeof t){var u=Formula.FINDFIELD(r,t);a=_.rest(r[u])}else a=_.rest(r[t]);for(var o=a[e[0]],l=1;l<e.length;l++)o<a[e[l]]&&(o=a[e[l]]);return o},Formula.DMIN=function(r,t,n){if(isNaN(t)&&"string"!=typeof t)return"#VALUE!";var e=Formula.FINDRESULTINDEX(r,n),a=[];if("string"==typeof t){var u=Formula.FINDFIELD(r,t);a=_.rest(r[u])}else a=_.rest(r[t]);for(var o=a[e[0]],l=1;l<e.length;l++)o>a[e[l]]&&(o=a[e[l]]);return o},Formula.DPRODUCT=function(r,t,n){if(isNaN(t)&&"string"!=typeof t)return"#VALUE!";var e=Formula.FINDRESULTINDEX(r,n),a=[];if("string"==typeof t){var u=Formula.FINDFIELD(r,t);a=_.rest(r[u])}else a=_.rest(r[t]);for(var o=[],l=0;l<e.length;l++)o[l]=a[e[l]];o=_.compact(o);var i=1;for(l=0;l<o.length;l++)i*=o[l];return i},Formula.DSTDEV=function(r,t,n){if(isNaN(t)&&"string"!=typeof t)return"#VALUE!";var e=Formula.FINDRESULTINDEX(r,n),a=[];if("string"==typeof t){var u=Formula.FINDFIELD(r,t);a=_.rest(r[u])}else a=_.rest(r[t]);for(var o=[],l=0;l<e.length;l++)o[l]=a[e[l]];return o=_.compact(o),Formula.STDEVS(o)},Formula.DSTDEVP=function(r,t,n){if(isNaN(t)&&"string"!=typeof t)return"#VALUE!";var e=Formula.FINDRESULTINDEX(r,n),a=[];if("string"==typeof t){var u=Formula.FINDFIELD(r,t);a=_.rest(r[u])}else a=_.rest(r[t]);for(var o=[],l=0;l<e.length;l++)o[l]=a[e[l]];return o=_.compact(o),Formula.STDEVP(o)},Formula.DSUM=function(r,t,n){if(isNaN(t)&&"string"!=typeof t)return"#VALUE!";var e=Formula.FINDRESULTINDEX(r,n),a=[];if("string"==typeof t){var u=Formula.FINDFIELD(r,t);a=_.rest(r[u])}else a=_.rest(r[t]);for(var o=[],l=0;l<e.length;l++)o[l]=a[e[l]];return Formula.SUM(o)},Formula.DVAR=function(r,t,n){if(isNaN(t)&&"string"!=typeof t)return"#VALUE!";var e=Formula.FINDRESULTINDEX(r,n),a=[];if("string"==typeof t){var u=Formula.FINDFIELD(r,t);a=_.rest(r[u])}else a=_.rest(r[t]);for(var o=[],l=0;l<e.length;l++)o[l]=a[e[l]];return Formula.VARS(o)},Formula.DVARP=function(r,t,n){if(isNaN(t)&&"string"!=typeof t)return"#VALUE!";var e=Formula.FINDRESULTINDEX(r,n),a=[];if("string"==typeof t){var u=Formula.FINDFIELD(r,t);a=_.rest(r[u])}else a=_.rest(r[t]);for(var o=[],l=0;l<e.length;l++)o[l]=a[e[l]];return Formula.VARP(o)},Formula.GETJSON=function(r){var t=new XMLHttpRequest;if(t.open("GET",r,!1),t.send(null),200===t.status)return JSON.parse(t.responseText)},Formula.DATE=function(r,t,n){return new Date(r,t-1,n)},Formula.DATEVALUE=function(r){return Math.ceil((moment(r)-moment("1900-1-1"))/864e5)+2},Formula.DAY=function(r){return moment(new Date(r)).date()},Formula.DAYS=function(r,t){return moment(new Date(r)).diff(moment(new Date(t)),"days")},Formula.DAYS360=function(r,t,n){var e=moment(new Date(r)),a=moment(new Date(t)),u=31,o=31,l=e.date(),i=a.date();return n?(l=31===l?30:l,i=31===i?30:i):(1===e.month()&&(u=e.daysInMonth()),1===a.month()&&(o=a.daysInMonth()),l=l===u?30:l,30!==l&&l!==u||(i=i===o?30:i)),360*(a.year()-e.year())+30*(a.month()-e.month())+(i-l)},Formula.EDATE=function(r,t){return moment(new Date(r)).add("months",t).toDate()},Formula.EOMONTH=function(r,t){var n=moment(new Date(r)).add("months",t);return new Date(n.year(),n.month(),n.daysInMonth())},Formula.FROMNOW=function(r,t){return moment(new Date(r)).fromNow(t)},Formula.HOUR=function(r){return r<=1?Math.floor(24*r):moment(new Date(r)).hours()},Formula.MINUTE=function(r){return r<=1?Math.floor(1440*r)-60*Math.floor(24*r):moment(new Date(r)).minutes()},Formula.ISOWEEKNUM=function(r){return moment(new Date(r)).format("w")},Formula.MONTH=function(r){return moment(new Date(r)).month()+1},Formula.NETWORKDAYS=function(r,t,n){return Formula.NETWORKDAYSINTL(r,t,1,n)},Formula.NETWORKDAYSINTL=function(r,t,n,e){var a="undefined"==typeof n?1:n,u=WEEKEND_TYPES[a],o=moment(r),l=moment(t),i=l.diff(o,"days")+1,f=i,m="",s=o,F=[];if("undefined"!=typeof e)for(var M=0;M<e.length;M++)F[M]=moment(new Date(e[M])).format("MM-DD-YYYY");for(var c=0;c<i;)m=s.format("d"),u.indexOf(parseInt(m,10))>=0?f--:F.indexOf(s.format("MM-DD-YYYY"))>=0&&f--,s=s.add("days",1),c++;return f},Formula.NOW=function(){return new Date},Formula.SECOND=function(r){return moment(new Date(r)).seconds()},Formula.TIME=function(r,t,n){return(3600*r+60*t+n)/86400},Formula.TIMEVALUE=function(r){var t=moment(new Date(r));return(3600*t.hours()+60*t.minutes()+t.seconds())/86400},Formula.TODAY=function(){return new Date},Formula.WEEKDAY=function(r,t){var n=moment(new Date(r)).format("d"),e="undefined"==typeof t?1:t;return WEEK_TYPES[e][n]},Formula.WEEKNUM=function(r,t){var n=moment(new Date(r)),e=moment(new Date(n.year(),0,1)),a="undefined"==typeof t?1:t,u=WEEK_STARTS[a],o=e.format("d"),l=o<u?u-o+1:o-u;return 21===a?Formula.ISOWEEKNUM(r):Math.floor(n.diff(e.subtract("days",l),"days")/7)+1},Formula.WORKDAY=function(r,t,n){return Formula.WORKDAYINTL(r,t,1,n)},Formula.WORKDAYINTL=function(r,t,n,e){var a="undefined"==typeof n?1:n,u=WEEKEND_TYPES[a],o=moment(new Date(r)),l=o,i="",f=[];if("undefined"!=typeof e)for(var m=0;m<e.length;m++)f[m]=moment(new Date(e[m])).format("MM-DD-YYYY");for(var s=0;s<t;)l=l.add("days",1),i=l.format("d"),u.indexOf(parseInt(i,10))<0&&f.indexOf(l.format("MM-DD-YYYY"))<0&&s++;return l.toDate()},Formula.YEAR=function(r){return moment(new Date(r)).year()},Formula.YEARFRAC=function(r,t,n){n="undefined"==typeof n?0:n;var e=moment(new Date(r)),a=moment(new Date(t));if(!e.isValid()||!a.isValid())return"#VALUE!";if([0,1,2,3,4].indexOf(n)===-1)return"#NUM!";if(e===a)return 0;e.diff(a)>0&&(a=moment(new Date(r)),e=moment(new Date(t)));var u=e.year(),o=e.month(),l=e.date(),i=a.year(),f=a.month(),m=a.date();switch(n){case 0:return 31===l&&31===m?(l=30,m=30):31===l?l=30:30===l&&31===m?m=30:1===o&&1===f&&e.daysInMonth()===l&&a.daysInMonth()===m?(l=30,m=30):1===o&&e.daysInMonth()===l&&(l=30),(m+30*f+360*i-(l+30*o+360*u))/360;case 1:var s=function(r,t){var n=moment(new Date(r.year(),2,1));if(moment([r.year()]).isLeapYear()&&r.diff(n)<0&&t.diff(n)>=0)return!0;var e=moment(new Date(t.year(),2,1));return!!(moment([t.year()]).isLeapYear()&&t.diff(e)>=0&&r.diff(e)<0)},F=365;if(u===i||u+1===i&&(o>f||o===f&&l>=m))return u===i&&moment([u]).isLeapYear()?F=366:(s(e,a)||1===f&&29===m)&&(F=366),a.diff(e,"days")/F;var M=i-u+1,c=moment(new Date(i+1,0,1)).diff(moment(new Date(u,0,1)),"days"),N=c/M;return a.diff(e,"days")/N;case 2:return a.diff(e,"days")/360;case 3:return a.diff(e,"days")/365;case 4:return 31===l&&(l=30),31===m&&(m=30),(m+30*f+360*i-(l+30*o+360*u))/360}},Formula.BESSELI=function(){},Formula.BESSELJ=function(){},Formula.BESSELK=function(){},Formula.BESSELY=function(){},Formula.VALIDBIN=function(r){return/^[01]{1,10}$/.test(r)},Formula.BIN2DEC=function(r){if(!Formula.VALIDBIN(r))return"#NUM!";var t=parseInt(r,2),n=r.toString();return 10===n.length&&"1"===n.substring(0,1)?parseInt(n.substring(1),2)-512:t},Formula.BIN2HEX=function(r,t){if(!Formula.VALIDBIN(r))return"#NUM!";var n=r.toString();if(10===n.length&&"1"===n.substring(0,1))return(0xfffffffe00+parseInt(n.substring(1),2)).toString(16);var e=parseInt(r,2).toString(16);return"undefined"==typeof t?e:isNaN(t)?"#VALUE!":t<0?"#NUM!":(t=Math.floor(t),t>=e.length?_s.repeat("0",t-e.length)+e:"#NUM!")},Formula.BIN2OCT=function(r,t){if(!Formula.VALIDBIN(r))return"#NUM!";var n=r.toString();if(10===n.length&&"1"===n.substring(0,1))return(1073741312+parseInt(n.substring(1),2)).toString(8);var e=parseInt(r,2).toString(8);return"undefined"==typeof t?e:isNaN(t)?"#VALUE!":t<0?"#NUM!":(t=Math.floor(t),t>=e.length?_s.repeat("0",t-e.length)+e:"#NUM!")},Formula.BITAND=function(r,t){return isNaN(r)||isNaN(t)?"#VALUE!":r<0||t<0?"#NUM!":Math.floor(r)!==r||Math.floor(t)!==t?"#NUM!":r>0xffffffffffff||t>0xffffffffffff?"#NUM!":r&t},Formula.BITLSHIFT=function(r,t){return isNaN(r)||isNaN(t)?"#VALUE!":r<0?"#NUM!":Math.floor(r)!==r?"#NUM!":r>0xffffffffffff?"#NUM!":Math.abs(t)>53?"#NUM!":t>=0?r<<t:r>>-t},Formula.BITOR=function(r,t){return isNaN(r)||isNaN(t)?"#VALUE!":r<0||t<0?"#NUM!":Math.floor(r)!==r||Math.floor(t)!==t?"#NUM!":r>0xffffffffffff||t>0xffffffffffff?"#NUM!":r|t},Formula.BITRSHIFT=function(r,t){return isNaN(r)||isNaN(t)?"#VALUE!":r<0?"#NUM!":Math.floor(r)!==r?"#NUM!":r>0xffffffffffff?"#NUM!":Math.abs(t)>53?"#NUM!":t>=0?r>>t:r<<-t},Formula.BITXOR=function(r,t){return isNaN(r)||isNaN(t)?"#VALUE!":r<0||t<0?"#NUM!":Math.floor(r)!==r||Math.floor(t)!==t?"#NUM!":r>0xffffffffffff||t>0xffffffffffff?"#NUM!":r^t},Formula.COMPLEX=function(r,t,n){if(isNaN(r)||isNaN(t))return"#VALUE!";if(n="undefined"==typeof n?"i":n,"i"!==n&&"j"!==n)return"#VALUE!";if(0===r&&0===t)return 0;if(0===r)return 1===t?n:t.toString()+n;if(0===t)return r.toString();var e=t>0?"+":"";return r.toString()+e+(1===t?n:t.toString()+n)},Formula.CONVERT=function(r,t,n){if(isNaN(r))return"#VALUE!";for(var e,a=[["a.u. of action","?",null,"action",!1,!1,1.05457168181818e-34],["a.u. of charge","e",null,"electric_charge",!1,!1,1.60217653141414e-19],["a.u. of energy","Eh",null,"energy",!1,!1,4.35974417757576e-18],["a.u. of length","a?",null,"length",!1,!1,5.29177210818182e-11],["a.u. of mass","m?",null,"mass",!1,!1,9.10938261616162e-31],["a.u. of time","?/Eh",null,"time",!1,!1,2.41888432650516e-17],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ångström","Å",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,1.49597870691667e-11],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ångström","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,8.46786664623715e-47],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,1.66053886282828e-27],["day","d",["day"],"time",!1,!0,86400],["degree","°",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,1.05457168181818e-34],["n.u. of mass","m?",null,"mass",!1,!1,9.10938261616162e-31],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,1.28808866778687e-21],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["œrsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","Ω",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestärke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ångström","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,8.95054210748189e31],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],u={Yi:["yobi",80,1.2089258196146292e24,"Yi","yotta"],Zi:["zebi",70,0x400000000000000000,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},o={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},l=null,i=null,f=t,m=n,s=1,F=1,M=0;M<a.length;M++)e=null===a[M][2]?[]:a[M][2],(a[M][1]===f||e.indexOf(f)>=0)&&(l=a[M]),(a[M][1]===m||e.indexOf(m)>=0)&&(i=a[M]);if(null===l){var c=u[t.substring(0,2)],N=o[t.substring(0,1)];"da"===t.substring(0,2)&&(N=["dekao",10,"da"]),c?(s=c[2],f=t.substring(2)):N&&(s=N[1],f=t.substring(N[2].length));for(var h=0;h<a.length;h++)e=null===a[h][2]?[]:a[h][2],(a[h][1]===f||e.indexOf(f)>=0)&&(l=a[h])}if(null===i){var p=u[n.substring(0,2)],E=o[n.substring(0,1)];"da"===n.substring(0,2)&&(E=["dekao",10,"da"]),p?(F=p[2],m=n.substring(2)):E&&(F=E[1],m=n.substring(E[2].length));for(var I=0;I<a.length;I++)e=null===a[I][2]?[]:a[I][2],(a[I][1]===m||e.indexOf(m)>=0)&&(i=a[I])}return null===l||null===i?"#N/A":l[3]!==i[3]?"#N/A":r*l[6]*s/(i[6]*F)},Formula.DEC2BIN=function(r,t){if(isNaN(r))return"#VALUE!";if(!/^-?[0-9]{1,3}$/.test(r)||r<-512||r>511)return"#NUM!";if(r<0)return"1"+_s.repeat("0",9-(512+r).toString(2).length)+(512+r).toString(2);var n=parseInt(r,10).toString(2);return"undefined"==typeof t?n:isNaN(t)?"#VALUE!":t<0?"#NUM!":(t=Math.floor(t),t>=n.length?_s.repeat("0",t-n.length)+n:"#NUM!")},Formula.DEC2HEX=function(r,t){if(isNaN(r))return"#VALUE!";if(!/^-?[0-9]{1,12}$/.test(r)||r<-549755813888||r>549755813887)return"#NUM!";if(r<0)return(1099511627776+r).toString(16);var n=parseInt(r,10).toString(16);return"undefined"==typeof t?n:isNaN(t)?"#VALUE!":t<0?"#NUM!":(t=Math.floor(t),t>=n.length?_s.repeat("0",t-n.length)+n:"#NUM!")},Formula.DEC2OCT=function(r,t){if(isNaN(r))return"#VALUE!";if(!/^-?[0-9]{1,9}$/.test(r)||r<-536870912||r>536870911)return"#NUM!";if(r<0)return(1073741824+r).toString(8);var n=parseInt(r,10).toString(8);return"undefined"==typeof t?n:isNaN(t)?"#VALUE!":t<0?"#NUM!":(t=Math.floor(t),t>=n.length?_s.repeat("0",t-n.length)+n:"#NUM!")},Formula.DELTA=function(r,t){return t="undefined"==typeof t?0:t,isNaN(r)||isNaN(t)?"#VALUE!":r===t?1:0},Formula.ERF=function(r,t){return t="undefined"==typeof t?0:t,isNaN(r)||isNaN(t)?"#VALUE!":jStat.erf(r)},Formula.ERFC=function(r){return isNaN(r)?"#VALUE!":jStat.erfc(r)},Formula.ERFCPRECISE=function(){},Formula.ERFPRECISE=function(){},Formula.GESTEP=function(r,t){return t="undefined"==typeof t?0:t,isNaN(r)||isNaN(t)?"#VALUE!":r>=t?1:0},Formula.HEX2BIN=function(r,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(r))return"#NUM!";var n=10===r.length&&"f"===r.substring(0,1).toLowerCase(),e=n?parseInt(r,16)-1099511627776:parseInt(r,16);if(e<-512||e>511)return"#NUM!";if(n)return"1"+_s.repeat("0",9-(512+e).toString(2).length)+(512+e).toString(2);var a=e.toString(2);return"undefined"==typeof t?a:isNaN(t)?"#VALUE!":t<0?"#NUM!":(t=Math.floor(t),t>=a.length?_s.repeat("0",t-a.length)+a:"#NUM!")},Formula.HEX2DEC=function(r){if(!/^[0-9A-Fa-f]{1,10}$/.test(r))return"#NUM!";var t=parseInt(r,16);return t>=549755813888?t-1099511627776:t},Formula.HEX2OCT=function(r,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(r))return"#NUM!";var n=parseInt(r,16);if(n>536870911&&n<0xffe0000000)return"#NUM!";if(n>=0xffe0000000)return(n-0xffc0000000).toString(8);var e=n.toString(8);return"undefined"==typeof t?e:isNaN(t)?"#VALUE!":t<0?"#NUM!":(t=Math.floor(t),t>=e.length?_s.repeat("0",t-e.length)+e:"#NUM!")},Formula.IMABS=function(r){var t=Formula.IMREAL(r),n=Formula.IMAGINARY(r);return"#NUM!"===t||"#NUM!"===n?"#NUM!":Math.sqrt(Math.pow(t,2)+Math.pow(n,2))},Formula.IMAGINARY=function(r){if(0===r||"0"===r)return 0;if(["i","j"].indexOf(r)>=0)return 1;r=r.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j");var t=r.indexOf("+"),n=r.indexOf("-");0===t&&(t=r.indexOf("+",1)),0===n&&(n=r.indexOf("-",1));var e=r.substring(r.length-1,r.length),a="i"===e||"j"===e;return t>=0||n>=0?a?t>=0?isNaN(r.substring(0,t))||isNaN(r.substring(t+1,r.length-1))?"#NUM!":Number(r.substring(t+1,r.length-1)):isNaN(r.substring(0,n))||isNaN(r.substring(n+1,r.length-1))?"#NUM!":-Number(r.substring(n+1,r.length-1)):"#NUM!":a?isNaN(r.substring(0,r.length-1))?"#NUM!":r.substring(0,r.length-1):isNaN(r)?"#NUM!":0},Formula.IMARGUMENT=function(r){var t=Formula.IMREAL(r),n=Formula.IMAGINARY(r);return"#NUM!"===t||"#NUM!"===n?"#NUM!":0===t&&0===n?"#DIV/0!":0===t&&n>0?Math.PI/2:0===t&&n<0?-Math.PI/2:0===n&&t>0?0:0===n&&t<0?-Math.PI:t>0?Math.atan(n/t):t<0&&n>=0?Math.atan(n/t)+Math.PI:Math.atan(n/t)-Math.PI},Formula.IMCONJUGATE=function(r){var t=Formula.IMREAL(r),n=Formula.IMAGINARY(r),e=r.substring(r.length-1);return e="i"===e||"j"===e?e:"i","#NUM!"===t||"#NUM!"===n?"#NUM!":0!==n?Formula.COMPLEX(t,-n,e):r},Formula.IMCOS=function(r){if(r===!0||r===!1)return"#VALUE!";var t=Formula.IMREAL(r),n=Formula.IMAGINARY(r),e=r.substring(r.length-1);return e="i"===e||"j"===e?e:"i","#NUM!"===t||"#NUM!"===n?"#NUM!":Formula.COMPLEX(Math.cos(t)*(Math.exp(n)+Math.exp(-n))/2,-Math.sin(t)*(Math.exp(n)-Math.exp(-n))/2,e)},Formula.IMCOSH=function(r){if(r===!0||r===!1)return"#VALUE!";var t=Formula.IMREAL(r),n=Formula.IMAGINARY(r),e=r.substring(r.length-1);return e="i"===e||"j"===e?e:"i","#NUM!"===t||"#NUM!"===n?"#NUM!":Formula.COMPLEX(Math.cos(n)*(Math.exp(t)+Math.exp(-t))/2,Math.sin(n)*(Math.exp(t)-Math.exp(-t))/2,e)},Formula.IMCOT=function(r){if(r===!0||r===!1)return"#VALUE!";var t=Formula.IMREAL(r),n=Formula.IMAGINARY(r);return"#NUM!"===t||"#NUM!"===n?"#NUM!":Formula.IMDIV(Formula.IMCOS(r),Formula.IMSIN(r))},Formula.IMCSC=function(r){if(r===!0||r===!1)return"#VALUE!";var t=Formula.IMREAL(r),n=Formula.IMAGINARY(r);return"#NUM!"===t||"#NUM!"===n?"#NUM!":Formula.IMDIV("1",Formula.IMSIN(r))},Formula.IMCSCH=function(r){if(r===!0||r===!1)return"#VALUE!";var t=Formula.IMREAL(r),n=Formula.IMAGINARY(r);return"#NUM!"===t||"#NUM!"===n?"#NUM!":Formula.IMDIV("1",Formula.IMSINH(r))},Formula.IMDIV=function(r,t){var n=Formula.IMREAL(r),e=Formula.IMAGINARY(r),a=Formula.IMREAL(t),u=Formula.IMAGINARY(t),o=r.substring(r.length-1),l=r.substring(r.length-1),i="i";if("j"===o?i="j":"j"===l&&(i="j"),"#NUM!"===n||"#NUM!"===e||"#NUM!"===a||"#NUM!"===u)return"#NUM!";if(0===a&&0===u)return"#NUM!";var f=a*a+u*u;return Formula.COMPLEX((n*a+e*u)/f,(e*a-n*u)/f,i)},Formula.IMEXP=function(r){var t=Formula.IMREAL(r),n=Formula.IMAGINARY(r),e=r.substring(r.length-1);if(e="i"===e||"j"===e?e:"i","#NUM!"===t||"#NUM!"===n)return"#NUM!";var a=Math.exp(t);return Formula.COMPLEX(a*Math.cos(n),a*Math.sin(n),e)},Formula.IMLN=function(r){var t=Formula.IMREAL(r),n=Formula.IMAGINARY(r),e=r.substring(r.length-1);return e="i"===e||"j"===e?e:"i","#NUM!"===t||"#NUM!"===n?"#NUM!":Formula.COMPLEX(Math.log(Math.sqrt(t*t+n*n)),Math.atan(n/t),e)},Formula.IMLOG10=function(r){var t=Formula.IMREAL(r),n=Formula.IMAGINARY(r),e=r.substring(r.length-1);return e="i"===e||"j"===e?e:"i","#NUM!"===t||"#NUM!"===n?"#NUM!":Formula.COMPLEX(Math.log(Math.sqrt(t*t+n*n))/Math.log(10),Math.atan(n/t)/Math.log(10),e)},Formula.IMLOG2=function(r){var t=Formula.IMREAL(r),n=Formula.IMAGINARY(r),e=r.substring(r.length-1);return e="i"===e||"j"===e?e:"i","#NUM!"===t||"#NUM!"===n?"#NUM!":Formula.COMPLEX(Math.log(Math.sqrt(t*t+n*n))/Math.log(2),Math.atan(n/t)/Math.log(2),e)},Formula.IMPOWER=function(r,t){if(isNaN(t))return"#VALUE!";var n=Formula.IMREAL(r),e=Formula.IMAGINARY(r),a=r.substring(r.length-1);if(a="i"===a||"j"===a?a:"i","#NUM!"===n||"#NUM!"===e)return"#NUM!";var u=Math.pow(Formula.IMABS(r),t),o=Formula.IMARGUMENT(r);return Formula.COMPLEX(u*Math.cos(t*o),u*Math.sin(t*o),a)},Formula.IMPRODUCT=function(){for(var r=arguments[0],t=1;t<arguments.length;t++){var n=Formula.IMREAL(r),e=Formula.IMAGINARY(r),a=Formula.IMREAL(arguments[t]),u=Formula.IMAGINARY(arguments[t]);if("#NUM!"===n||"#NUM!"===e||"#NUM!"===a||"#NUM!"===u)return"#NUM!";r=Formula.COMPLEX(n*a-e*u,n*u+e*a)}return r},Formula.IMREAL=function(r){if(0===r||"0"===r)return 0;if(["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(r)>=0)return 0;var t=r.indexOf("+"),n=r.indexOf("-");0===t&&(t=r.indexOf("+",1)),0===n&&(n=r.indexOf("-",1));var e=r.substring(r.length-1,r.length),a="i"===e||"j"===e;return t>=0||n>=0?a?t>=0?isNaN(r.substring(0,t))||isNaN(r.substring(t+1,r.length-1))?"#NUM!":Number(r.substring(0,t)):isNaN(r.substring(0,n))||isNaN(r.substring(n+1,r.length-1))?"#NUM!":Number(r.substring(0,n)):"#NUM!":a?isNaN(r.substring(0,r.length-1))?"#NUM!":0:isNaN(r)?"#NUM!":r},Formula.IMSEC=function(r){if(r===!0||r===!1)return"#VALUE!";var t=Formula.IMREAL(r),n=Formula.IMAGINARY(r);return"#NUM!"===t||"#NUM!"===n?"#NUM!":Formula.IMDIV("1",Formula.IMCOS(r))},Formula.IMSECH=function(r){if(r===!0||r===!1)return"#VALUE!";var t=Formula.IMREAL(r),n=Formula.IMAGINARY(r);return"#NUM!"===t||"#NUM!"===n?"#NUM!":Formula.IMDIV("1",Formula.IMCOSH(r))},Formula.IMSIN=function(r){if(r===!0||r===!1)return"#VALUE!";var t=Formula.IMREAL(r),n=Formula.IMAGINARY(r),e=r.substring(r.length-1);return e="i"===e||"j"===e?e:"i","#NUM!"===t||"#NUM!"===n?"#NUM!":Formula.COMPLEX(Math.sin(t)*(Math.exp(n)+Math.exp(-n))/2,Math.cos(t)*(Math.exp(n)-Math.exp(-n))/2,e)},Formula.IMSINH=function(r){if(r===!0||r===!1)return"#VALUE!";var t=Formula.IMREAL(r),n=Formula.IMAGINARY(r),e=r.substring(r.length-1);return e="i"===e||"j"===e?e:"i","#NUM!"===t||"#NUM!"===n?"#NUM!":Formula.COMPLEX(Math.cos(n)*(Math.exp(t)-Math.exp(-t))/2,Math.sin(n)*(Math.exp(t)+Math.exp(-t))/2,e)},Formula.IMSQRT=function(r){var t=Formula.IMREAL(r),n=Formula.IMAGINARY(r),e=r.substring(r.length-1);if(e="i"===e||"j"===e?e:"i","#NUM!"===t||"#NUM!"===n)return"#NUM!";var a=Math.sqrt(Formula.IMABS(r)),u=Formula.IMARGUMENT(r);return Formula.COMPLEX(a*Math.cos(u/2),a*Math.sin(u/2),e)},Formula.IMSUB=function(r,t){var n=Formula.IMREAL(r),e=Formula.IMAGINARY(r),a=Formula.IMREAL(t),u=Formula.IMAGINARY(t),o=r.substring(r.length-1),l=r.substring(r.length-1),i="i";return"j"===o?i="j":"j"===l&&(i="j"),"#NUM!"===n||"#NUM!"===e||"#NUM!"===a||"#NUM!"===u?"#NUM!":Formula.COMPLEX(n-a,e-u,i)},Formula.IMSUM=function(){for(var r=arguments[0],t=1;t<arguments.length;t++){var n=Formula.IMREAL(r),e=Formula.IMAGINARY(r),a=Formula.IMREAL(arguments[t]),u=Formula.IMAGINARY(arguments[t]);if("#NUM!"===n||"#NUM!"===e||"#NUM!"===a||"#NUM!"===u)return"#NUM!";
r=Formula.COMPLEX(n+a,e+u)}return r},Formula.IMTAN=function(r){if(r===!0||r===!1)return"#VALUE!";var t=Formula.IMREAL(r),n=Formula.IMAGINARY(r);return"#NUM!"===t||"#NUM!"===n?"#NUM!":Formula.IMDIV(Formula.IMSIN(r),Formula.IMCOS(r))},Formula.OCT2BIN=function(r,t){if(!/^[0-7]{1,10}$/.test(r))return"#NUM!";var n=10===r.length&&"7"===r.substring(0,1),e=n?parseInt(r,8)-1073741824:parseInt(r,8);if(e<-512||e>511)return"#NUM!";if(n)return"1"+_s.repeat("0",9-(512+e).toString(2).length)+(512+e).toString(2);var a=e.toString(2);return"undefined"==typeof t?a:isNaN(t)?"#VALUE!":t<0?"#NUM!":(t=Math.floor(t),t>=a.length?_s.repeat("0",t-a.length)+a:"#NUM!")},Formula.OCT2DEC=function(r){if(!/^[0-7]{1,10}$/.test(r))return"#NUM!";var t=parseInt(r,8);return t>=536870912?t-1073741824:t},Formula.OCT2HEX=function(r,t){if(!/^[0-7]{1,10}$/.test(r))return"#NUM!";var n=parseInt(r,8);if(n>=536870912)return"ff"+(n+3221225472).toString(16);var e=n.toString(16);return"undefined"==typeof t?e:isNaN(t)?"#VALUE!":t<0?"#NUM!":(t=Math.floor(t),t>=e.length?_s.repeat("0",t-e.length)+e:"#NUM!")},Formula.ACCRINT=function(r,t,n,e,a,u,o,l){if(!moment(r).isValid()||!moment(t).isValid()||!moment(n).isValid())return"#VALUE!";if(e<=0||a<=0)return"#NUM!";if([1,2,4].indexOf(u)===-1)return"#NUM!";if([0,1,2,3,4].indexOf(o)===-1)return"#NUM!";if(moment(r).diff(moment(n))>=0)return"#NUM!";a="undefined"==typeof a?0:a,o="undefined"==typeof o?0:o,l="undefined"==typeof l||l;var i=0,f=moment(new Date(r));moment(new Date(t)),moment(new Date(n)),moment([f.year()]).isLeapYear()?366:365;switch(o){case 0:i=Formula.YEARFRAC(r,n,o);break;case 1:i=Formula.YEARFRAC(r,n,o);break;case 2:i=Formula.YEARFRAC(r,n,o);break;case 3:i=Formula.YEARFRAC(r,n,o);break;case 4:i=Formula.YEARFRAC(r,n,o)}return a*e*i},Formula.ACCRINTM=function(){},Formula.AMORDEGRC=function(){},Formula.AMORLINC=function(){},Formula.COUPDAYBS=function(){},Formula.COUPDAYS=function(){},Formula.COUPDAYSNC=function(){},Formula.COUPNCD=function(){},Formula.COUPNUM=function(){},Formula.COUPPCD=function(){},Formula.CUMIPMT=function(rate,periods,value,start,end,type){if(rate=eval(rate),periods=eval(periods),rate<=0||periods<=0||value<=0)return"#NUM!";if(start<1||end<1||start>end)return"#NUM!";if(0!==type&&1!==type)return"#NUM!";var payment=Formula.PMT(rate,periods,value,0,type),interest=0;1===start&&0===type&&(interest=-value,start++);for(var i=start;i<=end;i++)interest+=1===type?Formula.FV(rate,i-2,payment,value,1)-payment:Formula.FV(rate,i-1,payment,value,0);return interest*=rate},Formula.CUMPRINC=function(rate,periods,value,start,end,type){if(rate=eval(rate),periods=eval(periods),rate<=0||periods<=0||value<=0)return"#NUM!";if(start<1||end<1||start>end)return"#NUM!";if(0!==type&&1!==type)return"#NUM!";var payment=Formula.PMT(rate,periods,value,0,type),principal=0;1===start&&(principal=0===type?payment+value*rate:payment,start++);for(var i=start;i<=end;i++)principal+=type>0?payment-(Formula.FV(rate,i-2,payment,value,1)-payment)*rate:payment-Formula.FV(rate,i-1,payment,value,0)*rate;return principal},Formula.DB=function(r,t,n,e,a){if(a="undefined"==typeof a?12:a,isNaN(r)||isNaN(t)||isNaN(n)||isNaN(e)||isNaN(a))return"#VALUE!";if(r<0||t<0||n<0||e<0)return"#NUM!";if([1,2,3,4,5,6,7,8,9,10,11,12].indexOf(a)===-1)return"#NUM!";if(e>n)return"#NUM!";if(t>=r)return 0;for(var u=(1-Math.pow(t/r,1/n)).toFixed(3),o=r*u*a/12,l=o,i=0,f=e===n?n-1:e,m=2;m<=f;m++)i=(r-l)*u,l+=i;return 1===e?o:e===n?(r-l)*u:i},Formula.DDB=function(r,t,n,e,a){if(a="undefined"==typeof a?2:a,isNaN(r)||isNaN(t)||isNaN(n)||isNaN(e)||isNaN(a))return"#VALUE!";if(r<0||t<0||n<0||e<0||a<=0)return"#NUM!";if(e>n)return"#NUM!";if(t>=r)return 0;for(var u=0,o=0,l=1;l<=e;l++)o=Math.min((r-u)*(a/n),r-t-u),u+=o;return o},Formula.DISC=function(){},Formula.DOLLARDE=function(r,t){if(isNaN(r)||isNaN(t))return"#VALUE!";if(t<0)return"#NUM!";if(t>=0&&t<1)return"#DIV/0!";t=parseInt(t,10);var n=parseInt(r,10);n+=r%1*Math.pow(10,Math.ceil(Math.log(t)/Math.LN10))/t;var e=Math.pow(10,Math.ceil(Math.log(t)/Math.LN2)+1);return n=Math.round(n*e)/e},Formula.DOLLARFR=function(r,t){if(isNaN(r)||isNaN(t))return"#VALUE!";if(t<0)return"#NUM!";if(t>=0&&t<1)return"#DIV/0!";t=parseInt(t,10);var n=parseInt(r,10);return n+=r%1*Math.pow(10,-Math.ceil(Math.log(t)/Math.LN10))*t},Formula.DURATION=function(){},Formula.EFFECT=function(r,t){return isNaN(r)||isNaN(t)?"#VALUE!":r<=0||t<1?"#NUM!":(t=parseInt(t,10),Math.pow(1+r/t,t)-1)},Formula.FV=function(rate,periods,payment,value,type){type="undefined"==typeof type?0:type,rate=eval(rate);var result;if(0===rate)result=value+payment*periods;else{var term=Math.pow(1+rate,periods);result=1===type?value*term+payment*(1+rate)*(term-1)/rate:value*term+payment*(term-1)/rate}return-result},Formula.FVSCHEDULE=function(r,t){for(var n=r,e=0;e<t.length;e++){if(isNaN(t[e]))return"#VALUE!";n*=1+t[e]}return n},Formula.INTRATE=function(){},Formula.IPMT=function(rate,period,periods,present,future,type){type="undefined"==typeof type?0:type,rate=eval(rate),periods=eval(periods);var payment=Formula.PMT(rate,periods,present,future,type),interest;return interest=1===period?1===type?0:-present:1===type?Formula.FV(rate,period-2,payment,present,1)-payment:Formula.FV(rate,period-1,payment,present,0),interest*rate},Formula.IRR=function(r,t){for(var n=function(r,t,n){for(var e=n+1,a=r[0],u=1;u<r.length;u++)a+=r[u]/Math.pow(e,(t[u]-t[0])/365);return a},e=function(r,t,n){for(var e=n+1,a=0,u=1;u<r.length;u++){var o=(t[u]-t[0])/365;a-=o*r[u]/Math.pow(e,o+1)}return a},a=[],u=!1,o=!1,l=0;l<r.length;l++)a[l]=0===l?0:a[l-1]+365,r[l]>0&&(u=!0),r[l]<0&&(o=!0);if(!u||!o)return"#NUM!";t="undefined"==typeof t?.1:t;var i,f,m,s=t,F=1e-10,M=50,c=0,N=!0;do m=n(r,a,s),i=s-m/e(r,a,s),f=Math.abs(i-s),s=i,N=f>F&&Math.abs(m)>F;while(N&&++c<M);return N?"#NUM!":s},Formula.ISPMT=function(rate,period,periods,value){return rate=eval(rate),periods=eval(periods),value*rate*(period/periods-1)},Formula.MDURATION=function(){},Formula.MIRR=function(r,t,n){for(var e=r.length,a=[],u=[],o=0;o<e;o++)r[o]<0?a.push(r[o]):u.push(r[o]);var l=-Formula.NPV(n,u)*Math.pow(1+n,e-1),i=Formula.NPV(t,a)*(1+t);return Math.pow(l/i,1/(e-1))-1},Formula.NOMINAL=function(r,t){return isNaN(r)||isNaN(t)?"#VALUE!":r<=0||t<1?"#NUM!":(t=parseInt(t,10),(Math.pow(r+1,1/t)-1)*t)},Formula.NPER=function(rate,payment,present,future,type){type="undefined"==typeof type?0:type,future="undefined"==typeof future?0:future,rate=eval(rate);var num=payment*(1+rate*type)-future*rate,den=present*rate+payment*(1+rate*type);return Math.log(num/den)/Math.log(1+rate)},Formula.NPV=function(){for(var r=[],t=0;t<arguments.length;t++)r=r.concat(arguments[t]);for(var n=r[0],e=0,a=1;a<r.length;a++)e+=r[a]/Math.pow(1+n,a);return e},Formula.ODDFPRICE=function(){},Formula.ODDFYIELD=function(){},Formula.ODDLPRICE=function(){},Formula.ODDLYIELD=function(){},Formula.PDURATION=function(r,t,n){return isNaN(r)||isNaN(t)||isNaN(n)?"#VALUE!":r<=0?"#NUM!":(Math.log(n)-Math.log(t))/Math.log(1+r)},Formula.PMT=function(rate,periods,present,future,type){type="undefined"==typeof type?0:type,rate=eval(rate),periods=eval(periods);var result;if(0===rate)result=(present+future)/periods;else{var term=Math.pow(1+rate,periods);result=1===type?(future*rate/(term-1)+present*rate/(1-1/term))/(1+rate):future*rate/(term-1)+present*rate/(1-1/term)}return-result},Formula.PPMT=function(r,t,n,e,a,u){return Formula.PMT(r,n,e,a,u)-Formula.IPMT(r,t,n,e,a,u)},Formula.PRICE=function(){},Formula.PRICEDISC=function(){},Formula.PRICEMAT=function(){},Formula.PV=function(rate,periods,payment,future,type){return type="undefined"==typeof type?0:type,rate=eval(rate),periods=eval(periods),0===rate?-payment*periods-future:((1-Math.pow(1+rate,periods))/rate*payment*(1+rate*type)-future)/Math.pow(1+rate,periods)},Formula.RATE=function(periods,payment,present,future,type,guess){guess="undefined"==typeof guess?.01:guess,future="undefined"==typeof future?0:future,type="undefined"==typeof type?0:type,periods=eval(periods);var epsMax=1e-10,iterMax=50,y,y0,y1,x0,x1=0,f=0,i=0,rate=guess;for(Math.abs(rate)<epsMax?y=present*(1+periods*rate)+payment*(1+rate*type)*periods+future:(f=Math.exp(periods*Math.log(1+rate)),y=present*f+payment*(1/rate+type)*(f-1)+future),y0=present+payment*periods+future,y1=present*f+payment*(1/rate+type)*(f-1)+future,i=x0=0,x1=rate;Math.abs(y0-y1)>epsMax&&i<iterMax;)rate=(y1*x0-y0*x1)/(y1-y0),x0=x1,x1=rate,Math.abs(rate)<epsMax?y=present*(1+periods*rate)+payment*(1+rate*type)*periods+future:(f=Math.exp(periods*Math.log(1+rate)),y=present*f+payment*(1/rate+type)*(f-1)+future),y0=y1,y1=y,++i;return rate},Formula.RECEIVED=function(){},Formula.RRI=function(r,t,n){return isNaN(r)||isNaN(t)||isNaN(n)?"#VALUE!":0===r||0===t?"#NUM!":Math.pow(n/t,1/r)-1},Formula.SLN=function(r,t,n){return isNaN(r)||isNaN(t)||isNaN(n)?"#VALUE!":0===n?"#NUM!":(r-t)/n},Formula.SYD=function(r,t,n,e){return isNaN(r)||isNaN(t)||isNaN(n)||isNaN(e)?"#VALUE!":0===n?"#NUM!":e<1||e>n?"#NUM!":(e=parseInt(e,10),(r-t)*(n-e+1)*2/(n*(n+1)))},Formula.TBILLEQ=function(r,t,n){return moment(r).isValid()&&moment(t).isValid()?n<=0?"#NUM!":moment(r).diff(moment(t))>0?"#NUM!":moment(t).diff(moment(r),"years")>1?"#NUM!":365*n/(360-n*Formula.DAYS360(r,t)):"#VALUE!"},Formula.TBILLPRICE=function(r,t,n){return moment(r).isValid()&&moment(t).isValid()?n<=0?"#NUM!":moment(r).diff(moment(t))>0?"#NUM!":moment(t).diff(moment(r),"years")>1?"#NUM!":100*(1-n*Formula.DAYS360(r,t)/360):"#VALUE!"},Formula.TBILLYIELD=function(r,t,n){return moment(r).isValid()&&moment(t).isValid()?n<=0?"#NUM!":moment(r).diff(moment(t))>0?"#NUM!":moment(t).diff(moment(r),"years")>1?"#NUM!":360*(100-n)/(n*Formula.DAYS360(r,t)):"#VALUE!"},Formula.VDB=function(){},Formula.XIRR=function(r,t,n){for(var e=function(r,t,n){for(var e=n+1,a=r[0],u=1;u<r.length;u++)a+=r[u]/Math.pow(e,moment(t[u]).diff(moment(t[0]),"days")/365);return a},a=function(r,t,n){for(var e=n+1,a=0,u=1;u<r.length;u++){var o=moment(t[u]).diff(moment(t[0]),"days")/365;a-=o*r[u]/Math.pow(e,o+1)}return a},u=!1,o=!1,l=0;l<r.length;l++)r[l]>0&&(u=!0),r[l]<0&&(o=!0);if(!u||!o)return"#NUM!";n=n||.1;var i,f,m,s=n,F=1e-10,M=50,c=0,N=!0;do m=e(r,t,s),i=s-m/a(r,t,s),f=Math.abs(i-s),s=i,N=f>F&&Math.abs(m)>F;while(N&&++c<M);return N?"#NUM!":s},Formula.XNPV=function(r,t,n){for(var e=0,a=0;a<t.length;a++)e+=t[a]/Math.pow(1+r,moment(n[a]).diff(moment(n[0]),"days")/365);return e},Formula.YIELD=function(){},Formula.YIELDDISC=function(){},Formula.YIELDMAT=function(){},Formula.ISNUMBER=function(r){return!(isNaN(parseFloat(r))||!isFinite(r))},Formula.AND=function(){for(var r=!0,t=0;t<arguments.length;t++)arguments[t]||(r=!1);return r},Formula.FALSE=function(){return!1},Formula.SWITCH=function(){var r;if(arguments.length>0){var t=arguments[0],n=arguments.length-1,e=Math.floor(n/2),a=!1,u=n%2===0?null:arguments[arguments.length-1];if(e)for(var o=0;o<e;o++)if(t===arguments[2*o+1]){r=arguments[2*o+2],a=!0;break}!a&&u&&(r=u)}return r},Formula.IF=function(r,t,n){return r?"undefined"==typeof t||t:"undefined"==typeof n||n},Formula.IFERROR=function(r,t){return["#DIV/0!","#N/A","#NAME?","#NUM!","#NULL!","#REF!","#VALUE!"].indexOf(r)>=0?t:r},Formula.IFNA=function(r,t){return"#N/A"===r?t:r},Formula.NOT=function(r){return!r},Formula.OR=function(){for(var r=!1,t=0;t<arguments.length;t++)arguments[t]&&(r=!0);return r},Formula.TRUE=function(){return!0},Formula.XOR=function(){for(var r=0,t=0;t<arguments.length;t++)arguments[t]&&r++;return!!(1&Math.floor(Math.abs(r)))},Formula.REFERENCE=function(r,t){try{var n=t.split("."),e=r;return _(n).forEach(function(r){if("]"===r[r.length-1]){var t=r.indexOf("["),n=r.substring(t+1,r.length-1);e=e[r.substring(0,t)][n]}else e=e[r]}),e}catch(r){return}},Formula.ABS=function(r){return Math.abs(r)},Formula.ACOS=function(r){return Math.acos(r)},Formula.ACOSH=function(r){return Math.log(r+Math.sqrt(r*r-1))},Formula.ACOT=function(r){return Math.atan(1/r)},Formula.ACOTH=function(r){return.5*Math.log((r+1)/(r-1))},Formula.AGGREGATE=function(r,t){for(var n=[],e=2;e<arguments.length;e++)switch(r){case 1:n[e-2]=Formula.AVERAGE(arguments[e]);break;case 2:n[e-2]=Formula.COUNT(arguments[e]);break;case 3:n[e-2]=Formula.COUNTA(arguments[e]);break;case 4:n[e-2]=Formula.MAX(arguments[e]);break;case 5:n[e-2]=Formula.MIN(arguments[e]);break;case 6:n[e-2]=Formula.PRODUCT(arguments[e]);break;case 7:n[e-2]=Formula.STDEVS(arguments[e]);break;case 8:n[e-2]=Formula.STDEVP(arguments[e]);break;case 9:n[e-2]=Formula.SUM(arguments[e]);break;case 10:n[e-2]=Formula.VARS(arguments[e]);break;case 11:n[e-2]=Formula.VARP(arguments[e]);break;case 12:n[e-2]=Formula.MEDIAN(arguments[e]);break;case 13:n[e-2]=Formula.MODESNGL(arguments[e]);break;case 14:n[e-2]=Formula.LARGE(arguments[e]);break;case 15:n[e-2]=Formula.SMALL(arguments[e]);break;case 16:n[e-2]=Formula.PERCENTILEINC(arguments[e]);break;case 17:n[e-2]=Formula.QUARTILEINC(arguments[e]);break;case 18:n[e-2]=Formula.PERCENTILEEXC(arguments[e]);break;case 19:n[e-2]=Formula.QUARTILEEXC(arguments[e])}return n},Formula.ARABIC=function(r){if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(r))throw new Error("Incorrect roman number");var t=0;return r.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(r){t+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[r]}),t},Formula.ASIN=function(r){return Math.asin(r)},Formula.ASINH=function(r){return Math.log(r+Math.sqrt(r*r+1))},Formula.ATAN=function(r){return Math.atan(r)},Formula.ATAN2=function(r,t){return Math.atan2(r,t)},Formula.ATANH=function(r){return Math.log((1+r)/(1-r))/2},Formula.BASE=function(r,t,n){n="undefined"==typeof n?0:n;var e=r.toString(t);return new Array(Math.max(n+1-e.length,0)).join("0")+e},Formula.CEILING=function(r,t,n){if(0===t)return 0;t="undefined"==typeof t?1:Math.abs(t),n="undefined"==typeof n?0:n;var e=-Math.floor(Math.log(t)/Math.log(10));return r>=0?Formula.ROUND(Math.ceil(r/t)*t,e):0===n?-Formula.ROUND(Math.floor(Math.abs(r)/t)*t,e):-Formula.ROUND(Math.ceil(Math.abs(r)/t)*t,e)},Formula.CEILINGMATH=Formula.CEILING,Formula.CEILINGPRECISE=Formula.CEILING,Formula.COMBIN=function(r,t){return Formula.FACT(r)/(Formula.FACT(t)*Formula.FACT(r-t))},Formula.COMBINA=function(r,t){return 0===r&&0===t?1:Formula.COMBIN(r+t-1,r-1)},Formula.COS=function(r){return Math.cos(r)},Formula.COSH=function(r){return(Math.exp(r)+Math.exp(-r))/2},Formula.COT=function(r){return 1/Math.tan(r)},Formula.COTH=function(r){var t=Math.exp(2*r);return(t+1)/(t-1)},Formula.CSC=function(r){return 1/Math.sin(r)},Formula.CSCH=function(r){return 2/(Math.exp(r)-Math.exp(-r))},Formula.DECIMAL=function(r,t){return parseInt(r,t)},Formula.DEGREES=function(r){return 180*r/Math.PI},Formula.EVEN=function(r){return Formula.CEILING(r,-2,-1)},Formula.EXP=function(r){return Math.exp(r)},Formula.FACT=function(r){var t=Math.floor(r);return 0===t||1===t?1:MEMOIZED_FACT[t]>0?MEMOIZED_FACT[t]:(MEMOIZED_FACT[t]=Formula.FACT(t-1)*t,MEMOIZED_FACT[t])},Formula.FACTDOUBLE=function(r){var t=Math.floor(r);return t<=0?1:t*Formula.FACTDOUBLE(t-2)},Formula.FLOOR=function(r,t,n){if(0===t)return 0;t="undefined"==typeof t?1:Math.abs(t),n="undefined"==typeof n?0:n;var e=-Math.floor(Math.log(t)/Math.log(10));return r>=0?Formula.ROUND(Math.floor(r/t)*t,e):0===n?-Formula.ROUND(Math.ceil(Math.abs(r)/t)*t,e):-Formula.ROUND(Math.floor(Math.abs(r)/t)*t,e)},Formula.FLOORMATH=Formula.FLOOR,Formula.FLOORPRECISE=Formula.FLOOR,Formula.GCD=function(){for(var r,t,n=arguments.length-1,e=arguments[n];n;)for(t=arguments[--n];r=t%e;t=e,e=r);return e},Formula.INT=function(r){return Math.floor(r)},Formula.ISEVEN=function(r){return!(1&Math.floor(Math.abs(r)))},Formula.ISOCEILING=Formula.CEILING,Formula.ISODD=function(r){return!!(1&Math.floor(Math.abs(r)))},Formula.LCM=function(){for(var r,t,n,e,a=Formula.ARGSTOARRAY(arguments),u=1;void 0!==(n=a.pop());)for(;n>1;){if(n%2){for(r=3,t=Math.floor(Math.sqrt(n));r<=t&&n%r;r+=2);e=r<=t?r:n}else e=2;for(n/=e,u*=e,r=a.length;r;a[--r]%e===0&&1===(a[r]/=e)&&a.splice(r,1));}return u},Formula.LN=function(r){return Math.log(r)},Formula.LOG=function(r,t){return t="undefined"==typeof t?10:t,Math.log(r)/Math.log(t)},Formula.LOG10=function(r){return Math.log(r)/Math.log(10)},Formula.MDETERM=numeric.det,Formula.MINVERSE=numeric.inv,Formula.MMULT=numeric.dot,Formula.MOD=function(r,t){var n=Math.abs(r%t);return t>0?n:-n},Formula.MROUND=function(r,t){if(r*t<0)throw new Error("Number and multiple must have the same sign.");return Math.round(r/t)*t},Formula.MULTINOMIAL=function(){for(var r=0,t=1,n=0;n<arguments.length;n++)r+=arguments[n],t*=Formula.FACT(arguments[n]);return Formula.FACT(r)/t},Formula.MUNIT=numeric.identity,Formula.ODD=function(r){var t=Math.ceil(Math.abs(r));return t=1&t?t:t+1,r>0?t:-t},Formula.PI=function(){return Math.PI},Formula.POWER=function(r,t){return Math.pow(r,t)},Formula.PRODUCT=function(){for(var r=1,t=0;t<arguments.length;t++)r*=arguments[t];return r},Formula.QUOTIENT=function(r,t){return(r/t).toFixed(0)},Formula.RADIANS=function(r){return r*Math.PI/180},Formula.RAND=function(){return Math.random()},Formula.RANDBETWEEN=function(r,t){return r+Math.ceil((t-r+1)*Math.random())-1},Formula.ROUND=function(r,t){return Math.round(r*Math.pow(10,t))/Math.pow(10,t)},Formula.ROUNDDOWN=function(r,t){var n=r>0?1:-1;return n*Math.floor(Math.abs(r)*Math.pow(10,t))/Math.pow(10,t)},Formula.ROUNDUP=function(r,t){var n=r>0?1:-1;return n*Math.ceil(Math.abs(r)*Math.pow(10,t))/Math.pow(10,t)},Formula.SERIESSUM=function(r,t,n,e){for(var a=e[0]*Math.pow(r,t),u=1;u<e.length;u++)a+=e[u]*Math.pow(r,t+u*n);return a},Formula.SEC=function(r){return 1/Math.cos(r)},Formula.SECH=function(r){return 2/(Math.exp(r)+Math.exp(-r))},Formula.SIGN=function(r){return r<0?-1:0===r?0:1},Formula.SIN=function(r){return Math.sin(r)},Formula.SINH=function(r){return(Math.exp(r)-Math.exp(-r))/2},Formula.SQRT=function(r){return Math.sqrt(r)},Formula.SQRTPI=function(r){return Math.sqrt(r*Math.PI)},Formula.SUBTOTAL=function(r){for(var t=[],n=1;n<arguments.length;n++)switch(r){case 1:t[n-1]=Formula.AVERAGE(arguments[n]);break;case 2:t[n-1]=Formula.COUNT(arguments[n]);break;case 3:t[n-1]=Formula.COUNTA(arguments[n]);break;case 4:t[n-1]=Formula.MAX(arguments[n]);break;case 5:t[n-1]=Formula.MIN(arguments[n]);break;case 6:t[n-1]=Formula.PRODUCT(arguments[n]);break;case 7:t[n-1]=Formula.STDEV(arguments[n]);break;case 8:t[n-1]=Formula.STDEVP(arguments[n]);break;case 9:t[n-1]=Formula.SUM(arguments[n]);break;case 10:t[n-1]=Formula.VAR(arguments[n]);break;case 11:t[n-1]=Formula.VARP(arguments[n])}return t},Formula.SUM=function(){for(var r=Formula.ARGSTOARRAY(arguments),t=0,n=0;n<r.length;n++)if(r[n]instanceof Array)for(var e=0;e<r[n].length;e++)t+=Formula.ISNUMBER(r[n][e])?r[n][e]:0;else t+=Formula.ISNUMBER(r[n])?r[n]:0;return t},Formula.SUMIF=function(range,criteria){for(var result=0,i=0;i<range.length;i++)result+=eval(range[i]+criteria)?range[i]:0;return result},Formula.SUMIFS=function(){for(var criteria=(arguments.length-1)/2,range=arguments[0],result=0,i=0;i<range.length;i++){for(var fit=!0,j=0;j<criteria;j++)eval(arguments[2*j+1][i]+arguments[2*j+2])||(fit=!1);result+=fit?range[i]:0}return result},Formula.SUMPRODUCT=function(){for(var r=arguments.length+1,t=0,n=0;n<arguments[0].length;n++)for(var e=0;e<arguments[0][n].length;e++){for(var a=1,u=1;u<r;u++)a*=arguments[u-1][n][e];t+=a}return t},Formula.SUMSQ=function(){for(var r=Formula.ARGSTOARRAY(arguments),t=0,n=0;n<r.length;n++)t+=Formula.ISNUMBER(r[n])?r[n]*r[n]:0;return t},Formula.SUMX2MY2=function(r,t){for(var n=0,e=0;e<r.length;e++)n+=r[e]*r[e]-t[e]*t[e];return n},Formula.SUMX2PY2=function(r,t){for(var n=0,e=0;e<r.length;e++)n+=r[e]*r[e]+t[e]*t[e];return n},Formula.SUMXMY2=function(r,t){for(var n=0,e=0;e<r.length;e++)n+=Math.pow(r[e]-t[e],2);return n},Formula.TAN=function(r){return Math.tan(r)},Formula.TANH=function(r){var t=Math.exp(2*r);return(t-1)/(t+1)},Formula.TRUNC=function(r,t){t="undefined"==typeof t?0:t;var n=r>0?1:-1;return n*Math.floor(Math.abs(r)*Math.pow(10,t))/Math.pow(10,t)},Formula.AVEDEV=function(){var r=Formula.ARGSCONCAT(arguments);return jStat.sum(jStat(r).subtract(jStat.mean(r)).abs()[0])/r.length},Formula.AVERAGE=function(){for(var r=Formula.ARGSCONCAT(arguments),t=r.length,n=0,e=0,a=0;a<t;a++)r[a]!==!0&&r[a]!==!1&&(e+=r[a],n++);return e/n},Formula.AVERAGEA=function(){return jStat.mean(Formula.ARGSCONCAT(arguments))},Formula.AVERAGEIF=function(range,criteria,average_range){average_range="undefined"==typeof average_range?range:average_range;for(var average_count=0,result=0,i=0;i<range.length;i++)eval(range[i]+criteria)&&(result+=average_range[i],average_count++);return result/average_count},Formula.AVERAGEIFS=function(){for(var criteria=(arguments.length-1)/2,range=arguments[0],count=0,result=0,i=0;i<range.length;i++){for(var fit=!0,j=0;j<criteria;j++)eval(arguments[2*j+1][i]+arguments[2*j+2])||(fit=!1);fit&&(result+=range[i],count++)}return result/count},Formula.BETADIST=function(r,t,n,e,a,u){return a="undefined"==typeof a?0:a,u="undefined"==typeof u?1:u,r=(r-a)/(u-a),e?jStat.beta.cdf(r,t,n):jStat.beta.pdf(r,t,n)},Formula.BETAINV=function(r,t,n,e,a){return e="undefined"==typeof e?0:e,a="undefined"==typeof a?1:a,jStat.beta.inv(r,t,n)*(a-e)+e},Formula.BINOMDIST=function(r,t,n,e){return e?jStat.binomial.cdf(r,t,n):jStat.binomial.pdf(r,t,n)},Formula.BINOMDISTRANGE=function(r,t,n,e){e="undefined"==typeof e?n:e;for(var a=0,u=n;u<=e;u++)a+=Formula.COMBIN(r,u)*Math.pow(t,u)*Math.pow(1-t,r-u);return a},Formula.BINOMINV=function(r,t,n){for(var e=0;e<=r;){if(jStat.binomial.cdf(e,r,t)>=n)return e;e++}},Formula.CHISQDIST=function(r,t,n){return n?jStat.chisquare.cdf(r,t):jStat.chisquare.pdf(r,t)},Formula.CHISQDISTRT=function(r,t){},Formula.CHISQINV=function(r,t){return jStat.chisquare.inv(r,t)},Formula.CHISQINVRT=function(){},Formula.CHISQTEST=function(){},Formula.CONFIDENCENORM=function(r,t,n){return jStat.normalci(1,r,t,n)[1]-1},Formula.CONFIDENCET=function(r,t,n){return jStat.tci(1,r,t,n)[1]-1},Formula.CORREL=function(){return jStat.corrcoeff.apply(this,arguments)},Formula.COUNT=function(){return Formula.ARGSCONCAT(arguments).length},Formula.COUNTA=function(){var r=Formula.ARGSCONCAT(arguments);return r.length-Formula.COUNTBLANK(r)},Formula.COUNTBLANK=function(){for(var r=Formula.ARGSCONCAT(arguments),t=0,n=0;n<r.length;n++)null!==r[n]&&""!==r[n]||t++;return t},Formula.COUNTIF=function(r,t){for(var n=0,e=0;e<r.length;e++)r[e].match(new RegExp(t))&&n++;return n},Formula.COUNTIFS=function(){for(var criteria=(arguments.length-1)/2,range=arguments[0],result=0,i=0;i<range.length;i++){for(var fit=!0,j=0;j<criteria;j++)eval(arguments[2*j+1][i]+arguments[2*j+2])||(fit=!1);result+=fit?1:0}return result},Formula.COUNTUNIQUE=function(){return _.uniq(Formula.ARGSCONCAT(arguments)).length},Formula.COVARIANCEP=function(r,t){for(var n=jStat.mean(r),e=jStat.mean(t),a=0,u=r.length,o=0;o<u;o++)a+=(r[o]-n)*(t[o]-e);return a/u},Formula.COVARIANCES=function(){return jStat.covariance.apply(this,arguments)},Formula.DEVSQ=function(){for(var r=Formula.ARGSCONCAT(arguments),t=jStat.mean(r),n=0,e=0;e<r.length;e++)n+=Math.pow(r[e]-t,2);return n},Formula.EXPONDIST=function(r,t,n){return n?jStat.exponential.cdf(r,t):jStat.exponential.pdf(r,t)},Formula.FDIST=function(r,t,n,e){return e?jStat.centralF.cdf(r,t,n):jStat.centralF.pdf(r,t,n)},Formula.FDISTRT=function(){},Formula.FINV=function(r,t,n){return r<=0||r>1?"#NUM!":jStat.centralF.inv(1-r,t,n)},Formula.FINVRT=function(){},Formula.FTEST=function(){},Formula.FISHER=function(r){return Math.log((1+r)/(1-r))/2},Formula.FISHERINV=function(r){var t=Math.exp(2*r);return(t-1)/(t+1)},Formula.FORECAST=function(r,t,n){for(var e=jStat.mean(n),a=jStat.mean(t),u=n.length,o=0,l=0,i=0;i<u;i++)o+=(n[i]-e)*(t[i]-a),l+=Math.pow(n[i]-e,2);var f=o/l,m=a-f*e;return m+f*r},Formula.FREQUENCY=function(r,t){for(var n=r.length,e=t.length,a=[],u=0;u<=e;u++){a[u]=0;for(var o=0;o<n;o++)0===u?r[o]<=t[0]&&(a[0]+=1):u<e?r[o]>t[u-1]&&r[o]<=t[u]&&(a[u]+=1):u===e&&r[o]>t[e-1]&&(a[e]+=1)}return a},Formula.GAMMA=function(){return jStat.gammafn.apply(this,arguments)},Formula.GAMMADIST=function(r,t,n,e){},Formula.GAMMAINV=function(r,t,n){},Formula.GAMMALN=function(){return jStat.gammaln.apply(this,arguments)},Formula.GAMMALNPRECISE=function(){},Formula.GAUSS=function(r){return jStat.normal.cdf(r,0,1)-.5},Formula.GEOMEAN=function(){return jStat.geomean(Formula.ARGSCONCAT(arguments))},Formula.GROWTH=function(r,t,n,e){var a;if("undefined"==typeof t)for(t=[],a=1;a<=r.length;a++)t.push(a);if("undefined"==typeof n)for(n=[],a=1;a<=r.length;a++)n.push(a);"undefined"==typeof e&&(e=!0);var u=r.length,o=0,l=0,i=0,f=0;for(a=0;a<u;a++){var m=t[a],s=Math.log(r[a]);o+=m,l+=s,i+=m*s,f+=m*m}o/=u,l/=u,i/=u,f/=u;var F,M;e?(F=(i-o*l)/(f-o*o),M=l-F*o):(F=i/f,M=0);var c=[];for(a=0;a<n.length;a++)c.push(Math.exp(M+F*n[a]));return c},Formula.HARMEAN=function(){for(var r=Formula.ARGSCONCAT(arguments),t=r.length,n=0,e=0;e<t;e++)n+=1/r[e];return t/n},Formula.HYPGEOMDIST=function(r,t,n,e,a){function u(r,t,n,e){return Formula.COMBIN(n,r)*Formula.COMBIN(e-n,t-r)/Formula.COMBIN(e,t)}function o(r,t,n,e){for(var a=0,o=0;o<=r;o++)a+=u(o,t,n,e);return a}return a?o(r,t,n,e):u(r,t,n,e)},Formula.INTERCEPT=function(r,t){return Formula.FORECAST(0,r,t)},Formula.KURT=function(){for(var r=Formula.ARGSCONCAT(arguments),t=jStat.mean(r),n=r.length,e=0,a=0;a<n;a++)e+=Math.pow(r[a]-t,4);return e/=Math.pow(jStat.stdev(r,!0),4),n*(n+1)/((n-1)*(n-2)*(n-3))*e-3*(n-1)*(n-1)/((n-2)*(n-3))},Formula.LARGE=function(r,t){return r.sort(function(r,t){return t-r})[t-1]},Formula.LINEST=function(r,t){for(var n=jStat.mean(t),e=jStat.mean(r),a=t.length,u=0,o=0,l=0;l<a;l++)u+=(t[l]-n)*(r[l]-e),o+=Math.pow(t[l]-n,2);var i=u/o,f=e-i*n;return[i,f]},Formula.LOGEST=function(){},Formula.LOGNORMDIST=function(r,t,n,e){return e?jStat.lognormal.cdf(r,t,n):jStat.lognormal.pdf(r,t,n)},Formula.LOGNORMINV=function(r,t,n){return jStat.lognormal.inv(r,t,n)},Formula.MAX=function(){for(var r=Formula.ARGSCONCAT(arguments),t=r.length,n=t>0?r[0]:0,e=0;e<t;e++)n=r[e]>n&&r[e]!==!0&&r[e]!==!1?r[e]:n;return n},Formula.MAXA=function(){var r=Formula.ARGSCONCAT(arguments);return r.length>0?Math.max.apply(Math,r):0},Formula.MEDIAN=function(){return jStat.median(Formula.ARGSCONCAT(arguments))},Formula.MIN=function(){for(var r=Formula.ARGSCONCAT(arguments),t=r.length,n=t>0?r[0]:0,e=0;e<t;e++)n=r[e]<n&&r[e]!==!0&&r[e]!==!1?r[e]:n;return n},Formula.MINA=function(){var r=Formula.ARGSCONCAT(arguments);return r.length>0?Math.min.apply(Math,r):0},Formula.MODEMULT=function(){for(var r,t=Formula.ARGSCONCAT(arguments),n=t.length,e={},a=[],u=0,o=0;o<n;o++)r=t[o],e[r]=e[r]?e[r]+1:1,e[r]>u&&(u=e[r],a=[]),e[r]===u&&(a[a.length]=r);return a},Formula.MODESNGL=function(){return Formula.MODEMULT(Formula.ARGSCONCAT(arguments)).sort(function(r,t){return r-t})[0]},Formula.NEGBINOMDIST=function(r,t,n,e){return e?jStat.negbin.cdf(r,t,n):jStat.negbin.pdf(r,t,n)},Formula.NORMDIST=function(r,t,n,e){return isNaN(r)||isNaN(t)||isNaN(n)?"#VALUE!":n<=0?"#NUM!":e?jStat.normal.cdf(r,t,n):jStat.normal.pdf(r,t,n)},Formula.NORMINV=function(r,t,n){return jStat.normal.inv(r,t,n)},Formula.NORMSDIST=function(r,t){return t?jStat.normal.cdf(r,0,1):jStat.normal.pdf(r,0,1)},Formula.NORMSINV=function(r){return jStat.normal.inv(r,0,1)},Formula.PEARSON=function(r,t){for(var n=jStat.mean(r),e=jStat.mean(t),a=r.length,u=0,o=0,l=0,i=0;i<a;i++)u+=(r[i]-n)*(t[i]-e),o+=Math.pow(r[i]-n,2),l+=Math.pow(t[i]-e,2);return u/Math.sqrt(o*l)},Formula.PERCENTILEEXC=function(r,t){r=r.sort(function(r,t){return r-t});var n=r.length;if(t<1/(n+1)||t>1-1/(n+1))return"#NUM!";var e=t*(n+1)-1,a=Math.floor(e);return Formula.CLEANFLOAT(e===a?r[e]:r[a]+(e-a)*(r[a+1]-r[a]))},Formula.PERCENTILEINC=function(r,t){r=r.sort(function(r,t){return r-t});var n=r.length,e=t*(n-1),a=Math.floor(e);return Formula.CLEANFLOAT(e===a?r[e]:r[a]+(e-a)*(r[a+1]-r[a]))},Formula.PERCENTRANKEXC=function(r,t,n){r=r.sort(function(r,t){return r-t});var e=_.uniq(r),a=r.length,u=e.length;n="undefined"==typeof n?3:n;for(var o=Math.pow(10,n),l=0,i=!1,f=0;!i&&f<u;)t===e[f]?(l=(r.indexOf(e[f])+1)/(a+1),i=!0):t>=e[f]&&(t<e[f+1]||f===u-1)&&(l=(r.indexOf(e[f])+1+(t-e[f])/(e[f+1]-e[f]))/(a+1),i=!0),f++;return Math.floor(l*o)/o},Formula.PERCENTRANKINC=function(r,t,n){r=r.sort(function(r,t){return r-t});var e=_.uniq(r),a=r.length,u=e.length;n="undefined"==typeof n?3:n;for(var o=Math.pow(10,n),l=0,i=!1,f=0;!i&&f<u;)t===e[f]?(l=r.indexOf(e[f])/(a-1),i=!0):t>=e[f]&&(t<e[f+1]||f===u-1)&&(l=(r.indexOf(e[f])+(t-e[f])/(e[f+1]-e[f]))/(a-1),i=!0),f++;return Math.floor(l*o)/o},Formula.PERMUT=function(r,t){return Formula.FACT(r)/Formula.FACT(r-t)},Formula.PERMUTATIONA=function(r,t){return Math.pow(r,t)},Formula.PHI=function(r){return Math.exp(-.5*r*r)/SQRT2PI},Formula.POISSONDIST=function(r,t,n){return n?jStat.poisson.cdf(r,t):jStat.poisson.pdf(r,t)},Formula.PROB=function(r,t,n,e){if("undefined"==typeof n)return 0;if(e="undefined"==typeof e?n:e,n===e)return r.indexOf(n)>=0?t[r.indexOf(n)]:0;for(var a=r.sort(function(r,t){return r-t}),u=a.length,o=0,l=0;l<u;l++)a[l]>=n&&a[l]<=e&&(o+=t[r.indexOf(a[l])]);return o},Formula.QUARTILEEXC=function(r,t){switch(t){case 1:return Formula.PERCENTILEEXC(r,.25);case 2:return Formula.PERCENTILEEXC(r,.5);case 3:return Formula.PERCENTILEEXC(r,.75);default:return"#NUM!"}},Formula.QUARTILEINC=function(r,t){switch(t){case 1:return Formula.PERCENTILEINC(r,.25);case 2:return Formula.PERCENTILEINC(r,.5);case 3:return Formula.PERCENTILEINC(r,.75);default:return"#NUM!"}},Formula.RANKAVG=function(r,t,n){n="undefined"!=typeof n&&n;var e=n?function(r,t){return r-t}:function(r,t){return t-r};t=t.sort(e);var a=Formula.COUNTIN(t,r);return a>1?(2*t.indexOf(r)+a+1)/2:t.indexOf(r)+1},Formula.RANKEQ=function(r,t,n){n="undefined"!=typeof n&&n;var e=n?function(r,t){return r-t}:function(r,t){return t-r};return t=t.sort(e),t.indexOf(r)+1},Formula.RSQ=function(r,t){return Math.pow(Formula.PEARSON(r,t),2)},Formula.SKEW=function(){for(var r=Formula.ARGSCONCAT(arguments),t=jStat.mean(r),n=r.length,e=0,a=0;a<n;a++)e+=Math.pow(r[a]-t,3);return n*e/((n-1)*(n-2)*Math.pow(jStat.stdev(r,!0),3))},Formula.SKEWP=function(){for(var r=Formula.ARGSCONCAT(arguments),t=jStat.mean(r),n=r.length,e=0,a=0,u=0;u<n;u++)a+=Math.pow(r[u]-t,3),e+=Math.pow(r[u]-t,2);return a/=n,e/=n,a/Math.pow(e,1.5)},Formula.SLOPE=function(r,t){for(var n=jStat.mean(t),e=jStat.mean(r),a=t.length,u=0,o=0,l=0;l<a;l++)u+=(t[l]-n)*(r[l]-e),o+=Math.pow(t[l]-n,2);return u/o},Formula.SMALL=function(r,t){return r.sort(function(r,t){return r-t})[t-1]},Formula.STANDARDIZE=function(r,t,n){return(r-t)/n},Formula.STDEVA=function(){for(var r=Formula.ARGSCONCAT(arguments),t=r.length,n=0,e=jStat.mean(r),a=0;a<t;a++)n+=Math.pow(r[a]-e,2);return Math.sqrt(n/(t-1))},Formula.STDEVP=function(){for(var r=Formula.ARGSCONCAT(arguments),t=r.length,n=0,e=0,a=Formula.AVERAGE(r),u=0;u<t;u++)r[u]!==!0&&r[u]!==!1&&(n+=Math.pow(r[u]-a,2),e++);return Math.sqrt(n/e)},Formula.STDEVPA=function(){for(var r=Formula.ARGSCONCAT(arguments),t=r.length,n=0,e=jStat.mean(r),a=0;a<t;a++)n+=Math.pow(r[a]-e,2);return Math.sqrt(n/t)},Formula.STDEVS=function(){for(var r=Formula.ARGSCONCAT(arguments),t=r.length,n=0,e=0,a=Formula.AVERAGE(r),u=0;u<t;u++)r[u]!==!0&&r[u]!==!1&&(n+=Math.pow(r[u]-a,2),e++);return Math.sqrt(n/(e-1))},Formula.STEYX=function(r,t){for(var n=jStat.mean(t),e=jStat.mean(r),a=t.length,u=0,o=0,l=0,i=0;i<a;i++)u+=Math.pow(r[i]-e,2),o+=(t[i]-n)*(r[i]-e),l+=Math.pow(t[i]-n,2);return Math.sqrt((u-o*o/l)/(a-2))},Formula.TDIST=function(r,t,n){return n?jStat.studentt.cdf(r,t):jStat.studentt.pdf(r,t)},Formula.TDIST2T=function(){},Formula.TDISTRT=function(){},Formula.TINV=function(r,t){return jStat.studentt.inv(r,t)},Formula.TINV2T=function(){},Formula.TTEST=function(){},Formula.TREND=function(){},Formula.TRIMMEAN=function(r,t){var n=(r.length,Formula.FLOOR(r.length*t,2)/2);return jStat.mean(_.initial(_.rest(r.sort(function(r,t){return r-t}),n),n))},Formula.VARA=function(){for(var r=Formula.ARGSCONCAT(arguments),t=r.length,n=0,e=jStat.mean(r),a=0;a<t;a++)n+=Math.pow(r[a]-e,2);return n/(t-1)},Formula.VARP=function(){
for(var r=Formula.ARGSCONCAT(arguments),t=r.length,n=0,e=0,a=Formula.AVERAGE(r),u=0;u<t;u++)r[u]!==!0&&r[u]!==!1&&(n+=Math.pow(r[u]-a,2),e++);return n/e},Formula.VARPA=function(){for(var r=Formula.ARGSCONCAT(arguments),t=r.length,n=0,e=jStat.mean(r),a=0;a<t;a++)n+=Math.pow(r[a]-e,2);return n/t},Formula.VARS=function(){for(var r=Formula.ARGSCONCAT(arguments),t=r.length,n=0,e=0,a=Formula.AVERAGE(r),u=0;u<t;u++)r[u]!==!0&&r[u]!==!1&&(n+=Math.pow(r[u]-a,2),e++);return n/(e-1)},Formula.WEIBULLDIST=function(r,t,n,e){return e?1-Math.exp(-Math.pow(r/n,t)):Math.pow(r,t-1)*Math.exp(-Math.pow(r/n,t))*t/Math.pow(n,t)},Formula.ZTEST=function(r,t,n){var e=r.length,a="undefined"==typeof n?Formula.STDEVS(r):n;return 1-Formula.NORMSDIST((Formula.AVERAGE(r)-t)/(a/Math.sqrt(e)),Formula.TRUE)},Formula.CHAR=function(r){return String.fromCharCode(r)},Formula.CLEAN=function(r){var t=/[\0-\x1F]/g;return r.replace(t,"")},Formula.CODE=function(r){return r.charCodeAt(0)},Formula.CONCATENATE=function(){for(var r="",t=0;t<arguments.length;t++)null!==arguments[t]&&void 0!==arguments[t]&&(r+=arguments[t]);return r},Formula.DOLLAR=function(r,t){t="undefined"==typeof t?2:t;var n="";return t<=0?(r=Math.round(r*Math.pow(10,t))/Math.pow(10,t),n="($0,0)"):t>0&&(n="($0,0."+new Array(t+1).join("0")+")"),numeral(r).format(n)},Formula.EXACT=function(r,t){return r===t},Formula.FIND=function(r,t,n){return n="undefined"==typeof n?0:n,t?t.indexOf(r,n-1)+1:null},Formula.FIXED=function(r,t,n){t="undefined"==typeof t?2:t,n="undefined"!=typeof n&&n;var e=n?"0":"0,0";return t<=0?r=Math.round(r*Math.pow(10,t))/Math.pow(10,t):t>0&&(e+="."+new Array(t+1).join("0")),numeral(r).format(e)},Formula.HTML2TEXT=function(r){var t="";return r&&(r instanceof Array?r.forEach(function(r){""!==t&&(t+="\n"),t+=r.replace(/<(?:.|\n)*?>/gm,"")}):t=r.replace(/<(?:.|\n)*?>/gm,"")),t},Formula.HUMANIZE=function(r){if(r instanceof Date){var t=moment(r);return t.hours()||t.minutes()||t.seconds()?t.format("dddd, MMMM Do YYYY, h:mm:ss"):t.format("dddd, MMMM Do YYYY")}return r},Formula.JOIN=function(r,t){return r.join(t)},Formula.LEFT=function(r,t){return t="undefined"==typeof t?1:t,r?r.substring(0,t):null},Formula.LEN=function(r){return r?r.length:0},Formula.LOWER=function(r){return r?r.toLowerCase():r},Formula.MID=function(r,t,n){return r.substring(t-1,n)},Formula.NUMBERVALUE=function(r,t,n){return t="undefined"==typeof t?".":t,n="undefined"==typeof n?",":n,Number(r.replace(t,".").replace(n,""))},Formula.PROPER=function(r){return r.replace(/\w\S*/g,function(r){return r.charAt(0).toUpperCase()+r.substr(1).toLowerCase()})},Formula.REGEXEXTRACT=function(r,t){var n=r.match(new RegExp(t));return console.log(n),n?n[n.length>1?n.length-1:0]:null},Formula.REGEXMATCH=function(r,t,n){var e=r.match(new RegExp(t));return n?e:!!r.match(new RegExp(t))},Formula.REGEXREPLACE=function(r,t,n){return r.replace(new RegExp(t),n)},Formula.REPLACE=function(r,t,n,e){return r.substr(0,t-1)+e+r.substr(t-1+n)},Formula.REPT=function(r,t){return new Array(t+1).join(r)},Formula.RIGHT=function(r,t){return t="undefined"==typeof t?1:t,r?r.substring(r.length-t):null},Formula.ROMAN=function(r){for(var t=String(r).split(""),n=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],e="",a=3;a--;)e=(n[+t.pop()+10*a]||"")+e;return new Array(+t.join("")+1).join("M")+e},Formula.SEARCH=function(r,t,n){return n="undefined"==typeof n?0:n,t.toLowerCase().indexOf(r.toLowerCase(),n-1)+1},Formula.SPLIT=function(r,t){return _s.words(r,t)},Formula.SUBSTITUTE=function(r,t,n,e){if(!(r&&t&&n))return r;if("undefined"==typeof e)return r.replace(new RegExp(t,"g"),n);for(var a=0,u=0;r.indexOf(t,a)>0;)if(a=r.indexOf(t,a+1),u++,u===e)return r.substring(0,a)+n+r.substring(a+t.length)},Formula.T=function(r){return"string"==typeof r?r:null},Formula.TEXT=function(r,t){var n="";if(r)if(r instanceof Object)try{n=JSON.stringify(r)}catch(r){}else"string"==typeof r?n=t?t.indexOf("0")>=0?numeral(r).format(t):moment(new Date(r)).format(t):r:r.toString&&"function"==typeof r.toString&&(n=r.toString());return n},Formula.TRIM=function(r){return _s.clean(r)},Formula.UNICHAR=Formula.CHAR,Formula.UNICODE=Formula.CODE,Formula.UPPER=function(r){return r.toUpperCase()},Formula.VALUE=function(r){return numeral().unformat(r)},Formula.MD5=function(r,t,n){return md5(r,t,n)},Formula.NUMERAL=function(r,t){return numeral(r).format(t)},Formula}"undefined"!=typeof exports?module.exports=exportModule(require("numeric"),require("numeral"),require("jStat"),require("moment"),require("lodash"),require("underscore.string"),require("blueimp-md5")):"function"==typeof define&&define.amd&&define("formula",["numeric","numeral","jStat","moment","lodash","underscore.string","md5"],exportModule)}).call(this);