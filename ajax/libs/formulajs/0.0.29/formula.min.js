(function(){function exportModule(numeric,numeral,jStatLib,moment,_,_s,md5Lib){var Formula={},jStat=jStatLib.jStat,md5=md5Lib.md5,MEMOIZED_FACT=[],SQRT2PI=2.5066282746310002,WEEK_STARTS=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],WEEK_TYPES=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],WEEKEND_TYPES=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0],[1],[2],[3],[4],[5],[6]];return Formula.UNIQUE=function(){return _.unique(arguments)},Formula.FLATTEN=function(){return _.flatten(arguments)},Formula.FUNCTION=function(){var r=Array.prototype.slice.call(arguments),t=r[r.length-1],e=/(\w+)\(/g,n=t.replace(e,function(){return"Formulae."+arguments[0]});return r[r.length-1]="return "+n+";",n!==t&&r.unshift("Formulae"),Function.apply(null,r)},Formula.MOMENT=function(r,t){return moment(r).format(t)},Formula.MOMENTADD=function(r,t,e){return moment(r).add(t,e)},Formula.MOMENTDIFF=function(r,t,e){return moment(t).diff(moment.utc(r),e)},Formula.MOMENTSUB=function(r,t,e){return moment(r).subtract(t,e)},Formula.MOMENTUTC=function(r,t){return moment.utc(r).format(t)},Formula.MOMENTUTCADD=function(r,t,e){return moment.utc(r).add(t,e)},Formula.MOMENTUTCDIFF=function(r,t,e){return moment.utc(t).diff(moment.utc(r),e)},Formula.MOMENTUTCSUB=function(r,t,e){return moment.utc(r).subtract(t,e)},Formula.MOMENTUNIX=function(r){return moment.unix(r).toDate()},Formula.MOMENTFORMAT=function(r,t){return moment(r).format(t)},Formula.MOMENTISLEAPYEAR=function(r,t){return moment(r,t).isLeapYear()},Formula.MOMENTISDST=function(r,t){return moment(r,t).isDST()},Formula.MOMENTSTARTOF=function(r,t,e){return moment(r,e).startOf(t).toDate()},Formula.MOMENTENDOF=function(r,t,e){return moment(r,e).endOf(t).toDate()},Formula.MOMENTISAFTER=function(r,t,e){return moment(r,e).isAfter(moment(t,e))},Formula.MOMENTISBEFORE=function(r,t,e){return moment(r,e).isBefore(moment(t,e))},Formula.INTERVAL=function(r){var t=Math.floor(r/94608e4);r%=94608e4;var e=Math.floor(r/2592e3);r%=2592e3;var n=Math.floor(r/86400);r%=86400;var a=Math.floor(r/3600);r%=3600;var u=Math.floor(r/60);r%=60;var o=r;return t=t>0?t+"Y":"",e=e>0?e+"M":"",n=n>0?n+"D":"",a=a>0?a+"H":"",u=u>0?u+"M":"",o=o>0?o+"S":"","P"+t+e+n+"T"+a+u+o},Formula.ARGSCONCAT=function(r){for(var t=[],e=0;e<r.length;e++)t=t.concat(r[e]);return t},Formula.ARGSTOARRAY=function(r){return Array.prototype.slice.call(r,0)},Formula.CLEANFLOAT=function(r){var t=Math.pow(10,14);return Math.round(r*t)/t},Formula.COUNTIN=function(r,t){for(var e=0,n=0;n<r.length;n++)r[n]===t&&e++;return e},Formula.FINDFIELD=function(r,t){for(var e=null,n=0;n<r.length;n++)if(r[n][0]===t){e=n;break}return null==e?"#VALUE!":e},Formula.FINDRESULTINDEX=function(database,criteria){for(var maxCriteriaLength=criteria[0].length,i=1;i<criteria.length;i++)criteria[i].length>maxCriteriaLength&&(maxCriteriaLength=criteria[i].length);var columnResultIndexes=[];for(i=1;i<maxCriteriaLength;i++){for(var rowResultIndexes=[],j=0;j<criteria.length;j++)if(!(criteria[j].length<maxCriteriaLength)){for(var criteriaTitle=criteria[j][0],criteriaIndex=Formula.FINDFIELD(database,criteriaTitle),criteriaValues=_.rest(database[criteriaIndex]),count=0,singleResultIndexes=[],k=0;k<criteriaValues.length;k++)eval(criteriaValues[k]+criteria[j][i])&&(singleResultIndexes[count++]=k);rowResultIndexes[j]=singleResultIndexes}columnResultIndexes[i-1]=_.intersection.apply(_,rowResultIndexes)}var resultIndexes=_.union.apply(_,columnResultIndexes);return resultIndexes},Formula.DAVERAGE=function(r,t,e){if(isNaN(t)&&"string"!=typeof t)return"#VALUE!";var n=Formula.FINDRESULTINDEX(r,e),a=[];if("string"==typeof t){var u=Formula.FINDFIELD(r,t);a=_.rest(r[u])}else a=_.rest(r[t]);for(var o=0,i=0;i<n.length;i++)o+=a[n[i]];var l=Formula.IF(0===n.length,"#DIV/0!",o/n.length);return l},Formula.DCOUNT=function(r,t,e){if(isNaN(t)&&"string"!=typeof t)return"#VALUE!";var n=Formula.FINDRESULTINDEX(r,e),a=[];if("string"==typeof t){var u=Formula.FINDFIELD(r,t);a=_.rest(r[u])}else a=_.rest(r[t]);for(var o=[],i=0;i<n.length;i++)o[i]=a[n[i]];return Formula.COUNT(o)},Formula.DCOUNTA=function(r,t,e){if(isNaN(t)&&"string"!=typeof t)return"#VALUE!";var n=Formula.FINDRESULTINDEX(r,e),a=[];if("string"==typeof t){var u=Formula.FINDFIELD(r,t);a=_.rest(r[u])}else a=_.rest(r[t]);for(var o=[],i=0;i<n.length;i++)o[i]=a[n[i]];return Formula.COUNTA(o)},Formula.DGET=function(r,t,e){if(isNaN(t)&&"string"!=typeof t)return"#VALUE!";var n=Formula.FINDRESULTINDEX(r,e),a=[];if("string"==typeof t){var u=Formula.FINDFIELD(r,t);a=_.rest(r[u])}else a=_.rest(r[t]);return 0===n.length?"#VALUE!":n.length>1?"#NUM!":a[n[0]]},Formula.DMAX=function(r,t,e){if(isNaN(t)&&"string"!=typeof t)return"#VALUE!";var n=Formula.FINDRESULTINDEX(r,e),a=[];if("string"==typeof t){var u=Formula.FINDFIELD(r,t);a=_.rest(r[u])}else a=_.rest(r[t]);for(var o=a[n[0]],i=1;i<n.length;i++)o<a[n[i]]&&(o=a[n[i]]);return o},Formula.DMIN=function(r,t,e){if(isNaN(t)&&"string"!=typeof t)return"#VALUE!";var n=Formula.FINDRESULTINDEX(r,e),a=[];if("string"==typeof t){var u=Formula.FINDFIELD(r,t);a=_.rest(r[u])}else a=_.rest(r[t]);for(var o=a[n[0]],i=1;i<n.length;i++)o>a[n[i]]&&(o=a[n[i]]);return o},Formula.DPRODUCT=function(r,t,e){if(isNaN(t)&&"string"!=typeof t)return"#VALUE!";var n=Formula.FINDRESULTINDEX(r,e),a=[];if("string"==typeof t){var u=Formula.FINDFIELD(r,t);a=_.rest(r[u])}else a=_.rest(r[t]);for(var o=[],i=0;i<n.length;i++)o[i]=a[n[i]];o=_.compact(o);var l=1;for(i=0;i<o.length;i++)l*=o[i];return l},Formula.DSTDEV=function(r,t,e){if(isNaN(t)&&"string"!=typeof t)return"#VALUE!";var n=Formula.FINDRESULTINDEX(r,e),a=[];if("string"==typeof t){var u=Formula.FINDFIELD(r,t);a=_.rest(r[u])}else a=_.rest(r[t]);for(var o=[],i=0;i<n.length;i++)o[i]=a[n[i]];return o=_.compact(o),Formula.STDEVS(o)},Formula.DSTDEVP=function(r,t,e){if(isNaN(t)&&"string"!=typeof t)return"#VALUE!";var n=Formula.FINDRESULTINDEX(r,e),a=[];if("string"==typeof t){var u=Formula.FINDFIELD(r,t);a=_.rest(r[u])}else a=_.rest(r[t]);for(var o=[],i=0;i<n.length;i++)o[i]=a[n[i]];return o=_.compact(o),Formula.STDEVP(o)},Formula.DSUM=function(r,t,e){if(isNaN(t)&&"string"!=typeof t)return"#VALUE!";var n=Formula.FINDRESULTINDEX(r,e),a=[];if("string"==typeof t){var u=Formula.FINDFIELD(r,t);a=_.rest(r[u])}else a=_.rest(r[t]);for(var o=[],i=0;i<n.length;i++)o[i]=a[n[i]];return Formula.SUM(o)},Formula.DVAR=function(r,t,e){if(isNaN(t)&&"string"!=typeof t)return"#VALUE!";var n=Formula.FINDRESULTINDEX(r,e),a=[];if("string"==typeof t){var u=Formula.FINDFIELD(r,t);a=_.rest(r[u])}else a=_.rest(r[t]);for(var o=[],i=0;i<n.length;i++)o[i]=a[n[i]];return Formula.VARS(o)},Formula.DVARP=function(r,t,e){if(isNaN(t)&&"string"!=typeof t)return"#VALUE!";var n=Formula.FINDRESULTINDEX(r,e),a=[];if("string"==typeof t){var u=Formula.FINDFIELD(r,t);a=_.rest(r[u])}else a=_.rest(r[t]);for(var o=[],i=0;i<n.length;i++)o[i]=a[n[i]];return Formula.VARP(o)},Formula.GETJSON=function(r){var t=new XMLHttpRequest;if(t.open("GET",r,!1),t.send(null),200===t.status)return JSON.parse(t.responseText)},Formula.DATE=function(){if(!arguments.length)return new Date;if(1===arguments.length)return new Date(arguments[0]);var r=arguments;return r[1]=r[1]-1,new(Date.bind.apply(Date,[Date].concat([].splice.call(r,0))))},Formula.DATEVALUE=function(r){return Math.ceil((moment(r)-moment("1900-1-1"))/864e5)+2},Formula.DAY=function(r){return new Date(r).getDate()},Formula.DAYS=function(r,t){return moment(new Date(r)).diff(moment(new Date(t)),"days")},Formula.DAYS360=function(r,t,e){var n=moment(new Date(r)),a=moment(new Date(t)),u=31,o=31,i=n.date(),l=a.date();return e?(i=31===i?30:i,l=31===l?30:l):(1===n.month()&&(u=n.daysInMonth()),1===a.month()&&(o=a.daysInMonth()),i=i===u?30:i,30!==i&&i!==u||(l=l===o?30:l)),360*(a.year()-n.year())+30*(a.month()-n.month())+(l-i)},Formula.EDATE=function(r,t){return moment(new Date(r)).add("months",t).toDate()},Formula.EOMONTH=function(r,t){var e=moment(new Date(r)).add("months",t);return new Date(e.year(),e.month(),e.daysInMonth())},Formula.FROMNOW=function(r,t){return moment(new Date(r)).fromNow(t)},Formula.HOUR=function(r){return r<=1?Math.floor(24*r):new Date(r).getHours()},Formula.MINUTE=function(r){return r<=1?Math.floor(1440*r)-60*Math.floor(24*r):new Date(r).getMinutes()},Formula.ISOWEEKNUM=function(r){return moment(new Date(r)).format("w")},Formula.MONTH=function(r){return new Date(r).getMonth()+1},Formula.NETWORKDAYS=function(r,t,e){return Formula.NETWORKDAYSINTL(r,t,1,e)},Formula.NETWORKDAYSINTL=function(r,t,e,n){var a="undefined"==typeof e?1:e,u=WEEKEND_TYPES[a],o=moment(r),i=moment(t),l=i.diff(o,"days")+1,f=l,m=o,s=[];if("undefined"!=typeof n)for(var F=0;F<n.length;F++)s[F]=moment(new Date(n[F])).format("MM-DD-YYYY");if(!u.length&&!s.length)return f;for(var M=0;M<l;)u.indexOf(parseInt(m.format("d"),10))>=0?f--:s.indexOf(m.format("MM-DD-YYYY"))>=0&&f--,m=m.add("days",1),M++;return f},Formula.NOW=function(){return new Date},Formula.SECOND=function(r){return new Date(r).getSeconds()},Formula.TIME=function(r,t,e){return(3600*r+60*t+e)/86400},Formula.TIMEVALUE=function(r){var t=new Date(r);return(3600*t.getHours()+60*t.getMinutes()+t.getSeconds())/86400},Formula.TODAY=Formula.NOW,Formula.WEEKDAY=function(r,t){var e=moment(new Date(r)).format("d"),n="undefined"==typeof t?1:t;return WEEK_TYPES[n][e]},Formula.WEEKNUM=function(r,t){var e=moment(new Date(r)),n=moment(new Date(e.year(),0,1)),a="undefined"==typeof t?1:t,u=WEEK_STARTS[a],o=n.format("d"),i=o<u?u-o+1:o-u;return 21===a?Formula.ISOWEEKNUM(r):Math.floor(e.diff(n.subtract("days",i),"days")/7)+1},Formula.WORKDAY=function(r,t,e){return Formula.WORKDAYINTL(r,t,1,e)},Formula.WORKDAYINTL=function(r,t,e,n){var a="undefined"==typeof e?1:e,u=WEEKEND_TYPES[a],o=moment(new Date(r)),i=o,l="",f=[];if("undefined"!=typeof n)for(var m=0;m<n.length;m++)f[m]=moment(new Date(n[m])).format("MM-DD-YYYY");for(var s=0;s<t;)i=i.add("days",1),l=i.format("d"),u.indexOf(parseInt(l,10))<0&&f.indexOf(i.format("MM-DD-YYYY"))<0&&s++;return i.toDate()},Formula.YEAR=function(r){return new Date(r).getFullYear()},Formula.YEARFRAC=function(r,t,e){e="undefined"==typeof e?0:e;var n=moment(new Date(r)),a=moment(new Date(t));if(!n.isValid()||!a.isValid())return"#VALUE!";if([0,1,2,3,4].indexOf(e)===-1)return"#NUM!";if(n===a)return 0;n.diff(a)>0&&(a=moment(new Date(r)),n=moment(new Date(t)));var u=n.year(),o=n.month(),i=n.date(),l=a.year(),f=a.month(),m=a.date();switch(e){case 0:return 31===i&&31===m?(i=30,m=30):31===i?i=30:30===i&&31===m?m=30:1===o&&1===f&&n.daysInMonth()===i&&a.daysInMonth()===m?(i=30,m=30):1===o&&n.daysInMonth()===i&&(i=30),(m+30*f+360*l-(i+30*o+360*u))/360;case 1:var s=function(r,t){var e=moment(new Date(r.year(),2,1));if(moment([r.year()]).isLeapYear()&&r.diff(e)<0&&t.diff(e)>=0)return!0;var n=moment(new Date(t.year(),2,1));return!!(moment([t.year()]).isLeapYear()&&t.diff(n)>=0&&r.diff(n)<0)},F=365;if(u===l||u+1===l&&(o>f||o===f&&i>=m))return u===l&&moment([u]).isLeapYear()?F=366:(s(n,a)||1===f&&29===m)&&(F=366),a.diff(n,"days")/F;var M=l-u+1,c=moment(new Date(l+1,0,1)).diff(moment(new Date(u,0,1)),"days"),N=c/M;return a.diff(n,"days")/N;case 2:return a.diff(n,"days")/360;case 3:return a.diff(n,"days")/365;case 4:return 31===i&&(i=30),31===m&&(m=30),(m+30*f+360*l-(i+30*o+360*u))/360}},Formula.BESSELI=function(){function r(r,t){return r.reduce(function(r,e){return t*r+e},0)}function t(t){return t<=3.75?r(n,t*t/14.0625):Math.exp(Math.abs(t))/Math.sqrt(Math.abs(t))*r(a,3.75/Math.abs(t))}function e(t){return t<3.75?t*r(u,t*t/14.0625):(t<0?-1:1)*Math.exp(Math.abs(t))/Math.sqrt(Math.abs(t))*r(o,3.75/Math.abs(t))}var n=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),a=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),u=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),o=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();return function r(n,a){if(a=Math.round(a),0===a)return t(n);if(1===a)return e(n);if(a<0)throw"BESSELI Order ("+a+") must be nonnegative";if(0===Math.abs(n))return 0;var u,o,i,l,f,m,s=2/Math.abs(n);for(i=2*Math.round((a+Math.round(Math.sqrt(40*a)))/2),l=u=0,f=1,o=i;o>0;o--)m=o*s*f+l,l=f,f=m,Math.abs(f)>1e10&&(f*=1e-10,l*=1e-10,u*=1e-10),o===a&&(u=l);return u*=r(n,0)/f,n<0&&a%2?-u:u}}(),Formula.BESSELJ=function(){function r(r,t){return r.reduce(function(r,e){return t*r+e},0)}function t(t){var e,n,f,m=t*t,s=Math.abs(t)-.785398164;return Math.abs(t)<8?(n=r(a,m),f=r(u,m),e=n/f):(m=64/m,n=r(o,m),f=r(i,m),e=Math.sqrt(l/Math.abs(t))*(Math.cos(s)*n-Math.sin(s)*f*8/Math.abs(t))),e}function e(t){var e,n,a,u=t*t,o=Math.abs(t)-2.356194491;return Math.abs(t)<8?(n=t*r(f,u),a=r(m,u),e=n/a):(u=64/u,n=r(s,u),a=r(F,u),e=Math.sqrt(l/Math.abs(t))*(Math.cos(o)*n-Math.sin(o)*a*8/Math.abs(t)),t<0&&(e=-e)),e}function n(r,t,e,n,a){a||(a=-1);var u,o=2/r;if(0===t)return e;if(1===t)return n;for(var i=1;i!==t;++i)u=n*i*o+a*e,e=n,n=u;return n}var a=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),u=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),o=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),i=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34935152e-8].reverse(),l=.636619772,f=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),m=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),s=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),F=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();return function(r,a){if(a=Math.round(a),0===a)return t(Math.abs(r));if(1===a)return e(Math.abs(r));if(a<0)throw"BESSELJ: Order ("+a+") must be nonnegative";if(0===Math.abs(r))return 0;var u,o,i,l,f,m,s,F,M=2/Math.abs(r);if(Math.abs(r)>a)u=n(r,a,t(Math.abs(r)),e(Math.abs(r)),-1);else{for(i=2*Math.floor((a+Math.floor(Math.sqrt(40*a)))/2),l=0,m=u=f=0,s=1,o=i;o>0;o--)F=o*M*s-m,m=s,s=F,Math.abs(s)>1e10&&(s*=1e-10,m*=1e-10,u*=1e-10,f*=1e-10),l&&(f+=s),l=!l,o===a&&(u=m);f=2*f-s,u/=f}return r<0&&a%2?-u:u}}(),Formula.BESSELK=function(){function r(r,t){return r.reduce(function(r,e){return t*r+e},0)}function t(t){return t<=2?-Math.log(t/2)*Formula.BESSELI(t,0)+r(u,t*t/4):Math.exp(-t)/Math.sqrt(t)*r(o,2/t)}function e(t){return t<=2?Math.log(t/2)*Formula.BESSELI(t,1)+1/t*r(i,t*t/4):Math.exp(-t)/Math.sqrt(t)*r(l,2/t)}function n(r,t,e,n,a){a||(a=-1);var u,o=2/r;if(0===t)return e;if(1===t)return n;for(var i=1;i!==t;++i)u=n*i*o+a*e,e=n,n=u;return n}function a(r,t,e,a,u){return function(o,i){if(0===i)return r(o);if(1===i)return t(o);if(i<0)throw e+": Order ("+i+") must be nonnegative";if(1===a&&0===o)throw e+": Undefined when x == 0";if(2===a&&o<=0)throw e+": Undefined when x <= 0";var l=r(o),f=t(o);return n(o,i,l,f,u)}}var u=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),o=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),i=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),l=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return a(t,e,"BESSELK",2,1)}(),Formula.BESSELY=function(){function r(r,t){return r.reduce(function(r,e){return t*r+e},0)}function t(t){var e,n,a,m=t*t,s=t-.785398164;return t<8?(n=r(u,m),a=r(o,m),e=n/a+f*Formula.BESSELJ(t,0)*Math.log(t)):(m=64/m,n=r(i,m),a=r(l,m),e=Math.sqrt(f/t)*(Math.sin(s)*n+Math.cos(s)*a*8/t)),e}function e(t){var e,n,a,u=t*t,o=t-2.356194491;return t<8?(n=t*r(m,u),a=r(s,u),e=n/a+f*(Formula.BESSELJ(t,1)*Math.log(t)-1/t)):(u=64/u,n=r(F,u),a=r(M,u),e=Math.sqrt(f/t)*(Math.sin(o)*n+Math.cos(o)*a*8/t)),e}function n(r,t,e,n,a){a||(a=-1);var u,o=2/r;if(0===t)return e;if(1===t)return n;for(var i=1;i!==t;++i)u=n*i*o+a*e,e=n,n=u;return n}function a(r,t,e,a,u){return function(o,i){if(0===i)return r(o);if(1===i)return t(o);if(i<0)throw e+": Order ("+i+") must be nonnegative";if(1===a&&0===o)throw e+": Undefined when x == 0";if(2===a&&o<=0)throw e+": Undefined when x <= 0";var l=r(o),f=t(o);return n(o,i,l,f,u)}}var u=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),o=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),i=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),l=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34945152e-8].reverse(),f=.636619772,m=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),s=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),F=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),M=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();return a(t,e,"BESSELY",1,-1)}(),Formula.VALIDBIN=function(r){return/^[01]{1,10}$/.test(r)},Formula.BIN2DEC=function(r){if(!Formula.VALIDBIN(r))return"#NUM!";var t=parseInt(r,2),e=r.toString();return 10===e.length&&"1"===e.substring(0,1)?parseInt(e.substring(1),2)-512:t},Formula.BIN2HEX=function(r,t){if(!Formula.VALIDBIN(r))return"#NUM!";var e=r.toString();if(10===e.length&&"1"===e.substring(0,1))return(0xfffffffe00+parseInt(e.substring(1),2)).toString(16);var n=parseInt(r,2).toString(16);return"undefined"==typeof t?n:isNaN(t)?"#VALUE!":t<0?"#NUM!":(t=Math.floor(t),t>=n.length?_s.repeat("0",t-n.length)+n:"#NUM!")},Formula.BIN2OCT=function(r,t){if(!Formula.VALIDBIN(r))return"#NUM!";var e=r.toString();if(10===e.length&&"1"===e.substring(0,1))return(1073741312+parseInt(e.substring(1),2)).toString(8);var n=parseInt(r,2).toString(8);return"undefined"==typeof t?n:isNaN(t)?"#VALUE!":t<0?"#NUM!":(t=Math.floor(t),t>=n.length?_s.repeat("0",t-n.length)+n:"#NUM!")},Formula.BITAND=function(r,t){return isNaN(r)||isNaN(t)?"#VALUE!":r<0||t<0?"#NUM!":Math.floor(r)!==r||Math.floor(t)!==t?"#NUM!":r>0xffffffffffff||t>0xffffffffffff?"#NUM!":r&t},Formula.BITLSHIFT=function(r,t){return isNaN(r)||isNaN(t)?"#VALUE!":r<0?"#NUM!":Math.floor(r)!==r?"#NUM!":r>0xffffffffffff?"#NUM!":Math.abs(t)>53?"#NUM!":t>=0?r<<t:r>>-t},Formula.BITOR=function(r,t){return isNaN(r)||isNaN(t)?"#VALUE!":r<0||t<0?"#NUM!":Math.floor(r)!==r||Math.floor(t)!==t?"#NUM!":r>0xffffffffffff||t>0xffffffffffff?"#NUM!":r|t},Formula.BITRSHIFT=function(r,t){return isNaN(r)||isNaN(t)?"#VALUE!":r<0?"#NUM!":Math.floor(r)!==r?"#NUM!":r>0xffffffffffff?"#NUM!":Math.abs(t)>53?"#NUM!":t>=0?r>>t:r<<-t},Formula.BITXOR=function(r,t){return isNaN(r)||isNaN(t)?"#VALUE!":r<0||t<0?"#NUM!":Math.floor(r)!==r||Math.floor(t)!==t?"#NUM!":r>0xffffffffffff||t>0xffffffffffff?"#NUM!":r^t},Formula.COMPLEX=function(r,t,e){if(isNaN(r)||isNaN(t))return"#VALUE!";if(e="undefined"==typeof e?"i":e,"i"!==e&&"j"!==e)return"#VALUE!";if(0===r&&0===t)return 0;if(0===r)return 1===t?e:t.toString()+e;if(0===t)return r.toString();var n=t>0?"+":"";return r.toString()+n+(1===t?e:t.toString()+e)},Formula.CONVERT=function(r,t,e){if(isNaN(r))return"#VALUE!";for(var n,a=[["a.u. of action","?",null,"action",!1,!1,1.05457168181818e-34],["a.u. of charge","e",null,"electric_charge",!1,!1,1.60217653141414e-19],["a.u. of energy","Eh",null,"energy",!1,!1,4.35974417757576e-18],["a.u. of length","a?",null,"length",!1,!1,5.29177210818182e-11],["a.u. of mass","m?",null,"mass",!1,!1,9.10938261616162e-31],["a.u. of time","?/Eh",null,"time",!1,!1,2.41888432650516e-17],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ångström","Å",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,1.49597870691667e-11],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ångström","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,8.46786664623715e-47],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,1.66053886282828e-27],["day","d",["day"],"time",!1,!0,86400],["degree","°",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,1.05457168181818e-34],["n.u. of mass","m?",null,"mass",!1,!1,9.10938261616162e-31],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,1.28808866778687e-21],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["œrsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","Ω",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestärke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ångström","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,8.95054210748189e31],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],u={Yi:["yobi",80,1.2089258196146292e24,"Yi","yotta"],Zi:["zebi",70,0x400000000000000000,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},o={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},i=null,l=null,f=t,m=e,s=1,F=1,M=0;M<a.length;M++)n=null===a[M][2]?[]:a[M][2],(a[M][1]===f||n.indexOf(f)>=0)&&(i=a[M]),(a[M][1]===m||n.indexOf(m)>=0)&&(l=a[M]);if(null===i){var c=u[t.substring(0,2)],N=o[t.substring(0,1)];"da"===t.substring(0,2)&&(N=["dekao",10,"da"]),c?(s=c[2],f=t.substring(2)):N&&(s=N[1],f=t.substring(N[2].length));for(var h=0;h<a.length;h++)n=null===a[h][2]?[]:a[h][2],(a[h][1]===f||n.indexOf(f)>=0)&&(i=a[h])}if(null===l){var E=u[e.substring(0,2)],p=o[e.substring(0,1)];"da"===e.substring(0,2)&&(p=["dekao",10,"da"]),E?(F=E[2],m=e.substring(2)):p&&(F=p[1],m=e.substring(p[2].length));for(var g=0;g<a.length;g++)n=null===a[g][2]?[]:a[g][2],(a[g][1]===m||n.indexOf(m)>=0)&&(l=a[g])}return null===i||null===l?"#N/A":i[3]!==l[3]?"#N/A":r*i[6]*s/(l[6]*F)},Formula.DEC2BIN=function(r,t){if(isNaN(r))return"#VALUE!";if(!/^-?[0-9]{1,3}$/.test(r)||r<-512||r>511)return"#NUM!";if(r<0)return"1"+_s.repeat("0",9-(512+r).toString(2).length)+(512+r).toString(2);var e=parseInt(r,10).toString(2);return"undefined"==typeof t?e:isNaN(t)?"#VALUE!":t<0?"#NUM!":(t=Math.floor(t),t>=e.length?_s.repeat("0",t-e.length)+e:"#NUM!")},Formula.DEC2HEX=function(r,t){if(isNaN(r))return"#VALUE!";if(!/^-?[0-9]{1,12}$/.test(r)||r<-549755813888||r>549755813887)return"#NUM!";if(r<0)return(1099511627776+r).toString(16);var e=parseInt(r,10).toString(16);return"undefined"==typeof t?e:isNaN(t)?"#VALUE!":t<0?"#NUM!":(t=Math.floor(t),t>=e.length?_s.repeat("0",t-e.length)+e:"#NUM!")},Formula.DEC2OCT=function(r,t){if(isNaN(r))return"#VALUE!";if(!/^-?[0-9]{1,9}$/.test(r)||r<-536870912||r>536870911)return"#NUM!";if(r<0)return(1073741824+r).toString(8);var e=parseInt(r,10).toString(8);return"undefined"==typeof t?e:isNaN(t)?"#VALUE!":t<0?"#NUM!":(t=Math.floor(t),t>=e.length?_s.repeat("0",t-e.length)+e:"#NUM!")},Formula.DELTA=function(r,t){return t="undefined"==typeof t?0:t,isNaN(r)||isNaN(t)?"#VALUE!":r===t?1:0},Formula.ERF=function(r,t){return t="undefined"==typeof t?0:t,isNaN(r)||isNaN(t)?"#VALUE!":jStat.erf(r)},Formula.ERFC=function(r){return isNaN(r)?"#VALUE!":jStat.erfc(r)},Formula.ERFCPRECISE=function(){},Formula.ERFPRECISE=function(){},Formula.GESTEP=function(r,t){return t="undefined"==typeof t?0:t,isNaN(r)||isNaN(t)?"#VALUE!":r>=t?1:0},Formula.HEX2BIN=function(r,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(r))return"#NUM!";var e=10===r.length&&"f"===r.substring(0,1).toLowerCase(),n=e?parseInt(r,16)-1099511627776:parseInt(r,16);if(n<-512||n>511)return"#NUM!";if(e)return"1"+_s.repeat("0",9-(512+n).toString(2).length)+(512+n).toString(2);var a=n.toString(2);return"undefined"==typeof t?a:isNaN(t)?"#VALUE!":t<0?"#NUM!":(t=Math.floor(t),t>=a.length?_s.repeat("0",t-a.length)+a:"#NUM!")},Formula.HEX2DEC=function(r){if(!/^[0-9A-Fa-f]{1,10}$/.test(r))return"#NUM!";var t=parseInt(r,16);return t>=549755813888?t-1099511627776:t},Formula.HEX2OCT=function(r,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(r))return"#NUM!";var e=parseInt(r,16);if(e>536870911&&e<0xffe0000000)return"#NUM!";if(e>=0xffe0000000)return(e-0xffc0000000).toString(8);var n=e.toString(8);return"undefined"==typeof t?n:isNaN(t)?"#VALUE!":t<0?"#NUM!":(t=Math.floor(t),t>=n.length?_s.repeat("0",t-n.length)+n:"#NUM!")},Formula.IMABS=function(r){var t=Formula.IMREAL(r),e=Formula.IMAGINARY(r);return"#NUM!"===t||"#NUM!"===e?"#NUM!":Math.sqrt(Math.pow(t,2)+Math.pow(e,2))},Formula.IMAGINARY=function(r){if(0===r||"0"===r)return 0;if(["i","j"].indexOf(r)>=0)return 1;r=r.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j");var t=r.indexOf("+"),e=r.indexOf("-");0===t&&(t=r.indexOf("+",1)),0===e&&(e=r.indexOf("-",1));var n=r.substring(r.length-1,r.length),a="i"===n||"j"===n;return t>=0||e>=0?a?t>=0?isNaN(r.substring(0,t))||isNaN(r.substring(t+1,r.length-1))?"#NUM!":Number(r.substring(t+1,r.length-1)):isNaN(r.substring(0,e))||isNaN(r.substring(e+1,r.length-1))?"#NUM!":-Number(r.substring(e+1,r.length-1)):"#NUM!":a?isNaN(r.substring(0,r.length-1))?"#NUM!":r.substring(0,r.length-1):isNaN(r)?"#NUM!":0},Formula.IMARGUMENT=function(r){var t=Formula.IMREAL(r),e=Formula.IMAGINARY(r);return"#NUM!"===t||"#NUM!"===e?"#NUM!":0===t&&0===e?"#DIV/0!":0===t&&e>0?Math.PI/2:0===t&&e<0?-Math.PI/2:0===e&&t>0?0:0===e&&t<0?-Math.PI:t>0?Math.atan(e/t):t<0&&e>=0?Math.atan(e/t)+Math.PI:Math.atan(e/t)-Math.PI},Formula.IMCONJUGATE=function(r){var t=Formula.IMREAL(r),e=Formula.IMAGINARY(r),n=r.substring(r.length-1);
return n="i"===n||"j"===n?n:"i","#NUM!"===t||"#NUM!"===e?"#NUM!":0!==e?Formula.COMPLEX(t,-e,n):r},Formula.IMCOS=function(r){if(r===!0||r===!1)return"#VALUE!";var t=Formula.IMREAL(r),e=Formula.IMAGINARY(r),n=r.substring(r.length-1);return n="i"===n||"j"===n?n:"i","#NUM!"===t||"#NUM!"===e?"#NUM!":Formula.COMPLEX(Math.cos(t)*(Math.exp(e)+Math.exp(-e))/2,-Math.sin(t)*(Math.exp(e)-Math.exp(-e))/2,n)},Formula.IMCOSH=function(r){if(r===!0||r===!1)return"#VALUE!";var t=Formula.IMREAL(r),e=Formula.IMAGINARY(r),n=r.substring(r.length-1);return n="i"===n||"j"===n?n:"i","#NUM!"===t||"#NUM!"===e?"#NUM!":Formula.COMPLEX(Math.cos(e)*(Math.exp(t)+Math.exp(-t))/2,Math.sin(e)*(Math.exp(t)-Math.exp(-t))/2,n)},Formula.IMCOT=function(r){if(r===!0||r===!1)return"#VALUE!";var t=Formula.IMREAL(r),e=Formula.IMAGINARY(r);return"#NUM!"===t||"#NUM!"===e?"#NUM!":Formula.IMDIV(Formula.IMCOS(r),Formula.IMSIN(r))},Formula.IMCSC=function(r){if(r===!0||r===!1)return"#VALUE!";var t=Formula.IMREAL(r),e=Formula.IMAGINARY(r);return"#NUM!"===t||"#NUM!"===e?"#NUM!":Formula.IMDIV("1",Formula.IMSIN(r))},Formula.IMCSCH=function(r){if(r===!0||r===!1)return"#VALUE!";var t=Formula.IMREAL(r),e=Formula.IMAGINARY(r);return"#NUM!"===t||"#NUM!"===e?"#NUM!":Formula.IMDIV("1",Formula.IMSINH(r))},Formula.IMDIV=function(r,t){var e=Formula.IMREAL(r),n=Formula.IMAGINARY(r),a=Formula.IMREAL(t),u=Formula.IMAGINARY(t),o=r.substring(r.length-1),i=r.substring(r.length-1),l="i";if("j"===o?l="j":"j"===i&&(l="j"),"#NUM!"===e||"#NUM!"===n||"#NUM!"===a||"#NUM!"===u)return"#NUM!";if(0===a&&0===u)return"#NUM!";var f=a*a+u*u;return Formula.COMPLEX((e*a+n*u)/f,(n*a-e*u)/f,l)},Formula.IMEXP=function(r){var t=Formula.IMREAL(r),e=Formula.IMAGINARY(r),n=r.substring(r.length-1);if(n="i"===n||"j"===n?n:"i","#NUM!"===t||"#NUM!"===e)return"#NUM!";var a=Math.exp(t);return Formula.COMPLEX(a*Math.cos(e),a*Math.sin(e),n)},Formula.IMLN=function(r){var t=Formula.IMREAL(r),e=Formula.IMAGINARY(r),n=r.substring(r.length-1);return n="i"===n||"j"===n?n:"i","#NUM!"===t||"#NUM!"===e?"#NUM!":Formula.COMPLEX(Math.log(Math.sqrt(t*t+e*e)),Math.atan(e/t),n)},Formula.IMLOG10=function(r){var t=Formula.IMREAL(r),e=Formula.IMAGINARY(r),n=r.substring(r.length-1);return n="i"===n||"j"===n?n:"i","#NUM!"===t||"#NUM!"===e?"#NUM!":Formula.COMPLEX(Math.log(Math.sqrt(t*t+e*e))/Math.log(10),Math.atan(e/t)/Math.log(10),n)},Formula.IMLOG2=function(r){var t=Formula.IMREAL(r),e=Formula.IMAGINARY(r),n=r.substring(r.length-1);return n="i"===n||"j"===n?n:"i","#NUM!"===t||"#NUM!"===e?"#NUM!":Formula.COMPLEX(Math.log(Math.sqrt(t*t+e*e))/Math.log(2),Math.atan(e/t)/Math.log(2),n)},Formula.IMPOWER=function(r,t){if(isNaN(t))return"#VALUE!";var e=Formula.IMREAL(r),n=Formula.IMAGINARY(r),a=r.substring(r.length-1);if(a="i"===a||"j"===a?a:"i","#NUM!"===e||"#NUM!"===n)return"#NUM!";var u=Math.pow(Formula.IMABS(r),t),o=Formula.IMARGUMENT(r);return Formula.COMPLEX(u*Math.cos(t*o),u*Math.sin(t*o),a)},Formula.IMPRODUCT=function(){for(var r=arguments[0],t=1;t<arguments.length;t++){var e=Formula.IMREAL(r),n=Formula.IMAGINARY(r),a=Formula.IMREAL(arguments[t]),u=Formula.IMAGINARY(arguments[t]);if("#NUM!"===e||"#NUM!"===n||"#NUM!"===a||"#NUM!"===u)return"#NUM!";r=Formula.COMPLEX(e*a-n*u,e*u+n*a)}return r},Formula.IMREAL=function(r){if(0===r||"0"===r)return 0;if(["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(r)>=0)return 0;var t=r.indexOf("+"),e=r.indexOf("-");0===t&&(t=r.indexOf("+",1)),0===e&&(e=r.indexOf("-",1));var n=r.substring(r.length-1,r.length),a="i"===n||"j"===n;return t>=0||e>=0?a?t>=0?isNaN(r.substring(0,t))||isNaN(r.substring(t+1,r.length-1))?"#NUM!":Number(r.substring(0,t)):isNaN(r.substring(0,e))||isNaN(r.substring(e+1,r.length-1))?"#NUM!":Number(r.substring(0,e)):"#NUM!":a?isNaN(r.substring(0,r.length-1))?"#NUM!":0:isNaN(r)?"#NUM!":r},Formula.IMSEC=function(r){if(r===!0||r===!1)return"#VALUE!";var t=Formula.IMREAL(r),e=Formula.IMAGINARY(r);return"#NUM!"===t||"#NUM!"===e?"#NUM!":Formula.IMDIV("1",Formula.IMCOS(r))},Formula.IMSECH=function(r){if(r===!0||r===!1)return"#VALUE!";var t=Formula.IMREAL(r),e=Formula.IMAGINARY(r);return"#NUM!"===t||"#NUM!"===e?"#NUM!":Formula.IMDIV("1",Formula.IMCOSH(r))},Formula.IMSIN=function(r){if(r===!0||r===!1)return"#VALUE!";var t=Formula.IMREAL(r),e=Formula.IMAGINARY(r),n=r.substring(r.length-1);return n="i"===n||"j"===n?n:"i","#NUM!"===t||"#NUM!"===e?"#NUM!":Formula.COMPLEX(Math.sin(t)*(Math.exp(e)+Math.exp(-e))/2,Math.cos(t)*(Math.exp(e)-Math.exp(-e))/2,n)},Formula.IMSINH=function(r){if(r===!0||r===!1)return"#VALUE!";var t=Formula.IMREAL(r),e=Formula.IMAGINARY(r),n=r.substring(r.length-1);return n="i"===n||"j"===n?n:"i","#NUM!"===t||"#NUM!"===e?"#NUM!":Formula.COMPLEX(Math.cos(e)*(Math.exp(t)-Math.exp(-t))/2,Math.sin(e)*(Math.exp(t)+Math.exp(-t))/2,n)},Formula.IMSQRT=function(r){var t=Formula.IMREAL(r),e=Formula.IMAGINARY(r),n=r.substring(r.length-1);if(n="i"===n||"j"===n?n:"i","#NUM!"===t||"#NUM!"===e)return"#NUM!";var a=Math.sqrt(Formula.IMABS(r)),u=Formula.IMARGUMENT(r);return Formula.COMPLEX(a*Math.cos(u/2),a*Math.sin(u/2),n)},Formula.IMSUB=function(r,t){var e=Formula.IMREAL(r),n=Formula.IMAGINARY(r),a=Formula.IMREAL(t),u=Formula.IMAGINARY(t),o=r.substring(r.length-1),i=r.substring(r.length-1),l="i";return"j"===o?l="j":"j"===i&&(l="j"),"#NUM!"===e||"#NUM!"===n||"#NUM!"===a||"#NUM!"===u?"#NUM!":Formula.COMPLEX(e-a,n-u,l)},Formula.IMSUM=function(){for(var r=arguments[0],t=1;t<arguments.length;t++){var e=Formula.IMREAL(r),n=Formula.IMAGINARY(r),a=Formula.IMREAL(arguments[t]),u=Formula.IMAGINARY(arguments[t]);if("#NUM!"===e||"#NUM!"===n||"#NUM!"===a||"#NUM!"===u)return"#NUM!";r=Formula.COMPLEX(e+a,n+u)}return r},Formula.IMTAN=function(r){if(r===!0||r===!1)return"#VALUE!";var t=Formula.IMREAL(r),e=Formula.IMAGINARY(r);return"#NUM!"===t||"#NUM!"===e?"#NUM!":Formula.IMDIV(Formula.IMSIN(r),Formula.IMCOS(r))},Formula.OCT2BIN=function(r,t){if(!/^[0-7]{1,10}$/.test(r))return"#NUM!";var e=10===r.length&&"7"===r.substring(0,1),n=e?parseInt(r,8)-1073741824:parseInt(r,8);if(n<-512||n>511)return"#NUM!";if(e)return"1"+_s.repeat("0",9-(512+n).toString(2).length)+(512+n).toString(2);var a=n.toString(2);return"undefined"==typeof t?a:isNaN(t)?"#VALUE!":t<0?"#NUM!":(t=Math.floor(t),t>=a.length?_s.repeat("0",t-a.length)+a:"#NUM!")},Formula.OCT2DEC=function(r){if(!/^[0-7]{1,10}$/.test(r))return"#NUM!";var t=parseInt(r,8);return t>=536870912?t-1073741824:t},Formula.OCT2HEX=function(r,t){if(!/^[0-7]{1,10}$/.test(r))return"#NUM!";var e=parseInt(r,8);if(e>=536870912)return"ff"+(e+3221225472).toString(16);var n=e.toString(16);return"undefined"==typeof t?n:isNaN(t)?"#VALUE!":t<0?"#NUM!":(t=Math.floor(t),t>=n.length?_s.repeat("0",t-n.length)+n:"#NUM!")},Formula.ACCRINT=function(r,t,e,n,a,u,o,i){if(!moment(r).isValid()||!moment(t).isValid()||!moment(e).isValid())return"#VALUE!";if(n<=0||a<=0)return"#NUM!";if([1,2,4].indexOf(u)===-1)return"#NUM!";if([0,1,2,3,4].indexOf(o)===-1)return"#NUM!";if(moment(r).diff(moment(e))>=0)return"#NUM!";a="undefined"==typeof a?0:a,o="undefined"==typeof o?0:o,i="undefined"==typeof i||i;var l=0;switch(o){case 0:l=Formula.YEARFRAC(r,e,o);break;case 1:l=Formula.YEARFRAC(r,e,o);break;case 2:l=Formula.YEARFRAC(r,e,o);break;case 3:l=Formula.YEARFRAC(r,e,o);break;case 4:l=Formula.YEARFRAC(r,e,o)}return a*n*l},Formula.ACCRINTM=function(){},Formula.AMORDEGRC=function(){},Formula.AMORLINC=function(){},Formula.COUPDAYBS=function(){},Formula.COUPDAYS=function(){},Formula.COUPDAYSNC=function(){},Formula.COUPNCD=function(){},Formula.COUPNUM=function(){},Formula.COUPPCD=function(){},Formula.CUMIPMT=function(rate,periods,value,start,end,type){if(rate=eval(rate),periods=eval(periods),rate<=0||periods<=0||value<=0)return"#NUM!";if(start<1||end<1||start>end)return"#NUM!";if(0!==type&&1!==type)return"#NUM!";var payment=Formula.PMT(rate,periods,value,0,type),interest=0;1===start&&0===type&&(interest=-value,start++);for(var i=start;i<=end;i++)interest+=1===type?Formula.FV(rate,i-2,payment,value,1)-payment:Formula.FV(rate,i-1,payment,value,0);return interest*=rate},Formula.CUMPRINC=function(rate,periods,value,start,end,type){if(rate=eval(rate),periods=eval(periods),rate<=0||periods<=0||value<=0)return"#NUM!";if(start<1||end<1||start>end)return"#NUM!";if(0!==type&&1!==type)return"#NUM!";var payment=Formula.PMT(rate,periods,value,0,type),principal=0;1===start&&(principal=0===type?payment+value*rate:payment,start++);for(var i=start;i<=end;i++)principal+=type>0?payment-(Formula.FV(rate,i-2,payment,value,1)-payment)*rate:payment-Formula.FV(rate,i-1,payment,value,0)*rate;return principal},Formula.DB=function(r,t,e,n,a){if(a="undefined"==typeof a?12:a,isNaN(r)||isNaN(t)||isNaN(e)||isNaN(n)||isNaN(a))return"#VALUE!";if(r<0||t<0||e<0||n<0)return"#NUM!";if([1,2,3,4,5,6,7,8,9,10,11,12].indexOf(a)===-1)return"#NUM!";if(n>e)return"#NUM!";if(t>=r)return 0;for(var u=(1-Math.pow(t/r,1/e)).toFixed(3),o=r*u*a/12,i=o,l=0,f=n===e?e-1:n,m=2;m<=f;m++)l=(r-i)*u,i+=l;return 1===n?o:n===e?(r-i)*u:l},Formula.DDB=function(r,t,e,n,a){if(a="undefined"==typeof a?2:a,isNaN(r)||isNaN(t)||isNaN(e)||isNaN(n)||isNaN(a))return"#VALUE!";if(r<0||t<0||e<0||n<0||a<=0)return"#NUM!";if(n>e)return"#NUM!";if(t>=r)return 0;for(var u=0,o=0,i=1;i<=n;i++)o=Math.min((r-u)*(a/e),r-t-u),u+=o;return o},Formula.DISC=function(){},Formula.DOLLARDE=function(r,t){if(isNaN(r)||isNaN(t))return"#VALUE!";if(t<0)return"#NUM!";if(t>=0&&t<1)return"#DIV/0!";t=parseInt(t,10);var e=parseInt(r,10);e+=r%1*Math.pow(10,Math.ceil(Math.log(t)/Math.LN10))/t;var n=Math.pow(10,Math.ceil(Math.log(t)/Math.LN2)+1);return e=Math.round(e*n)/n},Formula.DOLLARFR=function(r,t){if(isNaN(r)||isNaN(t))return"#VALUE!";if(t<0)return"#NUM!";if(t>=0&&t<1)return"#DIV/0!";t=parseInt(t,10);var e=parseInt(r,10);return e+=r%1*Math.pow(10,-Math.ceil(Math.log(t)/Math.LN10))*t},Formula.DURATION=function(){},Formula.EFFECT=function(r,t){return isNaN(r)||isNaN(t)?"#VALUE!":r<=0||t<1?"#NUM!":(t=parseInt(t,10),Math.pow(1+r/t,t)-1)},Formula.FV=function(rate,periods,payment,value,type){type="undefined"==typeof type?0:type,rate=eval(rate);var result;if(0===rate)result=value+payment*periods;else{var term=Math.pow(1+rate,periods);result=1===type?value*term+payment*(1+rate)*(term-1)/rate:value*term+payment*(term-1)/rate}return-result},Formula.FVSCHEDULE=function(r,t){for(var e=r,n=0;n<t.length;n++){if(isNaN(t[n]))return"#VALUE!";e*=1+t[n]}return e},Formula.INTRATE=function(){},Formula.IPMT=function(rate,period,periods,present,future,type){type="undefined"==typeof type?0:type,rate=eval(rate),periods=eval(periods);var payment=Formula.PMT(rate,periods,present,future,type),interest;return interest=1===period?1===type?0:-present:1===type?Formula.FV(rate,period-2,payment,present,1)-payment:Formula.FV(rate,period-1,payment,present,0),interest*rate},Formula.IRR=function(r,t){r=Formula.FLATTEN(r);for(var e=function(r,t,e){for(var n=e+1,a=r[0],u=1;u<r.length;u++)a+=r[u]/Math.pow(n,(t[u]-t[0])/365);return a},n=function(r,t,e){for(var n=e+1,a=0,u=1;u<r.length;u++){var o=(t[u]-t[0])/365;a-=o*r[u]/Math.pow(n,o+1)}return a},a=[],u=!1,o=!1,i=0;i<r.length;i++)a[i]=0===i?0:a[i-1]+365,r[i]>0&&(u=!0),r[i]<0&&(o=!0);if(!u||!o)return"#NUM!";t="undefined"==typeof t?.1:t;var l,f,m,s=t,F=1e-10,M=50,c=0,N=!0;do m=e(r,a,s),l=s-m/n(r,a,s),f=Math.abs(l-s),s=l,N=f>F&&Math.abs(m)>F;while(N&&++c<M);return N?"#NUM!":s},Formula.ISPMT=function(rate,period,periods,value){return rate=eval(rate),periods=eval(periods),value*rate*(period/periods-1)},Formula.MDURATION=function(){},Formula.MIRR=function(r,t,e){for(var n=r.length,a=[],u=[],o=0;o<n;o++)r[o]<0?a.push(r[o]):u.push(r[o]);var i=-Formula.NPV(e,u)*Math.pow(1+e,n-1),l=Formula.NPV(t,a)*(1+t);return Math.pow(i/l,1/(n-1))-1},Formula.NOMINAL=function(r,t){return isNaN(r)||isNaN(t)?"#VALUE!":r<=0||t<1?"#NUM!":(t=parseInt(t,10),(Math.pow(r+1,1/t)-1)*t)},Formula.NPER=function(rate,payment,present,future,type){type="undefined"==typeof type?0:type,future="undefined"==typeof future?0:future,rate=eval(rate);var num=payment*(1+rate*type)-future*rate,den=present*rate+payment*(1+rate*type);return Math.log(num/den)/Math.log(1+rate)},Formula.NPV=function(){for(var r=[],t=0;t<arguments.length;t++)r=r.concat(arguments[t]);for(var e=r[0],n=0,a=1;a<r.length;a++)n+=r[a]/Math.pow(1+e,a);return n},Formula.ODDFPRICE=function(){},Formula.ODDFYIELD=function(){},Formula.ODDLPRICE=function(){},Formula.ODDLYIELD=function(){},Formula.PDURATION=function(r,t,e){return isNaN(r)||isNaN(t)||isNaN(e)?"#VALUE!":r<=0?"#NUM!":(Math.log(e)-Math.log(t))/Math.log(1+r)},Formula.PMT=function(rate,periods,present,future,type){type="undefined"==typeof type?0:type,rate=eval(rate),periods=eval(periods);var result;if(0===rate)result=(present+future)/periods;else{var term=Math.pow(1+rate,periods);result=1===type?(future*rate/(term-1)+present*rate/(1-1/term))/(1+rate):future*rate/(term-1)+present*rate/(1-1/term)}return-result},Formula.PPMT=function(r,t,e,n,a,u){return Formula.PMT(r,e,n,a,u)-Formula.IPMT(r,t,e,n,a,u)},Formula.PRICE=function(){},Formula.PRICEDISC=function(){},Formula.PRICEMAT=function(){},Formula.PV=function(rate,periods,payment,future,type){return type="undefined"==typeof type?0:type,rate=eval(rate),periods=eval(periods),0===rate?-payment*periods-future:((1-Math.pow(1+rate,periods))/rate*payment*(1+rate*type)-future)/Math.pow(1+rate,periods)},Formula.RATE=function(periods,payment,present,future,type,guess){guess="undefined"==typeof guess?.01:guess,future="undefined"==typeof future?0:future,type="undefined"==typeof type?0:type,periods=eval(periods);var epsMax=1e-10,iterMax=50,y,y0,y1,x0,x1=0,f=0,i=0,rate=guess;for(Math.abs(rate)<epsMax?y=present*(1+periods*rate)+payment*(1+rate*type)*periods+future:(f=Math.exp(periods*Math.log(1+rate)),y=present*f+payment*(1/rate+type)*(f-1)+future),y0=present+payment*periods+future,y1=present*f+payment*(1/rate+type)*(f-1)+future,i=x0=0,x1=rate;Math.abs(y0-y1)>epsMax&&i<iterMax;)rate=(y1*x0-y0*x1)/(y1-y0),x0=x1,x1=rate,Math.abs(rate)<epsMax?y=present*(1+periods*rate)+payment*(1+rate*type)*periods+future:(f=Math.exp(periods*Math.log(1+rate)),y=present*f+payment*(1/rate+type)*(f-1)+future),y0=y1,y1=y,++i;return rate},Formula.RECEIVED=function(){},Formula.RRI=function(r,t,e){return isNaN(r)||isNaN(t)||isNaN(e)?"#VALUE!":0===r||0===t?"#NUM!":Math.pow(e/t,1/r)-1},Formula.SLN=function(r,t,e){return isNaN(r)||isNaN(t)||isNaN(e)?"#VALUE!":0===e?"#NUM!":(r-t)/e},Formula.SYD=function(r,t,e,n){return isNaN(r)||isNaN(t)||isNaN(e)||isNaN(n)?"#VALUE!":0===e?"#NUM!":n<1||n>e?"#NUM!":(n=parseInt(n,10),(r-t)*(e-n+1)*2/(e*(e+1)))},Formula.TBILLEQ=function(r,t,e){return moment(r).isValid()&&moment(t).isValid()?e<=0?"#NUM!":moment(r).diff(moment(t))>0?"#NUM!":moment(t).diff(moment(r),"years")>1?"#NUM!":365*e/(360-e*Formula.DAYS360(r,t)):"#VALUE!"},Formula.TBILLPRICE=function(r,t,e){return moment(r).isValid()&&moment(t).isValid()?e<=0?"#NUM!":moment(r).diff(moment(t))>0?"#NUM!":moment(t).diff(moment(r),"years")>1?"#NUM!":100*(1-e*Formula.DAYS360(r,t)/360):"#VALUE!"},Formula.TBILLYIELD=function(r,t,e){return moment(r).isValid()&&moment(t).isValid()?e<=0?"#NUM!":moment(r).diff(moment(t))>0?"#NUM!":moment(t).diff(moment(r),"years")>1?"#NUM!":360*(100-e)/(e*Formula.DAYS360(r,t)):"#VALUE!"},Formula.VDB=function(){},Formula.XIRR=function(r,t,e){for(var n=function(r,t,e){for(var n=e+1,a=r[0],u=1;u<r.length;u++)a+=r[u]/Math.pow(n,moment(t[u]).diff(moment(t[0]),"days")/365);return a},a=function(r,t,e){for(var n=e+1,a=0,u=1;u<r.length;u++){var o=moment(t[u]).diff(moment(t[0]),"days")/365;a-=o*r[u]/Math.pow(n,o+1)}return a},u=!1,o=!1,i=0;i<r.length;i++)r[i]>0&&(u=!0),r[i]<0&&(o=!0);if(!u||!o)return"#NUM!";e=e||.1;var l,f,m,s=e,F=1e-10,M=50,c=0,N=!0;do m=n(r,t,s),l=s-m/a(r,t,s),f=Math.abs(l-s),s=l,N=f>F&&Math.abs(m)>F;while(N&&++c<M);return N?"#NUM!":s},Formula.XNPV=function(r,t,e){for(var n=0,a=0;a<t.length;a++)n+=t[a]/Math.pow(1+r,moment(e[a]).diff(moment(e[0]),"days")/365);return n},Formula.YIELD=function(){},Formula.YIELDDISC=function(){},Formula.YIELDMAT=function(){},Formula.ISNUMBER=function(r){return!(isNaN(parseFloat(r))||!isFinite(r))},Formula.AND=function(){for(var r=!0,t=0;t<arguments.length;t++)arguments[t]||(r=!1);return r},Formula.FALSE=function(){return!1},Formula.SWITCH=function(){var r;if(arguments.length>0){var t=arguments[0],e=arguments.length-1,n=Math.floor(e/2),a=!1,u=e%2===0?null:arguments[arguments.length-1];if(n)for(var o=0;o<n;o++)if(t===arguments[2*o+1]){r=arguments[2*o+2],a=!0;break}!a&&u&&(r=u)}return r},Formula.IF=function(r,t,e){return r?t:e},Formula.IFNA=function(r,t){return"#N/A"===r?t:r},Formula.NOT=function(r){return!r},Formula.OR=function(){for(var r=!1,t=0;t<arguments.length;t++)arguments[t]&&(r=!0);return r},Formula.TRUE=function(){return!0},Formula.XOR=function(){for(var r=0,t=0;t<arguments.length;t++)arguments[t]&&r++;return!!(1&Math.floor(Math.abs(r)))},Formula.REFERENCE=function(r,t){try{var e=t.split("."),n=r;return _(e).forEach(function(r){if("]"===r[r.length-1]){var t=r.indexOf("["),e=r.substring(t+1,r.length-1);n=n[r.substring(0,t)][e]}else n=n[r]}),n}catch(r){return}},Formula.ABS=function(r){return Math.abs(r)},Formula.ACOS=function(r){return Math.acos(r)},Formula.ACOSH=function(r){return Math.log(r+Math.sqrt(r*r-1))},Formula.ACOT=function(r){return Math.atan(1/r)},Formula.ACOTH=function(r){return.5*Math.log((r+1)/(r-1))},Formula.AGGREGATE=function(r){for(var t=[],e=2;e<arguments.length;e++)switch(r){case 1:t[e-2]=Formula.AVERAGE(arguments[e]);break;case 2:t[e-2]=Formula.COUNT(arguments[e]);break;case 3:t[e-2]=Formula.COUNTA(arguments[e]);break;case 4:t[e-2]=Formula.MAX(arguments[e]);break;case 5:t[e-2]=Formula.MIN(arguments[e]);break;case 6:t[e-2]=Formula.PRODUCT(arguments[e]);break;case 7:t[e-2]=Formula.STDEVS(arguments[e]);break;case 8:t[e-2]=Formula.STDEVP(arguments[e]);break;case 9:t[e-2]=Formula.SUM(arguments[e]);break;case 10:t[e-2]=Formula.VARS(arguments[e]);break;case 11:t[e-2]=Formula.VARP(arguments[e]);break;case 12:t[e-2]=Formula.MEDIAN(arguments[e]);break;case 13:t[e-2]=Formula.MODESNGL(arguments[e]);break;case 14:t[e-2]=Formula.LARGE(arguments[e]);break;case 15:t[e-2]=Formula.SMALL(arguments[e]);break;case 16:t[e-2]=Formula.PERCENTILEINC(arguments[e]);break;case 17:t[e-2]=Formula.QUARTILEINC(arguments[e]);break;case 18:t[e-2]=Formula.PERCENTILEEXC(arguments[e]);break;case 19:t[e-2]=Formula.QUARTILEEXC(arguments[e])}return t},Formula.ARABIC=function(r){if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(r))throw new Error("Incorrect roman number");var t=0;return r.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(r){t+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[r]}),t},Formula.ASIN=function(r){return Math.asin(r)},Formula.ASINH=function(r){return Math.log(r+Math.sqrt(r*r+1))},Formula.ATAN=function(r){return Math.atan(r)},Formula.ATAN2=function(r,t){return Math.atan2(r,t)},Formula.ATANH=function(r){return Math.log((1+r)/(1-r))/2},Formula.BASE=function(r,t,e){e="undefined"==typeof e?0:e;var n=r.toString(t);return new Array(Math.max(e+1-n.length,0)).join("0")+n},Formula.CEILING=function(r,t,e){if(0===t)return 0;t="undefined"==typeof t?1:Math.abs(t),e="undefined"==typeof e?0:e;var n=-Math.floor(Math.log(t)/Math.log(10));return r>=0?Formula.ROUND(Math.ceil(r/t)*t,n):0===e?-Formula.ROUND(Math.floor(Math.abs(r)/t)*t,n):-Formula.ROUND(Math.ceil(Math.abs(r)/t)*t,n)},Formula.CEILINGMATH=Formula.CEILING,Formula.CEILINGPRECISE=Formula.CEILING,Formula.COMBIN=function(r,t){return Formula.FACT(r)/(Formula.FACT(t)*Formula.FACT(r-t))},Formula.COMBINA=function(r,t){return 0===r&&0===t?1:Formula.COMBIN(r+t-1,r-1)},Formula.COS=Math.cos,Formula.COSH=function(r){return(Math.exp(r)+Math.exp(-r))/2},Formula.COT=function(r){return 1/Math.tan(r)},Formula.COTH=function(r){var t=Math.exp(2*r);return(t+1)/(t-1)},Formula.CSC=function(r){return 1/Math.sin(r)},Formula.CSCH=function(r){return 2/(Math.exp(r)-Math.exp(-r))},Formula.DECIMAL=function(r,t){return parseInt(r,t)},Formula.DEGREES=function(r){return 180*r/Math.PI},Formula.EVEN=function(r){return Formula.CEILING(r,-2,-1)},Formula.EXP=Math.exp,Formula.FACT=function(r){var t=Math.floor(r);return 0===t||1===t?1:MEMOIZED_FACT[t]>0?MEMOIZED_FACT[t]:(MEMOIZED_FACT[t]=Formula.FACT(t-1)*t,MEMOIZED_FACT[t])},Formula.FACTDOUBLE=function(r){var t=Math.floor(r);return t<=0?1:t*Formula.FACTDOUBLE(t-2)},Formula.FLOOR=function(r,t,e){if(0===t)return 0;t=t?Math.abs(t):1;var n=-Math.floor(Math.log(t)/Math.log(10));return r>=0?Formula.ROUND(Math.floor(r/t)*t,n):0===e||"undefined"==typeof e?-Formula.ROUND(Math.ceil(Math.abs(r)/t)*t,n):-Formula.ROUND(Math.floor(Math.abs(r)/t)*t,n)},Formula.FLOORMATH=Formula.FLOOR,Formula.FLOORPRECISE=function(r,t){if(0===t)return 0;t=t?Math.abs(t):1;var e=-Math.floor(Math.log(t)/Math.log(10));return r>=0?Formula.ROUND(Math.round(r/t)*t,e):-Formula.ROUND(Math.ceil(Math.abs(r)/t)*t,e)},Formula.GCD=function(){for(var r,t,e=arguments.length-1,n=arguments[e];e;)for(t=arguments[--e];r=t%n;t=n,n=r);return n},Formula.INT=function(r){return Math.floor(r)},Formula.ISEVEN=function(r){return!(1&Math.floor(Math.abs(r)))},Formula.ISOCEILING=Formula.CEILING,Formula.ISODD=function(r){return!!(1&Math.floor(Math.abs(r)))},Formula.LCM=function(){for(var r,t,e,n,a=Formula.ARGSTOARRAY(arguments),u=1;void 0!==(e=a.pop());)for(;e>1;){if(e%2){for(r=3,t=Math.floor(Math.sqrt(e));r<=t&&e%r;r+=2);n=r<=t?r:e}else n=2;for(e/=n,u*=n,r=a.length;r;a[--r]%n===0&&1===(a[r]/=n)&&a.splice(r,1));}return u},Formula.LN=function(r){return Math.log(r)},Formula.LOG=function(r,t){return t="undefined"==typeof t?10:t,Math.log(r)/Math.log(t)},Formula.LOG10=function(r){return Math.log(r)/Math.log(10)},Formula.MDETERM=numeric.det,Formula.MINVERSE=numeric.inv,Formula.MMULT=numeric.dot,Formula.MOD=function(r,t){var e=Math.abs(r%t);return t>0?e:-e},Formula.MROUND=function(r,t){if(r*t<0)throw new Error("Number and multiple must have the same sign.");return Math.round(r/t)*t},Formula.MULTINOMIAL=function(){for(var r=0,t=1,e=0;e<arguments.length;e++)r+=arguments[e],t*=Formula.FACT(arguments[e]);return Formula.FACT(r)/t},Formula.MUNIT=numeric.identity,Formula.ODD=function(r){var t=Math.ceil(Math.abs(r));return t=1&t?t:t+1,r>0?t:-t},Formula.PI=function(){return Math.PI},Formula.POWER=function(r,t){var e=Math.pow(r,t);return isNaN(e)?"#NUM!":e},Formula.PRODUCT=function(){for(var r=1,t=0;t<arguments.length;t++)r*=arguments[t];return r},Formula.QUOTIENT=function(r,t){return(r/t).toFixed(0)},Formula.RADIANS=function(r){return r*Math.PI/180},Formula.RAND=function(){return Math.random()},Formula.RANDBETWEEN=function(r,t){return r+Math.ceil((t-r+1)*Math.random())-1},Formula.ROUND=function(r,t){return Math.round(r*Math.pow(10,t))/Math.pow(10,t)},Formula.ROUNDDOWN=function(r,t){var e=r>0?1:-1;return e*Math.floor(Math.abs(r)*Math.pow(10,t))/Math.pow(10,t)},Formula.ROUNDUP=function(r,t){var e=r>0?1:-1;return e*Math.ceil(Math.abs(r)*Math.pow(10,t))/Math.pow(10,t)},Formula.SERIESSUM=function(r,t,e,n){for(var a=n[0]*Math.pow(r,t),u=1;u<n.length;u++)a+=n[u]*Math.pow(r,t+u*e);return a},Formula.SEC=function(r){return 1/Math.cos(r)},Formula.SECH=function(r){return 2/(Math.exp(r)+Math.exp(-r))},Formula.SIGN=function(r){return r<0?-1:0===r?0:1},Formula.SIN=Math.sin,Formula.SINH=function(r){return(Math.exp(r)-Math.exp(-r))/2},Formula.SQRT=Math.sqrt,Formula.SQRTPI=function(r){return Math.sqrt(r*Math.PI)},Formula.SUBTOTAL=function(r){for(var t=[],e=1;e<arguments.length;e++)switch(r){case 1:t[e-1]=Formula.AVERAGE(arguments[e]);break;case 2:t[e-1]=Formula.COUNT(arguments[e]);break;case 3:t[e-1]=Formula.COUNTA(arguments[e]);break;case 4:t[e-1]=Formula.MAX(arguments[e]);break;case 5:t[e-1]=Formula.MIN(arguments[e]);break;case 6:t[e-1]=Formula.PRODUCT(arguments[e]);break;case 7:t[e-1]=Formula.STDEV(arguments[e]);break;case 8:t[e-1]=Formula.STDEVP(arguments[e]);break;case 9:t[e-1]=Formula.SUM(arguments[e]);break;case 10:t[e-1]=Formula.VAR(arguments[e]);break;case 11:t[e-1]=Formula.VARP(arguments[e])}return t},Formula.SUM=function(){for(var r=Formula.FLATTEN(arguments),t=0,e=r.length;e--;)t+=r[e];return t},Formula.SUMIF=function(range,criteria){range=Formula.FLATTEN(range);for(var result=0,i=0;i<range.length;i++)result+=eval(range[i]+criteria)?range[i]:0;return result},Formula.SUMIFS=function(){for(var args=Formula.ARGSTOARRAY(arguments),range=Formula.FLATTEN(args.shift()),criteria=args,n_range_elements=range.length,n_criterias=criteria.length,result=0,i=0;i<n_range_elements;i++){for(var el=range[i],condition="",c=0;c<n_criterias;c++)condition+=el+criteria[c],c!==n_criterias-1&&(condition+="&&");eval(condition)&&(result+=el)}return result},Formula.SUMPRODUCT=function(){for(var r=arguments.length+1,t=0,e=0;e<arguments[0].length;e++)for(var n=0;n<arguments[0][e].length;n++){for(var a=1,u=1;u<r;u++)a*=arguments[u-1][e][n];t+=a}return t},Formula.SUMSQ=function(){for(var r=Formula.FLATTEN(arguments),t=0,e=0;e<r.length;e++)t+=Formula.ISNUMBER(r[e])?r[e]*r[e]:0;return t},Formula.SUMX2MY2=function(r,t){var e=0;r=Formula.FLATTEN(r),t=Formula.FLATTEN(t);for(var n=0;n<r.length;n++)e+=r[n]*r[n]-t[n]*t[n];return e},Formula.SUMX2PY2=function(r,t){var e=0;r=Formula.FLATTEN(r),t=Formula.FLATTEN(t);for(var n=0;n<r.length;n++)e+=r[n]*r[n]+t[n]*t[n];return e},Formula.SUMXMY2=function(r,t){var e=0;r=Formula.FLATTEN(r),t=Formula.FLATTEN(t);for(var n=0;n<r.length;n++)e+=Math.pow(r[n]-t[n],2);return e},Formula.TAN=function(r){return Math.tan(r)},Formula.TANH=function(r){var t=Math.exp(2*r);return(t-1)/(t+1)},Formula.TRUNC=function(r,t){t="undefined"==typeof t?0:t;var e=r>0?1:-1;return e*Math.floor(Math.abs(r)*Math.pow(10,t))/Math.pow(10,t)},Formula.AVEDEV=function(){var r=Formula.FLATTEN(arguments);return jStat.sum(jStat(r).subtract(jStat.mean(r)).abs()[0])/r.length},Formula.AVERAGE=function(){for(var r=Formula.NUMBERS(Formula.FLATTEN(arguments)),t=r.length,e=0,n=0,a=0;a<t;a++)e+=r[a],n+=1;return e/n},Formula.AVERAGEA=function(){for(var r=Formula.FLATTEN(arguments),t=r.length,e=0,n=0,a=0;a<t;a++){var u=r[a];"number"==typeof u&&(e+=u),u===!0&&e++,null!==u&&n++}return e/n},Formula.AVERAGEIF=function(range,criteria,average_range){average_range=average_range||range,range=Formula.FLATTEN(range),average_range=Formula.FLATTEN(average_range);for(var average_count=0,result=0,i=0;i<range.length;i++)eval(range[i]+criteria)&&(result+=average_range[i],average_count++);return result/average_count},Formula.AVERAGEIFS=function(){for(var args=Formula.ARGSTOARRAY(arguments),criteria=(args.length-1)/2,range=Formula.FLATTEN(args[0]),count=0,result=0,i=0;i<range.length;i++){for(var condition="",j=0;j<criteria;j++)condition+=args[2*j+1][i]+args[2*j+2],j!==criteria-1&&(condition+="&&");eval(condition)&&(result+=range[i],count++)}var average=result/count;return isNaN(average)?0:average},Formula.BETADIST=function(r,t,e,n,a,u){return a="undefined"==typeof a?0:a,u="undefined"==typeof u?1:u,r=(r-a)/(u-a),n?jStat.beta.cdf(r,t,e):jStat.beta.pdf(r,t,e)},Formula.BETAINV=function(r,t,e,n,a){return n="undefined"==typeof n?0:n,a="undefined"==typeof a?1:a,jStat.beta.inv(r,t,e)*(a-n)+n},Formula.BINOMDIST=function(r,t,e,n){return n?jStat.binomial.cdf(r,t,e):jStat.binomial.pdf(r,t,e)},Formula.BINOMDISTRANGE=function(r,t,e,n){n="undefined"==typeof n?e:n;for(var a=0,u=e;u<=n;u++)a+=Formula.COMBIN(r,u)*Math.pow(t,u)*Math.pow(1-t,r-u);return a},Formula.BINOMINV=function(r,t,e){for(var n=0;n<=r;){if(jStat.binomial.cdf(n,r,t)>=e)return n;n++}},Formula.CHISQDIST=function(r,t,e){return e?jStat.chisquare.cdf(r,t):jStat.chisquare.pdf(r,t)},Formula.CHISQDISTRT=function(){},Formula.CHISQINV=function(r,t){return jStat.chisquare.inv(r,t)},Formula.CHISQINVRT=function(){},Formula.CHISQTEST=function(){},Formula.CONFIDENCENORM=function(r,t,e){return jStat.normalci(1,r,t,e)[1]-1},Formula.CONFIDENCET=function(r,t,e){return jStat.tci(1,r,t,e)[1]-1},Formula.CORREL=function(){return jStat.corrcoeff.apply(this,arguments)},Formula.COUNT=function(){var r=Formula.NUMBERS(Formula.FLATTEN(arguments));return r.length},Formula.COUNTA=function(){var r=Formula.FLATTEN(arguments);return r.length-Formula.COUNTBLANK(r)},Formula.COUNTBLANK=function(){for(var r,t=Formula.FLATTEN(arguments),e=0,n=0;n<t.length;n++)r=t[n],null!==r&&""!==r||e++;return e},Formula.COUNTIF=function(range,criteria){range=Formula.FLATTEN(range),/[<>=!]/.test(criteria)||(criteria='=="'+criteria+'"');for(var matches=0,i=0;i<range.length;i++)"string"!=typeof range[i]?eval(range[i]+criteria)&&matches++:eval('"'+range[i]+'"'+criteria)&&matches++;return matches},Formula.COUNTIFS=function(){for(var args=Formula.ARGSTOARRAY(arguments),results=new Array(Formula.FLATTEN(args[0]).length),i=0;i<results.length;i++)results[i]=!0;for(i=0;i<args.length;i+=2){var range=Formula.FLATTEN(args[i]),criteria=args[i+1];/[<>=!]/.test(criteria)||(criteria='=="'+criteria+'"');for(var j=0;j<range.length;j++)"string"!=typeof range[j]?results[j]=results[j]&&eval(range[j]+criteria):results[j]=results[j]&&eval('"'+range[j]+'"'+criteria)}var result=0;for(i=0;i<results.length;i++)results[i]&&result++;return result},Formula.COUNTUNIQUE=function(){return _.uniq(Formula.FLATTEN(arguments)).length},Formula.COVARIANCEP=function(r,t){for(var e=jStat.mean(r),n=jStat.mean(t),a=0,u=r.length,o=0;o<u;o++)a+=(r[o]-e)*(t[o]-n);return a/u},Formula.COVARIANCES=function(){return jStat.covariance.apply(this,arguments)},Formula.DEVSQ=function(){for(var r=Formula.ARGSCONCAT(arguments),t=jStat.mean(r),e=0,n=0;n<r.length;n++)e+=Math.pow(r[n]-t,2);return e},Formula.EXPONDIST=function(r,t,e){return e?jStat.exponential.cdf(r,t):jStat.exponential.pdf(r,t)},Formula.FDIST=function(r,t,e,n){return n?jStat.centralF.cdf(r,t,e):jStat.centralF.pdf(r,t,e)},Formula.FDISTRT=function(){},Formula.FINV=function(r,t,e){return r<=0||r>1?"#NUM!":jStat.centralF.inv(1-r,t,e)},Formula.FINVRT=function(){},Formula.FTEST=function(){},Formula.FISHER=function(r){return Math.log((1+r)/(1-r))/2},Formula.FISHERINV=function(r){var t=Math.exp(2*r);return(t-1)/(t+1)},Formula.FORECAST=function(r,t,e){for(var n=jStat.mean(e),a=jStat.mean(t),u=e.length,o=0,i=0,l=0;l<u;l++)o+=(e[l]-n)*(t[l]-a),i+=Math.pow(e[l]-n,2);var f=o/i,m=a-f*n;return m+f*r},Formula.FREQUENCY=function(r,t){for(var e=r.length,n=t.length,a=[],u=0;u<=n;u++){a[u]=0;for(var o=0;o<e;o++)0===u?r[o]<=t[0]&&(a[0]+=1):u<n?r[o]>t[u-1]&&r[o]<=t[u]&&(a[u]+=1):u===n&&r[o]>t[n-1]&&(a[n]+=1)}return a},Formula.GAMMA=function(){return jStat.gammafn.apply(this,arguments)},Formula.GAMMADIST=function(){},Formula.GAMMAINV=function(){},Formula.GAMMALN=function(){return jStat.gammaln.apply(this,arguments)},Formula.GAMMALNPRECISE=function(){},Formula.GAUSS=function(r){return jStat.normal.cdf(r,0,1)-.5},Formula.GEOMEAN=function(){return jStat.geomean(Formula.ARGSCONCAT(arguments))},Formula.GROWTH=function(r,t,e,n){var a;if("undefined"==typeof t)for(t=[],a=1;a<=r.length;a++)t.push(a);if("undefined"==typeof e)for(e=[],a=1;a<=r.length;a++)e.push(a);"undefined"==typeof n&&(n=!0);var u=r.length,o=0,i=0,l=0,f=0;for(a=0;a<u;a++){var m=t[a],s=Math.log(r[a]);o+=m,i+=s,l+=m*s,f+=m*m}o/=u,i/=u,l/=u,f/=u;var F,M;n?(F=(l-o*i)/(f-o*o),M=i-F*o):(F=l/f,M=0);var c=[];for(a=0;a<e.length;a++)c.push(Math.exp(M+F*e[a]));return c},Formula.HARMEAN=function(){for(var r=Formula.ARGSCONCAT(arguments),t=r.length,e=0,n=0;n<t;n++)e+=1/r[n];return t/e},Formula.HYPGEOMDIST=function(r,t,e,n,a){function u(r,t,e,n){return Formula.COMBIN(e,r)*Formula.COMBIN(n-e,t-r)/Formula.COMBIN(n,t)}function o(r,t,e,n){for(var a=0,o=0;o<=r;o++)a+=u(o,t,e,n);return a}return a?o(r,t,e,n):u(r,t,e,n)},Formula.INTERCEPT=function(r,t){return Formula.FORECAST(0,r,t)},Formula.KURT=function(){for(var r=Formula.ARGSCONCAT(arguments),t=jStat.mean(r),e=r.length,n=0,a=0;a<e;a++)n+=Math.pow(r[a]-t,4);return n/=Math.pow(jStat.stdev(r,!0),4),e*(e+1)/((e-1)*(e-2)*(e-3))*n-3*(e-1)*(e-1)/((e-2)*(e-3))},Formula.LARGE=function(r,t){return r.sort(function(r,t){return t-r})[t-1]},Formula.LINEST=function(r,t){for(var e=jStat.mean(t),n=jStat.mean(r),a=t.length,u=0,o=0,i=0;i<a;i++)u+=(t[i]-e)*(r[i]-n),o+=Math.pow(t[i]-e,2);var l=u/o,f=n-l*e;return[l,f]},Formula.LOGEST=function(){},
Formula.LOGNORMDIST=function(r,t,e,n){return n?jStat.lognormal.cdf(r,t,e):jStat.lognormal.pdf(r,t,e)},Formula.LOGNORMINV=function(r,t,e){return jStat.lognormal.inv(r,t,e)},Formula.MAX=function(){for(var r=Formula.FLATTEN(arguments),t=r.length,e=t>0?r[0]:0,n=0;n<t;n++)e=r[n]>e&&r[n]!==!0&&r[n]!==!1?r[n]:e;return e},Formula.MAXA=function(){var r=Formula.FLATTEN(arguments);return r.length>0?Math.max.apply(Math,r):0},Formula.MEDIAN=function(){return jStat.median(Formula.FLATTEN(arguments))},Formula.MIN=function(){for(var r=Formula.FLATTEN(arguments),t=r.length,e=t>0?r[0]:0,n=0;n<t;n++)e=r[n]<e&&r[n]!==!0&&r[n]!==!1?r[n]:e;return e},Formula.MINA=function(){var r=Formula.FLATTEN(arguments);return r.length>0?Math.min.apply(Math,r):0},Formula.MODEMULT=function(){for(var r,t=Formula.ARGSCONCAT(arguments),e=t.length,n={},a=[],u=0,o=0;o<e;o++)r=t[o],n[r]=n[r]?n[r]+1:1,n[r]>u&&(u=n[r],a=[]),n[r]===u&&(a[a.length]=r);return a},Formula.MODESNGL=function(){return Formula.MODEMULT(Formula.ARGSCONCAT(arguments)).sort(function(r,t){return r-t})[0]},Formula.NEGBINOMDIST=function(r,t,e,n){return n?jStat.negbin.cdf(r,t,e):jStat.negbin.pdf(r,t,e)},Formula.NORMDIST=function(r,t,e,n){return isNaN(r)||isNaN(t)||isNaN(e)?"#VALUE!":e<=0?"#NUM!":n?jStat.normal.cdf(r,t,e):jStat.normal.pdf(r,t,e)},Formula.NORMINV=function(r,t,e){return jStat.normal.inv(r,t,e)},Formula.NORMSDIST=function(r,t){return t?jStat.normal.cdf(r,0,1):jStat.normal.pdf(r,0,1)},Formula.NORMSINV=function(r){return jStat.normal.inv(r,0,1)},Formula.PEARSON=function(r,t){for(var e=jStat.mean(r),n=jStat.mean(t),a=r.length,u=0,o=0,i=0,l=0;l<a;l++)u+=(r[l]-e)*(t[l]-n),o+=Math.pow(r[l]-e,2),i+=Math.pow(t[l]-n,2);return u/Math.sqrt(o*i)},Formula.PERCENTILEEXC=function(r,t){r=r.sort(function(r,t){return r-t});var e=r.length;if(t<1/(e+1)||t>1-1/(e+1))return"#NUM!";var n=t*(e+1)-1,a=Math.floor(n);return Formula.CLEANFLOAT(n===a?r[n]:r[a]+(n-a)*(r[a+1]-r[a]))},Formula.PERCENTILEINC=function(r,t){r=r.sort(function(r,t){return r-t});var e=r.length,n=t*(e-1),a=Math.floor(n);return Formula.CLEANFLOAT(n===a?r[n]:r[a]+(n-a)*(r[a+1]-r[a]))},Formula.PERCENTRANKEXC=function(r,t,e){r=r.sort(function(r,t){return r-t});var n=_.uniq(r),a=r.length,u=n.length;e="undefined"==typeof e?3:e;for(var o=Math.pow(10,e),i=0,l=!1,f=0;!l&&f<u;)t===n[f]?(i=(r.indexOf(n[f])+1)/(a+1),l=!0):t>=n[f]&&(t<n[f+1]||f===u-1)&&(i=(r.indexOf(n[f])+1+(t-n[f])/(n[f+1]-n[f]))/(a+1),l=!0),f++;return Math.floor(i*o)/o},Formula.PERCENTRANKINC=function(r,t,e){r=r.sort(function(r,t){return r-t});var n=_.uniq(r),a=r.length,u=n.length;e="undefined"==typeof e?3:e;for(var o=Math.pow(10,e),i=0,l=!1,f=0;!l&&f<u;)t===n[f]?(i=r.indexOf(n[f])/(a-1),l=!0):t>=n[f]&&(t<n[f+1]||f===u-1)&&(i=(r.indexOf(n[f])+(t-n[f])/(n[f+1]-n[f]))/(a-1),l=!0),f++;return Math.floor(i*o)/o},Formula.PERMUT=function(r,t){return Formula.FACT(r)/Formula.FACT(r-t)},Formula.PERMUTATIONA=function(r,t){return Math.pow(r,t)},Formula.PHI=function(r){return Math.exp(-.5*r*r)/SQRT2PI},Formula.POISSONDIST=function(r,t,e){return e?jStat.poisson.cdf(r,t):jStat.poisson.pdf(r,t)},Formula.PROB=function(r,t,e,n){if("undefined"==typeof e)return 0;if(n="undefined"==typeof n?e:n,e===n)return r.indexOf(e)>=0?t[r.indexOf(e)]:0;for(var a=r.sort(function(r,t){return r-t}),u=a.length,o=0,i=0;i<u;i++)a[i]>=e&&a[i]<=n&&(o+=t[r.indexOf(a[i])]);return o},Formula.QUARTILEEXC=function(r,t){switch(t){case 1:return Formula.PERCENTILEEXC(r,.25);case 2:return Formula.PERCENTILEEXC(r,.5);case 3:return Formula.PERCENTILEEXC(r,.75);default:return"#NUM!"}},Formula.QUARTILEINC=function(r,t){switch(t){case 1:return Formula.PERCENTILEINC(r,.25);case 2:return Formula.PERCENTILEINC(r,.5);case 3:return Formula.PERCENTILEINC(r,.75);default:return"#NUM!"}},Formula.RANKAVG=function(r,t,e){e="undefined"!=typeof e&&e;var n=e?function(r,t){return r-t}:function(r,t){return t-r};t=t.sort(n);var a=Formula.COUNTIN(t,r);return a>1?(2*t.indexOf(r)+a+1)/2:t.indexOf(r)+1},Formula.RANKEQ=function(r,t,e){e="undefined"!=typeof e&&e;var n=e?function(r,t){return r-t}:function(r,t){return t-r};return t=t.sort(n),t.indexOf(r)+1},Formula.RSQ=function(r,t){return Math.pow(Formula.PEARSON(r,t),2)},Formula.SKEW=function(){for(var r=Formula.ARGSCONCAT(arguments),t=jStat.mean(r),e=r.length,n=0,a=0;a<e;a++)n+=Math.pow(r[a]-t,3);return e*n/((e-1)*(e-2)*Math.pow(jStat.stdev(r,!0),3))},Formula.SKEWP=function(){for(var r=Formula.ARGSCONCAT(arguments),t=jStat.mean(r),e=r.length,n=0,a=0,u=0;u<e;u++)a+=Math.pow(r[u]-t,3),n+=Math.pow(r[u]-t,2);return a/=e,n/=e,a/Math.pow(n,1.5)},Formula.SLOPE=function(r,t){for(var e=jStat.mean(t),n=jStat.mean(r),a=t.length,u=0,o=0,i=0;i<a;i++)u+=(t[i]-e)*(r[i]-n),o+=Math.pow(t[i]-e,2);return u/o},Formula.SMALL=function(r,t){return r.sort(function(r,t){return r-t})[t-1]},Formula.STANDARDIZE=function(r,t,e){return(r-t)/e},Formula.STDEVA=function(){for(var r=Formula.FLATTEN(arguments),t=r.length,e=0,n=jStat.mean(r),a=0;a<t;a++)e+=Math.pow(r[a]-n,2);return Math.sqrt(e/(t-1))},Formula.STDEVP=function(){for(var r=Formula.FLATTEN(arguments),t=r.length,e=0,n=0,a=Formula.AVERAGE(r),u=0;u<t;u++)r[u]!==!0&&r[u]!==!1&&(e+=Math.pow(r[u]-a,2),n++);return Math.sqrt(e/n)},Formula.STDEVPA=function(){for(var r=Formula.ARGSCONCAT(arguments),t=r.length,e=0,n=jStat.mean(r),a=0;a<t;a++)e+=Math.pow(r[a]-n,2);return Math.sqrt(e/t)},Formula.STDEVS=function(){for(var r=Formula.FLATTEN(arguments),t=r.length,e=0,n=0,a=Formula.AVERAGE(r),u=0;u<t;u++)r[u]!==!0&&r[u]!==!1&&(e+=Math.pow(r[u]-a,2),n++);return Math.sqrt(e/(n-1))},Formula.STEYX=function(r,t){for(var e=jStat.mean(t),n=jStat.mean(r),a=t.length,u=0,o=0,i=0,l=0;l<a;l++)u+=Math.pow(r[l]-n,2),o+=(t[l]-e)*(r[l]-n),i+=Math.pow(t[l]-e,2);return Math.sqrt((u-o*o/i)/(a-2))},Formula.TDIST=function(r,t,e){return e?jStat.studentt.cdf(r,t):jStat.studentt.pdf(r,t)},Formula.TDIST2T=function(){},Formula.TDISTRT=function(){},Formula.TINV=function(r,t){return jStat.studentt.inv(r,t)},Formula.TINV2T=function(){},Formula.TTEST=function(){},Formula.TREND=function(){},Formula.TRIMMEAN=function(r,t){r=Formula.FLATTEN(r);var e=Formula.FLOOR(r.length*t,2)/2;return jStat.mean(_.initial(_.rest(r.sort(function(r,t){return r-t}),e),e))},Formula.VARA=function(){for(var r=Formula.FLATTEN(arguments),t=r.length,e=0,n=0,a=Formula.AVERAGEA(r),u=0;u<t;u++){var o=r[u];e+="number"==typeof o?Math.pow(o-a,2):o===!0?Math.pow(1-a,2):Math.pow(0-a,2),null!==o&&n++}return e/(n-1)},Formula.VARP=function(){for(var r=Formula.NUMBERS(Formula.FLATTEN(arguments)),t=r.length,e=0,n=0,a=Formula.AVERAGE(r),u=0;u<t;u++)e+=Math.pow(r[u]-a,2),n++;return e/n},Formula.VARPA=function(){for(var r=Formula.FLATTEN(arguments),t=r.length,e=0,n=0,a=Formula.AVERAGEA(r),u=0;u<t;u++){var o=r[u];e+="number"==typeof o?Math.pow(o-a,2):o===!0?Math.pow(1-a,2):Math.pow(0-a,2),null!==o&&n++}return e/n},Formula.VARS=function(){for(var r=Formula.FLATTEN(arguments),t=r.length,e=0,n=0,a=Formula.AVERAGE(r),u=0;u<t;u++)r[u]!==!0&&r[u]!==!1&&(e+=Math.pow(r[u]-a,2),n++);return e/(n-1)},Formula.WEIBULLDIST=function(r,t,e,n){return n?1-Math.exp(-Math.pow(r/e,t)):Math.pow(r,t-1)*Math.exp(-Math.pow(r/e,t))*t/Math.pow(e,t)},Formula.ZTEST=function(r,t,e){var n=r.length,a="undefined"==typeof e?Formula.STDEVS(r):e;return 1-Formula.NORMSDIST((Formula.AVERAGE(r)-t)/(a/Math.sqrt(n)),Formula.TRUE)},Formula.CHAR=function(r){return String.fromCharCode(r)},Formula.CLEAN=function(r){return r.replace(/[\0-\x1F]/g,"")},Formula.CODE=function(r){return r.charCodeAt(0)},Formula.CONCATENATE=function(){for(var r="",t=0;t<arguments.length;t++)null!==arguments[t]&&void 0!==arguments[t]&&(r+=arguments[t]);return r},Formula.DOLLAR=function(r,t){t="undefined"==typeof t?2:t;var e="";return t<=0?(r=Math.round(r*Math.pow(10,t))/Math.pow(10,t),e="($0,0)"):t>0&&(e="($0,0."+new Array(t+1).join("0")+")"),numeral(r).format(e)},Formula.EXACT=function(r,t){return r===t},Formula.FIND=function(r,t,e){return e="undefined"==typeof e?0:e,t?t.indexOf(r,e-1)+1:null},Formula.FIXED=function(r,t,e){t="undefined"==typeof t?2:t,e="undefined"!=typeof e&&e;var n=e?"0":"0,0";return t<=0?r=Math.round(r*Math.pow(10,t))/Math.pow(10,t):t>0&&(n+="."+new Array(t+1).join("0")),numeral(r).format(n)},Formula.HTML2TEXT=function(r){var t="";return r&&(r instanceof Array?r.forEach(function(r){""!==t&&(t+="\n"),t+=r.replace(/<(?:.|\n)*?>/gm,"")}):t=r.replace(/<(?:.|\n)*?>/gm,"")),t},Formula.HUMANIZE=function(r){if(r instanceof Date){var t=moment(r);return t.hours()||t.minutes()||t.seconds()?t.format("dddd, MMMM Do YYYY, h:mm:ss"):t.format("dddd, MMMM Do YYYY")}return r},Formula.JOIN=function(r,t){return r.join(t)},Formula.LEFT=function(r,t){return t="undefined"==typeof t?1:t,r?r.substring(0,t):null},Formula.LEN=function(r){return r?r.length:0},Formula.LOWER=function(r){return r?r.toLowerCase():r},Formula.MID=function(r,t,e){return r.substring(t-1,e)},Formula.NUMBERVALUE=function(r,t,e){return t="undefined"==typeof t?".":t,e="undefined"==typeof e?",":e,Number(r.replace(t,".").replace(e,""))},Formula.NUMBERS=function(){var r=Formula.FLATTEN(arguments);return r.filter(function(r){return"number"==typeof r})},Formula.PROPER=function(r){if(r)return r.replace(/\w\S*/g,function(r){return r.charAt(0).toUpperCase()+r.substr(1).toLowerCase()})},Formula.REGEXEXTRACT=function(r,t){var e=r.match(new RegExp(t));return e?e[e.length>1?e.length-1:0]:null},Formula.REGEXMATCH=function(r,t,e){var n=r.match(new RegExp(t));return e?n:!!n},Formula.REGEXREPLACE=function(r,t,e){return r.replace(new RegExp(t),e)},Formula.REPLACE=function(r,t,e,n){return r.substr(0,t-1)+n+r.substr(t-1+e)},Formula.REPT=function(r,t){return new Array(t+1).join(r)},Formula.RIGHT=function(r,t){return t="undefined"==typeof t?1:t,r?r.substring(r.length-t):null},Formula.ROMAN=function(r){for(var t=String(r).split(""),e=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],n="",a=3;a--;)n=(e[+t.pop()+10*a]||"")+n;return new Array(+t.join("")+1).join("M")+n},Formula.SEARCH=function(r,t,e){return e="undefined"==typeof e?0:e,t.toLowerCase().indexOf(r.toLowerCase(),e-1)+1},Formula.SPLIT=function(r,t){return _s.words(r,t)},Formula.SUBSTITUTE=function(r,t,e,n){if(!(r&&t&&e))return r;if("undefined"==typeof n)return r.replace(new RegExp(t,"g"),e);for(var a=0,u=0;r.indexOf(t,a)>0;)if(a=r.indexOf(t,a+1),u++,u===n)return r.substring(0,a)+e+r.substring(a+t.length)},Formula.T=function(r){return"string"==typeof r?r:null},Formula.TEXT=function(r,t){if(!r)return"";if(r instanceof Object)try{return JSON.stringify(r)}catch(r){return""}return"string"==typeof r?t?t.indexOf("0")>=0?numeral(r).format(t):moment(new Date(r)).format(t):r:r.toString&&"function"==typeof r.toString?r.toString():""},Formula.TRIM=function(r){return _s.clean(r)},Formula.UNICHAR=Formula.CHAR,Formula.UNICODE=Formula.CODE,Formula.UPPER=function(r){return r.toUpperCase()},Formula.VALUE=function(r){return numeral().unformat(r)},Formula.MD5=function(r,t,e){return md5(r,t,e)},Formula.NUMERAL=function(r,t){return numeral(r).format(t)},Formula.ISERR=function(r){return["#DIV/0!","#NAME?","#NUM!","#NULL!","#REF!","#VALUE!"].indexOf(r)>=0},Formula.ISERROR=function(r){return Formula.ISERR(r)||"#N/A"===r},Formula.IFERROR=function(r,t){return Formula.ISERROR(r)?t:r},Formula}"undefined"!=typeof exports?module.exports=exportModule(require("numeric"),require("numeral"),require("jStat"),require("moment"),require("lodash"),require("underscore.string"),require("blueimp-md5")):"function"==typeof define&&define.amd&&define("formula",["numeric","numeral","jStat","moment","lodash","underscore.string","md5"],exportModule)}).call(this);