function Rythm(){function t(){if(!a.stopped){a._analyser.getByteFrequencyData(a._frequences);for(var n=0;n<a._frequences.length;n++){a._hzHistory[n]||(a._hzHistory[n]=[]),a._hzHistory[n].length>a.maxValueHistory&&a._hzHistory[n].shift(),a._hzHistory[n].push(a._frequences[n]);a._frequences[n]}a.rythmMapping.forEach(function(t){switch(t.type){default:i(t.elementClass,e(t.startValue,t.nbValue))}}),requestAnimationFrame(t)}}function e(t,e){for(var i=0,a=t;a<e+t;a++)i+=n(a);return i/e}function n(t){for(var e=255,n=0,i=0;i<a._hzHistory[t].length;i++)a._hzHistory[t][i]<e&&(e=a._hzHistory[t][i]),a._hzHistory[t][i]>n&&(n=a._hzHistory[t][i]);var r=n-e,o=a._frequences[t]-e,s=o/r;return a.startingScale+a.pulseRatio*s}function i(t,e){for(var n=document.getElementsByClassName(t),i=0;i<n.length;i++)n[i].style.transform="scale("+e+")"}var a=this;a._audioCtx=new AudioContext,a._init=function(){a._analyser=a._audioCtx.createAnalyser(),a._gain=a._audioCtx.createGain(),a._source={},a._audio={},a._hzHistory=[],a._analyser.fftSize=2048},a.stopped=!1,a._rythmInputTypeList={TRACK:0,STREAM:1},a.startingScale=.75,a.pulseRatio=.5,a.maxValueHistory=100,a.rythmMapping=[],a.addRythm=function(t,e,n,i){a.rythmMapping.push({elementClass:t,type:e,startValue:n,nbValue:i})},a.addRythm("rythm-bass","size",0,10),a.addRythm("rythm-medium","size",150,40),a.addRythm("rythm-high","size",500,100),a._connectSource=function(t){t.connect(a._gain),a._gain.connect(a._analyser),a._rythmInputType===a._rythmInputTypeList.TRACK&&a._analyser.connect(a._audioCtx.destination)},a.setMusic=function(t){a._init(),a._audio=new Audio(t),a._rythmInputType=a._rythmInputTypeList.TRACK,a._source=a._audioCtx.createMediaElementSource(a._audio),a._connectSource(a._source),a._audio.addEventListener("ended",a.stop)},a.plugMicrophone=function(){return a._init(),a._getMicrophoneStream().then(function(t){a._audio=t,a._rythmInputType=a._rythmInputTypeList.STREAM,a._source=a._audioCtx.createMediaStreamSource(t),a._connectSource(a._source)})},a._getMicrophoneStream=function(){return navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,new Promise(function(t,e){navigator.getUserMedia({audio:!0},function(e){t(e)},function(t){e(t)})})},a.setGain=function(t){a._gain.gain.value=t},a.start=function(){a._hzHistory=[],a._frequences=new Uint8Array(a._analyser.frequencyBinCount),a._rythmInputType===a._rythmInputTypeList.TRACK&&a._audio.play(),a.stopped=!1,t()},a.stop=function(){a._rythmInputType===a._rythmInputTypeList.TRACK?a._audio.pause():a._rythmInputType===a._rythmInputTypeList.STREAM&&(a._audio.getAudioTracks()[0].enabled=!1),a.rythmMapping.forEach(function(t){for(var e=document.getElementsByClassName(t.elementClass),n=0;n<e.length;n++)e[n].style.transform="initial"}),a._init(),a.stopped=!0}}
//# sourceMappingURL=rythm.min.js.map