function Rythm(){function t(){if(!r.stopped){r._analyser.getByteFrequencyData(r._frequences);for(var n=0;n<r._frequences.length;n++){r._hzHistory[n]||(r._hzHistory[n]=[]),r._hzHistory[n].length>r.maxValueHistory&&r._hzHistory[n].shift(),r._hzHistory[n].push(r._frequences[n]);r._frequences[n]}r.rythmMapping.forEach(function(t){switch(t.type){default:i(t.elementClass,e(t.startValue,t.nbValue))}}),requestAnimationFrame(t)}}function e(t,e){for(var i=0,r=t;r<e+t;r++)i+=n(r);return i/e}function n(t){for(var e=255,n=0,i=0;i<r._hzHistory[t].length;i++)r._hzHistory[t][i]<e&&(e=r._hzHistory[t][i]),r._hzHistory[t][i]>n&&(n=r._hzHistory[t][i]);var a=n-e,o=r._frequences[t]-e,u=o/a;return r.startingScale+r.pulseRatio*u}function i(t,e){for(var n=document.getElementsByClassName(t),i=0;i<n.length;i++)n[i].style.transform="scale("+e+")"}var r=this;r._audioCtx=new AudioContext,r._init=function(){r._analyser=r._audioCtx.createAnalyser(),r._gain=r._audioCtx.createGain(),r._source={},r._audio={},r._hzHistory=[],r._analyser.fftSize=2048},r.stopped=!1,r._rythmInputTypeList={TRACK:0,STREAM:1},r.startingScale=.75,r.pulseRatio=.5,r.maxValueHistory=100,r.rythmMapping=[],r.addRythm=function(t,e,n,i){r.rythmMapping.push({elementClass:t,type:e,startValue:n,nbValue:i})},r.addRythm("rythm-bass","size",0,10),r.addRythm("rythm-medium","size",150,40),r.addRythm("rythm-high","size",500,100),r._connectSource=function(t){t.connect(r._gain),r._gain.connect(r._analyser),r._rythmInputType===r._rythmInputTypeList.TRACK&&r._analyser.connect(r._audioCtx.destination)},r.setMusic=function(t){r._init(),r._audio=new Audio(t),r._rythmInputType=r._rythmInputTypeList.TRACK,r._source=r._audioCtx.createMediaElementSource(r._audio),r._connectSource(r._source)},r.plugMicrophone=function(){return r._init(),r._getMicrophoneStream().then(function(t){r._audio=t,r._rythmInputType=r._rythmInputTypeList.STREAM,r._source=r._audioCtx.createMediaStreamSource(t),r._connectSource(r._source)})},r._getMicrophoneStream=function(){return navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,new Promise(function(t,e){navigator.getUserMedia({audio:!0},function(e){t(e)},function(t){e(t)})})},r.setGain=function(t){r._gain.gain.value=t},r.start=function(){r._hzHistory=[],r._frequences=new Uint8Array(r._analyser.frequencyBinCount),r._rythmInputType===r._rythmInputTypeList.TRACK&&r._audio.play(),r.stopped=!1,t()},r.stop=function(){r._rythmInputType===r._rythmInputTypeList.TRACK?r._audio.pause():r._rythmInputType===r._rythmInputTypeList.STREAM&&(r._audio.getAudioTracks()[0].enabled=!1),r._init(),r.stopped=!0}}
//# sourceMappingURL=rythm.min.js.map