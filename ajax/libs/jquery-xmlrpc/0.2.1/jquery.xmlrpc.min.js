(function(j){"use strict";var q=function(){Error.apply(this,arguments)};q.prototype=new Error();q.prototype.type='XML-RPC fault';var c=j.xmlrpc=function(a,b){if(arguments.length==2){b.url=a}else{b=a;a=b.url}b.dataType='xml json';b.type='POST';b.contentType='text/xml';b.converters={'xml json':c.parseDocument};var d=c.document(b.methodName,b.params);var f=new XMLSerializer();b.data=f.serializeToString(d);return j.ajax(b)};c.document=function(d,f){var g=document.implementation.createDocument(null,null,null);var e=function(a){return j(g.createElement(a))};var i=e('methodName').text(d);var h=e('params').append(j.map(f,function(a){var b=e('value').append(c.toXmlRpc(a,e));return e('param').append(b)}));var k=e('methodCall').append(i,h);g.appendChild(k.get(0));return g};var s=function(a){return(a===parseInt(a,10))&&!isNaN(a)};c.toXmlRpc=function(a,b){if(a instanceof r)return a.toXmlRpc(b);var d=j.xmlrpc.types;var f=j.type(a);switch(f){case"undefined":case"null":return d.nil.encode(a,b);case"date":return d['date.iso8601'].encode(a,b);case"object":if(a instanceof ArrayBuffer){return d.base64.encode(a,b)}else{return d.struct.encode(a,b)}break;case"number":if(s(a)){return d['int'].encode(a,b)}else{return d['double'].encode(a,b)}break;case"array":case"boolean":case"string":return d[f].encode(a,b);default:throw new Error("Unknown type",a);}};c.parseDocument=function(a){var b=j(a);var d=b.children('methodresponse');var f;var g=d.find('> fault');if(g.length===0){var e=d.find('> params > param > value > *');var i=e.toArray().map(c.parseNode);return i}else{var h=c.parseNode(g.find('> value > *').get(0));var k=new q(h.faultString);k.msg=k.message=h.faultString;k.type=k.code=h.faultCode;throw k;}};c.parseNode=function(a){if(a===undefined){return null}var b=a.nodeName.toLowerCase();if(b in c.types){return c.types[b].decode(a)}else{throw new Error('Unknown type '+b);}};var r=function(){};j.xmlrpc.types={};c.makeType=function(f,g,e,i){var h;h=function(a){this.value=a};h.prototype=new r();h.prototype.tagName=f;if(g){var k=e,l=i;e=function(a,b){var d=k(a);return b(h.tagName).text(d)};i=function(a){return l(j(a).text(),a)}}h.prototype.toXmlRpc=function(a){return h.encode(this.value,a)};h.tagName=f;h.encode=e;h.decode=i;c.types[f]=h};var m=function(a){return''+Math.floor(a)};var n=function(a,b){return parseInt(a,10)};c.makeType('int',true,m,n),c.makeType('i4',true,m,n),c.makeType('i8',true,m,n),c.makeType('i16',true,m,n),c.makeType('i32',true,m,n),c.makeType('double',true,String,function(a){return parseFloat(a,10)});c.makeType('string',true,String,String);c.makeType('boolean',true,function(a){return a?'1':'0'},function(a){return a=='1'});var o=function(a){return a<10?'0'+a:a};c.makeType('date.iso8601',true,function(a){return[a.getUTCFullYear(),'-',o(a.getUTCMonth()+1),'-',o(a.getUTCDate()),'T',o(a.getUTCHours()),':',o(a.getUTCMinutes()),':',o(a.getUTCSeconds()),'Z'].join('')},function(a){return new Date(a)});c.binary=(function(){var k='=';var l=('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/').split("");var p=l.reduce(function(a,b,d){a[b]=d;return a},{});return{toBase64:function(a){var b=[];var d=new Uint8Array(a);var f=0,g;for(;f>18)%64]);b.push(l[(g>>12)%64]);b.push(l[(g>>6)%64]);b.push(l[(g>>0)%64])}var e=3-((a.byteLength%3)||3);while(e--){b[b.length-e-1]=k}return b.join('')},fromBase64:function(a){var b=a.length;var d=(b/4)*3;if(a.charAt(b-1)==k)d--;if(a.charAt(b-2)==k)d--;var f=new ArrayBuffer(d);var g=new Uint8Array(f);var e=0,i=0,h;for(;e>16)%256;g[i+1]=(h>>8)%256;g[i+2]=(h>>0)%256}return f}}})();c.makeType('base64',true,function(a){return c.binary.toBase64(a)},function(a){return c.binary.fromBase64(a)});c.makeType('nil',false,function(a,b){return b('nil')},function(a){return null});c.makeType('struct',false,function(g,e){var i=e('struct');j.each(g,function(a,b){var d=e('name').text(a);var f=e('value').append(c.toXmlRpc(b,e));i.append(e('member').append(d,f))});return i},function(i){return j(i).find('> member').toArray().reduce(function(a,b){var d=j(b);var f=d.find('> name').text();var g=d.find('> value').children()[0];var e=c.parseNode(g);a[f]=e;return a},{})});c.makeType('array',false,function(d,f){var g=f('array');var e=f('data');j.each(d,function(a,b){e.append(f('value').append(c.toXmlRpc(b,f)))});g.append(e);return g},function(b){return j(b).find('> data > value').toArray().map(function(a){return j(a).children()[0]}).map(c.parseNode)});c.force=function(a,b){return new c.types[a](b)}})(jQuery);