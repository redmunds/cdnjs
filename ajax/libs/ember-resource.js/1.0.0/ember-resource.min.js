function LRUCache(e){this.size=0,this.limit=e,this._keymap={}}LRUCache.prototype.put=function(e,t){var r={key:e,value:t};return this._keymap[e]=r,this.tail?(this.tail.newer=r,r.older=this.tail):this.head=r,this.tail=r,this.size===this.limit?this.shift():void this.size++},LRUCache.prototype.shift=function(){var e=this.head;return e&&(this.head.newer?(this.head=this.head.newer,this.head.older=void 0):this.head=void 0,e.newer=e.older=void 0,delete this._keymap[e.key]),e},LRUCache.prototype.get=function(e,t){var r=this._keymap[e];if(void 0!==r)return r===this.tail?r.value:(r.newer&&(r===this.head&&(this.head=r.newer),r.newer.older=r.older),r.older&&(r.older.newer=r.newer),r.newer=void 0,r.older=this.tail,this.tail&&(this.tail.newer=r),this.tail=r,t?r:r.value)},LRUCache.prototype.find=function(e){return this._keymap[e]},LRUCache.prototype.set=function(e,t){var r,i=this.get(e,!0);return i?(r=i.value,i.value=t):(r=this.put(e,t),r&&(r=r.value)),r},LRUCache.prototype.remove=function(e){var t=this._keymap[e];if(t)return delete this._keymap[t.key],t.newer&&t.older?(t.older.newer=t.newer,t.newer.older=t.older):t.newer?(t.newer.older=void 0,this.head=t.newer):t.older?(t.older.newer=void 0,this.tail=t.older):this.head=this.tail=void 0,this.size--,t.value},LRUCache.prototype.removeAll=function(){this.head=this.tail=void 0,this.size=0,this._keymap={}},"function"==typeof Object.keys?LRUCache.prototype.keys=function(){return Object.keys(this._keymap)}:LRUCache.prototype.keys=function(){var e=[];for(var t in this._keymap)e.push(t);return e},LRUCache.prototype.forEach=function(e,t,r){if(t===!0?(r=!0,t=void 0):"object"!=typeof t&&(t=this),r)for(var i=this.tail;i;)e.call(t,i.key,i.value,this),i=i.older;else for(var i=this.head;i;)e.call(t,i.key,i.value,this),i=i.newer},LRUCache.prototype.toJSON=function(){for(var e=[],t=this.head;t;)e.push({key:t.key.toJSON(),value:t.value.toJSON()}),t=t.newer;return e},LRUCache.prototype.toString=function(){for(var e="",t=this.head;t;)e+=String(t.key)+":"+t.value,(t=t.newer)&&(e+=" < ");return e},"object"==typeof this&&(this.LRUCache=LRUCache),function(){window.Ember=window.Ember||window.SC,window.Ember.Resource=window.Ember.Object.extend({resourcePropertyWillChange:window.Ember.K,resourcePropertyDidChange:window.Ember.K}),window.Ember.Resource.SUPPORT_AUTOFETCH=!0}(),function(e){var t=e.Ember,r={subscribe:t.K,unsubscribe:t.K};t.Resource.PushTransport=r;var i=t.Mixin.create({init:function(){var e=this._super(),r=this,i=this.get("remoteExpiryKey");return this.set("_subscribedForExpiry",!1),i?(t.addListener(this,"didFetch",this,function(){r.subscribeForExpiry()}),e):e},subscribeForExpiry:function(){var e=this.get("remoteExpiryKey"),r=this;e&&(this.get("_subscribedForExpiry")||(t.Resource.PushTransport.subscribe(e,function(e){r.updateExpiry(e)}),this.set("_subscribedForExpiry",!0)))},updateExpiry:function(e){var t=e&&e.updatedAt;t&&this.stale(t)&&(this.set("expiryUpdatedAt",t),this.get("remoteExpiryAutoFetch")?(this.set("isExpired",!0),this.fetch()):this.expire())},stale:function(e){return!this.get("expiryUpdatedAt")||+this.get("expiryUpdatedAt")<+e}});t.Resource.RemoteExpiry=i}(this),function(){Ember.Resource.IdentityMap=function(e){this.cache=new LRUCache(e||Ember.Resource.IdentityMap.DEFAULT_IDENTITY_MAP_LIMIT)},Ember.Resource.IdentityMap.prototype={get:function(){return LRUCache.prototype.get.apply(this.cache,arguments)},put:function(){return LRUCache.prototype.put.apply(this.cache,arguments)},remove:function(){return LRUCache.prototype.remove.apply(this.cache,arguments)},clear:function(){return LRUCache.prototype.removeAll.apply(this.cache,arguments)},size:function(){return this.cache.size},limit:function(){return this.cache.limit}},Ember.Resource.IdentityMap.DEFAULT_IDENTITY_MAP_LIMIT=500}(),function(e){function t(e){return!!(""===e||e&&e!==String&&e.charCodeAt&&e.substr)}function r(e){return e===Object(e)}var i,s,a,c=e.Ember;c.Resource.deepSet=function(e,t,r){if("string"===c.typeOf(t))return void c.Resource.deepSet(e,t.split("."),r);var i=t.shift();if(0===t.length)c.set(e,i,r);else{var s=c.get(e,i);null!==s&&void 0!==s||(s={},c.set(e,i,s)),c.propertyWillChange(s,t),c.Resource.deepSet(s,t,r),c.propertyDidChange(s,t)}},c.Resource.deepMerge=function(e,t){var r,i;for(var s in t)t.hasOwnProperty(s)&&(r=c.get(e,s),i=c.get(t,s),"object"===c.typeOf(i)&&"object"===c.typeOf(r)?(c.propertyWillChange(e,s),c.Resource.deepMerge(r,i),c.propertyDidChange(e,s)):c.set(e,s,i))},c.Resource.AbstractSchemaItem=c.Object.extend({name:c.required(String),fetchable:c.required(Boolean),getValue:c.required(Function),setValue:c.required(Function),dependencies:c.computed("path",function(){var e=["data."+this.get("path")];return c.Resource.SUPPORT_AUTOFETCH&&e.push("isExpired"),e}).cacheable(),data:function(e){return c.get(e,"data")},type:c.computed("theType",function(){var e=this.get("theType");return t(e)&&(e=c.getPath(e),e?this.set("theType",e):e=this.get("theType")),e}).cacheable(),propertyFunction:function(e,t){var r=this.constructor.schema[e];return 2===arguments.length?(this.resourcePropertyWillChange(e,t),r.setValue.call(r,this,t),t=r.getValue.call(r,this),this.resourcePropertyDidChange(e,t)):(t=r.getValue.call(r,this),(void 0===t||c.get(this,"isExpired"))&&r.get("fetchable")&&this.scheduleFetch()),t},property:function(){var e=new c.ComputedProperty(this.propertyFunction);return e.property.apply(e,this.get("dependencies")).cacheable()},toJSON:function(e){}}),c.Resource.AbstractSchemaItem.reopenClass({create:function(e,t){var r=this._super.apply(this);return r.set("name",e),r}}),c.Resource.SchemaItem=c.Resource.AbstractSchemaItem.extend({}),c.Resource.SchemaItem.reopenClass({create:function(e,t){var i=t[e];if(i instanceof c.Resource.AbstractSchemaItem)return i;var s;return i!==Number&&i!==String&&i!==Boolean&&i!==Date&&i!==Object||(i={type:i},t[e]=i),r(i)&&(s=i.type),s?s.isEmberResource||"string"===c.typeOf(s)?c.Resource.HasOneSchemaItem.create(e,t):s.isEmberResourceCollection?c.Resource.HasManySchemaItem.create(e,t):c.Resource.AttributeSchemaItem.create(e,t):void 0}}),c.Resource.AttributeSchemaItem=c.Resource.AbstractSchemaItem.extend({fetchable:!0,theType:Object,path:c.required(String),getValue:function(e){var t,r=this.data(e);return r&&(t=c.getPath(r,this.get("path"))),this.typeCast&&(t=this.typeCast(t)),t},setValue:function(e,t){var r=this.data(e);r&&(this.typeCast&&(t=this.typeCast(t)),null!==t&&void 0!==t&&"function"==c.typeOf(t.toJSON)&&(t=t.toJSON()),c.Resource.deepSet(r,this.get("path"),t))},toJSON:function(e){return c.get(e,this.name)}}),c.Resource.AttributeSchemaItem.reopenClass({create:function(e,t){var r,i=t[e];if(this!==c.Resource.AttributeSchemaItem)return r=this._super.apply(this,arguments),r.set("fetchable","id"!==e),r.set("path",i.path||e),r;switch(i.type){case Number:return c.Resource.NumberAttributeSchemaItem.create(e,t);case String:return c.Resource.StringAttributeSchemaItem.create(e,t);case Boolean:return c.Resource.BooleanAttributeSchemaItem.create(e,t);case Date:return c.Resource.DateAttributeSchemaItem.create(e,t);default:return r=this._super.apply(this,arguments),r.set("fetchable","id"!==e),r.set("path",i.path||e),r}}}),c.Resource.NumberAttributeSchemaItem=c.Resource.AttributeSchemaItem.extend({theType:Number,typeCast:function(e){return isNaN(e)&&(e=void 0),void 0===e||null===e||"number"===c.typeOf(e)?e:Number(e)}}),c.Resource.StringAttributeSchemaItem=c.Resource.AttributeSchemaItem.extend({theType:String,typeCast:function(e){return void 0===e||null===e||"string"===c.typeOf(e)?e:""+e}}),c.Resource.BooleanAttributeSchemaItem=c.Resource.AttributeSchemaItem.extend({theType:Boolean,typeCast:function(e){return void 0===e||null===e||"boolean"===c.typeOf(e)?e:"true"===e}}),c.Resource.DateAttributeSchemaItem=c.Resource.AttributeSchemaItem.extend({theType:Date,typeCast:function(e){return void 0===e||null===e||"date"===c.typeOf(e)?e:new Date(e)},toJSON:function(e){var t=c.get(e,this.name);return t?t.toJSON():t}}),c.Resource.HasOneSchemaItem=c.Resource.AbstractSchemaItem.extend({fetchable:!0}),c.Resource.HasOneSchemaItem.reopenClass({create:function(e,t){var r=t[e];if(this===c.Resource.HasOneSchemaItem)return r.nested?c.Resource.HasOneNestedSchemaItem.create(e,t):c.Resource.HasOneRemoteSchemaItem.create(e,t);var i=this._super.apply(this,arguments);return i.set("theType",r.type),r.parse&&i.set("parse",r.parse),i}}),c.Resource.HasOneNestedSchemaItem=c.Resource.HasOneSchemaItem.extend({getValue:function(e){var t=this.data(e);if(t){var r=this.get("type"),i=c.getPath(t,this.get("path"));return i?(i=(this.get("parse")||r.parse).call(r,c.copy(i)),r.create({},i)):i}},setValue:function(e,t){var r=this.data(e);r&&(t instanceof this.get("type")&&(t=c.get(t,"data")),c.Resource.deepSet(r,this.get("path"),t))},toJSON:function(e){var t=c.get(e,this.name);return t?t.toJSON():t}}),c.Resource.HasOneNestedSchemaItem.reopenClass({create:function(e,t){var r=t[e],i=this._super.apply(this,arguments);i.set("path",r.path||e);var s=e+"_id";return t[s]||(t[s]={type:Number,association:i},t[s]=c.Resource.HasOneNestedIdSchemaItem.create(s,t)),i}}),c.Resource.HasOneNestedIdSchemaItem=c.Resource.AbstractSchemaItem.extend({fetchable:!0,theType:Number,getValue:function(e){return e.getPath(this.get("path"))},setValue:function(e,t){c.set(e,this.getPath("association.name"),{id:t})}}),c.Resource.HasOneNestedIdSchemaItem.reopenClass({create:function(e,t){var r=t[e],i=this._super.apply(this,arguments);return i.set("association",r.association),i.set("path",r.association.get("path")+".id"),i}}),c.Resource.HasOneRemoteSchemaItem=c.Resource.HasOneSchemaItem.extend({getValue:function(e){var t=this.data(e);if(t){var r=c.getPath(t,this.get("path"));return r?this.get("type").create({},{id:r}):void 0}},setValue:function(e,t){var r=this.data(e);if(r){var i=c.get(t||{},"id");c.Resource.deepSet(r,this.get("path"),i)}}}),c.Resource.HasOneRemoteSchemaItem.reopenClass({create:function(e,t){var r=t[e],i=this._super.apply(this,arguments),s=r.path||e+"_id";return i.set("path",s),t[s]||(t[s]=Number,t[s]=c.Resource.SchemaItem.create(s,t)),i}}),c.Resource.HasManySchemaItem=c.Resource.AbstractSchemaItem.extend({itemType:c.computed("theItemType",function(){var e=this.get("theItemType");return t(e)&&(e=c.getPath(e),e?this.set("theItemType",e):e=this.get("theItemType")),e}).cacheable()}),c.Resource.HasManySchemaItem.reopenClass({create:function(e,t){var r=t[e];if(this===c.Resource.HasManySchemaItem)return r.url?c.Resource.HasManyRemoteSchemaItem.create(e,t):r.nested?c.Resource.HasManyNestedSchemaItem.create(e,t):c.Resource.HasManyInArraySchemaItem.create(e,t);var i=this._super.apply(this,arguments);return i.set("theType",r.type),i.set("theItemType",r.itemType),r.parse&&i.set("parse",r.parse),i}}),c.Resource.HasManyRemoteSchemaItem=c.Resource.HasManySchemaItem.extend({fetchable:!1,dependencies:["id","isInitializing"],getValue:function(e){if(!c.get(e,"isInitializing")){var t={type:this.get("itemType")};this.get("parse")&&(t.parse=this.get("parse"));var r=this.url(e);return r?t.url=r:t.content=[],this.get("type").create(t)}},setValue:function(e,t){throw"you can not set a remote has many association"}}),c.Resource.HasManyRemoteSchemaItem.reopenClass({create:function(e,t){var r=t[e],i=this._super.apply(this,arguments);return"function"===c.typeOf(r.url)?i.url=r.url:i.url=function(e){var t=e.get("id");if(t)return r.url.fmt(t)},i}}),c.Resource.HasManyNestedSchemaItem=c.Resource.HasManySchemaItem.extend({fetchable:!0,getValue:function(e){var t=this.data(e);if(t){if(t=c.getPath(t,this.get("path")),void 0===t||null===t)return t;t=c.copy(t);var r={type:this.get("itemType"),content:t};return this.get("parse")&&(r.parse=this.get("parse")),this.get("type").create(r)}},setValue:function(e,t){},toJSON:function(e){var t=c.get(e,this.name);return t?t.toJSON():t}}),c.Resource.HasManyNestedSchemaItem.reopenClass({create:function(e,t){var r=t[e],i=this._super.apply(this,arguments);return i.set("path",r.path||e),i}}),c.Resource.HasManyInArraySchemaItem=c.Resource.HasManySchemaItem.extend({fetchable:!0,getValue:function(e){var t=this.data(e);if(t)return t=c.getPath(t,this.get("path")),void 0===t||null===t?t:this.get("type").create({type:this.get("itemType"),content:t.map(function(e){return{id:e}})})},setValue:function(e,t){},toJSON:function(e){var t=c.get(e,this.name);return t?t.mapProperty("id"):t}}),c.Resource.HasManyInArraySchemaItem.reopenClass({create:function(e,t){var r=t[e],i=this._super.apply(this,arguments);return i.set("path",r.path||e+"_ids"),i}});var n=function(e,t){return function(){var r=Array.prototype.slice.call(arguments,0);r.push(t),e.apply(t,r)}};c.Resource.ajax=function(e){return e.dataType=e.dataType||"json",e.type=e.type||"GET",e.error?e.error=n(e.error,e):c.Resource.errorHandler&&(e.error=n(c.Resource.errorHandler,e)),$.ajax(e)},c.Resource.Lifecycle={INITIALIZING:0,UNFETCHED:10,EXPIRING:20,EXPIRED:30,FETCHING:40,FETCHED:50,SAVING:60,DESTROYING:70,DESTROYED:80,clock:c.Object.create({now:new Date,tick:function(){c.Resource.Lifecycle.clock.set("now",new Date)},start:function(){this.stop(),c.Resource.Lifecycle.clock.set("timer",setInterval(c.Resource.Lifecycle.clock.tick,1e4))},stop:function(){var e=c.Resource.Lifecycle.clock.get("timer");e&&clearInterval(e)}}),classMixin:c.Mixin.create({create:function(e,t){e=e||{},e.resourceState=c.Resource.Lifecycle.INITIALIZING;var r=this._super.apply(this,arguments);return c.get(r,"resourceState")===c.Resource.Lifecycle.INITIALIZING&&c.set(r,"resourceState",c.Resource.Lifecycle.UNFETCHED),r}}),prototypeMixin:c.Mixin.create({expireIn:300,resourceState:0,autoFetch:!0,init:function(){this._super.apply(this,arguments);var e=this;c.Resource.SUPPORT_AUTOFETCH||this.set("autoFetch",!1);var t=function(){var t=new Date;t.setSeconds(t.getSeconds()+c.get(e,"expireIn")),c.set(e,"expireAt",t)};c.addListener(this,"willFetch",this,function(){c.set(e,"resourceState",c.Resource.Lifecycle.FETCHING),t()}),c.addListener(this,"didFetch",this,function(){c.set(e,"resourceState",c.Resource.Lifecycle.FETCHED),t()}),c.addListener(this,"didFail",this,function(){c.set(e,"resourceState",c.Resource.Lifecycle.UNFETCHED),t()});var r;c.addListener(this,"willSave",this,function(){r=c.get(e,"resourceState"),c.set(e,"resourceState",c.Resource.Lifecycle.SAVING)}),c.addListener(this,"didSave",this,function(){c.set(e,"resourceState",r||c.Resource.Lifecycle.UNFETCHED)})},isFetchable:c.computed("resourceState",function(){var e=c.get(this,"resourceState");return e==c.Resource.Lifecycle.UNFETCHED||e===c.Resource.Lifecycle.EXPIRED}).cacheable(),isAutoFetchable:c.computed("isFetchable","autoFetch",function(){return this.get("isFetchable")&&this.get("autoFetch")}).cacheable(),isInitializing:c.computed("resourceState",function(){return(c.get(this,"resourceState")||c.Resource.Lifecycle.INITIALIZING)===c.Resource.Lifecycle.INITIALIZING}).cacheable(),isFetching:c.computed("resourceState",function(){return c.get(this,"resourceState")===c.Resource.Lifecycle.FETCHING}).cacheable(),isFetched:c.computed("resourceState",function(){return c.get(this,"resourceState")===c.Resource.Lifecycle.FETCHED}).cacheable(),isSavable:c.computed("resourceState",function(){var e=c.get(this,"resourceState"),t=[c.Resource.Lifecycle.INITIALIZING,c.Resource.Lifecycle.FETCHING,c.Resource.Lifecycle.SAVING,c.Resource.Lifecycle.DESTROYING];return e&&!t.contains(e)}).cacheable(),isSaving:c.computed("resourceState",function(){return c.get(this,"resourceState")===c.Resource.Lifecycle.SAVING}).cacheable(),scheduleFetch:function(){c.get(this,"isAutoFetchable")&&c.run.next(this,this.fetch)},expire:function(){c.run.next(this,function(){c.set(this,"expireAt",new Date),c.Resource.Lifecycle.clock.tick()})},updateIsExpired:c.observer(function(){var e=c.get(this,"resourceState")===c.Resource.Lifecycle.EXPIRED;if(e)return!0;var t=c.get(this,"expireAt");if(t){var r=c.Resource.Lifecycle.clock.get("now");e=t.getTime()<=r.getTime()}var i=c.get(this,"isExpired");(e&&!i||e===!1&&i)&&c.set(this,"isExpired",e)},"Ember.Resource.Lifecycle.clock.now","expireAt","resourceState"),isExpired:c.computed(function(e,t){return t&&c.set(this,"resourceState",c.Resource.Lifecycle.EXPIRED),t}).cacheable()})},c.Resource.Lifecycle.clock.start(),c.Resource.reopen({isEmberResource:!0,updateWithApiData:function(e){var t=c.get(this,"data");c.beginPropertyChanges(t),c.Resource.deepMerge(t,this.constructor.parse(e)),c.endPropertyChanges(t)},willFetch:function(){},didFetch:function(){},willSave:function(){},didSave:function(){},didFail:function(){},fetched:function(){return this._fetchDfd||(this._fetchDfd=$.Deferred()),this._fetchDfd},fetch:function(e){var t;if(!c.get(this,"isFetchable"))return $.when();var r=this.resourceURL();if(r){var i=this;return this.deferedFetch&&!c.get(this,"isExpired")?this.deferedFetch:(i.willFetch.call(i),c.sendEvent(i,"willFetch"),e=$.extend({},e,{url:r,resource:this,operation:"read"}),t=this.constructor.sideloads,t&&0!==t.length&&(e.data={include:t.join(",")}),this.deferedFetch=c.Resource.ajax(e).done(function(e){i.updateWithApiData(e)}),this.deferedFetch.fail(function(){i.didFail.call(i),c.sendEvent(i,"didFail"),i.fetched().reject()}),this.deferedFetch.done(function(){i.didFetch.call(i),c.sendEvent(i,"didFetch"),i.fetched().resolve()}),this.deferedFetch.always(function(){i.deferedFetch=null}),this.deferedFetch)}},resourceURL:function(){return this.constructor.resourceURL(this)},toJSON:function(){var e,t,r,i={};for(var s in this.constructor.schema)this.constructor.schema.hasOwnProperty(s)&&(e=this.constructor.schema[s],e instanceof c.Resource.AbstractSchemaItem&&(t=e.get("path"),r=e.toJSON(this),void 0!==r&&c.Resource.deepSet(i,t,r)));return i},isNew:c.computed("id",function(){return!c.get(this,"id")}).cacheable(),save:function(e){if(e=e||{},!c.get(this,"isSavable"))return!1;var t={contentType:"application/json",data:JSON.stringify(this.toJSON()),resource:this};c.get(this,"isNew")?(t.type="POST",t.url=this.constructor.resourceURL(),t.operation="create"):(t.type="PUT",t.url=this.resourceURL(),t.operation="update");var r=this;r.willSave.call(r),c.sendEvent(r,"willSave");var i=c.Resource.ajax(t);return i.done(function(t,i,s){var a=s.getResponseHeader("Location");if(a){var n=r.constructor.idFromURL(a);n&&c.set(r,"id",n)}e.update!==!1&&"object"===c.typeOf(t)&&r.updateWithApiData(t)}),i.always(function(){r.didSave.call(r),c.sendEvent(r,"didSave")}),i},destroy:function(){this.get("id")&&this.constructor.identityMap.remove(this.get("id")),this._super()},destroyResource:function(){var e=c.get(this,"resourceState"),t=this;return c.set(this,"resourceState",c.Resource.Lifecycle.DESTROYING),c.Resource.ajax({type:"DELETE",operation:"destroy",url:this.resourceURL(),resource:this}).done(function(){c.set(t,"resourceState",c.Resource.Lifecycle.DESTROYED),t.destroy()}).fail(function(){c.set(t,"resourceState",e)})}},c.Resource.Lifecycle.prototypeMixin),i=function(e){for(var t in e)e.hasOwnProperty(t)&&(e[t]=c.Resource.SchemaItem.create(t,e));return e},a=function(e,t){var r=c.copy(t||{});for(var i in e)if(e.hasOwnProperty(i)){if(r.hasOwnProperty(i))throw"Schema item '"+i+"' is already defined";r[i]=e[i]}return r},s=function(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r].property());return t},c.Resource.reopenClass({isEmberResource:!0,schema:{},baseClass:function(){return this===c.Resource?null:this.baseResourceClass||this},subclassFor:function(e,t){return this},create:function(e,t){t=t||{},e=e||{};var r=this.subclassFor(e,t),i=e.id;if(r===this){var s;this.identityMap=this.identityMap||new c.Resource.IdentityMap(this.identityMapLimit);var a=t.id||e.id;a&&!e.skipIdentityMap?(a=a.toString(),s=this.identityMap.get(a),s?(s.updateWithApiData(t),delete e.resourceState,delete e.id):(s=this._super.call(this,{data:t}),this.identityMap.put(a,s))):s=this._super.call(this,{data:t}),delete e.data,c.beginPropertyChanges(s);var n={},o=!1;for(var u in e)e.hasOwnProperty(u)&&(this.schema[u]?s.set(u,e[u]):(n[u]=e[u],o=!0));return o&&s.reopen(n),c.endPropertyChanges(s),e.id=i,s}return r.create(e,t)},parse:function(e){return e},define:function(e){e=e||{};var t=i(e.schema);t=a(t,this.schema);var r=this.extend(s(t),c.Resource.RemoteExpiry),n={schema:t};return this!==c.Resource&&(n.baseResourceClass=this.baseClass()||this),e.url&&(n.url=e.url),e.parse&&(n.parse=e.parse),e.identityMapLimit&&(n.identityMapLimit=e.identityMapLimit),e.sideloads&&(n.sideloads=e.sideloads),r.reopenClass(n),r},resourceURL:function(e){if("function"==c.typeOf(this.url))return this.url(e);if(this.url){if(!e)return this.url;var t=c.get(e,"id");if(!t)return this.url;if(t&&("number"!==c.typeOf(t)||t>0))return this.url+"/"+t}},idFromURL:function(e){var t;if(this.schema.id){t=this.schema.id.get("type")===Number?/\/(\d+)(\.\w+)?$/:/\/([^\/\.]+)(\.\w+)?$/;var r=(e||"").match(t);return r?r[1]:void 0}}},c.Resource.Lifecycle.classMixin),c.ResourceCollection=c.ArrayProxy.extend(c.Resource.RemoteExpiry,{isEmberResourceCollection:!0,type:c.required(),fetched:function(){return this._fetchDfd||(this._fetchDfd=$.Deferred()),this._fetchDfd},fetch:function(e){if(!c.get(this,"isFetchable")||c.get(this,"prePopulated"))return $.when();var t=this;return this.deferedFetch&&!c.get(this,"isExpired")?this.deferedFetch:(c.sendEvent(t,"willFetch"),this.deferedFetch=this._fetch(function(e){c.set(t,"content",t.parse(e))},e),this.deferedFetch.always(function(){c.sendEvent(t,"didFetch"),t.fetched().resolve(),t.deferredFetch=null}),this.deferedFetch)},_resolveType:function(){if(t(this.type)){var e=c.getPath(this.type);e&&(this.type=e)}},_fetch:function(e,t){return this._resolveType(),t=$.extend({},t,{url:this.resolveUrl(),resource:this,operation:"read",success:e}),c.Resource.ajax(t)},resolveUrl:function(){return this.get("url")||this.type.resourceURL()},instantiateItems:function(e){return this._resolveType(),e.map(function(e){return e instanceof this.type?e:this.type.create({},e)},this)},parse:function(e){return this._resolveType(),"function"==c.typeOf(this.type.parse)?e.map(this.type.parse):e},length:c.computed("content.length","resourceState","isExpired",function(){var e=c.get(this,"content"),t=e?c.get(e,"length"):0;return(0===t||c.get(this,"isExpired"))&&this.scheduleFetch(),t}).cacheable(),content:c.computed(function(e,t){if(2===arguments.length)return this.instantiateItems(t)}).cacheable(),autoFetchOnExpiry:c.observer(function(){c.get(this,"isAutoFetchable")&&c.get(this,"isExpired")&&c.get(this,"hasArrayObservers")&&this.fetch()},"isExpired","hasArrayObservers"),toJSON:function(){return this.map(function(e){return e.toJSON()})}},c.Resource.Lifecycle.prototypeMixin),c.ResourceCollection.reopenClass({isEmberResourceCollection:!0,identityMapLimit:5*c.Resource.IdentityMap.DEFAULT_IDENTITY_MAP_LIMIT,create:function(e){e=e||{};var t=e.content;delete e.content,e.prePopulated=!!t;var r;if(!e.prePopulated&&e.url){this.identityMap=this.identityMap||new c.Resource.IdentityMap(this.identityMapLimit);var i=[e.type,e.url];r=this.identityMap.get(i)||this._super.call(this,e),this.identityMap.put(i,r)}return r||(r=this._super.call(this,e),t&&c.set(r,"content",r.parse(t))),r}},c.Resource.Lifecycle.classMixin)}(this);