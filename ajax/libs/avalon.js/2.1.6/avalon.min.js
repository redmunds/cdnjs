!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.avalon=t():e.avalon=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var a=n[r]={exports:{},id:r,loaded:!1};return e[r].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){var r=n(1);n(9),n(16),n(21),n(37),n(67),n(78),e.exports=r},function(e,t,n){n(2),n(3),n(5),n(6),e.exports=n(8)},function(e,t){function n(e){return/\[native code\]/.test(e)}function r(e,t,n){var r="for(var "+e+"i=0,n = this.length; i < n; i++){"+t.replace("_","((i in this) && fn.call(scope,this[i],i,this))")+"}"+n;return Function("fn,scope",r)}var a=Object.prototype.hasOwnProperty;if(!n("司徒正美".trim)){var o=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;String.prototype.trim=function(){return this.replace(o,"")}}var i=!{toString:null}.propertyIsEnumerable("toString"),l=function(){}.propertyIsEnumerable("prototype"),s=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],c=s.length;n(Object.keys)||(Object.keys=function(e){var t=[],n=l&&"function"==typeof e;if("string"==typeof e||e&&e.callee)for(var r=0;r<e.length;++r)t.push(String(r));else for(var o in e)n&&"prototype"===o||!a.call(e,o)||t.push(String(o));if(i)for(var u=e.constructor,d=u&&u.prototype===e,f=0;f<c;f++){var v=s[f];d&&"constructor"===v||!a.call(e,v)||t.push(v)}return t}),n(Array.isArray)||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),n(n.bind)||(Function.prototype.bind=function(e){if(arguments.length<2&&void 0===e)return this;var t=this,n=arguments;return function(){var r,a=[];for(r=1;r<n.length;r++)a.push(n[r]);for(r=0;r<arguments.length;r++)a.push(arguments[r]);return t.apply(e,a)}});var u=Array.prototype,d=u.slice;try{d.call(document.documentElement)}catch(e){u.slice=function(e,t){if(t="undefined"!=typeof t?t:this.length,Array.isArray(this))return d.call(this,e,t);var n,r,a=[],o=this.length,i=e||0;i=i>=0?i:o+i;var l=t?t:o;if(t<0&&(l=o+t),r=l-i,r>0)if(a=new Array(r),this.charAt)for(n=0;n<r;n++)a[n]=this.charAt(i+n);else for(n=0;n<r;n++)a[n]=this[i+n];return a}}if(!n(u.map)){var f={indexOf:function(e,t){var n=this.length,r=~~t;for(r<0&&(r+=n);r<n;r++)if(this[r]===e)return r;return-1},lastIndexOf:function(e,t){var n=this.length,r=null==t?n-1:t;for(r<0&&(r=Math.max(0,n+r));r>=0;r--)if(this[r]===e)return r;return-1},forEach:r("","_",""),filter:r("r=[],j=0,","if(_)r[j++]=this[i]","return r"),map:r("r=[],","r[i]=_","return r"),some:r("","if(_)return true","return false"),every:r("","if(!_)return false","return true")};for(var v in f)u[v]=f[v]}e.exports={}},function(e,t,n){var r=n(4),a=Function(" return this")()||this,o={window:a,document:{createElement:Object,createElementNS:Object,contains:Boolean},root:{outerHTML:"x"},msie:NaN,browser:!1,modern:!0,avalonDiv:{},avalonFragment:null};if(a.avalon=r,a.location&&a.navigator&&a.window){var i=a.document;o.browser=!0,o.document=i,o.root=i.documentElement,o.avalonDiv=i.createElement("div"),o.avalonFragment=i.createDocumentFragment(),a.VBArray?(o.msie=i.documentMode||(a.XMLHttpRequest?7:6),o.modern=o.msie>8):o.modern=!0}r.shadowCopy(r,o)},function(e,t){function n(e){return new n.init(e)}n.init=function(e){this[0]=this.element=e},n.fn=n.prototype=n.init.prototype,n.shadowCopy=function(e,t){for(var n in t)e[n]=t[n];return e};var r=/[^, ]+/g,a="object"==typeof console;n.shadowCopy(n,{noop:function(){},version:"2.115",rword:r,inspect:{}.toString,ohasOwn:{}.hasOwnProperty,log:function(){a&&n.config.debug&&Function.apply.call(console.log,console,arguments)},warn:function(){if(a&&n.config.debug){var e=console.warn||console.log;Function.apply.call(e,console,arguments)}},error:function(e,t){throw(t||Error)(e)},oneObject:function(e,t){"string"==typeof e&&(e=e.match(r)||[]);for(var n={},a=void 0!==t?t:1,o=0,i=e.length;o<i;o++)n[e[o]]=a;return n}}),e.exports=n},function(e,t,n){function r(e){return!!e&&(e==e.document&&e.document!=e)}function a(e){return f.test(c.call(e))}function o(e,t){if(!e||"object"!==s.type(e)||e.nodeType||s.isWindow(e))return!1;try{if(e.constructor&&!m.call(e,"constructor")&&!m.call(e.constructor.prototype||{},"isPrototypeOf"))return!1}catch(e){return!1}if(p)for(t in e)return m.call(e,t);for(t in e);return void 0===t||m.call(e,t)}function i(e){return"[object Object]"===c.call(e)&&Object.getPrototypeOf(e)===Object.prototype}function l(e){if(!e)return!1;var t=e.length;if(t===t>>>0){var n=c.call(e).slice(8,-1);if(h.test(n))return!1;if("Array"===n)return!0;try{return{}.propertyIsEnumerable.call(e,"length")!==!1||d.test(e.item||e.callee)}catch(t){return!e.window}}return!1}var s=n(4);s.quote="undefined"!=typeof JSON?JSON.stringify:new function(){var e={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},t="000000",n=function(e,n){return(t+(n||0)).slice(-e)},r="\\u00",a=function(t){var a=t.charCodeAt(0),o=e[a];return o?o:r+n(2,a.toString(16))},o=/[\x00-\x1f\x22\x5c]/g;return function(e){return o.lastIndex=0,'"'+(o.test(e)?String(e).replace(o,a):e)+'"'}};var c=s.inspect,u={};"Boolean Number String Function Array Date RegExp Object Error".replace(s.rword,function(e){u["[object "+e+"]"]=e.toLowerCase()}),s.type=function(e){return null==e?String(e):"object"==typeof e||"function"==typeof e?u[c.call(e)]||"object":typeof e};var d=/^\s*\bfunction\b/;s.isFunction="object"==typeof alert?function(e){try{return d.test(e+"")}catch(e){return!1}}:function(e){return"[object Function]"===c.call(e)};var f=/^\[object (?:Window|DOMWindow|global)\]$/;s.isWindow=a(s.window)?a:r;var v,p;for(v in s({}))break;var m=s.ohasOwn;p="0"!==v,s.isPlainObject=/\[native code\]/.test(Object.getPrototypeOf)?i:o,s.mix=s.fn.mix=function(){var e,t,n,r,a,o,i=arguments[0]||{},l=1,c=arguments.length,u=!1;for("boolean"==typeof i&&(u=i,i=arguments[1]||{},l++),"object"==typeof i||s.isFunction(i)||(i={}),l===c&&(i=this,l--);l<c;l++)if(null!=(e=arguments[l]))for(t in e){try{n=i[t],r=e[t]}catch(e){continue}i!==r&&(u&&r&&(s.isPlainObject(r)||(a=Array.isArray(r)))?(a?(a=!1,o=n&&Array.isArray(n)?n:[]):o=n&&s.isPlainObject(n)?n:{},i[t]=s.mix(u,o,r)):void 0!==r&&(i[t]=r))}return i};var h=/(Array|List|Collection|Map|Arguments)\]$/;s.each=function(e,t){if(e){var n=0;if(l(e))for(var r=e.length;n<r&&t(n,e[n])!==!1;n++);else for(n in e)if(e.hasOwnProperty(n)&&t(n,e[n])===!1)break}},new function(){var e=["%cavalon.js %c"+s.version+" %cin debug mode, %cmore...","color: rgb(114, 157, 52); font-weight: normal;","color: rgb(85, 85, 85); font-weight: normal;","color: rgb(85, 85, 85); font-weight: normal;","color: rgb(82, 140, 224); font-weight: normal; text-decoration: underline;"],t="You're running avalon in debug mode - messages will be printed to the console to help you fix problems and optimise your application.\n\nTo disable debug mode, add this line at the start of your app:\n\n  avalon.config({debug: false});\n\nDebug mode also automatically shut down amicably when your app is minified.\n\nGet help and support:\n  https://segmentfault.com/t/avalon\n  http://avalonjs.coding.me/\n  http://www.avalon.org.cn/\n\nFound a bug? Raise an issue:\n  https://github.com/RubyLouvre/avalon/issues\n\n";if("object"==typeof console){var n=console,r=n.groupCollapsed||n.log;Function.apply.call(r,n,e),n.log(t),r!==console.log&&n.groupEnd(e)}},e.exports={avalon:s,isArrayLike:l}},function(e,t,n){function r(e,t,n){e[n.name]=a.parseExpr(n)}var a=n(4),o={},i=/([a-z\d])([A-Z]+)/g,l=/[-_][^-_]/g,s=/\d\.\d{4}/,c=/[-.*+?^${}()|[\]\/\\]/g,u=n(7),d=[].slice,f=/&[a-z0-9#]{2,10};/,v=a.avalonDiv;a.shadowCopy(a,{caches:{},vmodels:{},filters:{},components:{},directives:{},eventHooks:{},eventListeners:{},validators:{},scopes:{},evaluatorPool:new u(888),_decode:function(e){return f.test(e)?(v.innerHTML=e,v.innerText||v.textContent):e},cssHooks:o,parsers:{number:function(e){return""===e?"":parseFloat(e)||0},string:function(e){return null===e||void 0===e?"":e+""},boolean:function(e){return""===e?e:"true"===e||"1"==e}},slice:function(e,t,n){return d.call(e,t,n)},css:function(e,t,n,r){if(e instanceof a&&(e=e[0]),1===e.nodeType){var i=a.camelize(t);if(t=a.cssName(i)||i,void 0===n||"boolean"==typeof n){r=o[i+":get"]||o["@:get"],"background"===t&&(t="backgroundColor");var l=r(e,t);return n===!0?parseFloat(l)||0:l}if(""===n)e.style[t]="";else{if(null==n||n!==n)return;isFinite(n)&&!a.cssNumber[i]&&(n+="px"),r=o[i+":set"]||o["@:set"],r(e,t,n)}}},directive:function(e,t){return t.parse=t.parse||r,this.directives[e]=t},isObject:function(e){return null!==e&&"object"==typeof e},range:function(e,t,n){n||(n=1),null==t&&(t=e||0,e=0);for(var r=-1,a=Math.max(0,Math.ceil((t-e)/n)),o=new Array(a);++r<a;)o[r]=e,e+=n;return o},hyphen:function(e){return e.replace(i,"$1-$2").toLowerCase()},camelize:function(e){return!e||e.indexOf("-")<0&&e.indexOf("_")<0?e:e.replace(l,function(e){return e.charAt(1).toUpperCase()})},makeHashCode:function(e){return e=e||"avalon",String(Math.random()+Math.random()).replace(s,e)},escapeRegExp:function(e){return(e+"").replace(c,"\\$&")},Array:{merge:function(e,t){e.push.apply(e,t)},ensure:function(e,t){if(e.indexOf(t)===-1)return e.push(t)},removeAt:function(e,t){return!!e.splice(t,1).length},remove:function(e,t){var n=e.indexOf(t);return!!~n&&a.Array.removeAt(e,n)}}});var p=1;e.exports={avalon:a,getLongID:function(e){return e.uuid||(e.uuid=a.makeHashCode("e"))},getShortID:function(e){return e.uuid||(e.uuid="_"+ ++p)}}},function(e,t){function n(e){this.size=0,this.limit=e,this.head=this.tail=void 0,this._keymap={}}var r=n.prototype;r.put=function(e,t){var n={key:e,value:t};return this._keymap[e]=n,this.tail?(this.tail.newer=n,n.older=this.tail):this.head=n,this.tail=n,this.size===this.limit?this.shift():this.size++,t},r.shift=function(){var e=this.head;e&&(this.head=this.head.newer,this.head.older=e.newer=e.older=this._keymap[e.key]=void 0,delete this._keymap[e.key],this.size--)},r.get=function(e){var t=this._keymap[e];if(void 0!==t)return t===this.tail?t.value:(t.newer&&(t===this.head&&(this.head=t.newer),t.newer.older=t.older),t.older&&(t.older.newer=t.newer),t.newer=void 0,t.older=this.tail,this.tail&&(this.tail.newer=t),this.tail=t,t.value)},e.exports=n},function(e,t,n){function r(e){for(var t in e)if(a.ohasOwn.call(e,t)){var n=e[t];"function"==typeof r.plugins[t]?r.plugins[t](n):r[t]=n}return this}var a=n(4);a.config=r;var o={interpolate:function(e){var t=e[0],n=e[1];if(t===n)throw new SyntaxError("openTag!==closeTag");var o=t+"test"+n,i=a.avalonDiv;if(i.innerHTML=o,i.innerHTML!==o&&i.innerHTML.indexOf("&lt;")>-1)throw new SyntaxError("此定界符不合法");i.innerHTML="",r.openTag=t,r.closeTag=n;var l=a.escapeRegExp(t),s=a.escapeRegExp(n);r.rexpr=new RegExp(l+"([\\s\\S]*)"+s)}};r.plugins=o,a.config({interpolate:["{{","}}"],debug:!0}),e.exports=a},function(e,t,n){function r(e){return e}var a=n(4),o=n(10),i=n(11),l=n(12),s=n(13),c=n(14),u=a.filters,d=a.escapeHtml=n(15);a.__format__=function(e){var t=u[e];return t?t:r},a.mix(u,{uppercase:function(e){return String(e).toUpperCase()},lowercase:function(e){return String(e).toLowerCase()},truncate:function(e,t,n){return e?(e=String(e),isNaN(t)&&(t=30),n="string"==typeof n?n:"...",e.length>t?e.slice(0,t-n.length)+n:e):""},camelize:a.camelize,date:l,escape:d,sanitize:i,number:o,currency:function(e,t,n){return(t||"¥")+o(e,isFinite(n)?n:2)}},s,c),e.exports=a},function(e,t){function n(e,t,n,r){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var a=isFinite(+e)?+e:0,o=isFinite(+t)?Math.abs(t):3,i=r||",",l=n||".",s="",c=function(e,t){var n=Math.pow(10,t);return""+(Math.round(e*n)/n).toFixed(t)};return s=(o?c(a,o):""+Math.round(a)).split("."),s[0].length>3&&(s[0]=s[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,i)),(s[1]||"").length<o&&(s[1]=s[1]||"",s[1]+=new Array(o-s[1].length+1).join("0")),s.join(l)}e.exports=n},function(e,t){var n=/<script[^>]*>([\S\s]*?)<\/script\s*>/gim,r=/\s+(on[^=\s]+)(?:=("[^"]*"|'[^']*'|[^\s>]+))?/g,a=/<\w+\b(?:(["'])[^"]*?(\1)|[^>])*>/gi,o={a:/\b(href)\=("javascript[^"]*"|'javascript[^']*')/gi,img:/\b(src)\=("javascript[^"]*"|'javascript[^']*')/gi,form:/\b(action)\=("javascript[^"]*"|'javascript[^']*')/gi};e.exports=function(e){return e.replace(n,"").replace(a,function(e,t){var n=e.toLowerCase().match(/<(\w+)\s/);if(n){var a=o[n[1]];a&&(e=e.replace(a,function(e,t,n){var r=n.charAt(0);return t+"="+r+"javascript:void(0)"+r}))}return e.replace(r," ").replace(/\s+/g," ")})}},function(e,t){function n(e){return parseInt(e,10)||0}function r(e,t,n){var r="";for(e<0&&(r="-",e=-e),e=""+e;e.length<t;)e="0"+e;return n&&(e=e.substr(e.length-t)),r+e}function a(e,t,n,a){return function(o){var i=o["get"+e]();return(n>0||i>-n)&&(i+=n),0===i&&n===-12&&(i=12),r(i,t,a)}}function o(e,t){return function(n,r){var a=n["get"+e](),o=(t?"SHORT"+e:e).toUpperCase();return r[o][a]}}function i(e){var t=-1*e.getTimezoneOffset(),n=t>=0?"+":"";return n+=r(Math[t>0?"floor":"ceil"](t/60),2)+r(Math.abs(t%60),2)}function l(e,t){return e.getHours()<12?t.AMPMS[0]:t.AMPMS[1]}function s(e,t){var r,a,o=s.locate,i="",l=[];if(t=t||"mediumDate",t=o[t]||t,"string"==typeof e)if(/^\d+$/.test(e))e=n(e);else if(d.test(e))e=+RegExp.$1;else{var f=e.trim(),v=[0,0,0,0,0,0,0],p=new Date(0);f=f.replace(/^(\d+)\D(\d+)\D(\d+)/,function(e,t,r,a){var o=4===a.length?[a,t,r]:[t,r,a];return v[0]=n(o[0]),v[1]=n(o[1])-1,v[2]=n(o[2]),""});var m=p.setFullYear,h=p.setHours;f=f.replace(/[T\s](\d+):(\d+):?(\d+)?\.?(\d)?/,function(e,t,r,a,o){return v[3]=n(t),v[4]=n(r),v[5]=n(a),o&&(v[6]=Math.round(1e3*parseFloat("0."+o))),""});var y=0,g=0;f=f.replace(/Z|([+-])(\d\d):?(\d\d)/,function(e,t,r,a){return m=p.setUTCFullYear,h=p.setUTCHours,t&&(y=n(t+r),g=n(t+a)),""}),v[3]-=y,v[4]-=g,m.apply(p,v.slice(0,3)),h.apply(p,v.slice(3)),e=p}for("number"==typeof e&&(e=new Date(e));t;)a=u.exec(t),a?(l=l.concat(a.slice(1)),t=l.pop()):(l.push(t),t=null);return l.forEach(function(t){r=c[t],i+=r?r(e,o):t.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),i}var c=(Object.prototype.toString,{yyyy:a("FullYear",4),yy:a("FullYear",2,0,!0),y:a("FullYear",1),MMMM:o("Month"),MMM:o("Month",!0),MM:a("Month",2,1),M:a("Month",1,1),dd:a("Date",2),d:a("Date",1),HH:a("Hours",2),H:a("Hours",1),hh:a("Hours",2,-12),h:a("Hours",1,-12),mm:a("Minutes",2),m:a("Minutes",1),ss:a("Seconds",2),s:a("Seconds",1),sss:a("Milliseconds",3),EEEE:o("Day"),EEE:o("Day",!0),a:l,Z:i}),u=/((?:[^yMdHhmsaZE']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z))(.*)/,d=/^\/Date\((\d+)\)\/$/,f={AMPMS:{0:"上午",1:"下午"},DAY:{0:"星期日",1:"星期一",2:"星期二",3:"星期三",4:"星期四",5:"星期五",6:"星期六"},MONTH:{0:"1月",1:"2月",2:"3月",3:"4月",4:"5月",5:"6月",6:"7月",7:"8月",8:"9月",9:"10月",10:"11月",11:"12月"},SHORTDAY:{0:"周日",1:"周一",2:"周二",3:"周三",4:"周四",5:"周五",6:"周六"},fullDate:"y年M月d日EEEE",longDate:"y年M月d日",medium:"yyyy-M-d H:mm:ss",mediumDate:"yyyy-M-d",mediumTime:"H:mm:ss",short:"yy-M-d ah:mm",shortDate:"yy-M-d",shortTime:"ah:mm"};f.SHORTMONTH=f.MONTH,s.locate=f,e.exports=s},function(e,t,n){function r(e,t,n){var r=c.type(e);if("array"!==r&&"object"!==r)throw"orderBy只能处理对象或数组";var a=n&&n<0?-1:1;if("string"==typeof t){var o=t;t=function(e){return e&&e[o]}}e=s(e),e.forEach(function(e){e.order=t(e.value,e.key)}),e.sort(function(e,t){var n=e.order,r=t.order;return Number.isNaN(n)&&Number.isNaN(r)?0:n===r?0:n>r?a:-a});var i="array"===r,u=i?[]:{};return l(u,e,function(e){i?u.push(e.value):u[e.key]=e.value})}function a(e,t){var n=c.type(e);if("array"!==n&&"object"!==n)throw"filterBy只能处理对象或数组";var r=c.slice(arguments,2),a=c.type(t);if("function"===a)var o=t;else{if("string"!==a&&"number"!==a)return e;if(""===t)return e;var i=new RegExp(c.escapeRegExp(t),"i");o=function(e){return i.test(e)}}e=s(e).filter(function(e,t){return!!o.apply(e,[e.value,t].concat(r))});var u="array"===n,d=u?[]:{};return l(d,e,function(e){u?d.push(e.value):d[e.key]=e.value})}function o(e,t,n){if(c.isObject(e)&&!Array.isArray(e)){var r=[];return l(r,t,function(t){r.push(e.hasOwnProperty(t)?e[t]:n?n[t]:"")})}return e}function i(e,t,n){var r=c.type(e);if("array"!==r&&"object"!==r)throw"limitBy只能处理对象或数组";if("number"!=typeof t)return e;if(Number.isNaN(t))return e;"object"===r&&(e=s(e));var a=e.length;t=Math.floor(Math.min(a,t)),n="number"==typeof n?n:0,n<0&&(n=Math.max(0,a+n));for(var o=[],i=n;i<a&&o.length!==t;i++)o.push(e[i]);var u="array"===r;if(u)return o;var d={};return l(d,o,function(e){d[e.key]=e.value})}function l(e,t,n){for(var r=0,a=t.length;r<a;r++)n(t[r]);return e}function s(e){var t=[],n=0;return c.each(e,function(e,r){t[n++]={value:r,key:e}}),t}var c=n(4);Number.isNaN=Number.isNaN||function(e){return e!==e},e.exports={limitBy:i,orderBy:r,selectBy:o,filterBy:a}},function(e,t){var n={stop:function(e){return e.stopPropagation(),e},prevent:function(e){return e.preventDefault(),e}},r={esc:27,tab:9,enter:13,space:32,del:46,up:38,left:37,right:39,down:40};for(var a in r)!function(e,t){n[e]=function(e){return e.which!==t&&(e.$return=!0),e}}(a,r[a]);e.exports=n},function(e,t){function n(e){return null==e?"":String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}e.exports=n},function(e,t,n){var r=n(17),a=n(18),o=n(19),i=n(20);avalon.vdom=avalon.vdomAdaptor=function(e,t){if(!e)return"toHTML"===t?"":document.createDocumentFragment();switch(e.nodeName){case"#text":return r.prototype[t].call(e);case"#comment":return a.prototype[t].call(e);case"#document-fragment":return i.prototype[t].call(e);case void 0:return new i(e)[t]();default:return o.prototype[t].call(e)}};var l={VText:r,VComment:a,VElement:o,VFragment:i};avalon.shadowCopy(avalon.vdom,l),e.exports=l},function(e,t){function n(e){this.nodeName="#text",this.nodeValue=e,this.skipContent=!r.test(e)}var r=avalon.config.rexpr;n.prototype={constructor:n,toDOM:function(){if(this.dom)return this.dom;var e=avalon._decode(this.nodeValue);return this.dom=document.createTextNode(e)},toHTML:function(){return this.nodeValue}},e.exports=n},function(e,t){function n(e){this.nodeName="#comment",this.nodeValue=e}n.prototype={constructor:n,toDOM:function(){return this.dom=document.createComment(this.nodeValue)},toHTML:function(){return"<!--"+this.nodeValue+"-->"}},e.exports=n},function(e,t){function n(e,t,n){this.nodeName=e,this.props=t,this.children=n}function r(e){return e!==!1&&Object(e)!==e}function a(e){document.styleSheets.length<31?document.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)"):document.styleSheets[0].addRule(".rvml","behavior:url(#default#VML)");var t=e.split(":");1===t.length&&t.unshift("v");var n=t[1],r=t[0];return document.namespaces[r]||document.namespaces.add(r,"urn:schemas-microsoft-com:vml"),document.createElement("<"+r+":"+n+' class="rvml">')}function o(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}var i={class:function(e,t){e.className=t},style:function(e,t){e.style.cssText=t},type:function(e,t){try{e.type=t}catch(e){}},for:function(e,t){e.htmlFor=t}},l=avalon.oneObject("circle,defs,ellipse,image,line,path,polygon,polyline,rect,symbol,text,use,g,svg"),s=avalon.oneObject("shape,line,polyline,rect,roundrect,oval,arc,curve,background,image,shapetype,group,fill,stroke,shadow, extrusion, textbox, imagedata, textpath"),c=/^\w+\:\w+/;n.prototype={constructor:n,toDOM:function(){if(this.dom)return this.dom;var e,t=this.nodeName;e=avalon.modern&&l[t]?o(t):avalon.modern||!s[t]&&!c.test(t)?document.createElement(t):a(t);var n=this.props||{},u=n["ms-important"]||n["ms-controller"]||this.wid;if(u){var d=avalon.scopes[u],f=d&&d.vmodel&&d.vmodel.$element;if(f){var v=f.vtree[0];return v.children&&(this.children=v.children),f}}for(var p in n){var m=n[p];r(m)&&(i[p]&&avalon.msie<8?i[p](e,m):e.setAttribute(p,m+""))}var h=this.children||[],y=h[0]?h[0].nodeValue:"";switch(this.nodeName){case"script":e.text=y;break;case"style":"styleSheet"in e?(e.setAttribute("type","text/css"),e.styleSheet.cssText=y):e.innerHTML=y;break;case"xmp":case"noscript":e.innerText=e.textContent=y;break;case"template":e.innerHTML=y;break;default:this.isVoidTag||this.children.forEach(function(t){t&&e.appendChild(avalon.vdom(t,"toDOM"))})}return this.dom=e},toHTML:function(){var e=[],t=this.props||{};for(var n in t){var a=t[n];r(a)&&e.push(n+"="+avalon.quote(t[n]+""))}e=e.length?" "+e.join(" "):"";var o="<"+this.nodeName+e;return this.isVoidTag?o+"/>":(o+=">",this.children&&(o+=this.children.map(function(e){return e?avalon.vdom(e,"toHTML"):""}).join("")),o+"</"+this.nodeName+">")}},e.exports=n},function(e,t){function n(e){this.nodeName="#document-fragment",this.children=e}n.prototype={constructor:n,toDOM:function(){if(this.dom)return this.dom;for(var e,t=document.createDocumentFragment(),n=0;e=this.children[n++];)t.appendChild(avalon.vdom(e,"toDOM"));return this.split=t.lastChild,this.dom=t},toHTML:function(){return this.children.map(function(e){return avalon.vdom(e,"toHTML")}).join("")}},e.exports=n},function(e,t,n){n(22),n(24),n(25),n(28),n(29),n(30),n(31),n(33),e.exports=avalon},function(e,t,n){function r(e,t){try{for(;t=t.parentNode;)if(t===e)return!0;return!1}catch(e){return!1}}var a=n(4),o=n(23);a.cloneNode=function(e){return e.cloneNode(!0)},a.contains=r,a.browser&&(a.msie<10&&(a.cloneNode=o),document.contains||(document.contains=function(e){return r(document,e)}),window.Node&&!document.createTextNode("x").contains&&(Node.prototype.contains=function(e){return!!(16&this.compareDocumentPosition(e))}),window.HTMLElement&&!a.root.outerHTML&&HTMLElement.prototype.__defineGetter__("outerHTML",function(){var e=document.createElement("div");return e.appendChild(this),e.innerHTML}))},function(e,t){function n(e,t){if(1===e.nodeType){var n=e.nodeName.toLowerCase();"object"===n?e.parentNode&&(e.outerHTML=t.outerHTML):"input"===n&&o.test(t.nodeName)?(e.defaultChecked=e.checked=t.checked,e.value!==t.value&&(e.value=t.value)):"option"===n?e.defaultSelected=e.selected=t.defaultSelected:"input"!==n&&"textarea"!==n||(e.defaultValue=t.defaultValue)}}function r(e){return"undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName("*"):"undefined"!=typeof e.querySelectorAll?e.querySelectorAll("*"):[]}function a(e){var t=e.cloneNode(!0),a=r(t),o=r(e);return avalon.each(o,function(e){n(a[e],o[e])}),t}var o=/radio|checkbox/;e.exports=a},function(e,t,n){function r(e){if(!("classList"in e)){e.classList={node:e};for(var t in i)e.classList[t.slice(1)]=i[t]}return e.classList}var a=n(4),o=/\S+/g,i={_toString:function(){var e=this.node,t=e.className,n="string"==typeof t?t:t.baseVal,r=n.match(o);return r?r.join(" "):""},_contains:function(e){return(" "+this+" ").indexOf(" "+e+" ")>-1},_add:function(e){this.contains(e)||this._set(this+" "+e)},_remove:function(e){this._set((" "+this+" ").replace(" "+e+" "," "))},__set:function(e){e=e.trim();var t=this.node;"object"==typeof t.className?t.setAttribute("class",e):t.className=e}};"add,remove".replace(a.rword,function(e){a.fn[e+"Class"]=function(t){var n=this[0]||{};return t&&"string"==typeof t&&1===n.nodeType&&t.replace(o,function(t){r(n)[e](t)}),this}}),a.fn.mix({hasClass:function(e){var t=this[0]||{};return 1===t.nodeType&&r(t).contains(e)},toggleClass:function(e,t){var n="boolean"==typeof t,r=this;return String(e).replace(o,function(e){var a=n?t:!r.hasClass(e);r[a?"addClass":"removeClass"](e)}),this}})},function(e,t,n){function r(e,t){if(e&&1===e.nodeType){t.dynamic["ms-attr"]=1;var n=t["ms-attr"];for(var r in n){var c=n[r];if("href"===r||"src"===r){if(e.hasAttribute||(c=String(c).replace(s,"&")),e[r]=c,window.chrome&&"EMBED"===e.tagName){var u=e.parentNode,d=document.createComment("ms-src");u.replaceChild(d,e),u.replaceChild(e,d)}}else if(0===r.indexOf("data-"))e.setAttribute(r,c);else{var f=o[r]||r;if("boolean"==typeof e[f]&&(e[f]=!!c),c===!1){e.removeAttribute(f);continue}var v=!l.test(e)&&(!(a.modern||!i(e))||r in e.cloneNode(!1));v?e[f]=c+"":e.setAttribute(r,c)}}}}var a=n(4),o=n(26),i=n(27),l=/^\[object SVG\w*Element\]$/,s=/&amp;/g,c=/^[\],:{}\s]*$/,u=/(?:^|:|,)(?:\s*\[)+/g,d=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,f=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g;a.parseJSON="object"==typeof JSON?JSON.parse:function(e){if("string"==typeof e){if(e=e.trim(),e&&c.test(e.replace(d,"@").replace(f,"]").replace(u,"")))return new Function("return "+e)();a.error("Invalid JSON: "+e)}return e},a.fn.attr=function(e,t){return 2===arguments.length?(this[0].setAttribute(e,t),this):this[0].getAttribute(e)},e.exports=r},function(e,t){var n={"accept-charset":"acceptCharset",char:"ch",charoff:"chOff",class:"className",for:"htmlFor","http-equiv":"httpEquiv"},r=["autofocus,autoplay,async,allowTransparency,checked,controls","declare,disabled,defer,defaultChecked,defaultSelected,","isMap,loop,multiple,noHref,noResize,noShade","open,readOnly,selected"].join(",");r.replace(/\w+/g,function(e){n[e.toLowerCase()]=e});var a=["accessKey,bgColor,cellPadding,cellSpacing,codeBase,codeType,colSpan","dateTime,defaultValue,contentEditable,frameBorder,longDesc,maxLength,marginWidth,marginHeight,rowSpan,tabIndex,useMap,vSpace,valueType,vAlign"].join(",");a.replace(/\w+/g,function(e){n[e.toLowerCase()]=e}),e.exports=n},function(e,t){function n(e){var t=e.nodeName;return t.toLowerCase()===t&&e.scopeName&&""===e.outerText}e.exports=n},function(e,t,n){function r(e,t){if(e.offsetWidth<=0){if(g.test(s["@:get"](e,"display"))){var n={node:e};for(var a in y)n[a]=e.style[a],e.style[a]=y[a];t.push(n)}var o=e.parentNode;o&&1===o.nodeType&&r(o,t)}}function a(e){return e.window||e.defaultView||e.parentWindow||!1}var o=n(4),i=o.root,l=o.camelize,s=o.cssHooks,c=["","-webkit-","-o-","-moz-","-ms-"],u={float:o.modern?"cssFloat":"styleFloat"};if(o.cssNumber=o.oneObject("animationIterationCount,columnCount,order,flex,flexGrow,flexShrink,fillOpacity,fontWeight,lineHeight,opacity,orphans,widows,zIndex,zoom"),o.cssName=function(e,t,n){if(u[e])return u[e];t=t||i.style||{};for(var r=0,a=c.length;r<a;r++)if(n=l(c[r]+e),n in t)return u[e]=n;return null},o.fn.css=function(e,t){if(o.isPlainObject(e))for(var n in e)o.css(this,n,e[n]);else var r=o.css(this,e,t);return void 0!==r?r:this},o.fn.position=function(){var e,t,n=this[0],r={top:0,left:0};return n?("fixed"===this.css("position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),"HTML"!==e[0].tagName&&(r=e.offset()),r.top+=o.css(e[0],"borderTopWidth",!0),r.left+=o.css(e[0],"borderLeftWidth",!0),r.top-=e.scrollTop(),r.left-=e.scrollLeft()),{top:t.top-r.top-o.css(n,"marginTop",!0),left:t.left-r.left-o.css(n,"marginLeft",!0)}):r},o.fn.offsetParent=function(){for(var e=this[0].offsetParent;e&&"static"===o.css(e,"position");)e=e.offsetParent;return o(e||i)},s["@:set"]=function(e,t,n){try{e.style[t]=n}catch(e){}},"function"==typeof getComputedStyle)s["@:get"]=function(e,t){if(!e||!e.style)throw new Error("getComputedStyle要求传入一个节点 "+e);var n,r=getComputedStyle(e,null);return r&&(n="filter"===t?r.getPropertyValue(t):r[t],""===n&&(n=e.style[t])),n},s["opacity:get"]=function(e){var t=s["@:get"](e,"opacity");return""===t?"1":t};else{var d=/^-?(?:\d*\.)?\d+(?!px)[^\d\s]+$/i,f=/^(top|right|bottom|left)$/,v=/alpha\([^)]*\)/i,p=8===o.msie,m="DXImageTransform.Microsoft.Alpha",h={thin:p?"1px":"2px",medium:p?"3px":"4px",thick:p?"5px":"6px"};s["@:get"]=function(e,t){var n=e.currentStyle,r=n[t];if(d.test(r)&&!f.test(r)){var a=e.style,o=a.left,i=e.runtimeStyle.left;e.runtimeStyle.left=n.left,a.left="fontSize"===t?"1em":r||0,r=a.pixelLeft+"px",a.left=o,e.runtimeStyle.left=i}return"medium"===r&&(t=t.replace("Width","Style"),"none"===n[t]&&(r="0px")),""===r?"auto":h[r]||r},s["opacity:set"]=function(e,t,n){var r=e.style,a=isFinite(n)&&n<=1?"alpha(opacity="+100*n+")":"",o=r.filter||"";r.zoom=1,r.filter=(v.test(o)?o.replace(v,a):o+" "+a).trim(),r.filter||r.removeAttribute("filter")},s["opacity:get"]=function(e){var t=e.filters.alpha||e.filters[m],n=t&&t.enabled?t.opacity:100;return n/100+""}}"top,left".replace(o.rword,function(e){s[e+":get"]=function(t){var n=s["@:get"](t,e);return/px$/.test(n)?n:o(t).position()[e]+"px"}});var y={position:"absolute",visibility:"hidden",display:"block"},g=/^(none|table(?!-c[ea]).+)/;o.each({Width:"width",Height:"height"},function(e,t){var n="client"+e,a="scroll"+e,i="offset"+e;s[t+":get"]=function(t,n,r){var a=-4;"number"==typeof r&&(a=r),n="Width"===e?["Left","Right"]:["Top","Bottom"];var l=t[i];return 2===a?l+o.css(t,"margin"+n[0],!0)+o.css(t,"margin"+n[1],!0):(a<0&&(l=l-o.css(t,"border"+n[0]+"Width",!0)-o.css(t,"border"+n[1]+"Width",!0)),a===-4&&(l=l-o.css(t,"padding"+n[0],!0)-o.css(t,"padding"+n[1],!0)),l)},s[t+"&get"]=function(e){var n=[];r(e,n);for(var a,o=s[t+":get"](e),i=0;a=n[i++];){e=a.node;for(var l in a)"string"==typeof a[l]&&(e.style[l]=a[l])}return o},o.fn[t]=function(r){var o=this[0];if(0===arguments.length){if(o.setTimeout)return o["inner"+e]||o.document.documentElement[n]||o.document.body[n];if(9===o.nodeType){var l=o.documentElement;return Math.max(o.body[a],l[a],o.body[i],l[i],l[n])}return s[t+"&get"](o)}return this.css(t,r)},o.fn["inner"+e]=function(){return s[t+":get"](this[0],void 0,-2)},o.fn["outer"+e]=function(e){return s[t+":get"](this[0],void 0,e===!0?2:0)}}),o.fn.offset=function(){var e=this[0],t={left:0,top:0};if(!e||!e.tagName||!e.ownerDocument)return t;var n=e.ownerDocument,r=n.body,a=n.documentElement,i=n.defaultView||n.parentWindow;if(!o.contains(a,e))return t;e.getBoundingClientRect&&(t=e.getBoundingClientRect());var l=a.clientTop||r.clientTop,s=a.clientLeft||r.clientLeft,c=Math.max(i.pageYOffset||0,a.scrollTop,r.scrollTop),u=Math.max(i.pageXOffset||0,a.scrollLeft,r.scrollLeft);return{top:t.top+c-l,left:t.left+u-s}},o.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){o.fn[e]=function(n){var r=this[0]||{},l=a(r),s="scrollTop"===e;return arguments.length?void(l?l.scrollTo(s?o(l).scrollLeft():n,s?n:o(l).scrollTop()):r[e]=n):l?t in l?l[t]:i[e]:r[e]}})},function(e,t,n){function r(e){var t=e.tagName.toLowerCase();return"input"===t&&/checkbox|radio/.test(e.type)?"checked":t}var a=n(4),o=/^<option(?:\s+\w+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s>]+))?)*\s+value[\s=]/i,i={"option:get":a.msie?function(e){return o.test(e.outerHTML)?e.value:e.text.trim()}:function(e){return e.value},"select:get":function(e,t){for(var n,r=e.options,a=e.selectedIndex,o=i["option:get"],l="select-one"===e.type||a<0,s=l?null:[],c=l?a+1:r.length,u=a<0?c:l?a:0;u<c;u++)if(n=r[u],(n.selected||u===a)&&!n.disabled&&(!n.parentNode.disabled||"OPTGROUP"!==n.parentNode.tagName)){if(t=o(n),l)return t;s.push(t)}return s},"select:set":function(e,t,n){t=[].concat(t);for(var r,a=i["option:get"],o=0;r=e.options[o++];)(r.selected=t.indexOf(a(r))>-1)&&(n=!0);n||(e.selectedIndex=-1)}};a.fn.val=function(e){var t=this[0];if(t&&1===t.nodeType){var n=0===arguments.length,a=n?":get":":set",o=i[r(t)+a];if(o)var l=o(t,e);else{if(n)return(t.value||"").replace(/\r/g,"");t.value=e}}return n?l:this}},function(e,t,n){var r=n(7),a=n(4),o=/<|&#?\w+;/,i=new r(128),l=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi;a.parseHTML=function(e){var t=a.avalonFragment.cloneNode(!1);if("string"!=typeof e)return t;if(!o.test(e))return document.createTextNode(e);e=e.replace(l,"<$1></$2>").trim();var n=i.get(e);if(n)return a.cloneNode(n);for(var r,s=a.lexer(e),c=0;r=s[c++];)t.appendChild(a.vdom(r,"toDOM"));return e.length<1024&&i.put(e,t),t},a.innerHTML=function(e,t){var n=this.parseHTML(t);this.clearHTML(e).appendChild(n)},a.unescapeHTML=function(e){return String(e).replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")},a.clearHTML=function(e){for(e.textContent="";e.lastChild;)e.removeChild(e.lastChild);return e}},function(e,t,n){function r(e,t,n){var a=e.getAttribute("avalon-events");if(a&&(e.disabled!==!0||"click"!==t)){var o=[],i=m[t]||(m[t]=new RegExp("\\b"+t+"\\:([^,\\s]+)","g"));a.replace(i,function(e,t){return o.push(t),e}),o.length&&n.push({elem:e,uuids:o})}e=e.parentNode;var s=l.gestureEvents||{};e&&e.getAttribute&&(v[t]||s[t])&&r(e,t,n)}function a(e){e=new i(e);var t=e.type,n=e.target,a=[];r(n,t,a);for(var o,s,c,u=0;(c=a[u++])&&!e.cancelBubble;){
var d=e.currentTarget=c.elem;for(o=0;s=c.uuids[o++];){if(y){y=!1;break}var f=l.eventListeners[s];if(f){var v=h.test(s)?c.elem._ms_context_:0;if(v&&v.$hashcode===!1)return l.unbind(n,t,f);var p=f.call(v||n,e,d._ms_local);p===!1&&(e.preventDefault(),e.stopPropagation())}}}}function o(e){var t=c.getAttribute("delegate-events")||"";if(t.indexOf(e)===-1){var n=t.match(l.rword)||[];n.push(e),c.setAttribute("delegate-events",n.join(",")),_(c,e,a,!!g[e])}}function i(e){if(e.originalEvent)return this;for(var t in e)w.test(t)||"function"==typeof e[t]||(this[t]=e[t]);this.target||(this.target=e.srcElement);var n=this.target;if(null==this.which&&0===e.type.indexOf("key"))this.which=null!=e.charCode?e.charCode:e.keyCode;else if(x.test(e.type)&&!("pageX"in this)){var r=n.ownerDocument||s,a="BackCompat"===r.compatMode?r.body:r.documentElement;this.pageX=e.clientX+(a.scrollLeft>>0)-(a.clientLeft>>0),this.pageY=e.clientY+(a.scrollTop>>0)-(a.clientTop>>0),this.wheelDeltaY=this.wheelDelta,this.wheelDeltaX=0}this.timeStamp=new Date-0,this.originalEvent=e}var l=n(4),s=l.document,c=l.root,u=l.window,d=l.modern,f=n(6).getShortID,v=n(32);d||(delete v.change,delete v.select);var p=l.eventHooks;l.bind=function(e,t,n){if(1===e.nodeType){var r=e.getAttribute("avalon-events")||"",i=f(n),c=p[t];"click"===t&&l.modern&&s.ontouchstart&&e.addEventListener("click",l.noop),c&&(t=c.type||t,c.fix&&(n=c.fix(e,n),n.uuid=i));var u=t+":"+i;l.eventListeners[n.uuid]=n,r.indexOf(t+":")===-1&&(v[t]||l.modern&&g[t]?o(t):_(e,t,a));var d=r.split(",");""===d[0]&&d.shift(),d.indexOf(u)===-1&&(d.push(u),e.setAttribute("avalon-events",d.join(",")))}else _(e,t,n);return n},l.unbind=function(e,t,n){if(1===e.nodeType){var r=e.getAttribute("avalon-events")||"";switch(arguments.length){case 1:b(e,t,a),e.removeAttribute("avalon-events");break;case 2:r=r.split(",").filter(function(e){return e.indexOf(t+":")===-1}).join(","),e.setAttribute("avalon-events",r);break;default:var o=t+":"+n.uuid;r=r.split(",").filter(function(e){return e!==o}).join(","),e.setAttribute("avalon-events",r),delete l.eventListeners[n.uuid]}}else b(e,t,n)};var m={},h=/^e/,y=!1,g={focus:!0,blur:!0},_=d?function(e,t,n,r){e.addEventListener(t,n,r)}:function(e,t,n){e.attachEvent("on"+t,n)},b=d?function(e,t,n){e.removeEventListener(t,n)}:function(e,t,n){e.detachEvent("on"+t,n)};l.fireDom=function(e,t,n){if(s.createEvent){var r=s.createEvent("Events");r.initEvent(t,!0,!0,n),l.shadowCopy(r,n),e.dispatchEvent(r)}else c.contains(e)&&(r=s.createEventObject(),l.shadowCopy(r,n),e.fireEvent("on"+t,r))};var x=/^(?:mouse|contextmenu|drag)|click/,w=/^[A-Z_]+$/;if(i.prototype={preventDefault:function(){var e=this.originalEvent||{};e.returnValue=this.returnValue=!1,e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent||{};e.cancelBubble=this.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){y=!0,this.stopPropagation()},toString:function(){return"[object Event]"}},"onmouseenter"in c||l.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){p[e]={type:t,fix:function(t,n){return function(r){var a=r.relatedTarget;if(!a||a!==t&&!(16&t.compareDocumentPosition(a)))return delete r.type,r.type=e,n.apply(this,arguments)}}}}),l.each({AnimationEvent:"animationend",WebKitAnimationEvent:"webkitAnimationEnd"},function(e,t){u[e]&&!p.animationend&&(p.animationend={type:t})}),"oninput"in s.createElement("input")||(p.input={type:"propertychange",fix:function(e,t){return function(e){if("value"===e.propertyName)return e.type="input",t.apply(this,arguments)}}}),void 0===s.onmousewheel){var $=void 0!==s.onwheel?"wheel":"DOMMouseScroll",C="wheel"===$?"deltaY":"detail";p.mousewheel={type:$,fix:function(e,t){return function(n){var r=n[C]>0?-120:120;return n.wheelDelta=~~e._ms_wheel_+r,e._ms_wheel_=n.wheelDeltaY=n.wheelDelta,n.wheelDeltaX=0,Object.defineProperty&&Object.defineProperty(n,"type",{value:"mousewheel"}),t.apply(this,arguments)}}}}l.fn.bind=function(e,t,n){if(this[0])return l.bind(this[0],e,t,n)},l.fn.unbind=function(e,t,n){return this[0]&&l.unbind(this[0],e,t,n),this}},function(e,t){e.exports={click:!0,dblclick:!0,keydown:!0,keypress:!0,keyup:!0,mousedown:!0,mousemove:!0,mouseup:!0,mouseover:!0,mouseout:!0,wheel:!0,mousewheel:!0,input:!0,change:!0,beforeinput:!0,compositionstart:!0,compositionupdate:!0,compositionend:!0,select:!0,cut:!0,copy:!0,paste:!0,beforecut:!0,beforecopy:!0,beforepaste:!0,focusin:!0,focusout:!0,DOMFocusIn:!0,DOMFocusOut:!0,DOMActivate:!0,dragend:!0,datasetchanged:!0}},function(e,t,n){var r,a=n(4),o=n(34),i=a.document,l=[],s=function(e){for(r=!0;e=l.shift();)e(a)};a.ready=function(e){r?e(a):l.push(e)},a.ready(function(){o(i.body)}),new function(){function e(){try{t.doScroll("left"),s()}catch(t){setTimeout(e)}}if(a.browser){var t=a.root;if("complete"===i.readyState)setTimeout(s);else if(i.addEventListener)i.addEventListener("DOMContentLoaded",s);else if(i.attachEvent){i.attachEvent("onreadystatechange",function(){"complete"===i.readyState&&s()});try{var n=null===window.frameElement}catch(e){}t.doScroll&&n&&window.external&&e()}a.bind(window,"load",s)}}},function(e,t,n){function r(e){for(var t,n=0;t=e[n++];)if(1===t.nodeType){var l=a(t),s=avalon.vmodels[l];if(s&&!s.$element){if(s.$element=t,avalon.serverTemplates&&avalon.serverTemplates[l]){var c=avalon.serverTemplates[l],u=avalon.speedUp(avalon.lexer(c)),d=avalon.render(u),f=d(s),v=avalon.vdom(f[0],"toDOM");s.$element=v,v.vtree=f,s.$render=d,t.parentNode.replaceChild(v,t),avalon.diff(f,f);continue}var f=[i(t)],p=new Date;t.vtree=avalon.speedUp(f);var m=new Date;o&&avalon.log("构建虚拟DOM耗时",m-p,"ms"),s.$render=avalon.render(t.vtree),avalon.scopes[s.$id]={vmodel:s,local:{},isTemp:!0};var h=new Date;o&&avalon.log("构建当前vm的$render方法耗时 ",h-m,"ms\n","如果此时间太长,达100ms以上\n","建议将当前ms-controller拆分成多个ms-controller,减少每个vm管辖的区域"),avalon.rerenderStart=h,o=!1,avalon.batch(l)}else l||r(t.childNodes)}}function a(e){return e.getAttribute("ms-controller")||e.getAttribute(":controller")}var o=!0,i=n(35);e.exports=avalon.scan=function(e){return e&&e.nodeType?void r([e]):void avalon.warn("[avalon.scan] first argument must be element , documentFragment, or document")},avalon.scan.dom2vdom=avalon._hydrate=i},function(e,t,n){function r(e){var t={},n=e.nodeName.toLowerCase();if(t.nodeName=n,t.dom=e,"#"===n.charAt(0)){var r=e.nodeValue;/\S/.test(r)&&(t.nodeValue=r)}else{var o=a(e);l[n]&&(t.isVoidTag=!0),t.children=i(e),o&&("selectedIndex"in o&&(e.selectedIndex=o.selectedIndex,delete o.selectedIndex),t.props=o)}return t}function a(e){for(var t=e.attributes,n={},r=0,a=t.length;r<a;r++){var i=t[r];if(i.specified){var l=i.name;":"===l.charAt(0)&&(l=l.replace(c,"ms-")),n[l]=i.value}}s.test(e.nodeName)&&(n.type=e.type);var u=e.style.cssText;return u&&(n.style=u),"select-one"===n.type&&(n.selectedIndex=e.selectedIndex),o(n)?null:n}function o(e){for(var t in e)return!1;return!0}function i(e){var t=[],n=e.firstChild;if(!n)return t;do{var a=n.nextSibling;switch(n.nodeType){case 1:var o=n.getAttributeNode(":for")||n.getAttributeNode("ms-for");if(o){var i=document.createComment("ms-for:"+o.value),l=document.createComment("ms-for-end:");n.removeAttributeNode(o),e&&(e.insertBefore(l,n.nextSibling),e.insertBefore(i,n)),t.push(r(i),r(n),r(l))}else t.push(r(n));break;case 3:if(/\S/.test(n.nodeValue))t.push(r(n));else{var s=n.parentNode;s&&s.removeChild(n)}break;case 8:t.push(r(n))}n=a}while(n);return t}var l=n(36);e.exports=r;var s=/input|textarea|select/i,c=/^\:/},function(e,t){e.exports=avalon.oneObject("area,base,basefont,bgsound,br,col,command,embed,frame,hr,img,input,keygen,link,meta,param,source,track,wbr")},function(e,t,n){n(38),n(40),n(41),n(42),n(43),n(44),n(45),n(46),n(47),n(48),n(49),n(57),n(58),n(59),n(60),n(61),n(65)},function(e,t,n){var r=n(39);avalon.directive("important",{priority:1,parse:function(e,t,n){var r=avalon.quote(n.expr);e.local="{}",e.vmodel="__vmodel__",e[n.name]=1;var a="(function(){ return __vmodel__ = avalon.vmodels["+r+"]})()";t.$prepend=["(function(__vmodel__){","var __i = avalon.scopes["+r+"]","var ok = !__i || __i.vmodel === __vmodel__",'if( !ok ){avalon.log("不进入"+'+r+");return }"].join("\n")+"\n"+a,t.$append="\n})(__vmodel__);"},diff:function(e,t,n){t.dynamic[n]||(t.local=e.local,t.vmodel=e.vmodel,r(t,this.update))},update:function(e,t,n){avalon.directives.controller.update(e,t,n,"important")}})},function(e,t){e.exports=function(e,t,n){if(n)e.afterChange=e.afterChange||[],avalon.Array.ensure(e.afterChange,t);else{var r=e.dom;t(e.dom,e,r&&r.parentNode)}}},function(e,t,n){var r=n(39),a={};avalon.mediatorFactoryCache=function(e,t){var n=avalon.vmodels[t];if(n&&e&&n!==e){var r=e.$hashcode,o=n.$hashcode,i=r+o;if(a[i])return a[i];var l=avalon.mediatorFactory(e,n);return a[i]=l}return e},avalon.directive("controller",{priority:2,parse:function(e,t,n){var r=avalon.quote(n.expr);e.local="__local__",e.vmodel="__vmodel__",e[n.name]=1,t.$prepend="(function(__top__){\nvar __vmodel__ = avalon.mediatorFactoryCache(__top__,"+r+")\n",t.$append="\n})(__vmodel__);"},diff:function(e,t,n){t.dynamic[n]||(t.local=e.local,t.vmodel=e.vmodel,r(t,this.update))},update:function(e,t,n,a){var o=t.vmodel,i=t.local,l=a?"ms-important":"ms-controller";t.dynamic[l]=1;var s=t.props[l],c=avalon.scopes[s];if(!c){var u=avalon.vmodels[s];if(o.$element&&o.$element.vtree[0]===t)var d=o.$render;else d=avalon.render([t],i);o.$render=d,o.$element=e,e.vtree=[t],u!==o&&(u.$render=u.$render||d,u.$element=u.$element||e);var f=a?o:u,c=avalon.scopes[s]={vmodel:o,local:i};r(t,function(){avalon(e).removeClass("ms-controller"),e.setAttribute("wid",s),avalon._disposeComponent(e);var t=f.$events.onReady;t&&(f.$fire("onReady"),delete f.$events.onReady),c.isMount=!0},"afterChange")}}})},function(e,t,n){var r=n(25),a=n(42);avalon.directive("attr",{diff:a.diff,update:r})},function(e,t,n){var r=n(39);avalon.directive("css",{diff:function(e,t,n){var a=e[n],o=t[n];if(Object(a)===a){if(a=a.$model||a,Array.isArray(a)){var i={};a.forEach(function(e){e&&avalon.shadowCopy(i,e)}),a=i}var l=!1;if(t.dynamic[n]&&o){var s={};for(var c in a)a[c]!==o[c]&&(l=!0),s[c]=a[c];for(var c in o)c in s||(l=!0,s[c]="");t[n]=s}else t[n]=a,l=!0;l&&r(t,this.update)}delete e[n]},update:function(e,t){if(e&&1===e.nodeType){var n=avalon(e);t.dynamic["ms-css"]=1;var r=t["ms-css"];for(var a in r)n.css(a,r[a])}}}),e.exports=avalon.directives.css},function(e,t,n){function r(e,t){var n=e.ownerDocument,a=e.nodeName,i="_"+a;if(!r[i]){var l=n.body.appendChild(n.createElement(a));t=avalon.css(l,"display"),n.body.removeChild(l),t===o&&(t="block"),r[i]=t}return r[i]}var a=n(39),o="none";avalon.parseDisplay=r,avalon.directive("visible",{diff:function(e,t,n){var r=!!e[n];t.dynamic[n]&&r===t[n]||(t[n]=r,a(t,this.update))},update:function(e,t){function n(){void 0!==a&&(e.style.display=a)}if(e&&1===e.nodeType){t.dynamic["ms-visible"]=1;var a,i=t["ms-visible"],l=e.style.display;i?(l===o&&(a=t.displayValue,a||(e.style.display="")),""===e.style.display&&avalon(e).css("display")===o&&avalon.contains(e.ownerDocument,e)&&(a=r(e))):l!==o&&(a=o,t.displayValue=l),avalon.applyEffect(e,t,{hook:i?"onEnterDone":"onLeaveDone",cb:n})}}})},function(e,t,n){n(39);avalon.directive("expr",{parse:avalon.noop})},function(e,t,n){var r=n(39);avalon.directive("text",{parse:function(e,t,n){e[n.name]=1,t.children=[],e.children='[{\nnodeName:"#text",\ndynamic:true,\nnodeValue:avalon.parsers.string('+avalon.parseExpr(n)+")}]"},diff:function(e,t){t.children.length||r(t,this.update)},update:function(e,t){if(e&&!t.isVoidTag){for(var n=e;n.firstChild;)n.removeChild(n.firstChild);var e=document.createTextNode("x");n.appendChild(e);var r={nodeType:3,nodeName:"#text",dom:e};t.children.push(r)}}})},function(e,t,n){var r=n(39);avalon.directive("html",{parse:function(e,t,n){t.isVoidTag?e.children="[]":(e[n.name]=avalon.parseExpr(n),e.vmodel="__vmodel__",e.local="__local__")},diff:function(e,t,n){var a=e[n]+"";if(t.dynamic["ms-html"]&&t.render&&a===t[n]){if(t.render){var o=t.render(e.vmodel,e.local);e.children=o}}else{t[n]=a;var i=avalon.speedUp(avalon.lexer(a)),l=avalon.render(i,e.local);t.render=l;var o=l(e.vmodel,e.local);t.children=e.children=o,r(t,this.update)}},update:function(e,t){t.dynamic["ms-html"]=1,avalon.clearHTML(e),e.appendChild(avalon.domize(t.children))}})},function(e,t,n){function r(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t],a=typeof n;if("string"===a||"number"===a||n===!0)e.push(n);else if(Array.isArray(n))e.push(r.apply(null,n));else if("object"===a)for(var o in n)n.hasOwnProperty(o)&&n[o]&&e.push(o)}return e.join(" ")}function a(e){var t=e.target;avalon(t).addClass(t.getAttribute(u[e.type])||"")}function o(e){var t=e.target,n=u[e.type];avalon(t).removeClass(t.getAttribute(n)||""),"change-active"!==n&&avalon(t).removeClass(t.getAttribute("change-active")||"")}function i(e,t){var n=e.getAttribute("old-change-class"),r=t["ms-class"];n!==r&&(avalon(e).removeClass(n).addClass(r),e.setAttribute("old-change-class",r))}var l=n(6).getLongID,s=n(39),c=avalon.directives;avalon.directive("class",{diff:function(e,t,n){var i=n.slice(3),l=e[n],c=t[n]||"",u=t.classEvent||{};"hover"===i?(u.mouseenter=a,u.mouseleave=o):"active"===i&&(t.props.tabindex=e.props.tabindex||-1,u.tabIndex=t.props.tabindex,u.mousedown=a,u.mouseup=o,u.mouseleave=o),t.classEvent=u;var d=r(l);t.dynamic[n]&&c===d||(t[n]=d,t["change-"+i]=d,s(t,this.update,i))},update:function(e,t){if(e&&1===e.nodeType){var n=t.classEvent;if(n){for(var r in n)"tabIndex"===r?e[r]=n[r]:avalon.bind(e,r,n[r]);t.classEvent={}}var a=["class","hover","active"];a.forEach(function(n){var r="change-"+n,a=t[r];if(void 0!==a)if(t.dynamic["ms-"+n]=1,"class"===n)e&&i(e,t);else{var o=e.getAttribute("change-"+n);o&&avalon(e).removeClass(o),e.setAttribute(r,a)}})}}}),c.active=c.hover=c.class;var u={mouseenter:"change-hover",mouseleave:"change-hover",mousedown:"change-active",mouseup:"change-active"};l(a),l(o)},function(e,t,n){function r(e,t){for(var n in e)if(e[n]!==t[n])return!0;return!1}var a=n(7),o=(new a(128),n(39)),i=(n(6).getLongID,/^ms\-on\-(\w+)/);avalon.directive("on",{priority:3e3,parse:function(e,t,n){var r=n.name.replace("ms-on-","e").replace("-","_"),a=r+"_"+n.expr.replace(/\s/g,"").replace(/[^$a-z]/gi,function(e){return e.charCodeAt(0)}),o=avalon.quote(a),i="(function(){\nvar fn610 = "+avalon.parseExpr(n)+"\nfn610.uuid ="+o+";\nreturn fn610})()";e.vmodel="__vmodel__",e.local="__local__",e[n.name]=i},diff:function(e,t,n){var a=e[n],i=a.uuid,l=t[n]||{},s=!1;t.dynamic[n]&&l.uuid===i||(t[n]=a,avalon.eventListeners[i]=a,s=!0),r(t.local||{},e.local)&&(s=!0),s&&(t.local=e.local,t.vmodel=e.vmodel,o(t,this.update))},update:function(e,t){if(e&&1===e.nodeType){var n,r;e._ms_context_=t.vmodel,e._ms_local=t.local;for(n in t){var a=n.match(i);a&&(r=t[n],t.dynamic[n]=1,avalon.bind(e,a[1],r))}}}})},function(e,t,n){function r(e){for(var t,n=0;t=this.parsers[n++];){var r=avalon.parsers[t];r&&(e=r.call(this,e))}return e}var a=n(39),o=n(50),i=/\|\s*change\b/,l=/^(?:checkbox|radio)$/,s=/\|\s*debounce(?:\(([^)]+)\))?/,c=n(51),u=n(54),d=n(52),f=n(55),v=n(56),p="ms-duplex";avalon.directive("duplex",{priority:2e3,parse:function(e,t,n){var r,a=n.expr,c=t.props.type,u=n.param,d=!1;u=u?u.split("-").map(function(e){return"checked"===e&&(d=!0),e}):[],l.test(c)&&d&&(u=[],r="radio"),/input|textarea|select/.test(t.nodeName)?r||(r="select"===t.nodeName?"select":"checkbox"===c?"checkbox":"radio"===c?"radio":"input"):"contenteditable"in t.props&&(r="contenteditable");var f=!1,v=0;if("input"===r||"contenteditable"===r){var m=!0;if(i.test(a)&&(f=!0),!f){var h=a.match(s);h&&(v=parseInt(h[1],10)||300)}}var y=e.props["data-duplex-changed"],g=avalon.parseExpr(n),_=u.map(function(e){return avalon.quote(e)});e[p]=o({type:r,vmodel:"__vmodel__",local:"__local__",debug:avalon.quote(n.name+"="+n.expr),isChecked:d,parsers:"["+_+"]",isString:!!m,isChanged:f,debounceTime:v,get:g,set:avalon.evaluatorPool.get("duplex:set:"+a),callback:y?avalon.parseExpr({expr:y,type:"on"}):"avalon.noop"})},diff:function(e,t){if(t.dynamic[p])n=t[p];else{var n=t[p]=e[p];n.parse=r}e!==t&&(e[p]=null);var o=n.get(n.vmodel),i=n.value;if(n.isString){if(o=n.parse(o),o+="",o===i)return}else if(Array.isArray(o)){var l=!0;if(o+""===n.arrayHack)return}n.value=o,l&&(n.arayHack=o+""),a(t,this.update,"afterChange")},update:function(e,t){if(e&&1===e.nodeType){t.dynamic[p]=1,e.__ms_duplex__||(e.__ms_duplex__=avalon.mix(t[p],{dom:e}),c(e,t),v(e,t));var n=e.__ms_duplex__;if(n.dom=e,n.isString&&!avalon.msie&&u===!1&&!e.valueHijack){e.valueHijack=d;var r=setInterval(function(){avalon.contains(avalon.root,e)?e.valueHijack({type:"poll"}):clearInterval(r)},30)}f[n.type].call(n)}}})},function(e,t){function n(e){return i.test(e)||a[e]?l(e):e}function r(e){var t=[];for(var a in e){var i=typeof e[a];if("object"===i)if("props"===a){var s=[];for(var c in e.props){var u=e.props[c];"string"==typeof u&&(u=l(u)),s.push(n(c)+": "+u)}t.push(a+": {"+s.join(",\n")+"}")}else"children"===a&&t.push("children: ["+e[a].map(function(e){return r(e)})+"]");else if(e.hasOwnProperty(a)){var d=e[a];"string"===i&&(d=o[a]?l(d):d),t.push(n(a)+":"+d)}}return"{\n"+t.join(",\n")+"}"}var a=avalon.oneObject("break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile");avalon.keyMap=a;var o={nodeName:1,template:1,forExpr:1,type:1,nodeValue:1,signature:1,wid:1},i=/[W\:-]/,l=avalon.quote;e.exports=r},function(e,t,n){function r(e,t){var n={},r=t["ms-duplex"];switch(r.update=d,r.type){case"radio":case"checkbox":n.click=d;break;case"select":n.change=d;break;case"contenteditable":r.isChanged?n.blur=d:avalon.modern?(p.webkitURL?n.webkitEditableContentChanged=d:p.MutationEvent&&(n.DOMCharacterDataModified=d),n.input=d):(n.keydown=u,n.paste=o,n.cut=o,n.focus=c,n.blur=s);break;case"input":r.isChanged?n.change=d:(v&&(n.keyup=u),v<9?(n.propertychange=a,n.paste=o,n.cut=o):n.input=d,(!v||v>9)&&(n.compositionstart=s,n.compositionend=c),v||/\[native code\]/.test(p.Int8Array)||(n.keydown=u,n.paste=o,n.cut=o,p.netscape&&(n.DOMAutoComplete=d)))}/password|text/.test(t.props.type)&&(n.focus=i,n.blur=l,r.getCaret=g,r.setCaret=y);for(var f in n)avalon.bind(e,f,n[f])}function a(e){"value"===e.propertyName&&d.call(this,e)}function o(e){var t=this;setTimeout(function(){d.call(t,e)},0)}function i(){this.caret=!0}function l(){this.caret=!1}function s(){this.composing=!0}function c(e){this.composing=!1,o.call(this,e)}function u(e){var t=e.keyCode;91===t||15<t&&t<19||37<=t&&t<=40||d.call(this,e)}var d=n(52),f=n(6).getShortID,v=avalon.msie,p=avalon.window,m=avalon.document;f(i),f(l),f(s),f(c),f(d),f(a),f(o),f(u);var h=function(e){setTimeout(e,0)},y=function(e,t){var n;e.createTextRange?h(function(){e.focus(),n=e.createTextRange(),n.collapse(!0),n.moveEnd("character",t),n.moveStart("character",t),n.select()}):(e.focus(),void 0!==e.selectionStart&&e.setSelectionRange(t,t))},g=function(e){var t,n,r,a,o,i=0;return"number"==typeof e.selectionStart&&"number"==typeof e.selectionEnd?i=e.selectionStart:(n=m.selection.createRange(),n&&n.parentElement()==e&&(a=e.value.length,t=e.value.replace(/\r\n/g,"\n"),r=e.createTextRange(),r.moveToBookmark(n.getBookmark()),o=e.createTextRange(),o.collapse(!1),r.compareEndPoints("StartToEnd",o)>-1?i=a:(i=-r.moveStart("character",-a),i+=t.slice(0,i).split("\n").length-1))),i};e.exports=r},function(e,t,n){function r(e){var t=this,n=this.__ms_duplex__;if(!t.composing&&t.value!==n.value){if(t.caret)try{var r=n.getCaret(t);n.pos=r}catch(e){avalon.warn("fixCaret error",e)}if(n.debounceTime>4){var o=new Date,i=o-n.time||0;n.time=o,i>=n.debounceTime?a[n.type].call(n):(clearTimeout(n.debounceID),n.debounceID=setTimeout(function(){a[n.type].call(n)},i))}else a[n.type].call(n)}}var a=n(53);e.exports=r},function(e,t){function n(e){e.callback&&e.callback.call(e.vmodel,{type:"changed",target:e.dom})}var r={input:function(e){var t=this;e=e||"value";var r=t.dom,a=r[e],o=t.parse(a);t.value=a,t.set(t.vmodel,o),n(t);var i=t.pos;r.caret&&t.setCaret(r,i)},radio:function(){var e=this;if(e.isChecked){var t=!e.value;e.set(e.vmodel,t),n(e)}else r.input.call(e),e.value=NaN},checkbox:function(){var e=this,t=e.value;Array.isArray(t)||(avalon.warn("ms-duplex应用于checkbox上要对应一个数组"),t=[t]);var r=e.dom.checked?"ensure":"remove";if(t[r]){var a=e.parse(e.dom.value);t[r](a),n(e)}},select:function(){var e=this,t=avalon(e.dom).val();t+""!=this.value+""&&(t=Array.isArray(t)?t.map(function(t){return e.parse(t)}):e.parse(t),e.set(e.vmodel,t),n(e))},contenteditable:function(){r.input.call(this,"innerHTML")}};e.exports=r},function(e,t){function n(e){a[this.tagName].call(this,e);var t=this.__ms_duplex__;!this.caret&&t&&t.isString&&t.update.call(this,{type:"setter"})}var r=!1;try{var a={},o=HTMLInputElement.prototype,i=HTMLTextAreaElement.prototype,l=HTMLInputElement.prototype;Object.getOwnPropertyNames(l),a.INPUT=Object.getOwnPropertyDescriptor(o,"value").set,Object.defineProperty(o,"value",{set:n}),a.TEXTAREA=Object.getOwnPropertyDescriptor(i,"value").set,Object.defineProperty(i,"value",{set:n}),r=!0}catch(e){}e.exports=r},function(e,t){var n={input:function(){this.dom.value=this.value},radio:function(){var e;e=this.isChecked?!!this.value:this.value+""===this.dom.value;var t=this.dom;6===avalon.msie?setTimeout(function(){t.defaultChecked=e,t.checked=e},31):t.checked=e},checkbox:function(){for(var e=!1,t=this.dom,n=t.value,r=0;r<this.value.length;r++){var a=this.value[r];a+""===n&&(e=!0)}t.checked=e},select:function(){var e=Array.isArray(this.value)?this.value.map(String):this.value+"";avalon(this.dom).val(e)},contenteditable:function(){this.dom.innerHTML=this.value,this.update.call(this.dom)}};e.exports=n},function(e,t){e.exports=function(e,t){var n=e.__ms_duplex__,r=t["ms-rules"];if(r&&!n.validator)for(;e&&1===e.nodeType;){var a=e._ms_validator_;if(a){n.rules=r,n.validator=a,avalon.Array.ensure(a.fields,n)&&a.addField(n);break}e=e.parentNode}}},function(e,t,n){function r(){var e=this.data||{};return this.message.replace(i,function(t,n){return null==e[n]?"":e[n]})}var a=n(39),o=avalon.directive("validate",{diff:function(e,t,n){var r=e[n],i=t[n];if(!(i&&i.onError&&i.addField)&&Object(r)===r){t.vmValidator=r,r.$id&&(r=r.$model),t[n]=r;for(var n in o.defaults)r.hasOwnProperty(n)||(r[n]=o.defaults[n]);r.fields=r.fields||[],a(t,this.update)}},update:function(e,t){function n(){o.validateAll.call(r,r.onValidateAll)}var r=t["ms-validate"];e._ms_validator_=r,r.dom=e;var a=t.vmValidator;try{a.onManual=n}catch(e){}delete t.vmValidator,e.setAttribute("novalidate","novalidate"),r.validateAllInSubmit&&avalon.bind(e,"submit",function(e){e.preventDefault(),n()}),"function"==typeof r.onInit&&r.onInit.call(e,{type:"init",target:e,validator:r})},validateAll:function(e){var t=this,n="function"==typeof e?e:t.onValidateAll,r=t.fields.filter(function(e){var n=e.dom;return n&&!n.disabled&&t.dom.contains(n)}).map(function(e){return o.validate(e,!0)});return Promise.all(r).then(function(e){var r=e.concat.apply([],e);if(t.deduplicateInValidateAll){var a={};r=r.filter(function(e){var t=e.element,n=t.uniqueID||(t.uniqueID=setTimeout("1"));return!a[n]&&(a[n]=!0)})}n.call(t.dom,r)})},addField:function(e){var t=this,n=e.dom;!t.validateInKeyup||e.isChanged||e.debounceTime||avalon.bind(n,"keyup",function(t){o.validate(e,0,t)}),t.validateInBlur&&avalon.bind(n,"blur",function(t){o.validate(e,0,t)}),t.resetInFocus&&avalon.bind(n,"focus",function(r){t.onReset.call(n,r,e)})},validate:function(e,t,n){var a=[],o=e.value,i=e.dom,l=e.validator;if("function"!=typeof Promise&&avalon.error("please npm install avalon-promise or bluebird"),!i.disabled){var s=e.rules;if(!s.norequired||""!==o)for(var c in s){var u=s[c];if(u!==!1){var d,f,v=avalon.validators[c];a.push(new Promise(function(e,t){d=e,f=t}));var p=function(t){if(t)d(!0);else{var n={element:i,data:e.data,message:i.getAttribute("data-"+c+"-message")||i.getAttribute("data-message")||v.message,validateRule:c,getMessage:r};d(n)}};e.data={},e.data[c]=u,v.get(o,e,p)}}return Promise.all(a).then(function(e){var r=e.filter(function(e){return"object"==typeof e});return t||(r.length?l.onError.call(i,r,n):l.onSuccess.call(i,r,n),l.onComplete.call(i,r,n)),r})}}}),i=/\\?{{([^{}]+)\}}/gm;o.defaults={addField:o.addField,onError:avalon.noop,onSuccess:avalon.noop,onComplete:avalon.noop,onManual:avalon.noop,onReset:avalon.noop,onValidateAll:avalon.noop,validateInBlur:!0,validateInKeyup:!0,validateAllInSubmit:!0,resetInFocus:!0,deduplicateInValidateAll:!1}},function(e,t){function n(e){return"regexp"===avalon.type(e)}function r(e){if("string"==typeof e&&e){var t=e.split("-");if(3===t.length&&4===t[0].length){var n=~~t[0],r=~~t[1]-1,a=~~t[2],o=new Date(n,r,a);return o.getFullYear()===n&&o.getMonth()===r&&o.getDate()===a}}return!1}avalon.directive("rules",{diff:function(e,t,n){var r=e[n];if(r&&"[object Object]"===Object.prototype.toString.call(r)){t[n]=r.$model||r;var a=t.dom&&t.dom.__ms_duplex__;a&&(a.rules=e[n])}}});var a=/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/i,o=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/;avalon.shadowCopy(avalon.validators,{pattern:{message:"必须匹配{{pattern}}这样的格式",get:function(e,t,r){var a=t.dom,o=t.data;if(!n(o.pattern)){var i=a.getAttribute("pattern");o.pattern=new RegExp("^(?:"+i+")$")}return r(o.pattern.test(e)),e}},digits:{message:"必须整数",get:function(e,t,n){return n(/^\-?\d+$/.test(e)),e}},number:{message:"必须数字",get:function(e,t,n){return n(!!e&&isFinite(e)),e}},norequired:{message:"",get:function(e,t,n){return n(!0),e}},required:{message:"必须填写",get:function(e,t,n){return n(""!==e),e}},equalto:{message:"密码输入不一致",get:function(e,t,n){var r=String(t.data.equalto),a=avalon(document.getElementById(r)).val()||"";return n(e===a),e}},date:{message:"日期格式不正确",get:function(e,t,a){var o=t.data;return a(n(o.date)?o.date.test(e):r(e)),e}},url:{message:"URL格式不正确",get:function(e,t,n){return n(o.test(e)),e}},email:{message:"email格式不正确",get:function(e,t,n){return n(a.test(e)),e}},minlength:{message:"最少输入{{minlength}}个字",get:function(e,t,n){var r=parseInt(t.data.minlength,10);return n(e.length>=r),e}},maxlength:{message:"最多输入{{maxlength}}个字",get:function(e,t,n){var r=parseInt(t.data.maxlength,10);return n(e.length<=r),e}},min:{message:"输入值不能小于{{min}}",get:function(e,t,n){var r=parseInt(t.data.min,10);return n(parseFloat(e)>=r),e}},max:{message:"输入值不能大于{{max}}",get:function(e,t,n){var r=parseInt(t.data.max,10);return n(parseFloat(e)<=r),e}},chs:{message:"必须是中文字符",get:function(e,t,n){return n(/^[\u4e00-\u9fa5]+$/.test(e)),e}}})},function(e,t,n){var r=n(39);avalon.directive("if",{priority:6,diff:function(e,t,n,a,o,i){var l=!!e[n];t[n]=l,r(t,this.update)},update:function(e,t,n){var r=t["ms-if"];if(t.dynamic["ms-if"]&&(t.dynamic["ms-if"]=t.nodeName),r){if("#comment"===t.nodeName){t.nodeName=t.dynamic["ms-if"],delete t.nodeValue;var a=t.comment;if(!a)return;n=a.parentNode,n&&n.replaceChild(e,a),delete t.comment,avalon.applyEffect(e,t,{hook:"onEnterDone"})}}else t.comment||(t.comment=document.createComment("if")),t.nodeName="#comment",t.nodeValue="if",avalon.applyEffect(e,t,{hook:"onLeaveDone",cb:function(){n=n||e.parentNode,n&&n.replaceChild(t.comment,e)}})}})},function(e,t,n){function r(e){var t=typeof e;return e&&"object"===t?e.$hashcode:t+":"+e}function a(e,t,n,a,o,i,l,s){var c=s?r(t):e,u={};u[o]=e,u[i]=t;for(var d in n)d in u||(u[d]=n[d]);a(e,t,c,u,l)}function o(e,t){var n=e.children.map(function(e){return e["ms-if"]?e.comment:e.dom});return t&&n.forEach(function(t){e.dom.appendChild(t)}),n}function i(e){var t;for(var n in e){var t=n;break}if(t)return l(e,t)}function l(e,t){var n=e[t];if(n){var r=n.arr;if(r){var a=r.pop();return r.length||(n.arr=0),a}return delete e[t],n}}function s(e,t){var n=t.key;if(e[n]){var r=e[n],a=r.arr||(r.arr=[]);a.push(t)}else e[n]=t}var c=n(39),u=/\s+as\s+([$\w]+)/,d=/^[$a-zA-Z_][$a-zA-Z0-9_]*$/,f=/^(null|undefined|NaN|window|this|\$index|\$id)$/,v=/[$\w]+/g;avalon._each=function(e,t,n,r){var o=[];r.push(o);var i=(t+"").slice(0,40).match(v);if(i.shift(),Array.isArray(e))for(var l=0;l<e.length;l++)a(l,e[l],n,t,i[0],i[1],o,!0);else for(var l in e)e.hasOwnProperty(l)&&a(l,e[l],n,t,i[0],i[1],o)},avalon.directive("for",{priority:3,parse:function(e,t){var n,r=t.forExpr;r=r.replace(u,function(e,t){return!d.test(t)||f.test(t)?avalon.error("alias "+t+" is invalid --- must be a valid JS identifier which is not a reserved name."):n=t,""});var a=r.split(" in "),o={expr:a[1].trim(),type:"for"},i=avalon.parseExpr(o),l=(a[0]+" traceKey __local__ vnodes").match(v);4===l.length&&l.unshift("$key"),t.$append=Array("var loop = "+i+";","avalon._each(loop, function("+l+"){","__local__["+avalon.quote(n||"valueOf")+"] = loop","vnodes.push({",'\tnodeName: "#document-fragment",',"\tindex   : arguments[0],","\tkey     : traceKey,","\tchildren: new function(){\nvar vnodes = []\n").join("\n")},diff:function(e,t,n,r,a){if(!avalon.callArray||!t.list||t.forExpr.indexOf(avalon.callArray)!==-1){var o,u,d,f=r[a+1],v=n[a+1],p=n[a+2],m=t.cache||{},h=[];if(f.length)if(f===v){v.forEach(function(e){e.action="move",s(m,e)}),t.cache=m;var y=!0}else{t.action="update";var g={},_=[];for(o=0;u=v[o];o++){var d=l(m,u.key);d?(d.oldIndex=d.index,d.index=u.index,s(g,d)):_.push(u)}for(var u,o=0;u=_[o];o++)d=i(m,u.key),d?(d.oldIndex=d.index,d.index=u.index,d.key=u.key):(d=u,f.push(d)),s(g,d);f.sort(function(e,t){return e.index-t.index}),t.cache=g;for(var o in m)d=m[o],d.action="leave",avalon.Array.remove(f,d),h.push(d),d.arr&&(d.arr.forEach(function(e){e.action="leave",h.push(e)}),delete d.arr)}else t.action="init",r[a+1]=v,v.forEach(function(e,t){f[t]=e,s(m,e)}),t.cache=m;h.length>1&&h.sort(function(e,t){return e.index-t.index}),t.removes=h;var b=avalon.caches[t.wid],x=e.vmodel;return p&&b&&(p.afterChange=[function(e){b.call(x,{type:"rendered",target:e,signature:t.signature})}]),y||(t.list=f,c(t,this.update)),!0}},update:function(e,t,n){if("init"===t.action){var r=n;n=document.createDocumentFragment()}for(var a,i=e,l=t.signature,s=0;a=t.removes[s++];)a.dom&&(delete a.split,t.hasEffect?!function(e){var t=o(e),n=e.children.concat();e.children.length=0,p(t,n,{hook:"onLeaveDone",staggerKey:l+"leave",cb:function(e){e.parentNode&&e.parentNode.removeChild(e)}})}(a):o(a,"add"));t.list.forEach(function(e,r){if("leave"!==e.action){e.dom||(e.dom=avalon.domize(e));var a=e.dom;if(void 0===e.oldIndex){if(t.hasEffect)var s=avalon.slice(a.childNodes);0===r&&"init"===t.action?n.appendChild(a):n.insertBefore(a,i.nextSibling),t.hasEffect&&p(s,e.children,{hook:"onEnterDone",staggerKey:l+"enter"})}else if(e.index!==e.oldIndex){var s=o(e,"add");n.insertBefore(e.dom,i.nextSibling),t.hasEffect&&p(s,e.children,{hook:"onMoveDone",staggerKey:l+"move"})}i=e.split}}),"init"===t.action&&r.insertBefore(n,e.nextSibling)}}),avalon.domize=function(e){return avalon.vdom(e,"toDOM")};var p=function(e,t,n){t.forEach(function(t,r){avalon.applyEffect(e[r],t,n)})}},function(e,t,n){function r(e,t){var n=t.props.is,r=t["component-vm:"+n],a="component-html:"+n,o=t[a],i=avalon.vdom(t,"toHTML");o!==i&&(t[a]=i,r.$fire("onViewChange",{type:"viewchange",target:e,vmodel:r,is:n}))}function a(e){var t=!0;try{o(e)}catch(e){t=!1}return t}function o(e){e.children.forEach(function(e){if("#comment"===e.nodeName){if("unresolved component placeholder"===e.nodeValue)throw"unresolved"}else e.children&&o(e)})}var i=n(39),l=n(62);avalon.component=function(e,t){avalon.components[e]||(avalon.components[e]=t)},avalon.directive("widget",{priority:4,parse:function(e,t,n){t.props.wid=t.props.wid||avalon.makeHashCode("w"),e[n.name]=avalon.parseExpr(n),e.template=t.template,e.vmodel="__vmodel__",e.local="__local__"},define:function(){return avalon.mediatorFactory.apply(this,arguments)},diff:function(e,t,n,r,o,s){var c=e[n];if(Object(c)===c){
var u=t.props.is||(/^ms\-/.test(t.nodeName)?t.nodeName:0);u||(c=c.$model||c,Array.isArray(c)&&(c.unshift({}),avalon.mix.apply(0,c),c=c.shift()),u=c.is);var d="component-vm:"+u;if(t.props.is=u,t.vmodel=e.vmodel,!t[d]&&!l(t,e[n],e.local,e.template))return t.nodeValue="unresolved component placeholder",r[s]=t,void i(t,this.mountComment);var f=t[d],v=avalon.scopes[f.$id];if(v&&v.vmodel){var p=v.vmodel.$element;if(t.dom!==p){var m=p.vtree[0];return o[s]=r[s]=m,t.com=p,m.skipContent||(m.skipContent="optimize"),i(t,this.replaceCachedComponent),void i(m,function(){"optimize"===m.skipContent&&(m.skipContent=!0)},"afterChange")}}var h=f.$render,y=h(f,e.local),m=y[0];m&&a(m)?(m.local=e.local,Array(d,"component-html:"+u,"component-ready:"+u,"dom","dynamic").forEach(function(e){m[e]=t[e]}),m.vmodel=f,r[s]=m,t.comment&&t.nodeValue&&(m.dom=t.comment),t.nodeName!==m.nodeName?(o[s]=m,i(m,this.mountComponent)):i(t,this.updateComponent)):(t.nodeValue="unresolved component placeholder",r[s]={nodeValue:"unresolved component placeholder",nodeName:"#comment"},i(t,this.mountComment))}else t.props.is===e.props.is&&i(t,this.updateComponent)},replaceCachedComponent:function(e,t,n){var r=t.com;n.replaceChild(r,e),t.dom=r,delete t.com},mountComment:function(e,t,n){var r=document.createComment(t.nodeValue);t.dom=r,n.replaceChild(r,e)},updateComponent:function(e,t){var n=t["component-vm:"+t.props.is],a=n.$events.onViewChange;a&&a.length&&i(t,r,"afterChange")},mountComponent:function(e,t,n){delete t.dom;var r=avalon.vdom(t,"toDOM"),a=t.props.is,o=t["component-vm:"+a];o.$fire("onInit",{type:"init",vmodel:o,is:a}),n.replaceChild(r,e),t.dom=o.$element=r,r.vtree=[t],avalon._disposeComponent(r),t["component-ready:"+a]=!0,avalon.scopes[o.$id]={vmodel:o,top:t.vmodel,local:t.local},i(t,function(){o.$fire("onReady",{type:"ready",target:r,vmodel:o,is:a})},"afterChange"),i(t,function(){t["component-html:"+a]=avalon.vdom(t,"toHTML")},"afterChange")}})},function(e,t,n){function r(e,t,n,r){function d(e,t){C.forEach(function(n){delete e[n],delete t[n]})}var m=e.nodeName,h=e.props.is;if(!u[m]&&!l(m))return void avalon.warn(m+"不合适做组件的标签");var y={};if(t){var g=[].concat(t);g.forEach(function(e){e&&"object"==typeof e&&s(y,e.$model||e,!0)})}else g=[];var _=avalon.components[h];if(_){var b=y.id||y.$id;!b&&p&&(avalon.warn("warning!",h,"组件最好在ms-widget配置对象中指定全局不重复的$id以提高性能!\n","若在ms-for循环中可以利用 ($index,el) in @array 中的$index拼写你的$id\n","如 ms-widget=\"{is:'ms-button',id:'btn'+$index}\""),p=!1),y.define&&(delete y.define,avalon.warn("warning! 组件的define配置项已经被废掉"));var x=avalon.directives.widget.define,w=b||e.props.id||"w"+(new Date-0),$=avalon.mix(!0,{},_.defaults);s(y,$,!1);var C=v.concat();d.isWidget=!0;var E=x.apply(d,[e.vmodel,$].concat(g));if(!avalon.modern)for(var A in E)c[A]||"function"!=typeof E[A]||(E[A]=E[A].bind(E));E.$id=w,avalon.vmodels[w]=E;for(var k in f)y[k]&&y[k].forEach(function(e){E.$watch(k,e)});var T=avalon.lexer(r),O=T[0];O.children=O.children||[],O.props.is=h,O.props.wid=w,avalon.speedUp(T);var N=avalon.render(T,n),M=_.template.trim();"function"==typeof _.getTemplate&&(M=_.getTemplate(E,M));var j=avalon.lexer(M);j.length>1&&avalon.error("组件必须用一个元素包起来");var S=_.soleSlot;i(j,S),avalon.speedUp(j);var D=avalon.render(j),L=o+"",V=S?avalon.quote(S):"null";L=L.replace("XXXXX",a(N)).replace("YYYYY",a(D)).replace("ZZZZZ",V);var F=L.indexOf("{")+1,P=L.lastIndexOf("}"),H=Function("vm","local",L.slice(F,P));return E.$render=H,e["component-vm:"+h]=E,E.$render=H}}function a(e){return e.toString().replace("anonymous","").replace(/\s*\/\*\*\//g,"")}function o(){var e=XXXXX(vm,local),t=e[0],n=YYYYY(vm,local),r=n[0];for(var a in t)"children"!==a&&"nodeName"!==a&&("props"===a?avalon.mix(r.props,t.props):r[a]=t[a]);var o=ZZZZZ,i=avalon.collectSlots(t,o);return!o||i[o]&&i[o].length||(i[o]=[{nodeName:"#text",nodeValue:vm[o],dynamic:!0}]),avalon.insertSlots(n,i),delete r.skipAttrs,delete r.skipContent,n}function i(e,t){for(var n,r=0;n=e[r];r++)if("slot"===n.nodeName){var a=n.props.name||t;e.splice(r,1,{nodeName:"#comment",nodeValue:"slot:"+a,dynamic:!0,type:a},{nodeName:"#comment",nodeValue:"slot-end:"}),r++}else n.children&&i(n.children,t)}function l(e){return m.test(e)||avalon.components[e]}function s(e,t,n){for(var r in t){var a=t[r];f[r]?r in e?e[r].push(a):e[r]=[t[r]]:n&&(e[r]=a)}}var c=n(63);avalon._disposeComponent=n(64);var u={wbr:1,xmp:1,template:1},d="onInit,onReady,onViewChange,onDispose",f=avalon.oneObject(d),v=d.split(",").concat("is","define"),p=!0;e.exports=r,avalon.insertSlots=function(e,t){for(var n,r=0;n=e[r];r++)if("#comment"===n.nodeName&&t[n.type]){var a=[r+1,0].concat(t[n.type]);e.splice.apply(e,a),r+=t[n.type].length}else n.children&&avalon.insertSlots(n.children,t)},avalon.collectSlots=function(e,t){var n={};return t?(n[t]=e.children,n.__sole__=t):e.children.forEach(function(t,r){var a=t.props&&t.props.slot;a&&(t.forExpr?n[a]=e.children.slice(r,r+2):Array.isArray(n[a])?n[a].push(t):n[a]=[t])}),n};var m=/^[a-z]([a-z\d]+\-)+[a-z\d]+$/},function(e,t){e.exports=avalon.oneObject("$id,$render,$track,$element,$watch,$fire,$events,$model,$skipArray,$accessors,$hashcode,$run,$wait,__proxy__,__data__,__const__")},function(e,t){function n(e){for(;e;){if(9===e.nodeType)return!0;e=e.parentNode}return!1}function r(e){if(1===e.nodeType&&e.getAttribute("wid")&&!n(e)){var t=e.getAttribute("wid"),r=avalon.scopes[t];if(!r)return;var o=e.getAttribute("ms-controller")||e.getAttribute("ms-important"),i=o&&avalon.vmodels[o]||r.vmodel;if(i.$fire("onDispose",{type:"dispose",target:e,vmodel:i}),o)return;if(!e.getAttribute("cached")){delete r.vmodel,delete avalon.scopes[t];var l=e.vtree;a(l);var s=e.getAttribute("is");l&&(l[0][s+"-mount"]=!1,l[0]["component-ready:"+s]=!1)}return!1}}function a(e){for(var t in e){var n=e[t];if(d.test(n.nodeName)){for(var t in n)0===t.indexOf("ms-on")&&delete n[t];n.children&&a(n.children)}}}function o(e){setTimeout(function(){r(e)},4)}function i(e){for(var t,n=0;t=e[n++];)r(t)}function l(e){e.addEventListener("DOMNodeRemovedFromDocument",function(){o(e)})}function s(){function e(e,t){var r=n[e];n[e]=function(e,n){return t.call(this,r,e,n)}}function t(e){var t=avalon.slice(this.getElementsByTagName("*"));r.call(this,e),i(t)}if(!s.execute){s.execute=!0;var n=Node.prototype;e("removeChild",function(e,t,n){return e.call(this,t,n),1===t.nodeType&&o(t),t}),e("replaceChild",function(e,t,n){return e.call(this,t,n),1===n.nodeType&&o(n),t});var r,a=Element.prototype;try{var l=Object.getOwnPropertyDescriptor(a,"innerHTML"),r=l.set;l.set=t,Object.defineProperty(a,"innerHTML",l)}catch(e){if(!a||!a.__lookupSetter__)throw e;r=a.__lookupSetter__("innerHTML"),a.__defineSetter__("innerHTML",t)}e("appendChild",function(e,t){return e.call(this,t),1===t.nodeType&&11===this.nodeType&&o(t),t}),e("insertBefore",function(e,t,n){return e.call(this,t,n),1===t.nodeType&&11===this.nodeType&&o(t),t})}}function c(e){avalon.Array.ensure(f,e),v||(v=setInterval(function(){for(var e,t=0;e=f[t];)!1===r(e)?avalon.Array.removeAt(f,t):t++;0==f.length&&(clearInterval(v),v=0)},700))}function u(e){if(window.chrome&&window.MutationEvent)l(e);else try{s(e)}catch(t){c(e)}}var d=/^\w/,f=[],v=0;u.byMutationEvent=l,u.byRewritePrototype=s,u.byPolling=c,e.exports=u},function(e,t,n){function r(e,t){for(var n in e)if(e[n]!==t[n])return!0;return!1}function a(){if(!f.lock){var e=f[0];e&&(a.lock=!0,e())}}function o(e){var t=p.test(e)?1e3:1;return parseFloat(e)*t}function i(e,t,n){var r=e[t];r=Array.isArray(r)?r:"function"==typeof r?[r]:[],r.forEach(function(e){e&&e(n)})}function l(e){var t=e.toLowerCase();return function(n){var r,l=this.el,s=avalon(l),u=isFinite(n.stagger)?1e3*n.stagger:0;if(u&&n.staggerKey){var d=m.get(n.staggerKey)||m.put(n.staggerKey,{count:0,items:0});d.count++,d.items++}var v=d&&d.count||0,p=function(t){var o=t!==!1;l.animating=void 0,r=!0;var s=o?"Done":"Abort";i(n,"on"+e+s,l),avalon.unbind(l,c.transitionEndEvent),avalon.unbind(l,c.animationEndEvent),d&&0===--d.items&&(d.count=0),n.queue&&(f.lock=!1,f.shift(),a())};i(n,"onBefore"+e,l),n[t]?n[t](l,function(e){p(e!==!1)}):c.css&&(s.addClass(n[t+"Class"]),"leave"===t?s.removeClass(n.enterClass+" "+n.enterActiveClass):"enter"===t&&s.removeClass(n.leaveClass+" "+n.leaveActiveClass),s.bind(c.transitionEndEvent,p),s.bind(c.animationEndEvent,p),setTimeout(function(){r=NaN===avalon.root.offsetWidth,s.addClass(n[t+"ActiveClass"]);var e=window.getComputedStyle(l),a=e[c.transitionDuration],i=e[c.animationDuration],d=o(a)||o(i);0===!d?p(!1):u||setTimeout(function(){r||p(!1)},d+130)},17+u*v))}}function s(e){e.acton||(e.action=e.hook.replace(/^on/,"").replace(/Done$/,"").toLowerCase())}var c=n(66),u=n(7),d=n(39);avalon.directive("effect",{priority:5,diff:function(e,t,n){var a=e[n];if(a=e.$model||a,"string"==typeof a){var o=a;a={is:o}}else Array.isArray(a)&&(a=avalon.mix.apply({},a));a.action=a.action||"enter",Object(a)===a&&(t.dynamic[n]&&!r(a,t[n]||{})||(t[n]=a,d(t,this.update,"afterChange"))),e!==t&&delete e[n]},update:function(e,t,n,r){if(e&&1===e.nodeType&&!e.animating){e.animating=!0;var o=t["ms-effect"];if(!t.dynamic["ms-effect"]){var i=o.cb||avalon.noop;o.cb=[function(){t.dynamic["ms-effect"]=1,o.cb=i}].concat(i)}var l=o.is;if(r=r||{},!l)return avalon.warn("need is option");var s=avalon.effects;c.css&&!s[l]&&avalon.effect(l,{});var u=s[l];if(!u)return avalon.warn(l+" effect is undefined");var d=r.action||o.action,v=avalon.Effect,p=new v(e),m=avalon.mix(r,u,o);m.queue?(f.push(function(){p[d](m)}),a()):setTimeout(function(){p[d](m)},4)}}});var f=[];avalon.effects={},avalon.effect=function(e,t){avalon.effects[e]=t||{},c.css&&(t.enterClass||(t.enterClass=e+"-enter"),t.enterActiveClass||(t.enterActiveClass=t.enterClass+"-active"),t.leaveClass||(t.leaveClass=e+"-leave"),t.leaveActiveClass||(t.leaveActiveClass=t.leaveClass+"-active")),t.action||(t.action="enter")};var v=function(e){this.el=e};avalon.Effect=v,v.prototype={enter:l("Enter"),leave:l("Leave"),move:l("Move")};var p=/\d+s$/,m=new u(128);avalon.applyEffect=function(e,t,n){var r=n.cb,a=t["ms-effect"];if(a&&e&&1===e.nodeType){var o=n.hook,i=a[o];r&&(Array.isArray(i)?i.push(r):i?a[o]=[i,r]:a[o]=[r]),s(n),avalon.directives.effect.update(e,t,0,avalon.shadowCopy({},n))}else r&&r(e)}},function(e,t){if(avalon.browser){var n,r,a,o=!1,i=!1,l=!1,s=avalon.cssName("transition-duration"),c=avalon.cssName("animation-duration"),u={TransitionEvent:"transitionend",WebKitTransitionEvent:"webkitTransitionEnd",OTransitionEvent:"oTransitionEnd",otransitionEvent:"otransitionEnd"},d=avalon.window;for(var f in u){if(d[f]){a=u[f];break}try{document.createEvent(f);a=u[f];break}catch(e){}}"string"==typeof a&&(o=!0,l=!0,n=a),u={AnimationEvent:"animationend",WebKitAnimationEvent:"webkitAnimationEnd"};var v;for(f in u)if(d[f]){v=u[f];break}"string"==typeof v&&(i=!0,l=!0,r=v)}e.exports={transition:o,animation:i,css:l,transitionEndEvent:n,animationEndEvent:r,transitionDuration:s,animationDuration:c}},function(e,t,n){function r(e,t){var n=Array.isArray(e)?a(e):e,r=[];if(t)for(var i in t)r.push("var "+i+" = __local__["+avalon.quote(i)+"]");n=n.replace(o,"$1");var l="__local__ = __local__ || {};\n"+r.join(";\n")+"\n"+n;try{var s=Function("__vmodel__","__local__",l)}catch(e){avalon.warn(n,"render parse error")}return s}avalon.lexer=n(68),avalon.diff=n(72),avalon.batch=n(73),avalon.speedUp=n(74),avalon.parseExpr=n(77);var a=n(75),o=/\\\\(['"])/g;avalon.render=r,e.exports=avalon},function(e,t,n){function r(e){x={},e=d(e,s);var t=[];t.last=function(){return t[t.length-1]};var n=[],r=1e5;do{var v=!1;if("<"!==e.charAt(0)){var b=e.indexOf("<");b=b===-1?e.length:b;var w=e.slice(0,b).replace(_,c);e=e.slice(b),v={nodeName:"#text",nodeValue:w},g.test(w)&&o(v,t,n)}if(!v){var b=e.indexOf("<!--");if(0===b){var $=e.indexOf("-->");$===-1&&u.error("注释节点没有闭合"+e);var w=e.slice(4,$).replace(_,c);e=e.slice($+3),v={nodeName:"#comment",nodeValue:w},o(v,t,n)}}if(!v){var C=e.match(h);if(C){var E=C[1].toLowerCase(),A=f[E]||"/"===C[3];v={nodeName:E,props:{},children:[],isVoidTag:A};var k=C[2];if(k&&i(k,v.props),o(v,t,n),e=e.slice(C[0].length),A)v.end=!0;else if(t.push(v),m[E]){var T=e.indexOf("</"+E+">"),O=e.slice(0,T).trim();e=e.slice(T),p(v,E,l(O))}}}if(!v){var C=e.match(y);if(C){var E=C[1].toLowerCase(),N=t.last();N?N.nodeName!==E&&u.error(N.nodeName+"没有闭合"):u.error(C[0]+"前面缺少<"+E+">"),v=t.pop(),v.end=!0,e=e.slice(C[0].length)}}if(!v||0===--r)break;v.end&&(a(v,t,n),delete v.end)}while(e.length);return n}function a(e,t,n){var r=e.nodeName,a=e.props;"table"===r&&v(e.children);var o=a["ms-for"];if(o){delete a["ms-for"];var i=t.last(),l=i?i.children:n;l.splice(l.length-1,1,{nodeName:"#comment",nodeValue:"ms-for:"+o,type:r},e,{nodeName:"#comment",nodeValue:"ms-for-end:",type:r})}}function o(e,t,n){var r=t.last();r?r.children.push(e):n.push(e)}function i(e,t){for(;e;){var n=$.exec(e);if(!n)break;var r=n[1],a=n[2]||"";e=e.replace(n[0],""),":"===r.charAt(0)&&(r="ms-"+r.slice(1)),a&&0===a.indexOf("??")&&(a=l(a).replace(w,"").slice(1,-1)),r in t||(t[r]=a)}}function l(e){return u.unescapeHTML(e.replace(_,c))}function s(e){var t="??"+b++;return x[t]=e,t}function c(e){var t=x[e];return t}var u=n(4),d=n(69),f=n(36),v=n(70),p=n(71),m=u.oneObject("script,style,textarea,xmp,noscript,option,template"),h=/^<([-A-Za-z0-9_]+)\s*([^>]*?)(\/?)>/,y=/^<\/([^>]+)>/,g=/\S/,_=/\?\?\d+/g,b=1,x={};e.exports=r;var w=/[\n\r]s*/g,$=/([^=\s]+)(?:\s*=\s*(\S+))?/},function(e,t){function n(e,t){for(var n=r(e),a=0,o=n.length;a<o;a++)e=e.replace(n[a],t);return e}function r(e){for(var t,n=0,r=[],a=0,o=e.length;a<o;a++){var i=e.charAt(a);if(t){if("\\"===i){a+=1;continue}i===t&&(r.push(e.slice(n,a+1)),t=!1)}else"'"===i?(t="'",n=a):'"'===i&&(t='"',n=a)}return r}e.exports=n},function(e,t){e.exports=function(e){for(var t,n=!1,r=0,a=0,o=e.length,i=0;i<o;i++){var l=e[i];t?"tr"!==l.nodeName&&l.children?t=!1:(t.children.push(l),r++,e[i]=0):"tr"===(l.type||l.nodeName)&&(t={nodeName:"tbody",children:[]},t.children.push(l),l.type&&delete l.type,n=!0,0===a&&(a=i),e[i]=t)}if(n)for(i=a;i<o&&(0!==e[i]||(e.splice(i,1),i--,r--,0!==r));i++);}},function(e,t){function n(e,t,n){switch(t){case"style":case"script":case"noscript":case"template":case"xmp":e.children=[{nodeName:"#text",skipContent:!0,nodeValue:n}];break;case"textarea":var a=e.props;a.type=t,a.value=n,e.children=[{nodeName:"#text",nodeValue:n}];break;case"option":e.children=[{nodeName:"#text",nodeValue:r(n)}]}}function r(e){return String(e).replace(a,"").trim()}e.exports=n;var a=/<\w+(\s+("[^"]*"|'[^']*'|[^>])+)?>|<\/\w+>/gi},function(e,t){function n(e,t){for(var l=0;l<e.length;l++){var s=e[l],c=t[l]||e[l];switch(s.nodeName){case"#text":if(s.dynamic){var u=s.nodeValue+"";u!==c.nodeValue&&(c.nodeValue=u,c.dom&&(c.dom.nodeValue=u))}break;case"#comment":s.forExpr?i.for.diff(s,c,e,t,l):s.afterChange&&r(c,s.afterChange);break;case void 0:n(s,c);break;case"#document-fragment":n(s.children,c.children);break;default:if(s.dynamic){var d=l;s["ms-widget"]&&(avalon.directives.widget.diff(s,c,"ms-widget",e,t,d),s=e[l],c=t[l]||o(),delete s["ms-widget"]),"ms-if"in s&&(avalon.directives.if.diff(s,c,"ms-if",e,t,d),s=e[l],c=t[l]||o(),delete s["ms-if"]),a(s,c)}!/^\w/.test(s.nodeName)||s.skipContent||s.isVoidTag||n(s.children,c.children||[]),c.afterChange&&r(c,c.afterChange)}}}function r(e,t){if(t.length)for(var n,r=0;n=t[r++];)n(e.dom,e);delete e.afterChange}function a(e,t){var n=avalon.directives;try{for(var r in e){var a=r.match(l),o=a&&a[1];n[o]&&n[o].diff(e,t,r)}}catch(e){avalon.warn(o,e,e.stack||e.message,"diffProps error")}}var o=function(){return{children:[],props:{}}},i=avalon.directives,l=/^ms-(\w+)-?(.*)/;avalon.diff=n,e.exports=n},function(e,t){function n(e){if(a)return avalon.Array.ensure(r,e);a=e;var t=avalon.scopes[e];if(!t||!document.nodeName||avalon.suspendUpdate)return a=null;var o=t.vmodel,i=o.$element,l=i.vtree||[],s=o.$render,c=s(t.vmodel,t.local);t.isTemp&&delete avalon.scopes[e],avalon.diff(c,l);var u=r.indexOf(a);if(a=0,u>-1){var d=r.splice(u,1);return n(d[0])}var f=r.shift();f&&n(f)}var r=[],a=!1;avalon.suspendUpdate=0,e.exports=avalon.batch=n},function(e,t,n){function r(e){var t=e.nodeName;switch(t){case"#text":return!!avalon.config.rexpr.test(e.nodeValue)&&(e.dynamic=!0);case"#comment":return!!e.dynamic;case void 0:return!0;default:var n=e.props||{};if("ms-skip"in n)return e.skipContent=!0,!1;var r=!1;if("input"===t)n.type||(n.type="text");else if(/xmp|wbr|template/.test(t))!n["ms-widget"]&&n.is&&(n["ms-widget"]='{is:"'+n.is+'"}');else if("select"===t){var o=n.hasOwnProperty("multiple")?"multiple":"one";n.type=t+"-"+o}else 0===t.indexOf("ms-")&&(n["ms-widget"]||(n.is=t,n["ms-widget"]='{is:"'+t+'"}'));var i=!1;if(n["ms-widget"]){i=!0,a(n,"html","widget"),a(n,"text","widget");var l=avalon.mix({},e),s=avalon.mix({},e.props);delete s["ms-widget"],delete l.isVoidTag,l.nodeName="cheng",l.props=s,e.template=avalon.vdom(l,"toHTML"),e.isVoidTag||(e.children=[])}n["ms-text"]&&(i=!0,a(n,"html","text"),e.isVoidTag||(e.children=[])),n["ms-html"]&&(i=!0,e.isVoidTag||(e.children=[]));var u=!1;for(var d in n)if(u=!0,0===d.indexOf("ms-")){r=!0,e.dynamic={};break}if(u&&(e.props=n),e.children){var f=c(e.children);if(f)return delete e.skipContent,!0;i?delete e.skipContent:e.skipContent=!0}return r}}function a(e,t,n){e["ms-"+t]&&(avalon.warn(t,"指令不能与",n,"指令共存于同一个元素"),delete e["ms-"+t])}function o(e){for(var t,n=0;t=e[n++];)if(t.props&&t.props["ms-effect"])return!0;return!1}var i=/^\s*ms\-for\:\s*/,l=/^\s*ms\-for\-end/,s=n(75);e.exports=function(e){return c(e),e};var c=function(e){for(var t=[],n=!1,a=0;a<e.length;a++){var u=e[a],d="#comment"===u.nodeName;if(d&&i.test(u.nodeValue)){n=!0,t.push(u);var f=t;t=[],t.list=f,t.start=u}else if(d&&l.test(u.nodeValue)){var f=t;t=f.list;var v=f.start;delete f.list,delete f.start,t.push(f,u),u.dynamic=!0;var p=v.signature||(v.signature=avalon.makeHashCode("for"));if(u.signature=p,v.forExpr=v.nodeValue.replace(i,""),1===f.length){var m=f[0];if(m.props){m.props.slot&&(v.props='{slot: "'+m.props.slot+'"}');var h=m.props["data-for-rendered"];if(h){delete m.props["data-for-rendered"];var y=h+":cb";avalon.caches[y]||(avalon.caches[y]=Function("return "+avalon.parseExpr({type:"on",expr:h}))()),v.wid=y}}}for(var g=0;g<f.length;g++){var u=f[g],_=u.dom;_&&_.parentNode&&_.parentNode.removeChild(_)}v.hasEffect=o(f),c(f),avalon.caches[p]||(avalon.caches[p]=s(f,!0)),f.length=0}else r(u)&&(n=!0),t.push(u)}return e.length=0,e.push.apply(e,t),n}},function(e,t,n){function r(e,t){for(var n,r=t?[]:["\nvar vnodes = [];"],o=0;n=e[o++];){var i=a(n);n.$prepend&&r.push(n.$prepend);var l=n.$append;delete n.$append,delete n.$prepend,i&&r.push(i+"\n"),l&&r.push(l)}return t||r.push("return vnodes\n"),r.join("\n")}function a(e){if(!e.nodeName)return!1;switch(e.nodeName){case"#text":return e.dynamic?i(s(e)):l(e);case"#comment":var t=e.nodeValue;if(e.forExpr){var n={dynamic:!0,vmodel:"__vmodel__"};for(var a in e)e.hasOwnProperty(a)&&!h[a]&&(n[a]=e[a]);return avalon.directives.for.parse(n,e,e),e.$append+=avalon.caches[e.signature],l(n)}if("ms-for-end:"===t)return e.$append=l({nodeName:"#comment",nodeValue:e.signature})+" return vnodes}\n })\n},__local__,vnodes)\n"+l({nodeName:"#comment",signature:e.signature,nodeValue:"ms-for-end:"})+"\n","";if(0===t.indexOf("ms-js:")){var o=avalon.parseExpr({type:"js",expr:t.replace("ms-js:","")})+"\n",c=l(e),f=o.match(m);return f&&f[1]?e.$append=(e.$append||"")+o+"\n__local__."+f[1]+" = "+f[1]+"\n":avalon.warn(t+" parse fail!"),c}return l(e);default:if(!e.dynamic&&e.skipContent)return l(e);var n={nodeName:e.nodeName},v=e.props;if(e.dynamic){n.dynamic="{}";var p=u(n,v);p.map(function(t){return avalon.directives[t.type].parse(n,e,t),t.name})}else if(v){n.props={};for(var a in v)n.props[a]=v[a]}if(e.isVoidTag)n.isVoidTag=!0;else if(!("children"in n)){var y=e.children;y&&(e.skipContent?n.children="["+y.map(function(e){return d(e)})+"]":1===y.length&&"#text"===y[0].nodeName?y[0].dynamic?n.children="["+s(y[0])+"]":n.children="["+d(y[0])+"]":n.children="(function(){"+r(y)+"})()")}return e.template&&(n.template=e.template),e.skipContent&&(n.skipContent=!0),l(n)}}function o(e){return p.test(e)?e:avalon.parseExpr({expr:e,type:"text"})}function i(e){return"vnodes.push("+e+");"}function l(e){return i(d(e))}function s(e){var t=c(e.nodeValue),n="";if(1===t.length)n=o(t[0].expr);else{var r=t.map(function(e){return e.type?o(e.expr):v(e.expr)}).join(" + ");n="String("+r+")"}return'{\nnodeName: "#text",\ndynamic:true,\nnodeValue: '+n+"\n}"}function c(e){var t=[];do{var n=e.indexOf(f.openTag);n=n===-1?e.length:n;var r=e.slice(0,n);if(/\S/.test(r)&&t.push({expr:avalon._decode(r)}),e=e.slice(n+f.openTag.length)){n=e.indexOf(f.closeTag);var r=e.slice(0,n);t.push({expr:avalon.unescapeHTML(r.replace(y,"")),type:"text"}),e=e.slice(n+f.closeTag.length)}}while(e.length);return t}var u=n(76),d=n(50),f=avalon.config,v=avalon.quote,p=/^[$a-zA-Z_][$a-zA-Z0-9_]*$/,m=/^\s*var\s+([$\w]+)\s*\=\s*\S+/,h={__local__:1,vmode:1,dom:1};e.exports=r;var y=/\n\s*/g},function(e,t){function n(e,t){var n=[],l={},s="ms-skip"in t,c={};for(var u in t){var d,f=t[u];if(l[u]=t[u],d=u.match(o)){if(s)continue;var v=u.replace(d[1],"").split("-");i[v[0]]&&v.unshift("on"),"on"===v[0]&&(v[2]=parseFloat(v[2])||0),v.unshift("ms");var p=v[1];if(a[p]){var m={type:p,param:v[2],name:v.join("-"),expr:f,priority:a[p].priority||100*p.charCodeAt(0)};"on"===p&&(m.priority+=v[3]),c[m.name]||(c[m.name]=f,n.push(m))}}}return e.props=l,n.sort(r),n}function r(e,t){return e.priority-t.priority}var a=avalon.directives,o=/^(\:|ms\-)\w+/,i=avalon.oneObject("animationend,blur,change,input,click,dblclick,focus,keydown,keypress,keyup,mousedown,mouseenter,mouseleave,mousemove,mouseout,mouseover,mouseup,scan,scroll,submit");e.exports=n},function(e,t,n){function r(e){var t=e.expr,n=e.type,r=u.get(n+":"+t);if(r)return avalon.shadowCopy(e,r),r.text;f={};var b={},x={},$=t.replace(w,o);$=d($,o),$=$.replace(m,o).replace(y,"$1").replace(_,"$1__vmodel__.").replace(/\b[\$\w]+\s*:/g,function(e){return o(e)+" "}).replace(/\|(\w+)/g,function(e,t){return"|"+o(t)}).replace(/__vmodel__\.([\$\w\.]+)/g,function(e,t){return b[t]=1,e}),l($,x);var C=$.split(h),E=C.shift(),A=E.replace(v,i);if("js"===n)return a(e,A,b,x);C.length&&(C=C.map(function(e){var t="(__value__";return e=e.replace(p,function(e,n){return/\S/.test(n)&&(t+=","+n),""}).replace(v,i),e.replace(/^(\w+)/,'__value__ =  avalon.__format__("$1")')+t+")"}));var k=[];if("on"===n)g.test(A)&&(A+="($event)"),C=C.map(function(e){return e.replace(/__value__/g,"$event")}),C.length&&C.push("if($event.$return){\n\treturn;\n}"),avalon.modern||(A=A.replace(/__vmodel__\.([^(]+)\(([^)]*)\)/,function(e,t,n){return"__vmodel__."+t+".call(__vmodel__"+(/\S/.test(n)?","+n:"")+")"})),k=["function ($event, __local__){","try{",s(x).join("\n"),"\tvar __vmodel__ = this;","\t"+A,"}catch(e){",c(t,n),"}","}"],C.unshift(2,0);else{if("duplex"===n){var T=["function (__vmodel__,__value__){","try{","\t"+A+" = __value__","}catch(e){",c(t,n).replace("parse","set"),"}","}"];u.put("duplex:set:"+e.expr,T.join("\n"));var O=["function (__vmodel__){","try{","var __value__ = "+A,C.join("\n"),"return __value__","}catch(e){",c(t,n).replace("parse","get"),"}","}"].join("\n");return a(e,O,x,b)}k=["(function (){","try{","var __value__ = "+A.replace(v,i),"text"===n?"return avalon.parsers.string(__value__)":"return __value__","}catch(e){",c(t,n),'\treturn ""',"}","})()"],C.unshift(3,0)}return k.splice.apply(k,C),a(e,k.join("\n"),x,b)}function a(e,t,n,r){var a={text:t,locals:Object.keys(n).join(","),paths:Object.keys(r).join(",")},o=e.type+":"+e.expr;return e.locals=a.locals,e.paths=a.paths,u.put(o,a),t}function o(e){var t="??"+$++;return f[t]=e,t}function i(e){return f[e]}function l(e,t){e.replace(/__vmodel__/," ").replace(b," ").replace(x,function(e){"$event"===e||avalon.keyMap[e]||(t[e]=1)})}function s(e){var t=[];for(var n in e)t.push("var "+n+" = __local__["+avalon.quote(n)+"]");return t}function c(e,t){return"\tavalon.warn(e, "+avalon.quote("parse "+t+" binding【 "+e+" 】fail")+")"}var u=avalon.evaluatorPool,d=n(69),f={},v=/\?\?\d+/g,p=/\(([^)]*)\)/,m=/\|\|/g,h=/\|(?=\?\?)/,y=/\s*(\.|\|)\s*/g,g=/^__vmodel__\.[$\w\.]+$/i,_=/(^|[^\w\u00c0-\uFFFF_])(@|##)(?=[$\w])/g,b=/\.[\w\.\$]+/g,x=/\b[$a-zA-Z_][$a-zA-Z0-9_]*\b/g,w=/(^|[^\/])\/(?!\/)(\[.+?]|\\.|[^\/\\\r\n])+\/[gimyu]{0,5}(?=\s*($|[\r\n,.;})]))/g;e.exports=r;var $=1},function(e,t,n){function r(){}function a(e,t,n){var a={};e.$skipArray&&(a=avalon.oneObject(e.$skipArray),delete e.$skipArray);var o={};n=n||{},t=t||{};var i={},l=g("$"),s=n.pathname||"";n.id=n.id||l,n.hashcode=n.hashcode||l;var d,f,y;for(d in e)if(!v[d]){var _=o[d]=e[d];u(d,_,a)||(f=n.id+"."+d,y=s?s+"."+d:d,i[d]=p(f,y,t))}i.$model=h;var b=new r;b=c(b,i,e);for(d in o)b[d]=o[d],d in a?delete o[d]:o[d]=!0;return m(b,t,o,i,n),b}function o(e,t,n,a){var o={},i={},l={};n=n||{};var s,d,f,y=a.pathname,b=e.$accessors||{};for(s in t)v[s]||(o[s]=!0,u(s,t[s],_)?(i[s]=t[s],delete t[s]):b[s]?l[s]=b[s]:(d=a.id+"."+s,f=y?y+"."+s:s,l[s]=p(d,f,n)));a.hashcode=e.$hashcode||g("$"),l.$model=h;var x=new r;x=c(x,l,i);for(s in i)x[s]=i[s];return m(x,n,o,l,a),x}function i(e,t){for(var n,a,o,i={},l={},s={},d={},f=avalon.slice(arguments),h={},y="function"==typeof this&&this.isWidget,_=0;_<f.length;_++){var b=f[_],x=b.$accessors;for(var n in b)if(b.hasOwnProperty(n)){var w=b[n];"$skipArray"!==n?y&&f.indexOf(w)!==-1?(a=w,o=n):(i[n]=w,l[n]&&avalon.isObject(w)&&delete l[n],x&&x[n]?l[n]=x[n]:"function"!=typeof i[n]&&(s[n]=1)):Array.isArray(w)&&w.forEach(function(e){h[e]=1})}}"function"==typeof this&&this(i,s);for(n in s)v[n]||l[n]||u(n,i[n],h)||(l[n]=p(e.$id,n,d),l[n].set(i[n]));var $=new r;$=c($,l,i);for(n in i){if(l[n]||($[n]=i[n]),y&&a&&l[n]&&a.hasOwnProperty(n)){var C=l[n].get;C.$decompose||(C.$decompose={}),C.$decompose[o+"."+n]=$}n in v?delete i[n]:i[n]=!0}return m($,d,i,l,{id:e.$id,hashcode:g("$"),master:!0}),$}function l(e,t){e.length!==t&&e.notify("length",e.length,t,!0)}var s=n(79),c=n(83),u=s.isSkip,d=s.toJson,f=s.$$midway,v=s.$$skipArray,p=s.makeAccessor,m=s.initViewModel,h=s.modelAccessor,y=s.modelAdaptor,g=avalon.makeHashCode;f.masterFactory=a;var _={};f.slaveFactory=o,f.mediatorFactory=avalon.mediatorFactory=i;var b=s.__array__,x=Array.prototype,w=x.splice;b.removeAll=function(e){var t=this.length;if(Array.isArray(e))for(var n=this.length-1;n>=0;n--)e.indexOf(this[n])!==-1&&w.call(this,n,1);else if("function"==typeof e)for(n=this.length-1;n>=0;n--){var r=this[n];e(r,n)&&w.call(this,n,1)}else w.call(this,0,this.length);avalon.modern||(this.$model=d(this)),l(this,t),this.notify()};var $=["push","pop","shift","unshift","splice"];$.forEach(function(e){var t=x[e];b[e]=function(n,r){var a=[],o=this.length;if("splice"===e&&Object(this[0])===this[0])for(var i=this.slice(n,r),s=x.slice.call(arguments,2),a=[n,r],c=0,u=s.length;c<u;c++){var f=i[c];a[c+2]=y(s[c],f,f&&f.$events||{},{id:this.$id+".*",master:!0})}else for(var v=0,p=arguments.length;v<p;v++)a[v]=y(arguments[v],0,{},{id:this.$id+".*",master:!0});var m=t.apply(this,a);return avalon.modern||(this.$model=d(this)),l(this,o),this.notify(),m}}),"sort,reverse".replace(avalon.rword,function(e){b[e]=function(){return x[e].apply(this,arguments),avalon.modern||(this.$model=d(this)),this.notify(),this}}),e.exports=avalon},function(e,t,n){function r(e){var t=avalon.type(e);if("array"===t){for(var n=[],a=0;a<e.length;a++)n[a]=r(e[a]);return n}if("object"===t){var o={};for(a in e)if("__proxy__"!==a&&"__data__"!==a&&"__const__"!==a&&e.hasOwnProperty(a)){var i=e[a];o[a]=i&&i.nodeType?i:r(i)}return o}return e}function a(e,t,n){c?Object.defineProperty(e,t,{value:n,writable:!0,enumerable:!1,configurable:!0}):e[t]=n}function o(e,t,n,o,s){function c(e){return n[e]===!0}s.array?avalon.modern?Object.defineProperty(e,"$model",d):e.$model=r(e):(a(e,"$accessors",o),a(e,"hasOwnProperty",c),a(e,"$track",Object.keys(n).sort().join(";;"))),a(e,"$id",s.id),a(e,"$hashcode",s.hashcode),s.master===!0&&(a(e,"$run",function(){l.call(e)}),a(e,"$wait",function(){i.call(e)}),a(e,"$element",null),a(e,"$render",0),u(e,t))}function i(){this.$events.$$wait$$=!0}function l(){var e=this.$events;if(delete e.$$wait$$,e.$$dirty$$){delete e.$$dirty$$,avalon.rerenderStart=new Date;var t=this.$id,n=t.indexOf(".");n>0?avalon.batch(t.slice(0,n)):avalon.batch(t)}}var s=n(80),c=n(82),u=s.initEvents,d={get:function(){return r(this)},set:avalon.noop,enumerable:!1,configurable:!0};s.$$midway.initViewModel=o,s.$$midway.hideProperty=a;var f={toJson:r,initViewModel:o,modelAccessor:d};for(var v in s)f[v]=s[v];e.exports=f},function(e,t,n){function r(e,t){t.__vmodel__=e;var n=v.hideProperty;n(e,"$events",t),n(e,"$watch",function(){if(2===arguments.length)return y.apply(e,arguments);throw"$watch方法参数不对"}),n(e,"$fire",function(t,n,r){var a=e.$events[t];h(a,e,t,n,r)})}function a(e,t,n){return"$"===e.charAt(0)||n[e]||g.test(avalon.type(t))||t&&t.nodeName&&t.nodeType>0}function o(e,t,n,r){if(Array.isArray(e))return v.arrayFactory(e,t,n,r);if(Object(e)===e&&"function"!=typeof e){if(t&&t.$id){if(++avalon.suspendUpdate,t.$track!==Object.keys(e).sort().join(";;"))var a=v.slaveFactory(t,e,n,r);else a=t;for(var o in e)p[o]||(a[o]=e[o]);return--avalon.suspendUpdate,a}return a=v.masterFactory(e,n,r)}return e}function i(e,t,n){function r(){return a}var a=NaN;return r.heirloom=n,{get:r,set:function(o){if(a!==o){var i=n.__vmodel__;o&&"object"==typeof o&&(o=v.modelAdaptor(o,a,n,{pathname:t,id:e}));var d=a;if(a=o,this.$hashcode&&i){if(i.$events.$$dirty$$=!0,i.$events.$$wait$$)return;n!==i.$events&&(r.heirloom=i.$events),c(r.$decompose,t,o,d),t.indexOf("*")===-1&&h(r.heirloom[t],i,t,o,d),s(e+"",i,t,o,d),u(r.heirloom,i,t,o,d),i.$events.$$dirty$$=!1,l(i.$id)}}},enumerable:!0,configurable:!0}}function l(e){avalon.rerenderStart=new Date;var t=e.indexOf(".");t>0?avalon.batch(e.slice(0,t)):avalon.batch(e)}function s(e,t,n,r,a){if(e.indexOf(".*.")>0){var o=e.match(_),i=avalon.vmodels[o[1]];if(i){var l=o[2];h(i.$events[l],t,n,r,a)}}}function c(e,t,n,r){if(e&&e[t]){var a=e[t];if(a.$hashcode){var o=t.replace(/^[^.]+\./,"");o!==t&&h(a.$events[o],a,o,n,r)}else delete e[t]}}function u(e,t,n,r,a){e.__fuzzy__&&e.__fuzzy__.replace(avalon.rword,function(o){var i=e[o],l=i.reg;return l&&l.test(n)&&h(i,t,n,r,a),o})}function d(e){var t=e.$id;if(t||avalon.warn("vm.$id must be specified"),avalon.vmodels[t])throw Error("error:["+t+"] had defined!");var n=v.masterFactory(e,{},{pathname:"",id:t,master:!0});return avalon.vmodels[t]=n}function f(e,t,n,r){if(t&&t.splice){var a=[0,t.length].concat(e);return++avalon.suspendUpdate,avalon.callArray=r.pathname,t.splice.apply(t,a),--avalon.suspendUpdate,t}for(var i in b)e[i]=b[i];e.notify=function(e,t,a,o){var i=n.__vmodel__;if(i){var s=null===e||void 0===e?r.pathname:r.pathname+"."+e;i.$fire(s,t,a),o||n.$$wait$$||avalon.suspendUpdate||(avalon.callArray=s,l(i.$id),delete avalon.callArray)}};var s=avalon.makeHashCode("$");r.array=!0,r.hashcode=s,r.id=r.id||s,v.initViewModel(e,n,{},{},r);for(var c=0,u=e.length;c<u;c++)e[c]=o(e[c],0,{},{id:e.$id+".*",master:!0});return e}var v={},p=n(63),m=n(81),h=m.$emit,y=m.$watch,g=/function|window|date|regexp|element/i;v.modelAdaptor=o;var _=/([^.]+)\.(.+)/;v.arrayFactory=f;var b={set:function(e,t){if(e>>>0===e&&this[e]!==t){if(e>this.length)throw Error(e+"set方法的第一个参数不能大于原数组长度");this.splice(e,1,t)}},contains:function(e){return this.indexOf(e)!==-1},ensure:function(e){return this.contains(e)||this.push(e),this},pushArray:function(e){return this.push.apply(this,e)},remove:function(e){return this.removeAt(this.indexOf(e))},removeAt:function(e){return e>>>0===e?this.splice(e,1):[]},clear:function(){return this.removeAll(),this}};avalon.define=d,e.exports={$$midway:v,$$skipArray:p,isSkip:a,__array__:b,initEvents:r,makeAccessor:i,modelAdaptor:o}},function(e,t){function n(e,t){var n,r=t.split(".")[0];try{e.hasOwnProperty(r)&&(n=e.$accessors?e.$accessors[r].get.heirloom.__vmodel__:Object.getOwnPropertyDescriptor(e,r).get.heirloom.__vmodel__)}catch(e){}return n||e}function r(e){var t=e.split(".");return new RegExp("^"+t.map(function(e){return"*"===e?"(?:[^.]+)":e}).join("\\.")+"$","i");
}function a(e,t,n){e&&(t.__fuzzy__?t.__fuzzy__.indexOf(","+n)===-1&&(t.__fuzzy__+=","+n):t.__fuzzy__=n)}function o(e,t){var n=e.indexOf(".*")>0||"*"===e,i=n?this:o.adjust(this,e),l=this.$events,s=l[e]||(l[e]=[]);return n&&(s.reg=s.reg||r(e)),a(n,l,e),i!==this&&a(n,this.$events,e),avalon.Array.ensure(s,t),function(){avalon.Array.remove(s,t)}}function i(e,t,n,r,a,o){if(e&&e.length)try{for(o=o||e.length-1;o>=0;o--){var l=e[o];l.call(t,r,a,n)}}catch(l){o-1>0&&i(e,t,n,r,a,o-1),avalon.log(l,n)}}o.adjust=n,e.exports={$emit:i,$watch:o,adjustVm:n}},function(e,t){var n=!0;try{Object.defineProperty({},"_",{value:"x"})}catch(e){n=!1}e.exports=n},function(e,t,n){function r(e,t,n,r){var a=t[n];return 4!==arguments.length?a.get.call(e):void a.set.call(e,r)}var a,o=n(82),i=n(63),l=Object.defineProperties,s=new Date-0;if(!o&&("__defineGetter__"in avalon&&(a=function(e,t,n){return"value"in n&&(e[t]=n.value),"get"in n&&e.__defineGetter__(t,n.get),"set"in n&&e.__defineSetter__(t,n.set),e},l=function(e,t){for(var n in t)t.hasOwnProperty(n)&&a(e,n,t[n]);return e}),avalon.msie)){var c={};window.execScript(["Function parseVB(code)","\tExecuteGlobal(code)","End Function"].join("\n"),"VBScript"),l=function(e,t,n){var a=[];a.push("\r\n\tPrivate [__data__], [__proxy__]","\tPublic Default Function [__const__](d"+s+", p"+s+")","\t\tSet [__data__] = d"+s+": set [__proxy__] = p"+s,"\t\tSet [__const__] = Me","\tEnd Function");var o={__proxy__:!0,__data__:!0,__const__:!0};for(e in t)o[e]||i[e]&&"$model"!==e||(o[e]=!0,a.push("\tPublic Property Let ["+e+"](val"+s+")",'\t\tCall [__proxy__](Me,[__data__], "'+e+'", val'+s+")","\tEnd Property","\tPublic Property Set ["+e+"](val"+s+")",'\t\tCall [__proxy__](Me,[__data__], "'+e+'", val'+s+")","\tEnd Property","\tPublic Property Get ["+e+"]","\tOn Error Resume Next","\t\tSet["+e+'] = [__proxy__](Me,[__data__],"'+e+'")',"\tIf Err.Number <> 0 Then","\t\t["+e+'] = [__proxy__](Me,[__data__],"'+e+'")',"\tEnd If","\tOn Error Goto 0","\tEnd Property"));for(e in n)o[e]||i[e]||(o[e]=!0,a.push("\tPublic ["+e+"]"));for(e in i)o[e]||a.push("\tPublic ["+e+"]");a.push("\tPublic [hasOwnProperty]"),a.push("End Class");var l=a.join("\r\n"),u=c[l];u||(u=avalon.makeHashCode("VBClass"),window.parseVB("Class "+u+l),window.parseVB(["Function "+u+"Factory(a, b)","\tDim o","\tSet o = (New "+u+")(a, b)","\tSet "+u+"Factory = o","End Function"].join("\r\n")),c[l]=u);var d=window[u+"Factory"](t,r);return d}}e.exports=l}])});
//# sourceMappingURL=avalon.min.js.map