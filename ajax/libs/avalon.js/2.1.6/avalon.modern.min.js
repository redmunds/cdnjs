!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.avalon=t():e.avalon=t()}(this,function(){return function(e){function t(a){if(n[a])return n[a].exports;var r=n[a]={exports:{},id:a,loaded:!1};return e[a].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){var a=n(84);n(9),n(86),n(88),n(96),n(67),n(101),e.exports=a},,,function(e,t,n){var a=n(4),r=Function(" return this")()||this,o={window:r,document:{createElement:Object,createElementNS:Object,contains:Boolean},root:{outerHTML:"x"},msie:NaN,browser:!1,modern:!0,avalonDiv:{},avalonFragment:null};if(r.avalon=a,r.location&&r.navigator&&r.window){var i=r.document;o.browser=!0,o.document=i,o.root=i.documentElement,o.avalonDiv=i.createElement("div"),o.avalonFragment=i.createDocumentFragment(),r.VBArray?(o.msie=i.documentMode||(r.XMLHttpRequest?7:6),o.modern=o.msie>8):o.modern=!0}a.shadowCopy(a,o)},function(e,t){function n(e){return new n.init(e)}n.init=function(e){this[0]=this.element=e},n.fn=n.prototype=n.init.prototype,n.shadowCopy=function(e,t){for(var n in t)e[n]=t[n];return e};var a=/[^, ]+/g,r="object"==typeof console;n.shadowCopy(n,{noop:function(){},version:"2.115",rword:a,inspect:{}.toString,ohasOwn:{}.hasOwnProperty,log:function(){r&&n.config.debug&&Function.apply.call(console.log,console,arguments)},warn:function(){if(r&&n.config.debug){var e=console.warn||console.log;Function.apply.call(e,console,arguments)}},error:function(e,t){throw(t||Error)(e)},oneObject:function(e,t){"string"==typeof e&&(e=e.match(a)||[]);for(var n={},r=void 0!==t?t:1,o=0,i=e.length;o<i;o++)n[e[o]]=r;return n}}),e.exports=n},,function(e,t,n){function a(e,t,n){e[n.name]=r.parseExpr(n)}var r=n(4),o={},i=/([a-z\d])([A-Z]+)/g,s=/[-_][^-_]/g,l=/\d\.\d{4}/,c=/[-.*+?^${}()|[\]\/\\]/g,u=n(7),d=[].slice,f=/&[a-z0-9#]{2,10};/,v=r.avalonDiv;r.shadowCopy(r,{caches:{},vmodels:{},filters:{},components:{},directives:{},eventHooks:{},eventListeners:{},validators:{},scopes:{},evaluatorPool:new u(888),_decode:function(e){return f.test(e)?(v.innerHTML=e,v.innerText||v.textContent):e},cssHooks:o,parsers:{number:function(e){return""===e?"":parseFloat(e)||0},string:function(e){return null===e||void 0===e?"":e+""},boolean:function(e){return""===e?e:"true"===e||"1"==e}},slice:function(e,t,n){return d.call(e,t,n)},css:function(e,t,n,a){if(e instanceof r&&(e=e[0]),1===e.nodeType){var i=r.camelize(t);if(t=r.cssName(i)||i,void 0===n||"boolean"==typeof n){a=o[i+":get"]||o["@:get"],"background"===t&&(t="backgroundColor");var s=a(e,t);return n===!0?parseFloat(s)||0:s}if(""===n)e.style[t]="";else{if(null==n||n!==n)return;isFinite(n)&&!r.cssNumber[i]&&(n+="px"),a=o[i+":set"]||o["@:set"],a(e,t,n)}}},directive:function(e,t){return t.parse=t.parse||a,this.directives[e]=t},isObject:function(e){return null!==e&&"object"==typeof e},range:function(e,t,n){n||(n=1),null==t&&(t=e||0,e=0);for(var a=-1,r=Math.max(0,Math.ceil((t-e)/n)),o=new Array(r);++a<r;)o[a]=e,e+=n;return o},hyphen:function(e){return e.replace(i,"$1-$2").toLowerCase()},camelize:function(e){return!e||e.indexOf("-")<0&&e.indexOf("_")<0?e:e.replace(s,function(e){return e.charAt(1).toUpperCase()})},makeHashCode:function(e){return e=e||"avalon",String(Math.random()+Math.random()).replace(l,e)},escapeRegExp:function(e){return(e+"").replace(c,"\\$&")},Array:{merge:function(e,t){e.push.apply(e,t)},ensure:function(e,t){if(e.indexOf(t)===-1)return e.push(t)},removeAt:function(e,t){return!!e.splice(t,1).length},remove:function(e,t){var n=e.indexOf(t);return!!~n&&r.Array.removeAt(e,n)}}});var p=1;e.exports={avalon:r,getLongID:function(e){return e.uuid||(e.uuid=r.makeHashCode("e"))},getShortID:function(e){return e.uuid||(e.uuid="_"+ ++p)}}},function(e,t){function n(e){this.size=0,this.limit=e,this.head=this.tail=void 0,this._keymap={}}var a=n.prototype;a.put=function(e,t){var n={key:e,value:t};return this._keymap[e]=n,this.tail?(this.tail.newer=n,n.older=this.tail):this.head=n,this.tail=n,this.size===this.limit?this.shift():this.size++,t},a.shift=function(){var e=this.head;e&&(this.head=this.head.newer,this.head.older=e.newer=e.older=this._keymap[e.key]=void 0,delete this._keymap[e.key],this.size--)},a.get=function(e){var t=this._keymap[e];if(void 0!==t)return t===this.tail?t.value:(t.newer&&(t===this.head&&(this.head=t.newer),t.newer.older=t.older),t.older&&(t.older.newer=t.newer),t.newer=void 0,t.older=this.tail,this.tail&&(this.tail.newer=t),this.tail=t,t.value)},e.exports=n},function(e,t,n){function a(e){for(var t in e)if(r.ohasOwn.call(e,t)){var n=e[t];"function"==typeof a.plugins[t]?a.plugins[t](n):a[t]=n}return this}var r=n(4);r.config=a;var o={interpolate:function(e){var t=e[0],n=e[1];if(t===n)throw new SyntaxError("openTag!==closeTag");var o=t+"test"+n,i=r.avalonDiv;if(i.innerHTML=o,i.innerHTML!==o&&i.innerHTML.indexOf("&lt;")>-1)throw new SyntaxError("此定界符不合法");i.innerHTML="",a.openTag=t,a.closeTag=n;var s=r.escapeRegExp(t),l=r.escapeRegExp(n);a.rexpr=new RegExp(s+"([\\s\\S]*)"+l)}};a.plugins=o,r.config({interpolate:["{{","}}"],debug:!0}),e.exports=r},function(e,t,n){function a(e){return e}var r=n(4),o=n(10),i=n(11),s=n(12),l=n(13),c=n(14),u=r.filters,d=r.escapeHtml=n(15);r.__format__=function(e){var t=u[e];return t?t:a},r.mix(u,{uppercase:function(e){return String(e).toUpperCase()},lowercase:function(e){return String(e).toLowerCase()},truncate:function(e,t,n){return e?(e=String(e),isNaN(t)&&(t=30),n="string"==typeof n?n:"...",e.length>t?e.slice(0,t-n.length)+n:e):""},camelize:r.camelize,date:s,escape:d,sanitize:i,number:o,currency:function(e,t,n){return(t||"¥")+o(e,isFinite(n)?n:2)}},l,c),e.exports=r},function(e,t){function n(e,t,n,a){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var r=isFinite(+e)?+e:0,o=isFinite(+t)?Math.abs(t):3,i=a||",",s=n||".",l="",c=function(e,t){var n=Math.pow(10,t);return""+(Math.round(e*n)/n).toFixed(t)};return l=(o?c(r,o):""+Math.round(r)).split("."),l[0].length>3&&(l[0]=l[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,i)),(l[1]||"").length<o&&(l[1]=l[1]||"",l[1]+=new Array(o-l[1].length+1).join("0")),l.join(s)}e.exports=n},function(e,t){var n=/<script[^>]*>([\S\s]*?)<\/script\s*>/gim,a=/\s+(on[^=\s]+)(?:=("[^"]*"|'[^']*'|[^\s>]+))?/g,r=/<\w+\b(?:(["'])[^"]*?(\1)|[^>])*>/gi,o={a:/\b(href)\=("javascript[^"]*"|'javascript[^']*')/gi,img:/\b(src)\=("javascript[^"]*"|'javascript[^']*')/gi,form:/\b(action)\=("javascript[^"]*"|'javascript[^']*')/gi};e.exports=function(e){return e.replace(n,"").replace(r,function(e,t){var n=e.toLowerCase().match(/<(\w+)\s/);if(n){var r=o[n[1]];r&&(e=e.replace(r,function(e,t,n){var a=n.charAt(0);return t+"="+a+"javascript:void(0)"+a}))}return e.replace(a," ").replace(/\s+/g," ")})}},function(e,t){function n(e){return parseInt(e,10)||0}function a(e,t,n){var a="";for(e<0&&(a="-",e=-e),e=""+e;e.length<t;)e="0"+e;return n&&(e=e.substr(e.length-t)),a+e}function r(e,t,n,r){return function(o){var i=o["get"+e]();return(n>0||i>-n)&&(i+=n),0===i&&n===-12&&(i=12),a(i,t,r)}}function o(e,t){return function(n,a){var r=n["get"+e](),o=(t?"SHORT"+e:e).toUpperCase();return a[o][r]}}function i(e){var t=-1*e.getTimezoneOffset(),n=t>=0?"+":"";return n+=a(Math[t>0?"floor":"ceil"](t/60),2)+a(Math.abs(t%60),2)}function s(e,t){return e.getHours()<12?t.AMPMS[0]:t.AMPMS[1]}function l(e,t){var a,r,o=l.locate,i="",s=[];if(t=t||"mediumDate",t=o[t]||t,"string"==typeof e)if(/^\d+$/.test(e))e=n(e);else if(d.test(e))e=+RegExp.$1;else{var f=e.trim(),v=[0,0,0,0,0,0,0],p=new Date(0);f=f.replace(/^(\d+)\D(\d+)\D(\d+)/,function(e,t,a,r){var o=4===r.length?[r,t,a]:[t,a,r];return v[0]=n(o[0]),v[1]=n(o[1])-1,v[2]=n(o[2]),""});var m=p.setFullYear,h=p.setHours;f=f.replace(/[T\s](\d+):(\d+):?(\d+)?\.?(\d)?/,function(e,t,a,r,o){return v[3]=n(t),v[4]=n(a),v[5]=n(r),o&&(v[6]=Math.round(1e3*parseFloat("0."+o))),""});var g=0,y=0;f=f.replace(/Z|([+-])(\d\d):?(\d\d)/,function(e,t,a,r){return m=p.setUTCFullYear,h=p.setUTCHours,t&&(g=n(t+a),y=n(t+r)),""}),v[3]-=g,v[4]-=y,m.apply(p,v.slice(0,3)),h.apply(p,v.slice(3)),e=p}for("number"==typeof e&&(e=new Date(e));t;)r=u.exec(t),r?(s=s.concat(r.slice(1)),t=s.pop()):(s.push(t),t=null);return s.forEach(function(t){a=c[t],i+=a?a(e,o):t.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),i}var c=(Object.prototype.toString,{yyyy:r("FullYear",4),yy:r("FullYear",2,0,!0),y:r("FullYear",1),MMMM:o("Month"),MMM:o("Month",!0),MM:r("Month",2,1),M:r("Month",1,1),dd:r("Date",2),d:r("Date",1),HH:r("Hours",2),H:r("Hours",1),hh:r("Hours",2,-12),h:r("Hours",1,-12),mm:r("Minutes",2),m:r("Minutes",1),ss:r("Seconds",2),s:r("Seconds",1),sss:r("Milliseconds",3),EEEE:o("Day"),EEE:o("Day",!0),a:s,Z:i}),u=/((?:[^yMdHhmsaZE']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z))(.*)/,d=/^\/Date\((\d+)\)\/$/,f={AMPMS:{0:"上午",1:"下午"},DAY:{0:"星期日",1:"星期一",2:"星期二",3:"星期三",4:"星期四",5:"星期五",6:"星期六"},MONTH:{0:"1月",1:"2月",2:"3月",3:"4月",4:"5月",5:"6月",6:"7月",7:"8月",8:"9月",9:"10月",10:"11月",11:"12月"},SHORTDAY:{0:"周日",1:"周一",2:"周二",3:"周三",4:"周四",5:"周五",6:"周六"},fullDate:"y年M月d日EEEE",longDate:"y年M月d日",medium:"yyyy-M-d H:mm:ss",mediumDate:"yyyy-M-d",mediumTime:"H:mm:ss",short:"yy-M-d ah:mm",shortDate:"yy-M-d",shortTime:"ah:mm"};f.SHORTMONTH=f.MONTH,l.locate=f,e.exports=l},function(e,t,n){function a(e,t,n){var a=c.type(e);if("array"!==a&&"object"!==a)throw"orderBy只能处理对象或数组";var r=n&&n<0?-1:1;if("string"==typeof t){var o=t;t=function(e){return e&&e[o]}}e=l(e),e.forEach(function(e){e.order=t(e.value,e.key)}),e.sort(function(e,t){var n=e.order,a=t.order;return Number.isNaN(n)&&Number.isNaN(a)?0:n===a?0:n>a?r:-r});var i="array"===a,u=i?[]:{};return s(u,e,function(e){i?u.push(e.value):u[e.key]=e.value})}function r(e,t){var n=c.type(e);if("array"!==n&&"object"!==n)throw"filterBy只能处理对象或数组";var a=c.slice(arguments,2),r=c.type(t);if("function"===r)var o=t;else{if("string"!==r&&"number"!==r)return e;if(""===t)return e;var i=new RegExp(c.escapeRegExp(t),"i");o=function(e){return i.test(e)}}e=l(e).filter(function(e,t){return!!o.apply(e,[e.value,t].concat(a))});var u="array"===n,d=u?[]:{};return s(d,e,function(e){u?d.push(e.value):d[e.key]=e.value})}function o(e,t,n){if(c.isObject(e)&&!Array.isArray(e)){var a=[];return s(a,t,function(t){a.push(e.hasOwnProperty(t)?e[t]:n?n[t]:"")})}return e}function i(e,t,n){var a=c.type(e);if("array"!==a&&"object"!==a)throw"limitBy只能处理对象或数组";if("number"!=typeof t)return e;if(Number.isNaN(t))return e;"object"===a&&(e=l(e));var r=e.length;t=Math.floor(Math.min(r,t)),n="number"==typeof n?n:0,n<0&&(n=Math.max(0,r+n));for(var o=[],i=n;i<r&&o.length!==t;i++)o.push(e[i]);var u="array"===a;if(u)return o;var d={};return s(d,o,function(e){d[e.key]=e.value})}function s(e,t,n){for(var a=0,r=t.length;a<r;a++)n(t[a]);return e}function l(e){var t=[],n=0;return c.each(e,function(e,a){t[n++]={value:a,key:e}}),t}var c=n(4);Number.isNaN=Number.isNaN||function(e){return e!==e},e.exports={limitBy:i,orderBy:a,selectBy:o,filterBy:r}},function(e,t){var n={stop:function(e){return e.stopPropagation(),e},prevent:function(e){return e.preventDefault(),e}},a={esc:27,tab:9,enter:13,space:32,del:46,up:38,left:37,right:39,down:40};for(var r in a)!function(e,t){n[e]=function(e){return e.which!==t&&(e.$return=!0),e}}(r,a[r]);e.exports=n},function(e,t){function n(e){return null==e?"":String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}e.exports=n},,function(e,t){function n(e){this.nodeName="#text",this.nodeValue=e,this.skipContent=!a.test(e)}var a=avalon.config.rexpr;n.prototype={constructor:n,toDOM:function(){if(this.dom)return this.dom;var e=avalon._decode(this.nodeValue);return this.dom=document.createTextNode(e)},toHTML:function(){return this.nodeValue}},e.exports=n},function(e,t){function n(e){this.nodeName="#comment",this.nodeValue=e}n.prototype={constructor:n,toDOM:function(){return this.dom=document.createComment(this.nodeValue)},toHTML:function(){return"<!--"+this.nodeValue+"-->"}},e.exports=n},,function(e,t){function n(e){this.nodeName="#document-fragment",this.children=e}n.prototype={constructor:n,toDOM:function(){if(this.dom)return this.dom;for(var e,t=document.createDocumentFragment(),n=0;e=this.children[n++];)t.appendChild(avalon.vdom(e,"toDOM"));return this.split=t.lastChild,this.dom=t},toHTML:function(){return this.children.map(function(e){return avalon.vdom(e,"toHTML")}).join("")}},e.exports=n},,,,,,function(e,t){var n={"accept-charset":"acceptCharset",char:"ch",charoff:"chOff",class:"className",for:"htmlFor","http-equiv":"httpEquiv"},a=["autofocus,autoplay,async,allowTransparency,checked,controls","declare,disabled,defer,defaultChecked,defaultSelected,","isMap,loop,multiple,noHref,noResize,noShade","open,readOnly,selected"].join(",");a.replace(/\w+/g,function(e){n[e.toLowerCase()]=e});var r=["accessKey,bgColor,cellPadding,cellSpacing,codeBase,codeType,colSpan","dateTime,defaultValue,contentEditable,frameBorder,longDesc,maxLength,marginWidth,marginHeight,rowSpan,tabIndex,useMap,vSpace,valueType,vAlign"].join(",");r.replace(/\w+/g,function(e){n[e.toLowerCase()]=e}),e.exports=n},,,,function(e,t,n){var a=n(7),r=n(4),o=/<|&#?\w+;/,i=new a(128),s=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi;r.parseHTML=function(e){var t=r.avalonFragment.cloneNode(!1);if("string"!=typeof e)return t;if(!o.test(e))return document.createTextNode(e);e=e.replace(s,"<$1></$2>").trim();var n=i.get(e);if(n)return r.cloneNode(n);for(var a,l=r.lexer(e),c=0;a=l[c++];)t.appendChild(r.vdom(a,"toDOM"));return e.length<1024&&i.put(e,t),t},r.innerHTML=function(e,t){var n=this.parseHTML(t);this.clearHTML(e).appendChild(n)},r.unescapeHTML=function(e){return String(e).replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")},r.clearHTML=function(e){for(e.textContent="";e.lastChild;)e.removeChild(e.lastChild);return e}},,function(e,t){e.exports={click:!0,dblclick:!0,keydown:!0,keypress:!0,keyup:!0,mousedown:!0,mousemove:!0,mouseup:!0,mouseover:!0,mouseout:!0,wheel:!0,mousewheel:!0,input:!0,change:!0,beforeinput:!0,compositionstart:!0,compositionupdate:!0,compositionend:!0,select:!0,cut:!0,copy:!0,paste:!0,beforecut:!0,beforecopy:!0,beforepaste:!0,focusin:!0,focusout:!0,DOMFocusIn:!0,DOMFocusOut:!0,DOMActivate:!0,dragend:!0,datasetchanged:!0}},,function(e,t,n){function a(e){for(var t,n=0;t=e[n++];)if(1===t.nodeType){var s=r(t),l=avalon.vmodels[s];if(l&&!l.$element){if(l.$element=t,avalon.serverTemplates&&avalon.serverTemplates[s]){var c=avalon.serverTemplates[s],u=avalon.speedUp(avalon.lexer(c)),d=avalon.render(u),f=d(l),v=avalon.vdom(f[0],"toDOM");l.$element=v,v.vtree=f,l.$render=d,t.parentNode.replaceChild(v,t),avalon.diff(f,f);continue}var f=[i(t)],p=new Date;t.vtree=avalon.speedUp(f);var m=new Date;o&&avalon.log("构建虚拟DOM耗时",m-p,"ms"),l.$render=avalon.render(t.vtree),avalon.scopes[l.$id]={vmodel:l,local:{},isTemp:!0};var h=new Date;o&&avalon.log("构建当前vm的$render方法耗时 ",h-m,"ms\n","如果此时间太长,达100ms以上\n","建议将当前ms-controller拆分成多个ms-controller,减少每个vm管辖的区域"),avalon.rerenderStart=h,o=!1,avalon.batch(s)}else s||a(t.childNodes)}}function r(e){return e.getAttribute("ms-controller")||e.getAttribute(":controller")}var o=!0,i=n(35);e.exports=avalon.scan=function(e){return e&&e.nodeType?void a([e]):void avalon.warn("[avalon.scan] first argument must be element , documentFragment, or document")},avalon.scan.dom2vdom=avalon._hydrate=i},function(e,t,n){function a(e){var t={},n=e.nodeName.toLowerCase();if(t.nodeName=n,t.dom=e,"#"===n.charAt(0)){var a=e.nodeValue;/\S/.test(a)&&(t.nodeValue=a)}else{var o=r(e);s[n]&&(t.isVoidTag=!0),t.children=i(e),o&&("selectedIndex"in o&&(e.selectedIndex=o.selectedIndex,delete o.selectedIndex),t.props=o)}return t}function r(e){for(var t=e.attributes,n={},a=0,r=t.length;a<r;a++){var i=t[a];if(i.specified){var s=i.name;":"===s.charAt(0)&&(s=s.replace(c,"ms-")),n[s]=i.value}}l.test(e.nodeName)&&(n.type=e.type);var u=e.style.cssText;return u&&(n.style=u),"select-one"===n.type&&(n.selectedIndex=e.selectedIndex),o(n)?null:n}function o(e){for(var t in e)return!1;return!0}function i(e){var t=[],n=e.firstChild;if(!n)return t;do{var r=n.nextSibling;switch(n.nodeType){case 1:var o=n.getAttributeNode(":for")||n.getAttributeNode("ms-for");if(o){var i=document.createComment("ms-for:"+o.value),s=document.createComment("ms-for-end:");n.removeAttributeNode(o),e&&(e.insertBefore(s,n.nextSibling),e.insertBefore(i,n)),t.push(a(i),a(n),a(s))}else t.push(a(n));break;case 3:if(/\S/.test(n.nodeValue))t.push(a(n));else{var l=n.parentNode;l&&l.removeChild(n)}break;case 8:t.push(a(n))}n=r}while(n);return t}var s=n(36);e.exports=a;var l=/input|textarea|select/i,c=/^\:/},function(e,t){e.exports=avalon.oneObject("area,base,basefont,bgsound,br,col,command,embed,frame,hr,img,input,keygen,link,meta,param,source,track,wbr")},,function(e,t,n){var a=n(39);avalon.directive("important",{priority:1,parse:function(e,t,n){var a=avalon.quote(n.expr);e.local="{}",e.vmodel="__vmodel__",e[n.name]=1;var r="(function(){ return __vmodel__ = avalon.vmodels["+a+"]})()";t.$prepend=["(function(__vmodel__){","var __i = avalon.scopes["+a+"]","var ok = !__i || __i.vmodel === __vmodel__",'if( !ok ){avalon.log("不进入"+'+a+");return }"].join("\n")+"\n"+r,t.$append="\n})(__vmodel__);"},diff:function(e,t,n){t.dynamic[n]||(t.local=e.local,t.vmodel=e.vmodel,a(t,this.update))},update:function(e,t,n){avalon.directives.controller.update(e,t,n,"important")}})},function(e,t){e.exports=function(e,t,n){if(n)e.afterChange=e.afterChange||[],avalon.Array.ensure(e.afterChange,t);else{var a=e.dom;t(e.dom,e,a&&a.parentNode)}}},function(e,t,n){var a=n(39),r={};avalon.mediatorFactoryCache=function(e,t){var n=avalon.vmodels[t];if(n&&e&&n!==e){var a=e.$hashcode,o=n.$hashcode,i=a+o;if(r[i])return r[i];var s=avalon.mediatorFactory(e,n);return r[i]=s}return e},avalon.directive("controller",{priority:2,parse:function(e,t,n){var a=avalon.quote(n.expr);e.local="__local__",e.vmodel="__vmodel__",e[n.name]=1,t.$prepend="(function(__top__){\nvar __vmodel__ = avalon.mediatorFactoryCache(__top__,"+a+")\n",t.$append="\n})(__vmodel__);"},diff:function(e,t,n){t.dynamic[n]||(t.local=e.local,t.vmodel=e.vmodel,a(t,this.update))},update:function(e,t,n,r){var o=t.vmodel,i=t.local,s=r?"ms-important":"ms-controller";t.dynamic[s]=1;var l=t.props[s],c=avalon.scopes[l];if(!c){var u=avalon.vmodels[l];if(o.$element&&o.$element.vtree[0]===t)var d=o.$render;else d=avalon.render([t],i);o.$render=d,o.$element=e,e.vtree=[t],u!==o&&(u.$render=u.$render||d,u.$element=u.$element||e);var f=r?o:u,c=avalon.scopes[l]={vmodel:o,local:i};a(t,function(){avalon(e).removeClass("ms-controller"),e.setAttribute("wid",l),avalon._disposeComponent(e);var t=f.$events.onReady;t&&(f.$fire("onReady"),delete f.$events.onReady),c.isMount=!0},"afterChange")}}})},,function(e,t,n){var a=n(39);avalon.directive("css",{diff:function(e,t,n){var r=e[n],o=t[n];if(Object(r)===r){if(r=r.$model||r,Array.isArray(r)){var i={};r.forEach(function(e){e&&avalon.shadowCopy(i,e)}),r=i}var s=!1;if(t.dynamic[n]&&o){var l={};for(var c in r)r[c]!==o[c]&&(s=!0),l[c]=r[c];for(var c in o)c in l||(s=!0,l[c]="");t[n]=l}else t[n]=r,s=!0;s&&a(t,this.update)}delete e[n]},update:function(e,t){if(e&&1===e.nodeType){var n=avalon(e);t.dynamic["ms-css"]=1;var a=t["ms-css"];for(var r in a)n.css(r,a[r])}}}),e.exports=avalon.directives.css},function(e,t,n){function a(e,t){var n=e.ownerDocument,r=e.nodeName,i="_"+r;if(!a[i]){var s=n.body.appendChild(n.createElement(r));t=avalon.css(s,"display"),n.body.removeChild(s),t===o&&(t="block"),a[i]=t}return a[i]}var r=n(39),o="none";avalon.parseDisplay=a,avalon.directive("visible",{diff:function(e,t,n){var a=!!e[n];t.dynamic[n]&&a===t[n]||(t[n]=a,r(t,this.update))},update:function(e,t){function n(){void 0!==r&&(e.style.display=r)}if(e&&1===e.nodeType){t.dynamic["ms-visible"]=1;var r,i=t["ms-visible"],s=e.style.display;i?(s===o&&(r=t.displayValue,r||(e.style.display="")),""===e.style.display&&avalon(e).css("display")===o&&avalon.contains(e.ownerDocument,e)&&(r=a(e))):s!==o&&(r=o,t.displayValue=s),avalon.applyEffect(e,t,{hook:i?"onEnterDone":"onLeaveDone",cb:n})}}})},function(e,t,n){n(39);avalon.directive("expr",{parse:avalon.noop})},function(e,t,n){var a=n(39);avalon.directive("text",{parse:function(e,t,n){e[n.name]=1,t.children=[],e.children='[{\nnodeName:"#text",\ndynamic:true,\nnodeValue:avalon.parsers.string('+avalon.parseExpr(n)+")}]"},diff:function(e,t){t.children.length||a(t,this.update)},update:function(e,t){if(e&&!t.isVoidTag){for(var n=e;n.firstChild;)n.removeChild(n.firstChild);var e=document.createTextNode("x");n.appendChild(e);var a={nodeType:3,nodeName:"#text",dom:e};t.children.push(a)}}})},function(e,t,n){var a=n(39);avalon.directive("html",{parse:function(e,t,n){t.isVoidTag?e.children="[]":(e[n.name]=avalon.parseExpr(n),e.vmodel="__vmodel__",e.local="__local__")},diff:function(e,t,n){var r=e[n]+"";if(t.dynamic["ms-html"]&&t.render&&r===t[n]){if(t.render){var o=t.render(e.vmodel,e.local);e.children=o}}else{t[n]=r;var i=avalon.speedUp(avalon.lexer(r)),s=avalon.render(i,e.local);t.render=s;var o=s(e.vmodel,e.local);t.children=e.children=o,a(t,this.update)}},update:function(e,t){t.dynamic["ms-html"]=1,avalon.clearHTML(e),e.appendChild(avalon.domize(t.children))}})},function(e,t,n){function a(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t],r=typeof n;if("string"===r||"number"===r||n===!0)e.push(n);else if(Array.isArray(n))e.push(a.apply(null,n));else if("object"===r)for(var o in n)n.hasOwnProperty(o)&&n[o]&&e.push(o)}return e.join(" ")}function r(e){var t=e.target;avalon(t).addClass(t.getAttribute(u[e.type])||"")}function o(e){var t=e.target,n=u[e.type];avalon(t).removeClass(t.getAttribute(n)||""),"change-active"!==n&&avalon(t).removeClass(t.getAttribute("change-active")||"")}function i(e,t){var n=e.getAttribute("old-change-class"),a=t["ms-class"];n!==a&&(avalon(e).removeClass(n).addClass(a),e.setAttribute("old-change-class",a))}var s=n(6).getLongID,l=n(39),c=avalon.directives;avalon.directive("class",{diff:function(e,t,n){var i=n.slice(3),s=e[n],c=t[n]||"",u=t.classEvent||{};"hover"===i?(u.mouseenter=r,u.mouseleave=o):"active"===i&&(t.props.tabindex=e.props.tabindex||-1,u.tabIndex=t.props.tabindex,u.mousedown=r,u.mouseup=o,u.mouseleave=o),t.classEvent=u;var d=a(s);t.dynamic[n]&&c===d||(t[n]=d,t["change-"+i]=d,l(t,this.update,i))},update:function(e,t){if(e&&1===e.nodeType){var n=t.classEvent;if(n){for(var a in n)"tabIndex"===a?e[a]=n[a]:avalon.bind(e,a,n[a]);t.classEvent={}}var r=["class","hover","active"];r.forEach(function(n){var a="change-"+n,r=t[a];if(void 0!==r)if(t.dynamic["ms-"+n]=1,"class"===n)e&&i(e,t);else{var o=e.getAttribute("change-"+n);o&&avalon(e).removeClass(o),e.setAttribute(a,r)}})}}}),c.active=c.hover=c.class;var u={mouseenter:"change-hover",mouseleave:"change-hover",mousedown:"change-active",mouseup:"change-active"};s(r),s(o)},function(e,t,n){function a(e,t){for(var n in e)if(e[n]!==t[n])return!0;return!1}var r=n(7),o=(new r(128),n(39)),i=(n(6).getLongID,/^ms\-on\-(\w+)/);avalon.directive("on",{priority:3e3,parse:function(e,t,n){var a=n.name.replace("ms-on-","e").replace("-","_"),r=a+"_"+n.expr.replace(/\s/g,"").replace(/[^$a-z]/gi,function(e){return e.charCodeAt(0)}),o=avalon.quote(r),i="(function(){\nvar fn610 = "+avalon.parseExpr(n)+"\nfn610.uuid ="+o+";\nreturn fn610})()";e.vmodel="__vmodel__",e.local="__local__",e[n.name]=i},diff:function(e,t,n){var r=e[n],i=r.uuid,s=t[n]||{},l=!1;t.dynamic[n]&&s.uuid===i||(t[n]=r,avalon.eventListeners[i]=r,l=!0),a(t.local||{},e.local)&&(l=!0),l&&(t.local=e.local,t.vmodel=e.vmodel,o(t,this.update))},update:function(e,t){if(e&&1===e.nodeType){var n,a;e._ms_context_=t.vmodel,e._ms_local=t.local;for(n in t){var r=n.match(i);r&&(a=t[n],t.dynamic[n]=1,avalon.bind(e,r[1],a))}}}})},,function(e,t){function n(e){return i.test(e)||r[e]?s(e):e}function a(e){var t=[];for(var r in e){var i=typeof e[r];if("object"===i)if("props"===r){var l=[];for(var c in e.props){var u=e.props[c];"string"==typeof u&&(u=s(u)),l.push(n(c)+": "+u)}t.push(r+": {"+l.join(",\n")+"}")}else"children"===r&&t.push("children: ["+e[r].map(function(e){return a(e)})+"]");else if(e.hasOwnProperty(r)){var d=e[r];"string"===i&&(d=o[r]?s(d):d),t.push(n(r)+":"+d)}}return"{\n"+t.join(",\n")+"}"}var r=avalon.oneObject("break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile");avalon.keyMap=r;var o={nodeName:1,template:1,forExpr:1,type:1,nodeValue:1,signature:1,wid:1},i=/[W\:-]/,s=avalon.quote;e.exports=a},,function(e,t,n){function a(e){var t=this,n=this.__ms_duplex__;if(!t.composing&&t.value!==n.value){if(t.caret)try{var a=n.getCaret(t);n.pos=a}catch(e){avalon.warn("fixCaret error",e)}if(n.debounceTime>4){var o=new Date,i=o-n.time||0;n.time=o,i>=n.debounceTime?r[n.type].call(n):(clearTimeout(n.debounceID),n.debounceID=setTimeout(function(){r[n.type].call(n)},i))}else r[n.type].call(n)}}var r=n(53);e.exports=a},function(e,t){function n(e){e.callback&&e.callback.call(e.vmodel,{type:"changed",target:e.dom})}var a={input:function(e){var t=this;e=e||"value";var a=t.dom,r=a[e],o=t.parse(r);t.value=r,t.set(t.vmodel,o),n(t);var i=t.pos;a.caret&&t.setCaret(a,i)},radio:function(){var e=this;if(e.isChecked){var t=!e.value;e.set(e.vmodel,t),n(e)}else a.input.call(e),e.value=NaN},checkbox:function(){var e=this,t=e.value;Array.isArray(t)||(avalon.warn("ms-duplex应用于checkbox上要对应一个数组"),t=[t]);var a=e.dom.checked?"ensure":"remove";if(t[a]){var r=e.parse(e.dom.value);t[a](r),n(e)}},select:function(){var e=this,t=avalon(e.dom).val();t+""!=this.value+""&&(t=Array.isArray(t)?t.map(function(t){return e.parse(t)}):e.parse(t),e.set(e.vmodel,t),n(e))},contenteditable:function(){a.input.call(this,"innerHTML")}};e.exports=a},function(e,t){function n(e){r[this.tagName].call(this,e);var t=this.__ms_duplex__;!this.caret&&t&&t.isString&&t.update.call(this,{type:"setter"})}var a=!1;try{var r={},o=HTMLInputElement.prototype,i=HTMLTextAreaElement.prototype,s=HTMLInputElement.prototype;Object.getOwnPropertyNames(s),r.INPUT=Object.getOwnPropertyDescriptor(o,"value").set,Object.defineProperty(o,"value",{set:n}),r.TEXTAREA=Object.getOwnPropertyDescriptor(i,"value").set,Object.defineProperty(i,"value",{set:n}),a=!0}catch(e){}e.exports=a},,function(e,t){e.exports=function(e,t){var n=e.__ms_duplex__,a=t["ms-rules"];if(a&&!n.validator)for(;e&&1===e.nodeType;){var r=e._ms_validator_;if(r){n.rules=a,n.validator=r,avalon.Array.ensure(r.fields,n)&&r.addField(n);break}e=e.parentNode}}},function(e,t,n){function a(){var e=this.data||{};return this.message.replace(i,function(t,n){return null==e[n]?"":e[n]})}var r=n(39),o=avalon.directive("validate",{diff:function(e,t,n){var a=e[n],i=t[n];if(!(i&&i.onError&&i.addField)&&Object(a)===a){t.vmValidator=a,a.$id&&(a=a.$model),t[n]=a;for(var n in o.defaults)a.hasOwnProperty(n)||(a[n]=o.defaults[n]);a.fields=a.fields||[],r(t,this.update)}},update:function(e,t){function n(){o.validateAll.call(a,a.onValidateAll)}var a=t["ms-validate"];e._ms_validator_=a,a.dom=e;var r=t.vmValidator;try{r.onManual=n}catch(e){}delete t.vmValidator,e.setAttribute("novalidate","novalidate"),a.validateAllInSubmit&&avalon.bind(e,"submit",function(e){e.preventDefault(),n()}),"function"==typeof a.onInit&&a.onInit.call(e,{type:"init",target:e,validator:a})},validateAll:function(e){var t=this,n="function"==typeof e?e:t.onValidateAll,a=t.fields.filter(function(e){var n=e.dom;return n&&!n.disabled&&t.dom.contains(n)}).map(function(e){return o.validate(e,!0)});return Promise.all(a).then(function(e){var a=e.concat.apply([],e);if(t.deduplicateInValidateAll){var r={};a=a.filter(function(e){var t=e.element,n=t.uniqueID||(t.uniqueID=setTimeout("1"));return!r[n]&&(r[n]=!0)})}n.call(t.dom,a)})},addField:function(e){var t=this,n=e.dom;!t.validateInKeyup||e.isChanged||e.debounceTime||avalon.bind(n,"keyup",function(t){o.validate(e,0,t)}),t.validateInBlur&&avalon.bind(n,"blur",function(t){o.validate(e,0,t)}),t.resetInFocus&&avalon.bind(n,"focus",function(a){t.onReset.call(n,a,e)})},validate:function(e,t,n){var r=[],o=e.value,i=e.dom,s=e.validator;if("function"!=typeof Promise&&avalon.error("please npm install avalon-promise or bluebird"),!i.disabled){var l=e.rules;if(!l.norequired||""!==o)for(var c in l){var u=l[c];if(u!==!1){var d,f,v=avalon.validators[c];r.push(new Promise(function(e,t){d=e,f=t}));var p=function(t){if(t)d(!0);else{var n={element:i,data:e.data,message:i.getAttribute("data-"+c+"-message")||i.getAttribute("data-message")||v.message,validateRule:c,getMessage:a};d(n)}};e.data={},e.data[c]=u,v.get(o,e,p)}}return Promise.all(r).then(function(e){var a=e.filter(function(e){return"object"==typeof e});return t||(a.length?s.onError.call(i,a,n):s.onSuccess.call(i,a,n),s.onComplete.call(i,a,n)),a})}}}),i=/\\?{{([^{}]+)\}}/gm;o.defaults={addField:o.addField,onError:avalon.noop,onSuccess:avalon.noop,onComplete:avalon.noop,onManual:avalon.noop,onReset:avalon.noop,onValidateAll:avalon.noop,validateInBlur:!0,validateInKeyup:!0,validateAllInSubmit:!0,resetInFocus:!0,deduplicateInValidateAll:!1}},function(e,t){function n(e){return"regexp"===avalon.type(e)}function a(e){if("string"==typeof e&&e){var t=e.split("-");if(3===t.length&&4===t[0].length){var n=~~t[0],a=~~t[1]-1,r=~~t[2],o=new Date(n,a,r);return o.getFullYear()===n&&o.getMonth()===a&&o.getDate()===r}}return!1}avalon.directive("rules",{diff:function(e,t,n){var a=e[n];if(a&&"[object Object]"===Object.prototype.toString.call(a)){t[n]=a.$model||a;var r=t.dom&&t.dom.__ms_duplex__;r&&(r.rules=e[n])}}});var r=/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/i,o=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/;avalon.shadowCopy(avalon.validators,{pattern:{message:"必须匹配{{pattern}}这样的格式",get:function(e,t,a){var r=t.dom,o=t.data;if(!n(o.pattern)){var i=r.getAttribute("pattern");o.pattern=new RegExp("^(?:"+i+")$")}return a(o.pattern.test(e)),e}},digits:{message:"必须整数",get:function(e,t,n){return n(/^\-?\d+$/.test(e)),e}},number:{message:"必须数字",get:function(e,t,n){return n(!!e&&isFinite(e)),e}},norequired:{message:"",get:function(e,t,n){return n(!0),e}},required:{message:"必须填写",get:function(e,t,n){return n(""!==e),e}},equalto:{message:"密码输入不一致",get:function(e,t,n){var a=String(t.data.equalto),r=avalon(document.getElementById(a)).val()||"";return n(e===r),e}},date:{message:"日期格式不正确",get:function(e,t,r){var o=t.data;return r(n(o.date)?o.date.test(e):a(e)),e}},url:{message:"URL格式不正确",get:function(e,t,n){return n(o.test(e)),e}},email:{message:"email格式不正确",get:function(e,t,n){return n(r.test(e)),e}},minlength:{message:"最少输入{{minlength}}个字",get:function(e,t,n){var a=parseInt(t.data.minlength,10);return n(e.length>=a),e}},maxlength:{message:"最多输入{{maxlength}}个字",get:function(e,t,n){var a=parseInt(t.data.maxlength,10);return n(e.length<=a),e}},min:{message:"输入值不能小于{{min}}",get:function(e,t,n){var a=parseInt(t.data.min,10);return n(parseFloat(e)>=a),e}},max:{message:"输入值不能大于{{max}}",get:function(e,t,n){var a=parseInt(t.data.max,10);return n(parseFloat(e)<=a),e}},chs:{message:"必须是中文字符",get:function(e,t,n){return n(/^[\u4e00-\u9fa5]+$/.test(e)),e}}})},function(e,t,n){var a=n(39);avalon.directive("if",{priority:6,diff:function(e,t,n,r,o,i){var s=!!e[n];t[n]=s,a(t,this.update)},update:function(e,t,n){var a=t["ms-if"];if(t.dynamic["ms-if"]&&(t.dynamic["ms-if"]=t.nodeName),a){if("#comment"===t.nodeName){t.nodeName=t.dynamic["ms-if"],delete t.nodeValue;var r=t.comment;if(!r)return;n=r.parentNode,n&&n.replaceChild(e,r),delete t.comment,avalon.applyEffect(e,t,{hook:"onEnterDone"})}}else t.comment||(t.comment=document.createComment("if")),t.nodeName="#comment",t.nodeValue="if",avalon.applyEffect(e,t,{hook:"onLeaveDone",cb:function(){n=n||e.parentNode,
n&&n.replaceChild(t.comment,e)}})}})},function(e,t,n){function a(e){var t=typeof e;return e&&"object"===t?e.$hashcode:t+":"+e}function r(e,t,n,r,o,i,s,l){var c=l?a(t):e,u={};u[o]=e,u[i]=t;for(var d in n)d in u||(u[d]=n[d]);r(e,t,c,u,s)}function o(e,t){var n=e.children.map(function(e){return e["ms-if"]?e.comment:e.dom});return t&&n.forEach(function(t){e.dom.appendChild(t)}),n}function i(e){var t;for(var n in e){var t=n;break}if(t)return s(e,t)}function s(e,t){var n=e[t];if(n){var a=n.arr;if(a){var r=a.pop();return a.length||(n.arr=0),r}return delete e[t],n}}function l(e,t){var n=t.key;if(e[n]){var a=e[n],r=a.arr||(a.arr=[]);r.push(t)}else e[n]=t}var c=n(39),u=/\s+as\s+([$\w]+)/,d=/^[$a-zA-Z_][$a-zA-Z0-9_]*$/,f=/^(null|undefined|NaN|window|this|\$index|\$id)$/,v=/[$\w]+/g;avalon._each=function(e,t,n,a){var o=[];a.push(o);var i=(t+"").slice(0,40).match(v);if(i.shift(),Array.isArray(e))for(var s=0;s<e.length;s++)r(s,e[s],n,t,i[0],i[1],o,!0);else for(var s in e)e.hasOwnProperty(s)&&r(s,e[s],n,t,i[0],i[1],o)},avalon.directive("for",{priority:3,parse:function(e,t){var n,a=t.forExpr;a=a.replace(u,function(e,t){return!d.test(t)||f.test(t)?avalon.error("alias "+t+" is invalid --- must be a valid JS identifier which is not a reserved name."):n=t,""});var r=a.split(" in "),o={expr:r[1].trim(),type:"for"},i=avalon.parseExpr(o),s=(r[0]+" traceKey __local__ vnodes").match(v);4===s.length&&s.unshift("$key"),t.$append=Array("var loop = "+i+";","avalon._each(loop, function("+s+"){","__local__["+avalon.quote(n||"valueOf")+"] = loop","vnodes.push({",'\tnodeName: "#document-fragment",',"\tindex   : arguments[0],","\tkey     : traceKey,","\tchildren: new function(){\nvar vnodes = []\n").join("\n")},diff:function(e,t,n,a,r){if(!avalon.callArray||!t.list||t.forExpr.indexOf(avalon.callArray)!==-1){var o,u,d,f=a[r+1],v=n[r+1],p=n[r+2],m=t.cache||{},h=[];if(f.length)if(f===v){v.forEach(function(e){e.action="move",l(m,e)}),t.cache=m;var g=!0}else{t.action="update";var y={},_=[];for(o=0;u=v[o];o++){var d=s(m,u.key);d?(d.oldIndex=d.index,d.index=u.index,l(y,d)):_.push(u)}for(var u,o=0;u=_[o];o++)d=i(m,u.key),d?(d.oldIndex=d.index,d.index=u.index,d.key=u.key):(d=u,f.push(d)),l(y,d);f.sort(function(e,t){return e.index-t.index}),t.cache=y;for(var o in m)d=m[o],d.action="leave",avalon.Array.remove(f,d),h.push(d),d.arr&&(d.arr.forEach(function(e){e.action="leave",h.push(e)}),delete d.arr)}else t.action="init",a[r+1]=v,v.forEach(function(e,t){f[t]=e,l(m,e)}),t.cache=m;h.length>1&&h.sort(function(e,t){return e.index-t.index}),t.removes=h;var b=avalon.caches[t.wid],w=e.vmodel;return p&&b&&(p.afterChange=[function(e){b.call(w,{type:"rendered",target:e,signature:t.signature})}]),g||(t.list=f,c(t,this.update)),!0}},update:function(e,t,n){if("init"===t.action){var a=n;n=document.createDocumentFragment()}for(var r,i=e,s=t.signature,l=0;r=t.removes[l++];)r.dom&&(delete r.split,t.hasEffect?!function(e){var t=o(e),n=e.children.concat();e.children.length=0,p(t,n,{hook:"onLeaveDone",staggerKey:s+"leave",cb:function(e){e.parentNode&&e.parentNode.removeChild(e)}})}(r):o(r,"add"));t.list.forEach(function(e,a){if("leave"!==e.action){e.dom||(e.dom=avalon.domize(e));var r=e.dom;if(void 0===e.oldIndex){if(t.hasEffect)var l=avalon.slice(r.childNodes);0===a&&"init"===t.action?n.appendChild(r):n.insertBefore(r,i.nextSibling),t.hasEffect&&p(l,e.children,{hook:"onEnterDone",staggerKey:s+"enter"})}else if(e.index!==e.oldIndex){var l=o(e,"add");n.insertBefore(e.dom,i.nextSibling),t.hasEffect&&p(l,e.children,{hook:"onMoveDone",staggerKey:s+"move"})}i=e.split}}),"init"===t.action&&a.insertBefore(n,e.nextSibling)}}),avalon.domize=function(e){return avalon.vdom(e,"toDOM")};var p=function(e,t,n){t.forEach(function(t,a){avalon.applyEffect(e[a],t,n)})}},function(e,t,n){function a(e,t){var n=t.props.is,a=t["component-vm:"+n],r="component-html:"+n,o=t[r],i=avalon.vdom(t,"toHTML");o!==i&&(t[r]=i,a.$fire("onViewChange",{type:"viewchange",target:e,vmodel:a,is:n}))}function r(e){var t=!0;try{o(e)}catch(e){t=!1}return t}function o(e){e.children.forEach(function(e){if("#comment"===e.nodeName){if("unresolved component placeholder"===e.nodeValue)throw"unresolved"}else e.children&&o(e)})}var i=n(39),s=n(62);avalon.component=function(e,t){avalon.components[e]||(avalon.components[e]=t)},avalon.directive("widget",{priority:4,parse:function(e,t,n){t.props.wid=t.props.wid||avalon.makeHashCode("w"),e[n.name]=avalon.parseExpr(n),e.template=t.template,e.vmodel="__vmodel__",e.local="__local__"},define:function(){return avalon.mediatorFactory.apply(this,arguments)},diff:function(e,t,n,a,o,l){var c=e[n];if(Object(c)===c){var u=t.props.is||(/^ms\-/.test(t.nodeName)?t.nodeName:0);u||(c=c.$model||c,Array.isArray(c)&&(c.unshift({}),avalon.mix.apply(0,c),c=c.shift()),u=c.is);var d="component-vm:"+u;if(t.props.is=u,t.vmodel=e.vmodel,!t[d]&&!s(t,e[n],e.local,e.template))return t.nodeValue="unresolved component placeholder",a[l]=t,void i(t,this.mountComment);var f=t[d],v=avalon.scopes[f.$id];if(v&&v.vmodel){var p=v.vmodel.$element;if(t.dom!==p){var m=p.vtree[0];return o[l]=a[l]=m,t.com=p,m.skipContent||(m.skipContent="optimize"),i(t,this.replaceCachedComponent),void i(m,function(){"optimize"===m.skipContent&&(m.skipContent=!0)},"afterChange")}}var h=f.$render,g=h(f,e.local),m=g[0];m&&r(m)?(m.local=e.local,Array(d,"component-html:"+u,"component-ready:"+u,"dom","dynamic").forEach(function(e){m[e]=t[e]}),m.vmodel=f,a[l]=m,t.comment&&t.nodeValue&&(m.dom=t.comment),t.nodeName!==m.nodeName?(o[l]=m,i(m,this.mountComponent)):i(t,this.updateComponent)):(t.nodeValue="unresolved component placeholder",a[l]={nodeValue:"unresolved component placeholder",nodeName:"#comment"},i(t,this.mountComment))}else t.props.is===e.props.is&&i(t,this.updateComponent)},replaceCachedComponent:function(e,t,n){var a=t.com;n.replaceChild(a,e),t.dom=a,delete t.com},mountComment:function(e,t,n){var a=document.createComment(t.nodeValue);t.dom=a,n.replaceChild(a,e)},updateComponent:function(e,t){var n=t["component-vm:"+t.props.is],r=n.$events.onViewChange;r&&r.length&&i(t,a,"afterChange")},mountComponent:function(e,t,n){delete t.dom;var a=avalon.vdom(t,"toDOM"),r=t.props.is,o=t["component-vm:"+r];o.$fire("onInit",{type:"init",vmodel:o,is:r}),n.replaceChild(a,e),t.dom=o.$element=a,a.vtree=[t],avalon._disposeComponent(a),t["component-ready:"+r]=!0,avalon.scopes[o.$id]={vmodel:o,top:t.vmodel,local:t.local},i(t,function(){o.$fire("onReady",{type:"ready",target:a,vmodel:o,is:r})},"afterChange"),i(t,function(){t["component-html:"+r]=avalon.vdom(t,"toHTML")},"afterChange")}})},function(e,t,n){function a(e,t,n,a){function d(e,t){C.forEach(function(n){delete e[n],delete t[n]})}var m=e.nodeName,h=e.props.is;if(!u[m]&&!s(m))return void avalon.warn(m+"不合适做组件的标签");var g={};if(t){var y=[].concat(t);y.forEach(function(e){e&&"object"==typeof e&&l(g,e.$model||e,!0)})}else y=[];var _=avalon.components[h];if(_){var b=g.id||g.$id;!b&&p&&(avalon.warn("warning!",h,"组件最好在ms-widget配置对象中指定全局不重复的$id以提高性能!\n","若在ms-for循环中可以利用 ($index,el) in @array 中的$index拼写你的$id\n","如 ms-widget=\"{is:'ms-button',id:'btn'+$index}\""),p=!1),g.define&&(delete g.define,avalon.warn("warning! 组件的define配置项已经被废掉"));var w=avalon.directives.widget.define,x=b||e.props.id||"w"+(new Date-0),$=avalon.mix(!0,{},_.defaults);l(g,$,!1);var C=v.concat();d.isWidget=!0;var A=w.apply(d,[e.vmodel,$].concat(y));if(!avalon.modern)for(var k in A)c[k]||"function"!=typeof A[k]||(A[k]=A[k].bind(A));A.$id=x,avalon.vmodels[x]=A;for(var E in f)g[E]&&g[E].forEach(function(e){A.$watch(E,e)});var T=avalon.lexer(a),O=T[0];O.children=O.children||[],O.props.is=h,O.props.wid=x,avalon.speedUp(T);var N=avalon.render(T,n),j=_.template.trim();"function"==typeof _.getTemplate&&(j=_.getTemplate(A,j));var M=avalon.lexer(j);M.length>1&&avalon.error("组件必须用一个元素包起来");var D=_.soleSlot;i(M,D),avalon.speedUp(M);var S=avalon.render(M),V=o+"",L=D?avalon.quote(D):"null";V=V.replace("XXXXX",r(N)).replace("YYYYY",r(S)).replace("ZZZZZ",L);var H=V.indexOf("{")+1,F=V.lastIndexOf("}"),P=Function("vm","local",V.slice(H,F));return A.$render=P,e["component-vm:"+h]=A,A.$render=P}}function r(e){return e.toString().replace("anonymous","").replace(/\s*\/\*\*\//g,"")}function o(){var e=XXXXX(vm,local),t=e[0],n=YYYYY(vm,local),a=n[0];for(var r in t)"children"!==r&&"nodeName"!==r&&("props"===r?avalon.mix(a.props,t.props):a[r]=t[r]);var o=ZZZZZ,i=avalon.collectSlots(t,o);return!o||i[o]&&i[o].length||(i[o]=[{nodeName:"#text",nodeValue:vm[o],dynamic:!0}]),avalon.insertSlots(n,i),delete a.skipAttrs,delete a.skipContent,n}function i(e,t){for(var n,a=0;n=e[a];a++)if("slot"===n.nodeName){var r=n.props.name||t;e.splice(a,1,{nodeName:"#comment",nodeValue:"slot:"+r,dynamic:!0,type:r},{nodeName:"#comment",nodeValue:"slot-end:"}),a++}else n.children&&i(n.children,t)}function s(e){return m.test(e)||avalon.components[e]}function l(e,t,n){for(var a in t){var r=t[a];f[a]?a in e?e[a].push(r):e[a]=[t[a]]:n&&(e[a]=r)}}var c=n(63);avalon._disposeComponent=n(64);var u={wbr:1,xmp:1,template:1},d="onInit,onReady,onViewChange,onDispose",f=avalon.oneObject(d),v=d.split(",").concat("is","define"),p=!0;e.exports=a,avalon.insertSlots=function(e,t){for(var n,a=0;n=e[a];a++)if("#comment"===n.nodeName&&t[n.type]){var r=[a+1,0].concat(t[n.type]);e.splice.apply(e,r),a+=t[n.type].length}else n.children&&avalon.insertSlots(n.children,t)},avalon.collectSlots=function(e,t){var n={};return t?(n[t]=e.children,n.__sole__=t):e.children.forEach(function(t,a){var r=t.props&&t.props.slot;r&&(t.forExpr?n[r]=e.children.slice(a,a+2):Array.isArray(n[r])?n[r].push(t):n[r]=[t])}),n};var m=/^[a-z]([a-z\d]+\-)+[a-z\d]+$/},function(e,t){e.exports=avalon.oneObject("$id,$render,$track,$element,$watch,$fire,$events,$model,$skipArray,$accessors,$hashcode,$run,$wait,__proxy__,__data__,__const__")},function(e,t){function n(e){for(;e;){if(9===e.nodeType)return!0;e=e.parentNode}return!1}function a(e){if(1===e.nodeType&&e.getAttribute("wid")&&!n(e)){var t=e.getAttribute("wid"),a=avalon.scopes[t];if(!a)return;var o=e.getAttribute("ms-controller")||e.getAttribute("ms-important"),i=o&&avalon.vmodels[o]||a.vmodel;if(i.$fire("onDispose",{type:"dispose",target:e,vmodel:i}),o)return;if(!e.getAttribute("cached")){delete a.vmodel,delete avalon.scopes[t];var s=e.vtree;r(s);var l=e.getAttribute("is");s&&(s[0][l+"-mount"]=!1,s[0]["component-ready:"+l]=!1)}return!1}}function r(e){for(var t in e){var n=e[t];if(d.test(n.nodeName)){for(var t in n)0===t.indexOf("ms-on")&&delete n[t];n.children&&r(n.children)}}}function o(e){setTimeout(function(){a(e)},4)}function i(e){for(var t,n=0;t=e[n++];)a(t)}function s(e){e.addEventListener("DOMNodeRemovedFromDocument",function(){o(e)})}function l(){function e(e,t){var a=n[e];n[e]=function(e,n){return t.call(this,a,e,n)}}function t(e){var t=avalon.slice(this.getElementsByTagName("*"));a.call(this,e),i(t)}if(!l.execute){l.execute=!0;var n=Node.prototype;e("removeChild",function(e,t,n){return e.call(this,t,n),1===t.nodeType&&o(t),t}),e("replaceChild",function(e,t,n){return e.call(this,t,n),1===n.nodeType&&o(n),t});var a,r=Element.prototype;try{var s=Object.getOwnPropertyDescriptor(r,"innerHTML"),a=s.set;s.set=t,Object.defineProperty(r,"innerHTML",s)}catch(e){if(!r||!r.__lookupSetter__)throw e;a=r.__lookupSetter__("innerHTML"),r.__defineSetter__("innerHTML",t)}e("appendChild",function(e,t){return e.call(this,t),1===t.nodeType&&11===this.nodeType&&o(t),t}),e("insertBefore",function(e,t,n){return e.call(this,t,n),1===t.nodeType&&11===this.nodeType&&o(t),t})}}function c(e){avalon.Array.ensure(f,e),v||(v=setInterval(function(){for(var e,t=0;e=f[t];)!1===a(e)?avalon.Array.removeAt(f,t):t++;0==f.length&&(clearInterval(v),v=0)},700))}function u(e){if(window.chrome&&window.MutationEvent)s(e);else try{l(e)}catch(t){c(e)}}var d=/^\w/,f=[],v=0;u.byMutationEvent=s,u.byRewritePrototype=l,u.byPolling=c,e.exports=u},function(e,t,n){function a(e,t){for(var n in e)if(e[n]!==t[n])return!0;return!1}function r(){if(!f.lock){var e=f[0];e&&(r.lock=!0,e())}}function o(e){var t=p.test(e)?1e3:1;return parseFloat(e)*t}function i(e,t,n){var a=e[t];a=Array.isArray(a)?a:"function"==typeof a?[a]:[],a.forEach(function(e){e&&e(n)})}function s(e){var t=e.toLowerCase();return function(n){var a,s=this.el,l=avalon(s),u=isFinite(n.stagger)?1e3*n.stagger:0;if(u&&n.staggerKey){var d=m.get(n.staggerKey)||m.put(n.staggerKey,{count:0,items:0});d.count++,d.items++}var v=d&&d.count||0,p=function(t){var o=t!==!1;s.animating=void 0,a=!0;var l=o?"Done":"Abort";i(n,"on"+e+l,s),avalon.unbind(s,c.transitionEndEvent),avalon.unbind(s,c.animationEndEvent),d&&0===--d.items&&(d.count=0),n.queue&&(f.lock=!1,f.shift(),r())};i(n,"onBefore"+e,s),n[t]?n[t](s,function(e){p(e!==!1)}):c.css&&(l.addClass(n[t+"Class"]),"leave"===t?l.removeClass(n.enterClass+" "+n.enterActiveClass):"enter"===t&&l.removeClass(n.leaveClass+" "+n.leaveActiveClass),l.bind(c.transitionEndEvent,p),l.bind(c.animationEndEvent,p),setTimeout(function(){a=NaN===avalon.root.offsetWidth,l.addClass(n[t+"ActiveClass"]);var e=window.getComputedStyle(s),r=e[c.transitionDuration],i=e[c.animationDuration],d=o(r)||o(i);0===!d?p(!1):u||setTimeout(function(){a||p(!1)},d+130)},17+u*v))}}function l(e){e.acton||(e.action=e.hook.replace(/^on/,"").replace(/Done$/,"").toLowerCase())}var c=n(66),u=n(7),d=n(39);avalon.directive("effect",{priority:5,diff:function(e,t,n){var r=e[n];if(r=e.$model||r,"string"==typeof r){var o=r;r={is:o}}else Array.isArray(r)&&(r=avalon.mix.apply({},r));r.action=r.action||"enter",Object(r)===r&&(t.dynamic[n]&&!a(r,t[n]||{})||(t[n]=r,d(t,this.update,"afterChange"))),e!==t&&delete e[n]},update:function(e,t,n,a){if(e&&1===e.nodeType&&!e.animating){e.animating=!0;var o=t["ms-effect"];if(!t.dynamic["ms-effect"]){var i=o.cb||avalon.noop;o.cb=[function(){t.dynamic["ms-effect"]=1,o.cb=i}].concat(i)}var s=o.is;if(a=a||{},!s)return avalon.warn("need is option");var l=avalon.effects;c.css&&!l[s]&&avalon.effect(s,{});var u=l[s];if(!u)return avalon.warn(s+" effect is undefined");var d=a.action||o.action,v=avalon.Effect,p=new v(e),m=avalon.mix(a,u,o);m.queue?(f.push(function(){p[d](m)}),r()):setTimeout(function(){p[d](m)},4)}}});var f=[];avalon.effects={},avalon.effect=function(e,t){avalon.effects[e]=t||{},c.css&&(t.enterClass||(t.enterClass=e+"-enter"),t.enterActiveClass||(t.enterActiveClass=t.enterClass+"-active"),t.leaveClass||(t.leaveClass=e+"-leave"),t.leaveActiveClass||(t.leaveActiveClass=t.leaveClass+"-active")),t.action||(t.action="enter")};var v=function(e){this.el=e};avalon.Effect=v,v.prototype={enter:s("Enter"),leave:s("Leave"),move:s("Move")};var p=/\d+s$/,m=new u(128);avalon.applyEffect=function(e,t,n){var a=n.cb,r=t["ms-effect"];if(r&&e&&1===e.nodeType){var o=n.hook,i=r[o];a&&(Array.isArray(i)?i.push(a):i?r[o]=[i,a]:r[o]=[a]),l(n),avalon.directives.effect.update(e,t,0,avalon.shadowCopy({},n))}else a&&a(e)}},function(e,t){if(avalon.browser){var n,a,r,o=!1,i=!1,s=!1,l=avalon.cssName("transition-duration"),c=avalon.cssName("animation-duration"),u={TransitionEvent:"transitionend",WebKitTransitionEvent:"webkitTransitionEnd",OTransitionEvent:"oTransitionEnd",otransitionEvent:"otransitionEnd"},d=avalon.window;for(var f in u){if(d[f]){r=u[f];break}try{document.createEvent(f);r=u[f];break}catch(e){}}"string"==typeof r&&(o=!0,s=!0,n=r),u={AnimationEvent:"animationend",WebKitAnimationEvent:"webkitAnimationEnd"};var v;for(f in u)if(d[f]){v=u[f];break}"string"==typeof v&&(i=!0,s=!0,a=v)}e.exports={transition:o,animation:i,css:s,transitionEndEvent:n,animationEndEvent:a,transitionDuration:l,animationDuration:c}},function(e,t,n){function a(e,t){var n=Array.isArray(e)?r(e):e,a=[];if(t)for(var i in t)a.push("var "+i+" = __local__["+avalon.quote(i)+"]");n=n.replace(o,"$1");var s="__local__ = __local__ || {};\n"+a.join(";\n")+"\n"+n;try{var l=Function("__vmodel__","__local__",s)}catch(e){avalon.warn(n,"render parse error")}return l}avalon.lexer=n(68),avalon.diff=n(72),avalon.batch=n(73),avalon.speedUp=n(74),avalon.parseExpr=n(77);var r=n(75),o=/\\\\(['"])/g;avalon.render=a,e.exports=avalon},function(e,t,n){function a(e){w={},e=d(e,l);var t=[];t.last=function(){return t[t.length-1]};var n=[],a=1e5;do{var v=!1;if("<"!==e.charAt(0)){var b=e.indexOf("<");b=b===-1?e.length:b;var x=e.slice(0,b).replace(_,c);e=e.slice(b),v={nodeName:"#text",nodeValue:x},y.test(x)&&o(v,t,n)}if(!v){var b=e.indexOf("<!--");if(0===b){var $=e.indexOf("-->");$===-1&&u.error("注释节点没有闭合"+e);var x=e.slice(4,$).replace(_,c);e=e.slice($+3),v={nodeName:"#comment",nodeValue:x},o(v,t,n)}}if(!v){var C=e.match(h);if(C){var A=C[1].toLowerCase(),k=f[A]||"/"===C[3];v={nodeName:A,props:{},children:[],isVoidTag:k};var E=C[2];if(E&&i(E,v.props),o(v,t,n),e=e.slice(C[0].length),k)v.end=!0;else if(t.push(v),m[A]){var T=e.indexOf("</"+A+">"),O=e.slice(0,T).trim();e=e.slice(T),p(v,A,s(O))}}}if(!v){var C=e.match(g);if(C){var A=C[1].toLowerCase(),N=t.last();N?N.nodeName!==A&&u.error(N.nodeName+"没有闭合"):u.error(C[0]+"前面缺少<"+A+">"),v=t.pop(),v.end=!0,e=e.slice(C[0].length)}}if(!v||0===--a)break;v.end&&(r(v,t,n),delete v.end)}while(e.length);return n}function r(e,t,n){var a=e.nodeName,r=e.props;"table"===a&&v(e.children);var o=r["ms-for"];if(o){delete r["ms-for"];var i=t.last(),s=i?i.children:n;s.splice(s.length-1,1,{nodeName:"#comment",nodeValue:"ms-for:"+o,type:a},e,{nodeName:"#comment",nodeValue:"ms-for-end:",type:a})}}function o(e,t,n){var a=t.last();a?a.children.push(e):n.push(e)}function i(e,t){for(;e;){var n=$.exec(e);if(!n)break;var a=n[1],r=n[2]||"";e=e.replace(n[0],""),":"===a.charAt(0)&&(a="ms-"+a.slice(1)),r&&0===r.indexOf("??")&&(r=s(r).replace(x,"").slice(1,-1)),a in t||(t[a]=r)}}function s(e){return u.unescapeHTML(e.replace(_,c))}function l(e){var t="??"+b++;return w[t]=e,t}function c(e){var t=w[e];return t}var u=n(4),d=n(69),f=n(36),v=n(70),p=n(71),m=u.oneObject("script,style,textarea,xmp,noscript,option,template"),h=/^<([-A-Za-z0-9_]+)\s*([^>]*?)(\/?)>/,g=/^<\/([^>]+)>/,y=/\S/,_=/\?\?\d+/g,b=1,w={};e.exports=a;var x=/[\n\r]s*/g,$=/([^=\s]+)(?:\s*=\s*(\S+))?/},function(e,t){function n(e,t){for(var n=a(e),r=0,o=n.length;r<o;r++)e=e.replace(n[r],t);return e}function a(e){for(var t,n=0,a=[],r=0,o=e.length;r<o;r++){var i=e.charAt(r);if(t){if("\\"===i){r+=1;continue}i===t&&(a.push(e.slice(n,r+1)),t=!1)}else"'"===i?(t="'",n=r):'"'===i&&(t='"',n=r)}return a}e.exports=n},function(e,t){e.exports=function(e){for(var t,n=!1,a=0,r=0,o=e.length,i=0;i<o;i++){var s=e[i];t?"tr"!==s.nodeName&&s.children?t=!1:(t.children.push(s),a++,e[i]=0):"tr"===(s.type||s.nodeName)&&(t={nodeName:"tbody",children:[]},t.children.push(s),s.type&&delete s.type,n=!0,0===r&&(r=i),e[i]=t)}if(n)for(i=r;i<o&&(0!==e[i]||(e.splice(i,1),i--,a--,0!==a));i++);}},function(e,t){function n(e,t,n){switch(t){case"style":case"script":case"noscript":case"template":case"xmp":e.children=[{nodeName:"#text",skipContent:!0,nodeValue:n}];break;case"textarea":var r=e.props;r.type=t,r.value=n,e.children=[{nodeName:"#text",nodeValue:n}];break;case"option":e.children=[{nodeName:"#text",nodeValue:a(n)}]}}function a(e){return String(e).replace(r,"").trim()}e.exports=n;var r=/<\w+(\s+("[^"]*"|'[^']*'|[^>])+)?>|<\/\w+>/gi},function(e,t){function n(e,t){for(var s=0;s<e.length;s++){var l=e[s],c=t[s]||e[s];switch(l.nodeName){case"#text":if(l.dynamic){var u=l.nodeValue+"";u!==c.nodeValue&&(c.nodeValue=u,c.dom&&(c.dom.nodeValue=u))}break;case"#comment":l.forExpr?i.for.diff(l,c,e,t,s):l.afterChange&&a(c,l.afterChange);break;case void 0:n(l,c);break;case"#document-fragment":n(l.children,c.children);break;default:if(l.dynamic){var d=s;l["ms-widget"]&&(avalon.directives.widget.diff(l,c,"ms-widget",e,t,d),l=e[s],c=t[s]||o(),delete l["ms-widget"]),"ms-if"in l&&(avalon.directives.if.diff(l,c,"ms-if",e,t,d),l=e[s],c=t[s]||o(),delete l["ms-if"]),r(l,c)}!/^\w/.test(l.nodeName)||l.skipContent||l.isVoidTag||n(l.children,c.children||[]),c.afterChange&&a(c,c.afterChange)}}}function a(e,t){if(t.length)for(var n,a=0;n=t[a++];)n(e.dom,e);delete e.afterChange}function r(e,t){var n=avalon.directives;try{for(var a in e){var r=a.match(s),o=r&&r[1];n[o]&&n[o].diff(e,t,a)}}catch(e){avalon.warn(o,e,e.stack||e.message,"diffProps error")}}var o=function(){return{children:[],props:{}}},i=avalon.directives,s=/^ms-(\w+)-?(.*)/;avalon.diff=n,e.exports=n},function(e,t){function n(e){if(r)return avalon.Array.ensure(a,e);r=e;var t=avalon.scopes[e];if(!t||!document.nodeName||avalon.suspendUpdate)return r=null;var o=t.vmodel,i=o.$element,s=i.vtree||[],l=o.$render,c=l(t.vmodel,t.local);t.isTemp&&delete avalon.scopes[e],avalon.diff(c,s);var u=a.indexOf(r);if(r=0,u>-1){var d=a.splice(u,1);return n(d[0])}var f=a.shift();f&&n(f)}var a=[],r=!1;avalon.suspendUpdate=0,e.exports=avalon.batch=n},function(e,t,n){function a(e){var t=e.nodeName;switch(t){case"#text":return!!avalon.config.rexpr.test(e.nodeValue)&&(e.dynamic=!0);case"#comment":return!!e.dynamic;case void 0:return!0;default:var n=e.props||{};if("ms-skip"in n)return e.skipContent=!0,!1;var a=!1;if("input"===t)n.type||(n.type="text");else if(/xmp|wbr|template/.test(t))!n["ms-widget"]&&n.is&&(n["ms-widget"]='{is:"'+n.is+'"}');else if("select"===t){var o=n.hasOwnProperty("multiple")?"multiple":"one";n.type=t+"-"+o}else 0===t.indexOf("ms-")&&(n["ms-widget"]||(n.is=t,n["ms-widget"]='{is:"'+t+'"}'));var i=!1;if(n["ms-widget"]){i=!0,r(n,"html","widget"),r(n,"text","widget");var s=avalon.mix({},e),l=avalon.mix({},e.props);delete l["ms-widget"],delete s.isVoidTag,s.nodeName="cheng",s.props=l,e.template=avalon.vdom(s,"toHTML"),e.isVoidTag||(e.children=[])}n["ms-text"]&&(i=!0,r(n,"html","text"),e.isVoidTag||(e.children=[])),n["ms-html"]&&(i=!0,e.isVoidTag||(e.children=[]));var u=!1;for(var d in n)if(u=!0,0===d.indexOf("ms-")){a=!0,e.dynamic={};break}if(u&&(e.props=n),e.children){var f=c(e.children);if(f)return delete e.skipContent,!0;i?delete e.skipContent:e.skipContent=!0}return a}}function r(e,t,n){e["ms-"+t]&&(avalon.warn(t,"指令不能与",n,"指令共存于同一个元素"),delete e["ms-"+t])}function o(e){for(var t,n=0;t=e[n++];)if(t.props&&t.props["ms-effect"])return!0;return!1}var i=/^\s*ms\-for\:\s*/,s=/^\s*ms\-for\-end/,l=n(75);e.exports=function(e){return c(e),e};var c=function(e){for(var t=[],n=!1,r=0;r<e.length;r++){var u=e[r],d="#comment"===u.nodeName;if(d&&i.test(u.nodeValue)){n=!0,t.push(u);var f=t;t=[],t.list=f,t.start=u}else if(d&&s.test(u.nodeValue)){var f=t;t=f.list;var v=f.start;delete f.list,delete f.start,t.push(f,u),u.dynamic=!0;var p=v.signature||(v.signature=avalon.makeHashCode("for"));if(u.signature=p,v.forExpr=v.nodeValue.replace(i,""),1===f.length){var m=f[0];if(m.props){m.props.slot&&(v.props='{slot: "'+m.props.slot+'"}');var h=m.props["data-for-rendered"];if(h){delete m.props["data-for-rendered"];var g=h+":cb";avalon.caches[g]||(avalon.caches[g]=Function("return "+avalon.parseExpr({type:"on",expr:h}))()),v.wid=g}}}for(var y=0;y<f.length;y++){var u=f[y],_=u.dom;_&&_.parentNode&&_.parentNode.removeChild(_)}v.hasEffect=o(f),c(f),avalon.caches[p]||(avalon.caches[p]=l(f,!0)),f.length=0}else a(u)&&(n=!0),t.push(u)}return e.length=0,e.push.apply(e,t),n}},function(e,t,n){function a(e,t){for(var n,a=t?[]:["\nvar vnodes = [];"],o=0;n=e[o++];){var i=r(n);n.$prepend&&a.push(n.$prepend);var s=n.$append;delete n.$append,delete n.$prepend,i&&a.push(i+"\n"),s&&a.push(s)}return t||a.push("return vnodes\n"),a.join("\n")}function r(e){if(!e.nodeName)return!1;switch(e.nodeName){case"#text":return e.dynamic?i(l(e)):s(e);case"#comment":var t=e.nodeValue;if(e.forExpr){var n={dynamic:!0,vmodel:"__vmodel__"};for(var r in e)e.hasOwnProperty(r)&&!h[r]&&(n[r]=e[r]);return avalon.directives.for.parse(n,e,e),e.$append+=avalon.caches[e.signature],s(n)}if("ms-for-end:"===t)return e.$append=s({nodeName:"#comment",nodeValue:e.signature})+" return vnodes}\n })\n},__local__,vnodes)\n"+s({nodeName:"#comment",signature:e.signature,nodeValue:"ms-for-end:"})+"\n","";if(0===t.indexOf("ms-js:")){var o=avalon.parseExpr({type:"js",expr:t.replace("ms-js:","")})+"\n",c=s(e),f=o.match(m);return f&&f[1]?e.$append=(e.$append||"")+o+"\n__local__."+f[1]+" = "+f[1]+"\n":avalon.warn(t+" parse fail!"),c}return s(e);default:if(!e.dynamic&&e.skipContent)return s(e);var n={nodeName:e.nodeName},v=e.props;if(e.dynamic){n.dynamic="{}";var p=u(n,v);p.map(function(t){return avalon.directives[t.type].parse(n,e,t),t.name})}else if(v){n.props={};for(var r in v)n.props[r]=v[r]}if(e.isVoidTag)n.isVoidTag=!0;else if(!("children"in n)){var g=e.children;g&&(e.skipContent?n.children="["+g.map(function(e){return d(e)})+"]":1===g.length&&"#text"===g[0].nodeName?g[0].dynamic?n.children="["+l(g[0])+"]":n.children="["+d(g[0])+"]":n.children="(function(){"+a(g)+"})()")}return e.template&&(n.template=e.template),e.skipContent&&(n.skipContent=!0),s(n)}}function o(e){return p.test(e)?e:avalon.parseExpr({expr:e,type:"text"})}function i(e){return"vnodes.push("+e+");"}function s(e){return i(d(e))}function l(e){var t=c(e.nodeValue),n="";if(1===t.length)n=o(t[0].expr);else{var a=t.map(function(e){return e.type?o(e.expr):v(e.expr)}).join(" + ");n="String("+a+")"}return'{\nnodeName: "#text",\ndynamic:true,\nnodeValue: '+n+"\n}"}function c(e){var t=[];do{var n=e.indexOf(f.openTag);n=n===-1?e.length:n;var a=e.slice(0,n);if(/\S/.test(a)&&t.push({expr:avalon._decode(a)}),e=e.slice(n+f.openTag.length)){n=e.indexOf(f.closeTag);var a=e.slice(0,n);t.push({expr:avalon.unescapeHTML(a.replace(g,"")),type:"text"}),e=e.slice(n+f.closeTag.length)}}while(e.length);return t}var u=n(76),d=n(50),f=avalon.config,v=avalon.quote,p=/^[$a-zA-Z_][$a-zA-Z0-9_]*$/,m=/^\s*var\s+([$\w]+)\s*\=\s*\S+/,h={__local__:1,vmode:1,dom:1};e.exports=a;var g=/\n\s*/g},function(e,t){function n(e,t){var n=[],s={},l="ms-skip"in t,c={};for(var u in t){var d,f=t[u];if(s[u]=t[u],d=u.match(o)){if(l)continue;var v=u.replace(d[1],"").split("-");i[v[0]]&&v.unshift("on"),"on"===v[0]&&(v[2]=parseFloat(v[2])||0),v.unshift("ms");var p=v[1];if(r[p]){var m={type:p,param:v[2],name:v.join("-"),expr:f,priority:r[p].priority||100*p.charCodeAt(0)};"on"===p&&(m.priority+=v[3]),c[m.name]||(c[m.name]=f,n.push(m))}}}return e.props=s,n.sort(a),n}function a(e,t){return e.priority-t.priority}var r=avalon.directives,o=/^(\:|ms\-)\w+/,i=avalon.oneObject("animationend,blur,change,input,click,dblclick,focus,keydown,keypress,keyup,mousedown,mouseenter,mouseleave,mousemove,mouseout,mouseover,mouseup,scan,scroll,submit");e.exports=n},function(e,t,n){function a(e){var t=e.expr,n=e.type,a=u.get(n+":"+t);if(a)return avalon.shadowCopy(e,a),a.text;f={};var b={},w={},$=t.replace(x,o);$=d($,o),$=$.replace(m,o).replace(g,"$1").replace(_,"$1__vmodel__.").replace(/\b[\$\w]+\s*:/g,function(e){return o(e)+" "}).replace(/\|(\w+)/g,function(e,t){return"|"+o(t)}).replace(/__vmodel__\.([\$\w\.]+)/g,function(e,t){return b[t]=1,e}),s($,w);var C=$.split(h),A=C.shift(),k=A.replace(v,i);if("js"===n)return r(e,k,b,w);C.length&&(C=C.map(function(e){var t="(__value__";return e=e.replace(p,function(e,n){return/\S/.test(n)&&(t+=","+n),""}).replace(v,i),e.replace(/^(\w+)/,'__value__ =  avalon.__format__("$1")')+t+")"}));var E=[];if("on"===n)y.test(k)&&(k+="($event)"),C=C.map(function(e){return e.replace(/__value__/g,"$event")}),C.length&&C.push("if($event.$return){\n\treturn;\n}"),avalon.modern||(k=k.replace(/__vmodel__\.([^(]+)\(([^)]*)\)/,function(e,t,n){return"__vmodel__."+t+".call(__vmodel__"+(/\S/.test(n)?","+n:"")+")"})),E=["function ($event, __local__){","try{",l(w).join("\n"),"\tvar __vmodel__ = this;","\t"+k,"}catch(e){",c(t,n),"}","}"],C.unshift(2,0);else{if("duplex"===n){var T=["function (__vmodel__,__value__){","try{","\t"+k+" = __value__","}catch(e){",c(t,n).replace("parse","set"),"}","}"];u.put("duplex:set:"+e.expr,T.join("\n"));var O=["function (__vmodel__){","try{","var __value__ = "+k,C.join("\n"),"return __value__","}catch(e){",c(t,n).replace("parse","get"),"}","}"].join("\n");return r(e,O,w,b)}E=["(function (){","try{","var __value__ = "+k.replace(v,i),"text"===n?"return avalon.parsers.string(__value__)":"return __value__","}catch(e){",c(t,n),'\treturn ""',"}","})()"],C.unshift(3,0)}return E.splice.apply(E,C),r(e,E.join("\n"),w,b)}function r(e,t,n,a){var r={text:t,locals:Object.keys(n).join(","),paths:Object.keys(a).join(",")},o=e.type+":"+e.expr;return e.locals=r.locals,e.paths=r.paths,u.put(o,r),t}function o(e){var t="??"+$++;return f[t]=e,t}function i(e){return f[e]}function s(e,t){e.replace(/__vmodel__/," ").replace(b," ").replace(w,function(e){"$event"===e||avalon.keyMap[e]||(t[e]=1)})}function l(e){var t=[];for(var n in e)t.push("var "+n+" = __local__["+avalon.quote(n)+"]");return t}function c(e,t){return"\tavalon.warn(e, "+avalon.quote("parse "+t+" binding【 "+e+" 】fail")+")"}var u=avalon.evaluatorPool,d=n(69),f={},v=/\?\?\d+/g,p=/\(([^)]*)\)/,m=/\|\|/g,h=/\|(?=\?\?)/,g=/\s*(\.|\|)\s*/g,y=/^__vmodel__\.[$\w\.]+$/i,_=/(^|[^\w\u00c0-\uFFFF_])(@|##)(?=[$\w])/g,b=/\.[\w\.\$]+/g,w=/\b[$a-zA-Z_][$a-zA-Z0-9_]*\b/g,x=/(^|[^\/])\/(?!\/)(\[.+?]|\\.|[^\/\\\r\n])+\/[gimyu]{0,5}(?=\s*($|[\r\n,.;})]))/g;e.exports=a;var $=1},,,function(e,t,n){function a(e,t){t.__vmodel__=e;var n=v.hideProperty;n(e,"$events",t),n(e,"$watch",function(){if(2===arguments.length)return g.apply(e,arguments);throw"$watch方法参数不对"}),n(e,"$fire",function(t,n,a){var r=e.$events[t];h(r,e,t,n,a)})}function r(e,t,n){return"$"===e.charAt(0)||n[e]||y.test(avalon.type(t))||t&&t.nodeName&&t.nodeType>0}function o(e,t,n,a){if(Array.isArray(e))return v.arrayFactory(e,t,n,a);if(Object(e)===e&&"function"!=typeof e){if(t&&t.$id){if(++avalon.suspendUpdate,t.$track!==Object.keys(e).sort().join(";;"))var r=v.slaveFactory(t,e,n,a);else r=t;for(var o in e)p[o]||(r[o]=e[o]);return--avalon.suspendUpdate,r}return r=v.masterFactory(e,n,a)}return e}function i(e,t,n){function a(){return r}var r=NaN;return a.heirloom=n,{get:a,set:function(o){if(r!==o){var i=n.__vmodel__;o&&"object"==typeof o&&(o=v.modelAdaptor(o,r,n,{pathname:t,id:e}));var d=r;if(r=o,this.$hashcode&&i){if(i.$events.$$dirty$$=!0,i.$events.$$wait$$)return;n!==i.$events&&(a.heirloom=i.$events),c(a.$decompose,t,o,d),t.indexOf("*")===-1&&h(a.heirloom[t],i,t,o,d),l(e+"",i,t,o,d),u(a.heirloom,i,t,o,d),i.$events.$$dirty$$=!1,s(i.$id)}}},enumerable:!0,configurable:!0}}function s(e){avalon.rerenderStart=new Date;var t=e.indexOf(".");t>0?avalon.batch(e.slice(0,t)):avalon.batch(e)}function l(e,t,n,a,r){if(e.indexOf(".*.")>0){var o=e.match(_),i=avalon.vmodels[o[1]];if(i){var s=o[2];h(i.$events[s],t,n,a,r)}}}function c(e,t,n,a){if(e&&e[t]){var r=e[t];if(r.$hashcode){var o=t.replace(/^[^.]+\./,"");o!==t&&h(r.$events[o],r,o,n,a)}else delete e[t]}}function u(e,t,n,a,r){e.__fuzzy__&&e.__fuzzy__.replace(avalon.rword,function(o){var i=e[o],s=i.reg;return s&&s.test(n)&&h(i,t,n,a,r),o})}function d(e){var t=e.$id;if(t||avalon.warn("vm.$id must be specified"),avalon.vmodels[t])throw Error("error:["+t+"] had defined!");var n=v.masterFactory(e,{},{pathname:"",id:t,master:!0});return avalon.vmodels[t]=n}function f(e,t,n,a){if(t&&t.splice){var r=[0,t.length].concat(e);return++avalon.suspendUpdate,avalon.callArray=a.pathname,t.splice.apply(t,r),--avalon.suspendUpdate,t}for(var i in b)e[i]=b[i];e.notify=function(e,t,r,o){var i=n.__vmodel__;if(i){var l=null===e||void 0===e?a.pathname:a.pathname+"."+e;i.$fire(l,t,r),o||n.$$wait$$||avalon.suspendUpdate||(avalon.callArray=l,s(i.$id),delete avalon.callArray)}};var l=avalon.makeHashCode("$");a.array=!0,a.hashcode=l,a.id=a.id||l,v.initViewModel(e,n,{},{},a);for(var c=0,u=e.length;c<u;c++)e[c]=o(e[c],0,{},{id:e.$id+".*",master:!0});return e}var v={},p=n(63),m=n(81),h=m.$emit,g=m.$watch,y=/function|window|date|regexp|element/i;v.modelAdaptor=o;var _=/([^.]+)\.(.+)/;v.arrayFactory=f;var b={set:function(e,t){if(e>>>0===e&&this[e]!==t){if(e>this.length)throw Error(e+"set方法的第一个参数不能大于原数组长度");this.splice(e,1,t)}},contains:function(e){return this.indexOf(e)!==-1},ensure:function(e){return this.contains(e)||this.push(e),this},pushArray:function(e){return this.push.apply(this,e)},remove:function(e){return this.removeAt(this.indexOf(e))},removeAt:function(e){return e>>>0===e?this.splice(e,1):[]},clear:function(){return this.removeAll(),
this}};avalon.define=d,e.exports={$$midway:v,$$skipArray:p,isSkip:r,__array__:b,initEvents:a,makeAccessor:i,modelAdaptor:o}},function(e,t){function n(e,t){var n,a=t.split(".")[0];try{e.hasOwnProperty(a)&&(n=e.$accessors?e.$accessors[a].get.heirloom.__vmodel__:Object.getOwnPropertyDescriptor(e,a).get.heirloom.__vmodel__)}catch(e){}return n||e}function a(e){var t=e.split(".");return new RegExp("^"+t.map(function(e){return"*"===e?"(?:[^.]+)":e}).join("\\.")+"$","i")}function r(e,t,n){e&&(t.__fuzzy__?t.__fuzzy__.indexOf(","+n)===-1&&(t.__fuzzy__+=","+n):t.__fuzzy__=n)}function o(e,t){var n=e.indexOf(".*")>0||"*"===e,i=n?this:o.adjust(this,e),s=this.$events,l=s[e]||(s[e]=[]);return n&&(l.reg=l.reg||a(e)),r(n,s,e),i!==this&&r(n,this.$events,e),avalon.Array.ensure(l,t),function(){avalon.Array.remove(l,t)}}function i(e,t,n,a,r,o){if(e&&e.length)try{for(o=o||e.length-1;o>=0;o--){var s=e[o];s.call(t,a,r,n)}}catch(s){o-1>0&&i(e,t,n,a,r,o-1),avalon.log(s,n)}}o.adjust=n,e.exports={$emit:i,$watch:o,adjustVm:n}},,,function(e,t,n){n(3),n(85),n(6),e.exports=n(8)},function(e,t,n){function a(e){if(e&&"object"==typeof e){var t=e.length,n=o.call(e);if(s.test(n))return!0;if("[object Object]"===n&&t===t>>>0)return!0}return!1}var r=n(4),o=r.inspect,i=/^\[object (?:Window|DOMWindow|global)\]$/,s=/(Array|List|Collection|Map|Arguments)\]$/,l={};"Boolean Number String Function Array Date RegExp Object Error".replace(r.rword,function(e){l["[object "+e+"]"]=e.toLowerCase()}),r.type=function(e){return null==e?String(e):"object"==typeof e||"function"==typeof e?l[o.call(e)]||"object":typeof e},r.quote=JSON.stringify,r.isFunction=function(e){return"function"==typeof e},r.isWindow=function(e){return i.test(o.call(e))},r.isPlainObject=function(e){return"[object Object]"===o.call(e)&&Object.getPrototypeOf(e)===Object.prototype},r.mix=r.fn.mix=function(){var e,t,n,a,o,i,s=arguments[0]||{},l=1,c=arguments.length,u=!1;for("boolean"==typeof s&&(u=s,s=arguments[1]||{},l++),"object"!=typeof s&&"function"!=typeof s&&(s={}),l===c&&(s=this,l--);l<c;l++)if(null!=(e=arguments[l]))for(t in e){n=s[t];try{a=e[t]}catch(e){continue}s!==a&&(u&&a&&(r.isPlainObject(a)||(o=Array.isArray(a)))?(o?(o=!1,i=n&&Array.isArray(n)?n:[]):i=n&&r.isPlainObject(n)?n:{},s[t]=r.mix(u,i,a)):void 0!==a&&(s[t]=a))}return s},r.each=function(e,t){if(e){var n=0;if(a(e))for(var r=e.length;n<r&&t(n,e[n])!==!1;n++);else for(n in e)if(e.hasOwnProperty(n)&&t(n,e[n])===!1)break}},new function(){var e=["%cavalon.js %c"+r.version+" %cin debug mode, %cmore...","color: rgb(114, 157, 52); font-weight: normal;","color: rgb(85, 85, 85); font-weight: normal;","color: rgb(85, 85, 85); font-weight: normal;","color: rgb(82, 140, 224); font-weight: normal; text-decoration: underline;"],t="You're running avalon in debug mode - messages will be printed to the console to help you fix problems and optimise your application.\n\nTo disable debug mode, add this line at the start of your app:\n\n  avalon.config({debug: false});\n\nDebug mode also automatically shut down amicably when your app is minified.\n\nGet help and support:\n  https://segmentfault.com/t/avalon\n  http://avalonjs.coding.me/\n  http://www.avalon.org.cn/\n\nFound a bug? Raise an issue:\n  https://github.com/RubyLouvre/avalon/issues\n\n",n=!!console.groupCollapsed;console[n?"groupCollapsed":"log"].apply(console,e),console.log(t),n&&console.groupEnd(e)},e.exports={avalon:r,isArrayLike:a}},function(e,t,n){var a=n(17),r=n(18),o=n(87),i=n(20);avalon.vdom=avalon.vdomAdaptor=function(e,t){if(!e)return"toHTML"===t?"":document.createDocumentFragment();switch(e.nodeName){case"#text":return a.prototype[t].call(e);case"#comment":return r.prototype[t].call(e);case"#document-fragment":return i.prototype[t].call(e);case void 0:return new i(e)[t]();default:return o.prototype[t].call(e)}};var s={VText:a,VComment:r,VElement:o,VFragment:i};avalon.shadowCopy(avalon.vdom,s),e.exports=s},function(e,t){function n(e,t,n){this.nodeName=e,this.props=t,this.children=n}function a(e){return e!==!1&&Object(e)!==e}function r(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}var o=avalon.oneObject("circle,defs,ellipse,image,line,path,polygon,polyline,rect,symbol,text,use,g,svg");if(avalon.browser)var i="content"in document.createElement("template");n.prototype={constructor:n,toDOM:function(){if(this.dom)return this.dom;var e,t=this.nodeName;e=avalon.modern&&o[t]?r(t):document.createElement(t);var n=this.props||{},s=n["ms-important"]||n["ms-controller"]||this.wid;if(s){var l=avalon.scopes[s],c=l&&l.vmodel&&l.vmodel.$element;if(c){var u=c.vtree[0];return u.children&&(this.children=u.children),c}}for(var d in n){var f=n[d];a(f)&&e.setAttribute(d,f+"")}var v=this.children||[],p=v[0]?v[0].nodeValue:"";switch(this.nodeName){case"xmp":case"script":case"style":case"noscript":e.innerHTML=p;break;case"template":i?e.innerHTML=p:e.textContent=p;break;default:this.isVoidTag||this.children.forEach(function(t){t&&e.appendChild(avalon.vdom(t,"toDOM"))})}return this.dom=e},toHTML:function(){var e=[],t=this.props||{};for(var n in t){var r=t[n];a(r)&&e.push(n+"="+avalon.quote(t[n]+""))}e=e.length?" "+e.join(" "):"";var o="<"+this.nodeName+e;return this.isVoidTag?o+"/>":(o+=">",this.children&&(o+=this.children.map(function(e){return e?avalon.vdom(e,"toHTML"):""}).join("")),o+"</"+this.nodeName+">")}},e.exports=n},function(e,t,n){n(89),n(90),n(91),n(92),n(93),n(30),n(94),n(95),e.exports=avalon},function(e,t,n){var a=n(4);"function"==typeof Node&&(document.contains||(Node.prototype.contains=function(e){return!!(16&this.compareDocumentPosition(e))})),a.cloneNode=function(e){return e.cloneNode(!0)},a.contains=function(e,t){try{for(;t=t.parentNode;)if(t===e)return!0;return!1}catch(e){return!1}}},function(e,t,n){var a=n(4),r=/\S+/g;"add,remove".replace(a.rword,function(e){a.fn[e+"Class"]=function(t){var n=this[0]||{};return t&&"string"==typeof t&&1===n.nodeType&&t.replace(r,function(t){n.classList[e](t)}),this}}),a.fn.mix({hasClass:function(e){var t=this[0]||{};return 1===t.nodeType&&t.classList.contains(e)},toggleClass:function(e,t){var n="boolean"==typeof t,a=this;return String(e).replace(r,function(e){var r=n?t:!a.hasClass(e);a[r?"addClass":"removeClass"](e)}),this}})},function(e,t,n){function a(e,t){if(e&&1===e.nodeType){t.dynamic["ms-attr"]=1;var n=t["ms-attr"];for(var a in n){var r=n[a];if("src"===a&&window.chrome&&"EMBED"===e.tagName){e[a]=r;var s=e.parentNode,l=document.createComment("ms-src");s.replaceChild(l,e),s.replaceChild(e,l)}else if(0===a.indexOf("data-"))e.setAttribute(a,r);else{var c=o[a]||a;if("boolean"==typeof e[c]&&(e[c]=!!r),r===!1){e.removeAttribute(a);continue}var u=!i.test(e)&&a in e.cloneNode(!1);u?e[c]=r+"":e.setAttribute(a,r)}}}}var r=n(4),o=n(26),i=/^\[object SVG\w*Element\]$/;r.parseJSON=JSON.parse,r.fn.attr=function(e,t){return 2===arguments.length?(this[0].setAttribute(e,t),this):this[0].getAttribute(e)},e.exports=a},function(e,t,n){function a(e,t){if(e.offsetWidth<=0){var n=getComputedStyle(e,null);if(f.test(n.display)){var r={node:e};for(var o in d)r[o]=n[o],e.style[o]=d[o];t.push(r)}var i=e.parentNode;i&&1===i.nodeType&&a(i,t)}}function r(e){return e.window||e.defaultView||!1}var o=n(4),i=o.root,s=o.camelize,l=o.cssHooks,c=["","-webkit-","-o-","-moz-","-ms-"],u={float:"cssFloat"};o.cssNumber=o.oneObject("animationIterationCount,columnCount,order,flex,flexGrow,flexShrink,fillOpacity,fontWeight,lineHeight,opacity,orphans,widows,zIndex,zoom"),o.cssName=function(e,t,n){if(u[e])return u[e];t=t||i.style;for(var a=0,r=c.length;a<r;a++)if(n=s(c[a]+e),n in t)return u[e]=n;return null},o.fn.css=function(e,t){if(o.isPlainObject(e))for(var n in e)o.css(this,n,e[n]);else var a=o.css(this,e,t);return void 0!==a?a:this},o.fn.position=function(){var e,t,n=this[0],a={top:0,left:0};return n?("fixed"===this.css("position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),"HTML"!==e[0].tagName&&(a=e.offset()),a.top+=o.css(e[0],"borderTopWidth",!0),a.left+=o.css(e[0],"borderLeftWidth",!0),a.top-=e.scrollTop(),a.left-=e.scrollLeft()),{top:t.top-a.top-o.css(n,"marginTop",!0),left:t.left-a.left-o.css(n,"marginLeft",!0)}):a},o.fn.offsetParent=function(){for(var e=this[0].offsetParent;e&&"static"===o.css(e,"position");)e=e.offsetParent;return o(e||i)},l["@:set"]=function(e,t,n){e.style[t]=n},l["@:get"]=function(e,t){if(!e||!e.style)throw new Error("getComputedStyle要求传入一个节点 "+e);var n,a=getComputedStyle(e);return a&&(n="filter"===t?a.getPropertyValue(t):a[t],""===n&&(n=e.style[t])),n},l["opacity:get"]=function(e){var t=l["@:get"](e,"opacity");return""===t?"1":t},"top,left".replace(o.rword,function(e){l[e+":get"]=function(t){var n=l["@:get"](t,e);return/px$/.test(n)?n:o(t).position()[e]+"px"}});var d={position:"absolute",visibility:"hidden",display:"block"},f=/^(none|table(?!-c[ea]).+)/;o.each({Width:"width",Height:"height"},function(e,t){var n="client"+e,r="scroll"+e,i="offset"+e;l[t+":get"]=function(t,n,a){var r=-4;"number"==typeof a&&(r=a),n="Width"===e?["Left","Right"]:["Top","Bottom"];var s=t[i];return 2===r?s+o.css(t,"margin"+n[0],!0)+o.css(t,"margin"+n[1],!0):(r<0&&(s=s-o.css(t,"border"+n[0]+"Width",!0)-o.css(t,"border"+n[1]+"Width",!0)),r===-4&&(s=s-o.css(t,"padding"+n[0],!0)-o.css(t,"padding"+n[1],!0)),s)},l[t+"&get"]=function(e){var n=[];a(e,n);for(var r,o=l[t+":get"](e),i=0;r=n[i++];){e=r.node;for(var s in r)"string"==typeof r[s]&&(e.style[s]=r[s])}return o},o.fn[t]=function(a){var o=this[0];if(0===arguments.length){if(o.setTimeout)return o["inner"+e];if(9===o.nodeType){var s=o.documentElement;return Math.max(o.body[r],s[r],o.body[i],s[i],s[n])}return l[t+"&get"](o)}return this.css(t,a)},o.fn["inner"+e]=function(){return l[t+":get"](this[0],void 0,-2)},o.fn["outer"+e]=function(e){return l[t+":get"](this[0],void 0,e===!0?2:0)}}),o.fn.offset=function(){var e=this[0];try{var t=e.getBoundingClientRect();if(t.width||t.height||e.getClientRects().length){var n=e.ownerDocument,a=n.documentElement,r=n.defaultView;return{top:t.top+r.pageYOffset-a.clientTop,left:t.left+r.pageXOffset-a.clientLeft}}}catch(e){return{left:0,top:0}}},o.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){o.fn[e]=function(n){var a=this[0]||{},o=r(a),i="scrollTop"===e;return arguments.length?void(o?o.scrollTo(i?o[t]:n,i?n:o[t]):a[e]=n):o?o[t]:a[e]}})},function(e,t,n){function a(e){var t=e.tagName.toLowerCase();return"input"===t&&/checkbox|radio/.test(e.type)?"checked":t}var r=n(4),o={"select:get":function e(t,n,a,r){var i,s=t.children;o["option:get"];a=n?a:t.selectedIndex,r=n?r:"select-one"===t.type||a<0,n=n||[];for(var l,c=0;l=s[c++];)if(!l.disabled)switch(l.nodeName.toLowerCase()){case"option":if(l.selected||l.index===a){if(i=l.value,r)return i;n.push(i)}break;case"optgroup":if(i=e(l,n,a,r),"string"==typeof i)return i}return r?null:n},"select:set":function(e,t,n){t=[].concat(t);for(var a,r=0;a=e.options[r++];)(a.selected=t.indexOf(a.value)>-1)&&(n=!0);n||(e.selectedIndex=-1)}};r.fn.val=function(e){var t=this[0];if(t&&1===t.nodeType){var n=0===arguments.length,r=n?":get":":set",i=o[a(t)+r];if(i)var s=i(t,e);else{if(n)return(t.value||"").replace(/\r/g,"");t.value=e}}return n?s:this}},function(e,t,n){function a(e,t,n){var r=e.getAttribute("avalon-events");if(r&&(e.disabled!==!0||"click"!==t)){var o=[],i=p[t]||(p[t]=new RegExp("\\b"+t+"\\:([^,\\s]+)","g"));r.replace(i,function(e,t){return o.push(t),e}),o.length&&n.push({elem:e,uuids:o})}e=e.parentNode;var l=s.gestureEvents||{};e&&e.getAttribute&&(f[t]||l[t])&&a(e,t,n)}function r(e){e=new i(e);var t=e.type,n=e.target,r=[];a(n,t,r);for(var o,l,c,u=0;(c=r[u++])&&!e.cancelBubble;){var d=e.currentTarget=c.elem;for(o=0;l=c.uuids[o++];){if(h){h=!1;break}var f=s.eventListeners[l];if(f){var v=m.test(l)?c.elem._ms_context_:0;if(v&&v.$hashcode===!1)return s.unbind(n,t,f);var p=f.call(v||n,e,d._ms_local);p===!1&&(e.preventDefault(),e.stopPropagation())}}}}function o(e){var t=u.getAttribute("delegate-events")||"";if(t.indexOf(e)===-1){var n=t.match(s.rword)||[];n.push(e),u.setAttribute("delegate-events",n.join(",")),y(u,e,r,!!g[e])}}function i(e){if(e.originalEvent)return this;for(var t in e)b.test(t)||"function"==typeof e[t]||(this[t]=e[t]);this.timeStamp=new Date-0,this.originalEvent=e}var s=n(4),l=s.document,c=s.window,u=s.root,d=n(6).getShortID,f=n(32),v=s.eventHooks;s.bind=function(e,t,n){if(1===e.nodeType){var a=e.getAttribute("avalon-events")||"",i=d(n),c=v[t];c&&(t=c.type||t,c.fix&&(n=c.fix(e,n),n.uuid=i)),"click"===t&&s.modern&&l.ontouchstart&&e.addEventListener("click",s.noop);var u=t+":"+i;s.eventListeners[n.uuid]=n,a.indexOf(t+":")===-1&&(f[t]||g[t]?o(t):y(e,t,r));var p=a.split(",");""===p[0]&&p.shift(),p.indexOf(u)===-1&&(p.push(u),e.setAttribute("avalon-events",p.join(",")))}else y(e,t,n);return n},s.unbind=function(e,t,n){if(1===e.nodeType){var a=e.getAttribute("avalon-events")||"";switch(arguments.length){case 1:_(e,t,r),e.removeAttribute("avalon-events");break;case 2:a=a.split(",").filter(function(e){return e.indexOf(t+":")===-1}).join(","),e.setAttribute("avalon-events",a);break;default:var o=t+":"+n.uuid;a=a.split(",").filter(function(e){return e!==o}).join(","),e.setAttribute("avalon-events",a),delete s.eventListeners[n.uuid]}}else _(e,t,n)};var p={},m=/^e/,h=!1,g={focus:!0,blur:!0},y=function(e,t,n,a){e.addEventListener(t,n,a)},_=function(e,t,n){e.removeEventListener(t,n)},b=/^[A-Z_]+$/;i.prototype={preventDefault:function(){var e=this.originalEvent||{};this.returnValue=!1,e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent||{};this.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){h=!0,this.stopPropagation()},toString:function(){return"[object Event]"}},s.fireDom=function(e,t,n){var a=l.createEvent("Events");a.initEvent(t,!0,!0),s.shadowCopy(a,n),e.dispatchEvent(a)},"onmouseenter"in u||s.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){v[e]={type:t,fn:function(t,n){return function(a){var r=a.relatedTarget;if(!r||r!==t&&!(16&t.compareDocumentPosition(r)))return delete a.type,a.type=e,n.call(this,a)}}}}),s.each({AnimationEvent:"animationend",WebKitAnimationEvent:"webkitAnimationEnd"},function(e,t){c[e]&&!v.animationend&&(v.animationend={type:t})}),void 0===l.onmousewheel&&(v.mousewheel={type:"wheel",fn:function(e,t){return function(e){e.wheelDeltaY=e.wheelDelta=e.deltaY>0?-120:120,e.wheelDeltaX=0,Object.defineProperty(e,"type",{value:"mousewheel"}),t.call(this,e)}}}),s.fn.bind=function(e,t,n){if(this[0])return s.bind(this[0],e,t,n)},s.fn.unbind=function(e,t,n){return this[0]&&s.unbind(this[0],e,t,n),this}},function(e,t,n){var a,r=n(4),o=n(34),i=r.document,s=[],l=function(e){for(a=!0;e=s.shift();)e(r)};r.ready=function(e){a?e(r):s.push(e)},r.ready(function(){o(i.body)}),new function(){r.browser&&("complete"===i.readyState?setTimeout(l):i.addEventListener("DOMContentLoaded",l),r.bind(window,"load",l))}},function(e,t,n){n(38),n(40),n(97),n(42),n(43),n(44),n(45),n(46),n(47),n(48),n(98),n(57),n(58),n(59),n(60),n(61),n(65)},function(e,t,n){var a=n(91),r=n(42);avalon.directive("attr",{diff:r.diff,update:a})},function(e,t,n){function a(e){for(var t,n=0;t=this.parsers[n++];){var a=avalon.parsers[t];a&&(e=a.call(this,e))}return e}var r=n(39),o=n(50),i=/\|\s*change\b/,s=/^(?:checkbox|radio)$/,l=/\|\s*debounce(?:\(([^)]+)\))?/,c=n(99),u=n(54),d=n(52),f=n(100),v=n(56),p="ms-duplex";avalon.directive("duplex",{priority:2e3,parse:function(e,t,n){var a,r=n.expr,c=t.props.type,u=n.param,d=!1;u=u?u.split("-").map(function(e){return"checked"===e&&(d=!0),e}):[],s.test(c)&&d&&(u=[],a="radio"),/input|textarea|select/.test(t.nodeName)?a||(a="select"===t.nodeName?"select":"checkbox"===c?"checkbox":"radio"===c?"radio":"input"):"contenteditable"in t.props&&(a="contenteditable");var f=!1,v=0;if("input"===a||"contenteditable"===a){var m=!0;if(i.test(r)&&(f=!0),!f){var h=r.match(l);h&&(v=parseInt(h[1],10)||300)}}var g=e.props["data-duplex-changed"],y=avalon.parseExpr(n),_=u.map(function(e){return avalon.quote(e)});e[p]=o({type:a,vmodel:"__vmodel__",local:"__local__",debug:avalon.quote(n.name+"="+n.expr),isChecked:d,parsers:"["+_+"]",isString:!!m,isChanged:f,debounceTime:v,get:y,set:avalon.evaluatorPool.get("duplex:set:"+r),callback:g?avalon.parseExpr({expr:g,type:"on"}):"avalon.noop"})},diff:function(e,t){if(t.dynamic[p])n=t[p];else{var n=t[p]=e[p];n.parse=a}e!==t&&(e[p]=null);var o=n.get(n.vmodel),i=n.value;if(n.isString){if(o=n.parse(o),o+="",o===i)return}else if(Array.isArray(o)){var s=!0;if(o+""===n.arrayHack)return}n.value=o,s&&(n.arayHack=o+""),r(t,this.update,"afterChange")},update:function(e,t){if(e&&1===e.nodeType){t.dynamic[p]=1,e.__ms_duplex__||(e.__ms_duplex__=avalon.mix(t[p],{dom:e}),c(e,t),v(e,t));var n=e.__ms_duplex__;if(n.dom=e,n.isString&&!avalon.msie&&u===!1&&!e.valueHijack){e.valueHijack=d;var a=setInterval(function(){avalon.contains(avalon.root,e)?e.valueHijack({type:"poll"}):clearInterval(a)},30)}f[n.type].call(n)}}})},function(e,t,n){function a(e,t){var n={},a=t["ms-duplex"];switch(a.update=d,a.type){case"radio":case"checkbox":n.click=d;break;case"select":n.change=d;break;case"contenteditable":a.isChanged?n.blur=d:(v.webkitURL?n.webkitEditableContentChanged=d:v.MutationEvent&&(n.DOMCharacterDataModified=d),n.input=d);break;case"input":a.isChanged?n.change=d:(n.input=d,n.compositionstart=s,n.compositionend=l,avalon.msie&&(n.keyup=r))}/password|text/.test(t.props.type)&&(n.focus=o,n.blur=i,a.getCaret=c,a.setCaret=u);for(var f in n)avalon.bind(e,f,n[f])}function r(e){var t=e.keyCode;91===t||15<t&&t<19||37<=t&&t<=40||d.call(this,e)}function o(){this.caret=!0}function i(){this.caret=!1}function s(){this.composing=!0}function l(e){this.composing=!1;var t=this;setTimeout(function(){d.call(t,e)},0)}function c(e){var t=NaN;return e.setSelectionRange&&(t=e.selectionStart),t}function u(e,t){e.value&&!e.readOnly&&(e.selectionStart=t,e.selectionEnd=t)}var d=n(52),f=n(6).getShortID,v=(avalon.msie,avalon.window);avalon.document;f(o),f(i),f(s),f(l),f(r),f(d),e.exports=a},function(e,t){var n={input:function(){this.dom.value=this.value},radio:function(){var e;e=this.isChecked?!!this.value:this.value+""===this.dom.value;var t=this.dom;t.checked=e},checkbox:function(){for(var e=!1,t=this.dom,n=t.value,a=0;a<this.value.length;a++){var r=this.value[a];r+""===n&&(e=!0)}t.checked=e},select:function(){var e=Array.isArray(this.value)?this.value.map(String):this.value+"";avalon(this.dom).val(e)},contenteditable:function(){this.dom.innerHTML=this.value,this.update.call(this.dom)}};e.exports=n},function(e,t,n){function a(){}function r(e,t,n){var r={};e.$skipArray&&(r=avalon.oneObject(e.$skipArray),delete e.$skipArray);var o={};n=n||{},t=t||{};var i={},s=h("$"),l=n.pathname||"";n.id=n.id||s,n.hashcode=s;var u,m,g;for(u in e)if(!d[u]){var y=o[u]=e[u];c(u,y,r)||(m=n.id+"."+u,g=l?l+"."+u:u,i[u]=f(m,g,t))}i.$model=p;var _=new a;Object.defineProperties(_,i);for(u in o)_[u]=o[u],u in r?delete o[u]:o[u]=!0;return v(_,t,o,i,n),_}function o(e,t,n,a){var r={},o={},i=a.pathname;n=n||{};var s,l,u;for(s in t)if(!d[s]&&(r[s]=t[s],!c(s,t[s],g))){var m=Object.getOwnPropertyDescriptor(e,s);m&&m.get?o[s]=m:(l=a.id+"."+s,u=i?i+"."+s:s,o[s]=f(l,u,n))}for(s in e)delete e[s];a.hashcode=e.$hashcode||h("$"),o.$model=p;var y=e;Object.defineProperties(y,o);for(s in r)o[s]||(y[s]=r[s]),r[s]=!0;return v(y,n,r,o,a),y}function i(e,t){for(var n,r,o={},i={},s={},l={},u={},p=avalon.slice(arguments),m="function"==typeof this&&this.isWidget,g=0;g<p.length;g++){var y=p[g];for(var _ in y){var b=y[_];if("$skipArray"!==_)if(m&&p.indexOf(b)!==-1)n=b,r=_;else{var w=Object.getOwnPropertyDescriptor(y,_);o[_]=b,i[_]&&avalon.isObject(b)&&delete i[_],w.set?i[_]=w:"function"!=typeof o[_]&&(s[_]=1)}else Array.isArray(b)&&b.forEach(function(e){u[e]=1})}}"function"==typeof this&&this(o,s);for(_ in s)d[_]||i[_]||c(_,o[_],u)||(i[_]=f(e.$id+"."+_,_,l),i[_].set(o[_]));var x=new a;Object.defineProperties(x,i);for(_ in o){if(i[_]||(x[_]=o[_]),m&&n&&i[_]&&n.hasOwnProperty(_)){var $=i[_].get;$.$decompose||($.$decompose={}),$.$decompose[r+"."+_]=x}o[_]=!0}return v(x,l,o,i,{id:e.$id,hashcode:h("$"),master:!0}),x}function s(e,t){e.length!==t&&e.notify("length",e.length,t,!0)}var l=n(102),c=l.isSkip,u=l.$$midway,d=l.$$skipArray;delete d.$accessors,delete d.__data__,delete d.__proxy__,delete d.__const__;var f=l.makeAccessor,v=l.initViewModel,p=l.modelAccessor,m=l.modelAdaptor,h=avalon.makeHashCode;u.masterFactory=r;var g={};u.slaveFactory=o,u.mediatorFactory=avalon.mediatorFactory=i;var y=l.__array__,_=Array.prototype,b=_.splice;y.removeAll=function(e){var t=this.length;if(Array.isArray(e))for(var n=this.length-1;n>=0;n--)e.indexOf(this[n])!==-1&&b.call(this,n,1);else if("function"==typeof e)for(n=this.length-1;n>=0;n--){var a=this[n];e(a,n)&&b.call(this,n,1)}else b.call(this,0,this.length);s(this,t),this.notify()};var w=["push","pop","shift","unshift","splice"];w.forEach(function(e){var t=_[e];y[e]=function(n,a){var r=[],o=this.length;if("splice"===e&&Object(this[0])===this[0])for(var i=this.slice(n,a),l=_.slice.call(arguments,2),r=[n,a],c=0,u=l.length;c<u;c++){var d=i[c];r[c+2]=m(l[c],d,d&&d.$events||{},{id:this.$id+".*",master:!0})}else for(var f=0,v=arguments.length;f<v;f++)r[f]=m(arguments[f],0,{},{id:this.$id+".*",master:!0});var p=t.apply(this,r);return s(this,o),this.notify(),p}}),"sort,reverse".replace(avalon.rword,function(e){y[e]=function(){return _[e].apply(this,arguments),this.notify(),this}}),e.exports=avalon},function(e,t,n){function a(e){var t=avalon.type(e);if("array"===t){for(var n=[],r=0;r<e.length;r++)n[r]=a(e[r]);return n}if("object"===t){var o={};for(r in e)if(e.hasOwnProperty(r)){var i=e[r];o[r]=i&&i.nodeType?i:a(i)}return o}return e}function r(e,t,n){Object.defineProperty(e,t,{value:n,writable:!0,enumerable:!1,configurable:!0})}function o(e,t,n,a,o){function l(e){return n[e]===!0}o.array?Object.defineProperty(e,"$model",u):r(e,"hasOwnProperty",l),r(e,"$id",o.id),r(e,"$hashcode",o.hashcode),r(e,"$track",Object.keys(n).sort().join(";;")),o.master===!0&&(r(e,"$run",s),r(e,"$wait",i),r(e,"$element",null),r(e,"$render",0),c(e,t))}function i(){this.$events.$$wait$$=!0}function s(){var e=this.$events;if(delete e.$$wait$$,e.$$dirty$$){delete e.$$dirty$$,avalon.rerenderStart=new Date;var t=this.$id,n=t.indexOf(".");n>0?avalon.batch(t.slice(0,n)):avalon.batch(t)}}var l=n(80),c=l.initEvents,u={get:function(){return a(this)},set:avalon.noop,enumerable:!1,configurable:!0};l.$$midway.hideProperty=r,l.$$midway.initViewModel=o;var d={toJson:a,initViewModel:o,modelAccessor:u};for(var f in l)d[f]=l[f];e.exports=d}])});
//# sourceMappingURL=avalon.modern.min.js.map