!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.avalon=n():e.avalon=n()}(this,function(){return function(e){function n(a){if(t[a])return t[a].exports;var r=t[a]={exports:{},id:a,loaded:!1};return e[a].call(r.exports,r,r.exports,n),r.loaded=!0,r.exports}var t={};return n.m=e,n.c=t,n.p="",n(0)}([function(e,n,t){var a=t(86);t(8),t(88),t(90),t(98),t(71),t(106),a.onComponentDispose=t(105),e.exports=a},,,function(e,n){(function(n){function t(e){return new t.init(e)}n.avalon=t,"undefined"!=typeof window&&(window.avalon=t),t.init=function(e){this[0]=this.element=e},t.fn=t.prototype=t.init.prototype,t.shadowCopy=function(e,n){for(var t in n)e[t]=n[t];return e};var a=/[^, ]+/g,r=n.console;t.shadowCopy(t,{noop:function(){},rword:a,inspect:{}.toString,ohasOwn:{}.hasOwnProperty,log:function(){r&&t.config.debug&&Function.apply.call(console.log,console,arguments)},warn:function(){if(r&&t.config.debug){var e=console.warn||console.log;Function.apply.call(e,console,arguments)}},error:function(e,n){throw(n||Error)(e)},oneObject:function(e,n){"string"==typeof e&&(e=e.match(a)||[]);for(var t={},r=void 0!==n?n:1,o=0,i=e.length;i>o;o++)t[e[o]]=r;return t}}),e.exports=t}).call(n,function(){return this}())},function(e,n){(function(n){var t=n,a={window:t,document:{createElement:function(){return{}},createElementNS:function(){return{}},contains:Boolean},root:{outerHTML:"x"},msie:NaN,modern:!0,avalonDiv:{},avalonFragment:null};if(t.location&&t.navigator&&t.window){var r=t.document;a.document=r,a.modern=t.dispatchEvent,a.root=r.documentElement,a.avalonDiv=r.createElement("div"),a.avalonFragment=r.createDocumentFragment(),t.VBArray&&(a.msie=r.documentMode||(t.XMLHttpRequest?7:6))}e.exports=a}).call(n,function(){return this}())},,function(e,n){function t(e,n,t){e[t.name]=avalon.parseExpr(t)}var a={},r=/([a-z\d])([A-Z]+)/g,o=/[-_][^-_]/g,i=/\d\.\d{4}/,l=/[-.*+?^${}()|[\]\/\\]/g,s=[].slice;avalon.shadowCopy(avalon,{caches:{},vmodels:{},filters:{},components:{},directives:{},eventHooks:{},eventListeners:{},validators:{},scopes:{},cssHooks:a,parsers:{number:function(e){return""===e?"":/\d\.$/.test(e)?e:parseFloat(e)||0},string:function(e){return null===e||void 0===e?"":e+""},"boolean":function(e){return""===e?e:"true"===e||"1"==e}},version:"2.112",slice:function(e,n,t){return s.call(e,n,t)},css:function(e,n,t,r){if(e instanceof avalon&&(e=e[0]),1===e.nodeType){var o=avalon.camelize(n);if(n=avalon.cssName(o)||o,void 0===t||"boolean"==typeof t){r=a[o+":get"]||a["@:get"],"background"===n&&(n="backgroundColor");var i=r(e,n);return t===!0?parseFloat(i)||0:i}if(""===t)e.style[n]="";else{if(null==t||t!==t)return;isFinite(t)&&!avalon.cssNumber[o]&&(t+="px"),r=a[o+":set"]||a["@:set"],r(e,n,t)}}},directive:function(e,n){return n.parse=n.parse||t,this.directives[e]=n},isObject:function(e){return null!==e&&"object"==typeof e},range:function(e,n,t){t||(t=1),null==n&&(n=e||0,e=0);for(var a=-1,r=Math.max(0,Math.ceil((n-e)/t)),o=new Array(r);++a<r;)o[a]=e,e+=t;return o},hyphen:function(e){return e.replace(r,"$1-$2").toLowerCase()},camelize:function(e){return!e||e.indexOf("-")<0&&e.indexOf("_")<0?e:e.replace(o,function(e){return e.charAt(1).toUpperCase()})},makeHashCode:function(e){return e=e||"avalon",String(Math.random()+Math.random()).replace(i,e)},escapeRegExp:function(e){return(e+"").replace(l,"\\$&")},Array:{merge:function(e,n){e.push.apply(e,n)},ensure:function(e,n){return-1===e.indexOf(n)?e.push(n):void 0},removeAt:function(e,n){return!!e.splice(n,1).length},remove:function(e,n){var t=e.indexOf(n);return~t?avalon.Array.removeAt(e,t):!1}}}),"undefined"!=typeof performance&&performance.now&&(avalon.makeHashCode=function(e){return e=e||"avalon",(e+performance.now()).replace(".","")});var c=1;e.exports={avalon:avalon,getLongID:function(e){return e.uuid||(e.uuid=avalon.makeHashCode("e"))},getShortID:function(e){return e.uuid||(e.uuid="_"+ ++c)}}},function(e,n){function t(e){for(var n in e)if(avalon.ohasOwn.call(e,n)){var a=e[n];"function"==typeof t.plugins[n]?t.plugins[n](a):"object"==typeof t[n]?avalon.shadowCopy(t[n],a):t[n]=a}return this}avalon.config=t;var a={interpolate:function(e){var n=e[0],a=e[1];if(n===a)throw new SyntaxError("openTag!==closeTag");var r=n+"test"+a,o=avalon.avalonDiv;if(o.innerHTML=r,o.innerHTML!==r&&o.innerHTML.indexOf("&lt;")>-1)throw new SyntaxError("此定界符不合法");o.innerHTML="",t.openTag=n,t.closeTag=a;var i=avalon.escapeRegExp(n),l=avalon.escapeRegExp(a);t.rexpr=new RegExp(i+"([\\s\\S]*)"+l)}};t.plugins=a,avalon.config({interpolate:["{{","}}"],debug:!0})},function(e,n,t){function a(e){return e}var r=t(9),o=t(10),i=t(11),l=t(12),s=t(13),c=avalon.filters;avalon.__format__=function(e){var n=c[e];return n?n.get?n.get:n:a},avalon.mix(c,{uppercase:function(e){return String(e).toUpperCase()},lowercase:function(e){return String(e).toLowerCase()},truncate:function(e,n,t){return n=n||30,t="string"==typeof t?t:"...",e.length>n?e.slice(0,n-t.length)+t:String(e)},camelize:avalon.camelize,date:i,escape:avalon.escapeHtml,sanitize:o,number:r,currency:function(e,n,t){return(n||"￥")+r(e,isFinite(t)?t:2)}},l,s),e.exports=avalon},function(e,n){function t(e,n,t,a){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var r=isFinite(+e)?+e:0,o=isFinite(+n)?Math.abs(n):3,i=a||",",l=t||".",s="",c=function(e,n){var t=Math.pow(10,n);return""+(Math.round(e*t)/t).toFixed(n)};return s=(o?c(r,o):""+Math.round(r)).split("."),s[0].length>3&&(s[0]=s[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,i)),(s[1]||"").length<o&&(s[1]=s[1]||"",s[1]+=new Array(o-s[1].length+1).join("0")),s.join(l)}e.exports=t},function(e,n){var t=/<script[^>]*>([\S\s]*?)<\/script\s*>/gim,a=/\s+(on[^=\s]+)(?:=("[^"]*"|'[^']*'|[^\s>]+))?/g,r=/<\w+\b(?:(["'])[^"]*?(\1)|[^>])*>/gi,o={a:/\b(href)\=("javascript[^"]*"|'javascript[^']*')/gi,img:/\b(src)\=("javascript[^"]*"|'javascript[^']*')/gi,form:/\b(action)\=("javascript[^"]*"|'javascript[^']*')/gi};e.exports=function(e){return e.replace(t,"").replace(r,function(e,n){var t=e.toLowerCase().match(/<(\w+)\s/);if(t){var r=o[t[1]];r&&(e=e.replace(r,function(e,n,t){var a=t.charAt(0);return n+"="+a+"javascript:void(0)"+a}))}return e.replace(a," ").replace(/\s+/g," ")})}},function(e,n){function t(e){return parseInt(e,10)||0}function a(e,n,t){var a="";for(0>e&&(a="-",e=-e),e=""+e;e.length<n;)e="0"+e;return t&&(e=e.substr(e.length-n)),a+e}function r(e,n,t,r){return function(o){var i=o["get"+e]();return(t>0||i>-t)&&(i+=t),0===i&&-12===t&&(i=12),a(i,n,r)}}function o(e,n){return function(t,a){var r=t["get"+e](),o=(n?"SHORT"+e:e).toUpperCase();return a[o][r]}}function i(e){var n=-1*e.getTimezoneOffset(),t=n>=0?"+":"";return t+=a(Math[n>0?"floor":"ceil"](n/60),2)+a(Math.abs(n%60),2)}function l(e,n){return e.getHours()<12?n.AMPMS[0]:n.AMPMS[1]}function s(e,n){var a,r,o=s.locate,i="",l=[];if(n=n||"mediumDate",n=o[n]||n,"string"==typeof e)if(/^\d+$/.test(e))e=t(e);else if(d.test(e))e=+RegExp.$1;else{var v=e.trim(),f=[0,0,0,0,0,0,0],p=new Date(0);v=v.replace(/^(\d+)\D(\d+)\D(\d+)/,function(e,n,a,r){var o=4===r.length?[r,n,a]:[n,a,r];return f[0]=t(o[0]),f[1]=t(o[1])-1,f[2]=t(o[2]),""});var m=p.setFullYear,h=p.setHours;v=v.replace(/[T\s](\d+):(\d+):?(\d+)?\.?(\d)?/,function(e,n,a,r,o){return f[3]=t(n),f[4]=t(a),f[5]=t(r),o&&(f[6]=Math.round(1e3*parseFloat("0."+o))),""});var g=0,y=0;v=v.replace(/Z|([+-])(\d\d):?(\d\d)/,function(e,n,a,r){return m=p.setUTCFullYear,h=p.setUTCHours,n&&(g=t(n+a),y=t(n+r)),""}),f[3]-=g,f[4]-=y,m.apply(p,f.slice(0,3)),h.apply(p,f.slice(3)),e=p}if("number"==typeof e&&(e=new Date(e)),"date"===avalon.type(e)){for(;n;)r=u.exec(n),r?(l=l.concat(r.slice(1)),n=l.pop()):(l.push(n),n=null);return l.forEach(function(n){a=c[n],i+=a?a(e,o):n.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),i}}var c={yyyy:r("FullYear",4),yy:r("FullYear",2,0,!0),y:r("FullYear",1),MMMM:o("Month"),MMM:o("Month",!0),MM:r("Month",2,1),M:r("Month",1,1),dd:r("Date",2),d:r("Date",1),HH:r("Hours",2),H:r("Hours",1),hh:r("Hours",2,-12),h:r("Hours",1,-12),mm:r("Minutes",2),m:r("Minutes",1),ss:r("Seconds",2),s:r("Seconds",1),sss:r("Milliseconds",3),EEEE:o("Day"),EEE:o("Day",!0),a:l,Z:i},u=/((?:[^yMdHhmsaZE']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z))(.*)/,d=/^\/Date\((\d+)\)\/$/,v={AMPMS:{0:"上午",1:"下午"},DAY:{0:"星期日",1:"星期一",2:"星期二",3:"星期三",4:"星期四",5:"星期五",6:"星期六"},MONTH:{0:"1月",1:"2月",2:"3月",3:"4月",4:"5月",5:"6月",6:"7月",7:"8月",8:"9月",9:"10月",10:"11月",11:"12月"},SHORTDAY:{0:"周日",1:"周一",2:"周二",3:"周三",4:"周四",5:"周五",6:"周六"},fullDate:"y年M月d日EEEE",longDate:"y年M月d日",medium:"yyyy-M-d H:mm:ss",mediumDate:"yyyy-M-d",mediumTime:"H:mm:ss","short":"yy-M-d ah:mm",shortDate:"yy-M-d",shortTime:"ah:mm"};v.SHORTMONTH=v.MONTH,s.locate=v,e.exports=s},function(e,n){function t(e,n,t){var a=avalon.type(e);if("array"!==a&&"object"!==a)throw"orderBy只能处理对象或数组";var r=t&&0>t?-1:1;if("string"==typeof n){var o=n;n=function(e){return e&&e[o]}}e=l(e),e.forEach(function(e){e.order=n(e.value,e.key)}),e.sort(function(e,n){var t=e.order,a=n.order;return Number.isNaN(t)&&Number.isNaN(a)?0:t===a?0:t>a?r:-r});var s="array"===a,c=s?[]:{};return i(c,e,function(e){s?c.push(e.value):c[e.key]=e.value})}function a(e,n){console.log(e,n);var t=avalon.type(e);if("array"!==t&&"object"!==t)throw"filterBy只能处理对象或数组";var a=avalon.slice(arguments,2),r=avalon.type(n);if("function"===r)var o=n;else{if("string"!==r&&"number"!==r)return e;if(""===n)return e;var s=new RegExp(avalon.escapeRegExp(n),"i");console.log(s),o=function(e){return console.log(e),s.test(e)}}e=l(e).filter(function(e,n){return!!o.apply(e,[e.value,n].concat(a))});var c="array"===t,u=c?[]:{};return i(u,e,function(e){c?u.push(e.value):u[e.key]=e.value})}function r(e,n,t){if(avalon.isObject(e)&&!Array.isArray(e)){var a=[];return i(a,n,function(n){a.push(e.hasOwnProperty(n)?e[n]:t?t[n]:"")})}return e}function o(e,n,t){var a=avalon.type(e);if("array"!==a&&"object"!==a)throw"limitBy只能处理对象或数组";if("number"!=typeof n)return e;if(Number.isNaN(n))return e;"object"===a&&(e=l(e));var r=e.length;n=Math.min(r,n),t="number"==typeof t?t:0,0>t&&(t=Math.max(0,r+t));for(var o=[],s=t;r>s&&(o.push(e[s]),o.length!==n);s++);var c="array"===a;if(c)return o;var u={};return i(u,o,function(e){u[e.key]=e.value})}function i(e,n,t){for(var a=0,r=n.length;r>a;a++)t(n[a]);return e}function l(e){var n=[],t=0;return avalon.each(e,function(e,a){n[t++]={value:a,key:e}}),n}Number.isNaN=Number.isNaN||function(e){return e!==e},e.exports={limitBy:o,orderBy:t,selectBy:r,filterBy:a}},function(e,n){var t={stop:function(e){return e.stopPropagation(),e},prevent:function(e){return e.preventDefault(),e}},a={esc:27,tab:9,enter:13,space:32,del:46,up:38,left:37,right:39,down:40};avalon.each(a,function(e,n){t[e]=function(e){return e.which!==n&&(e.$return=!0),e}}),e.exports=t},,function(e,n,t){function a(e){this.nodeName="#text",this.nodeValue=e,this.skipContent=!r.test(e)}var r=avalon.config.rexpr,o=t(16);a.prototype={constructor:a,toDOM:function(){if(this.dom)return this.dom;var e=o(this.nodeValue);return this.dom=document.createTextNode(e)},toHTML:function(){return this.nodeValue}},e.exports=a},function(e,n){var t=/&[a-z0-9#]{2,10};/,a=avalon.avalonDiv;e.exports=function(e){return t.test(e)?(a.innerHTML=e,a.innerText||a.textContent):e}},function(e,n){function t(e){this.nodeName="#comment",this.nodeValue=e}t.prototype={constructor:t,toDOM:function(){return this.dom=document.createComment(this.nodeValue)},toHTML:function(){return"<!--"+this.nodeValue+"-->"+(this.template||"")}},e.exports=t},,function(e,n){function t(e){this.nodeName="#document-fragment",this.children=e}t.prototype={constructor:t,toDOM:function(){if(this.dom)return this.dom;for(var e,n=document.createDocumentFragment(),t=0;e=this.children[t++];)n.appendChild(avalon.vdomAdaptor(e,"toDOM"));return this.split=n.lastChild,this.dom=n},toHTML:function(){return this.children.map(function(e){return avalon.vdomAdaptor(e,"toHTML")}).join("")}},e.exports=t},,,,,function(e,n){var t={"accept-charset":"acceptCharset","char":"ch",charoff:"chOff","class":"className","for":"htmlFor","http-equiv":"httpEquiv"},a=["autofocus,autoplay,async,allowTransparency,checked,controls","declare,disabled,defer,defaultChecked,defaultSelected,","isMap,loop,multiple,noHref,noResize,noShade","open,readOnly,selected"].join(",");a.replace(/\w+/g,function(e){t[e.toLowerCase()]=e});var r=["accessKey,bgColor,cellPadding,cellSpacing,codeBase,codeType,colSpan","dateTime,defaultValue,contentEditable,frameBorder,longDesc,maxLength,marginWidth,marginHeight,rowSpan,tabIndex,useMap,vSpace,valueType,vAlign"].join(",");r.replace(/\w+/g,function(e){t[e.toLowerCase()]=e}),e.exports=t},,,,function(e,n,t){var a=t(29),r=t(30),o=/<|&#?\w+;/,i=new a(128),l=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi;avalon.parseHTML=function(e){var n=avalon.avalonFragment.cloneNode(!1);if("string"!=typeof e)return n;if(!o.test(e))return document.createTextNode(e);e=e.replace(l,"<$1></$2>").trim();var t=i.get(e);if(t)return r(t);for(var a,s=avalon.lexer(e),c=0;a=s[c++];)n.appendChild(avalon.vdomAdaptor(a,"toDOM"));return e.length<1024&&i.put(e,r(n)),n},avalon.innerHTML=function(e,n){if(!avalon.modern&&!rcreate.test(n)&&!rnest.test(n))try{return void(e.innerHTML=n)}catch(t){}var a=this.parseHTML(n);this.clearHTML(e).appendChild(a)};var s=/&(?:amp|lt|gt|quot|#39|#96);/g,c={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"};avalon.unescapeHTML=function(e){var n=""+e;return n.replace(s,function(e){return c[e]})};var u=/["'&<>]/;avalon.escapeHTML=function(e){var n=""+e,t=u.exec(n);if(!t)return n;var a,r="",o=0,i=0;for(o=t.index;o<n.length;o++){switch(n.charCodeAt(o)){case 34:a="&quot;";break;case 38:a="&amp;";break;case 39:a="&#39;";break;case 60:a="&lt;";break;case 62:a="&gt;";break;default:continue}i!==o&&(r+=n.substring(i,o)),i=o+1,r+=a}return i!==o?r+n.substring(i,o):r},avalon.clearHTML=function(e){for(e.textContent="";e.lastChild;)e.removeChild(e.lastChild);return e}},function(e,n){function t(e){this.size=0,this.limit=e,this.head=this.tail=void 0,this._keymap={}}var a=t.prototype;a.put=function(e,n){var t={key:e,value:n};return this._keymap[e]=t,this.tail?(this.tail.newer=t,t.older=this.tail):this.head=t,this.tail=t,this.size===this.limit?this.shift():this.size++,n},a.shift=function(){var e=this.head;e&&(this.head=this.head.newer,this.head.older=e.newer=e.older=this._keymap[e.key]=void 0,delete this._keymap[e.key])},a.get=function(e){var n=this._keymap[e];if(void 0!==n)return n===this.tail?n.value:(n.newer&&(n===this.head&&(this.head=n.newer),n.newer.older=n.older),n.older&&(n.older.newer=n.newer),n.newer=void 0,n.older=this.tail,this.tail&&(this.tail.newer=n),this.tail=n,n.value)},e.exports=t},function(e,n){function t(e,n){if(1===e.nodeType){var t=e.nodeName.toLowerCase();"object"===t?e.parentNode&&(e.outerHTML=n.outerHTML):"input"===t&&o.test(n.nodeName)?(e.defaultChecked=e.checked=n.checked,e.value!==n.value&&(e.value=n.value)):"option"===t?e.defaultSelected=e.selected=n.defaultSelected:"input"!==t&&"textarea"!==t||(e.defaultValue=n.defaultValue)}}function a(e){return"undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName("*"):"undefined"!=typeof e.querySelectorAll?e.querySelectorAll("*"):[]}function r(e){var n=e.cloneNode(!0);if(avalon.modern)return n;var r=a(n),o=a(e);return avalon.each(o,function(e){t(r[e],o[e])}),n}var o=/radio|checkbox/;e.exports=r},,function(e,n){e.exports={click:!0,dblclick:!0,keydown:!0,keypress:!0,keyup:!0,mousedown:!0,mousemove:!0,mouseup:!0,mouseover:!0,mouseout:!0,wheel:!0,mousewheel:!0,input:!0,change:!0,beforeinput:!0,compositionstart:!0,compositionupdate:!0,compositionend:!0,select:!0,cut:!0,copy:!0,paste:!0,beforecut:!0,beforecopy:!0,beforepaste:!0,focusin:!0,focusout:!0,DOMFocusIn:!0,DOMFocusOut:!0,DOMActivate:!0,dragend:!0,datasetchanged:!0}},,function(e,n,t){function a(e){for(var n,t=0;n=e[t++];)if(1===n.nodeType){var l=r(n),s=avalon.vmodels[l];if(s&&!s.$element){avalon(n).removeClass("ms-controller"),s.$element=n;var c=i(n),u=new Date;n.vtree=avalon.speedUp(c);var d=new Date;o&&avalon.log("构建虚拟DOM耗时",d-u,"ms"),s.$render=avalon.render(n.vtree),avalon.scopes[s.$id]={vmodel:s,local:{},isTemp:!0};var v=new Date;o&&avalon.log("构建当前vm的$render方法耗时 ",v-d,"ms\n","如果此时间太长,达100ms以上\n","建议将当前ms-controller拆分成多个ms-controller,减少每个vm管辖的区域"),avalon.rerenderStart=v,o=!1,avalon.batch(l)}else l||a(n.childNodes)}}function r(e){return e.getAttribute("ms-controller")||e.getAttribute(":controller")}var o=!0,i=t(35);e.exports=avalon.scan=function(e){return e&&e.nodeType?void a([e]):void avalon.warn("[avalon.scan] first argument must be element , documentFragment, or document")}},function(e,n,t){function a(e){for(var n=e.attributes,t={},a=0,o=n.length;o>a;a++){var i=n[a];if(i.specified){var l=i.name;":"===l.charAt(0)&&(l=l.replace(d,"ms-")),t[l]=i.value}}u.test(e.nodeName)&&(t.type=e.type);var s=e.style.cssText;return s&&(t.style=s),"select-one"===t.type&&(t.selectedIndex=e.selectedIndex),r(t)?null:t}function r(e){for(var n in e)return!1;return!0}function o(e){var n={},t=e.nodeName.toLowerCase();if(n.nodeName=t,n.dom=e,"#"===t.charAt(0)){var o=e.nodeValue;/\S/.test(o)&&(n.nodeValue=o)}else{var i=a(e);c[t]&&(n.isVoidTag=!0),i&&(n.props=i),n.children=l(e.childNodes,e),i&&"selectedIndex"in n&&(e.selectedIndex=n.selectedIndex,delete n.selectedIndex,r(i)&&delete n.props)}return n}function i(e){return l([e],null)}function l(e,n){var t=[];e=avalon.slice(e);for(var a=0;a<e.length;a++){var r=e[a];switch(r.nodeType){case 1:var i=r.getAttributeNode(":for")||r.getAttributeNode("ms-for");if(i){var l=document.createComment("ms-for:"+i.value),c=document.createComment("ms-for-end:");r.removeAttributeNode(i),n&&(n.insertBefore(c,r.nextSibling),n.insertBefore(l,r)),t.push(o(l),o(r),o(c))}else t.push(o(r));break;case 3:/\S/.test(r.nodeValue)?t.push(o(r)):s(r);break;case 8:t.push(o(r))}}return t}function s(e){return v.appendChild(e),v.removeChild(e),e}var c=t(36),u=(t(37),/input|textarea|select/i),d=/^\:/,v=document.documentElement;e.exports=i},function(e,n){e.exports=avalon.oneObject("area,base,basefont,bgsound,br,col,command,embed,frame,hr,img,input,keygen,link,meta,param,source,track,wbr")},function(e,n,t){function a(e,n){for(var t,a=n?[]:["\nvar vnodes = [];"],o=0;t=e[o++];){var i=r(t);t.$prepend&&a.push(t.$prepend);var l=t.$append;delete t.$append,delete t.$prepend,i&&a.push(i+"\n"),l&&a.push(l)}return n||a.push("return vnodes\n"),a.join("\n")}function r(e){if(!e.nodeName)return!1;switch(e.nodeName){case"#text":return e.dynamic?i(s(e)):l(e);case"#comment":var n=e.nodeValue;if(e.forExpr){var t={dynamic:!0,vmodel:"__vmodel__"};for(var r in e)e.hasOwnProperty(r)&&!y[r]&&(t[r]=e[r]);return avalon.directives["for"].parse(t,e,e),e.$append+=avalon.caches[e.signature],l(t)}if("ms-for-end:"===n)return e.$append=l({nodeName:"#comment",nodeValue:e.signature})+" return vnodes}\n })\n},__local__,vnodes)\n"+l({nodeName:"#comment",signature:e.signature,nodeValue:"ms-for-end:"})+"\n","";if(0===n.indexOf("ms-js:")){var o=v(n.replace("ms-js:",""),"js")+"\n",c=l(e),f=o.match(g);return f&&f[1]?e.$append=(e.$append||"")+o+"\n__local__."+f[1]+" = "+f[1]+"\n":avalon.warn(n+" parse fail!"),c}return l(e);default:if(!e.dynamic&&e.skipContent)return l(e);var t={nodeName:e.nodeName},p=e.props;if(e.dynamic){t.dynamic="{}";var m=u(t,p);m.map(function(n){return avalon.directives[n.type].parse(t,e,n),n.name})}else if(p){t.props={};for(var r in p)t.props[r]=p[r]}if(e.isVoidTag)t.isVoidTag=!0;else if(!("children"in t)){var h=e.children;h&&(e.skipContent?t.children="["+h.map(function(e){return d(e)})+"]":1===h.length&&"#text"===h[0].nodeName?h[0].dynamic?t.children="["+s(h[0])+"]":t.children="["+d(h[0])+"]":t.children="(function(){"+a(h)+"})()")}return e.template&&(t.template=e.template),e.skipContent&&(t.skipContent=!0),l(t)}}function o(e){return h.test(e)?e:v(e,"text")}function i(e){return"vnodes.push("+e+");"}function l(e){return i(d(e))}function s(e){var n=c(e.nodeValue),t="";if(1===n.length)t=o(n[0].expr);else{var a=n.map(function(e){return e.type?o(e.expr):m(e.expr)}).join(" + ");t="String("+a+")"}return'{\nnodeName: "#text",\ndynamic:true,\nnodeValue: '+t+"\n}"}function c(e){var n=[];do{var t=e.indexOf(p.openTag);t=-1===t?e.length:t;var a=e.slice(0,t);if(/\S/.test(a)&&n.push({expr:f(a)}),e=e.slice(t+p.openTag.length)){t=e.indexOf(p.closeTag);var a=e.slice(0,t);n.push({expr:avalon.unescapeHTML(a.replace(_,"")),type:"{{}}"}),e=e.slice(t+p.closeTag.length)}}while(e.length);return n}var u=t(38),d=t(39),v=t(40),f=t(16),p=avalon.config,m=avalon.quote,h=/^[$a-zA-Z_][$a-zA-Z0-9_]*$/,g=/^\s*var\s+([$\w]+)\s*\=\s*\S+/,y={__local__:1,vmode:1,dom:1};e.exports=a;var _=/\n\s*/g},function(e,n){function t(e,n){var t=[],l={},s="ms-skip"in n,c={};for(var u in n){var d,v=n[u];if(l[u]=n[u],d=u.match(o)){if(s)continue;var f=u.replace(d[1],"").split("-");i[f[0]]&&f.unshift("on"),"on"===f[0]&&(f[2]=parseFloat(f[2])||0),f.unshift("ms");var p=f[1];if(r[p]){var m={type:p,param:f[2],name:f.join("-"),expr:v,priority:r[p].priority||100*p.charCodeAt(0)};"on"===p&&(m.priority+=f[3]),c[m.name]||(c[m.name]=v,t.push(m))}}}return e.props=l,t.sort(a),t}function a(e,n){return e.priority-n.priority}var r=avalon.directives,o=/^(\:|ms\-)\w+/,i=avalon.oneObject("animationend,blur,change,input,click,dblclick,focus,keydown,keypress,keyup,mousedown,mouseenter,mouseleave,mousemove,mouseout,mouseover,mouseup,scan,scroll,submit");e.exports=t},function(e,n){function t(e){return i.test(e)||r[e]?l(e):e}function a(e){var n=[];for(var r in e){var i=typeof e[r];if("object"===i)if("props"===r){var s=[];for(var c in e.props){var u=e.props[c];"string"==typeof u&&(u=l(u)),s.push(t(c)+": "+u)}n.push(r+": {"+s.join(",\n")+"}")}else"children"===r&&n.push("children: ["+e[r].map(function(e){return a(e)})+"]");else if(e.hasOwnProperty(r)){var d=e[r];"string"===i&&(d=o[r]?l(d):d),n.push(t(r)+":"+d)}}return"{\n"+n.join(",\n")+"}"}var r=avalon.oneObject("break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile");avalon.keyMap=r;var o={nodeName:1,template:1,forExpr:1,type:1,nodeValue:1,signature:1,wid:1},i=/[W-]/,l=avalon.quote;e.exports=a},function(e,n,t){function a(e,n){var t=e.replace(g,"").match(y);t&&t.filter(function(e){/^[@\d\-]/.test(e)||"##"===e.slice(0,2)||"$event"===e||avalon.keyMap[e]||(n[e]=1)})}function r(e){var n=[];for(var t in e)n.push("var "+t+" = __local__["+avalon.quote(t)+"]");return n}function o(e,n){function t(e){var n="??"+b++;return x[n]=e,n}function o(e){return x[e]}var g={};if(n=n||"other","object"==typeof e&&(n=e.type,g=e,e=g.expr),"string"!=typeof e)return"";var y=e,_=l.get(n+":"+y);if(_)return _;var b=1,x={},w=e.replace(s,t).replace(c,t).replace(v,t).replace(p,"$1").split(f),$=w.shift(),C={},A=$.replace(u,o).trim();if("on"===n&&h.test(A)&&(A+="($event)"),A=A.replace(m,"$1__vmodel__."),"js"===n)return l.put(n+":"+y,A);"on"===n&&a($,C);var k=w.map(function(e){a(e.replace(/^\w+/g,""),C),e=e.replace(u,o).replace(m,"$1__vmodel__.");var n=!1;return e=e.replace(d,function(e,t){return n=!0,/\S/.test(t)?"(__value__,"+t+");":"(__value__);"}),n||(e+="(__value__);"),e=e.replace(/(\w+)/,'avalon.__format__("$1")'),"__value__ = "+e}),E=[];if("on"===n)k=k.map(function(e){return e.replace(/__value__/g,"$event")}),k.length&&k.push("if($event.$return){\n	return;\n}"),avalon.modern||(A=A.replace(/__vmodel__\.([^(]+)\(([^)]*)\)/,function(e,n,t){return"__vmodel__."+n+".call(__vmodel__"+(/\S/.test(t)?","+t:"")+")"})),E=["function ($event, __local__){","try{",r(C).join("\n"),"	var __vmodel__ = this;","	"+A,"}catch(e){",i(e,n),"}","}"],k.unshift(2,0);else{if("duplex"===n){var T=["function (__vmodel__,__value__){","try{","	"+A+" = __value__","}catch(e){",i(e,n).replace("parse","set"),"}","}"];l.put("duplex:set:"+y,T.join("\n"));var N=["function (__vmodel__){","try{","var __value__ = "+A+"\n",k.join("\n"),"return __value__\n","}catch(e){",i(e,n).replace("parse","get"),"}","}"].join("\n");return l.put("duplex:get:"+y,N),N}E=["(function(){","try{","var __value__ = "+A,"text"===n?"return avalon.parsers.string(__value__)":"return __value__","}catch(e){",i(e,n),'	return ""',"}","})()"],k.unshift(3,0)}return E.splice.apply(E,k),_=E.join("\n"),l.put(n+":"+y,_),_}function i(e,n){return"	avalon.warn(e, "+avalon.quote("parse "+n+" binding【 "+e+" 】fail")+")"}var l=t(41),s=/(^|[^\/])\/(?!\/)(\[.+?]|\\.|[^\/\\\r\n])+\/[gimyu]{0,5}(?=\s*($|[\r\n,.;})]))/g,c=/(["'])(\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/g,u=/\?\?\d+/g,d=/\(([^)]*)\)/,v=/\|\|/g,f=/\|(?=\w)/,p=/\s*(\.|\|)\s*/g,m=/(^|[^\w\u00c0-\uFFFF_])(@|##)(?=[$\w])/g,h=/^(?:\@|##)[$\w\.]+$/i,g=/\|.+/g,y=/((?:\@|\$|\#\#)?\w+)/g;e.exports=avalon.parseExpr=o},function(e,n,t){var a=t(29);e.exports=new a(888)},,function(e,n,t){var a=t(44);avalon.directive("important",{priority:1,parse:function(e,n,t){var a=avalon.quote(t.expr);e.local="{}",e[t.name]=1,e.vmodel="(function(){ return __vmodel__ = avalon.vmodels["+a+"]})()",n.$prepend=["(function(__vmodel__){","var important = avalon.scopes["+a+"]",'if(important){avalon.log("不进入"+'+a+");return }"].join("\n")+"\n",n.$append="\n})();"},diff:function(e,n,t){n.dynamic[t]||(n.local=e.local,n.vmodel=e.vmodel,a(n,this.update))},update:function(e,n,t){avalon.directives.controller.update(e,n,t,"important")}})},function(e,n){e.exports=function(e,n,t){if(t)e.afterChange=e.afterChange||[],avalon.Array.ensure(e.afterChange,n);else{var a=e.dom;n(e.dom,e,a&&a.parentNode)}}},function(e,n,t){var a=t(44),r={};avalon.mediatorFactoryCache=function(e,n){var t=e.$hashcode,a=n.$hashcode,o=t+a;if(r[o])return r[o];var i=avalon.mediatorFactory(e,n);return r[o]=i},avalon.directive("controller",{priority:2,parse:function(e,n,t){var a=avalon.quote(t.expr);e.local="__local__",e[t.name]=1,e.vmodel=["(function(){","var vm = avalon.vmodels["+a+"]","if(vm && __vmodel__&& vm !== __vmodel__){","return __vmodel__ = avalon.mediatorFactoryCache(__vmodel__, vm)","}else if(vm){","return __vmodel__ = vm","}","})()"].join("\n"),n.$prepend="(function(__vmodel__){",n.$append="\n})(__vmodel__);"},diff:function(e,n,t){n.dynamic[t]||(n.local=e.local,n.vmodel=e.vmodel,a(n,this.update))},update:function(e,n,t,r){var o=n.vmodel,i=n.local,l=r?"ms-important":"ms-controller";n.dynamic[l]=1;var s=n.props[l],c=avalon.scopes[s];if(!c){delete n.vmodel,delete n.local;var u=avalon.vmodels[s];if(o.$element&&o.$element.vtree[0]===n)var d=o.$render;else d=avalon.render([n],i);o.$render=d,o.$element=e,e.vtree=[n],u!==o&&(u.$render=u.$render||d,u.$element=u.$element||e);var v=r?o:u,c=avalon.scopes[s]={vmodel:o,local:i};a(n,function(){var e=v.$events.onReady;e&&(v.$fire("onReady"),delete v.$events.onReady),c.isMount=!0},"afterChange")}}})},,function(e,n,t){var a=t(44);avalon.directive("css",{diff:function(e,n,t){var r=e[t],o=n[t];if(Object(r)===r){if(r=r.$model||r,Array.isArray(r)&&(r=avalon.mix.apply({},r)),n.dynamic[t]&&o){var i={},l=!1;for(var s in r)r[s]!==o[s]&&(l=!0,i[s]=r[s]);l&&(n[t]=r,n.changeStyle=i)}else n.changeStyle=n[t]=r;n.changeStyle&&a(n,this.update)}delete e[t]},update:function(e,n){var t=n.changeStyle,a=avalon(e);n.dynamic["ms-css"]=1;for(var r in t)a.css(r,t[r]);delete n.changeStyle}})},function(e,n,t){function a(e,n){var t=e.ownerDocument,r=e.nodeName,i="_"+r;if(!a[i]){var l=t.body.appendChild(t.createElement(r));n=avalon.modern?getComputedStyle(l,null).display:l.currentStyle.display,t.body.removeChild(l),n===o&&(n="block"),a[i]=n}return a[i]}var r=t(44),o="none";avalon.parseDisplay=a,avalon.directive("visible",{diff:function(e,n,t){var a=!!e[t];n.dynamic[t]&&a===n[t]||(n[t]=a,r(n,this.update))},update:function(e,n){function t(){void 0!==r&&(e.style.display=r)}if(e&&1===e.nodeType){n.dynamic["ms-visible"]=1;var r,i=n["ms-visible"],l=e.style.display;i?(l===o&&(r=n.displayValue,r||(e.style.display="")),""===e.style.display&&avalon(e).css("display")===o&&avalon.contains(e.ownerDocument,e)&&(r=a(e))):l!==o&&(r=o,n.displayValue=l),avalon.applyEffect(e,n,{hook:i?"onEnterDone":"onLeaveDone",cb:t})}}})},function(e,n,t){t(44);avalon.directive("expr",{parse:avalon.noop})},function(e,n,t){var a=t(44);avalon.directive("text",{parse:function(e,n,t){e[t.name]=1,n.children=[],e.children='[{\nnodeName:"#text",\ndynamic:true,\nnodeValue:avalon.parsers.string('+avalon.parseExpr(t)+")}]"},diff:function(e,n){n.children.length||a(n,this.update)},update:function(e,n){if(e&&!n.isVoidTag){for(var t=e;t.firstChild;)t.removeChild(t.firstChild);var e=document.createTextNode("x");t.appendChild(e);var a={nodeType:3,nodeName:"#text",dom:e};n.children.push(a)}}})},function(e,n,t){var a=t(44);t(52);avalon.directive("html",{parse:function(e,n,t){n.isVoidTag?e.children="[]":(e[t.name]=avalon.parseExpr(t),e.vmodel="__vmodel__",e.local="__local__")},diff:function(e,n,t){var r=e[t]+"";if(n.dynamic["ms-html"]&&n.render&&r===n[t]){if(n.render){var o=n.render(e.vmodel,e.local);e.children=o}}else{n[t]=r;var i=avalon.speedUp(avalon.lexer(r)),l=avalon.render(i,e.local);n.render=l;var o=l(e.vmodel,e.local);n.children=e.children=o,a(n,this.update)}},update:function(e,n,t){n.dynamic["ms-html"]=1,avalon.clearHTML(e),e.appendChild(avalon.domize(n.children))}})},function(e,n){function t(e,n,o){n=r(n);var i={},s=n.length;if(0!==s){n.forEach(function(e,n){i[n]=a(e)});for(var c,u=[],d=!1,v=0,f=0;;){if(c=e[v++],f++>5e3)break;var p,m=c&&a(c),h=u.length;if(i[h]===m){if(p&&1===c.nodeType&&(c.getAttribute(":for")||c.getAttribute("ms-for"))){p=!1;continue}u.push(c);var g=n[h];if(g.dynamic&&(g.dom=c),1===c.nodeType&&!g.isVoidTag&&!l[g.nodeName]){if("select-one"===c.type)var y=c.selectedIndex;t(c.childNodes,g.children,c),"select-one"===c.type&&(c.selectedIndex=y)}}else if(d=!0,"8true"===i[h]){var _=n[h],b=document.createComment(_.nodeValue);_.dom=b,u.push(b),_.forExpr&&(p=!0),v=Math.max(0,--v)}if(u.length===s)break}if(d){for(var x=document.createDocumentFragment(),v=0;c=u[v++];)x.appendChild(c);for(;o.firstChild;)o.removeChild(o.firstChild);o.appendChild(x)}}}function a(e){switch(e.nodeType){case 3:return"3"+i.test(e.nodeValue);case 1:return"1"+e.nodeName.toLowerCase();case 8:return"8"+o.test(e.nodeValue)}}function r(e){for(var n,t=[],a=0;n=e[a];a++)Array.isArray(n)?t=t.concat(r(n)):t.push(n);return t}var o=/^ms\-for/,i=/[\S\xA0]/,l=avalon.oneObject("script,style,xmp,template,noscript,textarea");e.exports=t},function(e,n,t){function a(){for(var e=[],n=0;n<arguments.length;n++){var t=arguments[n],r=typeof t;if("string"===r||"number"===r||t===!0)e.push(t);else if(Array.isArray(t))e.push(a.apply(null,t));else if("object"===r)for(var o in t)t.hasOwnProperty(o)&&t[o]&&e.push(o)}return e.join(" ")}function r(e){var n=e.target;avalon(n).addClass(n.getAttribute(u[e.type])||"")}function o(e){var n=e.target,t=u[e.type];avalon(n).removeClass(n.getAttribute(t)||""),"change-active"!==t&&avalon(n).removeClass(n.getAttribute("change-active")||"")}function i(e,n){var t=e.getAttribute("old-change-class"),a=n["ms-class"];t!==a&&(avalon(e).removeClass(t).addClass(a),e.setAttribute("old-change-class",a))}var l=t(6).getLongID,s=t(44),c=avalon.directives;avalon.directive("class",{diff:function(e,n,t){var i=t.slice(3),l=e[t],c=n[t]||"",u=n.classEvent||{};"hover"===i?(u.mouseenter=r,u.mouseleave=o):"active"===i&&(n.props.tabindex=e.props.tabindex||-1,u.tabIndex=n.props.tabindex,u.mousedown=r,u.mouseup=o,u.mouseleave=o),n.classEvent=u;var d=a(l);n.dynamic[t]&&c===d||(n[t]=d,n["change-"+i]=d,s(n,this.update,i))},update:function(e,n){if(e&&1===e.nodeType){var t=n.classEvent;if(t){for(var a in t)"tabIndex"===a?e[a]=t[a]:avalon.bind(e,a,t[a]);n.classEvent={}}var r=["class","hover","active"];r.forEach(function(t){var a="change-"+t,r=n[a];if(void 0!==r)if(n.dynamic["ms-"+t]=1,"class"===t)e&&i(e,n);else{var o=e.getAttribute("change-"+t);o&&avalon(e).removeClass(o),
e.setAttribute(a,r)}})}}}),c.active=c.hover=c["class"];var u={mouseenter:"change-hover",mouseleave:"change-hover",mousedown:"change-active",mouseup:"change-active"};l(r),l(o)},function(e,n,t){function a(e,n){for(var t in e)if(e[t]!==n[t])return!0;return!1}var r=t(29),o=(new r(128),t(44)),i=(t(6).getLongID,/^ms\-on\-(\w+)/);avalon.directive("on",{priority:3e3,parse:function(e,n,t){var a=t.name.replace("ms-on-","e").replace("-","_"),r=a+"_"+t.expr.replace(/\s/g,"").replace(/[^$a-z]/gi,function(e){return e.charCodeAt(0)}),o=avalon.quote(r),i="(function(){\nvar fn610 = "+avalon.parseExpr(t,"on")+"\nfn610.uuid ="+o+";\nreturn fn610})()";e.vmodel="__vmodel__",e.local="__local__",e[t.name]=i},diff:function(e,n,t){var r=e[t],i=r.uuid,l=n[t]||{},s=!1;n.dynamic[t]&&l.uuid===i||(n[t]=r,avalon.eventListeners.uuid=r,s=!0),a(n.local||{},e.local)&&(s=!0),s&&(n.local=e.local,n.vmodel=e.vmodel,o(n,this.update))},update:function(e,n){if(e&&!(e.nodeType>1)){var t,a;e._ms_context_=n.vmodel,e._ms_local=n.local;for(t in n){var r=t.match(i);r&&(a=n[t],n.dynamic[t]=1,avalon.bind(e,r[1],a))}}}})},,,function(e,n,t){function a(e){var n=this,t=this.__ms_duplex__;if(!n.composing&&n.value!==t.value){if(n.caret)try{var a=t.getCaret(n);t.pos=a}catch(o){avalon.warn("fixCaret error",o)}if(t.debounceTime>4){var i=new Date,l=i-t.time||0;t.time=i,l>=t.debounceTime?r[t.type].call(t):(clearTimeout(t.debounceID),t.debounceID=setTimeout(function(){r[t.type].call(t)},l))}else r[t.type].call(t)}}var r=t(58);e.exports=a},function(e,n){function t(e){e.callback&&e.callback.call(e.vmodel,{type:"changed",target:e.dom})}var a={input:function(e){var n=this;e=e||"value";var a=n.dom,r=a[e],o=n.parse(r);n.value=r,n.set(n.vmodel,o),t(n);var i=n.pos;a.caret&&n.setCaret(a,i)},radio:function(){var e=this;if(e.isChecked){var n=!e.value;e.set(e.vmodel,n),t(e)}else a.input.call(e),e.value=NaN},checkbox:function(){var e=this,n=e.value;Array.isArray(n)||(avalon.warn("ms-duplex应用于checkbox上要对应一个数组"),n=[n]);var a=e.dom.checked?"ensure":"remove";if(n[a]){var r=e.parse(e.dom.value);n[a](r),t(e)}},select:function(){var e=this,n=avalon(e.dom).val();n+""!=this.value+""&&(n=Array.isArray(n)?n.map(function(n){return e.parse(n)}):e.parse(n),e.set(e.vmodel,n),t(e))},contenteditable:function(){a.input.call(this,"innerHTML")}};e.exports=a},function(e,n){function t(e){r[this.tagName].call(this,e);var n=this.__ms_duplex__;!this.caret&&n&&n.isString&&n.update.call(this,{type:"setter"})}var a=!1;try{var r={},o=HTMLInputElement.prototype,i=HTMLTextAreaElement.prototype,l=HTMLInputElement.prototype;Object.getOwnPropertyNames(l),r.INPUT=Object.getOwnPropertyDescriptor(o,"value").set,Object.defineProperty(o,"value",{set:t}),r.TEXTAREA=Object.getOwnPropertyDescriptor(i,"value").set,Object.defineProperty(i,"value",{set:t}),a=!0}catch(s){}e.exports=a},,function(e,n){e.exports=function(e,n){var t=e.__ms_duplex__,a=n["ms-rules"];if(a&&!t.validator)for(;e&&1===e.nodeType;){var r=e._ms_validator_;if(r){t.rules=a,t.validator=r,avalon.Array.ensure(r.fields,t)&&r.addField(t);break}e=e.parentNode}}},function(e,n,t){function a(){var e=this.data||{};return this.message.replace(i,function(n,t){return null==e[t]?"":e[t]})}var r=t(44),o=avalon.directive("validate",{diff:function(e,n,t){var a=e[t],i=n[t];if(!(i&&i.onError&&i.addField)&&Object(a)===a){n.vmValidator=a,a.$id&&(a=a.$model),n[t]=a;for(var t in o.defaults)a.hasOwnProperty(t)||(a[t]=o.defaults[t]);a.fields=a.fields||[],r(n,this.update)}},update:function(e,n){function t(){o.validateAll.call(a,a.onValidateAll)}var a=n["ms-validate"];e._ms_validator_=a,a.dom=e;var r=n.vmValidator;try{r.onManual=t}catch(i){}delete n.vmValidator,e.setAttribute("novalidate","novalidate"),a.validateAllInSubmit&&avalon.bind(e,"submit",function(e){e.preventDefault(),t()}),"function"==typeof a.onInit&&a.onInit.call(e,{type:"init",target:e,validator:a})},validateAll:function(e){var n=this,t="function"==typeof e?e:n.onValidateAll,a=n.fields.filter(function(e){var t=e.dom;return t&&!t.disabled&&n.dom.contains(t)}).map(function(e){return o.validate(e,!0)}),r=[];Promise.all(a).then(function(e){for(var a,o=0;a=e[o++];)r=r.concat(a);if(n.deduplicateInValidateAll){var i={};r=r.filter(function(e){var n=e.dom,t=n.uniqueID||(n.uniqueID=setTimeout("1"));return i[t]?!1:(i[t]=!0,!0)})}t.call(n.dom,r)})},addField:function(e){var n=this,t=e.dom;!n.validateInKeyup||e.isChanged||e.debounceTime||avalon.bind(t,"keyup",function(n){o.validate(e,0,n)}),n.validateInBlur&&avalon.bind(t,"blur",function(n){o.validate(e,0,n)}),n.resetInFocus&&avalon.bind(t,"focus",function(a){n.onReset.call(t,a,e)})},validate:function(e,n,t){var r=[],o=e.value,i=e.dom,l=e.validator;if(!i.disabled){for(var s in e.rules){var c=e.rules[s];if(c!==!1){var u,d,v=avalon.validators[s];r.push(new Promise(function(e,n){u=e,d=n}));var f=function(n){if(e.norequired&&""===o&&(n=!0),n)u(!0);else{var t={element:i,data:e.data,message:i.getAttribute("data-"+s+"-message")||i.getAttribute("data-message")||v.message,validateRule:s,getMessage:a};u(t)}};e.data={},e.data[s]=c,v.get(o,e,f)}}var p=[],m=Promise.all(r).then(function(e){for(var a,r=0;a=e[r++];)"object"==typeof a&&p.push(a);return n||(p.length?l.onError.call(i,p,t):l.onSuccess.call(i,p,t),l.onComplete.call(i,p,t)),p});return m}}}),i=/\\?{{([^{}]+)\}}/gm;o.defaults={addField:o.addField,onError:avalon.noop,onSuccess:avalon.noop,onComplete:avalon.noop,onManual:avalon.noop,onReset:avalon.noop,onValidateAll:avalon.noop,validateInBlur:!0,validateInKeyup:!0,validateAllInSubmit:!0,resetInFocus:!0,deduplicateInValidateAll:!1}},function(e,n){function t(e){return"regexp"===avalon.type(e)}function a(e){if("string"==typeof e&&e){var n=e.split("-");if(3===n.length&&4===n[0].length){var t=~~n[0],a=~~n[1]-1,r=~~n[2],o=new Date(t,a,r);return o.getFullYear()===t&&o.getMonth()===a&&o.getDate()===r}}return!1}avalon.directive("rules",{diff:function(e,n,t){var a=e[t];if(a&&"[object Object]"===Object.prototype.toString.call(a)){n[t]=a.$model||a;var r=n.dom&&n.dom.__ms_duplex__;r&&(r.rules=e[t])}}});var r=/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/i,o=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/;avalon.shadowCopy(avalon.validators,{pattern:{message:"必须匹配{{pattern}}这样的格式",get:function(e,n,a){var r=n.element,o=n.data;if(!t(o.pattern)){var i=r.getAttribute("pattern");o.pattern=new RegExp("^(?:"+i+")$")}return a(o.pattern.test(e)),e}},digits:{message:"必须整数",get:function(e,n,t){return t(/^\-?\d+$/.test(e)),e}},number:{message:"必须数字",get:function(e,n,t){return t(isFinite(e)),e}},required:{message:"必须填写",get:function(e,n,t){return t(""!==e),e}},equalto:{message:"密码输入不一致",get:function(e,n,t){var a=String(n.data.equalto),r=avalon(document.getElementById(a)).val()||"";return t(e===r),e}},date:{message:"日期格式不正确",get:function(e,n,t){var r=n.data;return t("regexp"===avalon.type(r.date)?r.date.test(e):a(e)),e}},url:{message:"URL格式不正确",get:function(e,n,t){return t(o.test(e)),e}},email:{message:"email格式不正确",get:function(e,n,t){return t(r.test(e)),e}},minlength:{message:"最少输入{{minlength}}个字",get:function(e,n,t){var a=parseInt(n.data.minlength,10);return t(e.length>=a),e}},maxlength:{message:"最多输入{{maxlength}}个字",get:function(e,n,t){var a=parseInt(n.data.maxlength,10);return t(e.length<=a),e}},min:{message:"输入值不能小于{{min}}",get:function(e,n,t){var a=parseInt(n.data.min,10);return t(parseFloat(e)>=a),e}},max:{message:"输入值不能大于{{max}}",get:function(e,n,t){var a=parseInt(n.data.max,10);return t(parseFloat(e)<=a),e}},chs:{message:"必须是中文字符",get:function(e,n,t){return t(/^[\u4e00-\u9fa5]+$/.test(e)),e}}})},function(e,n,t){var a=t(44);avalon.directive("if",{priority:6,diff:function(e,n,t,r,o,i){var l=!!e[t];n[t]=l,a(n,this.update)},update:function(e,n,t){var a=n["ms-if"];if(n.dynamic["ms-if"]&&(n.dynamic["ms-if"]=n.nodeName),a){if("#comment"===n.nodeName){n.nodeName=n.dynamic["ms-if"],delete n.nodeValue;var r=n.comment;if(!r)return;t=r.parentNode,t&&t.replaceChild(e,r),avalon.applyEffect(e,n,{hook:"onEnterDone"})}}else n.comment||(n.comment=document.createComment("if")),n.nodeName="#comment",n.nodeValue="if",avalon.applyEffect(e,n,{hook:"onLeaveDone",cb:function(){t=t||e.parentNode,t&&t.replaceChild(n.comment,e)}})}})},function(e,n,t){function a(e){var n=typeof e;return e&&"object"===n?e.$hashcode:n+":"+e}function r(e,n,t,r,o,i,l,s){var c=s?a(n):e,u={};u[o]=e,u[i]=n;for(var d in t)d in u||(u[d]=t[d]);r(e,n,c,u,l)}function o(e,n,t){var a=e.split,r=a.nodeValue,o=[],i=a.previousSibling;for(o.unshift(a);;){if(!i||i===n||i.nodeValue===r)break;var l=i.previousSibling;o.unshift(i),i=l}return t&&o.forEach(function(n){e.dom.appendChild(n)}),o}function i(e){var n;for(var t in e){var n=t;break}return n?l(e,n):void 0}function l(e,n){var t=e[n];if(t){var a=t.arr;if(a){var r=a.pop();return a.length||(t.arr=0),r}return delete e[n],t}}function s(e,n){var t=n.key;if(e[t]){var a=e[t],r=a.arr||(a.arr=[]);r.push(n)}else e[t]=n}var c=t(44),u=/\s+as\s+([$\w]+)/,d=/^[$a-zA-Z_][$a-zA-Z0-9_]*$/,v=/^(null|undefined|NaN|window|this|\$index|\$id)$/,f=/[$\w]+/g;avalon._each=function(e,n,t,a){var o=[];a.push(o);var i=(n+"").slice(0,40).match(f);if(i.shift(),Array.isArray(e))for(var l=0;l<e.length;l++)r(l,e[l],t,n,i[0],i[1],o,!0);else for(var l in e)e.hasOwnProperty(l)&&r(l,e[l],t,n,i[0],i[1],o)},avalon.directive("for",{priority:3,parse:function(e,n,t){var a,r=n.forExpr;r=r.replace(u,function(e,n){return!d.test(n)||v.test(n)?avalon.error("alias "+n+" is invalid --- must be a valid JS identifier which is not a reserved name."):a=n,""});var o=r.split(" in "),i="var loop = "+avalon.parseExpr(o[1])+" \n",l=a?"var "+a+" = loop\n":"",s=o[0].match(f);1===s.length&&s.unshift("$key"),s.push("traceKey","__local__","vnodes"),n.$append=i+l+"avalon._each(loop,function("+s.join(", ")+"){\n"+(a?"__local__["+avalon.quote(a)+"]=loop\n":"")+'vnodes.push({\nnodeName: "#document-fragment",\nindex: arguments[0],\nkey: traceKey,\nchildren: new function(){\n var vnodes = []\n'},diff:function(e,n,t,a,r){if(avalon.callArray){if(n.list&&-1===n.forExpr.indexOf(avalon.callArray))return}else if(n.list)return;var o,u,d,v=a[r+1],f=t[r+1],p=a[r+2],m=n.cache||{},h=[];if(v.length){if(v===f)return f.forEach(function(e){s(m,e)}),void(n.cache=m);n.action="update";var g={},y=[];for(o=0;u=f[o];o++){var d=l(m,u.key);d?(d.oldIndex=d.index,d.index=u.index,s(g,d)):y.push(u)}for(var u,o=0;u=y[o];o++)d=i(m,u.key),d?(d.oldIndex=d.index,d.index=u.index,d.key=u.key):(d=u,v.push(d)),s(g,d);v.sort(function(e,n){return e.index-n.index}),n.cache=g;for(var o in m)d=m[o],d.action="leave",avalon.Array.remove(v,d),h.push(d),d.arr&&(d.arr.forEach(function(e){e.action="leave",h.push(e)}),delete d.arr)}else n.action="init",a[r+1]=f,f.forEach(function(e,n){v[n]=e,s(m,e)}),n.cache=m;h.length>1&&h.sort(function(e,n){return e.index-n.index}),n.removes=h;var _=avalon.caches[n.wid],b=e.vmodel;return p&&_&&(p.afterChange=[function(e){_.call(b,{type:"rendered",target:e,signature:n.signature})}]),n.list=v,c(n,this.update),!0},update:function(e,n,t){if("init"===n.action){var a=t;t=document.createDocumentFragment()}for(var r,i=e,l=e.signature,s=0;r=n.removes[s++];)if(r.dom)if(r.num=0,n.hasEffect){var c=o(r,e);p(c,r.children,{hook:"onLeaveDone",staggerKey:l+"leave",cb:function(e){++r.num,r.dom.appendChild(e),r.num===r.children.length&&(delete r.dom,delete r.split,r.children.length=0)}})}else o(r,e,"add"),delete r.dom,delete r.split;n.list.forEach(function(a,r){a.dom||(a.dom=avalon.domize(a));var s=a.dom;if(void 0===a.oldIndex){if(0===r&&"init"===n.action?t.appendChild(s):t.insertBefore(s,i.nextSibling),n.hasEffect){var c=avalon.slice(s.childNodes);p(c,a.children,{hook:"onEnterDone",staggerKey:l+"enter"})}}else if(a.index!==a.oldIndex){var c=o(a,e,"add");t.insertBefore(a.dom,i.nextSibling),n.hasEffect&&p(c,a.children,{hook:"onMoveDone",staggerKey:l+"move"})}i=a.split}),"init"===n.action&&a.insertBefore(t,e.nextSibling)}}),avalon.domize=function(e){return avalon.vdomAdaptor(e,"toDOM")};var p=function(e,n,t){n.forEach(function(a,r){avalon.applyEffect(e[r],n[r],t)})}},function(e,n,t){function a(e,n){var t=n.props.is,a=n["component-vm:"+t],r="component-html:"+t,o=n[r],i=avalon.vdomAdaptor(n,"toHTML");o!==i&&(n[r]=i,a.$fire("onViewChange",{type:"viewchange",target:e,vmodel:a,is:t}))}function r(e){var n=!0;try{o(e)}catch(t){n=!1}return n}function o(e){e.children.forEach(function(e){if("#comment"===e.nodeName){if("unresolved component placeholder"===e.nodeValue)throw"unresolved"}else e.children&&o(e)})}var i=t(44),l=t(67);avalon.component=function(e,n){avalon.components[e]||(avalon.components[e]=n)},avalon.directive("widget",{priority:4,parse:function(e,n,t){n.props.wid=n.props.wid||avalon.makeHashCode("w"),e[t.name]=avalon.parseExpr(t),e.template=n.template,e.vmodel="__vmodel__",e.local="__local__"},define:function(){return avalon.mediatorFactory.apply(this,arguments)},diff:function(e,n,t,a,o,s){var c=e[t];if(Object(c)===c){var u=n.props.is||(/^ms\-/.test(n.nodeName)?n.nodeName:0);u||(c=c.$model||c,Array.isArray(c)&&(c.unshift({}),avalon.mix.apply(0,c),c=c.shift()),u=c.is);var d="component-vm:"+u;if(n.props.is=u,n.vmodel=e.vmodel,!n[d]&&!l(n,e[t],e.local,e.template))return n.nodeValue="unresolved component placeholder",a[s]=n,void i(n,this.mountComment);var v=n[d],f=avalon.scopes[v.$id];if(f&&f.vmodel){var p=f.vmodel.$element;if(n.dom!==p){var m=p.vtree[0];return o[s]=a[s]=m,n.com=p,m.skipContent||(m.skipContent="optimize"),i(n,this.replaceCachedComponent),void i(m,function(){"optimize"===m.skipContent&&(m.skipContent=!0)},"afterChange")}}var h=v.$render,g=h(v,e.local),m=g[0];m&&r(m)?(m.local=e.local,Array(d,"component-html:"+u,"component-ready:"+u,"dom","dynamic").forEach(function(e){m[e]=n[e]}),m.vmodel=v,a[s]=m,n.comment&&n.nodeValue&&(m.dom=n.comment),n.nodeName!==m.nodeName?(o[s]=m,i(m,this.mountComponent)):i(n,this.updateComponent)):(n.nodeValue="unresolved component placeholder",a[s]={nodeValue:"unresolved component placeholder",nodeName:"#comment"},i(n,this.mountComment))}else n.props.is===e.props.is&&i(n,this.updateComponent)},replaceCachedComponent:function(e,n,t){var a=n.com;t.replaceChild(a,e),n.dom=a,delete n.com},mountComment:function(e,n,t){var a=document.createComment(n.nodeValue);n.dom=a,t.replaceChild(a,e)},updateComponent:function(e,n){var t=n["component-vm:"+n.props.is],r=t.$events.onViewChange;r&&r.length&&i(n,a,"afterChange")},mountComponent:function(e,n,t){delete n.dom;var a=avalon.vdomAdaptor(n,"toDOM"),r=n.props.is,o=n["component-vm:"+r];o.$fire("onInit",{type:"init",vmodel:o,is:r}),t.replaceChild(a,e),n.dom=o.$element=a,a.vtree=[n],avalon.onComponentDispose(a),n["component-ready:"+r]=!0,avalon.scopes[o.$id]={vmodel:o,top:n.vmodel,local:n.local},i(n,function(){o.$fire("onReady",{type:"ready",target:a,vmodel:o,is:r})},"afterChange"),i(n,function(){n["component-html:"+r]=avalon.vdomAdaptor(n,"toHTML")},"afterChange")}})},function(e,n,t){function a(e,n,t,a){function d(e,n){$.forEach(function(t){delete e[t],delete n[t]})}var m=e.nodeName,h=e.props.is;if(!u[m]&&!l(m))return void avalon.warn(m+"不合适做组件的标签");var g={};if(n){var y=[].concat(n);y.forEach(function(e){e&&"object"==typeof e&&s(g,e.$model||e,!0)})}else y=[];var _=avalon.components[h];if(_){!g.$id&&p&&(avalon.warn("warning!",h,"组件最好在ms-widget配置对象中指定全局不重复的$id以提高性能!\n","若在ms-for循环中可以利用 ($index,el) in @array 中的$index拼写你的$id\n","如 ms-widget=\"{is:'ms-button',$id:'btn'+$index}\""),p=!1);var b=g.define;b=b||avalon.directives.widget.define;var x=g.$id||e.props.wid||"w"+(new Date-0),w=avalon.mix(!0,{},_.defaults);s(g,w,!1);var $=f.concat();d.isWidget=!0;var C=b.apply(d,[e.vmodel,w].concat(y));if(!avalon.modern)for(var A in C)c[A]||"function"!=typeof C[A]||(C[A]=C[A].bind(C));C.$id=x,avalon.vmodels[x]=C;for(var k in v)g[k]&&g[k].forEach(function(e){C.$watch(k,e)});var E=avalon.lexer(a),T=E[0];T.children=T.children||[],T.props.is=h,T.props.wid=x,avalon.speedUp(E);var N=avalon.render(E,t),O=_.template.trim();"function"==typeof _.getTemplate&&(O=_.getTemplate(C,O));var j=avalon.lexer(O);j.length>1&&avalon.error("组件必须用一个元素包起来");var M=_.soleSlot;i(j,M),avalon.speedUp(j);var D=avalon.render(j),S=o+"",H=M?avalon.quote(M):"null";S=S.replace("XXXXX",r(N)).replace("YYYYY",r(D)).replace("ZZZZZ",H);var V=S.indexOf("{")+1,L=S.lastIndexOf("}"),F=Function("vm","local",S.slice(V,L));return C.$render=F,e["component-vm:"+h]=C,C.$render=F}}function r(e){return e.toString().replace("anonymous","").replace(/\s*\/\*\*\//g,"")}function o(){var e=XXXXX(vm,local),n=e[0],t=YYYYY(vm,local),a=t[0];for(var r in n)"children"!==r&&"nodeName"!==r&&("props"===r?avalon.mix(a.props,n.props):a[r]=n[r]);var o=ZZZZZ,i=avalon.collectSlots(n,o);return!o||i[o]&&i[o].length||(i[o]=[{nodeName:"#text",nodeValue:vm[o],dynamic:!0}]),avalon.insertSlots(t,i),delete a.skipAttrs,delete a.skipContent,t}function i(e,n){for(var t,a=0;t=e[a];a++)if("slot"===t.nodeName){var r=t.props.name||n;e.splice(a,1,{nodeName:"#comment",nodeValue:"slot:"+r,dynamic:!0,type:r},{nodeName:"#comment",nodeValue:"slot-end:"}),a++}else t.children&&i(t.children,n)}function l(e){return m.test(e)||avalon.components[e]}function s(e,n,t){for(var a in n){var r=n[a];v[a]?a in e?e[a].push(r):e[a]=[n[a]]:t&&(e[a]=r)}}var c=t(68),u={wbr:1,xmp:1,template:1},d="onInit,onReady,onViewChange,onDispose",v=avalon.oneObject(d),f=d.split(",").concat("is","define"),p=!0;e.exports=a,avalon.insertSlots=function(e,n){for(var t,a=0;t=e[a];a++)if("#comment"===t.nodeName&&n[t.type]){var r=[a+1,0].concat(n[t.type]);e.splice.apply(e,r),a+=n[t.type].length}else t.children&&avalon.insertSlots(t.children,n)},avalon.collectSlots=function(e,n){var t={};return n?(t[n]=e.children,t.__sole__=n):e.children.forEach(function(n,a){if(/^\w/.test(n.nodeName)){var r=n.props.slot;r&&(Array.isArray(t[r])?t[r].push(n):t[r]=[n])}else if(n.forExpr&&/slot=['"](\w+)/.test(n.template)){var o=RegExp.$1;t[o]=e.children.slice(a,a+2)}}),t};var m=/^[a-z]([a-z\d]+\-)+[a-z\d]+$/},function(e,n){e.exports=avalon.oneObject("$id,$render,$track,$element,$watch,$fire,$events,$model,$skipArray,$accessors,$hashcode,$run,$wait,__proxy__,__data__,__const__")},function(e,n,t){function a(e,n){for(var t in e)if(e[t]!==n[t])return!0;return!1}function r(){if(!v.lock){var e=v[0];e&&(r.lock=!0,e())}}function o(e){var n=p.test(e)?1e3:1;return parseFloat(e)*n}function i(e,n,t){var a=e[n];a=Array.isArray(a)?a:"function"==typeof a?[a]:[],a.forEach(function(e){e&&e(t)})}function l(e){var n=e.toLowerCase();return function(t){var a,l=this.el,s=avalon(l),u=isFinite(t.stagger)?1e3*t.stagger:0;if(u&&t.staggerKey){var d=m.get(t.staggerKey)||m.put(t.staggerKey,{count:0,items:0});d.count++,d.items++}var f=d&&d.count||0,p=function(n){var o=n!==!1;l.animating=void 0,a=!0;var s=o?"Done":"Abort";i(t,"on"+e+s,l),avalon.unbind(l,c.transitionEndEvent),avalon.unbind(l,c.animationEndEvent),d&&0===--d.items&&(d.count=0),t.queue&&(v.lock=!1,v.shift(),r())};i(t,"onBefore"+e,l),t[n]?t[n](l,function(e){p(e!==!1)}):c.css&&(s.addClass(t[n+"Class"]),"leave"===n?s.removeClass(t.enterClass+" "+t.enterActiveClass):"enter"===n&&s.removeClass(t.leaveClass+" "+t.leaveActiveClass),s.bind(c.transitionEndEvent,p),s.bind(c.animationEndEvent,p),setTimeout(function(){a=NaN===avalon.root.offsetWidth,s.addClass(t[n+"ActiveClass"]);var e=window.getComputedStyle(l),r=e[c.transitionDuration],i=e[c.animationDuration],d=o(r)||o(i);0===!d?p(!1):u||setTimeout(function(){a||p(!1)},d+130)},17+u*f))}}function s(e){e.acton||(e.action=e.hook.replace(/^on/,"").replace(/Done$/,"").toLowerCase())}var c=t(70),u=t(29),d=t(44);avalon.directive("effect",{priority:5,diff:function(e,n,t){var r=e[t];if(r=e.$model||r,"string"==typeof r){var o=r;r={is:o}}else Array.isArray(r)&&(r=avalon.mix.apply({},r));r.action=r.action||"enter",Object(r)===r&&(n.dynamic[t]&&!a(r,n[t]||{})||(n[t]=r,d(n,this.update,"afterChange"))),e!==n&&delete e[t]},update:function(e,n,t,a){if(!e.animating){e.animating=!0;var o=n["ms-effect"],i=o.is;if(a=a||{},!i)return avalon.warn("need is option");n.dynamic["ms-effect"]=1;var l=avalon.effects;c.css&&!l[i]&&avalon.effect(i,{});var s=l[i];if(!s)return avalon.warn(i+" effect is undefined");var u=a.action||o.action,d=avalon.Effect;if("function"!=typeof d.prototype[u])return avalon.warn(u+" action is undefined");var f=new d(e),p=avalon.mix(a,s,o);p.queue?(v.push(function(){f[u](p)}),r()):setTimeout(function(){f[u](p)},4)}}});var v=[];avalon.effects={},avalon.effect=function(e,n){avalon.effects[e]=n||{},c.css&&(n.enterClass||(n.enterClass=e+"-enter"),n.enterActiveClass||(n.enterActiveClass=n.enterClass+"-active"),n.leaveClass||(n.leaveClass=e+"-leave"),n.leaveActiveClass||(n.leaveActiveClass=n.leaveClass+"-active")),n.action||(n.action="enter")};var f=function(e){this.el=e};avalon.Effect=f,f.prototype={enter:l("Enter"),leave:l("Leave"),move:l("Move")};var p=/\d+s$/,m=new u(128);avalon.applyEffect=function(e,n,t){var a=t.cb,r=n["ms-effect"];if(r){var o=t.hook,i=r[o];a&&(Array.isArray(i)?i.push(a):i?r[o]=[i,a]:r[o]=[a]),s(t),e.animate=!0,avalon.directives.effect.update(e,n,0,avalon.shadowCopy({},t))}else a&&a()}},function(e,n){var t,a,r,o=!1,i=!1,l=!1,s=avalon.cssName("transition-duration"),c=avalon.cssName("animation-duration"),u={TransitionEvent:"transitionend",WebKitTransitionEvent:"webkitTransitionEnd",OTransitionEvent:"oTransitionEnd",otransitionEvent:"otransitionEnd"},d=avalon.window;for(var v in u){if(d[v]){r=u[v];break}try{document.createEvent(v);r=u[v];break}catch(f){}}"string"==typeof r&&(o=!0,l=!0,t=r),u={AnimationEvent:"animationend",WebKitAnimationEvent:"webkitAnimationEnd"};var p;for(v in u)if(d[v]){p=u[v];break}"string"==typeof p&&(i=!0,l=!0,a=p),e.exports={transition:o,animation:i,css:l,transitionEndEvent:t,animationEndEvent:a,transitionDuration:s,animationDuration:c}},function(e,n,t){function a(e,n){var t=Array.isArray(e)?r(e):e,a=[];if(n)for(var o in n)a.push("var "+o+" = __local__["+avalon.quote(o)+"]");var i="__local__ = __local__ || {};\n"+a.join(";\n")+"\n"+t;try{var l=Function("__vmodel__","__local__",i)}catch(s){avalon.warn(t,"render parse error")}return l}avalon.lexer=t(72),avalon.diff=t(76),avalon.batch=t(77);var r=t(37);avalon.render=a,e.exports=avalon},function(e,n,t){function a(e){var n="??"+w++;return $[n]=e,n}function r(e){var n=$[e];return n}function o(e){$={},e=u(e);var n=[];n.last=function(){return n[n.length-1]};var t=[],a=1e5;do{var o=!1;if("<"!==e.charAt(0)){var d=e.indexOf("<");d=-1===d?e.length:d;var f=e.slice(0,d).replace(_,r);e=e.slice(d),o={nodeName:"#text",nodeValue:f},y.test(f)&&l(o,n,t)}if(!o){var d=e.indexOf("<!--");if(0===d){var b=e.indexOf("-->");-1===b&&avalon.error("注释节点没有闭合"+e);var f=e.slice(4,b).replace(_,r);e=e.slice(b+3),o={nodeName:"#comment",nodeValue:f},l(o,n,t)}}if(!o){var x=e.match(h);if(x){var w=x[1].toLowerCase(),C=v[w]||"/"===x[3];o={nodeName:w,props:{},children:[],isVoidTag:C};var A=x[2];if(A&&s(A,o.props),l(o,n,t),e=e.slice(x[0].length),C)o.end=!0;else if(n.push(o),m[w]){var k=e.indexOf("</"+w+">"),E=e.slice(0,k).trim();e=e.slice(k),p(o,w,c(E))}}}if(!o){var x=e.match(g);if(x){var w=x[1].toLowerCase(),T=n.last();T?T.nodeName!==w&&avalon.error(T.nodeName+"没有闭合"):avalon.error(x[0]+"前面缺少<"+w+">"),o=n.pop(),o.end=!0,e=e.slice(x[0].length)}}if(!o||0===--a)break;o.end&&(i(o,n,t),delete o.end)}while(e.length);return t}function i(e,n,t){var a=e.nodeName,r=e.props;"table"===a&&f(e.children);var o=r["ms-for"];if(o){delete r["ms-for"];var i=n.last(),l=i?i.children:t;l.splice(l.length-1,1,{nodeName:"#comment",nodeValue:"ms-for:"+o,type:a},e,{nodeName:"#comment",nodeValue:"ms-for-end:",type:a})}}function l(e,n,t){var a=n.last();a?a.children.push(e):t.push(e)}function s(e,n){e.replace(x,function(e){var t=e.split("="),a=t[0],r=t[1]||"";":"===a.charAt(0)&&(a="ms-"+a.slice(1)),r&&0===r.indexOf("??")&&(r=c(r).replace(b,"").replace(/\"/g,"'").slice(1,-1)),a in n||(n[a]=r)})}function c(e){return avalon.unescapeHTML(e.replace(_,r))}function u(e){for(var n=d(e),t=0,r=n.length;r>t;t++)e=e.replace(n[t],a);return e}function d(e){for(var n,t=0,a=[],r=0,o=e.length;o>r;r++){var i=e.charAt(r);if(n){if("\\"===i){r+=1;continue}i===n&&(a.push(e.slice(t,r+1)),n=!1)}else"'"===i?(n="'",t=r):'"'===i&&(n='"',t=r)}return a}t(73);var v=t(36),f=t(74),p=t(75),m=avalon.oneObject("script,style,textarea,xmp,noscript,option,template"),h=/^<([-A-Za-z0-9_]+)\s*([^>]*?)(\/?)>/,g=/^<\/([^>]+)>/,y=/\S/,_=/\?\?\d+/g,b=/\n\s*/g,x=/\S+/g,w=1,$={};e.exports=o},function(e,n,t){function a(e){var n=e.nodeName;switch(n){case"#text":return avalon.config.rexpr.test(e.nodeValue)?e.dynamic=!0:!1;case"#comment":return!!e.dynamic;case void 0:return!0;default:var t=e.props||{};if("ms-skip"in t)return e.skipContent=!0,!1;var a=!1;if("input"===n)t.type||(t.type="text");else if("select"===n){var o=t.hasOwnProperty("multiple")?"multiple":"one";t.type=n+"-"+o}else 0===n.indexOf("ms-")&&(t["ms-widget"]||(t.is=n,t["ms-widget"]='{is:"'+n+'"}'));var i=!1;if(t["ms-widget"]){i=!0,r(t,"html","widget"),r(t,"text","widget");var l=avalon.mix({},e),s=avalon.mix({},e.props);delete s["ms-widget"],delete l.isVoidTag,l.nodeName="cheng",l.props=s,e.template=avalon.vdomAdaptor(l,"toHTML"),e.isVoidTag||(e.children=[])}t["ms-text"]&&(i=!0,r(t,"html","text"),e.isVoidTag||(e.children=[])),t["ms-html"]&&(i=!0,e.isVoidTag||(e.children=[]));var c=!1;for(var d in t)if(c=!0,0===d.indexOf("ms-")){a=!0,e.dynamic={};break}if(c&&(e.props=t),e.children){var v=u(e.children);if(v)return delete e.skipContent,!0;i?delete e.skipContent:e.skipContent=!0}return a}}function r(e,n,t){e["ms-"+n]&&(avalon.warn(n,"指令不能与",t,"指令共存于同一个元素"),delete e["ms-"+n])}function o(e){return d.appendChild(e),d.removeChild(e),e}function i(e){for(var n,t=0;n=e[t++];)if(n.props&&n.props["ms-effect"])return!0;return!1}var l=/^\s*ms\-for\:/,s=/^\s*ms\-for\-end/,c=t(37);avalon.speedUp=function(e){return u(e),e};var u=function(e){for(var n=[],t=!1,r=0;r<e.length;r++){var d=e[r],v="#comment"===d.nodeName;if(v&&l.test(d.nodeValue)){t=!0,n.push(d);var f=n;n=[],n.list=f,n.start=d}else if(v&&s.test(d.nodeValue)){var f=n;n=f.list;var p=f.start;delete f.list,delete f.start,n.push(f,d),d.dynamic=!0;var m=p.signature||(p.signature=avalon.makeHashCode("for"));if(d.signature=m,p.forExpr=p.nodeValue.replace(/ms\-for:\s*/,""),1===f.length){var h=f[0];if(h.props){var g=h.props["data-for-rendered"];if(g){var y=g+":cb";avalon.caches[y]||(avalon.caches[y]=Function("return "+avalon.parseExpr(g,"on"))()),p.wid=y}}}for(var _=0;_<f.length;_++){var d=f[_];d.dom&&o(d.dom)}p.hasEffect=i(f),u(f),avalon.caches[m]||(avalon.caches[m]=c(f,!0)),f.length=0}else a(d)&&(t=!0),n.push(d)}return e.length=0,e.push.apply(e,n),t},d=document.documentElement},function(e,n){e.exports=function(e){for(var n,t=!1,a=0,r=0,o=e.length,i=0;o>i;i++){var l=e[i];n?"tr"!==l.nodeName&&l.children?n=!1:(n.children.push(l),a++,e[i]=0):"tr"===(l.type||l.nodeName)&&(n={nodeName:"tbody",children:[]},n.children.push(l),l.type&&delete l.type,t=!0,0===r&&(r=i),e[i]=n)}if(t)for(i=r;o>i&&(0!==e[i]||(e.splice(i,1),i--,a--,0!==a));i++);}},function(e,n){function t(e,n,t){switch(n){case"style":case"script":case"noscript":case"template":case"xmp":e.children=[{nodeName:"#text",skipContent:!0,nodeValue:t}];break;case"textarea":var r=e.props;r.type="textarea",r.value=t,e.children=[];break;case"option":e.children=[{nodeName:"#text",nodeValue:a(t)}]}}function a(e){return String(e).replace(r,"").trim()}var r=/<\w+(\s+("[^"]*"|'[^']*'|[^>])+)?>|<\/\w+>/gi;e.exports=t},function(e,n){function t(e,n){for(var l=0;l<e.length;l++){var s=e[l],c=n[l]||e[l];switch(s.nodeName){case"#text":if(s.dynamic){var u=s.nodeValue+"";u!==c.nodeValue&&(c.nodeValue=u,c.dom&&(c.dom.nodeValue=u))}break;case"#comment":s.forExpr?i["for"].diff(s,c,e,n,l):c.afterChange&&a(c,c.afterChange);break;case void 0:t(s,c);break;case"#document-fragment":t(s.children,c.children);break;default:if(s.dynamic){var d=l;s["ms-widget"]&&(avalon.directives.widget.diff(s,c,"ms-widget",e,n,d),s=e[l],c=n[l]||o(),delete s["ms-widget"]),"ms-if"in s&&(avalon.directives["if"].diff(s,c,"ms-if",e,n,d),s=e[l],c=n[l]||o(),delete s["ms-if"]),r(s,c)}!/^\w/.test(s.nodeName)||s.skipContent||s.isVoidTag||t(s.children,c.children||[]),c.afterChange&&a(c,c.afterChange)}}}function a(e,n){if(n.length)for(var t,a=0;t=n[a++];)t(e.dom,e);delete e.afterChange}function r(e,n){var t=avalon.directives;try{for(var a in e){var r=a.match(l),o=r&&r[1];t[o]&&t[o].diff(e,n,a)}}catch(i){avalon.warn(o,i,i.stack||i.message,"diffProps error")}}var o=function(){return{children:[],props:{}}},i=avalon.directives,l=/^ms-(\w+)-?(.*)/;avalon.diff=t,avalon.diffProps=r,e.exports=t},function(e,n,t){function a(e){if(o)return avalon.Array.ensure(r,e);o=e;var n=avalon.scopes[e];if(!n||!document.nodeName||avalon.suspendUpdate)return o=null;var t=n.vmodel,i=t.$element,l=i.vtree||[],s=t.$render,c=s(n.vmodel,n.local);n.isTemp&&delete avalon.scopes[e],avalon.diff(c,l);var u=r.indexOf(o);if(o=0,u>-1){var d=r.splice(u,1);return a(d[0])}var v=r.shift();v&&a(v)}var r=(t(52),[]),o=!1;avalon.suspendUpdate=0,e.exports=avalon.batch=a},,function(e,n){function t(e){for(;e;){if(9===e.nodeType)return!0;e=e.parentNode}return!1}function a(e){if(1===e.nodeType&&e.getAttribute("wid")&&!t(e)){var n=e.getAttribute("wid"),a=avalon.scopes[n];if(!a)return;var o=a.vmodel;if(a.vmodel.$fire("onDispose",{type:"dispose",target:e,vmodel:o}),a&&!e.getAttribute("cached")){delete a.vmodel,delete avalon.scopes[n];var i=e.getAttribute("is"),l=e.vtree;r(l),l&&(l[0][i+"-mount"]=!1,l[0]["component-ready:"+i]=!1)}return!1}}function r(e){for(var n in e){var t=e[n];if(l.test(t.nodeName)){for(var n in t)0===n.indexOf("ms-on")&&delete t[n];t.children&&r(t.children)}}}function o(e){setTimeout(function(){a(e)},4)}function i(e){for(var n,t=0;n=e[t++];)a(n)}var l=/^\w/;e.exports={fireDisposeHookDelay:o,fireDisposeHooks:i,fireDisposeHook:a}},,,function(e,n,t){function a(e,n){n.__vmodel__=e;var t=f.hideProperty;t(e,"$events",n),t(e,"$watch",function(){if(2===arguments.length)return g.apply(e,arguments);throw"$watch方法参数不对"}),t(e,"$fire",function(n,t,a){var r=e.$events[n];h(r,e,n,t,a)})}function r(e,n,t){return"$"===e.charAt(0)||t[e]||y.test(avalon.type(n))||n&&n.nodeName&&n.nodeType>0}function o(e,n,t,a){if(Array.isArray(e))return f.arrayFactory(e,n,t,a);if(Object(e)===e&&"function"!=typeof e){if(n&&n.$id){if(++avalon.suspendUpdate,n.$track!==Object.keys(e).sort().join(";;"))var r=f.slaveFactory(n,e,t,a);else r=n;for(var o in e)p[o]||(r[o]=e[o]);return--avalon.suspendUpdate,r}return r=f.masterFactory(e,t,a)}return e}function i(e,n,t){function a(){return r}var r=NaN;return a.heirloom=t,{get:a,set:function(o){if(r!==o){var i=t.__vmodel__;o&&"object"==typeof o&&(o=f.modelAdaptor(o,r,t,{pathname:n,id:e}));var d=r;if(r=o,this.$hashcode&&i){if(i.$events.$$dirty$$=!0,i.$events.$$wait$$)return;t!==i.$events&&(a.heirloom=i.$events),c(a.$decompose,n,o,d),-1===n.indexOf("*")&&h(a.heirloom[n],i,n,o,d),s(e+"",i,n,o,d),u(a.heirloom,i,n,o,d),i.$events.$$dirty$$=!1,l(i.$id)}}},enumerable:!0,configurable:!0}}function l(e){avalon.rerenderStart=new Date;var n=e.indexOf(".");n>0?avalon.batch(e.slice(0,n)):avalon.batch(e)}function s(e,n,t,a,r){if(e.indexOf(".*.")>0){var o=e.match(_),i=avalon.vmodels[o[1]];if(i){var l=o[2];h(i.$events[l],n,t,a,r)}}}function c(e,n,t,a){if(e&&e[n]){var r=e[n];if(r.$hashcode){var o=n.replace(/^[^.]+\./,"");o!==n&&h(r.$events[o],r,o,t,a)}else delete e[n]}}function u(e,n,t,a,r){e.__fuzzy__&&e.__fuzzy__.replace(avalon.rword,function(o){var i=e[o],l=i.reg;return l&&l.test(t)&&h(i,n,t,a,r),o})}function d(e){var n=e.$id;if(!n&&avalon.config.debug&&avalon.warn("vm.$id must be specified"),avalon.vmodels[n])throw Error("error:["+n+"] had defined!");var t=f.masterFactory(e,{},{pathname:"",id:n,master:!0});return avalon.vmodels[n]=t}function v(e,n,t,a){if(n&&n.splice){var r=[0,n.length].concat(e);return++avalon.suspendUpdate,avalon.callArray=a.pathname,n.splice.apply(n,r),--avalon.suspendUpdate,n}for(var i in b)e[i]=b[i];e.notify=function(e,n,r,o){var i=t.__vmodel__;if(i){var s=null===e||void 0===e?a.pathname:a.pathname+"."+e;i.$fire(s,n,r),o||t.$$wait$$||avalon.suspendUpdate||(avalon.callArray=s,
l(i.$id),delete avalon.callArray)}};var s=avalon.makeHashCode("$");a.array=!0,a.hashcode=s,a.id=a.id||s,f.initViewModel(e,t,{},{},a);for(var c=0,u=e.length;u>c;c++)e[c]=o(e[c],0,{},{id:e.$id+".*",master:!0});return e}var f={},p=t(68),m=t(83),h=m.$emit,g=m.$watch,y=/function|window|date|regexp|element/i;f.modelAdaptor=o;var _=/([^.]+)\.(.+)/;f.arrayFactory=v;var b={set:function(e,n){if(e>>>0===e&&this[e]!==n){if(e>this.length)throw Error(e+"set方法的第一个参数不能大于原数组长度");this.splice(e,1,n)}},contains:function(e){return-1!==this.indexOf(e)},ensure:function(e){return this.contains(e)||this.push(e),this},pushArray:function(e){return this.push.apply(this,e)},remove:function(e){return this.removeAt(this.indexOf(e))},removeAt:function(e){return e>>>0===e?this.splice(e,1):[]},clear:function(){return this.removeAll(),this}};avalon.define=d,e.exports={$$midway:f,$$skipArray:p,isSkip:r,__array__:b,initEvents:a,makeAccessor:i,modelAdaptor:o}},function(e,n){function t(e,n){var t,a=n.split(".")[0];try{e.hasOwnProperty(a)&&(t=e.$accessors?e.$accessors[a].get.heirloom.__vmodel__:Object.getOwnPropertyDescriptor(e,a).get.heirloom.__vmodel__)}catch(r){}return t||e}function a(e){var n=e.split(".");return new RegExp("^"+n.map(function(e){return"*"===e?"(?:[^.]+)":e}).join("\\.")+"$","i")}function r(e,n,t){e&&(n.__fuzzy__?-1===n.__fuzzy__.indexOf(","+t)&&(n.__fuzzy__+=","+t):n.__fuzzy__=t)}function o(e,n){var t=e.indexOf(".*")>0||"*"===e,i=t?this:o.adjust(this,e),l=this.$events,s=l[e]||(l[e]=[]);return t&&(s.reg=s.reg||a(e)),r(t,l,e),i!==this&&r(t,this.$events,e),avalon.Array.ensure(s,n),function(){avalon.Array.remove(s,n)}}function i(e,n,t,a,r,o){if(e&&e.length)try{for(o=o||e.length-1;o>=0;o--){var l=e[o];l.call(n,a,r,t)}}catch(s){o-1>0&&i(e,n,t,a,r,o-1),avalon.log(s,t)}}o.adjust=t,e.exports={$emit:i,$watch:o,adjustVm:t}},,,function(e,n,t){var a=t(3),r=t(4);a.shadowCopy(a,r),t(87),t(6),t(7),e.exports=a},function(e,n){function t(e){if(e&&"object"==typeof e){var n=e.length,t=a.call(e);if(o.test(t))return!0;if("[object Object]"===t&&n===n>>>0)return!0}return!1}var a=avalon.inspect,r=/^\[object (?:Window|DOMWindow|global)\]$/,o=/(Array|List|Collection|Map|Arguments)\]$/;avalon.quote=JSON.stringify;var i={};"Boolean Number String Function Array Date RegExp Object Error".replace(avalon.rword,function(e){i["[object "+e+"]"]=e.toLowerCase()}),avalon.type=function(e){return null==e?String(e):"object"==typeof e||"function"==typeof e?i[a.call(e)]||"object":typeof e},avalon.isFunction=function(e){return"function"==typeof e},avalon.isWindow=function(e){return r.test(a.call(e))},avalon.isPlainObject=function(e){return"[object Object]"===a.call(e)&&Object.getPrototypeOf(e)===Object.prototype},avalon.mix=avalon.fn.mix=function(){var e,n,t,a,r,o,i=arguments[0]||{},l=1,s=arguments.length,c=!1;for("boolean"==typeof i&&(c=i,i=arguments[1]||{},l++),"object"!=typeof i&&"function"!=typeof i&&(i={}),l===s&&(i=this,l--);s>l;l++)if(null!=(e=arguments[l]))for(n in e){t=i[n];try{a=e[n]}catch(u){continue}i!==a&&(c&&a&&(avalon.isPlainObject(a)||(r=Array.isArray(a)))?(r?(r=!1,o=t&&Array.isArray(t)?t:[]):o=t&&avalon.isPlainObject(t)?t:{},i[n]=avalon.mix(c,o,a)):void 0!==a&&(i[n]=a))}return i},avalon.each=function(e,n){if(e){var a=0;if(t(e))for(var r=e.length;r>a&&n(a,e[a])!==!1;a++);else for(a in e)if(e.hasOwnProperty(a)&&n(a,e[a])===!1)break}},e.exports={avalon:avalon,isArrayLike:t}},function(e,n,t){var a=t(15),r=t(17),o=t(89),i=t(19);avalon.vdomAdaptor=function(e,n){if(!e)return"toHTML"===n?"":document.createDocumentFragment();switch(e.nodeName){case"#text":return a.prototype[n].call(e);case"#comment":return r.prototype[n].call(e);case"#document-fragment":return i.prototype[n].call(e);case void 0:return new i(e)[n]();default:return o.prototype[n].call(e)}},e.exports={VText:a,VComment:r,VElement:o,VFragment:i}},function(e,n){function t(e,n,t){this.nodeName=e,this.props=n,this.children=t}function a(e){return e!==!1&&Object(e)!==e}function r(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}var o=avalon.oneObject("circle,defs,ellipse,image,line,path,polygon,polyline,rect,symbol,text,use,g,svg"),i="content"in document.createElement("template");t.prototype={constructor:t,toDOM:function(){if(this.dom)return this.dom;var e,n=this.nodeName;e=avalon.modern&&o[n]?r(n):document.createElement(n);var t=this.props||{},l=t["ms-important"]||t["ms-controller"]||this.wid;if(l){var s=avalon.scopes[l],c=s&&s.vmodel&&s.vmodel.$element;if(c){var u=c.vtree[0];return u.children&&(this.children=u.children),c}}for(var d in t){var v=t[d];a(v)&&e.setAttribute(d,v+"")}var f=this.children||[],p=f[0]?f[0].nodeValue:"";switch(this.nodeName){case"xmp":case"script":case"style":case"noscript":e.innerHTML=p;break;case"template":i?e.innerHTML=p:e.textContent=p;break;default:this.isVoidTag||this.children.forEach(function(n){n&&e.appendChild(avalon.vdomAdaptor(n,"toDOM"))})}return this.dom=e},toHTML:function(){var e=[],n=this.props||{};for(var t in n){var r=n[t];a(r)&&e.push(t+"="+avalon.quote(n[t]+""))}e=e.length?" "+e.join(" "):"";var o="<"+this.nodeName+e;return this.isVoidTag?o+"/>":(o+=">",this.children&&(o+=this.children.map(function(e){return e?avalon.vdomAdaptor(e,"toHTML"):""}).join("")),o+"</"+this.nodeName+">")}},e.exports=t},function(e,n,t){t(91),t(92),t(93),t(94),t(95),t(28),t(96),t(97),e.exports=avalon},function(e,n){avalon.document.contains||(Node.prototype.contains=function(e){return!!(16&this.compareDocumentPosition(e))}),avalon.contains=function(e,n){try{for(;n=n.parentNode;)if(n===e)return!0;return!1}catch(t){return!1}}},function(e,n){var t=/\S+/g;"add,remove".replace(avalon.rword,function(e){avalon.fn[e+"Class"]=function(n){var a=this[0]||{};return n&&"string"==typeof n&&1===a.nodeType&&n.replace(t,function(n){a.classList[e](n)}),this}}),avalon.fn.mix({hasClass:function(e){var n=this[0]||{};return 1===n.nodeType&&n.classList.contains(e)},toggleClass:function(e,n){var a="boolean"==typeof n,r=this;return String(e).replace(t,function(e){var t=a?n:!r.hasClass(e);r[t?"addClass":"removeClass"](e)}),this}})},function(e,n,t){function a(e,n){var t=n.changeAttr;if(t){n.dynamic["ms-attr"]=1;for(var a in t){var i=t[a];if("src"===a&&window.chrome&&"EMBED"===e.tagName){e[a]=i;var l=e.parentNode,s=document.createComment("ms-src");l.replaceChild(s,e),l.replaceChild(e,s)}else if(0==a.indexOf("data-"))e.setAttribute(a,i);else{var c=r[a]||a;if("boolean"==typeof e[c]&&(e[c]=!!i),i===!1){e.removeAttribute(a);continue}var u=o.test(e)?!1:a in e.cloneNode(!1);u?e[c]=i+"":e.setAttribute(a,i)}}}n.changeAttr=null}var r=t(24),o=/^\[object SVG\w*Element\]$/;avalon.parseJSON=JSON.parse,avalon.fn.attr=function(e,n){return 2===arguments.length?(this[0].setAttribute(e,n),this):this[0].getAttribute(e)},e.exports=a},function(e,n){function t(e,n){if(e.offsetWidth<=0){var a=getComputedStyle(e,null);if(u.test(a.display)){var r={node:e};for(var o in c)r[o]=a[o],e.style[o]=c[o];n.push(r)}var i=e.parentNode;i&&1===i.nodeType&&t(i,n)}}function a(e){return e.window||e.defaultView||!1}var r=avalon.root,o=avalon.camelize,i=avalon.cssHooks,l=["","-webkit-","-o-","-moz-","-ms-"],s={"float":"cssFloat"};avalon.cssNumber=avalon.oneObject("animationIterationCount,columnCount,order,flex,flexGrow,flexShrink,fillOpacity,fontWeight,lineHeight,opacity,orphans,widows,zIndex,zoom"),avalon.cssName=function(e,n,t){if(s[e])return s[e];n=n||r.style;for(var a=0,i=l.length;i>a;a++)if(t=o(l[a]+e),t in n)return s[e]=t;return null},avalon.fn.css=function(e,n){if(avalon.isPlainObject(e))for(var t in e)avalon.css(this,t,e[t]);else var a=avalon.css(this,e,n);return void 0!==a?a:this},avalon.fn.position=function(){var e,n,t=this[0],a={top:0,left:0};return t?("fixed"===this.css("position")?n=t.getBoundingClientRect():(e=this.offsetParent(),n=this.offset(),"HTML"!==e[0].tagName&&(a=e.offset()),a.top+=avalon.css(e[0],"borderTopWidth",!0),a.left+=avalon.css(e[0],"borderLeftWidth",!0),a.top-=e.scrollTop(),a.left-=e.scrollLeft()),{top:n.top-a.top-avalon.css(t,"marginTop",!0),left:n.left-a.left-avalon.css(t,"marginLeft",!0)}):a},avalon.fn.offsetParent=function(){for(var e=this[0].offsetParent;e&&"static"===avalon.css(e,"position");)e=e.offsetParent;return avalon(e||r)},i["@:set"]=function(e,n,t){e.style[n]=t},i["@:get"]=function(e,n){if(!e||!e.style)throw new Error("getComputedStyle要求传入一个节点 "+e);var t,a=getComputedStyle(e);return a&&(t="filter"===n?a.getPropertyValue(n):a[n],""===t&&(t=e.style[n])),t},i["opacity:get"]=function(e){var n=i["@:get"](e,"opacity");return""===n?"1":n},"top,left".replace(avalon.rword,function(e){i[e+":get"]=function(n){var t=i["@:get"](n,e);return/px$/.test(t)?t:avalon(n).position()[e]+"px"}});var c={position:"absolute",visibility:"hidden",display:"block"},u=/^(none|table(?!-c[ea]).+)/;avalon.each({Width:"width",Height:"height"},function(e,n){var a="client"+e,r="scroll"+e,o="offset"+e;i[n+":get"]=function(n,t,a){var r=-4;"number"==typeof a&&(r=a),t="Width"===e?["Left","Right"]:["Top","Bottom"];var i=n[o];return 2===r?i+avalon.css(n,"margin"+t[0],!0)+avalon.css(n,"margin"+t[1],!0):(0>r&&(i=i-avalon.css(n,"border"+t[0]+"Width",!0)-avalon.css(n,"border"+t[1]+"Width",!0)),-4===r&&(i=i-avalon.css(n,"padding"+t[0],!0)-avalon.css(n,"padding"+t[1],!0)),i)},i[n+"&get"]=function(e){var a=[];t(e,a);for(var r,o=i[n+":get"](e),l=0;r=a[l++];){e=r.node;for(var s in r)"string"==typeof r[s]&&(e.style[s]=r[s])}return o},avalon.fn[n]=function(t){var l=this[0];if(0===arguments.length){if(l.setTimeout)return l["inner"+e];if(9===l.nodeType){var s=l.documentElement;return Math.max(l.body[r],s[r],l.body[o],s[o],s[a])}return i[n+"&get"](l)}return this.css(n,t)},avalon.fn["inner"+e]=function(){return i[n+":get"](this[0],void 0,-2)},avalon.fn["outer"+e]=function(e){return i[n+":get"](this[0],void 0,e===!0?2:0)}}),avalon.fn.offset=function(){var e=this[0];try{var n=e.getBoundingClientRect();if(n.width||n.height||e.getClientRects().length){var t=e.ownerDocument,a=t.documentElement,r=t.defaultView;return{top:n.top+r.pageYOffset-a.clientTop,left:n.left+r.pageXOffset-a.clientLeft}}}catch(o){return{left:0,top:0}}},avalon.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,n){avalon.fn[e]=function(t){var r=this[0]||{},o=a(r),i="scrollTop"===e;return arguments.length?void(o?o.scrollTo(i?o[n]:t,i?t:o[n]):r[e]=t):o?o[n]:r[e]}})},function(e,n){function t(e){var n=e.tagName.toLowerCase();return"input"===n&&/checkbox|radio/.test(e.type)?"checked":n}var a={"select:get":function r(e,n,t,o){var i,l=e.children;a["option:get"];t=n?t:e.selectedIndex,o=n?o:"select-one"===e.type||0>t,n=n||[];for(var s,c=0;s=l[c++];)if(!s.disabled)switch(s.nodeName.toLowerCase()){case"option":if(s.selected||s.index===t){if(i=s.value,o)return i;n.push(i)}break;case"optgroup":if(i=r(s,n,t,o),"string"==typeof i)return i}return o?null:n},"select:set":function(e,n,t){n=[].concat(n);for(var a,r=0;a=e.options[r++];)(a.selected=n.indexOf(a.value)>-1)&&(t=!0);t||(e.selectedIndex=-1)}};avalon.fn.val=function(e){var n=this[0];if(n&&1===n.nodeType){var r=0===arguments.length,o=r?":get":":set",i=a[t(n)+o];if(i)var l=i(n,e);else{if(r)return(n.value||"").replace(/\r/g,"");n.value=e}}return r?l:this}},function(e,n,t){function a(e,n,t){var r=e.getAttribute("avalon-events");if(r&&(e.disabled!==!0||"click"!==n)){var o=[],i=f[n]||(f[n]=new RegExp("\\b"+n+"\\:([^,\\s]+)","g"));r.replace(i,function(e,n){return o.push(n),e}),o.length&&t.push({elem:e,uuids:o})}e=e.parentNode;var l=avalon.gestureEvents||{};e&&e.getAttribute&&(d[n]||l[n])&&a(e,n,t)}function r(e){e=new i(e);var n=e.type,t=e.target,r=[];a(t,n,r);for(var o,l,s,c=0;(s=r[c++])&&!e.cancelBubble;){var u=e.currentTarget=s.elem;for(o=0;l=s.uuids[o++];){if(m){m=!1;break}var d=avalon.eventListeners[l];if(d){var v=p.test(l)?s.elem._ms_context_:0;if(v&&v.$hashcode===!1)return avalon.unbind(t,n,d);var f=d.call(v||t,e,u._ms_local);f===!1&&(e.preventDefault(),e.stopPropagation())}}}}function o(e){var n=c.getAttribute("delegate-events")||"";if(-1===n.indexOf(e)){var t=n.match(avalon.rword)||[];t.push(e),c.setAttribute("delegate-events",t.join(",")),g(c,e,r,!!h[e])}}function i(e){if(e.originalEvent)return this;for(var n in e)_.test(n)||"function"==typeof e[n]||(this[n]=e[n]);this.timeStamp=new Date-0,this.originalEvent=e}var l=avalon.document,s=avalon.window,c=avalon.root,u=t(6).getShortID,d=t(32),v=avalon.eventHooks;avalon.bind=function(e,n,t){if(1===e.nodeType){var a=e.getAttribute("avalon-events")||"",i=u(t),l=v[n];l&&(n=l.type||n,l.fix&&(t=l.fix(e,t),t.uuid=i));var s=n+":"+i;avalon.eventListeners[t.uuid]=t,-1===a.indexOf(n+":")&&(d[n]||h[n]?o(n):g(e,n,r));var c=a.split(",");""===c[0]&&c.shift(),-1===c.indexOf(s)&&(c.push(s),e.setAttribute("avalon-events",c.join(",")))}else g(e,n,t);return t},avalon.unbind=function(e,n,t){if(1===e.nodeType){var a=e.getAttribute("avalon-events")||"";switch(arguments.length){case 1:y(e,n,r),e.removeAttribute("avalon-events");break;case 2:a=a.split(",").filter(function(e){return-1===e.indexOf(n+":")}).join(","),e.setAttribute("avalon-events",a);break;default:var o=n+":"+t.uuid;a=a.split(",").filter(function(e){return e!==o}).join(","),e.setAttribute("avalon-events",a),delete avalon.eventListeners[t.uuid]}}else y(e,n,t)};var f={},p=/^e/,m=!1,h={focus:!0,blur:!0},g=function(e,n,t,a){e.addEventListener(n,t,a)},y=function(e,n,t){e.removeEventListener(n,t)},_=/^[A-Z_]+$/;i.prototype={preventDefault:function(){var e=this.originalEvent||{};this.returnValue=!1,e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent||{};this.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){m=!0,this.stopPropagation()},toString:function(){return"[object Event]"}},avalon.fireDom=function(e,n,t){var a=l.createEvent("Events");a.initEvent(n,!0,!0),avalon.shadowCopy(a,t),e.dispatchEvent(a)};var v=avalon.eventHooks;"onmouseenter"in c||avalon.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,n){v[e]={type:n,fn:function(n,t){return function(a){var r=a.relatedTarget;return r&&(r===n||16&n.compareDocumentPosition(r))?void 0:(delete a.type,a.type=e,t.call(this,a))}}}}),avalon.each({AnimationEvent:"animationend",WebKitAnimationEvent:"webkitAnimationEnd"},function(e,n){s[e]&&!v.animationend&&(v.animationend={type:n})}),void 0===l.onmousewheel&&(v.mousewheel={type:"wheel",fn:function(e,n){return function(e){e.wheelDeltaY=e.wheelDelta=e.deltaY>0?-120:120,e.wheelDeltaX=0,Object.defineProperty(e,"type",{value:"mousewheel"}),n.call(this,e)}}}),avalon.fn.bind=function(e,n,t){return this[0]?avalon.bind(this[0],e,n,t):void 0},avalon.fn.unbind=function(e,n,t){return this[0]&&avalon.unbind(this[0],e,n,t),this}},function(e,n,t){var a,r=t(34),o=avalon.document,i=avalon.window,l=[],s=function(e){for(a=!0;e=l.shift();)e(avalon)};"complete"===o.readyState?setTimeout(s):o.addEventListener("DOMContentLoaded",s),avalon.bind(i,"load",s),avalon.ready=function(e){a?e(avalon):l.push(e)},avalon.ready(function(){r(o.body)})},function(e,n,t){t(43),t(45),t(99),t(47),t(48),t(49),t(50),t(51),t(53),t(54),t(100),t(62),t(63),t(64),t(65),t(66),t(69)},function(e,n,t){var a=t(93),r=t(44);avalon.directive("attr",{diff:function(e,n,t){var a=e[t],o=n[t];if(a&&"object"==typeof a){if(Array.isArray(a)&&(a=avalon.mix.apply({},a)),n.dynamic[t]&&o){var i={},l=!1;for(var s in a)a[s]!==o[s]&&(l=!0,i[s]=a[s]);l&&(n[t]=a,n.changeAttr=i)}else n.changeAttr=n[t]=a;n.changeAttr&&r(n,this.update)}e!==n&&delete e[t]},update:a})},function(e,n,t){function a(e){for(var n,t=0;n=this.parsers[t++];){var a=avalon.parsers[n];a&&(e=a.call(this,e))}return e}var r=t(44),o=t(41),i=t(39),l=/\|\s*change\b/,s=/^(?:checkbox|radio)$/,c=/\|\s*debounce(?:\(([^)]+)\))?/,u=t(101),d=t(59),v=t(57),f=t(102),p=t(61),m="ms-duplex";avalon.directive("duplex",{priority:2e3,parse:function(e,n,t){var a,r=t.expr,u=n.props.type,d=t.param,v=!1;d=d?d.split("-").map(function(e){return"checked"===e&&(v=!0),e}):[],s.test(u)&&v&&(d=[],a="radio"),/input|textarea|select/.test(n.nodeName)?a||(a="select"===n.nodeName?"select":"checkbox"===u?"checkbox":"radio"===u?"radio":"input"):"contenteditable"in n.props&&(a="contenteditable");var f=!1,p=0;if("input"===a||"contenteditable"===a){var h=!0;if(l.test(r)&&(f=!0),!f){var g=r.match(c);g&&(p=parseInt(g[1],10)||300)}}var y=e.props["data-duplex-changed"],_=avalon.parseExpr(t,"duplex"),b=d.map(function(e){return avalon.quote(e)});e[m]=i({type:a,vmodel:"__vmodel__",local:"__local__",debug:avalon.quote(t.name+"="+t.expr),isChecked:v,parsers:"["+b+"]",isString:!!h,isChanged:f,debounceTime:p,get:_,set:o.get("duplex:set:"+r),callback:y?avalon.parseExpr(y,"on"):"avalon.noop"})},diff:function(e,n){if(n.dynamic[m])t=n[m];else{var t=n[m]=e[m];t.parse=a}e!==n&&(e[m]=null);var o=t.get(t.vmodel),i=t.value;if(t.isString){if(o=t.parse(o),o+="",o===i)return}else if(Array.isArray(o)){var l=!0;if(o+""===t.arrayHack)return}t.value=o,l&&(t.arayHack=o+""),r(n,this.update,"afterChange")},update:function(e,n){if(e&&1===e.nodeType){n.dynamic[m]=1,e.__ms_duplex__||(e.__ms_duplex__=avalon.mix(n[m],{dom:e}),u(e,n),p(e,n));var t=e.__ms_duplex__;if(t.dom=e,t.isString&&!avalon.msie&&d===!1&&!e.valueHijack){e.valueHijack=v;var a=setInterval(function(){avalon.contains(avalon.root,e)?e.valueHijack({type:"poll"}):clearInterval(a)},30)}f[t.type].call(t)}}})},function(e,n,t){function a(e,n){var t={},a=n["ms-duplex"];switch(a.update=d,a.type){case"radio":case"checkbox":t.click=d;break;case"select":t.change=d;break;case"contenteditable":a.isChanged?t.blur=d:(f.webkitURL?t.webkitEditableContentChanged=d:f.MutationEvent&&(t.DOMCharacterDataModified=d),t.input=d);break;case"input":a.isChanged?t.change=d:(t.input=d,t.compositionstart=l,t.compositionend=s,avalon.msie&&(t.keyup=r))}/password|text/.test(n.props.type)&&(t.focus=o,t.blur=i,a.getCaret=c,a.setCaret=u);for(var v in t)avalon.bind(e,v,t[v])}function r(e){var n=e.keyCode;91===n||n>15&&19>n||n>=37&&40>=n||d.call(this,e)}function o(){this.caret=!0}function i(){this.caret=!1}function l(){this.composing=!0}function s(e){this.composing=!1;var n=this;setTimeout(function(){d.call(n,e)},0)}function c(e){var n=NaN;return e.setSelectionRange&&(n=e.selectionStart),n}function u(e,n){e.value&&!e.readOnly&&(e.selectionStart=n,e.selectionEnd=n)}var d=t(57),v=t(6).getShortID,f=(avalon.msie,avalon.window);avalon.document;v(o),v(i),v(l),v(s),v(r),v(d),e.exports=a},function(e,n){var t={input:function(){this.dom.value=this.value},radio:function(){var e;e=this.isChecked?!!this.value:this.value+""===this.dom.value;var n=this.dom;n.checked=e},checkbox:function(){for(var e=!1,n=this.dom,t=n.value,a=0;a<this.value.length;a++){var r=this.value[a];r+""===t&&(e=!0)}n.checked=e},select:function(){var e=Array.isArray(this.value)?this.value.map(String):this.value+"";avalon(this.dom).val(e)},contenteditable:function(){this.dom.innerHTML=this.value,this.update.call(this.dom)}};e.exports=t},,,function(e,n,t){function a(){function e(e,n){var a=t[e];t[e]=function(e,t){return n.call(this,a,e,t)}}function n(e){var n=avalon.slice(this.getElementsByTagName("*"));s.call(this,e),o(n)}if(!a.execute){a.execute=!0;var t=Node.prototype;e("removeChild",function(e,n,t){return e.call(this,n,t),1===n.nodeType&&i(n),n}),e("replaceChild",function(e,n,t){return e.call(this,n,t),1===n.nodeType&&i(n),n});var r=Element.prototype,l=Object.getOwnPropertyDescriptor(r,"innerHTML"),s=l.set;l.set=n;try{Object.defineProperty(r,"innerHTML",l)}catch(c){r._lookupSetter__&&(s=r.__lookupSetter__("innerHTML"),r.__defineSetter__("innerHTML",n))}e("appendChild",function(e,n){return e.call(this,n),1===n.nodeType&&11===this.nodeType&&i(n),n}),e("insertBefore",function(e,n,t){return e.call(this,n,t),1===n.nodeType&&11===this.nodeType&&i(n),n})}}var r=t(79),o=(r.fireDisposeHook,r.fireDisposeHooks),i=r.fireDisposeHookDelay;e.exports=function(e){a(e)}},function(e,n,t){function a(e,n,t){return!t[e]&&"$"!==e.charAt(0)&&n&&!n.$id&&"object"==typeof n&&!n.nodeType&&!n.nodeName}function r(e){return(";;"+this.$track+";;").indexOf(";;"+e+";;")>-1}function o(e){var n=avalon.type(e);if("array"===n){for(var t=[],a=0;a<e.length;a++)t[a]=o(e[a]);return t}if("object"===n){var r={};return e.$track.split("??").forEach(function(n){var t=e[n];r[n]=t&&t.nodeType?t:o(t)}),r}return e}function i(e,n){if(e.$compose){var t=n.split(".")[0];return e.$compose[t]||e}return e}function l(e,n,t){var a=this.$events[e];b(a,this,e,n,t)}function s(e,n,t){var r={};e.$skipArray&&(r=avalon.oneObject(e.$skipArray),delete e.$skipArray),t=t||{};var o=y("$");t.id=t.id||o,t.hashcode=o;var i=[];for(var l in e)if(!h[l]){i.push(l);var s=e[l];a(l,s,r)&&(e[l]=m.modelAdaptor(s,0,n,{id:e.$id+"."+l}))}e.$track=i.sort().join(";;");var u=c(e);return v(u,n,{},{},t)}function c(e){return Proxy.create?Proxy.create(e,k):new Proxy(e,k)}function u(e,n,t){for(var r in n)if(!h[r]&&!e.hasOwnProperty(r)){var o=n[r];a(r,o,{})&&(e[r]=m.modelAdaptor(o,0,t,{id:e.$id+"."+r}))}return r in e&&n.hasOwnProperty(r)&&delete e[r],e.$track=Object.keys(n).sort().join(";;"),e}function d(e){for(var n,t={},r={},o={},i={},l=0;l<arguments.length;l++){var s=arguments[l],u=s.$id&&s.$events;for(var d in s)if(!h[d]){var f=r[d]=s[d];a(d,f,t)&&(r[d]=m.modelAdaptor(f,0,i,{id:r.$id+"."+d})),u&&(o[d]=s)}u&&(n=s)}r.$track=Object.keys(r).sort().join(";;");var p=c(r);p.$compose=o;for(var l in o){var g=o[l];g.$decompose||(g.$decompose={}),g.$decompose[l]=p}return v(p,i,{},{},{id:e.$id,hashcode:y("$"),master:!0})}function v(e,n,t,a,i){return i.array?Object.defineProperty(e,"$model",{get:function(){return o(this)},set:avalon.noop,enumerable:!1,configurable:!0}):e.hasOwnProperty=r,e.$id=i.id,e.$hashcode=i.hashcode,e.$events=n,i.master===!0&&(e.$element=null,e.$render=0,e.$fire=l,e.$watch=x,n.__vmodel__=e),e}function f(e,n){e.length!==n&&e.notify("length",e.length,n,!0)}var p=t(82),m=p.$$midway,h=p.$$skipArray;h.$compose=!0,h.$decompose=!0,delete h;var g=p.modelAdaptor,y=avalon.makeHashCode,_=t(83),b=_.$emit,x=_.$watch;if(p.toJson=o,avalon.window.Proxy){x.adjust=i,m.masterFactory=s,m.slaveFactory=u,avalon.mediatorFactory=m.mediatorFactory=d,m.initViewModel=v;var w=p.__array__,$=Array.prototype,C=$.splice;w.removeAll=function(e){var n=this.length;if(Array.isArray(e))for(var t=this.length-1;t>=0;t--)-1!==e.indexOf(this[t])&&C.call(this,t,1);else if("function"==typeof e)for(t=this.length-1;t>=0;t--){var a=this[t];e(a,t)&&C.call(this,t,1)}else C.call(this,0,this.length);f(this,n),this.notify()};var A=["push","pop","shift","unshift","splice"];A.forEach(function(e){var n=$[e];w[e]=function(t,a){var r=[],o=this.length;if("splice"===e&&Object(this[0])===this[0])for(var i=this.slice(t,a),l=$.slice.call(arguments,2),r=[t,a],s=0,c=l.length;c>s;s++){var u=i[s];r[s+2]=g(l[s],u,u&&u.$events,{id:this.$id+".*",master:!0})}else for(var d=0,v=arguments.length;v>d;d++)r[d]=g(arguments[d],0,{},{id:this.$id+".*",master:!0});var p=n.apply(this,r);return f(this,o),this.notify(),p}}),"sort,reverse".replace(avalon.rword,function(e){w[e]=function(){return $[e].apply(this,arguments),this.notify(),this}})}var k={deleteProperty:function(e,n){e.hasOwnProperty(n)&&(e.$track=(";;"+e.$track+";;").replace(";;"+n+";;","").slice(2,-2))},get:function(e,n){return"$model"===n?o(e):e[n]},set:function(e,n,t){if("$model"!==n){var a=e[n];if(a!==t){if(!h[n]&&void 0===a&&!e.hasOwnProperty(n)){var r=e.$track.split(";;");r.push(n),e.$track=r.sort().join(";;")}if(e[n]=t,e.$decompose){var o=e.$decompose[n];if(o&&n in o)return void(o.$hashcode?o[n]=t:delete e.$decompose[n])}if(!h[n]){var l=e.$events.__vmodel__,r=e.$id.split("."),s=r.shift(),c=r.concat(n).join("."),u=i(l,c);t&&"object"==typeof t&&!t.$id&&(t=m.modelAdaptor(t,a,u.$events,{pathname:c,id:e.$id}),e[n]=t);var d=u.$events[c];d&&d.length&&b(d,u,c,t,a),avalon.rerenderStart=Date.now(),avalon.batch(s,!0)}}}},has:function(e,n){return e.hasOwnProperty(n)}};e.exports=avalon}])});
//# sourceMappingURL=avalon.next.min.js.map