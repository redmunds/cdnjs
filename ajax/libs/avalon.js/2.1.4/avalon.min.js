!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.avalon=t():e.avalon=t()}(this,function(){return function(e){function t(a){if(n[a])return n[a].exports;var r=n[a]={exports:{},id:a,loaded:!1};return e[a].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){var a=n(1);n(8),n(14),n(20),n(42),n(71),a.onComponentDispose=n(78),n(80),e.exports=a},function(e,t,n){n(2);var a=n(3),r=n(4);a.shadowCopy(a,r),n(5),n(6),n(7),e.exports=a},function(e,t){function n(e,t,n){var a="for(var "+e+"i=0,n = this.length; i < n; i++){"+t.replace("_","((i in this) && fn.call(scope,this[i],i,this))")+"}"+n;return Function("fn,scope",a)}var a=Object.prototype.hasOwnProperty;if(!"司徒正美".trim){var r=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;String.prototype.trim=function(){return this.replace(r,"")}}var o=!{toString:null}.propertyIsEnumerable("toString"),i=function(){}.propertyIsEnumerable("prototype"),l=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],s=l.length;Object.keys||(Object.keys=function(e){var t=[],n=i&&"function"==typeof e;if("string"==typeof e||e&&e.callee)for(var r=0;r<e.length;++r)t.push(String(r));else for(var c in e)n&&"prototype"===c||!a.call(e,c)||t.push(String(c));if(o)for(var u=e.constructor,d=u&&u.prototype===e,v=0;s>v;v++){var f=l[v];d&&"constructor"===f||!a.call(e,f)||t.push(f)}return t}),Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),Array.isArray.bind||(Function.prototype.bind=function(e){if(arguments.length<2&&void 0===e)return this;var t=this,n=arguments;return function(){var a,r=[];for(a=1;a<n.length;a++)r.push(n[a]);for(a=0;a<arguments.length;a++)r.push(arguments[a]);return t.apply(e,r)}});var c=Array.prototype.slice;try{c.call(document.documentElement)}catch(u){Array.prototype.slice=function(e,t){if(t="undefined"!=typeof t?t:this.length,Array.isArray(this))return c.call(this,e,t);var n,a,r=[],o=this.length,i=e||0;i=i>=0?i:o+i;var l=t?t:o;if(0>t&&(l=o+t),a=l-i,a>0)if(r=new Array(a),this.charAt)for(n=0;a>n;n++)r[n]=this.charAt(i+n);else for(n=0;a>n;n++)r[n]=this[i+n];return r}}var d=Array.prototype;if(!/\[native code\]/.test(d.map)){var v={indexOf:function(e,t){var n=this.length,a=~~t;for(0>a&&(a+=n);n>a;a++)if(this[a]===e)return a;return-1},lastIndexOf:function(e,t){var n=this.length,a=null==t?n-1:t;for(0>a&&(a=Math.max(0,n+a));a>=0;a--)if(this[a]===e)return a;return-1},forEach:n("","_",""),filter:n("r=[],j=0,","if(_)r[j++]=this[i]","return r"),map:n("r=[],","r[i]=_","return r"),some:n("","if(_)return true","return false"),every:n("","if(!_)return false","return true")};for(var f in v)d[f]=v[f]}e.exports={}},function(e,t){(function(t){function n(e){return new n.init(e)}t.avalon=n,"undefined"!=typeof window&&(window.avalon=n),n.init=function(e){this[0]=this.element=e},n.fn=n.prototype=n.init.prototype,n.shadowCopy=function(e,t){for(var n in t)e[n]=t[n];return e};var a=/[^, ]+/g,r=t.console;n.shadowCopy(n,{noop:function(){},rword:a,inspect:{}.toString,ohasOwn:{}.hasOwnProperty,log:function(){r&&n.config.debug&&Function.apply.call(console.log,console,arguments)},warn:function(){if(r&&n.config.debug){var e=console.warn||console.log;Function.apply.call(e,console,arguments)}},error:function(e,t){throw(t||Error)(e)},oneObject:function(e,t){"string"==typeof e&&(e=e.match(a)||[]);for(var n={},r=void 0!==t?t:1,o=0,i=e.length;i>o;o++)n[e[o]]=r;return n}}),e.exports=n}).call(t,function(){return this}())},function(e,t){(function(t){var n=t,a={window:n,document:{createElement:function(){return{}},createElementNS:function(){return{}},contains:Boolean},root:{outerHTML:"x"},msie:NaN,modern:!0,avalonDiv:{},avalonFragment:null};if(n.location&&n.navigator&&n.window){var r=n.document;a.document=r,a.modern=n.dispatchEvent,a.root=r.documentElement,a.avalonDiv=r.createElement("div"),a.avalonFragment=r.createDocumentFragment(),n.VBArray&&(a.msie=r.documentMode||(n.XMLHttpRequest?7:6))}e.exports=a}).call(t,function(){return this}())},function(e,t){function n(e){return m.lastIndex=0,'"'+(m.test(e)?String(e).replace(m,p):e)+'"'}function a(e){return i.test(o.call(e))}function r(e){if(!e)return!1;var t=e.length;if(t===t>>>0){var n=o.call(e).slice(8,-1);if(s.test(n))return!1;if("Array"===n)return!0;try{return{}.propertyIsEnumerable.call(e,"length")===!1?y.test(e.item||e.callee):!0}catch(a){return!e.window}}return!1}var o=avalon.inspect,i=/^\[object (?:Window|DOMWindow|global)\]$/,l=/\[native code\]/,s=/(Array|List|Collection|Map|Arguments)\]$/,c=avalon.ohasOwn,u={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},d="000000",v=function(e,t){return(d+(t||0)).slice(-e)},f="\\u00",p=function(e){var t=e.charCodeAt(0),n=u[t];return n?n:f+v(2,t.toString(16))},m=/[\x00-\x1f\x22\x5c]/g;avalon.quote="undefined"!=typeof JSON?JSON.stringify:n;var h={};"Boolean Number String Function Array Date RegExp Object Error".replace(avalon.rword,function(e){h["[object "+e+"]"]=e.toLowerCase()}),avalon.type=function(e){return null==e?String(e):"object"==typeof e||"function"==typeof e?h[o.call(e)]||"object":typeof e};var y=/^\s*\bfunction\b/;avalon.isFunction="object"==typeof alert?function(e){try{return y.test(e+"")}catch(t){return!1}}:function(e){return"[object Function]"===o.call(e)},avalon.isWindow=function(e){return e?e==e.document&&e.document!=e:!1},a(avalon.window)&&(avalon.isWindow=a);var g,_;for(g in avalon({}))break;_="0"!==g,avalon.isPlainObject=function(e,t){if(!e||"object"!==avalon.type(e)||e.nodeType||avalon.isWindow(e))return!1;try{if(e.constructor&&!c.call(e,"constructor")&&!c.call(e.constructor.prototype||{},"isPrototypeOf"))return!1}catch(n){return!1}if(_)for(t in e)return c.call(e,t);for(t in e);return void 0===t||c.call(e,t)},l.test(Object.getPrototypeOf)&&(avalon.isPlainObject=function(e){return"[object Object]"===o.call(e)&&Object.getPrototypeOf(e)===Object.prototype}),avalon.mix=avalon.fn.mix=function(){var e,t,n,a,r,o,i=arguments[0]||{},l=1,s=arguments.length,c=!1;for("boolean"==typeof i&&(c=i,i=arguments[1]||{},l++),"object"==typeof i||avalon.isFunction(i)||(i={}),l===s&&(i=this,l--);s>l;l++)if(null!=(e=arguments[l]))for(t in e){try{n=i[t],a=e[t]}catch(u){continue}i!==a&&(c&&a&&(avalon.isPlainObject(a)||(r=Array.isArray(a)))?(r?(r=!1,o=n&&Array.isArray(n)?n:[]):o=n&&avalon.isPlainObject(n)?n:{},i[t]=avalon.mix(c,o,a)):void 0!==a&&(i[t]=a))}return i},avalon.each=function(e,t){if(e){var n=0;if(r(e))for(var a=e.length;a>n&&t(n,e[n])!==!1;n++);else for(n in e)if(e.hasOwnProperty(n)&&t(n,e[n])===!1)break}},e.exports={avalon:avalon,isArrayLike:r}},function(e,t){function n(e,t,n){e[n.name]=avalon.parseExpr(n)}var a={},r=/([a-z\d])([A-Z]+)/g,o=/[-_][^-_]/g,i=/\d\.\d{4}/,l=/[-.*+?^${}()|[\]\/\\]/g,s=[].slice;avalon.shadowCopy(avalon,{caches:{},vmodels:{},filters:{},components:{},directives:{},eventHooks:{},eventListeners:{},validators:{},scopes:{},cssHooks:a,parsers:{number:function(e){return""===e?"":/\d\.$/.test(e)?e:parseFloat(e)||0},string:function(e){return null===e||void 0===e?"":e+""},"boolean":function(e){return""===e?e:"true"===e||"1"==e}},version:"2.112",slice:function(e,t,n){return s.call(e,t,n)},css:function(e,t,n,r){if(e instanceof avalon&&(e=e[0]),1===e.nodeType){var o=avalon.camelize(t);if(t=avalon.cssName(o)||o,void 0===n||"boolean"==typeof n){r=a[o+":get"]||a["@:get"],"background"===t&&(t="backgroundColor");var i=r(e,t);return n===!0?parseFloat(i)||0:i}if(""===n)e.style[t]="";else{if(null==n||n!==n)return;isFinite(n)&&!avalon.cssNumber[o]&&(n+="px"),r=a[o+":set"]||a["@:set"],r(e,t,n)}}},directive:function(e,t){return t.parse=t.parse||n,this.directives[e]=t},isObject:function(e){return null!==e&&"object"==typeof e},range:function(e,t,n){n||(n=1),null==t&&(t=e||0,e=0);for(var a=-1,r=Math.max(0,Math.ceil((t-e)/n)),o=new Array(r);++a<r;)o[a]=e,e+=n;return o},hyphen:function(e){return e.replace(r,"$1-$2").toLowerCase()},camelize:function(e){return!e||e.indexOf("-")<0&&e.indexOf("_")<0?e:e.replace(o,function(e){return e.charAt(1).toUpperCase()})},makeHashCode:function(e){return e=e||"avalon",String(Math.random()+Math.random()).replace(i,e)},escapeRegExp:function(e){return(e+"").replace(l,"\\$&")},Array:{merge:function(e,t){e.push.apply(e,t)},ensure:function(e,t){return-1===e.indexOf(t)?e.push(t):void 0},removeAt:function(e,t){return!!e.splice(t,1).length},remove:function(e,t){var n=e.indexOf(t);return~n?avalon.Array.removeAt(e,n):!1}}}),"undefined"!=typeof performance&&performance.now&&(avalon.makeHashCode=function(e){return e=e||"avalon",(e+performance.now()).replace(".","")});var c=1;e.exports={avalon:avalon,getLongID:function(e){return e.uuid||(e.uuid=avalon.makeHashCode("e"))},getShortID:function(e){return e.uuid||(e.uuid="_"+ ++c)}}},function(e,t){function n(e){for(var t in e)if(avalon.ohasOwn.call(e,t)){var a=e[t];"function"==typeof n.plugins[t]?n.plugins[t](a):"object"==typeof n[t]?avalon.shadowCopy(n[t],a):n[t]=a}return this}avalon.config=n;var a={interpolate:function(e){var t=e[0],a=e[1];if(t===a)throw new SyntaxError("openTag!==closeTag");var r=t+"test"+a,o=avalon.avalonDiv;if(o.innerHTML=r,o.innerHTML!==r&&o.innerHTML.indexOf("&lt;")>-1)throw new SyntaxError("此定界符不合法");o.innerHTML="",n.openTag=t,n.closeTag=a;var i=avalon.escapeRegExp(t),l=avalon.escapeRegExp(a);n.rexpr=new RegExp(i+"([\\s\\S]*)"+l)}};n.plugins=a,avalon.config({interpolate:["{{","}}"],debug:!0})},function(e,t,n){function a(e){return e}var r=n(9),o=n(10),i=n(11),l=n(12),s=n(13),c=avalon.filters;avalon.__format__=function(e){var t=c[e];return t?t.get?t.get:t:a},avalon.mix(c,{uppercase:function(e){return String(e).toUpperCase()},lowercase:function(e){return String(e).toLowerCase()},truncate:function(e,t,n){return t=t||30,n="string"==typeof n?n:"...",e.length>t?e.slice(0,t-n.length)+n:String(e)},camelize:avalon.camelize,date:i,escape:avalon.escapeHtml,sanitize:o,number:r,currency:function(e,t,n){return(t||"￥")+r(e,isFinite(n)?n:2)}},l,s),e.exports=avalon},function(e,t){function n(e,t,n,a){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var r=isFinite(+e)?+e:0,o=isFinite(+t)?Math.abs(t):3,i=a||",",l=n||".",s="",c=function(e,t){var n=Math.pow(10,t);return""+(Math.round(e*n)/n).toFixed(t)};return s=(o?c(r,o):""+Math.round(r)).split("."),s[0].length>3&&(s[0]=s[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,i)),(s[1]||"").length<o&&(s[1]=s[1]||"",s[1]+=new Array(o-s[1].length+1).join("0")),s.join(l)}e.exports=n},function(e,t){var n=/<script[^>]*>([\S\s]*?)<\/script\s*>/gim,a=/\s+(on[^=\s]+)(?:=("[^"]*"|'[^']*'|[^\s>]+))?/g,r=/<\w+\b(?:(["'])[^"]*?(\1)|[^>])*>/gi,o={a:/\b(href)\=("javascript[^"]*"|'javascript[^']*')/gi,img:/\b(src)\=("javascript[^"]*"|'javascript[^']*')/gi,form:/\b(action)\=("javascript[^"]*"|'javascript[^']*')/gi};e.exports=function(e){return e.replace(n,"").replace(r,function(e,t){var n=e.toLowerCase().match(/<(\w+)\s/);if(n){var r=o[n[1]];r&&(e=e.replace(r,function(e,t,n){var a=n.charAt(0);return t+"="+a+"javascript:void(0)"+a}))}return e.replace(a," ").replace(/\s+/g," ")})}},function(e,t){function n(e){return parseInt(e,10)||0}function a(e,t,n){var a="";for(0>e&&(a="-",e=-e),e=""+e;e.length<t;)e="0"+e;return n&&(e=e.substr(e.length-t)),a+e}function r(e,t,n,r){return function(o){var i=o["get"+e]();return(n>0||i>-n)&&(i+=n),0===i&&-12===n&&(i=12),a(i,t,r)}}function o(e,t){return function(n,a){var r=n["get"+e](),o=(t?"SHORT"+e:e).toUpperCase();return a[o][r]}}function i(e){var t=-1*e.getTimezoneOffset(),n=t>=0?"+":"";return n+=a(Math[t>0?"floor":"ceil"](t/60),2)+a(Math.abs(t%60),2)}function l(e,t){return e.getHours()<12?t.AMPMS[0]:t.AMPMS[1]}function s(e,t){var a,r,o=s.locate,i="",l=[];if(t=t||"mediumDate",t=o[t]||t,"string"==typeof e)if(/^\d+$/.test(e))e=n(e);else if(d.test(e))e=+RegExp.$1;else{var v=e.trim(),f=[0,0,0,0,0,0,0],p=new Date(0);v=v.replace(/^(\d+)\D(\d+)\D(\d+)/,function(e,t,a,r){var o=4===r.length?[r,t,a]:[t,a,r];return f[0]=n(o[0]),f[1]=n(o[1])-1,f[2]=n(o[2]),""});var m=p.setFullYear,h=p.setHours;v=v.replace(/[T\s](\d+):(\d+):?(\d+)?\.?(\d)?/,function(e,t,a,r,o){return f[3]=n(t),f[4]=n(a),f[5]=n(r),o&&(f[6]=Math.round(1e3*parseFloat("0."+o))),""});var y=0,g=0;v=v.replace(/Z|([+-])(\d\d):?(\d\d)/,function(e,t,a,r){return m=p.setUTCFullYear,h=p.setUTCHours,t&&(y=n(t+a),g=n(t+r)),""}),f[3]-=y,f[4]-=g,m.apply(p,f.slice(0,3)),h.apply(p,f.slice(3)),e=p}if("number"==typeof e&&(e=new Date(e)),"date"===avalon.type(e)){for(;t;)r=u.exec(t),r?(l=l.concat(r.slice(1)),t=l.pop()):(l.push(t),t=null);return l.forEach(function(t){a=c[t],i+=a?a(e,o):t.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),i}}var c={yyyy:r("FullYear",4),yy:r("FullYear",2,0,!0),y:r("FullYear",1),MMMM:o("Month"),MMM:o("Month",!0),MM:r("Month",2,1),M:r("Month",1,1),dd:r("Date",2),d:r("Date",1),HH:r("Hours",2),H:r("Hours",1),hh:r("Hours",2,-12),h:r("Hours",1,-12),mm:r("Minutes",2),m:r("Minutes",1),ss:r("Seconds",2),s:r("Seconds",1),sss:r("Milliseconds",3),EEEE:o("Day"),EEE:o("Day",!0),a:l,Z:i},u=/((?:[^yMdHhmsaZE']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z))(.*)/,d=/^\/Date\((\d+)\)\/$/,v={AMPMS:{0:"上午",1:"下午"},DAY:{0:"星期日",1:"星期一",2:"星期二",3:"星期三",4:"星期四",5:"星期五",6:"星期六"},MONTH:{0:"1月",1:"2月",2:"3月",3:"4月",4:"5月",5:"6月",6:"7月",7:"8月",8:"9月",9:"10月",10:"11月",11:"12月"},SHORTDAY:{0:"周日",1:"周一",2:"周二",3:"周三",4:"周四",5:"周五",6:"周六"},fullDate:"y年M月d日EEEE",longDate:"y年M月d日",medium:"yyyy-M-d H:mm:ss",mediumDate:"yyyy-M-d",mediumTime:"H:mm:ss","short":"yy-M-d ah:mm",shortDate:"yy-M-d",shortTime:"ah:mm"};v.SHORTMONTH=v.MONTH,s.locate=v,e.exports=s},function(e,t){function n(e,t,n){var a=avalon.type(e);if("array"!==a&&"object"!==a)throw"orderBy只能处理对象或数组";var r=n&&0>n?-1:1;if("string"==typeof t){var o=t;t=function(e){return e&&e[o]}}e=l(e),e.forEach(function(e){e.order=t(e.value,e.key)}),e.sort(function(e,t){var n=e.order,a=t.order;return Number.isNaN(n)&&Number.isNaN(a)?0:n===a?0:n>a?r:-r});var s="array"===a,c=s?[]:{};return i(c,e,function(e){s?c.push(e.value):c[e.key]=e.value})}function a(e,t){console.log(e,t);var n=avalon.type(e);if("array"!==n&&"object"!==n)throw"filterBy只能处理对象或数组";var a=avalon.slice(arguments,2),r=avalon.type(t);if("function"===r)var o=t;else{if("string"!==r&&"number"!==r)return e;if(""===t)return e;var s=new RegExp(avalon.escapeRegExp(t),"i");console.log(s),o=function(e){return console.log(e),s.test(e)}}e=l(e).filter(function(e,t){return!!o.apply(e,[e.value,t].concat(a))});var c="array"===n,u=c?[]:{};return i(u,e,function(e){c?u.push(e.value):u[e.key]=e.value})}function r(e,t,n){if(avalon.isObject(e)&&!Array.isArray(e)){var a=[];return i(a,t,function(t){a.push(e.hasOwnProperty(t)?e[t]:n?n[t]:"")})}return e}function o(e,t,n){var a=avalon.type(e);if("array"!==a&&"object"!==a)throw"limitBy只能处理对象或数组";if("number"!=typeof t)return e;if(Number.isNaN(t))return e;"object"===a&&(e=l(e));var r=e.length;t=Math.min(r,t),n="number"==typeof n?n:0,0>n&&(n=Math.max(0,r+n));for(var o=[],s=n;r>s&&(o.push(e[s]),o.length!==t);s++);var c="array"===a;if(c)return o;var u={};return i(u,o,function(e){u[e.key]=e.value})}function i(e,t,n){for(var a=0,r=t.length;r>a;a++)n(t[a]);return e}function l(e){var t=[],n=0;return avalon.each(e,function(e,a){t[n++]={value:a,key:e}}),t}Number.isNaN=Number.isNaN||function(e){return e!==e},e.exports={limitBy:o,orderBy:n,selectBy:r,filterBy:a}},function(e,t){var n={stop:function(e){return e.stopPropagation(),e},prevent:function(e){return e.preventDefault(),e}},a={esc:27,tab:9,enter:13,space:32,del:46,up:38,left:37,right:39,down:40};avalon.each(a,function(e,t){n[e]=function(e){return e.which!==t&&(e.$return=!0),e}}),e.exports=n},function(e,t,n){var a=n(15),r=n(17),o=n(18),i=n(19);avalon.vdomAdaptor=function(e,t){if(!e)return"toHTML"===t?"":document.createDocumentFragment();switch(e.nodeName){case"#text":return a.prototype[t].call(e);case"#comment":return r.prototype[t].call(e);case"#document-fragment":return i.prototype[t].call(e);case void 0:return new i(e)[t]();default:return o.prototype[t].call(e)}},e.exports={VText:a,VComment:r,VElement:o,VFragment:i}},function(e,t,n){function a(e){this.nodeName="#text",this.nodeValue=e,this.skipContent=!r.test(e)}var r=avalon.config.rexpr,o=n(16);a.prototype={constructor:a,toDOM:function(){if(this.dom)return this.dom;var e=o(this.nodeValue);return this.dom=document.createTextNode(e)},toHTML:function(){return this.nodeValue}},e.exports=a},function(e,t){var n=/&[a-z0-9#]{2,10};/,a=avalon.avalonDiv;e.exports=function(e){return n.test(e)?(a.innerHTML=e,a.innerText||a.textContent):e}},function(e,t){function n(e){this.nodeName="#comment",this.nodeValue=e}n.prototype={constructor:n,toDOM:function(){return this.dom=document.createComment(this.nodeValue)},toHTML:function(){return"<!--"+this.nodeValue+"-->"+(this.template||"")}},e.exports=n},function(e,t){function n(e,t,n){this.nodeName=e,this.props=t,this.children=n}function a(e){return e!==!1&&Object(e)!==e}function r(e){document.styleSheets.length<31?document.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)"):document.styleSheets[0].addRule(".rvml","behavior:url(#default#VML)");var t=e.split(":");1===t.length&&t.unshift("v");var n=t[1],a=t[0];return document.namespaces[a]||document.namespaces.add(a,"urn:schemas-microsoft-com:vml"),document.createElement("<"+a+":"+n+' class="rvml">')}function o(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}var i={"class":function(e,t){e.className=t},style:function(e,t){e.style.cssText=t},"for":function(e,t){e.htmlFor=t}},l=avalon.oneObject("circle,defs,ellipse,image,line,path,polygon,polyline,rect,symbol,text,use,g,svg"),s=avalon.oneObject("shape,line,polyline,rect,roundrect,oval,arc,curve,background,image,shapetype,group,fill,stroke,shadow, extrusion, textbox, imagedata, textpath"),c=/^\w+\:\w+/;n.prototype={constructor:n,toDOM:function(){if(this.dom)return this.dom;var e,t=this.nodeName;e=avalon.modern&&l[t]?o(t):avalon.modern||!s[t]&&!c.test(t)?document.createElement(t):r(t);var n=this.props||{},u=n["ms-important"]||n["ms-controller"]||this.wid;if(u){var d=avalon.scopes[u],v=d&&d.vmodel&&d.vmodel.$element;if(v){var f=v.vtree[0];return f.children&&(this.children=f.children),v}}for(var p in n){var m=n[p];a(m)&&(i[p]&&avalon.msie<8?i[p](e,m):e.setAttribute(p,m+""))}var h=this.children||[],y=h[0]?h[0].nodeValue:"";switch(this.nodeName){case"script":e.text=y;break;case"style":"styleSheet"in e?(e.setAttribute("type","text/css"),e.styleSheet.cssText=y):e.innerHTML=y;break;case"xmp":case"noscript":e.innerText=e.textContent=y;break;case"template":e.innerHTML=y;break;default:this.isVoidTag||this.children.forEach(function(t){t&&e.appendChild(avalon.vdomAdaptor(t,"toDOM"))})}return this.dom=e},toHTML:function(){var e=[],t=this.props||{};for(var n in t){var r=t[n];a(r)&&e.push(n+"="+avalon.quote(t[n]+""))}e=e.length?" "+e.join(" "):"";var o="<"+this.nodeName+e;return this.isVoidTag?o+"/>":(o+=">",this.children&&(o+=this.children.map(function(e){return e?avalon.vdomAdaptor(e,"toHTML"):""}).join("")),o+"</"+this.nodeName+">")}},e.exports=n},function(e,t){function n(e){this.nodeName="#document-fragment",this.children=e}n.prototype={constructor:n,toDOM:function(){if(this.dom)return this.dom;for(var e,t=document.createDocumentFragment(),n=0;e=this.children[n++];)t.appendChild(avalon.vdomAdaptor(e,"toDOM"));return this.split=t.lastChild,this.dom=t},toHTML:function(){return this.children.map(function(e){return avalon.vdomAdaptor(e,"toHTML")}).join("")}},e.exports=n},function(e,t,n){n(21),n(22),n(23),n(26),n(27),n(28),n(31),n(33),e.exports=avalon},function(e,t){function n(e,t){try{for(;t=t.parentNode;)if(t===e)return!0;return!1}catch(n){return!1}}avalon.contains=n,avalon.document.contains||(avalon.document.contains=function(e){return n(document,e)}),window.Node&&!document.createTextNode("x").contains&&(Node.prototype.contains=function(e){return!!(16&this.compareDocumentPosition(e))}),window.HTMLElement&&!avalon.root.outerHTML&&HTMLElement.prototype.__defineGetter__("outerHTML",function(){var e=document.createElement("div");return e.appendChild(this),e.innerHTML})},function(e,t){function n(e){if(!("classList"in e)){e.classList={node:e};for(var t in r)e.classList[t.slice(1)]=r[t]}return e.classList}var a=/\S+/g,r={_toString:function(){var e=this.node,t=e.className,n="string"==typeof t?t:t.baseVal,r=n.match(a);return r?r.join(" "):""},_contains:function(e){return(" "+this+" ").indexOf(" "+e+" ")>-1},_add:function(e){this.contains(e)||this._set(this+" "+e)},_remove:function(e){this._set((" "+this+" ").replace(" "+e+" "," "))},__set:function(e){e=e.trim();var t=this.node;"object"==typeof t.className?t.setAttribute("class",e):t.className=e}};"add,remove".replace(avalon.rword,function(e){avalon.fn[e+"Class"]=function(t){var r=this[0]||{};return t&&"string"==typeof t&&1===r.nodeType&&t.replace(a,function(t){n(r)[e](t)}),this}}),avalon.fn.mix({hasClass:function(e){var t=this[0]||{};return 1===t.nodeType&&n(t).contains(e)},toggleClass:function(e,t){var n="boolean"==typeof t,r=this;return String(e).replace(a,function(e){var a=n?t:!r.hasClass(e);r[a?"addClass":"removeClass"](e)}),this}})},function(e,t,n){function a(e,t){var n=t.changeAttr;if(e&&1===e.nodeType&&n){t.dynamic["ms-attr"]=1;for(var a in n){var s=n[a];if("href"===a||"src"===a){if(e.hasAttribute||(s=String(s).replace(l,"&")),e[a]=s,window.chrome&&"EMBED"===e.tagName){var c=e.parentNode,u=document.createComment("ms-src");c.replaceChild(u,e),c.replaceChild(e,u)}}else if(0===a.indexOf("data-"))e.setAttribute(a,s);else{var d=r[a]||a;if("boolean"==typeof e[d]&&(e[d]=!!s),s===!1){e.removeAttribute(d);continue}var v=i.test(e)?!1:!avalon.modern&&o(e)?!0:a in e.cloneNode(!1);v?e[d]=s+"":e.setAttribute(a,s)}}t.changeAttr=null}}var r=n(24),o=n(25),i=/^\[object SVG\w*Element\]$/,l=/&amp;/g,s=/^[\],:{}\s]*$/,c=/(?:^|:|,)(?:\s*\[)+/g,u=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,d=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g;avalon.parseJSON=avalon.window.JSON?JSON.parse:function(e){if("string"==typeof e){if(e=e.trim(),e&&s.test(e.replace(u,"@").replace(d,"]").replace(c,"")))return new Function("return "+e)();avalon.error("Invalid JSON: "+e)}return e},avalon.fn.attr=function(e,t){return 2===arguments.length?(this[0].setAttribute(e,t),this):this[0].getAttribute(e)},e.exports=a},function(e,t){var n={"accept-charset":"acceptCharset","char":"ch",charoff:"chOff","class":"className","for":"htmlFor","http-equiv":"httpEquiv"},a=["autofocus,autoplay,async,allowTransparency,checked,controls","declare,disabled,defer,defaultChecked,defaultSelected,","isMap,loop,multiple,noHref,noResize,noShade","open,readOnly,selected"].join(",");a.replace(/\w+/g,function(e){n[e.toLowerCase()]=e});var r=["accessKey,bgColor,cellPadding,cellSpacing,codeBase,codeType,colSpan","dateTime,defaultValue,contentEditable,frameBorder,longDesc,maxLength,marginWidth,marginHeight,rowSpan,tabIndex,useMap,vSpace,valueType,vAlign"].join(",");r.replace(/\w+/g,function(e){n[e.toLowerCase()]=e}),e.exports=n},function(e,t){function n(e){var t=e.nodeName;return t.toLowerCase()===t&&e.scopeName&&""===e.outerText}e.exports=n},function(e,t){function n(e,t){if(e.offsetWidth<=0){if(y.test(l["@:get"](e,"display"))){var a={node:e};for(var r in h)a[r]=e.style[r],e.style[r]=h[r];t.push(a)}var o=e.parentNode;o&&1===o.nodeType&&n(o,t)}}function a(e){return e.window||e.defaultView||e.parentWindow||!1}var r=avalon.root,o=avalon.window,i=avalon.camelize,l=avalon.cssHooks,s=["","-webkit-","-o-","-moz-","-ms-"],c={"float":o.Range?"cssFloat":"styleFloat"};if(avalon.cssNumber=avalon.oneObject("animationIterationCount,columnCount,order,flex,flexGrow,flexShrink,fillOpacity,fontWeight,lineHeight,opacity,orphans,widows,zIndex,zoom"),avalon.cssName=function(e,t,n){if(c[e])return c[e];t=t||r.style||{};for(var a=0,o=s.length;o>a;a++)if(n=i(s[a]+e),n in t)return c[e]=n;return null},avalon.fn.css=function(e,t){if(avalon.isPlainObject(e))for(var n in e)avalon.css(this,n,e[n]);else var a=avalon.css(this,e,t);return void 0!==a?a:this},avalon.fn.position=function(){var e,t,n=this[0],a={top:0,left:0};return n?("fixed"===this.css("position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),"HTML"!==e[0].tagName&&(a=e.offset()),a.top+=avalon.css(e[0],"borderTopWidth",!0),a.left+=avalon.css(e[0],"borderLeftWidth",!0),a.top-=e.scrollTop(),a.left-=e.scrollLeft()),{top:t.top-a.top-avalon.css(n,"marginTop",!0),left:t.left-a.left-avalon.css(n,"marginLeft",!0)}):a},avalon.fn.offsetParent=function(){for(var e=this[0].offsetParent;e&&"static"===avalon.css(e,"position");)e=e.offsetParent;return avalon(e||r)},l["@:set"]=function(e,t,n){try{e.style[t]=n}catch(a){}},o.getComputedStyle)l["@:get"]=function(e,t){if(!e||!e.style)throw new Error("getComputedStyle要求传入一个节点 "+e);var n,a=getComputedStyle(e,null);return a&&(n="filter"===t?a.getPropertyValue(t):a[t],""===n&&(n=e.style[t])),n},l["opacity:get"]=function(e){var t=l["@:get"](e,"opacity");return""===t?"1":t};else{var u=/^-?(?:\d*\.)?\d+(?!px)[^\d\s]+$/i,d=/^(top|right|bottom|left)$/,v=/alpha\([^)]*\)/i,f=!!o.XDomainRequest,p="DXImageTransform.Microsoft.Alpha",m={thin:f?"1px":"2px",medium:f?"3px":"4px",thick:f?"5px":"6px"};l["@:get"]=function(e,t){var n=e.currentStyle,a=n[t];if(u.test(a)&&!d.test(a)){var r=e.style,o=r.left,i=e.runtimeStyle.left;e.runtimeStyle.left=n.left,r.left="fontSize"===t?"1em":a||0,a=r.pixelLeft+"px",r.left=o,e.runtimeStyle.left=i}return"medium"===a&&(t=t.replace("Width","Style"),"none"===n[t]&&(a="0px")),""===a?"auto":m[a]||a},l["opacity:set"]=function(e,t,n){var a=e.style,r=isFinite(n)&&1>=n?"alpha(opacity="+100*n+")":"",o=a.filter||"";a.zoom=1,a.filter=(v.test(o)?o.replace(v,r):o+" "+r).trim(),a.filter||a.removeAttribute("filter")},l["opacity:get"]=function(e){var t=e.filters.alpha||e.filters[p],n=t&&t.enabled?t.opacity:100;return n/100+""}}"top,left".replace(avalon.rword,function(e){l[e+":get"]=function(t){var n=l["@:get"](t,e);return/px$/.test(n)?n:avalon(t).position()[e]+"px"}});var h={position:"absolute",visibility:"hidden",display:"block"},y=/^(none|table(?!-c[ea]).+)/;avalon.each({Width:"width",Height:"height"},function(e,t){var a="client"+e,r="scroll"+e,o="offset"+e;l[t+":get"]=function(t,n,a){var r=-4;"number"==typeof a&&(r=a),n="Width"===e?["Left","Right"]:["Top","Bottom"];var i=t[o];return 2===r?i+avalon.css(t,"margin"+n[0],!0)+avalon.css(t,"margin"+n[1],!0):(0>r&&(i=i-avalon.css(t,"border"+n[0]+"Width",!0)-avalon.css(t,"border"+n[1]+"Width",!0)),-4===r&&(i=i-avalon.css(t,"padding"+n[0],!0)-avalon.css(t,"padding"+n[1],!0)),i)},l[t+"&get"]=function(e){var a=[];n(e,a);for(var r,o=l[t+":get"](e),i=0;r=a[i++];){e=r.node;for(var s in r)"string"==typeof r[s]&&(e.style[s]=r[s])}return o},avalon.fn[t]=function(n){var i=this[0];if(0===arguments.length){if(i.setTimeout)return i["inner"+e]||i.document.documentElement[a]||i.document.body[a];if(9===i.nodeType){var s=i.documentElement;return Math.max(i.body[r],s[r],i.body[o],s[o],s[a])}return l[t+"&get"](i)}return this.css(t,n)},avalon.fn["inner"+e]=function(){return l[t+":get"](this[0],void 0,-2)},avalon.fn["outer"+e]=function(e){return l[t+":get"](this[0],void 0,e===!0?2:0)}}),avalon.fn.offset=function(){var e=this[0],t={left:0,top:0};if(!e||!e.tagName||!e.ownerDocument)return t;var n=e.ownerDocument,a=n.body,r=n.documentElement,o=n.defaultView||n.parentWindow;if(!avalon.contains(r,e))return t;e.getBoundingClientRect&&(t=e.getBoundingClientRect());var i=r.clientTop||a.clientTop,l=r.clientLeft||a.clientLeft,s=Math.max(o.pageYOffset||0,r.scrollTop,a.scrollTop),c=Math.max(o.pageXOffset||0,r.scrollLeft,a.scrollLeft);return{top:t.top+s-i,left:t.left+c-l}},avalon.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){avalon.fn[e]=function(n){var o=this[0]||{},i=a(o),l="scrollTop"===e;return arguments.length?void(i?i.scrollTo(l?avalon(i).scrollLeft():n,l?n:avalon(i).scrollTop()):o[e]=n):i?t in i?i[t]:r[e]:o[e]}})},function(e,t){function n(e){var t=e.tagName.toLowerCase();return"input"===t&&/checkbox|radio/.test(e.type)?"checked":t}var a=/^<option(?:\s+\w+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s>]+))?)*\s+value[\s=]/i,r={"option:get":avalon.msie?function(e){return a.test(e.outerHTML)?e.value:e.text.trim()}:function(e){return e.value},"select:get":function(e,t){for(var n,a=e.options,o=e.selectedIndex,i=r["option:get"],l="select-one"===e.type||0>o,s=l?null:[],c=l?o+1:a.length,u=0>o?c:l?o:0;c>u;u++)if(n=a[u],(n.selected||u===o)&&!n.disabled&&(!n.parentNode.disabled||"OPTGROUP"!==n.parentNode.tagName)){if(t=i(n),l)return t;s.push(t)}return s},"select:set":function(e,t,n){t=[].concat(t);for(var a,o=r["option:get"],i=0;a=e.options[i++];)(a.selected=t.indexOf(o(a))>-1)&&(n=!0);n||(e.selectedIndex=-1)}};avalon.fn.val=function(e){var t=this[0];if(t&&1===t.nodeType){var a=0===arguments.length,o=a?":get":":set",i=r[n(t)+o];if(i)var l=i(t,e);else{if(a)return(t.value||"").replace(/\r/g,"");t.value=e}}return a?l:this}},function(e,t,n){var a=n(29),r=n(30),o=/<|&#?\w+;/,i=new a(128),l=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi;avalon.parseHTML=function(e){var t=avalon.avalonFragment.cloneNode(!1);if("string"!=typeof e)return t;if(!o.test(e))return document.createTextNode(e);e=e.replace(l,"<$1></$2>").trim();var n=i.get(e);if(n)return r(n);for(var a,s=avalon.lexer(e),c=0;a=s[c++];)t.appendChild(avalon.vdomAdaptor(a,"toDOM"));return e.length<1024&&i.put(e,r(t)),t},avalon.innerHTML=function(e,t){if(!avalon.modern&&!rcreate.test(t)&&!rnest.test(t))try{return void(e.innerHTML=t)}catch(n){}var a=this.parseHTML(t);this.clearHTML(e).appendChild(a)};var s=/&(?:amp|lt|gt|quot|#39|#96);/g,c={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"};avalon.unescapeHTML=function(e){var t=""+e;return t.replace(s,function(e){return c[e]})};var u=/["'&<>]/;avalon.escapeHTML=function(e){var t=""+e,n=u.exec(t);if(!n)return t;var a,r="",o=0,i=0;for(o=n.index;o<t.length;o++){switch(t.charCodeAt(o)){case 34:a="&quot;";break;case 38:a="&amp;";break;case 39:a="&#39;";break;case 60:a="&lt;";break;case 62:a="&gt;";break;default:continue}i!==o&&(r+=t.substring(i,o)),i=o+1,r+=a}return i!==o?r+t.substring(i,o):r},avalon.clearHTML=function(e){for(e.textContent="";e.lastChild;)e.removeChild(e.lastChild);return e}},function(e,t){function n(e){this.size=0,this.limit=e,this.head=this.tail=void 0,this._keymap={}}var a=n.prototype;a.put=function(e,t){var n={key:e,value:t};return this._keymap[e]=n,this.tail?(this.tail.newer=n,n.older=this.tail):this.head=n,this.tail=n,this.size===this.limit?this.shift():this.size++,t},a.shift=function(){var e=this.head;e&&(this.head=this.head.newer,this.head.older=e.newer=e.older=this._keymap[e.key]=void 0,delete this._keymap[e.key])},a.get=function(e){var t=this._keymap[e];if(void 0!==t)return t===this.tail?t.value:(t.newer&&(t===this.head&&(this.head=t.newer),t.newer.older=t.older),t.older&&(t.older.newer=t.newer),t.newer=void 0,t.older=this.tail,this.tail&&(this.tail.newer=t),this.tail=t,t.value)},e.exports=n},function(e,t){function n(e,t){if(1===e.nodeType){var n=e.nodeName.toLowerCase();"object"===n?e.parentNode&&(e.outerHTML=t.outerHTML):"input"===n&&o.test(t.nodeName)?(e.defaultChecked=e.checked=t.checked,e.value!==t.value&&(e.value=t.value)):"option"===n?e.defaultSelected=e.selected=t.defaultSelected:"input"!==n&&"textarea"!==n||(e.defaultValue=t.defaultValue)}}function a(e){return"undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName("*"):"undefined"!=typeof e.querySelectorAll?e.querySelectorAll("*"):[]}function r(e){var t=e.cloneNode(!0);if(avalon.modern)return t;var r=a(t),o=a(e);return avalon.each(o,function(e){n(r[e],o[e])}),t}var o=/radio|checkbox/;e.exports=r},function(e,t,n){function a(e,t,n){var r=e.getAttribute("avalon-events");if(r&&(e.disabled!==!0||"click"!==t)){var o=[],i=p[t]||(p[t]=new RegExp("\\b"+t+"\\:([^,\\s]+)","g"));r.replace(i,function(e,t){return o.push(t),e}),o.length&&n.push({elem:e,uuids:o})}e=e.parentNode;var l=avalon.gestureEvents||{};e&&e.getAttribute&&(v[t]||l[t])&&a(e,t,n);
}function r(e){e=new i(e);var t=e.type,n=e.target,r=[];a(n,t,r);for(var o,l,s,c=0;(s=r[c++])&&!e.cancelBubble;){var u=e.currentTarget=s.elem;for(o=0;l=s.uuids[o++];){if(h){h=!1;break}var d=avalon.eventListeners[l];if(d){var v=m.test(l)?s.elem._ms_context_:0;if(v&&v.$hashcode===!1)return avalon.unbind(n,t,d);var f=d.call(v||n,e,u._ms_local);f===!1&&(e.preventDefault(),e.stopPropagation())}}}}function o(e){var t=c.getAttribute("delegate-events")||"";if(-1===t.indexOf(e)){var n=t.match(avalon.rword)||[];n.push(e),c.setAttribute("delegate-events",n.join(",")),g(c,e,r,!!y[e])}}function i(e){if(e.originalEvent)return this;for(var t in e)x.test(t)||"function"==typeof e[t]||(this[t]=e[t]);this.target||(this.target=e.srcElement);var n=this.target;if(null==this.which&&0===e.type.indexOf("key"))this.which=null!=e.charCode?e.charCode:e.keyCode;else if(b.test(e.type)&&!("pageX"in this)){var a=n.ownerDocument||l,r="BackCompat"===a.compatMode?a.body:a.documentElement;this.pageX=e.clientX+(r.scrollLeft>>0)-(r.clientLeft>>0),this.pageY=e.clientY+(r.scrollTop>>0)-(r.clientTop>>0),this.wheelDeltaY=this.wheelDelta,this.wheelDeltaX=0}this.timeStamp=new Date-0,this.originalEvent=e}var l=avalon.document,s=avalon.window,c=avalon.root,u=avalon.modern,d=n(6).getShortID,v=n(32);u||(delete v.change,delete v.select);var f=avalon.eventHooks;avalon.bind=function(e,t,n){if(1===e.nodeType){var a=e.getAttribute("avalon-events")||"",i=d(n),l=f[t];l&&(t=l.type||t,l.fix&&(n=l.fix(e,n),n.uuid=i));var s=t+":"+i;avalon.eventListeners[n.uuid]=n,-1===a.indexOf(t+":")&&(v[t]||avalon.modern&&y[t]?o(t):g(e,t,r));var c=a.split(",");""===c[0]&&c.shift(),-1===c.indexOf(s)&&(c.push(s),e.setAttribute("avalon-events",c.join(",")))}else g(e,t,n);return n},avalon.unbind=function(e,t,n){if(1===e.nodeType){var a=e.getAttribute("avalon-events")||"";switch(arguments.length){case 1:_(e,t,r),e.removeAttribute("avalon-events");break;case 2:a=a.split(",").filter(function(e){return-1===e.indexOf(t+":")}).join(","),e.setAttribute("avalon-events",a);break;default:var o=t+":"+n.uuid;a=a.split(",").filter(function(e){return e!==o}).join(","),e.setAttribute("avalon-events",a),delete avalon.eventListeners[n.uuid]}}else _(e,t,n)};var p={},m=/^e/,h=!1,y={focus:!0,blur:!0},g=u?function(e,t,n,a){e.addEventListener(t,n,a)}:function(e,t,n){e.attachEvent("on"+t,n)},_=u?function(e,t,n){e.removeEventListener(t,n)}:function(e,t,n){e.detachEvent("on"+t,n)};avalon.fireDom=function(e,t,n){if(l.createEvent){var a=l.createEvent("Events");a.initEvent(t,!0,!0,n),avalon.shadowCopy(a,n),e.dispatchEvent(a)}else c.contains(e)&&(a=l.createEventObject(),avalon.shadowCopy(a,n),e.fireEvent("on"+t,a))};var b=/^(?:mouse|contextmenu|drag)|click/,x=/^[A-Z_]+$/;if(i.prototype={preventDefault:function(){var e=this.originalEvent||{};e.returnValue=this.returnValue=!1,e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent||{};e.cancelBubble=this.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){h=!0,this.stopPropagation()},toString:function(){return"[object Event]"}},"onmouseenter"in c||avalon.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){f[e]={type:t,fix:function(t,n){return function(a){var r=a.relatedTarget;return r&&(r===t||16&t.compareDocumentPosition(r))?void 0:(delete a.type,a.type=e,n.apply(this,arguments))}}}}),avalon.each({AnimationEvent:"animationend",WebKitAnimationEvent:"webkitAnimationEnd"},function(e,t){s[e]&&!f.animationend&&(f.animationend={type:t})}),"oninput"in l.createElement("input")||(f.input={type:"propertychange",fix:function(e,t){return function(e){return"value"===e.propertyName?(e.type="input",t.apply(this,arguments)):void 0}}}),void 0===l.onmousewheel){var w=void 0!==l.onwheel?"wheel":"DOMMouseScroll",$="wheel"===w?"deltaY":"detail";f.mousewheel={type:w,fix:function(e,t){return function(n){var a=n[$]>0?-120:120;return n.wheelDelta=~~e._ms_wheel_+a,e._ms_wheel_=n.wheelDeltaY=n.wheelDelta,n.wheelDeltaX=0,Object.defineProperty&&Object.defineProperty(n,"type",{value:"mousewheel"}),t.apply(this,arguments)}}}}avalon.fn.bind=function(e,t,n){return this[0]?avalon.bind(this[0],e,t,n):void 0},avalon.fn.unbind=function(e,t,n){return this[0]&&avalon.unbind(this[0],e,t,n),this}},function(e,t){e.exports={click:!0,dblclick:!0,keydown:!0,keypress:!0,keyup:!0,mousedown:!0,mousemove:!0,mouseup:!0,mouseover:!0,mouseout:!0,wheel:!0,mousewheel:!0,input:!0,change:!0,beforeinput:!0,compositionstart:!0,compositionupdate:!0,compositionend:!0,select:!0,cut:!0,copy:!0,paste:!0,beforecut:!0,beforecopy:!0,beforepaste:!0,focusin:!0,focusout:!0,DOMFocusIn:!0,DOMFocusOut:!0,DOMActivate:!0,dragend:!0,datasetchanged:!0}},function(e,t,n){function a(){try{s.doScroll("left"),u()}catch(e){setTimeout(a)}}var r,o=n(34),i=avalon.document,l=avalon.window,s=avalon.root,c=[],u=function(e){for(r=!0;e=c.shift();)e(avalon)};if("complete"===i.readyState)setTimeout(u);else if(i.addEventListener)i.addEventListener("DOMContentLoaded",u);else if(i.attachEvent){i.attachEvent("onreadystatechange",function(){"complete"===i.readyState&&u()});try{var d=null===l.frameElement}catch(v){}s.doScroll&&d&&l.external&&a()}l.document&&avalon.bind(l,"load",u),avalon.ready=function(e){r?e(avalon):c.push(e)},avalon.ready(function(){o(i.body)})},function(e,t,n){function a(e){for(var t,n=0;t=e[n++];)if(1===t.nodeType){var l=r(t),s=avalon.vmodels[l];if(s&&!s.$element){avalon(t).removeClass("ms-controller"),s.$element=t;var c=i(t),u=new Date;t.vtree=avalon.speedUp(c);var d=new Date;o&&avalon.log("构建虚拟DOM耗时",d-u,"ms"),s.$render=avalon.render(t.vtree),avalon.scopes[s.$id]={vmodel:s,local:{},isTemp:!0};var v=new Date;o&&avalon.log("构建当前vm的$render方法耗时 ",v-d,"ms\n","如果此时间太长,达100ms以上\n","建议将当前ms-controller拆分成多个ms-controller,减少每个vm管辖的区域"),avalon.rerenderStart=v,o=!1,avalon.batch(l)}else l||a(t.childNodes)}}function r(e){return e.getAttribute("ms-controller")||e.getAttribute(":controller")}var o=!0,i=n(35);e.exports=avalon.scan=function(e){return e&&e.nodeType?void a([e]):void avalon.warn("[avalon.scan] first argument must be element , documentFragment, or document")}},function(e,t,n){function a(e){for(var t=e.attributes,n={},a=0,o=t.length;o>a;a++){var i=t[a];if(i.specified){var l=i.name;":"===l.charAt(0)&&(l=l.replace(d,"ms-")),n[l]=i.value}}u.test(e.nodeName)&&(n.type=e.type);var s=e.style.cssText;return s&&(n.style=s),"select-one"===n.type&&(n.selectedIndex=e.selectedIndex),r(n)?null:n}function r(e){for(var t in e)return!1;return!0}function o(e){var t={},n=e.nodeName.toLowerCase();if(t.nodeName=n,t.dom=e,"#"===n.charAt(0)){var o=e.nodeValue;/\S/.test(o)&&(t.nodeValue=o)}else{var i=a(e);c[n]&&(t.isVoidTag=!0),i&&(t.props=i),t.children=l(e.childNodes,e),i&&"selectedIndex"in t&&(e.selectedIndex=t.selectedIndex,delete t.selectedIndex,r(i)&&delete t.props)}return t}function i(e){return l([e],null)}function l(e,t){var n=[];e=avalon.slice(e);for(var a=0;a<e.length;a++){var r=e[a];switch(r.nodeType){case 1:var i=r.getAttributeNode(":for")||r.getAttributeNode("ms-for");if(i){var l=document.createComment("ms-for:"+i.value),c=document.createComment("ms-for-end:");r.removeAttributeNode(i),t&&(t.insertBefore(c,r.nextSibling),t.insertBefore(l,r)),n.push(o(l),o(r),o(c))}else n.push(o(r));break;case 3:/\S/.test(r.nodeValue)?n.push(o(r)):s(r);break;case 8:n.push(o(r))}}return n}function s(e){return v.appendChild(e),v.removeChild(e),e}var c=n(36),u=(n(37),/input|textarea|select/i),d=/^\:/,v=document.documentElement;e.exports=i},function(e,t){e.exports=avalon.oneObject("area,base,basefont,bgsound,br,col,command,embed,frame,hr,img,input,keygen,link,meta,param,source,track,wbr")},function(e,t,n){function a(e,t){for(var n,a=t?[]:["\nvar vnodes = [];"],o=0;n=e[o++];){var i=r(n);n.$prepend&&a.push(n.$prepend);var l=n.$append;delete n.$append,delete n.$prepend,i&&a.push(i+"\n"),l&&a.push(l)}return t||a.push("return vnodes\n"),a.join("\n")}function r(e){if(!e.nodeName)return!1;switch(e.nodeName){case"#text":return e.dynamic?i(s(e)):l(e);case"#comment":var t=e.nodeValue;if(e.forExpr){var n={dynamic:!0,vmodel:"__vmodel__"};for(var r in e)e.hasOwnProperty(r)&&!g[r]&&(n[r]=e[r]);return avalon.directives["for"].parse(n,e,e),e.$append+=avalon.caches[e.signature],l(n)}if("ms-for-end:"===t)return e.$append=l({nodeName:"#comment",nodeValue:e.signature})+" return vnodes}\n })\n},__local__,vnodes)\n"+l({nodeName:"#comment",signature:e.signature,nodeValue:"ms-for-end:"})+"\n","";if(0===t.indexOf("ms-js:")){var o=v(t.replace("ms-js:",""),"js")+"\n",c=l(e),f=o.match(y);return f&&f[1]?e.$append=(e.$append||"")+o+"\n__local__."+f[1]+" = "+f[1]+"\n":avalon.warn(t+" parse fail!"),c}return l(e);default:if(!e.dynamic&&e.skipContent)return l(e);var n={nodeName:e.nodeName},p=e.props;if(e.dynamic){n.dynamic="{}";var m=u(n,p);m.map(function(t){return avalon.directives[t.type].parse(n,e,t),t.name})}else if(p){n.props={};for(var r in p)n.props[r]=p[r]}if(e.isVoidTag)n.isVoidTag=!0;else if(!("children"in n)){var h=e.children;h&&(e.skipContent?n.children="["+h.map(function(e){return d(e)})+"]":1===h.length&&"#text"===h[0].nodeName?h[0].dynamic?n.children="["+s(h[0])+"]":n.children="["+d(h[0])+"]":n.children="(function(){"+a(h)+"})()")}return e.template&&(n.template=e.template),e.skipContent&&(n.skipContent=!0),l(n)}}function o(e){return h.test(e)?e:v(e,"text")}function i(e){return"vnodes.push("+e+");"}function l(e){return i(d(e))}function s(e){var t=c(e.nodeValue),n="";if(1===t.length)n=o(t[0].expr);else{var a=t.map(function(e){return e.type?o(e.expr):m(e.expr)}).join(" + ");n="String("+a+")"}return'{\nnodeName: "#text",\ndynamic:true,\nnodeValue: '+n+"\n}"}function c(e){var t=[];do{var n=e.indexOf(p.openTag);n=-1===n?e.length:n;var a=e.slice(0,n);if(/\S/.test(a)&&t.push({expr:f(a)}),e=e.slice(n+p.openTag.length)){n=e.indexOf(p.closeTag);var a=e.slice(0,n);t.push({expr:avalon.unescapeHTML(a.replace(_,"")),type:"{{}}"}),e=e.slice(n+p.closeTag.length)}}while(e.length);return t}var u=n(38),d=n(39),v=n(40),f=n(16),p=avalon.config,m=avalon.quote,h=/^[$a-zA-Z_][$a-zA-Z0-9_]*$/,y=/^\s*var\s+([$\w]+)\s*\=\s*\S+/,g={__local__:1,vmode:1,dom:1};e.exports=a;var _=/\n\s*/g},function(e,t){function n(e,t){var n=[],l={},s="ms-skip"in t,c={};for(var u in t){var d,v=t[u];if(l[u]=t[u],d=u.match(o)){if(s)continue;var f=u.replace(d[1],"").split("-");i[f[0]]&&f.unshift("on"),"on"===f[0]&&(f[2]=parseFloat(f[2])||0),f.unshift("ms");var p=f[1];if(r[p]){var m={type:p,param:f[2],name:f.join("-"),expr:v,priority:r[p].priority||100*p.charCodeAt(0)};"on"===p&&(m.priority+=f[3]),c[m.name]||(c[m.name]=v,n.push(m))}}}return e.props=l,n.sort(a),n}function a(e,t){return e.priority-t.priority}var r=avalon.directives,o=/^(\:|ms\-)\w+/,i=avalon.oneObject("animationend,blur,change,input,click,dblclick,focus,keydown,keypress,keyup,mousedown,mouseenter,mouseleave,mousemove,mouseout,mouseover,mouseup,scan,scroll,submit");e.exports=n},function(e,t){function n(e){return i.test(e)||r[e]?l(e):e}function a(e){var t=[];for(var r in e){var i=typeof e[r];if("object"===i)if("props"===r){var s=[];for(var c in e.props){var u=e.props[c];"string"==typeof u&&(u=l(u)),s.push(n(c)+": "+u)}t.push(r+": {"+s.join(",\n")+"}")}else"children"===r&&t.push("children: ["+e[r].map(function(e){return a(e)})+"]");else if(e.hasOwnProperty(r)){var d=e[r];"string"===i&&(d=o[r]?l(d):d),t.push(n(r)+":"+d)}}return"{\n"+t.join(",\n")+"}"}var r=avalon.oneObject("break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile");avalon.keyMap=r;var o={nodeName:1,template:1,forExpr:1,type:1,nodeValue:1,signature:1,wid:1},i=/[W-]/,l=avalon.quote;e.exports=a},function(e,t,n){function a(e,t){var n=e.replace(y,"").match(g);n&&n.filter(function(e){/^[@\d\-]/.test(e)||"##"===e.slice(0,2)||"$event"===e||avalon.keyMap[e]||(t[e]=1)})}function r(e){var t=[];for(var n in e)t.push("var "+n+" = __local__["+avalon.quote(n)+"]");return t}function o(e,t){function n(e){var t="??"+b++;return x[t]=e,t}function o(e){return x[e]}var y={};if(t=t||"other","object"==typeof e&&(t=e.type,y=e,e=y.expr),"string"!=typeof e)return"";var g=e,_=l.get(t+":"+g);if(_)return _;var b=1,x={},w=e.replace(s,n).replace(c,n).replace(v,n).replace(p,"$1").split(f),$=w.shift(),A={},C=$.replace(u,o).trim();if("on"===t&&h.test(C)&&(C+="($event)"),C=C.replace(m,"$1__vmodel__."),"js"===t)return l.put(t+":"+g,C);"on"===t&&a($,A);var E=w.map(function(e){a(e.replace(/^\w+/g,""),A),e=e.replace(u,o).replace(m,"$1__vmodel__.");var t=!1;return e=e.replace(d,function(e,n){return t=!0,/\S/.test(n)?"(__value__,"+n+");":"(__value__);"}),t||(e+="(__value__);"),e=e.replace(/(\w+)/,'avalon.__format__("$1")'),"__value__ = "+e}),k=[];if("on"===t)E=E.map(function(e){return e.replace(/__value__/g,"$event")}),E.length&&E.push("if($event.$return){\n	return;\n}"),avalon.modern||(C=C.replace(/__vmodel__\.([^(]+)\(([^)]*)\)/,function(e,t,n){return"__vmodel__."+t+".call(__vmodel__"+(/\S/.test(n)?","+n:"")+")"})),k=["function ($event, __local__){","try{",r(A).join("\n"),"	var __vmodel__ = this;","	"+C,"}catch(e){",i(e,t),"}","}"],E.unshift(2,0);else{if("duplex"===t){var T=["function (__vmodel__,__value__){","try{","	"+C+" = __value__","}catch(e){",i(e,t).replace("parse","set"),"}","}"];l.put("duplex:set:"+g,T.join("\n"));var O=["function (__vmodel__){","try{","var __value__ = "+C+"\n",E.join("\n"),"return __value__\n","}catch(e){",i(e,t).replace("parse","get"),"}","}"].join("\n");return l.put("duplex:get:"+g,O),O}k=["(function(){","try{","var __value__ = "+C,"text"===t?"return avalon.parsers.string(__value__)":"return __value__","}catch(e){",i(e,t),'	return ""',"}","})()"],E.unshift(3,0)}return k.splice.apply(k,E),_=k.join("\n"),l.put(t+":"+g,_),_}function i(e,t){return"	avalon.warn(e, "+avalon.quote("parse "+t+" binding【 "+e+" 】fail")+")"}var l=n(41),s=/(^|[^\/])\/(?!\/)(\[.+?]|\\.|[^\/\\\r\n])+\/[gimyu]{0,5}(?=\s*($|[\r\n,.;})]))/g,c=/(["'])(\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/g,u=/\?\?\d+/g,d=/\(([^)]*)\)/,v=/\|\|/g,f=/\|(?=\w)/,p=/\s*(\.|\|)\s*/g,m=/(^|[^\w\u00c0-\uFFFF_])(@|##)(?=[$\w])/g,h=/^(?:\@|##)[$\w\.]+$/i,y=/\|.+/g,g=/((?:\@|\$|\#\#)?\w+)/g;e.exports=avalon.parseExpr=o},function(e,t,n){var a=n(29);e.exports=new a(888)},function(e,t,n){n(43),n(45),n(46),n(47),n(48),n(49),n(50),n(51),n(53),n(54),n(55),n(62),n(63),n(64),n(65),n(66),n(69)},function(e,t,n){var a=n(44);avalon.directive("important",{priority:1,parse:function(e,t,n){var a=avalon.quote(n.expr);e.local="{}",e[n.name]=1,e.vmodel="(function(){ return __vmodel__ = avalon.vmodels["+a+"]})()",t.$prepend=["(function(__vmodel__){","var important = avalon.scopes["+a+"]",'if(important){avalon.log("不进入"+'+a+");return }"].join("\n")+"\n",t.$append="\n})();"},diff:function(e,t,n){t.dynamic[n]||(t.local=e.local,t.vmodel=e.vmodel,a(t,this.update))},update:function(e,t,n){avalon.directives.controller.update(e,t,n,"important")}})},function(e,t){e.exports=function(e,t,n){if(n)e.afterChange=e.afterChange||[],avalon.Array.ensure(e.afterChange,t);else{var a=e.dom;t(e.dom,e,a&&a.parentNode)}}},function(e,t,n){var a=n(44),r={};avalon.mediatorFactoryCache=function(e,t){var n=e.$hashcode,a=t.$hashcode,o=n+a;if(r[o])return r[o];var i=avalon.mediatorFactory(e,t);return r[o]=i},avalon.directive("controller",{priority:2,parse:function(e,t,n){var a=avalon.quote(n.expr);e.local="__local__",e[n.name]=1,e.vmodel=["(function(){","var vm = avalon.vmodels["+a+"]","if(vm && __vmodel__&& vm !== __vmodel__){","return __vmodel__ = avalon.mediatorFactoryCache(__vmodel__, vm)","}else if(vm){","return __vmodel__ = vm","}","})()"].join("\n"),t.$prepend="(function(__vmodel__){",t.$append="\n})(__vmodel__);"},diff:function(e,t,n){t.dynamic[n]||(t.local=e.local,t.vmodel=e.vmodel,a(t,this.update))},update:function(e,t,n,r){var o=t.vmodel,i=t.local,l=r?"ms-important":"ms-controller";t.dynamic[l]=1;var s=t.props[l],c=avalon.scopes[s];if(!c){delete t.vmodel,delete t.local;var u=avalon.vmodels[s];if(o.$element&&o.$element.vtree[0]===t)var d=o.$render;else d=avalon.render([t],i);o.$render=d,o.$element=e,e.vtree=[t],u!==o&&(u.$render=u.$render||d,u.$element=u.$element||e);var v=r?o:u,c=avalon.scopes[s]={vmodel:o,local:i};a(t,function(){var e=v.$events.onReady;e&&(v.$fire("onReady"),delete v.$events.onReady),c.isMount=!0},"afterChange")}}})},function(e,t,n){var a=n(23),r=n(44);avalon.directive("attr",{diff:function(e,t,n){var a=e[n],o=t[n];if(a&&"object"==typeof a){if(a=a.$model||a,Array.isArray(a)&&(a=avalon.mix.apply({},a)),t.dynamic[n]&&o){var i={},l=!1;for(var s in a)a[s]!==o[s]&&(l=!0,i[s]=a[s]);l&&(t[n]=a,t.changeAttr=i)}else t.changeAttr=t[n]=a;t.changeAttr&&r(t,this.update)}e!==t&&delete e[n]},update:a})},function(e,t,n){var a=n(44);avalon.directive("css",{diff:function(e,t,n){var r=e[n],o=t[n];if(Object(r)===r){if(r=r.$model||r,Array.isArray(r)&&(r=avalon.mix.apply({},r)),t.dynamic[n]&&o){var i={},l=!1;for(var s in r)r[s]!==o[s]&&(l=!0,i[s]=r[s]);l&&(t[n]=r,t.changeStyle=i)}else t.changeStyle=t[n]=r;t.changeStyle&&a(t,this.update)}delete e[n]},update:function(e,t){var n=t.changeStyle,a=avalon(e);t.dynamic["ms-css"]=1;for(var r in n)a.css(r,n[r]);delete t.changeStyle}})},function(e,t,n){function a(e,t){var n=e.ownerDocument,r=e.nodeName,i="_"+r;if(!a[i]){var l=n.body.appendChild(n.createElement(r));t=avalon.modern?getComputedStyle(l,null).display:l.currentStyle.display,n.body.removeChild(l),t===o&&(t="block"),a[i]=t}return a[i]}var r=n(44),o="none";avalon.parseDisplay=a,avalon.directive("visible",{diff:function(e,t,n){var a=!!e[n];t.dynamic[n]&&a===t[n]||(t[n]=a,r(t,this.update))},update:function(e,t){function n(){void 0!==r&&(e.style.display=r)}if(e&&1===e.nodeType){t.dynamic["ms-visible"]=1;var r,i=t["ms-visible"],l=e.style.display;i?(l===o&&(r=t.displayValue,r||(e.style.display="")),""===e.style.display&&avalon(e).css("display")===o&&avalon.contains(e.ownerDocument,e)&&(r=a(e))):l!==o&&(r=o,t.displayValue=l),avalon.applyEffect(e,t,{hook:i?"onEnterDone":"onLeaveDone",cb:n})}}})},function(e,t,n){n(44);avalon.directive("expr",{parse:avalon.noop})},function(e,t,n){var a=n(44);avalon.directive("text",{parse:function(e,t,n){e[n.name]=1,t.children=[],e.children='[{\nnodeName:"#text",\ndynamic:true,\nnodeValue:avalon.parsers.string('+avalon.parseExpr(n)+")}]"},diff:function(e,t){t.children.length||a(t,this.update)},update:function(e,t){if(e&&!t.isVoidTag){for(var n=e;n.firstChild;)n.removeChild(n.firstChild);var e=document.createTextNode("x");n.appendChild(e);var a={nodeType:3,nodeName:"#text",dom:e};t.children.push(a)}}})},function(e,t,n){var a=n(44);n(52);avalon.directive("html",{parse:function(e,t,n){t.isVoidTag?e.children="[]":(e[n.name]=avalon.parseExpr(n),e.vmodel="__vmodel__",e.local="__local__")},diff:function(e,t,n){var r=e[n]+"";if(t.dynamic["ms-html"]&&t.render&&r===t[n]){if(t.render){var o=t.render(e.vmodel,e.local);e.children=o}}else{t[n]=r;var i=avalon.speedUp(avalon.lexer(r)),l=avalon.render(i,e.local);t.render=l;var o=l(e.vmodel,e.local);t.children=e.children=o,a(t,this.update)}},update:function(e,t,n){t.dynamic["ms-html"]=1,avalon.clearHTML(e),e.appendChild(avalon.domize(t.children))}})},function(e,t){function n(e,t,o){t=r(t);var i={},s=t.length;if(0!==s){t.forEach(function(e,t){i[t]=a(e)});for(var c,u=[],d=!1,v=0,f=0;;){if(c=e[v++],f++>5e3)break;var p,m=c&&a(c),h=u.length;if(i[h]===m){if(p&&1===c.nodeType&&(c.getAttribute(":for")||c.getAttribute("ms-for"))){p=!1;continue}u.push(c);var y=t[h];if(y.dynamic&&(y.dom=c),1===c.nodeType&&!y.isVoidTag&&!l[y.nodeName]){if("select-one"===c.type)var g=c.selectedIndex;n(c.childNodes,y.children,c),"select-one"===c.type&&(c.selectedIndex=g)}}else if(d=!0,"8true"===i[h]){var _=t[h],b=document.createComment(_.nodeValue);_.dom=b,u.push(b),_.forExpr&&(p=!0),v=Math.max(0,--v)}if(u.length===s)break}if(d){for(var x=document.createDocumentFragment(),v=0;c=u[v++];)x.appendChild(c);for(;o.firstChild;)o.removeChild(o.firstChild);o.appendChild(x)}}}function a(e){switch(e.nodeType){case 3:return"3"+i.test(e.nodeValue);case 1:return"1"+e.nodeName.toLowerCase();case 8:return"8"+o.test(e.nodeValue)}}function r(e){for(var t,n=[],a=0;t=e[a];a++)Array.isArray(t)?n=n.concat(r(t)):n.push(t);return n}var o=/^ms\-for/,i=/[\S\xA0]/,l=avalon.oneObject("script,style,xmp,template,noscript,textarea");e.exports=n},function(e,t,n){function a(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t],r=typeof n;if("string"===r||"number"===r||n===!0)e.push(n);else if(Array.isArray(n))e.push(a.apply(null,n));else if("object"===r)for(var o in n)n.hasOwnProperty(o)&&n[o]&&e.push(o)}return e.join(" ")}function r(e){var t=e.target;avalon(t).addClass(t.getAttribute(u[e.type])||"")}function o(e){var t=e.target,n=u[e.type];avalon(t).removeClass(t.getAttribute(n)||""),"change-active"!==n&&avalon(t).removeClass(t.getAttribute("change-active")||"")}function i(e,t){var n=e.getAttribute("old-change-class"),a=t["ms-class"];n!==a&&(avalon(e).removeClass(n).addClass(a),e.setAttribute("old-change-class",a))}var l=n(6).getLongID,s=n(44),c=avalon.directives;avalon.directive("class",{diff:function(e,t,n){var i=n.slice(3),l=e[n],c=t[n]||"",u=t.classEvent||{};"hover"===i?(u.mouseenter=r,u.mouseleave=o):"active"===i&&(t.props.tabindex=e.props.tabindex||-1,u.tabIndex=t.props.tabindex,u.mousedown=r,u.mouseup=o,u.mouseleave=o),t.classEvent=u;var d=a(l);t.dynamic[n]&&c===d||(t[n]=d,t["change-"+i]=d,s(t,this.update,i))},update:function(e,t){if(e&&1===e.nodeType){var n=t.classEvent;if(n){for(var a in n)"tabIndex"===a?e[a]=n[a]:avalon.bind(e,a,n[a]);t.classEvent={}}var r=["class","hover","active"];r.forEach(function(n){var a="change-"+n,r=t[a];if(void 0!==r)if(t.dynamic["ms-"+n]=1,"class"===n)e&&i(e,t);else{var o=e.getAttribute("change-"+n);o&&avalon(e).removeClass(o),e.setAttribute(a,r)}})}}}),c.active=c.hover=c["class"];var u={mouseenter:"change-hover",mouseleave:"change-hover",mousedown:"change-active",mouseup:"change-active"};l(r),l(o)},function(e,t,n){function a(e,t){for(var n in e)if(e[n]!==t[n])return!0;return!1}var r=n(29),o=(new r(128),n(44)),i=(n(6).getLongID,/^ms\-on\-(\w+)/);avalon.directive("on",{priority:3e3,parse:function(e,t,n){var a=n.name.replace("ms-on-","e").replace("-","_"),r=a+"_"+n.expr.replace(/\s/g,"").replace(/[^$a-z]/gi,function(e){return e.charCodeAt(0)}),o=avalon.quote(r),i="(function(){\nvar fn610 = "+avalon.parseExpr(n,"on")+"\nfn610.uuid ="+o+";\nreturn fn610})()";e.vmodel="__vmodel__",e.local="__local__",e[n.name]=i},diff:function(e,t,n){var r=e[n],i=r.uuid,l=t[n]||{},s=!1;t.dynamic[n]&&l.uuid===i||(t[n]=r,avalon.eventListeners.uuid=r,s=!0),a(t.local||{},e.local)&&(s=!0),s&&(t.local=e.local,t.vmodel=e.vmodel,o(t,this.update))},update:function(e,t){if(e&&!(e.nodeType>1)){var n,a;e._ms_context_=t.vmodel,e._ms_local=t.local;for(n in t){var r=n.match(i);r&&(a=t[n],t.dynamic[n]=1,avalon.bind(e,r[1],a))}}}})},function(e,t,n){function a(e){for(var t,n=0;t=this.parsers[n++];){var a=avalon.parsers[t];a&&(e=a.call(this,e))}return e}var r=n(44),o=n(41),i=n(39),l=/\|\s*change\b/,s=/^(?:checkbox|radio)$/,c=/\|\s*debounce(?:\(([^)]+)\))?/,u=n(56),d=n(59),v=n(57),f=n(60),p=n(61),m="ms-duplex";avalon.directive("duplex",{priority:2e3,parse:function(e,t,n){var a,r=n.expr,u=t.props.type,d=n.param,v=!1;d=d?d.split("-").map(function(e){return"checked"===e&&(v=!0),e}):[],s.test(u)&&v&&(d=[],a="radio"),/input|textarea|select/.test(t.nodeName)?a||(a="select"===t.nodeName?"select":"checkbox"===u?"checkbox":"radio"===u?"radio":"input"):"contenteditable"in t.props&&(a="contenteditable");var f=!1,p=0;if("input"===a||"contenteditable"===a){var h=!0;if(l.test(r)&&(f=!0),!f){var y=r.match(c);y&&(p=parseInt(y[1],10)||300)}}var g=e.props["data-duplex-changed"],_=avalon.parseExpr(n,"duplex"),b=d.map(function(e){return avalon.quote(e)});e[m]=i({type:a,vmodel:"__vmodel__",local:"__local__",debug:avalon.quote(n.name+"="+n.expr),isChecked:v,parsers:"["+b+"]",isString:!!h,isChanged:f,debounceTime:p,get:_,set:o.get("duplex:set:"+r),callback:g?avalon.parseExpr(g,"on"):"avalon.noop"})},diff:function(e,t){if(t.dynamic[m])n=t[m];else{var n=t[m]=e[m];n.parse=a}e!==t&&(e[m]=null);var o=n.get(n.vmodel),i=n.value;if(n.isString){if(o=n.parse(o),o+="",o===i)return}else if(Array.isArray(o)){var l=!0;if(o+""===n.arrayHack)return}n.value=o,l&&(n.arayHack=o+""),r(t,this.update,"afterChange")},update:function(e,t){if(e&&1===e.nodeType){t.dynamic[m]=1,e.__ms_duplex__||(e.__ms_duplex__=avalon.mix(t[m],{dom:e}),u(e,t),p(e,t));var n=e.__ms_duplex__;if(n.dom=e,n.isString&&!avalon.msie&&d===!1&&!e.valueHijack){e.valueHijack=v;var a=setInterval(function(){avalon.contains(avalon.root,e)?e.valueHijack({type:"poll"}):clearInterval(a)},30)}f[n.type].call(n)}}})},function(e,t,n){function a(e,t){var n={},a=t["ms-duplex"];switch(a.update=d,a.type){case"radio":case"checkbox":n.click=d;break;case"select":n.change=d;break;case"contenteditable":a.isChanged?n.blur=d:avalon.modern?(p.webkitURL?n.webkitEditableContentChanged=d:p.MutationEvent&&(n.DOMCharacterDataModified=d),n.input=d):(n.keydown=u,n.paste=o,n.cut=o,n.focus=c,n.blur=s);break;case"input":a.isChanged?n.change=d:(f&&(n.keyup=u),9>f?(n.propertychange=r,n.paste=o,n.cut=o):n.input=d,(!f||f>9)&&(n.compositionstart=s,n.compositionend=c),f||/\[native code\]/.test(p.Int8Array)||(n.keydown=u,n.paste=o,n.cut=o,p.netscape&&(n.DOMAutoComplete=d)))}/password|text/.test(t.props.type)&&(n.focus=i,n.blur=l,a.getCaret=g,a.setCaret=y);for(var v in n)avalon.bind(e,v,n[v])}function r(e){"value"===e.propertyName&&d.call(this,e)}function o(e){var t=this;setTimeout(function(){d.call(t,e)},0)}function i(){this.caret=!0}function l(){this.caret=!1}function s(){this.composing=!0}function c(e){this.composing=!1,o.call(this,e)}function u(e){var t=e.keyCode;91===t||t>15&&19>t||t>=37&&40>=t||d.call(this,e)}var d=n(57),v=n(6).getShortID,f=avalon.msie,p=avalon.window,m=avalon.document;v(i),v(l),v(s),v(c),v(d),v(r),v(o),v(u);var h=function(e){setTimeout(e,0)},y=function(e,t){var n;e.createTextRange?h(function(){e.focus(),n=e.createTextRange(),n.collapse(!0),n.moveEnd("character",t),n.moveStart("character",t),n.select()}):(e.focus(),void 0!==e.selectionStart&&e.setSelectionRange(t,t))},g=function(e){var t,n,a,r,o,i=0;return"number"==typeof e.selectionStart&&"number"==typeof e.selectionEnd?i=e.selectionStart:(n=m.selection.createRange(),n&&n.parentElement()==e&&(r=e.value.length,t=e.value.replace(/\r\n/g,"\n"),a=e.createTextRange(),a.moveToBookmark(n.getBookmark()),o=e.createTextRange(),o.collapse(!1),a.compareEndPoints("StartToEnd",o)>-1?i=r:(i=-a.moveStart("character",-r),i+=t.slice(0,i).split("\n").length-1))),i};e.exports=a},function(e,t,n){function a(e){var t=this,n=this.__ms_duplex__;if(!t.composing&&t.value!==n.value){if(t.caret)try{var a=n.getCaret(t);n.pos=a}catch(o){avalon.warn("fixCaret error",o)}if(n.debounceTime>4){var i=new Date,l=i-n.time||0;n.time=i,l>=n.debounceTime?r[n.type].call(n):(clearTimeout(n.debounceID),n.debounceID=setTimeout(function(){r[n.type].call(n)},l))}else r[n.type].call(n)}}var r=n(58);e.exports=a},function(e,t){function n(e){e.callback&&e.callback.call(e.vmodel,{type:"changed",target:e.dom})}var a={input:function(e){var t=this;e=e||"value";var a=t.dom,r=a[e],o=t.parse(r);t.value=r,t.set(t.vmodel,o),n(t);var i=t.pos;a.caret&&t.setCaret(a,i)},radio:function(){var e=this;if(e.isChecked){var t=!e.value;e.set(e.vmodel,t),n(e)}else a.input.call(e),e.value=NaN},checkbox:function(){var e=this,t=e.value;Array.isArray(t)||(avalon.warn("ms-duplex应用于checkbox上要对应一个数组"),t=[t]);var a=e.dom.checked?"ensure":"remove";if(t[a]){var r=e.parse(e.dom.value);t[a](r),n(e)}},select:function(){var e=this,t=avalon(e.dom).val();t+""!=this.value+""&&(t=Array.isArray(t)?t.map(function(t){return e.parse(t)}):e.parse(t),e.set(e.vmodel,t),n(e))},contenteditable:function(){a.input.call(this,"innerHTML")}};e.exports=a},function(e,t){function n(e){r[this.tagName].call(this,e);var t=this.__ms_duplex__;!this.caret&&t&&t.isString&&t.update.call(this,{type:"setter"})}var a=!1;try{var r={},o=HTMLInputElement.prototype,i=HTMLTextAreaElement.prototype,l=HTMLInputElement.prototype;Object.getOwnPropertyNames(l),r.INPUT=Object.getOwnPropertyDescriptor(o,"value").set,Object.defineProperty(o,"value",{set:n}),r.TEXTAREA=Object.getOwnPropertyDescriptor(i,"value").set,Object.defineProperty(i,"value",{set:n}),a=!0}catch(s){}e.exports=a},function(e,t){var n={input:function(){this.dom.value=this.value},radio:function(){var e;e=this.isChecked?!!this.value:this.value+""===this.dom.value;var t=this.dom;6===avalon.msie?setTimeout(function(){t.defaultChecked=e,t.checked=e},31):t.checked=e},checkbox:function(){for(var e=!1,t=this.dom,n=t.value,a=0;a<this.value.length;a++){var r=this.value[a];r+""===n&&(e=!0)}t.checked=e},select:function(){var e=Array.isArray(this.value)?this.value.map(String):this.value+"";avalon(this.dom).val(e)},contenteditable:function(){this.dom.innerHTML=this.value,this.update.call(this.dom)}};e.exports=n},function(e,t){e.exports=function(e,t){var n=e.__ms_duplex__,a=t["ms-rules"];if(a&&!n.validator)for(;e&&1===e.nodeType;){var r=e._ms_validator_;if(r){n.rules=a,n.validator=r,avalon.Array.ensure(r.fields,n)&&r.addField(n);break}e=e.parentNode}}},function(e,t,n){function a(){var e=this.data||{};return this.message.replace(i,function(t,n){return null==e[n]?"":e[n]})}var r=n(44),o=avalon.directive("validate",{diff:function(e,t,n){var a=e[n],i=t[n];if(!(i&&i.onError&&i.addField)&&Object(a)===a){t.vmValidator=a,a.$id&&(a=a.$model),t[n]=a;for(var n in o.defaults)a.hasOwnProperty(n)||(a[n]=o.defaults[n]);a.fields=a.fields||[],r(t,this.update)}},update:function(e,t){function n(){o.validateAll.call(a,a.onValidateAll)}var a=t["ms-validate"];e._ms_validator_=a,a.dom=e;var r=t.vmValidator;try{r.onManual=n}catch(i){}delete t.vmValidator,e.setAttribute("novalidate","novalidate"),a.validateAllInSubmit&&avalon.bind(e,"submit",function(e){e.preventDefault(),n()}),"function"==typeof a.onInit&&a.onInit.call(e,{type:"init",target:e,validator:a})},validateAll:function(e){var t=this,n="function"==typeof e?e:t.onValidateAll,a=t.fields.filter(function(e){var n=e.dom;return n&&!n.disabled&&t.dom.contains(n)}).map(function(e){return o.validate(e,!0)}),r=[];Promise.all(a).then(function(e){for(var a,o=0;a=e[o++];)r=r.concat(a);if(t.deduplicateInValidateAll){var i={};r=r.filter(function(e){var t=e.dom,n=t.uniqueID||(t.uniqueID=setTimeout("1"));return i[n]?!1:(i[n]=!0,!0)})}n.call(t.dom,r)})},addField:function(e){var t=this,n=e.dom;!t.validateInKeyup||e.isChanged||e.debounceTime||avalon.bind(n,"keyup",function(t){o.validate(e,0,t)}),t.validateInBlur&&avalon.bind(n,"blur",function(t){o.validate(e,0,t)}),t.resetInFocus&&avalon.bind(n,"focus",function(a){t.onReset.call(n,a,e)})},validate:function(e,t,n){var r=[],o=e.value,i=e.dom,l=e.validator;if(!i.disabled){for(var s in e.rules){var c=e.rules[s];if(c!==!1){var u,d,v=avalon.validators[s];r.push(new Promise(function(e,t){u=e,d=t}));var f=function(t){if(e.norequired&&""===o&&(t=!0),t)u(!0);else{var n={element:i,data:e.data,message:i.getAttribute("data-"+s+"-message")||i.getAttribute("data-message")||v.message,validateRule:s,getMessage:a};u(n)}};e.data={},e.data[s]=c,v.get(o,e,f)}}var p=[],m=Promise.all(r).then(function(e){for(var a,r=0;a=e[r++];)"object"==typeof a&&p.push(a);return t||(p.length?l.onError.call(i,p,n):l.onSuccess.call(i,p,n),l.onComplete.call(i,p,n)),p});return m}}}),i=/\\?{{([^{}]+)\}}/gm;o.defaults={addField:o.addField,onError:avalon.noop,onSuccess:avalon.noop,onComplete:avalon.noop,onManual:avalon.noop,onReset:avalon.noop,onValidateAll:avalon.noop,validateInBlur:!0,validateInKeyup:!0,validateAllInSubmit:!0,resetInFocus:!0,deduplicateInValidateAll:!1}},function(e,t){function n(e){return"regexp"===avalon.type(e)}function a(e){if("string"==typeof e&&e){var t=e.split("-");if(3===t.length&&4===t[0].length){
var n=~~t[0],a=~~t[1]-1,r=~~t[2],o=new Date(n,a,r);return o.getFullYear()===n&&o.getMonth()===a&&o.getDate()===r}}return!1}avalon.directive("rules",{diff:function(e,t,n){var a=e[n];if(a&&"[object Object]"===Object.prototype.toString.call(a)){t[n]=a.$model||a;var r=t.dom&&t.dom.__ms_duplex__;r&&(r.rules=e[n])}}});var r=/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/i,o=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/;avalon.shadowCopy(avalon.validators,{pattern:{message:"必须匹配{{pattern}}这样的格式",get:function(e,t,a){var r=t.element,o=t.data;if(!n(o.pattern)){var i=r.getAttribute("pattern");o.pattern=new RegExp("^(?:"+i+")$")}return a(o.pattern.test(e)),e}},digits:{message:"必须整数",get:function(e,t,n){return n(/^\-?\d+$/.test(e)),e}},number:{message:"必须数字",get:function(e,t,n){return n(isFinite(e)),e}},required:{message:"必须填写",get:function(e,t,n){return n(""!==e),e}},equalto:{message:"密码输入不一致",get:function(e,t,n){var a=String(t.data.equalto),r=avalon(document.getElementById(a)).val()||"";return n(e===r),e}},date:{message:"日期格式不正确",get:function(e,t,n){var r=t.data;return n("regexp"===avalon.type(r.date)?r.date.test(e):a(e)),e}},url:{message:"URL格式不正确",get:function(e,t,n){return n(o.test(e)),e}},email:{message:"email格式不正确",get:function(e,t,n){return n(r.test(e)),e}},minlength:{message:"最少输入{{minlength}}个字",get:function(e,t,n){var a=parseInt(t.data.minlength,10);return n(e.length>=a),e}},maxlength:{message:"最多输入{{maxlength}}个字",get:function(e,t,n){var a=parseInt(t.data.maxlength,10);return n(e.length<=a),e}},min:{message:"输入值不能小于{{min}}",get:function(e,t,n){var a=parseInt(t.data.min,10);return n(parseFloat(e)>=a),e}},max:{message:"输入值不能大于{{max}}",get:function(e,t,n){var a=parseInt(t.data.max,10);return n(parseFloat(e)<=a),e}},chs:{message:"必须是中文字符",get:function(e,t,n){return n(/^[\u4e00-\u9fa5]+$/.test(e)),e}}})},function(e,t,n){var a=n(44);avalon.directive("if",{priority:6,diff:function(e,t,n,r,o,i){var l=!!e[n];t[n]=l,a(t,this.update)},update:function(e,t,n){var a=t["ms-if"];if(t.dynamic["ms-if"]&&(t.dynamic["ms-if"]=t.nodeName),a){if("#comment"===t.nodeName){t.nodeName=t.dynamic["ms-if"],delete t.nodeValue;var r=t.comment;if(!r)return;n=r.parentNode,n&&n.replaceChild(e,r),avalon.applyEffect(e,t,{hook:"onEnterDone"})}}else t.comment||(t.comment=document.createComment("if")),t.nodeName="#comment",t.nodeValue="if",avalon.applyEffect(e,t,{hook:"onLeaveDone",cb:function(){n=n||e.parentNode,n&&n.replaceChild(t.comment,e)}})}})},function(e,t,n){function a(e){var t=typeof e;return e&&"object"===t?e.$hashcode:t+":"+e}function r(e,t,n,r,o,i,l,s){var c=s?a(t):e,u={};u[o]=e,u[i]=t;for(var d in n)d in u||(u[d]=n[d]);r(e,t,c,u,l)}function o(e,t,n){var a=e.split,r=a.nodeValue,o=[],i=a.previousSibling;for(o.unshift(a);;){if(!i||i===t||i.nodeValue===r)break;var l=i.previousSibling;o.unshift(i),i=l}return n&&o.forEach(function(t){e.dom.appendChild(t)}),o}function i(e){var t;for(var n in e){var t=n;break}return t?l(e,t):void 0}function l(e,t){var n=e[t];if(n){var a=n.arr;if(a){var r=a.pop();return a.length||(n.arr=0),r}return delete e[t],n}}function s(e,t){var n=t.key;if(e[n]){var a=e[n],r=a.arr||(a.arr=[]);r.push(t)}else e[n]=t}var c=n(44),u=/\s+as\s+([$\w]+)/,d=/^[$a-zA-Z_][$a-zA-Z0-9_]*$/,v=/^(null|undefined|NaN|window|this|\$index|\$id)$/,f=/[$\w]+/g;avalon._each=function(e,t,n,a){var o=[];a.push(o);var i=(t+"").slice(0,40).match(f);if(i.shift(),Array.isArray(e))for(var l=0;l<e.length;l++)r(l,e[l],n,t,i[0],i[1],o,!0);else for(var l in e)e.hasOwnProperty(l)&&r(l,e[l],n,t,i[0],i[1],o)},avalon.directive("for",{priority:3,parse:function(e,t,n){var a,r=t.forExpr;r=r.replace(u,function(e,t){return!d.test(t)||v.test(t)?avalon.error("alias "+t+" is invalid --- must be a valid JS identifier which is not a reserved name."):a=t,""});var o=r.split(" in "),i="var loop = "+avalon.parseExpr(o[1])+" \n",l=a?"var "+a+" = loop\n":"",s=o[0].match(f);1===s.length&&s.unshift("$key"),s.push("traceKey","__local__","vnodes"),t.$append=i+l+"avalon._each(loop,function("+s.join(", ")+"){\n"+(a?"__local__["+avalon.quote(a)+"]=loop\n":"")+'vnodes.push({\nnodeName: "#document-fragment",\nindex: arguments[0],\nkey: traceKey,\nchildren: new function(){\n var vnodes = []\n'},diff:function(e,t,n,a,r){if(avalon.callArray){if(t.list&&-1===t.forExpr.indexOf(avalon.callArray))return}else if(t.list)return;var o,u,d,v=a[r+1],f=n[r+1],p=a[r+2],m=t.cache||{},h=[];if(v.length){if(v===f)return f.forEach(function(e){s(m,e)}),void(t.cache=m);t.action="update";var y={},g=[];for(o=0;u=f[o];o++){var d=l(m,u.key);d?(d.oldIndex=d.index,d.index=u.index,s(y,d)):g.push(u)}for(var u,o=0;u=g[o];o++)d=i(m,u.key),d?(d.oldIndex=d.index,d.index=u.index,d.key=u.key):(d=u,v.push(d)),s(y,d);v.sort(function(e,t){return e.index-t.index}),t.cache=y;for(var o in m)d=m[o],d.action="leave",avalon.Array.remove(v,d),h.push(d),d.arr&&(d.arr.forEach(function(e){e.action="leave",h.push(e)}),delete d.arr)}else t.action="init",a[r+1]=f,f.forEach(function(e,t){v[t]=e,s(m,e)}),t.cache=m;h.length>1&&h.sort(function(e,t){return e.index-t.index}),t.removes=h;var _=avalon.caches[t.wid],b=e.vmodel;return p&&_&&(p.afterChange=[function(e){_.call(b,{type:"rendered",target:e,signature:t.signature})}]),t.list=v,c(t,this.update),!0},update:function(e,t,n){if("init"===t.action){var a=n;n=document.createDocumentFragment()}for(var r,i=e,l=e.signature,s=0;r=t.removes[s++];)if(r.dom)if(r.num=0,t.hasEffect){var c=o(r,e);p(c,r.children,{hook:"onLeaveDone",staggerKey:l+"leave",cb:function(e){++r.num,r.dom.appendChild(e),r.num===r.children.length&&(delete r.dom,delete r.split,r.children.length=0)}})}else o(r,e,"add"),delete r.dom,delete r.split;t.list.forEach(function(a,r){a.dom||(a.dom=avalon.domize(a));var s=a.dom;if(void 0===a.oldIndex){if(0===r&&"init"===t.action?n.appendChild(s):n.insertBefore(s,i.nextSibling),t.hasEffect){var c=avalon.slice(s.childNodes);p(c,a.children,{hook:"onEnterDone",staggerKey:l+"enter"})}}else if(a.index!==a.oldIndex){var c=o(a,e,"add");n.insertBefore(a.dom,i.nextSibling),t.hasEffect&&p(c,a.children,{hook:"onMoveDone",staggerKey:l+"move"})}i=a.split}),"init"===t.action&&a.insertBefore(n,e.nextSibling)}}),avalon.domize=function(e){return avalon.vdomAdaptor(e,"toDOM")};var p=function(e,t,n){t.forEach(function(a,r){avalon.applyEffect(e[r],t[r],n)})}},function(e,t,n){function a(e,t){var n=t.props.is,a=t["component-vm:"+n],r="component-html:"+n,o=t[r],i=avalon.vdomAdaptor(t,"toHTML");o!==i&&(t[r]=i,a.$fire("onViewChange",{type:"viewchange",target:e,vmodel:a,is:n}))}function r(e){var t=!0;try{o(e)}catch(n){t=!1}return t}function o(e){e.children.forEach(function(e){if("#comment"===e.nodeName){if("unresolved component placeholder"===e.nodeValue)throw"unresolved"}else e.children&&o(e)})}var i=n(44),l=n(67);avalon.component=function(e,t){avalon.components[e]||(avalon.components[e]=t)},avalon.directive("widget",{priority:4,parse:function(e,t,n){t.props.wid=t.props.wid||avalon.makeHashCode("w"),e[n.name]=avalon.parseExpr(n),e.template=t.template,e.vmodel="__vmodel__",e.local="__local__"},define:function(){return avalon.mediatorFactory.apply(this,arguments)},diff:function(e,t,n,a,o,s){var c=e[n];if(Object(c)===c){var u=t.props.is||(/^ms\-/.test(t.nodeName)?t.nodeName:0);u||(c=c.$model||c,Array.isArray(c)&&(c.unshift({}),avalon.mix.apply(0,c),c=c.shift()),u=c.is);var d="component-vm:"+u;if(t.props.is=u,t.vmodel=e.vmodel,!t[d]&&!l(t,e[n],e.local,e.template))return t.nodeValue="unresolved component placeholder",a[s]=t,void i(t,this.mountComment);var v=t[d],f=avalon.scopes[v.$id];if(f&&f.vmodel){var p=f.vmodel.$element;if(t.dom!==p){var m=p.vtree[0];return o[s]=a[s]=m,t.com=p,m.skipContent||(m.skipContent="optimize"),i(t,this.replaceCachedComponent),void i(m,function(){"optimize"===m.skipContent&&(m.skipContent=!0)},"afterChange")}}var h=v.$render,y=h(v,e.local),m=y[0];m&&r(m)?(m.local=e.local,Array(d,"component-html:"+u,"component-ready:"+u,"dom","dynamic").forEach(function(e){m[e]=t[e]}),m.vmodel=v,a[s]=m,t.comment&&t.nodeValue&&(m.dom=t.comment),t.nodeName!==m.nodeName?(o[s]=m,i(m,this.mountComponent)):i(t,this.updateComponent)):(t.nodeValue="unresolved component placeholder",a[s]={nodeValue:"unresolved component placeholder",nodeName:"#comment"},i(t,this.mountComment))}else t.props.is===e.props.is&&i(t,this.updateComponent)},replaceCachedComponent:function(e,t,n){var a=t.com;n.replaceChild(a,e),t.dom=a,delete t.com},mountComment:function(e,t,n){var a=document.createComment(t.nodeValue);t.dom=a,n.replaceChild(a,e)},updateComponent:function(e,t){var n=t["component-vm:"+t.props.is],r=n.$events.onViewChange;r&&r.length&&i(t,a,"afterChange")},mountComponent:function(e,t,n){delete t.dom;var a=avalon.vdomAdaptor(t,"toDOM"),r=t.props.is,o=t["component-vm:"+r];o.$fire("onInit",{type:"init",vmodel:o,is:r}),n.replaceChild(a,e),t.dom=o.$element=a,a.vtree=[t],avalon.onComponentDispose(a),t["component-ready:"+r]=!0,avalon.scopes[o.$id]={vmodel:o,top:t.vmodel,local:t.local},i(t,function(){o.$fire("onReady",{type:"ready",target:a,vmodel:o,is:r})},"afterChange"),i(t,function(){t["component-html:"+r]=avalon.vdomAdaptor(t,"toHTML")},"afterChange")}})},function(e,t,n){function a(e,t,n,a){function d(e,t){$.forEach(function(n){delete e[n],delete t[n]})}var m=e.nodeName,h=e.props.is;if(!u[m]&&!l(m))return void avalon.warn(m+"不合适做组件的标签");var y={};if(t){var g=[].concat(t);g.forEach(function(e){e&&"object"==typeof e&&s(y,e.$model||e,!0)})}else g=[];var _=avalon.components[h];if(_){!y.$id&&p&&(avalon.warn("warning!",h,"组件最好在ms-widget配置对象中指定全局不重复的$id以提高性能!\n","若在ms-for循环中可以利用 ($index,el) in @array 中的$index拼写你的$id\n","如 ms-widget=\"{is:'ms-button',$id:'btn'+$index}\""),p=!1);var b=y.define;b=b||avalon.directives.widget.define;var x=y.$id||e.props.wid||"w"+(new Date-0),w=avalon.mix(!0,{},_.defaults);s(y,w,!1);var $=f.concat();d.isWidget=!0;var A=b.apply(d,[e.vmodel,w].concat(g));if(!avalon.modern)for(var C in A)c[C]||"function"!=typeof A[C]||(A[C]=A[C].bind(A));A.$id=x,avalon.vmodels[x]=A;for(var E in v)y[E]&&y[E].forEach(function(e){A.$watch(E,e)});var k=avalon.lexer(a),T=k[0];T.children=T.children||[],T.props.is=h,T.props.wid=x,avalon.speedUp(k);var O=avalon.render(k,n),N=_.template.trim();"function"==typeof _.getTemplate&&(N=_.getTemplate(A,N));var M=avalon.lexer(N);M.length>1&&avalon.error("组件必须用一个元素包起来");var S=_.soleSlot;i(M,S),avalon.speedUp(M);var j=avalon.render(M),D=o+"",L=S?avalon.quote(S):"null";D=D.replace("XXXXX",r(O)).replace("YYYYY",r(j)).replace("ZZZZZ",L);var V=D.indexOf("{")+1,H=D.lastIndexOf("}"),F=Function("vm","local",D.slice(V,H));return A.$render=F,e["component-vm:"+h]=A,A.$render=F}}function r(e){return e.toString().replace("anonymous","").replace(/\s*\/\*\*\//g,"")}function o(){var e=XXXXX(vm,local),t=e[0],n=YYYYY(vm,local),a=n[0];for(var r in t)"children"!==r&&"nodeName"!==r&&("props"===r?avalon.mix(a.props,t.props):a[r]=t[r]);var o=ZZZZZ,i=avalon.collectSlots(t,o);return!o||i[o]&&i[o].length||(i[o]=[{nodeName:"#text",nodeValue:vm[o],dynamic:!0}]),avalon.insertSlots(n,i),delete a.skipAttrs,delete a.skipContent,n}function i(e,t){for(var n,a=0;n=e[a];a++)if("slot"===n.nodeName){var r=n.props.name||t;e.splice(a,1,{nodeName:"#comment",nodeValue:"slot:"+r,dynamic:!0,type:r},{nodeName:"#comment",nodeValue:"slot-end:"}),a++}else n.children&&i(n.children,t)}function l(e){return m.test(e)||avalon.components[e]}function s(e,t,n){for(var a in t){var r=t[a];v[a]?a in e?e[a].push(r):e[a]=[t[a]]:n&&(e[a]=r)}}var c=n(68),u={wbr:1,xmp:1,template:1},d="onInit,onReady,onViewChange,onDispose",v=avalon.oneObject(d),f=d.split(",").concat("is","define"),p=!0;e.exports=a,avalon.insertSlots=function(e,t){for(var n,a=0;n=e[a];a++)if("#comment"===n.nodeName&&t[n.type]){var r=[a+1,0].concat(t[n.type]);e.splice.apply(e,r),a+=t[n.type].length}else n.children&&avalon.insertSlots(n.children,t)},avalon.collectSlots=function(e,t){var n={};return t?(n[t]=e.children,n.__sole__=t):e.children.forEach(function(t,a){if(/^\w/.test(t.nodeName)){var r=t.props.slot;r&&(Array.isArray(n[r])?n[r].push(t):n[r]=[t])}else if(t.forExpr&&/slot=['"](\w+)/.test(t.template)){var o=RegExp.$1;n[o]=e.children.slice(a,a+2)}}),n};var m=/^[a-z]([a-z\d]+\-)+[a-z\d]+$/},function(e,t){e.exports=avalon.oneObject("$id,$render,$track,$element,$watch,$fire,$events,$model,$skipArray,$accessors,$hashcode,$run,$wait,__proxy__,__data__,__const__")},function(e,t,n){function a(e,t){for(var n in e)if(e[n]!==t[n])return!0;return!1}function r(){if(!v.lock){var e=v[0];e&&(r.lock=!0,e())}}function o(e){var t=p.test(e)?1e3:1;return parseFloat(e)*t}function i(e,t,n){var a=e[t];a=Array.isArray(a)?a:"function"==typeof a?[a]:[],a.forEach(function(e){e&&e(n)})}function l(e){var t=e.toLowerCase();return function(n){var a,l=this.el,s=avalon(l),u=isFinite(n.stagger)?1e3*n.stagger:0;if(u&&n.staggerKey){var d=m.get(n.staggerKey)||m.put(n.staggerKey,{count:0,items:0});d.count++,d.items++}var f=d&&d.count||0,p=function(t){var o=t!==!1;l.animating=void 0,a=!0;var s=o?"Done":"Abort";i(n,"on"+e+s,l),avalon.unbind(l,c.transitionEndEvent),avalon.unbind(l,c.animationEndEvent),d&&0===--d.items&&(d.count=0),n.queue&&(v.lock=!1,v.shift(),r())};i(n,"onBefore"+e,l),n[t]?n[t](l,function(e){p(e!==!1)}):c.css&&(s.addClass(n[t+"Class"]),"leave"===t?s.removeClass(n.enterClass+" "+n.enterActiveClass):"enter"===t&&s.removeClass(n.leaveClass+" "+n.leaveActiveClass),s.bind(c.transitionEndEvent,p),s.bind(c.animationEndEvent,p),setTimeout(function(){a=NaN===avalon.root.offsetWidth,s.addClass(n[t+"ActiveClass"]);var e=window.getComputedStyle(l),r=e[c.transitionDuration],i=e[c.animationDuration],d=o(r)||o(i);0===!d?p(!1):u||setTimeout(function(){a||p(!1)},d+130)},17+u*f))}}function s(e){e.acton||(e.action=e.hook.replace(/^on/,"").replace(/Done$/,"").toLowerCase())}var c=n(70),u=n(29),d=n(44);avalon.directive("effect",{priority:5,diff:function(e,t,n){var r=e[n];if(r=e.$model||r,"string"==typeof r){var o=r;r={is:o}}else Array.isArray(r)&&(r=avalon.mix.apply({},r));r.action=r.action||"enter",Object(r)===r&&(t.dynamic[n]&&!a(r,t[n]||{})||(t[n]=r,d(t,this.update,"afterChange"))),e!==t&&delete e[n]},update:function(e,t,n,a){if(!e.animating){e.animating=!0;var o=t["ms-effect"],i=o.is;if(a=a||{},!i)return avalon.warn("need is option");t.dynamic["ms-effect"]=1;var l=avalon.effects;c.css&&!l[i]&&avalon.effect(i,{});var s=l[i];if(!s)return avalon.warn(i+" effect is undefined");var u=a.action||o.action,d=avalon.Effect;if("function"!=typeof d.prototype[u])return avalon.warn(u+" action is undefined");var f=new d(e),p=avalon.mix(a,s,o);p.queue?(v.push(function(){f[u](p)}),r()):setTimeout(function(){f[u](p)},4)}}});var v=[];avalon.effects={},avalon.effect=function(e,t){avalon.effects[e]=t||{},c.css&&(t.enterClass||(t.enterClass=e+"-enter"),t.enterActiveClass||(t.enterActiveClass=t.enterClass+"-active"),t.leaveClass||(t.leaveClass=e+"-leave"),t.leaveActiveClass||(t.leaveActiveClass=t.leaveClass+"-active")),t.action||(t.action="enter")};var f=function(e){this.el=e};avalon.Effect=f,f.prototype={enter:l("Enter"),leave:l("Leave"),move:l("Move")};var p=/\d+s$/,m=new u(128);avalon.applyEffect=function(e,t,n){var a=n.cb,r=t["ms-effect"];if(r){var o=n.hook,i=r[o];a&&(Array.isArray(i)?i.push(a):i?r[o]=[i,a]:r[o]=[a]),s(n),e.animate=!0,avalon.directives.effect.update(e,t,0,avalon.shadowCopy({},n))}else a&&a()}},function(e,t){var n,a,r,o=!1,i=!1,l=!1,s=avalon.cssName("transition-duration"),c=avalon.cssName("animation-duration"),u={TransitionEvent:"transitionend",WebKitTransitionEvent:"webkitTransitionEnd",OTransitionEvent:"oTransitionEnd",otransitionEvent:"otransitionEnd"},d=avalon.window;for(var v in u){if(d[v]){r=u[v];break}try{document.createEvent(v);r=u[v];break}catch(f){}}"string"==typeof r&&(o=!0,l=!0,n=r),u={AnimationEvent:"animationend",WebKitAnimationEvent:"webkitAnimationEnd"};var p;for(v in u)if(d[v]){p=u[v];break}"string"==typeof p&&(i=!0,l=!0,a=p),e.exports={transition:o,animation:i,css:l,transitionEndEvent:n,animationEndEvent:a,transitionDuration:s,animationDuration:c}},function(e,t,n){function a(e,t){var n=Array.isArray(e)?r(e):e,a=[];if(t)for(var o in t)a.push("var "+o+" = __local__["+avalon.quote(o)+"]");var i="__local__ = __local__ || {};\n"+a.join(";\n")+"\n"+n;try{var l=Function("__vmodel__","__local__",i)}catch(s){avalon.warn(n,"render parse error")}return l}avalon.lexer=n(72),avalon.diff=n(76),avalon.batch=n(77);var r=n(37);avalon.render=a,e.exports=avalon},function(e,t,n){function a(e){var t="??"+w++;return $[t]=e,t}function r(e){var t=$[e];return t}function o(e){$={},e=u(e);var t=[];t.last=function(){return t[t.length-1]};var n=[],a=1e5;do{var o=!1;if("<"!==e.charAt(0)){var d=e.indexOf("<");d=-1===d?e.length:d;var f=e.slice(0,d).replace(_,r);e=e.slice(d),o={nodeName:"#text",nodeValue:f},g.test(f)&&l(o,t,n)}if(!o){var d=e.indexOf("<!--");if(0===d){var b=e.indexOf("-->");-1===b&&avalon.error("注释节点没有闭合"+e);var f=e.slice(4,b).replace(_,r);e=e.slice(b+3),o={nodeName:"#comment",nodeValue:f},l(o,t,n)}}if(!o){var x=e.match(h);if(x){var w=x[1].toLowerCase(),A=v[w]||"/"===x[3];o={nodeName:w,props:{},children:[],isVoidTag:A};var C=x[2];if(C&&s(C,o.props),l(o,t,n),e=e.slice(x[0].length),A)o.end=!0;else if(t.push(o),m[w]){var E=e.indexOf("</"+w+">"),k=e.slice(0,E).trim();e=e.slice(E),p(o,w,c(k))}}}if(!o){var x=e.match(y);if(x){var w=x[1].toLowerCase(),T=t.last();T?T.nodeName!==w&&avalon.error(T.nodeName+"没有闭合"):avalon.error(x[0]+"前面缺少<"+w+">"),o=t.pop(),o.end=!0,e=e.slice(x[0].length)}}if(!o||0===--a)break;o.end&&(i(o,t,n),delete o.end)}while(e.length);return n}function i(e,t,n){var a=e.nodeName,r=e.props;"table"===a&&f(e.children);var o=r["ms-for"];if(o){delete r["ms-for"];var i=t.last(),l=i?i.children:n;l.splice(l.length-1,1,{nodeName:"#comment",nodeValue:"ms-for:"+o,type:a},e,{nodeName:"#comment",nodeValue:"ms-for-end:",type:a})}}function l(e,t,n){var a=t.last();a?a.children.push(e):n.push(e)}function s(e,t){e.replace(x,function(e){var n=e.split("="),a=n[0],r=n[1]||"";":"===a.charAt(0)&&(a="ms-"+a.slice(1)),r&&0===r.indexOf("??")&&(r=c(r).replace(b,"").replace(/\"/g,"'").slice(1,-1)),a in t||(t[a]=r)})}function c(e){return avalon.unescapeHTML(e.replace(_,r))}function u(e){for(var t=d(e),n=0,r=t.length;r>n;n++)e=e.replace(t[n],a);return e}function d(e){for(var t,n=0,a=[],r=0,o=e.length;o>r;r++){var i=e.charAt(r);if(t){if("\\"===i){r+=1;continue}i===t&&(a.push(e.slice(n,r+1)),t=!1)}else"'"===i?(t="'",n=r):'"'===i&&(t='"',n=r)}return a}n(73);var v=n(36),f=n(74),p=n(75),m=avalon.oneObject("script,style,textarea,xmp,noscript,option,template"),h=/^<([-A-Za-z0-9_]+)\s*([^>]*?)(\/?)>/,y=/^<\/([^>]+)>/,g=/\S/,_=/\?\?\d+/g,b=/\n\s*/g,x=/\S+/g,w=1,$={};e.exports=o},function(e,t,n){function a(e){var t=e.nodeName;switch(t){case"#text":return avalon.config.rexpr.test(e.nodeValue)?e.dynamic=!0:!1;case"#comment":return!!e.dynamic;case void 0:return!0;default:var n=e.props||{};if("ms-skip"in n)return e.skipContent=!0,!1;var a=!1;if("input"===t)n.type||(n.type="text");else if("select"===t){var o=n.hasOwnProperty("multiple")?"multiple":"one";n.type=t+"-"+o}else 0===t.indexOf("ms-")&&(n["ms-widget"]||(n.is=t,n["ms-widget"]='{is:"'+t+'"}'));var i=!1;if(n["ms-widget"]){i=!0,r(n,"html","widget"),r(n,"text","widget");var l=avalon.mix({},e),s=avalon.mix({},e.props);delete s["ms-widget"],delete l.isVoidTag,l.nodeName="cheng",l.props=s,e.template=avalon.vdomAdaptor(l,"toHTML"),e.isVoidTag||(e.children=[])}n["ms-text"]&&(i=!0,r(n,"html","text"),e.isVoidTag||(e.children=[])),n["ms-html"]&&(i=!0,e.isVoidTag||(e.children=[]));var c=!1;for(var d in n)if(c=!0,0===d.indexOf("ms-")){a=!0,e.dynamic={};break}if(c&&(e.props=n),e.children){var v=u(e.children);if(v)return delete e.skipContent,!0;i?delete e.skipContent:e.skipContent=!0}return a}}function r(e,t,n){e["ms-"+t]&&(avalon.warn(t,"指令不能与",n,"指令共存于同一个元素"),delete e["ms-"+t])}function o(e){return d.appendChild(e),d.removeChild(e),e}function i(e){for(var t,n=0;t=e[n++];)if(t.props&&t.props["ms-effect"])return!0;return!1}var l=/^\s*ms\-for\:/,s=/^\s*ms\-for\-end/,c=n(37);avalon.speedUp=function(e){return u(e),e};var u=function(e){for(var t=[],n=!1,r=0;r<e.length;r++){var d=e[r],v="#comment"===d.nodeName;if(v&&l.test(d.nodeValue)){n=!0,t.push(d);var f=t;t=[],t.list=f,t.start=d}else if(v&&s.test(d.nodeValue)){var f=t;t=f.list;var p=f.start;delete f.list,delete f.start,t.push(f,d),d.dynamic=!0;var m=p.signature||(p.signature=avalon.makeHashCode("for"));if(d.signature=m,p.forExpr=p.nodeValue.replace(/ms\-for:\s*/,""),1===f.length){var h=f[0];if(h.props){var y=h.props["data-for-rendered"];if(y){var g=y+":cb";avalon.caches[g]||(avalon.caches[g]=Function("return "+avalon.parseExpr(y,"on"))()),p.wid=g}}}for(var _=0;_<f.length;_++){var d=f[_];d.dom&&o(d.dom)}p.hasEffect=i(f),u(f),avalon.caches[m]||(avalon.caches[m]=c(f,!0)),f.length=0}else a(d)&&(n=!0),t.push(d)}return e.length=0,e.push.apply(e,t),n},d=document.documentElement},function(e,t){e.exports=function(e){for(var t,n=!1,a=0,r=0,o=e.length,i=0;o>i;i++){var l=e[i];t?"tr"!==l.nodeName&&l.children?t=!1:(t.children.push(l),a++,e[i]=0):"tr"===(l.type||l.nodeName)&&(t={nodeName:"tbody",children:[]},t.children.push(l),l.type&&delete l.type,n=!0,0===r&&(r=i),e[i]=t)}if(n)for(i=r;o>i&&(0!==e[i]||(e.splice(i,1),i--,a--,0!==a));i++);}},function(e,t){function n(e,t,n){switch(t){case"style":case"script":case"noscript":case"template":case"xmp":e.children=[{nodeName:"#text",skipContent:!0,nodeValue:n}];break;case"textarea":var r=e.props;r.type="textarea",r.value=n,e.children=[];break;case"option":e.children=[{nodeName:"#text",nodeValue:a(n)}]}}function a(e){return String(e).replace(r,"").trim()}var r=/<\w+(\s+("[^"]*"|'[^']*'|[^>])+)?>|<\/\w+>/gi;e.exports=n},function(e,t){function n(e,t){for(var l=0;l<e.length;l++){var s=e[l],c=t[l]||e[l];switch(s.nodeName){case"#text":if(s.dynamic){var u=s.nodeValue+"";u!==c.nodeValue&&(c.nodeValue=u,c.dom&&(c.dom.nodeValue=u))}break;case"#comment":s.forExpr?i["for"].diff(s,c,e,t,l):c.afterChange&&a(c,c.afterChange);break;case void 0:n(s,c);break;case"#document-fragment":n(s.children,c.children);break;default:if(s.dynamic){var d=l;s["ms-widget"]&&(avalon.directives.widget.diff(s,c,"ms-widget",e,t,d),s=e[l],c=t[l]||o(),delete s["ms-widget"]),"ms-if"in s&&(avalon.directives["if"].diff(s,c,"ms-if",e,t,d),s=e[l],c=t[l]||o(),delete s["ms-if"]),r(s,c)}!/^\w/.test(s.nodeName)||s.skipContent||s.isVoidTag||n(s.children,c.children||[]),c.afterChange&&a(c,c.afterChange)}}}function a(e,t){if(t.length)for(var n,a=0;n=t[a++];)n(e.dom,e);delete e.afterChange}function r(e,t){var n=avalon.directives;try{for(var a in e){var r=a.match(l),o=r&&r[1];n[o]&&n[o].diff(e,t,a)}}catch(i){avalon.warn(o,i,i.stack||i.message,"diffProps error")}}var o=function(){return{children:[],props:{}}},i=avalon.directives,l=/^ms-(\w+)-?(.*)/;avalon.diff=n,avalon.diffProps=r,e.exports=n},function(e,t,n){function a(e){if(o)return avalon.Array.ensure(r,e);o=e;var t=avalon.scopes[e];if(!t||!document.nodeName||avalon.suspendUpdate)return o=null;var n=t.vmodel,i=n.$element,l=i.vtree||[],s=n.$render,c=s(t.vmodel,t.local);t.isTemp&&delete avalon.scopes[e],avalon.diff(c,l);var u=r.indexOf(o);if(o=0,u>-1){var d=r.splice(u,1);return a(d[0])}var v=r.shift();v&&a(v)}var r=(n(52),[]),o=!1;avalon.suspendUpdate=0,e.exports=avalon.batch=a},function(e,t,n){function a(e){e.addEventListener("DOMNodeRemovedFromDocument",function(){c(e)})}function r(){function e(e,t){var a=n[e];n[e]=function(e,n){return t.call(this,a,e,n)}}function t(e){var t=avalon.slice(this.getElementsByTagName("*"));a.call(this,e),s(t)}if(!r.execute){r.execute=!0;var n=Node.prototype;e("removeChild",function(e,t,n){return e.call(this,t,n),1===t.nodeType&&c(t),t}),e("replaceChild",function(e,t,n){return e.call(this,t,n),1===t.nodeType&&c(t),t});var a,o=Element.prototype;if(Object.getOwnPropertyDescriptor){var i=Object.getOwnPropertyDescriptor(o,"innerHTML");a=i.set,i.set=t,Object.defineProperty(o,"innerHTML",i)}else a=o.__lookupSetter__("innerHTML"),o.__defineSetter__("innerHTML",t);e("appendChild",function(e,t){return e.call(this,t),1===t.nodeType&&11===this.nodeType&&c(t),t}),e("insertBefore",function(e,t,n){return e.call(this,t,n),1===t.nodeType&&11===this.nodeType&&c(t),t})}}function o(e){avalon.Array.ensure(u,e),d||(d=setInterval(function(){for(var e,t=0;e=u[t];)!1===l(e)?avalon.Array.removeAt(u,t):t++;0==u.length&&(clearInterval(d),d=0)},700))}var i=n(79),l=i.fireDisposeHook,s=i.fireDisposeHooks,c=i.fireDisposeHookDelay,u=[],d=0;e.exports=function(e){window.chrome&&window.MutationEvent?a(e):avalon.modern&&"function"==typeof window.Node?r(e):o(e)}},function(e,t){function n(e){for(;e;){if(9===e.nodeType)return!0;e=e.parentNode}return!1}function a(e){if(1===e.nodeType&&e.getAttribute("wid")&&!n(e)){var t=e.getAttribute("wid"),a=avalon.scopes[t];if(!a)return;var o=a.vmodel;if(a.vmodel.$fire("onDispose",{type:"dispose",target:e,vmodel:o}),a&&!e.getAttribute("cached")){delete a.vmodel,delete avalon.scopes[t];var i=e.getAttribute("is"),l=e.vtree;r(l),l&&(l[0][i+"-mount"]=!1,l[0]["component-ready:"+i]=!1)}return!1}}function r(e){for(var t in e){var n=e[t];if(l.test(n.nodeName)){for(var t in n)0===t.indexOf("ms-on")&&delete n[t];n.children&&r(n.children)}}}function o(e){setTimeout(function(){a(e)},4)}function i(e){for(var t,n=0;t=e[n++];)a(t)}var l=/^\w/;e.exports={fireDisposeHookDelay:o,fireDisposeHooks:i,fireDisposeHook:a}},function(e,t,n){function a(){}function r(e,t,n){var r={};e.$skipArray&&(r=avalon.oneObject(e.$skipArray),delete e.$skipArray);var o={};n=n||{},t=t||{};var i={},l=g("$"),s=n.pathname||"";n.id=n.id||l,n.hashcode=n.hashcode||l;var d,v,y;for(d in e)if(!f[d]){var _=o[d]=e[d];u(d,_,r)||(v=n.id+"."+d,y=s?s+"."+d:d,i[d]=p(v,y,t))}i.$model=h;var b=new a;b=c(b,i,e);for(d in o)b[d]=o[d],d in r?delete o[d]:o[d]=!0;return m(b,t,o,i,n),b}function o(e,t,n,r){var o={},i={},l={};n=n||{};var s,d,v,y=r.pathname,b=e.$accessors||{};for(s in t)f[s]||(o[s]=!0,u(s,t[s],_)?(i[s]=t[s],delete t[s]):b[s]?l[s]=b[s]:(d=r.id+"."+s,v=y?y+"."+s:s,l[s]=p(d,v,n)));r.hashcode=e.$hashcode||g("$"),l.$model=h;var x=new a;x=c(x,l,i);for(s in i)x[s]=i[s];return m(x,n,o,l,r),x}function i(e,t){for(var n,r,o,i={},l={},s={},d={},v=avalon.slice(arguments),h={},y="function"==typeof this&&this.isWidget,_=0;_<v.length;_++){var b=v[_],x=b.$accessors;for(var n in b)if(b.hasOwnProperty(n)){var w=b[n];"$skipArray"!==n?y&&-1!==v.indexOf(w)?(r=w,o=n):(i[n]=w,l[n]&&avalon.isObject(w)&&delete l[n],x&&x[n]?l[n]=x[n]:"function"!=typeof i[n]&&(s[n]=1)):Array.isArray(w)&&w.forEach(function(e){h[e]=1})}}"function"==typeof this&&this(i,s);for(n in s)f[n]||l[n]||u(n,i[n],h)||(l[n]=p(e.$id,n,d),l[n].set(i[n]));var $=new a;$=c($,l,i);for(n in i){if(l[n]||($[n]=i[n]),y&&r&&l[n]&&r.hasOwnProperty(n)){var A=l[n].get;A.$decompose||(A.$decompose={}),A.$decompose[o+"."+n]=$}n in f?delete i[n]:i[n]=!0}return m($,d,i,l,{id:e.$id,hashcode:g("$"),master:!0}),$}function l(e,t){e.length!==t&&e.notify("length",e.length,t,!0)}var s=n(81),c=n(85),u=s.isSkip,d=s.toJson,v=s.$$midway,f=s.$$skipArray,p=s.makeAccessor,m=s.initViewModel,h=s.modelAccessor,y=s.modelAdaptor,g=avalon.makeHashCode;v.masterFactory=r;var _={};v.slaveFactory=o,v.mediatorFactory=avalon.mediatorFactory=i;var b=s.__array__,x=Array.prototype,w=x.splice;b.removeAll=function(e){var t=this.length;if(Array.isArray(e))for(var n=this.length-1;n>=0;n--)-1!==e.indexOf(this[n])&&w.call(this,n,1);else if("function"==typeof e)for(n=this.length-1;n>=0;n--){var a=this[n];e(a,n)&&w.call(this,n,1)}else w.call(this,0,this.length);avalon.modern||(this.$model=d(this)),l(this,t),this.notify()};var $=["push","pop","shift","unshift","splice"];$.forEach(function(e){var t=x[e];b[e]=function(n,a){var r=[],o=this.length;if("splice"===e&&Object(this[0])===this[0])for(var i=this.slice(n,a),s=x.slice.call(arguments,2),r=[n,a],c=0,u=s.length;u>c;c++){var v=i[c];r[c+2]=y(s[c],v,v&&v.$events||{},{id:this.$id+".*",master:!0})}else for(var f=0,p=arguments.length;p>f;f++)r[f]=y(arguments[f],0,{},{id:this.$id+".*",master:!0});var m=t.apply(this,r);return avalon.modern||(this.$model=d(this)),l(this,o),this.notify(),m}}),"sort,reverse".replace(avalon.rword,function(e){b[e]=function(){return x[e].apply(this,arguments),avalon.modern||(this.$model=d(this)),this.notify(),this}}),e.exports=avalon},function(e,t,n){function a(e){var t=avalon.type(e);if("array"===t){for(var n=[],r=0;r<e.length;r++)n[r]=a(e[r]);return n}if("object"===t){var o={};for(r in e)if("__proxy__"!==r&&"__data__"!==r&&"__const__"!==r&&e.hasOwnProperty(r)){var i=e[r];o[r]=i&&i.nodeType?i:a(i)}return o}return e}function r(e,t,n){c?Object.defineProperty(e,t,{value:n,writable:!0,enumerable:!1,configurable:!0}):e[t]=n}function o(e,t,n,o,s){function c(e){return n[e]===!0}s.array?avalon.modern?Object.defineProperty(e,"$model",d):e.$model=a(e):(r(e,"$accessors",o),r(e,"hasOwnProperty",c),r(e,"$track",Object.keys(n).sort().join(";;"))),r(e,"$id",s.id),r(e,"$hashcode",s.hashcode),s.master===!0&&(r(e,"$run",function(){l.call(e)}),r(e,"$wait",function(){i.call(e)}),r(e,"$element",null),r(e,"$render",0),u(e,t))}function i(){this.$events.$$wait$$=!0}function l(){var e=this.$events;if(delete e.$$wait$$,e.$$dirty$$){delete e.$$dirty$$,avalon.rerenderStart=new Date;var t=this.$id,n=t.indexOf(".");n>0?avalon.batch(t.slice(0,n)):avalon.batch(t)}}var s=n(82),c=n(84),u=s.initEvents,d={get:function(){return a(this)},set:avalon.noop,enumerable:!1,configurable:!0};s.$$midway.initViewModel=o,s.$$midway.hideProperty=r;var v={toJson:a,initViewModel:o,modelAccessor:d};for(var f in s)v[f]=s[f];e.exports=v},function(e,t,n){function a(e,t){t.__vmodel__=e;var n=f.hideProperty;n(e,"$events",t),n(e,"$watch",function(){if(2===arguments.length)return y.apply(e,arguments);throw"$watch方法参数不对"}),n(e,"$fire",function(t,n,a){var r=e.$events[t];h(r,e,t,n,a)})}function r(e,t,n){return"$"===e.charAt(0)||n[e]||g.test(avalon.type(t))||t&&t.nodeName&&t.nodeType>0}function o(e,t,n,a){if(Array.isArray(e))return f.arrayFactory(e,t,n,a);if(Object(e)===e&&"function"!=typeof e){if(t&&t.$id){if(++avalon.suspendUpdate,t.$track!==Object.keys(e).sort().join(";;"))var r=f.slaveFactory(t,e,n,a);else r=t;for(var o in e)p[o]||(r[o]=e[o]);return--avalon.suspendUpdate,r}return r=f.masterFactory(e,n,a)}return e}function i(e,t,n){function a(){return r}var r=NaN;return a.heirloom=n,{get:a,set:function(o){if(r!==o){var i=n.__vmodel__;o&&"object"==typeof o&&(o=f.modelAdaptor(o,r,n,{pathname:t,id:e}));var d=r;if(r=o,this.$hashcode&&i){if(i.$events.$$dirty$$=!0,i.$events.$$wait$$)return;n!==i.$events&&(a.heirloom=i.$events),c(a.$decompose,t,o,d),-1===t.indexOf("*")&&h(a.heirloom[t],i,t,o,d),s(e+"",i,t,o,d),u(a.heirloom,i,t,o,d),i.$events.$$dirty$$=!1,l(i.$id)}}},enumerable:!0,configurable:!0}}function l(e){avalon.rerenderStart=new Date;var t=e.indexOf(".");t>0?avalon.batch(e.slice(0,t)):avalon.batch(e)}function s(e,t,n,a,r){if(e.indexOf(".*.")>0){var o=e.match(_),i=avalon.vmodels[o[1]];if(i){var l=o[2];h(i.$events[l],t,n,a,r)}}}function c(e,t,n,a){if(e&&e[t]){var r=e[t];if(r.$hashcode){var o=t.replace(/^[^.]+\./,"");o!==t&&h(r.$events[o],r,o,n,a)}else delete e[t]}}function u(e,t,n,a,r){e.__fuzzy__&&e.__fuzzy__.replace(avalon.rword,function(o){var i=e[o],l=i.reg;return l&&l.test(n)&&h(i,t,n,a,r),o})}function d(e){var t=e.$id;if(!t&&avalon.config.debug&&avalon.warn("vm.$id must be specified"),avalon.vmodels[t])throw Error("error:["+t+"] had defined!");var n=f.masterFactory(e,{},{pathname:"",id:t,master:!0});return avalon.vmodels[t]=n}function v(e,t,n,a){if(t&&t.splice){var r=[0,t.length].concat(e);return++avalon.suspendUpdate,avalon.callArray=a.pathname,t.splice.apply(t,r),--avalon.suspendUpdate,t}for(var i in b)e[i]=b[i];e.notify=function(e,t,r,o){var i=n.__vmodel__;if(i){var s=null===e||void 0===e?a.pathname:a.pathname+"."+e;i.$fire(s,t,r),o||n.$$wait$$||avalon.suspendUpdate||(avalon.callArray=s,l(i.$id),delete avalon.callArray)}};var s=avalon.makeHashCode("$");a.array=!0,a.hashcode=s,a.id=a.id||s,f.initViewModel(e,n,{},{},a);for(var c=0,u=e.length;u>c;c++)e[c]=o(e[c],0,{},{id:e.$id+".*",master:!0});return e}var f={},p=n(68),m=n(83),h=m.$emit,y=m.$watch,g=/function|window|date|regexp|element/i;
f.modelAdaptor=o;var _=/([^.]+)\.(.+)/;f.arrayFactory=v;var b={set:function(e,t){if(e>>>0===e&&this[e]!==t){if(e>this.length)throw Error(e+"set方法的第一个参数不能大于原数组长度");this.splice(e,1,t)}},contains:function(e){return-1!==this.indexOf(e)},ensure:function(e){return this.contains(e)||this.push(e),this},pushArray:function(e){return this.push.apply(this,e)},remove:function(e){return this.removeAt(this.indexOf(e))},removeAt:function(e){return e>>>0===e?this.splice(e,1):[]},clear:function(){return this.removeAll(),this}};avalon.define=d,e.exports={$$midway:f,$$skipArray:p,isSkip:r,__array__:b,initEvents:a,makeAccessor:i,modelAdaptor:o}},function(e,t){function n(e,t){var n,a=t.split(".")[0];try{e.hasOwnProperty(a)&&(n=e.$accessors?e.$accessors[a].get.heirloom.__vmodel__:Object.getOwnPropertyDescriptor(e,a).get.heirloom.__vmodel__)}catch(r){}return n||e}function a(e){var t=e.split(".");return new RegExp("^"+t.map(function(e){return"*"===e?"(?:[^.]+)":e}).join("\\.")+"$","i")}function r(e,t,n){e&&(t.__fuzzy__?-1===t.__fuzzy__.indexOf(","+n)&&(t.__fuzzy__+=","+n):t.__fuzzy__=n)}function o(e,t){var n=e.indexOf(".*")>0||"*"===e,i=n?this:o.adjust(this,e),l=this.$events,s=l[e]||(l[e]=[]);return n&&(s.reg=s.reg||a(e)),r(n,l,e),i!==this&&r(n,this.$events,e),avalon.Array.ensure(s,t),function(){avalon.Array.remove(s,t)}}function i(e,t,n,a,r,o){if(e&&e.length)try{for(o=o||e.length-1;o>=0;o--){var l=e[o];l.call(t,a,r,n)}}catch(s){o-1>0&&i(e,t,n,a,r,o-1),avalon.log(s,n)}}o.adjust=n,e.exports={$emit:i,$watch:o,adjustVm:n}},function(e,t){var n=!0;try{Object.defineProperty({},"_",{value:"x"})}catch(a){n=!1}e.exports=n},function(e,t,n){function a(e,t,n,a){var r=t[n];return 4!==arguments.length?r.get.call(e):void r.set.call(e,a)}var r,o=n(84),i=n(68),l=Object.defineProperties,s=new Date-0;if(!o&&("__defineGetter__"in avalon&&(r=function(e,t,n){return"value"in n&&(e[t]=n.value),"get"in n&&e.__defineGetter__(t,n.get),"set"in n&&e.__defineSetter__(t,n.set),e},l=function(e,t){for(var n in t)t.hasOwnProperty(n)&&r(e,n,t[n]);return e}),avalon.msie)){var c={};window.execScript(["Function parseVB(code)","	ExecuteGlobal(code)","End Function"].join("\n"),"VBScript"),l=function(e,t,n){var r=[];r.push("\r\n	Private [__data__], [__proxy__]","	Public Default Function [__const__](d"+s+", p"+s+")","		Set [__data__] = d"+s+": set [__proxy__] = p"+s,"		Set [__const__] = Me","	End Function");var o={__proxy__:!0,__data__:!0,__const__:!0};for(e in t)o[e]=!0,r.push("	Public Property Let ["+e+"](val"+s+")",'		Call [__proxy__](Me,[__data__], "'+e+'", val'+s+")","	End Property","	Public Property Set ["+e+"](val"+s+")",'		Call [__proxy__](Me,[__data__], "'+e+'", val'+s+")","	End Property","	Public Property Get ["+e+"]","	On Error Resume Next","		Set["+e+'] = [__proxy__](Me,[__data__],"'+e+'")',"	If Err.Number <> 0 Then","		["+e+'] = [__proxy__](Me,[__data__],"'+e+'")',"	End If","	On Error Goto 0","	End Property");for(e in n)o[e]!==!0&&(o[e]=!0,r.push("	Public ["+e+"]"));for(e in i)o[e]!==!0&&(o[e]=!0,r.push("	Public ["+e+"]"));r.push("	Public [hasOwnProperty]"),r.push("End Class");var l=r.join("\r\n"),u=c[l];u||(u=avalon.makeHashCode("VBClass"),window.parseVB("Class "+u+l),window.parseVB(["Function "+u+"Factory(a, b)","	Dim o","	Set o = (New "+u+")(a, b)","	Set "+u+"Factory = o","End Function"].join("\r\n")),c[l]=u);var d=window[u+"Factory"](t,a);return d}}e.exports=l}])});
//# sourceMappingURL=avalon.min.js.map