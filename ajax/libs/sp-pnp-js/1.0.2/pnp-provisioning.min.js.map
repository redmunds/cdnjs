{"version":3,"sources":["pnp-provisioning.min.js"],"names":["f","exports","module","define","amd","g","window","global","self","this","$pnp","Provisioning","e","t","n","r","s","o","u","a","require","i","Error","code","l","call","length","1","factory","v","undefined","util_1","Dictionary","keys","values","prototype","get","key","index","indexOf","add","push","merge","source","Util","isFunction","sourceAsDictionary","getKeys","sourceAsHash","hasOwnProperty","remove","val","splice","getValues","clear","count","../utils/util","2","setRuntimeConfig","config","_runtimeConfig","set","RuntimeConfigImpl","_headers","_defaultCachingStore","_defaultCachingTimeoutSeconds","_globalCacheDisable","_useSPRequestExecutor","headers","globalCacheDisable","defaultCachingStore","defaultCachingTimeoutSeconds","useSPRequestExecutor","Object","defineProperty","enumerable","configurable","RuntimeConfig","3","fetchClient_1","digestCache_1","pnplibconfig_1","SPRequestExecutorClient_1","HttpClient","_impl","SPRequestExecutorClient","FetchClient","_digestCache","DigestCache","fetch","url","options","opts","extend","cache","credentials","Headers","mergeHeaders","has","append","method","toUpperCase","webUrl","substr","getDigest","then","digest","fetchRaw","_this","retry","ctx","response","resolve","delay","status","reject","attempts","retryCount","setTimeout","getCtxCallback","Promise","retryContext","post","target","temp","Request","forEach","value","name","../configuration/pnplibconfig","./SPRequestExecutorClient","./digestCache","./fetchClient","4","convertToResponse","spResponse","responseHeaders","h","Response","body","statusCode","statusText","SP","RequestExecutor","iterator","addinWebUrl","substring","executor","entries","next","done","executeAsync","error","success","5","collections_1","odata_1","CachedDigest","_httpClient","_digests","cachedDigest","now","Date","expiration","combinePaths","Accept","Content-type","parser","ODataDefaultParser","parse","d","GetContextWebInformation","data","newCachedDigest","FormDigestValue","seconds","FormDigestTimeoutSeconds","setTime","getTime","../collections/collections","../sharepoint/rest/odata","6","7","arguments","apply","dup","8","__extends","b","__","constructor","p","create","ObjectHandlerBase_1","ObjectComposedLook","_super","ProvisionObjects","object","scope_started","clientContext","ClientContext","get_current","web","get_web","colorPaletteUrl","ColorPaletteUrl","replaceUrlTokens","fontSchemeUrl","FontSchemeUrl","backgroundImageUrl","BackgroundImageUrl","applyTheme","getRelativeUrl","update","executeQueryAsync","scope_ended","ObjectHandlerBase","../util","./ObjectHandlerBase","9","ObjectCustomActions","customactions","userCustomActions","get_userCustomActions","load","obj","objExists","get_data","filter","userCustomAction","get_title","Title","objCreationInformation","Description","set_description","CommandUIExtension","set_commandUIExtension","Group","set_group","set_title","Url","set_url","ScriptBlock","set_scriptBlock","ScriptSrc","set_scriptSrc","Location","set_location","ImageUrl","set_imageUrl","Name","set_name","RegistrationId","set_registrationId","RegistrationType","set_registrationType","Rights","set_rights","Sequence","set_sequence","10","ObjectFeatures","features","webFeatures","get_features","Deactivate","Guid","ID","FeatureDefinitionScope","none","11","CoreUtil","ObjectFiles","objects","fileInfos","promises","httpClient","Src","text","all","responses","filename","GetFilenameFromFilePath","Dest","webServerRelativeUrl","_spPageContextInfo","folder","getFolderByServerRelativeUrl","GetFolderFromFilePath","fi","Contents","Filename","Folder","Instance","Overwrite","Properties","RemoveExistingWebParts","ServerRelativeUrl","Views","WebParts","FileCreationInformation","set_overwrite","set_content","Base64EncodedByteArray","get_content","charCodeAt","get_files","ApplyFileProperties","AddWebPartsToWebPartPage","ModifyHiddenViews","RemoveWebPartsFromFileIfSpecified","limitedWebPartManager","shouldRemoveExisting","existingWebParts","get_webParts","wp","deleteWebPart","GetWebPartXml","webParts","FileUrl","fileUrl","res","rej","Xml","dest","src","fileServerRelativeUrl","file","getFileByServerRelativeUrl","getLimitedWebPartManager","PersonalizationScope","shared","webPartsWithXml","oWebPartDefinition","importWebPart","oWebPart","get_webPart","addWebPart","Zone","Order","fileProperties","listItemAllFields","get_listItemAllFields","set_item","GetViewFromCollectionByUrl","viewCollection","serverRelativeUrl","viewCollectionEnumerator","getEnumerator","moveNext","view","get_serverRelativeUrl","toString","toLowerCase","mapping","lists","listViewCollections","List","get_lists","getByTitle","get_views","views","list","Paged","set_paged","Query","set_viewQuery","RowLimit","set_rowLimit","ViewFields","columns_1","get_viewFields","removeAll","vf","filePath","split","join","../../../utils/util","12","HttpClient_1","logging_1","parameters","Logger","write","../../../net/HttpClient","../../../utils/logging","13","Sequencer_1","ObjectLists","listInstances","existingObj","EnableVersioning","set_enableVersioning","EnableMinorVersions","set_enableMinorVersions","EnableModeration","set_enableModeration","EnableFolderCreation","set_enableFolderCreation","EnableAttachments","set_enableAttachments","NoCrawl","set_noCrawl","DefaultDisplayFormUrl","set_defaultDisplayFormUrl","DefaultEditFormUrl","set_defaultEditFormUrl","DefaultNewFormUrl","set_defaultNewFormUrl","DraftVersionVisibility","set_draftVersionVisibility","DraftVisibilityType","Hidden","set_hidden","ForceCheckout","set_forceCheckout","ListCreationInformation","OnQuickLaunch","QuickLaunchOptions","on","off","set_quickLaunchOption","TemplateType","set_templateType","createdList","toLocaleLowerCase","sequencer","Sequencer","ApplyContentTypeBindings","ApplyListInstanceFieldRefs","ApplyFields","ApplyLookupFields","ApplyListSecurity","CreateViews","InsertDataRows","CreateFolders","ListInstances","Objects","execute","EnsureLocationBasedMetadataDefaultsReceiver","eventReceivers","get_eventReceivers","eventRecCreationInfo","EventReceiverDefinitionCreationInformation","set_receiverName","set_synchronization","set_sequenceNumber","set_receiverAssembly","set_receiverClass","set_eventType","EventReceiverType","itemAdded","params","Folders","folderServerRelativeUrl","rootFolder","get_rootFolder","metadataDefaults","setMetadataDefaults","folderUrl","get_folders","DefaultValues","metadataDefaultsFileCreateInfo","webCts","get_site","get_rootWeb","get_contentTypes","listCts","ContentTypeBindings","set_contentTypesEnabled","listContentTypes","existingContentTypes","Array","RemoveExistingContentTypes","ct","ctb","addExistingContentType","getById","ContentTypeId","j","ect","deleteObject","siteFields","get_fields","FieldRefs","fr","field","getByInternalNameOrTitle","Fields","fieldXml","GetFieldXml","fieldType","GetFieldXmlAttr","addFieldAsXml","AddFieldOptions","addToAllContentTypes","attr","regex","RegExp","match","exec","SchemaXml","properties_1","prop","targetList","get_id","Type","Formula","Security","BreakRoleInheritance","breakRoleInheritance","CopyRoleAssignments","ClearSubscopes","get_roleAssignments","allProperties","get_allProperties","siteGroups","get_siteGroups","roleDefinitions","get_roleDefinitions","RoleAssignments","ra","roleDef","RoleDefinition","getByName","roleBindings","RoleDefinitionBindingCollection","newObject","principal","Principal","token","groupId","get_fieldValues","viewExists","ev","RemoveExistingViews","Scope","set_scope","viewCreationInformation","ViewCreationInformation","PersonalView","set_personalView","set_query","SetAsDefaultView","set_setAsDefaultView","set_viewFields","ViewTypeKind","set_viewTypeKind","ViewType","html","DataRows","item","addItem","ListItemCreationInformation","../Sequencer/Sequencer","14","ObjectNavigation","navigation","get_navigation","ConfigureQuickLaunch","QuickLaunch","getNodeFromCollectionByTitle","nodeCollection","title","nodes","quickLaunchNodeCollection_1","get_quickLaunch","temporaryQuickLaunch","get_count","oldNode","itemAt","existingNode","newNode","NavigationNodeCreationInformation","get_url","set_asLastNode","webAbsoluteUrl","json","node","getNodeById","Id","childrenNodeCollection","get_children","parentNode","Children","15","ObjectPropertyBagEntries","clientContext_1","web_1","propBag_1","indexedProperties_1","entry","Key","Value","Indexed","encodePropertyKey","16","ObjectWebSettings","WelcomePage","set_welcomePage","MasterUrl","set_masterUrl","CustomMasterUrl","set_customMasterUrl","SaveSiteAsTemplateEnabled","set_saveSiteAsTemplateEnabled","QuickLaunchEnabled","TreeViewEnabled","set_treeViewEnabled","17","ProvisioningStep","handler","dependentPromise","_handler","18","functions","parameter","scope","progressFunction","promiseSequence","sequenceFunction","functionNr","result","19","ProvisioningStep_1","ObjectNavigation_1","ObjectPropertyBagEntries_1","ObjectFeatures_1","ObjectWebSettings_1","ObjectComposedLook_1","ObjectCustomActions_1","ObjectFiles_1","ObjectLists_1","handlers","Navigation","PropertyBagEntries","Features","WebSettings","ComposedLook","CustomActions","Files","Lists","applyTemplate","path","ok","template","start","LogLevel","queue","startTime","queueItems","q","Parameters","Info","JSON","stringify","../../net/HttpClient","../../utils/logging","./ObjectHandlers/ObjectComposedLook","./ObjectHandlers/ObjectCustomActions","./ObjectHandlers/ObjectFeatures","./ObjectHandlers/ObjectFiles","./ObjectHandlers/ObjectLists","./ObjectHandlers/ObjectNavigation","./ObjectHandlers/ObjectPropertyBagEntries","./ObjectHandlers/ObjectWebSettings","./ProvisioningStep","./util","20","replace","document","location","protocol","hostname","siteAbsoluteUrl","propKey","bytes","b64encoded","btoa","String","fromCharCode","21","getEntityUrl","entity","__metadata","uri","Warning","ODataValue","ODataValueParserImpl","ODataEntity","ODataEntityParserImpl","ODataEntityArray","ODataEntityArrayParserImpl","httpclient_1","ODataParserBase","results","ODataRawParserImpl","map","ODataRaw","ODataBatch","_batchId","getGUID","_requests","_batchDepCount","info","incrementBatchDep","decrementBatchDep","executeImpl","batchBody","currentChangeSetId","reqInfo","Content-Type","name_1","batchHeaders","batchOptions","client","makeUrlAbsolute","_parseResponse","request","header","statusRegExp","lines","state","line","trim","parts","parseInt","../../configuration/pnplibconfig","../../net/httpclient","../../utils/util","22","instance","activeLogLevel","_instance","LoggerImpl","subscribe","listeners","_i","clearSubscribers","message","level","Verbose","log","measure","subscribers","listener","slice","console","profile","profileEnd","ConsoleListener","msg","format","warn","AzureInsightsListener","azureInsightsInstrumentationKey","appInsights","createElement","getElementsByTagName","appendChild","cookie","pop","disableExceptionTracking","instrumentationKey","ai","trackException","trackEvent","FunctionListener","23","context","urlParamExists","test","search","getUrlParamByName","decodeURIComponent","getUrlParamBoolByName","isFalse","stringInsert","dateAdd","date","interval","units","ret","toLocaleString","setFullYear","getFullYear","setMonth","getMonth","setDate","getDate","loadStylesheet","avoidCache","encodeURIComponent","head","setAttribute","paths","getRandomString","chars","possible","charAt","Math","floor","random","guid","c","candidateFunction","isArray","array","stringIsNullOrEmpty","noOverwrite","id","check","applyMixins","derivedCtor","baseCtors","baseCtor","getOwnPropertyNames","isUrlAbsolute"],"mappings":"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","file":"pnp-provisioning.min.js","sourcesContent":["(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}(g.$pnp || (g.$pnp = {})).Provisioning = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n(function (factory) {\n    if (typeof module === 'object' && typeof module.exports === 'object') {\n        var v = factory(require, exports); if (v !== undefined) module.exports = v;\n    }\n    else if (typeof define === 'function' && define.amd) {\n        define([\"require\", \"exports\", \"../utils/util\"], factory);\n    }\n})(function (require, exports) {\n    \"use strict\";\n    var util_1 = require(\"../utils/util\");\n    var Dictionary = (function () {\n        function Dictionary() {\n            this.keys = [];\n            this.values = [];\n        }\n        Dictionary.prototype.get = function (key) {\n            var index = this.keys.indexOf(key);\n            if (index < 0) {\n                return null;\n            }\n            return this.values[index];\n        };\n        Dictionary.prototype.add = function (key, o) {\n            var index = this.keys.indexOf(key);\n            if (index > -1) {\n                this.values[index] = o;\n            }\n            else {\n                this.keys.push(key);\n                this.values.push(o);\n            }\n        };\n        Dictionary.prototype.merge = function (source) {\n            if (util_1.Util.isFunction(source[\"getKeys\"])) {\n                var sourceAsDictionary = source;\n                var keys = sourceAsDictionary.getKeys();\n                var l = keys.length;\n                for (var i = 0; i < l; i++) {\n                    this.add(keys[i], sourceAsDictionary.get(keys[i]));\n                }\n            }\n            else {\n                var sourceAsHash = source;\n                for (var key in sourceAsHash) {\n                    if (sourceAsHash.hasOwnProperty(key)) {\n                        this.add(key, source[key]);\n                    }\n                }\n            }\n        };\n        Dictionary.prototype.remove = function (key) {\n            var index = this.keys.indexOf(key);\n            if (index < 0) {\n                return null;\n            }\n            var val = this.values[index];\n            this.keys.splice(index, 1);\n            this.values.splice(index, 1);\n            return val;\n        };\n        Dictionary.prototype.getKeys = function () {\n            return this.keys;\n        };\n        Dictionary.prototype.getValues = function () {\n            return this.values;\n        };\n        Dictionary.prototype.clear = function () {\n            this.keys = [];\n            this.values = [];\n        };\n        Dictionary.prototype.count = function () {\n            return this.keys.length;\n        };\n        return Dictionary;\n    }());\n    exports.Dictionary = Dictionary;\n});\n\n},{\"../utils/util\":23}],2:[function(require,module,exports){\n(function (factory) {\n    if (typeof module === 'object' && typeof module.exports === 'object') {\n        var v = factory(require, exports); if (v !== undefined) module.exports = v;\n    }\n    else if (typeof define === 'function' && define.amd) {\n        define([\"require\", \"exports\"], factory);\n    }\n})(function (require, exports) {\n    \"use strict\";\n    var RuntimeConfigImpl = (function () {\n        function RuntimeConfigImpl() {\n            this._headers = null;\n            this._defaultCachingStore = \"session\";\n            this._defaultCachingTimeoutSeconds = 30;\n            this._globalCacheDisable = false;\n            this._useSPRequestExecutor = false;\n        }\n        RuntimeConfigImpl.prototype.set = function (config) {\n            if (config.hasOwnProperty(\"headers\")) {\n                this._headers = config.headers;\n            }\n            if (config.hasOwnProperty(\"globalCacheDisable\")) {\n                this._globalCacheDisable = config.globalCacheDisable;\n            }\n            if (config.hasOwnProperty(\"defaultCachingStore\")) {\n                this._defaultCachingStore = config.defaultCachingStore;\n            }\n            if (config.hasOwnProperty(\"defaultCachingTimeoutSeconds\")) {\n                this._defaultCachingTimeoutSeconds = config.defaultCachingTimeoutSeconds;\n            }\n            if (config.hasOwnProperty(\"useSPRequestExecutor\")) {\n                this._useSPRequestExecutor = config.useSPRequestExecutor;\n            }\n        };\n        Object.defineProperty(RuntimeConfigImpl.prototype, \"headers\", {\n            get: function () {\n                return this._headers;\n            },\n            enumerable: true,\n            configurable: true\n        });\n        Object.defineProperty(RuntimeConfigImpl.prototype, \"defaultCachingStore\", {\n            get: function () {\n                return this._defaultCachingStore;\n            },\n            enumerable: true,\n            configurable: true\n        });\n        Object.defineProperty(RuntimeConfigImpl.prototype, \"defaultCachingTimeoutSeconds\", {\n            get: function () {\n                return this._defaultCachingTimeoutSeconds;\n            },\n            enumerable: true,\n            configurable: true\n        });\n        Object.defineProperty(RuntimeConfigImpl.prototype, \"globalCacheDisable\", {\n            get: function () {\n                return this._globalCacheDisable;\n            },\n            enumerable: true,\n            configurable: true\n        });\n        Object.defineProperty(RuntimeConfigImpl.prototype, \"useSPRequestExecutor\", {\n            get: function () {\n                return this._useSPRequestExecutor;\n            },\n            enumerable: true,\n            configurable: true\n        });\n        return RuntimeConfigImpl;\n    }());\n    exports.RuntimeConfigImpl = RuntimeConfigImpl;\n    var _runtimeConfig = new RuntimeConfigImpl();\n    exports.RuntimeConfig = _runtimeConfig;\n    function setRuntimeConfig(config) {\n        _runtimeConfig.set(config);\n    }\n    exports.setRuntimeConfig = setRuntimeConfig;\n});\n\n},{}],3:[function(require,module,exports){\n(function (factory) {\n    if (typeof module === 'object' && typeof module.exports === 'object') {\n        var v = factory(require, exports); if (v !== undefined) module.exports = v;\n    }\n    else if (typeof define === 'function' && define.amd) {\n        define([\"require\", \"exports\", \"./fetchClient\", \"./digestCache\", \"../utils/util\", \"../configuration/pnplibconfig\", \"./SPRequestExecutorClient\"], factory);\n    }\n})(function (require, exports) {\n    \"use strict\";\n    var fetchClient_1 = require(\"./fetchClient\");\n    var digestCache_1 = require(\"./digestCache\");\n    var util_1 = require(\"../utils/util\");\n    var pnplibconfig_1 = require(\"../configuration/pnplibconfig\");\n    var SPRequestExecutorClient_1 = require(\"./SPRequestExecutorClient\");\n    var HttpClient = (function () {\n        function HttpClient() {\n            if (pnplibconfig_1.RuntimeConfig.useSPRequestExecutor) {\n                this._impl = new SPRequestExecutorClient_1.SPRequestExecutorClient();\n            }\n            else {\n                this._impl = new fetchClient_1.FetchClient();\n            }\n            this._digestCache = new digestCache_1.DigestCache(this);\n        }\n        HttpClient.prototype.fetch = function (url, options) {\n            if (options === void 0) { options = {}; }\n            var self = this;\n            var opts = util_1.Util.extend(options, { cache: \"no-cache\", credentials: \"same-origin\" }, true);\n            var headers = new Headers();\n            this.mergeHeaders(headers, pnplibconfig_1.RuntimeConfig.headers);\n            this.mergeHeaders(headers, options.headers);\n            if (!headers.has(\"Accept\")) {\n                headers.append(\"Accept\", \"application/json\");\n            }\n            if (!headers.has(\"Content-Type\")) {\n                headers.append(\"Content-Type\", \"application/json;odata=verbose;charset=utf-8\");\n            }\n            if (!headers.has(\"X-ClientService-ClientTag\")) {\n                headers.append(\"X-ClientService-ClientTag\", \"SharePoint.PnP.JavaScriptCore\");\n            }\n            opts = util_1.Util.extend(opts, { headers: headers });\n            if (opts.method && opts.method.toUpperCase() !== \"GET\") {\n                if (!headers.has(\"X-RequestDigest\")) {\n                    var index = url.indexOf(\"/_api/\");\n                    if (index < 0) {\n                        throw new Error(\"Unable to determine API url\");\n                    }\n                    var webUrl = url.substr(0, index);\n                    return this._digestCache.getDigest(webUrl)\n                        .then(function (digest) {\n                        headers.append(\"X-RequestDigest\", digest);\n                        return self.fetchRaw(url, opts);\n                    });\n                }\n            }\n            return self.fetchRaw(url, opts);\n        };\n        HttpClient.prototype.fetchRaw = function (url, options) {\n            var _this = this;\n            if (options === void 0) { options = {}; }\n            var retry = function (ctx) {\n                _this._impl.fetch(url, options).then(function (response) { return ctx.resolve(response); }).catch(function (response) {\n                    var delay = ctx.delay;\n                    if (response.status !== 429 && response.status !== 503) {\n                        ctx.reject(response);\n                    }\n                    ctx.delay *= 2;\n                    ctx.attempts++;\n                    if (ctx.retryCount <= ctx.attempts) {\n                        ctx.reject(response);\n                    }\n                    setTimeout(util_1.Util.getCtxCallback(_this, retry, ctx), delay);\n                });\n            };\n            return new Promise(function (resolve, reject) {\n                var retryContext = {\n                    attempts: 0,\n                    delay: 100,\n                    reject: reject,\n                    resolve: resolve,\n                    retryCount: 7,\n                };\n                retry.call(_this, retryContext);\n            });\n        };\n        HttpClient.prototype.get = function (url, options) {\n            if (options === void 0) { options = {}; }\n            var opts = util_1.Util.extend(options, { method: \"GET\" });\n            return this.fetch(url, opts);\n        };\n        HttpClient.prototype.post = function (url, options) {\n            if (options === void 0) { options = {}; }\n            var opts = util_1.Util.extend(options, { method: \"POST\" });\n            return this.fetch(url, opts);\n        };\n        HttpClient.prototype.mergeHeaders = function (target, source) {\n            if (typeof source !== \"undefined\") {\n                var temp = new Request(\"\", { headers: source });\n                temp.headers.forEach(function (value, name) {\n                    target.append(name, value);\n                });\n            }\n        };\n        return HttpClient;\n    }());\n    exports.HttpClient = HttpClient;\n});\n\n},{\"../configuration/pnplibconfig\":2,\"../utils/util\":23,\"./SPRequestExecutorClient\":4,\"./digestCache\":5,\"./fetchClient\":6}],4:[function(require,module,exports){\n(function (factory) {\n    if (typeof module === 'object' && typeof module.exports === 'object') {\n        var v = factory(require, exports); if (v !== undefined) module.exports = v;\n    }\n    else if (typeof define === 'function' && define.amd) {\n        define([\"require\", \"exports\"], factory);\n    }\n})(function (require, exports) {\n    \"use strict\";\n    var SPRequestExecutorClient = (function () {\n        function SPRequestExecutorClient() {\n            this.convertToResponse = function (spResponse) {\n                var responseHeaders = new Headers();\n                for (var h in spResponse.headers) {\n                    if (spResponse.headers[h]) {\n                        responseHeaders.append(h, spResponse.headers[h]);\n                    }\n                }\n                return new Response(spResponse.body, {\n                    headers: responseHeaders,\n                    status: spResponse.statusCode,\n                    statusText: spResponse.statusText,\n                });\n            };\n        }\n        SPRequestExecutorClient.prototype.fetch = function (url, options) {\n            var _this = this;\n            if (typeof SP === \"undefined\" || typeof SP.RequestExecutor === \"undefined\") {\n                throw new Error(\"SP.RequestExecutor is undefined. \" +\n                    \"Load the SP.RequestExecutor.js library (/_layouts/15/SP.RequestExecutor.js) before loading the PnP JS Core library.\");\n            }\n            var addinWebUrl = url.substring(0, url.indexOf(\"/_api\")), executor = new SP.RequestExecutor(addinWebUrl), headers = {}, iterator, temp;\n            if (options.headers && options.headers instanceof Headers) {\n                iterator = options.headers.entries();\n                temp = iterator.next();\n                while (!temp.done) {\n                    headers[temp.value[0]] = temp.value[1];\n                    temp = iterator.next();\n                }\n            }\n            else {\n                headers = options.headers;\n            }\n            return new Promise(function (resolve, reject) {\n                executor.executeAsync({\n                    body: options.body,\n                    error: function (error) {\n                        reject(_this.convertToResponse(error));\n                    },\n                    headers: headers,\n                    method: options.method,\n                    success: function (response) {\n                        resolve(_this.convertToResponse(response));\n                    },\n                    url: url,\n                });\n            });\n        };\n        return SPRequestExecutorClient;\n    }());\n    exports.SPRequestExecutorClient = SPRequestExecutorClient;\n});\n\n},{}],5:[function(require,module,exports){\n(function (factory) {\n    if (typeof module === 'object' && typeof module.exports === 'object') {\n        var v = factory(require, exports); if (v !== undefined) module.exports = v;\n    }\n    else if (typeof define === 'function' && define.amd) {\n        define([\"require\", \"exports\", \"../collections/collections\", \"../utils/util\", \"../sharepoint/rest/odata\"], factory);\n    }\n})(function (require, exports) {\n    \"use strict\";\n    var collections_1 = require(\"../collections/collections\");\n    var util_1 = require(\"../utils/util\");\n    var odata_1 = require(\"../sharepoint/rest/odata\");\n    var CachedDigest = (function () {\n        function CachedDigest() {\n        }\n        return CachedDigest;\n    }());\n    exports.CachedDigest = CachedDigest;\n    var DigestCache = (function () {\n        function DigestCache(_httpClient, _digests) {\n            if (_digests === void 0) { _digests = new collections_1.Dictionary(); }\n            this._httpClient = _httpClient;\n            this._digests = _digests;\n        }\n        DigestCache.prototype.getDigest = function (webUrl) {\n            var self = this;\n            var cachedDigest = this._digests.get(webUrl);\n            if (cachedDigest !== null) {\n                var now = new Date();\n                if (now < cachedDigest.expiration) {\n                    return Promise.resolve(cachedDigest.value);\n                }\n            }\n            var url = util_1.Util.combinePaths(webUrl, \"/_api/contextinfo\");\n            return self._httpClient.fetchRaw(url, {\n                cache: \"no-cache\",\n                credentials: \"same-origin\",\n                headers: {\n                    \"Accept\": \"application/json;odata=verbose\",\n                    \"Content-type\": \"application/json;odata=verbose;charset=utf-8\",\n                },\n                method: \"POST\",\n            }).then(function (response) {\n                var parser = new odata_1.ODataDefaultParser();\n                return parser.parse(response).then(function (d) { return d.GetContextWebInformation; });\n            }).then(function (data) {\n                var newCachedDigest = new CachedDigest();\n                newCachedDigest.value = data.FormDigestValue;\n                var seconds = data.FormDigestTimeoutSeconds;\n                var expiration = new Date();\n                expiration.setTime(expiration.getTime() + 1000 * seconds);\n                newCachedDigest.expiration = expiration;\n                self._digests.add(webUrl, newCachedDigest);\n                return newCachedDigest.value;\n            });\n        };\n        DigestCache.prototype.clear = function () {\n            this._digests.clear();\n        };\n        return DigestCache;\n    }());\n    exports.DigestCache = DigestCache;\n});\n\n},{\"../collections/collections\":1,\"../sharepoint/rest/odata\":21,\"../utils/util\":23}],6:[function(require,module,exports){\n(function (global){\n(function (factory) {\n    if (typeof module === 'object' && typeof module.exports === 'object') {\n        var v = factory(require, exports); if (v !== undefined) module.exports = v;\n    }\n    else if (typeof define === 'function' && define.amd) {\n        define([\"require\", \"exports\"], factory);\n    }\n})(function (require, exports) {\n    \"use strict\";\n    var FetchClient = (function () {\n        function FetchClient() {\n        }\n        FetchClient.prototype.fetch = function (url, options) {\n            return global.fetch(url, options);\n        };\n        return FetchClient;\n    }());\n    exports.FetchClient = FetchClient;\n});\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n},{}],7:[function(require,module,exports){\narguments[4][3][0].apply(exports,arguments)\n},{\"../configuration/pnplibconfig\":2,\"../utils/util\":23,\"./SPRequestExecutorClient\":4,\"./digestCache\":5,\"./fetchClient\":6,\"dup\":3}],8:[function(require,module,exports){\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\n(function (factory) {\n    if (typeof module === 'object' && typeof module.exports === 'object') {\n        var v = factory(require, exports); if (v !== undefined) module.exports = v;\n    }\n    else if (typeof define === 'function' && define.amd) {\n        define([\"require\", \"exports\", \"../util\", \"./ObjectHandlerBase\"], factory);\n    }\n})(function (require, exports) {\n    \"use strict\";\n    var util_1 = require(\"../util\");\n    var ObjectHandlerBase_1 = require(\"./ObjectHandlerBase\");\n    var ObjectComposedLook = (function (_super) {\n        __extends(ObjectComposedLook, _super);\n        function ObjectComposedLook() {\n            _super.call(this, \"ComposedLook\");\n        }\n        ObjectComposedLook.prototype.ProvisionObjects = function (object) {\n            var _this = this;\n            _super.prototype.scope_started.call(this);\n            return new Promise(function (resolve, reject) {\n                var clientContext = SP.ClientContext.get_current();\n                var web = clientContext.get_web();\n                var colorPaletteUrl = object.ColorPaletteUrl ? util_1.Util.replaceUrlTokens(object.ColorPaletteUrl) : \"\";\n                var fontSchemeUrl = object.FontSchemeUrl ? util_1.Util.replaceUrlTokens(object.FontSchemeUrl) : \"\";\n                var backgroundImageUrl = object.BackgroundImageUrl ? util_1.Util.replaceUrlTokens(object.BackgroundImageUrl) : null;\n                web.applyTheme(util_1.Util.getRelativeUrl(colorPaletteUrl), util_1.Util.getRelativeUrl(fontSchemeUrl), backgroundImageUrl, true);\n                web.update();\n                clientContext.executeQueryAsync(function () {\n                    _super.prototype.scope_ended.call(_this);\n                    resolve();\n                }, function () {\n                    _super.prototype.scope_ended.call(_this);\n                    resolve();\n                });\n            });\n        };\n        return ObjectComposedLook;\n    }(ObjectHandlerBase_1.ObjectHandlerBase));\n    exports.ObjectComposedLook = ObjectComposedLook;\n});\n\n},{\"../util\":20,\"./ObjectHandlerBase\":12}],9:[function(require,module,exports){\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\n(function (factory) {\n    if (typeof module === 'object' && typeof module.exports === 'object') {\n        var v = factory(require, exports); if (v !== undefined) module.exports = v;\n    }\n    else if (typeof define === 'function' && define.amd) {\n        define([\"require\", \"exports\", \"./ObjectHandlerBase\"], factory);\n    }\n})(function (require, exports) {\n    \"use strict\";\n    var ObjectHandlerBase_1 = require(\"./ObjectHandlerBase\");\n    var ObjectCustomActions = (function (_super) {\n        __extends(ObjectCustomActions, _super);\n        function ObjectCustomActions() {\n            _super.call(this, \"CustomActions\");\n        }\n        ObjectCustomActions.prototype.ProvisionObjects = function (customactions) {\n            var _this = this;\n            _super.prototype.scope_started.call(this);\n            return new Promise(function (resolve, reject) {\n                var clientContext = SP.ClientContext.get_current();\n                var userCustomActions = clientContext.get_web().get_userCustomActions();\n                clientContext.load(userCustomActions);\n                clientContext.executeQueryAsync(function () {\n                    customactions.forEach(function (obj) {\n                        var objExists = userCustomActions.get_data().filter(function (userCustomAction) {\n                            return userCustomAction.get_title() === obj.Title;\n                        }).length > 0;\n                        if (!objExists) {\n                            var objCreationInformation = userCustomActions.add();\n                            if (obj.Description) {\n                                objCreationInformation.set_description(obj.Description);\n                            }\n                            if (obj.CommandUIExtension) {\n                                objCreationInformation.set_commandUIExtension(obj.CommandUIExtension);\n                            }\n                            if (obj.Group) {\n                                objCreationInformation.set_group(obj.Group);\n                            }\n                            if (obj.Title) {\n                                objCreationInformation.set_title(obj.Title);\n                            }\n                            if (obj.Url) {\n                                objCreationInformation.set_url(obj.Url);\n                            }\n                            if (obj.ScriptBlock) {\n                                objCreationInformation.set_scriptBlock(obj.ScriptBlock);\n                            }\n                            if (obj.ScriptSrc) {\n                                objCreationInformation.set_scriptSrc(obj.ScriptSrc);\n                            }\n                            if (obj.Location) {\n                                objCreationInformation.set_location(obj.Location);\n                            }\n                            if (obj.ImageUrl) {\n                                objCreationInformation.set_imageUrl(obj.ImageUrl);\n                            }\n                            if (obj.Name) {\n                                objCreationInformation.set_name(obj.Name);\n                            }\n                            if (obj.RegistrationId) {\n                                objCreationInformation.set_registrationId(obj.RegistrationId);\n                            }\n                            if (obj.RegistrationType) {\n                                objCreationInformation.set_registrationType(obj.RegistrationType);\n                            }\n                            if (obj.Rights) {\n                                objCreationInformation.set_rights(obj.Rights);\n                            }\n                            if (obj.Sequence) {\n                                objCreationInformation.set_sequence(obj.Sequence);\n                            }\n                            objCreationInformation.update();\n                        }\n                    });\n                    clientContext.executeQueryAsync(function () {\n                        _super.prototype.scope_ended.call(_this);\n                        resolve();\n                    }, function () {\n                        _super.prototype.scope_ended.call(_this);\n                        resolve();\n                    });\n                }, function () {\n                    _super.prototype.scope_ended.call(_this);\n                    resolve();\n                });\n            });\n        };\n        return ObjectCustomActions;\n    }(ObjectHandlerBase_1.ObjectHandlerBase));\n    exports.ObjectCustomActions = ObjectCustomActions;\n});\n\n},{\"./ObjectHandlerBase\":12}],10:[function(require,module,exports){\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\n(function (factory) {\n    if (typeof module === 'object' && typeof module.exports === 'object') {\n        var v = factory(require, exports); if (v !== undefined) module.exports = v;\n    }\n    else if (typeof define === 'function' && define.amd) {\n        define([\"require\", \"exports\", \"./ObjectHandlerBase\"], factory);\n    }\n})(function (require, exports) {\n    \"use strict\";\n    var ObjectHandlerBase_1 = require(\"./ObjectHandlerBase\");\n    var ObjectFeatures = (function (_super) {\n        __extends(ObjectFeatures, _super);\n        function ObjectFeatures() {\n            _super.call(this, \"Features\");\n        }\n        ObjectFeatures.prototype.ProvisionObjects = function (features) {\n            var _this = this;\n            _super.prototype.scope_started.call(this);\n            return new Promise(function (resolve, reject) {\n                var clientContext = SP.ClientContext.get_current();\n                var web = clientContext.get_web();\n                var webFeatures = web.get_features();\n                features.forEach(function (f) {\n                    if (f.Deactivate === true) {\n                        webFeatures.remove(new SP.Guid(f.ID), true);\n                    }\n                    else {\n                        webFeatures.add(new SP.Guid(f.ID), true, SP.FeatureDefinitionScope.none);\n                    }\n                });\n                web.update();\n                clientContext.load(webFeatures);\n                clientContext.executeQueryAsync(function () {\n                    _super.prototype.scope_ended.call(_this);\n                    resolve();\n                }, function () {\n                    _super.prototype.scope_ended.call(_this);\n                    resolve();\n                });\n            });\n        };\n        return ObjectFeatures;\n    }(ObjectHandlerBase_1.ObjectHandlerBase));\n    exports.ObjectFeatures = ObjectFeatures;\n});\n\n},{\"./ObjectHandlerBase\":12}],11:[function(require,module,exports){\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\n(function (factory) {\n    if (typeof module === 'object' && typeof module.exports === 'object') {\n        var v = factory(require, exports); if (v !== undefined) module.exports = v;\n    }\n    else if (typeof define === 'function' && define.amd) {\n        define([\"require\", \"exports\", \"../../../utils/util\", \"../util\", \"./ObjectHandlerBase\"], factory);\n    }\n})(function (require, exports) {\n    \"use strict\";\n    var CoreUtil = require(\"../../../utils/util\");\n    var util_1 = require(\"../util\");\n    var ObjectHandlerBase_1 = require(\"./ObjectHandlerBase\");\n    var ObjectFiles = (function (_super) {\n        __extends(ObjectFiles, _super);\n        function ObjectFiles() {\n            _super.call(this, \"Files\");\n        }\n        ObjectFiles.prototype.ProvisionObjects = function (objects) {\n            var _this = this;\n            _super.prototype.scope_started.call(this);\n            return new Promise(function (resolve, reject) {\n                var clientContext = SP.ClientContext.get_current();\n                var web = clientContext.get_web();\n                var fileInfos = [];\n                var promises = [];\n                objects.forEach(function (obj, index) {\n                    promises.push(_this.httpClient.fetchRaw(util_1.Util.replaceUrlTokens(obj.Src)).then(function (response) {\n                        return response.text();\n                    }));\n                });\n                Promise.all(promises).then(function (responses) {\n                    responses.forEach(function (response, index) {\n                        var obj = objects[index];\n                        var filename = _this.GetFilenameFromFilePath(obj.Dest);\n                        var webServerRelativeUrl = _spPageContextInfo.webServerRelativeUrl;\n                        var folder = web.getFolderByServerRelativeUrl(webServerRelativeUrl + \"/\" + _this.GetFolderFromFilePath(obj.Dest));\n                        var fi = {\n                            Contents: response,\n                            Dest: obj.Dest,\n                            Filename: filename,\n                            Folder: folder,\n                            Instance: null,\n                            Overwrite: false,\n                            Properties: [],\n                            RemoveExistingWebParts: true,\n                            ServerRelativeUrl: obj.Dest,\n                            Src: obj.Src,\n                            Views: [],\n                            WebParts: [],\n                        };\n                        CoreUtil.Util.extend(fi, obj);\n                        if (fi.Filename.indexOf(\"Form.aspx\") !== -1) {\n                            return;\n                        }\n                        var objCreationInformation = new SP.FileCreationInformation();\n                        objCreationInformation.set_overwrite(fi.Overwrite);\n                        objCreationInformation.set_url(fi.Filename);\n                        objCreationInformation.set_content(new SP.Base64EncodedByteArray());\n                        for (var i = 0; i < fi.Contents.length; i++) {\n                            objCreationInformation.get_content().append(fi.Contents.charCodeAt(i));\n                        }\n                        clientContext.load(fi.Folder.get_files().add(objCreationInformation));\n                        fileInfos.push(fi);\n                    });\n                });\n                clientContext.executeQueryAsync(function () {\n                    promises = [];\n                    fileInfos.forEach(function (fi) {\n                        if (fi.Properties && Object.keys(fi.Properties).length > 0) {\n                            promises.push(_this.ApplyFileProperties(fi.Dest, fi.Properties));\n                        }\n                        if (fi.WebParts && fi.WebParts.length > 0) {\n                            promises.push(_this.AddWebPartsToWebPartPage(fi.Dest, fi.Src, fi.WebParts, fi.RemoveExistingWebParts));\n                        }\n                    });\n                    Promise.all(promises).then(function () {\n                        _this.ModifyHiddenViews(objects).then(function (value) {\n                            _super.prototype.scope_ended.call(_this);\n                            resolve(value);\n                        }, function (error) {\n                            _super.prototype.scope_ended.call(_this);\n                            reject(error);\n                        });\n                    });\n                }, function (error) {\n                    _super.prototype.scope_ended.call(_this);\n                    reject(error);\n                });\n            });\n        };\n        ObjectFiles.prototype.RemoveWebPartsFromFileIfSpecified = function (clientContext, limitedWebPartManager, shouldRemoveExisting) {\n            return new Promise(function (resolve, reject) {\n                if (!shouldRemoveExisting) {\n                    resolve();\n                }\n                var existingWebParts = limitedWebPartManager.get_webParts();\n                clientContext.load(existingWebParts);\n                clientContext.executeQueryAsync(function () {\n                    existingWebParts.get_data().forEach(function (wp) {\n                        wp.deleteWebPart();\n                    });\n                    clientContext.load(existingWebParts);\n                    clientContext.executeQueryAsync(resolve, reject);\n                }, reject);\n            });\n        };\n        ObjectFiles.prototype.GetWebPartXml = function (webParts) {\n            var _this = this;\n            return new Promise(function (resolve, reject) {\n                var promises = [];\n                webParts.forEach(function (wp, index) {\n                    if (wp.Contents.FileUrl) {\n                        var fileUrl = util_1.Util.replaceUrlTokens(wp.Contents.FileUrl);\n                        promises.push(_this.httpClient.fetchRaw(fileUrl).then(function (response) {\n                            return response.text();\n                        }));\n                    }\n                    else {\n                        promises.push((function () {\n                            return new Promise(function (res, rej) {\n                                res();\n                            });\n                        })());\n                    }\n                });\n                Promise.all(promises).then(function (responses) {\n                    responses.forEach(function (response, index) {\n                        var wp = webParts[index];\n                        if (wp !== null && response && response.length > 0) {\n                            wp.Contents.Xml = response;\n                        }\n                    });\n                    resolve(webParts);\n                });\n            });\n        };\n        ObjectFiles.prototype.AddWebPartsToWebPartPage = function (dest, src, webParts, shouldRemoveExisting) {\n            var _this = this;\n            return new Promise(function (resolve, reject) {\n                var clientContext = SP.ClientContext.get_current();\n                var web = clientContext.get_web();\n                var fileServerRelativeUrl = _spPageContextInfo.webServerRelativeUrl + \"/\" + dest;\n                var file = web.getFileByServerRelativeUrl(fileServerRelativeUrl);\n                clientContext.load(file);\n                clientContext.executeQueryAsync(function () {\n                    var limitedWebPartManager = file.getLimitedWebPartManager(SP.WebParts.PersonalizationScope.shared);\n                    _this.RemoveWebPartsFromFileIfSpecified(clientContext, limitedWebPartManager, shouldRemoveExisting).then(function () {\n                        _this.GetWebPartXml(webParts).then(function (webPartsWithXml) {\n                            webPartsWithXml.forEach(function (wp) {\n                                if (!wp.Contents.Xml) {\n                                    return;\n                                }\n                                var oWebPartDefinition = limitedWebPartManager.importWebPart(util_1.Util.replaceUrlTokens(wp.Contents.Xml));\n                                var oWebPart = oWebPartDefinition.get_webPart();\n                                limitedWebPartManager.addWebPart(oWebPart, wp.Zone, wp.Order);\n                            });\n                            clientContext.executeQueryAsync(resolve, resolve);\n                        });\n                    });\n                }, resolve);\n            });\n        };\n        ObjectFiles.prototype.ApplyFileProperties = function (dest, fileProperties) {\n            return new Promise(function (resolve, reject) {\n                var clientContext = SP.ClientContext.get_current();\n                var web = clientContext.get_web();\n                var fileServerRelativeUrl = _spPageContextInfo.webServerRelativeUrl + \"/\" + dest;\n                var file = web.getFileByServerRelativeUrl(fileServerRelativeUrl);\n                var listItemAllFields = file.get_listItemAllFields();\n                Object.keys(fileProperties).forEach(function (key) {\n                    listItemAllFields.set_item(key, fileProperties[key]);\n                });\n                listItemAllFields.update();\n                clientContext.executeQueryAsync(resolve, resolve);\n            });\n        };\n        ObjectFiles.prototype.GetViewFromCollectionByUrl = function (viewCollection, url) {\n            var serverRelativeUrl = _spPageContextInfo.webServerRelativeUrl + \"/\" + url;\n            var viewCollectionEnumerator = viewCollection.getEnumerator();\n            while (viewCollectionEnumerator.moveNext()) {\n                var view = viewCollectionEnumerator.get_current();\n                if (view.get_serverRelativeUrl().toString().toLowerCase() === serverRelativeUrl.toLowerCase()) {\n                    return view;\n                }\n            }\n            return null;\n        };\n        ObjectFiles.prototype.ModifyHiddenViews = function (objects) {\n            var _this = this;\n            return new Promise(function (resolve, reject) {\n                var clientContext = SP.ClientContext.get_current();\n                var web = clientContext.get_web();\n                var mapping = {};\n                var lists = [];\n                var listViewCollections = [];\n                objects.forEach(function (obj) {\n                    if (!obj.Views) {\n                        return;\n                    }\n                    obj.Views.forEach(function (v) {\n                        mapping[v.List] = mapping[v.List] || [];\n                        mapping[v.List].push(CoreUtil.Util.extend(v, { \"Url\": obj.Dest }));\n                    });\n                });\n                Object.keys(mapping).forEach(function (l, index) {\n                    lists.push(web.get_lists().getByTitle(l));\n                    listViewCollections.push(web.get_lists().getByTitle(l).get_views());\n                    clientContext.load(lists[index]);\n                    clientContext.load(listViewCollections[index]);\n                });\n                clientContext.executeQueryAsync(function () {\n                    Object.keys(mapping).forEach(function (l, index) {\n                        var views = mapping[l];\n                        var list = lists[index];\n                        var viewCollection = listViewCollections[index];\n                        views.forEach(function (v) {\n                            var view = _this.GetViewFromCollectionByUrl(viewCollection, v.Url);\n                            if (view == null) {\n                                return;\n                            }\n                            if (v.Paged) {\n                                view.set_paged(v.Paged);\n                            }\n                            if (v.Query) {\n                                view.set_viewQuery(v.Query);\n                            }\n                            if (v.RowLimit) {\n                                view.set_rowLimit(v.RowLimit);\n                            }\n                            if (v.ViewFields && v.ViewFields.length > 0) {\n                                var columns_1 = view.get_viewFields();\n                                columns_1.removeAll();\n                                v.ViewFields.forEach(function (vf) {\n                                    columns_1.add(vf);\n                                });\n                            }\n                            view.update();\n                        });\n                        clientContext.load(viewCollection);\n                        list.update();\n                    });\n                    clientContext.executeQueryAsync(resolve, resolve);\n                }, resolve);\n            });\n        };\n        ObjectFiles.prototype.GetFolderFromFilePath = function (filePath) {\n            var split = filePath.split(\"/\");\n            return split.splice(0, split.length - 1).join(\"/\");\n        };\n        ObjectFiles.prototype.GetFilenameFromFilePath = function (filePath) {\n            var split = filePath.split(\"/\");\n            return split[split.length - 1];\n        };\n        return ObjectFiles;\n    }(ObjectHandlerBase_1.ObjectHandlerBase));\n    exports.ObjectFiles = ObjectFiles;\n    ;\n});\n\n},{\"../../../utils/util\":23,\"../util\":20,\"./ObjectHandlerBase\":12}],12:[function(require,module,exports){\n(function (factory) {\n    if (typeof module === 'object' && typeof module.exports === 'object') {\n        var v = factory(require, exports); if (v !== undefined) module.exports = v;\n    }\n    else if (typeof define === 'function' && define.amd) {\n        define([\"require\", \"exports\", \"../../../net/HttpClient\", \"../../../utils/logging\"], factory);\n    }\n})(function (require, exports) {\n    \"use strict\";\n    var HttpClient_1 = require(\"../../../net/HttpClient\");\n    var logging_1 = require(\"../../../utils/logging\");\n    var ObjectHandlerBase = (function () {\n        function ObjectHandlerBase(name) {\n            this.name = name;\n            this.httpClient = new HttpClient_1.HttpClient();\n        }\n        ObjectHandlerBase.prototype.ProvisionObjects = function (objects, parameters) {\n            return new Promise(function (resolve, reject) { resolve(\"Not implemented.\"); });\n        };\n        ObjectHandlerBase.prototype.scope_started = function () {\n            logging_1.Logger.write(this.name + \": Code execution scope started\");\n        };\n        ObjectHandlerBase.prototype.scope_ended = function () {\n            logging_1.Logger.write(this.name + \": Code execution scope stopped\");\n        };\n        return ObjectHandlerBase;\n    }());\n    exports.ObjectHandlerBase = ObjectHandlerBase;\n});\n\n},{\"../../../net/HttpClient\":3,\"../../../utils/logging\":22}],13:[function(require,module,exports){\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\n(function (factory) {\n    if (typeof module === 'object' && typeof module.exports === 'object') {\n        var v = factory(require, exports); if (v !== undefined) module.exports = v;\n    }\n    else if (typeof define === 'function' && define.amd) {\n        define([\"require\", \"exports\", \"../Sequencer/Sequencer\", \"./ObjectHandlerBase\"], factory);\n    }\n})(function (require, exports) {\n    \"use strict\";\n    var Sequencer_1 = require(\"../Sequencer/Sequencer\");\n    var ObjectHandlerBase_1 = require(\"./ObjectHandlerBase\");\n    var ObjectLists = (function (_super) {\n        __extends(ObjectLists, _super);\n        function ObjectLists() {\n            _super.call(this, \"Lists\");\n        }\n        ObjectLists.prototype.ProvisionObjects = function (objects) {\n            var _this = this;\n            _super.prototype.scope_started.call(this);\n            return new Promise(function (resolve, reject) {\n                var clientContext = SP.ClientContext.get_current();\n                var lists = clientContext.get_web().get_lists();\n                var listInstances = [];\n                clientContext.load(lists);\n                clientContext.executeQueryAsync(function () {\n                    objects.forEach(function (obj, index) {\n                        var existingObj = lists.get_data().filter(function (list) {\n                            return list.get_title() === obj.Title;\n                        })[0];\n                        if (existingObj) {\n                            if (obj.Description) {\n                                existingObj.set_description(obj.Description);\n                            }\n                            if (obj.EnableVersioning !== undefined) {\n                                existingObj.set_enableVersioning(obj.EnableVersioning);\n                            }\n                            if (obj.EnableMinorVersions !== undefined) {\n                                existingObj.set_enableMinorVersions(obj.EnableMinorVersions);\n                            }\n                            if (obj.EnableModeration !== undefined) {\n                                existingObj.set_enableModeration(obj.EnableModeration);\n                            }\n                            if (obj.EnableFolderCreation !== undefined) {\n                                existingObj.set_enableFolderCreation(obj.EnableFolderCreation);\n                            }\n                            if (obj.EnableAttachments !== undefined) {\n                                existingObj.set_enableAttachments(obj.EnableAttachments);\n                            }\n                            if (obj.NoCrawl !== undefined) {\n                                existingObj.set_noCrawl(obj.NoCrawl);\n                            }\n                            if (obj.DefaultDisplayFormUrl) {\n                                existingObj.set_defaultDisplayFormUrl(obj.DefaultDisplayFormUrl);\n                            }\n                            if (obj.DefaultEditFormUrl) {\n                                existingObj.set_defaultEditFormUrl(obj.DefaultEditFormUrl);\n                            }\n                            if (obj.DefaultNewFormUrl) {\n                                existingObj.set_defaultNewFormUrl(obj.DefaultNewFormUrl);\n                            }\n                            if (obj.DraftVersionVisibility) {\n                                existingObj.set_draftVersionVisibility(SP.DraftVisibilityType[obj.DraftVersionVisibility]);\n                            }\n                            if (obj.ImageUrl) {\n                                existingObj.set_imageUrl(obj.ImageUrl);\n                            }\n                            if (obj.Hidden !== undefined) {\n                                existingObj.set_hidden(obj.Hidden);\n                            }\n                            if (obj.ForceCheckout !== undefined) {\n                                existingObj.set_forceCheckout(obj.ForceCheckout);\n                            }\n                            existingObj.update();\n                            listInstances.push(existingObj);\n                            clientContext.load(listInstances[index]);\n                        }\n                        else {\n                            var objCreationInformation = new SP.ListCreationInformation();\n                            if (obj.Description) {\n                                objCreationInformation.set_description(obj.Description);\n                            }\n                            if (obj.OnQuickLaunch !== undefined) {\n                                var value = obj.OnQuickLaunch ? SP.QuickLaunchOptions.on : SP.QuickLaunchOptions.off;\n                                objCreationInformation.set_quickLaunchOption(value);\n                            }\n                            if (obj.TemplateType) {\n                                objCreationInformation.set_templateType(obj.TemplateType);\n                            }\n                            if (obj.Title) {\n                                objCreationInformation.set_title(obj.Title);\n                            }\n                            if (obj.Url) {\n                                objCreationInformation.set_url(obj.Url);\n                            }\n                            var createdList = lists.add(objCreationInformation);\n                            if (obj.EnableVersioning !== undefined) {\n                                createdList.set_enableVersioning(obj.EnableVersioning);\n                            }\n                            if (obj.EnableMinorVersions !== undefined) {\n                                createdList.set_enableMinorVersions(obj.EnableMinorVersions);\n                            }\n                            if (obj.EnableModeration !== undefined) {\n                                createdList.set_enableModeration(obj.EnableModeration);\n                            }\n                            if (obj.EnableFolderCreation !== undefined) {\n                                createdList.set_enableFolderCreation(obj.EnableFolderCreation);\n                            }\n                            if (obj.EnableAttachments !== undefined) {\n                                createdList.set_enableAttachments(obj.EnableAttachments);\n                            }\n                            if (obj.NoCrawl !== undefined) {\n                                createdList.set_noCrawl(obj.NoCrawl);\n                            }\n                            if (obj.DefaultDisplayFormUrl) {\n                                createdList.set_defaultDisplayFormUrl(obj.DefaultDisplayFormUrl);\n                            }\n                            if (obj.DefaultEditFormUrl) {\n                                createdList.set_defaultEditFormUrl(obj.DefaultEditFormUrl);\n                            }\n                            if (obj.DefaultNewFormUrl) {\n                                createdList.set_defaultNewFormUrl(obj.DefaultNewFormUrl);\n                            }\n                            if (obj.DraftVersionVisibility) {\n                                var value = SP.DraftVisibilityType[obj.DraftVersionVisibility.toLocaleLowerCase()];\n                                createdList.set_draftVersionVisibility(value);\n                            }\n                            if (obj.ImageUrl) {\n                                createdList.set_imageUrl(obj.ImageUrl);\n                            }\n                            if (obj.Hidden !== undefined) {\n                                createdList.set_hidden(obj.Hidden);\n                            }\n                            if (obj.ForceCheckout !== undefined) {\n                                createdList.set_forceCheckout(obj.ForceCheckout);\n                            }\n                            listInstances.push(createdList);\n                            clientContext.load(listInstances[index]);\n                        }\n                    });\n                    clientContext.executeQueryAsync(function () {\n                        var sequencer = new Sequencer_1.Sequencer([\n                            _this.ApplyContentTypeBindings,\n                            _this.ApplyListInstanceFieldRefs,\n                            _this.ApplyFields,\n                            _this.ApplyLookupFields,\n                            _this.ApplyListSecurity,\n                            _this.CreateViews,\n                            _this.InsertDataRows,\n                            _this.CreateFolders,\n                        ], { ClientContext: clientContext, ListInstances: listInstances, Objects: objects }, _this);\n                        sequencer.execute().then(function () {\n                            _super.prototype.scope_ended.call(_this);\n                            resolve();\n                        });\n                    }, function () {\n                        _super.prototype.scope_ended.call(_this);\n                        resolve();\n                    });\n                }, function () {\n                    _super.prototype.scope_ended.call(_this);\n                    resolve();\n                });\n            });\n        };\n        ObjectLists.prototype.EnsureLocationBasedMetadataDefaultsReceiver = function (clientContext, list) {\n            var eventReceivers = list.get_eventReceivers();\n            var eventRecCreationInfo = new SP.EventReceiverDefinitionCreationInformation();\n            eventRecCreationInfo.set_receiverName(\"LocationBasedMetadataDefaultsReceiver ItemAdded\");\n            eventRecCreationInfo.set_synchronization(1);\n            eventRecCreationInfo.set_sequenceNumber(1000);\n            eventRecCreationInfo.set_receiverAssembly(\"Microsoft.Office.DocumentManagement, Version=15.0.0.0, Culture=neutral, \" +\n                \"PublicKeyToken=71e9bce111e9429c\");\n            eventRecCreationInfo.set_receiverClass(\"Microsoft.Office.DocumentManagement.LocationBasedMetadataDefaultsReceiver\");\n            eventRecCreationInfo.set_eventType(SP.EventReceiverType.itemAdded);\n            eventReceivers.add(eventRecCreationInfo);\n            list.update();\n        };\n        ObjectLists.prototype.CreateFolders = function (params) {\n            var _this = this;\n            return new Promise(function (resolve, reject) {\n                params.ListInstances.forEach(function (l, index) {\n                    var obj = params.Objects[index];\n                    if (!obj.Folders) {\n                        return;\n                    }\n                    var folderServerRelativeUrl = _spPageContextInfo.webServerRelativeUrl + \"/\" + obj.Url;\n                    var rootFolder = l.get_rootFolder();\n                    var metadataDefaults = \"<MetadataDefaults>\";\n                    var setMetadataDefaults = false;\n                    obj.Folders.forEach(function (f) {\n                        var folderUrl = folderServerRelativeUrl + \"/\" + f.Name;\n                        rootFolder.get_folders().add(folderUrl);\n                        if (f.DefaultValues) {\n                            var keys = Object.keys(f.DefaultValues).length;\n                            if (keys > 0) {\n                                metadataDefaults += \"<a href='\" + folderUrl + \"'>\";\n                                Object.keys(f.DefaultValues).forEach(function (key) {\n                                    metadataDefaults += \"<DefaultValue FieldName=\\\"\" + key + \"\\\">\" + f.DefaultValues[key] + \"</DefaultValue>\";\n                                });\n                                metadataDefaults += \"</a>\";\n                            }\n                            setMetadataDefaults = true;\n                        }\n                    });\n                    metadataDefaults += \"</MetadataDefaults>\";\n                    if (setMetadataDefaults) {\n                        var metadataDefaultsFileCreateInfo = new SP.FileCreationInformation();\n                        metadataDefaultsFileCreateInfo.set_url(folderServerRelativeUrl + \"/Forms/client_LocationBasedDefaults.html\");\n                        metadataDefaultsFileCreateInfo.set_content(new SP.Base64EncodedByteArray());\n                        metadataDefaultsFileCreateInfo.set_overwrite(true);\n                        for (var i = 0; i < metadataDefaults.length; i++) {\n                            metadataDefaultsFileCreateInfo.get_content().append(metadataDefaults.charCodeAt(i));\n                        }\n                        rootFolder.get_files().add(metadataDefaultsFileCreateInfo);\n                        _this.EnsureLocationBasedMetadataDefaultsReceiver(params.ClientContext, l);\n                    }\n                });\n                params.ClientContext.executeQueryAsync(resolve, resolve);\n            });\n        };\n        ObjectLists.prototype.ApplyContentTypeBindings = function (params) {\n            return new Promise(function (resolve, reject) {\n                var webCts = params.ClientContext.get_site().get_rootWeb().get_contentTypes();\n                var listCts = [];\n                params.ListInstances.forEach(function (l, index) {\n                    listCts.push(l.get_contentTypes());\n                    params.ClientContext.load(listCts[index], \"Include(Name,Id)\");\n                    if (params.Objects[index].ContentTypeBindings) {\n                        l.set_contentTypesEnabled(true);\n                        l.update();\n                    }\n                });\n                params.ClientContext.load(webCts);\n                params.ClientContext.executeQueryAsync(function () {\n                    params.ListInstances.forEach(function (list, index) {\n                        var obj = params.Objects[index];\n                        if (!obj.ContentTypeBindings) {\n                            return;\n                        }\n                        var listContentTypes = listCts[index];\n                        var existingContentTypes = new Array();\n                        if (obj.RemoveExistingContentTypes && obj.ContentTypeBindings.length > 0) {\n                            listContentTypes.get_data().forEach(function (ct) {\n                                existingContentTypes.push(ct);\n                            });\n                        }\n                        obj.ContentTypeBindings.forEach(function (ctb) {\n                            listContentTypes.addExistingContentType(webCts.getById(ctb.ContentTypeId));\n                        });\n                        if (obj.RemoveExistingContentTypes && obj.ContentTypeBindings.length > 0) {\n                            for (var j = 0; j < existingContentTypes.length; j++) {\n                                var ect = existingContentTypes[j];\n                                ect.deleteObject();\n                            }\n                        }\n                        list.update();\n                    });\n                    params.ClientContext.executeQueryAsync(resolve, resolve);\n                }, resolve);\n            });\n        };\n        ObjectLists.prototype.ApplyListInstanceFieldRefs = function (params) {\n            return new Promise(function (resolve, reject) {\n                var siteFields = params.ClientContext.get_site().get_rootWeb().get_fields();\n                params.ListInstances.forEach(function (l, index) {\n                    var obj = params.Objects[index];\n                    if (obj.FieldRefs) {\n                        obj.FieldRefs.forEach(function (fr) {\n                            var field = siteFields.getByInternalNameOrTitle(fr.Name);\n                            l.get_fields().add(field);\n                        });\n                        l.update();\n                    }\n                });\n                params.ClientContext.executeQueryAsync(resolve, resolve);\n            });\n        };\n        ObjectLists.prototype.ApplyFields = function (params) {\n            var _this = this;\n            return new Promise(function (resolve, reject) {\n                params.ListInstances.forEach(function (l, index) {\n                    var obj = params.Objects[index];\n                    if (obj.Fields) {\n                        obj.Fields.forEach(function (f) {\n                            var fieldXml = _this.GetFieldXml(f, params.ListInstances, l);\n                            var fieldType = _this.GetFieldXmlAttr(fieldXml, \"Type\");\n                            if (fieldType !== \"Lookup\" && fieldType !== \"LookupMulti\") {\n                                l.get_fields().addFieldAsXml(fieldXml, true, SP.AddFieldOptions.addToAllContentTypes);\n                            }\n                        });\n                        l.update();\n                    }\n                });\n                params.ClientContext.executeQueryAsync(resolve, resolve);\n            });\n        };\n        ObjectLists.prototype.ApplyLookupFields = function (params) {\n            var _this = this;\n            return new Promise(function (resolve, reject) {\n                params.ListInstances.forEach(function (l, index) {\n                    var obj = params.Objects[index];\n                    if (obj.Fields) {\n                        obj.Fields.forEach(function (f) {\n                            var fieldXml = _this.GetFieldXml(f, params.ListInstances, l);\n                            if (!fieldXml) {\n                                return;\n                            }\n                            var fieldType = _this.GetFieldXmlAttr(fieldXml, \"Type\");\n                            if (fieldType === \"Lookup\" || fieldType === \"LookupMulti\") {\n                                l.get_fields().addFieldAsXml(fieldXml, true, SP.AddFieldOptions.addToAllContentTypes);\n                            }\n                        });\n                        l.update();\n                    }\n                });\n                params.ClientContext.executeQueryAsync(resolve, resolve);\n            });\n        };\n        ObjectLists.prototype.GetFieldXmlAttr = function (fieldXml, attr) {\n            var regex = new RegExp(attr + '=[\\'|\\\"](?:(.+?))[\\'|\\\"]');\n            var match = regex.exec(fieldXml);\n            return match[1];\n        };\n        ObjectLists.prototype.GetFieldXml = function (field, lists, list) {\n            var fieldXml = \"\";\n            if (!field.SchemaXml) {\n                var properties_1 = [];\n                Object.keys(field).forEach(function (prop) {\n                    var value = field[prop];\n                    if (prop === \"List\") {\n                        var targetList = lists.filter(function (v) {\n                            return v.get_title() === value;\n                        });\n                        if (targetList.length > 0) {\n                            value = \"{\" + targetList[0].get_id().toString() + \"}\";\n                        }\n                        else {\n                            return null;\n                        }\n                        properties_1.push(prop + \"=\\\"\" + value + \"\\\"\");\n                    }\n                });\n                fieldXml = \"<Field \" + properties_1.join(\" \") + \">\";\n                if (field.Type === \"Calculated\") {\n                    fieldXml += \"<Formula>\" + field.Formula + \"</Formula>\";\n                }\n                fieldXml += \"</Field>\";\n            }\n            return fieldXml;\n        };\n        ObjectLists.prototype.ApplyListSecurity = function (params) {\n            return new Promise(function (resolve, reject) {\n                params.ListInstances.forEach(function (l, index) {\n                    var obj = params.Objects[index];\n                    if (!obj.Security) {\n                        return;\n                    }\n                    if (obj.Security.BreakRoleInheritance) {\n                        l.breakRoleInheritance(obj.Security.CopyRoleAssignments, obj.Security.ClearSubscopes);\n                        l.update();\n                        params.ClientContext.load(l.get_roleAssignments());\n                    }\n                });\n                var web = params.ClientContext.get_web();\n                var allProperties = web.get_allProperties();\n                var siteGroups = web.get_siteGroups();\n                var roleDefinitions = web.get_roleDefinitions();\n                params.ClientContext.load(allProperties);\n                params.ClientContext.load(roleDefinitions);\n                params.ClientContext.executeQueryAsync(function () {\n                    params.ListInstances.forEach(function (l, index) {\n                        var obj = params.Objects[index];\n                        if (!obj.Security) {\n                            return;\n                        }\n                        obj.Security.RoleAssignments.forEach(function (ra) {\n                            var roleDef = null;\n                            if (typeof ra.RoleDefinition === \"number\") {\n                                roleDef = roleDefinitions.getById(ra.RoleDefinition);\n                            }\n                            else {\n                                roleDef = roleDefinitions.getByName(ra.RoleDefinition);\n                            }\n                            var roleBindings = SP.RoleDefinitionBindingCollection.newObject(params.ClientContext);\n                            roleBindings.add(roleDef);\n                            var principal = null;\n                            if (ra.Principal.match(/\\{[A-Za-z]*\\}+/g)) {\n                                var token = ra.Principal.substring(1, ra.Principal.length - 1);\n                                var groupId = allProperties.get_fieldValues()[(\"vti_\" + token)];\n                                principal = siteGroups.getById(groupId);\n                            }\n                            else {\n                                principal = siteGroups.getByName(principal);\n                            }\n                            l.get_roleAssignments().add(principal, roleBindings);\n                        });\n                        l.update();\n                    });\n                    params.ClientContext.executeQueryAsync(resolve, resolve);\n                }, resolve);\n            });\n        };\n        ObjectLists.prototype.CreateViews = function (params) {\n            return new Promise(function (resolve, reject) {\n                var listViewCollections = [];\n                params.ListInstances.forEach(function (l, index) {\n                    listViewCollections.push(l.get_views());\n                    params.ClientContext.load(listViewCollections[index]);\n                });\n                params.ClientContext.executeQueryAsync(function () {\n                    params.ListInstances.forEach(function (l, index) {\n                        var obj = params.Objects[index];\n                        if (!obj.Views) {\n                            return;\n                        }\n                        listViewCollections.push(l.get_views());\n                        params.ClientContext.load(listViewCollections[index]);\n                        obj.Views.forEach(function (v) {\n                            var viewExists = listViewCollections[index].get_data().filter(function (ev) {\n                                if (obj.RemoveExistingViews && obj.Views.length > 0) {\n                                    ev.deleteObject();\n                                    return false;\n                                }\n                                return ev.get_title() === v.Title;\n                            }).length > 0;\n                            if (viewExists) {\n                                var view = listViewCollections[index].getByTitle(v.Title);\n                                if (v.Paged) {\n                                    view.set_paged(v.Paged);\n                                }\n                                if (v.Query) {\n                                    view.set_viewQuery(v.Query);\n                                }\n                                if (v.RowLimit) {\n                                    view.set_rowLimit(v.RowLimit);\n                                }\n                                if (v.ViewFields && v.ViewFields.length > 0) {\n                                    var columns_1 = view.get_viewFields();\n                                    columns_1.removeAll();\n                                    v.ViewFields.forEach(function (vf) {\n                                        columns_1.add(vf);\n                                    });\n                                }\n                                if (v.Scope) {\n                                    view.set_scope(v.Scope);\n                                }\n                                view.update();\n                            }\n                            else {\n                                var viewCreationInformation = new SP.ViewCreationInformation();\n                                if (v.Title) {\n                                    viewCreationInformation.set_title(v.Title);\n                                }\n                                if (v.PersonalView) {\n                                    viewCreationInformation.set_personalView(v.PersonalView);\n                                }\n                                if (v.Paged) {\n                                    viewCreationInformation.set_paged(v.Paged);\n                                }\n                                if (v.Query) {\n                                    viewCreationInformation.set_query(v.Query);\n                                }\n                                if (v.RowLimit) {\n                                    viewCreationInformation.set_rowLimit(v.RowLimit);\n                                }\n                                if (v.SetAsDefaultView) {\n                                    viewCreationInformation.set_setAsDefaultView(v.SetAsDefaultView);\n                                }\n                                if (v.ViewFields) {\n                                    viewCreationInformation.set_viewFields(v.ViewFields);\n                                }\n                                if (v.ViewTypeKind) {\n                                    viewCreationInformation.set_viewTypeKind(SP.ViewType.html);\n                                }\n                                var view = l.get_views().add(viewCreationInformation);\n                                if (v.Scope) {\n                                    view.set_scope(v.Scope);\n                                    view.update();\n                                }\n                                l.update();\n                            }\n                            params.ClientContext.load(l.get_views());\n                        });\n                    });\n                    params.ClientContext.executeQueryAsync(resolve, resolve);\n                }, resolve);\n            });\n        };\n        ObjectLists.prototype.InsertDataRows = function (params) {\n            return new Promise(function (resolve, reject) {\n                params.ListInstances.forEach(function (l, index) {\n                    var obj = params.Objects[index];\n                    if (obj.DataRows) {\n                        obj.DataRows.forEach(function (r) {\n                            var item = l.addItem(new SP.ListItemCreationInformation());\n                            Object.keys(r).forEach(function (key) {\n                                item.set_item(key, r[key]);\n                            });\n                            item.update();\n                            params.ClientContext.load(item);\n                        });\n                    }\n                });\n                params.ClientContext.executeQueryAsync(resolve, resolve);\n            });\n        };\n        return ObjectLists;\n    }(ObjectHandlerBase_1.ObjectHandlerBase));\n    exports.ObjectLists = ObjectLists;\n});\n\n},{\"../Sequencer/Sequencer\":18,\"./ObjectHandlerBase\":12}],14:[function(require,module,exports){\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\n(function (factory) {\n    if (typeof module === 'object' && typeof module.exports === 'object') {\n        var v = factory(require, exports); if (v !== undefined) module.exports = v;\n    }\n    else if (typeof define === 'function' && define.amd) {\n        define([\"require\", \"exports\", \"../util\", \"./ObjectHandlerBase\"], factory);\n    }\n})(function (require, exports) {\n    \"use strict\";\n    var util_1 = require(\"../util\");\n    var ObjectHandlerBase_1 = require(\"./ObjectHandlerBase\");\n    var ObjectNavigation = (function (_super) {\n        __extends(ObjectNavigation, _super);\n        function ObjectNavigation() {\n            _super.call(this, \"Navigation\");\n        }\n        ObjectNavigation.prototype.ProvisionObjects = function (object) {\n            var _this = this;\n            _super.prototype.scope_started.call(this);\n            var clientContext = SP.ClientContext.get_current();\n            var navigation = clientContext.get_web().get_navigation();\n            return new Promise(function (resolve, reject) {\n                _this.ConfigureQuickLaunch(object.QuickLaunch, clientContext, _this.httpClient, navigation).then(function () {\n                    _super.prototype.scope_ended.call(_this);\n                    resolve();\n                }, function () {\n                    _super.prototype.scope_ended.call(_this);\n                    reject();\n                });\n            });\n        };\n        ObjectNavigation.prototype.getNodeFromCollectionByTitle = function (nodeCollection, title) {\n            var f = nodeCollection.filter(function (val) {\n                return val.get_title() === title;\n            });\n            return f[0] || null;\n        };\n        ;\n        ObjectNavigation.prototype.ConfigureQuickLaunch = function (nodes, clientContext, httpClient, navigation) {\n            var _this = this;\n            return new Promise(function (resolve, reject) {\n                if (nodes.length === 0) {\n                    resolve();\n                }\n                else {\n                    var quickLaunchNodeCollection_1 = navigation.get_quickLaunch();\n                    clientContext.load(quickLaunchNodeCollection_1);\n                    clientContext.executeQueryAsync(function () {\n                        var temporaryQuickLaunch = [];\n                        var index = quickLaunchNodeCollection_1.get_count() - 1;\n                        while (index >= 0) {\n                            var oldNode = quickLaunchNodeCollection_1.itemAt(index);\n                            temporaryQuickLaunch.push(oldNode);\n                            oldNode.deleteObject();\n                            index--;\n                        }\n                        clientContext.executeQueryAsync(function () {\n                            nodes.forEach(function (n) {\n                                var existingNode = _this.getNodeFromCollectionByTitle(temporaryQuickLaunch, n.Title);\n                                var newNode = new SP.NavigationNodeCreationInformation();\n                                newNode.set_title(n.Title);\n                                newNode.set_url(existingNode ? existingNode.get_url() : util_1.Util.replaceUrlTokens(n.Url));\n                                newNode.set_asLastNode(true);\n                                quickLaunchNodeCollection_1.add(newNode);\n                            });\n                            clientContext.executeQueryAsync(function () {\n                                httpClient.get(_spPageContextInfo.webAbsoluteUrl + \"/_api/web/Navigation/QuickLaunch\").then(function (response) {\n                                    response.json().then(function (json) {\n                                        json.value.forEach(function (d) {\n                                            var node = navigation.getNodeById(d.Id);\n                                            var childrenNodeCollection = node.get_children();\n                                            var parentNode = nodes.filter(function (value) { return value.Title === d.Title; })[0];\n                                            if (parentNode && parentNode.Children) {\n                                                parentNode.Children.forEach(function (n) {\n                                                    var existingNode = _this.getNodeFromCollectionByTitle(temporaryQuickLaunch, n.Title);\n                                                    var newNode = new SP.NavigationNodeCreationInformation();\n                                                    newNode.set_title(n.Title);\n                                                    newNode.set_url(existingNode\n                                                        ? existingNode.get_url()\n                                                        : util_1.Util.replaceUrlTokens(n.Url));\n                                                    newNode.set_asLastNode(true);\n                                                    childrenNodeCollection.add(newNode);\n                                                });\n                                            }\n                                        });\n                                        clientContext.executeQueryAsync(resolve, resolve);\n                                    });\n                                });\n                            }, resolve);\n                        });\n                    });\n                }\n            });\n        };\n        return ObjectNavigation;\n    }(ObjectHandlerBase_1.ObjectHandlerBase));\n    exports.ObjectNavigation = ObjectNavigation;\n});\n\n},{\"../util\":20,\"./ObjectHandlerBase\":12}],15:[function(require,module,exports){\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\n(function (factory) {\n    if (typeof module === 'object' && typeof module.exports === 'object') {\n        var v = factory(require, exports); if (v !== undefined) module.exports = v;\n    }\n    else if (typeof define === 'function' && define.amd) {\n        define([\"require\", \"exports\", \"../util\", \"./ObjectHandlerBase\"], factory);\n    }\n})(function (require, exports) {\n    \"use strict\";\n    var util_1 = require(\"../util\");\n    var ObjectHandlerBase_1 = require(\"./ObjectHandlerBase\");\n    var ObjectPropertyBagEntries = (function (_super) {\n        __extends(ObjectPropertyBagEntries, _super);\n        function ObjectPropertyBagEntries() {\n            _super.call(this, \"PropertyBagEntries\");\n        }\n        ObjectPropertyBagEntries.prototype.ProvisionObjects = function (entries) {\n            var _this = this;\n            _super.prototype.scope_started.call(this);\n            return new Promise(function (resolve, reject) {\n                if (!entries || entries.length === 0) {\n                    resolve();\n                }\n                else {\n                    var clientContext_1 = SP.ClientContext.get_current();\n                    var web_1 = clientContext_1.get_web();\n                    var propBag_1 = web_1.get_allProperties();\n                    var indexedProperties_1 = [];\n                    for (var i = 0; i < entries.length; i++) {\n                        var entry = entries[i];\n                        propBag_1.set_item(entry.Key, entry.Value);\n                        if (entry.Indexed) {\n                            indexedProperties_1.push(util_1.Util.encodePropertyKey(entry.Key));\n                        }\n                        ;\n                    }\n                    ;\n                    web_1.update();\n                    clientContext_1.load(propBag_1);\n                    clientContext_1.executeQueryAsync(function () {\n                        if (indexedProperties_1.length > 0) {\n                            propBag_1.set_item(\"vti_indexedpropertykeys\", indexedProperties_1.join(\"|\"));\n                            web_1.update();\n                            clientContext_1.executeQueryAsync(function () {\n                                _super.prototype.scope_ended.call(_this);\n                                resolve();\n                            }, function () {\n                                _super.prototype.scope_ended.call(_this);\n                                resolve();\n                            });\n                        }\n                        else {\n                            _super.prototype.scope_ended.call(_this);\n                            resolve();\n                        }\n                    }, function () {\n                        _super.prototype.scope_ended.call(_this);\n                        resolve();\n                    });\n                }\n            });\n        };\n        return ObjectPropertyBagEntries;\n    }(ObjectHandlerBase_1.ObjectHandlerBase));\n    exports.ObjectPropertyBagEntries = ObjectPropertyBagEntries;\n});\n\n},{\"../util\":20,\"./ObjectHandlerBase\":12}],16:[function(require,module,exports){\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\n(function (factory) {\n    if (typeof module === 'object' && typeof module.exports === 'object') {\n        var v = factory(require, exports); if (v !== undefined) module.exports = v;\n    }\n    else if (typeof define === 'function' && define.amd) {\n        define([\"require\", \"exports\", \"./ObjectHandlerBase\"], factory);\n    }\n})(function (require, exports) {\n    \"use strict\";\n    var ObjectHandlerBase_1 = require(\"./ObjectHandlerBase\");\n    var ObjectWebSettings = (function (_super) {\n        __extends(ObjectWebSettings, _super);\n        function ObjectWebSettings() {\n            _super.call(this, \"WebSettings\");\n        }\n        ObjectWebSettings.prototype.ProvisionObjects = function (object) {\n            var _this = this;\n            _super.prototype.scope_started.call(this);\n            return new Promise(function (resolve, reject) {\n                var clientContext = SP.ClientContext.get_current();\n                var web = clientContext.get_web();\n                if (object.WelcomePage) {\n                    web.get_rootFolder().set_welcomePage(object.WelcomePage);\n                    web.get_rootFolder().update();\n                }\n                if (object.MasterUrl) {\n                    web.set_masterUrl(object.MasterUrl);\n                }\n                if (object.CustomMasterUrl) {\n                    web.set_customMasterUrl(object.CustomMasterUrl);\n                }\n                if (object.SaveSiteAsTemplateEnabled !== undefined) {\n                    web.set_saveSiteAsTemplateEnabled(object.SaveSiteAsTemplateEnabled);\n                }\n                if (object.QuickLaunchEnabled !== undefined) {\n                    web.set_saveSiteAsTemplateEnabled(object.QuickLaunchEnabled);\n                }\n                if (object.TreeViewEnabled !== undefined) {\n                    web.set_treeViewEnabled(object.TreeViewEnabled);\n                }\n                web.update();\n                clientContext.load(web);\n                clientContext.executeQueryAsync(function () {\n                    _super.prototype.scope_ended.call(_this);\n                    resolve();\n                }, function () {\n                    _super.prototype.scope_ended.call(_this);\n                    resolve();\n                });\n            });\n        };\n        return ObjectWebSettings;\n    }(ObjectHandlerBase_1.ObjectHandlerBase));\n    exports.ObjectWebSettings = ObjectWebSettings;\n});\n\n},{\"./ObjectHandlerBase\":12}],17:[function(require,module,exports){\n(function (factory) {\n    if (typeof module === 'object' && typeof module.exports === 'object') {\n        var v = factory(require, exports); if (v !== undefined) module.exports = v;\n    }\n    else if (typeof define === 'function' && define.amd) {\n        define([\"require\", \"exports\"], factory);\n    }\n})(function (require, exports) {\n    \"use strict\";\n    var ProvisioningStep = (function () {\n        function ProvisioningStep(name, index, objects, parameters, handler) {\n            this.name = name;\n            this.index = index;\n            this.objects = objects;\n            this.parameters = parameters;\n            this.handler = handler;\n        }\n        ProvisioningStep.prototype.execute = function (dependentPromise) {\n            var _this = this;\n            var _handler = new this.handler();\n            if (!dependentPromise) {\n                return _handler.ProvisionObjects(this.objects, this.parameters);\n            }\n            return new Promise(function (resolve, reject) {\n                dependentPromise.then(function () {\n                    return _handler.ProvisionObjects(_this.objects, _this.parameters).then(resolve, resolve);\n                });\n            });\n        };\n        return ProvisioningStep;\n    }());\n    exports.ProvisioningStep = ProvisioningStep;\n});\n\n},{}],18:[function(require,module,exports){\n(function (factory) {\n    if (typeof module === 'object' && typeof module.exports === 'object') {\n        var v = factory(require, exports); if (v !== undefined) module.exports = v;\n    }\n    else if (typeof define === 'function' && define.amd) {\n        define([\"require\", \"exports\"], factory);\n    }\n})(function (require, exports) {\n    \"use strict\";\n    var Sequencer = (function () {\n        function Sequencer(functions, parameter, scope) {\n            this.functions = functions;\n            this.parameter = parameter;\n            this.scope = scope;\n        }\n        Sequencer.prototype.execute = function (progressFunction) {\n            var promiseSequence = Promise.resolve();\n            this.functions.forEach(function (sequenceFunction, functionNr) {\n                promiseSequence = promiseSequence.then(function () {\n                    return sequenceFunction.call(this.scope, this.parameter);\n                }).then(function (result) {\n                    if (progressFunction) {\n                        progressFunction.call(this, functionNr, this.functions);\n                    }\n                });\n            }, this);\n            return promiseSequence;\n        };\n        return Sequencer;\n    }());\n    exports.Sequencer = Sequencer;\n});\n\n},{}],19:[function(require,module,exports){\n(function (factory) {\n    if (typeof module === 'object' && typeof module.exports === 'object') {\n        var v = factory(require, exports); if (v !== undefined) module.exports = v;\n    }\n    else if (typeof define === 'function' && define.amd) {\n        define([\"require\", \"exports\", \"./ProvisioningStep\", \"./ObjectHandlers/ObjectNavigation\", \"./ObjectHandlers/ObjectPropertyBagEntries\", \"./ObjectHandlers/ObjectFeatures\", \"./ObjectHandlers/ObjectWebSettings\", \"./ObjectHandlers/ObjectComposedLook\", \"./ObjectHandlers/ObjectCustomActions\", \"./ObjectHandlers/ObjectFiles\", \"./ObjectHandlers/ObjectLists\", \"./util\", \"../../utils/logging\", \"../../net/HttpClient\"], factory);\n    }\n})(function (require, exports) {\n    \"use strict\";\n    var ProvisioningStep_1 = require(\"./ProvisioningStep\");\n    var ObjectNavigation_1 = require(\"./ObjectHandlers/ObjectNavigation\");\n    var ObjectPropertyBagEntries_1 = require(\"./ObjectHandlers/ObjectPropertyBagEntries\");\n    var ObjectFeatures_1 = require(\"./ObjectHandlers/ObjectFeatures\");\n    var ObjectWebSettings_1 = require(\"./ObjectHandlers/ObjectWebSettings\");\n    var ObjectComposedLook_1 = require(\"./ObjectHandlers/ObjectComposedLook\");\n    var ObjectCustomActions_1 = require(\"./ObjectHandlers/ObjectCustomActions\");\n    var ObjectFiles_1 = require(\"./ObjectHandlers/ObjectFiles\");\n    var ObjectLists_1 = require(\"./ObjectHandlers/ObjectLists\");\n    var util_1 = require(\"./util\");\n    var logging_1 = require(\"../../utils/logging\");\n    var HttpClient_1 = require(\"../../net/HttpClient\");\n    var Provisioning = (function () {\n        function Provisioning() {\n            this.handlers = {\n                \"Navigation\": ObjectNavigation_1.ObjectNavigation,\n                \"PropertyBagEntries\": ObjectPropertyBagEntries_1.ObjectPropertyBagEntries,\n                \"Features\": ObjectFeatures_1.ObjectFeatures,\n                \"WebSettings\": ObjectWebSettings_1.ObjectWebSettings,\n                \"ComposedLook\": ObjectComposedLook_1.ObjectComposedLook,\n                \"CustomActions\": ObjectCustomActions_1.ObjectCustomActions,\n                \"Files\": ObjectFiles_1.ObjectFiles,\n                \"Lists\": ObjectLists_1.ObjectLists,\n            };\n            this.httpClient = new HttpClient_1.HttpClient();\n        }\n        Provisioning.prototype.applyTemplate = function (path) {\n            var _this = this;\n            var url = util_1.Util.replaceUrlTokens(path);\n            return new Promise(function (resolve, reject) {\n                _this.httpClient.get(url).then(function (response) {\n                    if (response.ok) {\n                        response.json().then(function (template) {\n                            _this.start(template, Object.keys(template)).then(resolve, reject);\n                        });\n                    }\n                    else {\n                        reject(response.statusText);\n                    }\n                }, function (error) {\n                    logging_1.Logger.write(\"Provisioning: The provided template is invalid\", logging_1.Logger.LogLevel.Error);\n                });\n            });\n        };\n        Provisioning.prototype.start = function (json, queue) {\n            var _this = this;\n            return new Promise(function (resolve, reject) {\n                _this.startTime = new Date().getTime();\n                _this.queueItems = [];\n                queue.forEach(function (q, index) {\n                    if (!_this.handlers[q]) {\n                        return;\n                    }\n                    _this.queueItems.push(new ProvisioningStep_1.ProvisioningStep(q, index, json[q], json.Parameters, _this.handlers[q]));\n                });\n                var promises = [];\n                promises.push(new Promise(function (res) {\n                    logging_1.Logger.write(\"Provisioning: Code execution scope started\", logging_1.Logger.LogLevel.Info);\n                    res();\n                }));\n                var index = 1;\n                while (_this.queueItems[index - 1] !== undefined) {\n                    var i = promises.length - 1;\n                    promises.push(_this.queueItems[index - 1].execute(promises[i]));\n                    index++;\n                }\n                ;\n                Promise.all(promises).then(function (value) {\n                    logging_1.Logger.write(\"Provisioning: Code execution scope ended\", logging_1.Logger.LogLevel.Info);\n                    resolve(value);\n                }, function (error) {\n                    logging_1.Logger.write(\"Provisioning: Code execution scope ended\" + JSON.stringify(error), logging_1.Logger.LogLevel.Error);\n                    reject(error);\n                });\n            });\n        };\n        return Provisioning;\n    }());\n    exports.Provisioning = Provisioning;\n});\n\n},{\"../../net/HttpClient\":3,\"../../utils/logging\":22,\"./ObjectHandlers/ObjectComposedLook\":8,\"./ObjectHandlers/ObjectCustomActions\":9,\"./ObjectHandlers/ObjectFeatures\":10,\"./ObjectHandlers/ObjectFiles\":11,\"./ObjectHandlers/ObjectLists\":13,\"./ObjectHandlers/ObjectNavigation\":14,\"./ObjectHandlers/ObjectPropertyBagEntries\":15,\"./ObjectHandlers/ObjectWebSettings\":16,\"./ProvisioningStep\":17,\"./util\":20}],20:[function(require,module,exports){\n(function (factory) {\n    if (typeof module === 'object' && typeof module.exports === 'object') {\n        var v = factory(require, exports); if (v !== undefined) module.exports = v;\n    }\n    else if (typeof define === 'function' && define.amd) {\n        define([\"require\", \"exports\"], factory);\n    }\n})(function (require, exports) {\n    \"use strict\";\n    var Util = (function () {\n        function Util() {\n        }\n        Util.getRelativeUrl = function (url) {\n            return url.replace(document.location.protocol + \"//\" + document.location.hostname, \"\");\n        };\n        Util.replaceUrlTokens = function (url) {\n            return url.replace(/{site}/g, _spPageContextInfo.webAbsoluteUrl)\n                .replace(/{sitecollection}/g, _spPageContextInfo.siteAbsoluteUrl)\n                .replace(/{themegallery}/g, _spPageContextInfo.siteAbsoluteUrl + \"/_catalogs/theme/15\");\n        };\n        ;\n        Util.encodePropertyKey = function (propKey) {\n            var bytes = [];\n            for (var i = 0; i < propKey.length; ++i) {\n                bytes.push(propKey.charCodeAt(i));\n                bytes.push(0);\n            }\n            var b64encoded = window.btoa(String.fromCharCode.apply(null, bytes));\n            return b64encoded;\n        };\n        return Util;\n    }());\n    exports.Util = Util;\n});\n\n},{}],21:[function(require,module,exports){\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\n(function (factory) {\n    if (typeof module === 'object' && typeof module.exports === 'object') {\n        var v = factory(require, exports); if (v !== undefined) module.exports = v;\n    }\n    else if (typeof define === 'function' && define.amd) {\n        define([\"require\", \"exports\", \"../../utils/util\", \"../../utils/logging\", \"../../net/httpclient\", \"../../configuration/pnplibconfig\"], factory);\n    }\n})(function (require, exports) {\n    \"use strict\";\n    var util_1 = require(\"../../utils/util\");\n    var logging_1 = require(\"../../utils/logging\");\n    var httpclient_1 = require(\"../../net/httpclient\");\n    var pnplibconfig_1 = require(\"../../configuration/pnplibconfig\");\n    var ODataParserBase = (function () {\n        function ODataParserBase() {\n        }\n        ODataParserBase.prototype.parse = function (r) {\n            return r.json().then(function (json) {\n                if (json.hasOwnProperty(\"d\")) {\n                    if (json.d.hasOwnProperty(\"results\")) {\n                        return json.d.results;\n                    }\n                    return json.d;\n                }\n                else if (json.hasOwnProperty(\"value\")) {\n                    return json.value;\n                }\n                return json;\n            });\n        };\n        return ODataParserBase;\n    }());\n    exports.ODataParserBase = ODataParserBase;\n    var ODataDefaultParser = (function (_super) {\n        __extends(ODataDefaultParser, _super);\n        function ODataDefaultParser() {\n            _super.apply(this, arguments);\n        }\n        return ODataDefaultParser;\n    }(ODataParserBase));\n    exports.ODataDefaultParser = ODataDefaultParser;\n    var ODataRawParserImpl = (function () {\n        function ODataRawParserImpl() {\n        }\n        ODataRawParserImpl.prototype.parse = function (r) {\n            return r.json();\n        };\n        return ODataRawParserImpl;\n    }());\n    exports.ODataRawParserImpl = ODataRawParserImpl;\n    var ODataValueParserImpl = (function (_super) {\n        __extends(ODataValueParserImpl, _super);\n        function ODataValueParserImpl() {\n            _super.apply(this, arguments);\n        }\n        ODataValueParserImpl.prototype.parse = function (r) {\n            return _super.prototype.parse.call(this, r).then(function (d) { return d; });\n        };\n        return ODataValueParserImpl;\n    }(ODataParserBase));\n    var ODataEntityParserImpl = (function (_super) {\n        __extends(ODataEntityParserImpl, _super);\n        function ODataEntityParserImpl(factory) {\n            _super.call(this);\n            this.factory = factory;\n        }\n        ODataEntityParserImpl.prototype.parse = function (r) {\n            var _this = this;\n            return _super.prototype.parse.call(this, r).then(function (d) {\n                var o = new _this.factory(getEntityUrl(d), null);\n                return util_1.Util.extend(o, d);\n            });\n        };\n        return ODataEntityParserImpl;\n    }(ODataParserBase));\n    var ODataEntityArrayParserImpl = (function (_super) {\n        __extends(ODataEntityArrayParserImpl, _super);\n        function ODataEntityArrayParserImpl(factory) {\n            _super.call(this);\n            this.factory = factory;\n        }\n        ODataEntityArrayParserImpl.prototype.parse = function (r) {\n            var _this = this;\n            return _super.prototype.parse.call(this, r).then(function (d) {\n                return d.map(function (v) {\n                    var o = new _this.factory(getEntityUrl(v), null);\n                    return util_1.Util.extend(o, v);\n                });\n            });\n        };\n        return ODataEntityArrayParserImpl;\n    }(ODataParserBase));\n    function getEntityUrl(entity) {\n        if (entity.hasOwnProperty(\"__metadata\")) {\n            return entity.__metadata.uri;\n        }\n        else if (entity.hasOwnProperty(\"odata.editLink\")) {\n            return util_1.Util.combinePaths(\"_api\", entity[\"odata.editLink\"]);\n        }\n        else {\n            logging_1.Logger.write(\"No uri information found in ODataEntity parsing, chaining will fail for this object.\", logging_1.Logger.LogLevel.Warning);\n            return \"\";\n        }\n    }\n    exports.ODataRaw = new ODataRawParserImpl();\n    function ODataValue() {\n        return new ODataValueParserImpl();\n    }\n    exports.ODataValue = ODataValue;\n    function ODataEntity(factory) {\n        return new ODataEntityParserImpl(factory);\n    }\n    exports.ODataEntity = ODataEntity;\n    function ODataEntityArray(factory) {\n        return new ODataEntityArrayParserImpl(factory);\n    }\n    exports.ODataEntityArray = ODataEntityArray;\n    var ODataBatch = (function () {\n        function ODataBatch(_batchId) {\n            if (_batchId === void 0) { _batchId = util_1.Util.getGUID(); }\n            this._batchId = _batchId;\n            this._requests = [];\n            this._batchDepCount = 0;\n        }\n        ODataBatch.prototype.add = function (url, method, options, parser) {\n            var info = {\n                method: method.toUpperCase(),\n                options: options,\n                parser: parser,\n                reject: null,\n                resolve: null,\n                url: url,\n            };\n            var p = new Promise(function (resolve, reject) {\n                info.resolve = resolve;\n                info.reject = reject;\n            });\n            this._requests.push(info);\n            return p;\n        };\n        ODataBatch.prototype.incrementBatchDep = function () {\n            this._batchDepCount++;\n        };\n        ODataBatch.prototype.decrementBatchDep = function () {\n            this._batchDepCount--;\n        };\n        ODataBatch.prototype.execute = function () {\n            var _this = this;\n            if (this._batchDepCount > 0) {\n                setTimeout(function () { return _this.execute(); }, 100);\n            }\n            else {\n                this.executeImpl();\n            }\n        };\n        ODataBatch.prototype.executeImpl = function () {\n            var _this = this;\n            if (this._requests.length < 1) {\n                return;\n            }\n            var batchBody = [];\n            var currentChangeSetId = \"\";\n            this._requests.forEach(function (reqInfo, index) {\n                if (reqInfo.method === \"GET\") {\n                    if (currentChangeSetId.length > 0) {\n                        batchBody.push(\"--changeset_\" + currentChangeSetId + \"--\\n\\n\");\n                        currentChangeSetId = \"\";\n                    }\n                    batchBody.push(\"--batch_\" + _this._batchId + \"\\n\");\n                }\n                else {\n                    if (currentChangeSetId.length < 1) {\n                        currentChangeSetId = util_1.Util.getGUID();\n                        batchBody.push(\"--batch_\" + _this._batchId + \"\\n\");\n                        batchBody.push(\"Content-Type: multipart/mixed; boundary=\\\"changeset_\" + currentChangeSetId + \"\\\"\\n\\n\");\n                    }\n                    batchBody.push(\"--changeset_\" + currentChangeSetId + \"\\n\");\n                }\n                batchBody.push(\"Content-Type: application/http\\n\");\n                batchBody.push(\"Content-Transfer-Encoding: binary\\n\\n\");\n                var headers = {\n                    \"Accept\": \"application/json;\",\n                };\n                if (reqInfo.method !== \"GET\") {\n                    var method = reqInfo.method;\n                    if (reqInfo.options && reqInfo.options.headers && reqInfo.options.headers[\"X-HTTP-Method\"] !== typeof undefined) {\n                        method = reqInfo.options.headers[\"X-HTTP-Method\"];\n                        delete reqInfo.options.headers[\"X-HTTP-Method\"];\n                    }\n                    batchBody.push(method + \" \" + reqInfo.url + \" HTTP/1.1\\n\");\n                    headers = util_1.Util.extend(headers, { \"Content-Type\": \"application/json;odata=verbose;charset=utf-8\" });\n                }\n                else {\n                    batchBody.push(reqInfo.method + \" \" + reqInfo.url + \" HTTP/1.1\\n\");\n                }\n                if (typeof pnplibconfig_1.RuntimeConfig.headers !== \"undefined\") {\n                    headers = util_1.Util.extend(headers, pnplibconfig_1.RuntimeConfig.headers);\n                }\n                if (reqInfo.options && reqInfo.options.headers) {\n                    headers = util_1.Util.extend(headers, reqInfo.options.headers);\n                }\n                for (var name_1 in headers) {\n                    if (headers.hasOwnProperty(name_1)) {\n                        batchBody.push(name_1 + \": \" + headers[name_1] + \"\\n\");\n                    }\n                }\n                batchBody.push(\"\\n\");\n                if (reqInfo.options.body) {\n                    batchBody.push(reqInfo.options.body + \"\\n\\n\");\n                }\n            });\n            if (currentChangeSetId.length > 0) {\n                batchBody.push(\"--changeset_\" + currentChangeSetId + \"--\\n\\n\");\n                currentChangeSetId = \"\";\n            }\n            batchBody.push(\"--batch_\" + this._batchId + \"--\\n\");\n            var batchHeaders = new Headers();\n            batchHeaders.append(\"Content-Type\", \"multipart/mixed; boundary=batch_\" + this._batchId);\n            var batchOptions = {\n                \"body\": batchBody.join(\"\"),\n                \"headers\": batchHeaders,\n            };\n            var client = new httpclient_1.HttpClient();\n            client.post(util_1.Util.makeUrlAbsolute(\"/_api/$batch\"), batchOptions)\n                .then(function (r) { return r.text(); })\n                .then(this._parseResponse)\n                .then(function (responses) {\n                if (responses.length !== _this._requests.length) {\n                    throw new Error(\"Could not properly parse responses to match requests in batch.\");\n                }\n                for (var i = 0; i < responses.length; i++) {\n                    var request = _this._requests[i];\n                    var response = responses[i];\n                    if (!response.ok) {\n                        request.reject(new Error(response.statusText));\n                    }\n                    request.parser.parse(response).then(request.resolve).catch(request.reject);\n                }\n            });\n        };\n        ODataBatch.prototype._parseResponse = function (body) {\n            return new Promise(function (resolve, reject) {\n                var responses = [];\n                var header = \"--batchresponse_\";\n                var statusRegExp = new RegExp(\"^HTTP/[0-9.]+ +([0-9]+) +(.*)\", \"i\");\n                var lines = body.split(\"\\n\");\n                var state = \"batch\";\n                var status;\n                var statusText;\n                for (var i = 0; i < lines.length; ++i) {\n                    var line = lines[i];\n                    switch (state) {\n                        case \"batch\":\n                            if (line.substr(0, header.length) === header) {\n                                state = \"batchHeaders\";\n                            }\n                            else {\n                                if (line.trim() !== \"\") {\n                                    throw new Error(\"Invalid response, line \" + i);\n                                }\n                            }\n                            break;\n                        case \"batchHeaders\":\n                            if (line.trim() === \"\") {\n                                state = \"status\";\n                            }\n                            break;\n                        case \"status\":\n                            var parts = statusRegExp.exec(line);\n                            if (parts.length !== 3) {\n                                throw new Error(\"Invalid status, line \" + i);\n                            }\n                            status = parseInt(parts[1], 10);\n                            statusText = parts[2];\n                            state = \"statusHeaders\";\n                            break;\n                        case \"statusHeaders\":\n                            if (line.trim() === \"\") {\n                                state = \"body\";\n                            }\n                            break;\n                        case \"body\":\n                            var response = void 0;\n                            if (status === 204) {\n                                response = new Response();\n                            }\n                            else {\n                                response = new Response(line, { status: status, statusText: statusText });\n                            }\n                            responses.push(response);\n                            state = \"batch\";\n                            break;\n                    }\n                }\n                if (state !== \"status\") {\n                    reject(new Error(\"Unexpected end of input\"));\n                }\n                resolve(responses);\n            });\n        };\n        return ODataBatch;\n    }());\n    exports.ODataBatch = ODataBatch;\n});\n\n},{\"../../configuration/pnplibconfig\":2,\"../../net/httpclient\":7,\"../../utils/logging\":22,\"../../utils/util\":23}],22:[function(require,module,exports){\n(function (factory) {\n    if (typeof module === 'object' && typeof module.exports === 'object') {\n        var v = factory(require, exports); if (v !== undefined) module.exports = v;\n    }\n    else if (typeof define === 'function' && define.amd) {\n        define([\"require\", \"exports\"], factory);\n    }\n})(function (require, exports) {\n    \"use strict\";\n    var Logger = (function () {\n        function Logger() {\n        }\n        Object.defineProperty(Logger, \"activeLogLevel\", {\n            get: function () {\n                return Logger.instance.activeLogLevel;\n            },\n            set: function (value) {\n                Logger.instance.activeLogLevel = value;\n            },\n            enumerable: true,\n            configurable: true\n        });\n        Object.defineProperty(Logger, \"instance\", {\n            get: function () {\n                if (typeof Logger._instance === \"undefined\" || Logger._instance === null) {\n                    Logger._instance = new LoggerImpl();\n                }\n                return Logger._instance;\n            },\n            enumerable: true,\n            configurable: true\n        });\n        Logger.subscribe = function () {\n            var listeners = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                listeners[_i - 0] = arguments[_i];\n            }\n            for (var i = 0; i < listeners.length; i++) {\n                Logger.instance.subscribe(listeners[i]);\n            }\n        };\n        Logger.clearSubscribers = function () {\n            return Logger.instance.clearSubscribers();\n        };\n        Object.defineProperty(Logger, \"count\", {\n            get: function () {\n                return Logger.instance.count;\n            },\n            enumerable: true,\n            configurable: true\n        });\n        Logger.write = function (message, level) {\n            if (level === void 0) { level = Logger.LogLevel.Verbose; }\n            Logger.instance.log({ level: level, message: message });\n        };\n        Logger.log = function (entry) {\n            Logger.instance.log(entry);\n        };\n        Logger.measure = function (name, f) {\n            return Logger.instance.measure(name, f);\n        };\n        return Logger;\n    }());\n    exports.Logger = Logger;\n    var LoggerImpl = (function () {\n        function LoggerImpl(activeLogLevel, subscribers) {\n            if (activeLogLevel === void 0) { activeLogLevel = Logger.LogLevel.Warning; }\n            if (subscribers === void 0) { subscribers = []; }\n            this.activeLogLevel = activeLogLevel;\n            this.subscribers = subscribers;\n        }\n        LoggerImpl.prototype.subscribe = function (listener) {\n            this.subscribers.push(listener);\n        };\n        LoggerImpl.prototype.clearSubscribers = function () {\n            var s = this.subscribers.slice(0);\n            this.subscribers.length = 0;\n            return s;\n        };\n        Object.defineProperty(LoggerImpl.prototype, \"count\", {\n            get: function () {\n                return this.subscribers.length;\n            },\n            enumerable: true,\n            configurable: true\n        });\n        LoggerImpl.prototype.write = function (message, level) {\n            if (level === void 0) { level = Logger.LogLevel.Verbose; }\n            this.log({ level: level, message: message });\n        };\n        LoggerImpl.prototype.log = function (entry) {\n            if (typeof entry === \"undefined\" || entry.level < this.activeLogLevel) {\n                return;\n            }\n            for (var i = 0; i < this.subscribers.length; i++) {\n                this.subscribers[i].log(entry);\n            }\n        };\n        LoggerImpl.prototype.measure = function (name, f) {\n            console.profile(name);\n            try {\n                return f();\n            }\n            finally {\n                console.profileEnd();\n            }\n        };\n        return LoggerImpl;\n    }());\n    var Logger;\n    (function (Logger) {\n        (function (LogLevel) {\n            LogLevel[LogLevel[\"Verbose\"] = 0] = \"Verbose\";\n            LogLevel[LogLevel[\"Info\"] = 1] = \"Info\";\n            LogLevel[LogLevel[\"Warning\"] = 2] = \"Warning\";\n            LogLevel[LogLevel[\"Error\"] = 3] = \"Error\";\n            LogLevel[LogLevel[\"Off\"] = 99] = \"Off\";\n        })(Logger.LogLevel || (Logger.LogLevel = {}));\n        var LogLevel = Logger.LogLevel;\n        var ConsoleListener = (function () {\n            function ConsoleListener() {\n            }\n            ConsoleListener.prototype.log = function (entry) {\n                var msg = this.format(entry);\n                switch (entry.level) {\n                    case LogLevel.Verbose:\n                    case LogLevel.Info:\n                        console.log(msg);\n                        break;\n                    case LogLevel.Warning:\n                        console.warn(msg);\n                        break;\n                    case LogLevel.Error:\n                        console.error(msg);\n                        break;\n                }\n            };\n            ConsoleListener.prototype.format = function (entry) {\n                return \"Message: \" + entry.message + \". Data: \" + JSON.stringify(entry.data);\n            };\n            return ConsoleListener;\n        }());\n        Logger.ConsoleListener = ConsoleListener;\n        var AzureInsightsListener = (function () {\n            function AzureInsightsListener(azureInsightsInstrumentationKey) {\n                this.azureInsightsInstrumentationKey = azureInsightsInstrumentationKey;\n                var appInsights = window[\"appInsights\"] || function (config) {\n                    function r(config) {\n                        t[config] = function () {\n                            var i = arguments;\n                            t.queue.push(function () { t[config].apply(t, i); });\n                        };\n                    }\n                    var t = { config: config }, u = document, e = window, o = \"script\", s = u.createElement(o), i, f;\n                    for (s.src = config.url || \"//az416426.vo.msecnd.net/scripts/a/ai.0.js\", u.getElementsByTagName(o)[0].parentNode.appendChild(s), t.cookie = u.cookie, t.queue = [], i = [\"Event\", \"Exception\", \"Metric\", \"PageView\", \"Trace\"]; i.length;) {\n                        r(\"track\" + i.pop());\n                    }\n                    return r(\"setAuthenticatedUserContext\"), r(\"clearAuthenticatedUserContext\"), config.disableExceptionTracking || (i = \"onerror\", r(\"_\" + i), f = e[i], e[i] = function (config, r, u, e, o) {\n                        var s = f && f(config, r, u, e, o);\n                        return s !== !0 && t[\"_\" + i](config, r, u, e, o), s;\n                    }), t;\n                }({\n                    instrumentationKey: this.azureInsightsInstrumentationKey\n                });\n                window[\"appInsights\"] = appInsights;\n            }\n            AzureInsightsListener.prototype.log = function (entry) {\n                var ai = window[\"appInsights\"];\n                var msg = this.format(entry);\n                if (entry.level === LogLevel.Error) {\n                    ai.trackException(msg);\n                }\n                else {\n                    ai.trackEvent(msg);\n                }\n            };\n            AzureInsightsListener.prototype.format = function (entry) {\n                return \"Message: \" + entry.message + \". Data: \" + JSON.stringify(entry.data);\n            };\n            return AzureInsightsListener;\n        }());\n        Logger.AzureInsightsListener = AzureInsightsListener;\n        var FunctionListener = (function () {\n            function FunctionListener(method) {\n                this.method = method;\n            }\n            FunctionListener.prototype.log = function (entry) {\n                this.method(entry);\n            };\n            return FunctionListener;\n        }());\n        Logger.FunctionListener = FunctionListener;\n    })(Logger = exports.Logger || (exports.Logger = {}));\n});\n\n},{}],23:[function(require,module,exports){\n(function (factory) {\n    if (typeof module === 'object' && typeof module.exports === 'object') {\n        var v = factory(require, exports); if (v !== undefined) module.exports = v;\n    }\n    else if (typeof define === 'function' && define.amd) {\n        define([\"require\", \"exports\"], factory);\n    }\n})(function (require, exports) {\n    \"use strict\";\n    var Util = (function () {\n        function Util() {\n        }\n        Util.getCtxCallback = function (context, method) {\n            var params = [];\n            for (var _i = 2; _i < arguments.length; _i++) {\n                params[_i - 2] = arguments[_i];\n            }\n            return function () {\n                method.apply(context, params);\n            };\n        };\n        Util.urlParamExists = function (name) {\n            name = name.replace(/[\\[]/, \"\\\\[\").replace(/[\\]]/, \"\\\\]\");\n            var regex = new RegExp(\"[\\\\?&]\" + name + \"=([^&#]*)\");\n            return regex.test(location.search);\n        };\n        Util.getUrlParamByName = function (name) {\n            name = name.replace(/[\\[]/, \"\\\\[\").replace(/[\\]]/, \"\\\\]\");\n            var regex = new RegExp(\"[\\\\?&]\" + name + \"=([^&#]*)\");\n            var results = regex.exec(location.search);\n            return results == null ? \"\" : decodeURIComponent(results[1].replace(/\\+/g, \" \"));\n        };\n        Util.getUrlParamBoolByName = function (name) {\n            var p = this.getUrlParamByName(name);\n            var isFalse = (p === \"\" || /false|0/i.test(p));\n            return !isFalse;\n        };\n        Util.stringInsert = function (target, index, s) {\n            if (index > 0) {\n                return target.substring(0, index) + s + target.substring(index, target.length);\n            }\n            return s + target;\n        };\n        Util.dateAdd = function (date, interval, units) {\n            var ret = new Date(date.toLocaleString());\n            switch (interval.toLowerCase()) {\n                case \"year\":\n                    ret.setFullYear(ret.getFullYear() + units);\n                    break;\n                case \"quarter\":\n                    ret.setMonth(ret.getMonth() + 3 * units);\n                    break;\n                case \"month\":\n                    ret.setMonth(ret.getMonth() + units);\n                    break;\n                case \"week\":\n                    ret.setDate(ret.getDate() + 7 * units);\n                    break;\n                case \"day\":\n                    ret.setDate(ret.getDate() + units);\n                    break;\n                case \"hour\":\n                    ret.setTime(ret.getTime() + units * 3600000);\n                    break;\n                case \"minute\":\n                    ret.setTime(ret.getTime() + units * 60000);\n                    break;\n                case \"second\":\n                    ret.setTime(ret.getTime() + units * 1000);\n                    break;\n                default:\n                    ret = undefined;\n                    break;\n            }\n            return ret;\n        };\n        Util.loadStylesheet = function (path, avoidCache) {\n            if (avoidCache) {\n                path += \"?\" + encodeURIComponent((new Date()).getTime().toString());\n            }\n            var head = document.getElementsByTagName(\"head\");\n            if (head.length > 0) {\n                var e = document.createElement(\"link\");\n                head[0].appendChild(e);\n                e.setAttribute(\"type\", \"text/css\");\n                e.setAttribute(\"rel\", \"stylesheet\");\n                e.setAttribute(\"href\", path);\n            }\n        };\n        Util.combinePaths = function () {\n            var paths = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                paths[_i - 0] = arguments[_i];\n            }\n            var parts = [];\n            for (var i = 0; i < paths.length; i++) {\n                if (typeof paths[i] !== \"undefined\" && paths[i] !== null) {\n                    parts.push(paths[i].replace(/^[\\\\|\\/]/, \"\").replace(/[\\\\|\\/]$/, \"\"));\n                }\n            }\n            return parts.join(\"/\").replace(/\\\\/, \"/\");\n        };\n        Util.getRandomString = function (chars) {\n            var text = \"\";\n            var possible = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\n            for (var i = 0; i < chars; i++) {\n                text += possible.charAt(Math.floor(Math.random() * possible.length));\n            }\n            return text;\n        };\n        Util.getGUID = function () {\n            var d = new Date().getTime();\n            var guid = \"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g, function (c) {\n                var r = (d + Math.random() * 16) % 16 | 0;\n                d = Math.floor(d / 16);\n                return (c === \"x\" ? r : (r & 0x3 | 0x8)).toString(16);\n            });\n            return guid;\n        };\n        Util.isFunction = function (candidateFunction) {\n            return typeof candidateFunction === \"function\";\n        };\n        Util.isArray = function (array) {\n            if (Array.isArray) {\n                return Array.isArray(array);\n            }\n            return array && typeof array.length === \"number\" && array.constructor === Array;\n        };\n        Util.stringIsNullOrEmpty = function (s) {\n            return typeof s === \"undefined\" || s === null || s === \"\";\n        };\n        Util.extend = function (target, source, noOverwrite) {\n            if (noOverwrite === void 0) { noOverwrite = false; }\n            var result = {};\n            for (var id in target) {\n                result[id] = target[id];\n            }\n            var check = noOverwrite ? function (o, i) { return !o.hasOwnProperty(i); } : function (o, i) { return true; };\n            for (var id in source) {\n                if (check(result, id)) {\n                    result[id] = source[id];\n                }\n            }\n            return result;\n        };\n        Util.applyMixins = function (derivedCtor) {\n            var baseCtors = [];\n            for (var _i = 1; _i < arguments.length; _i++) {\n                baseCtors[_i - 1] = arguments[_i];\n            }\n            baseCtors.forEach(function (baseCtor) {\n                Object.getOwnPropertyNames(baseCtor.prototype).forEach(function (name) {\n                    derivedCtor.prototype[name] = baseCtor.prototype[name];\n                });\n            });\n        };\n        Util.isUrlAbsolute = function (url) {\n            return /^https?:\\/\\/|^\\/\\//i.test(url);\n        };\n        Util.makeUrlAbsolute = function (url) {\n            if (Util.isUrlAbsolute(url)) {\n                return url;\n            }\n            if (typeof _spPageContextInfo !== \"undefined\") {\n                if (_spPageContextInfo.hasOwnProperty(\"webAbsoluteUrl\")) {\n                    return Util.combinePaths(_spPageContextInfo.webAbsoluteUrl, url);\n                }\n                else if (_spPageContextInfo.hasOwnProperty(\"webServerRelativeUrl\")) {\n                    return Util.combinePaths(_spPageContextInfo.webServerRelativeUrl, url);\n                }\n            }\n            else {\n                return url;\n            }\n        };\n        return Util;\n    }());\n    exports.Util = Util;\n});\n\n},{}]},{},[19])(19)\n});"],"sourceRoot":"/source/"}