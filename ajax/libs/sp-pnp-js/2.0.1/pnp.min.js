!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.$pnp=t():e.$pnp=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="/assets/",t(0)}([function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}var o=n(1),i=n(6),a=n(7),u=n(3),s=n(9),l=n(4);t.util=o.Util,t.sp=new s.Rest,t.storage=new i.PnPClientStorage,t.config=new a.Settings,t.log=u.Logger,t.setup=l.setRuntimeConfig,r(n(42));var c={config:t.config,log:t.log,setup:t.setup,sp:t.sp,storage:t.storage,util:t.util};Object.defineProperty(t,"__esModule",{value:!0}),t.default=c},function(e,t,n){(function(e){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(e,t,n,r){var o,a=arguments.length,u=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)u=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(u=(a<3?o(u):a>3?o(t,n,u):o(t,n))||u);return a>3&&u&&Object.defineProperty(t,n,u),u},u=n(2),s=n(4),l=function(){function t(){r(this,t)}return o(t,null,[{key:"getCtxCallback",value:function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];return function(){t.apply(e,r)}}},{key:"urlParamExists",value:function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)");return t.test(location.search)}},{key:"getUrlParamByName",value:function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)"),n=t.exec(location.search);return null==n?"":decodeURIComponent(n[1].replace(/\+/g," "))}},{key:"getUrlParamBoolByName",value:function(e){var t=this.getUrlParamByName(e),n=""===t||/false|0/i.test(t);return!n}},{key:"stringInsert",value:function(e,t,n){return t>0?e.substring(0,t)+n+e.substring(t,e.length):n+e}},{key:"dateAdd",value:function(e,t,n){var r=new Date(e.toLocaleString());switch(t.toLowerCase()){case"year":r.setFullYear(r.getFullYear()+n);break;case"quarter":r.setMonth(r.getMonth()+3*n);break;case"month":r.setMonth(r.getMonth()+n);break;case"week":r.setDate(r.getDate()+7*n);break;case"day":r.setDate(r.getDate()+n);break;case"hour":r.setTime(r.getTime()+36e5*n);break;case"minute":r.setTime(r.getTime()+6e4*n);break;case"second":r.setTime(r.getTime()+1e3*n);break;default:r=void 0}return r}},{key:"loadStylesheet",value:function(e,t){t&&(e+="?"+encodeURIComponent((new Date).getTime().toString()));var n=document.getElementsByTagName("head");if(n.length>0){var r=document.createElement("link");n[0].appendChild(r),r.setAttribute("type","text/css"),r.setAttribute("rel","stylesheet"),r.setAttribute("href",e)}}},{key:"combinePaths",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter(function(e){return"undefined"!=typeof e&&null!==e}).map(function(e){return e.replace(/^[\\|\/]/,"").replace(/[\\|\/]$/,"")}).join("/").replace(/\\/g,"/")}},{key:"getRandomString",value:function(e){for(var t=new Array(e),n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=0;r<e;r++)t[r]=n.charAt(Math.floor(Math.random()*n.length));return t.join("")}},{key:"getGUID",value:function(){var e=(new Date).getTime(),t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)});return t}},{key:"isFunction",value:function(e){return"function"==typeof e}},{key:"isArray",value:function(e){return Array.isArray?Array.isArray(e):e&&"number"==typeof e.length&&e.constructor===Array}},{key:"stringIsNullOrEmpty",value:function(e){return"undefined"==typeof e||null===e||""===e}},{key:"extend",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null===t||"undefined"==typeof t)return e;var r=n?function(e,t){return!(t in e)}:function(){return!0};return Object.getOwnPropertyNames(t).filter(function(t){return r(e,t)}).reduce(function(e,n){return e[n]=t[n],e},e)}},{key:"isUrlAbsolute",value:function(e){return/^https?:\/\/|^\/\//i.test(e)}},{key:"makeUrlAbsolute",value:function(n){return t.isUrlAbsolute(n)?n:"undefined"==typeof e._spPageContextInfo?n:e._spPageContextInfo.hasOwnProperty("webAbsoluteUrl")?t.combinePaths(e._spPageContextInfo.webAbsoluteUrl,n):e._spPageContextInfo.hasOwnProperty("webServerRelativeUrl")?t.combinePaths(e._spPageContextInfo.webServerRelativeUrl,n):void 0}},{key:"toAbsoluteUrl",value:function(n){return new Promise(function(r){if(t.isUrlAbsolute(n))return r(n);if(null!==s.RuntimeConfig.baseUrl)return r(t.combinePaths(s.RuntimeConfig.baseUrl,n));if("undefined"!=typeof e._spPageContextInfo){if(e._spPageContextInfo.hasOwnProperty("webAbsoluteUrl"))return r(t.combinePaths(e._spPageContextInfo.webAbsoluteUrl,n));if(e._spPageContextInfo.hasOwnProperty("webServerRelativeUrl"))return r(t.combinePaths(e._spPageContextInfo.webServerRelativeUrl,n))}if("undefined"!=typeof e.location){var o=e.location.toString().toLowerCase().indexOf("/_layouts/");if(o>0)return r(t.combinePaths(e.location.toString().substr(0,o),n))}return r(n)})}}]),t}();a([u.deprecated("The Util.makeUrlAbsolute method is deprecated and will be removed from future releases. Use Util.toAbsoluteUrl instead")],l,"makeUrlAbsolute",null),t.Util=l}).call(t,function(){return this}())},function(e,t,n){"use strict";function r(e){return function(t,n,r){var i=r.value;r.value=function(){o.Logger.log({data:{descriptor:r,propertyKey:n,target:t},level:o.LogLevel.Warning,message:e});for(var a=arguments.length,u=Array(a),s=0;s<a;s++)u[s]=arguments[s];return i.apply(this,u)}}}var o=n(3);t.deprecated=r},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();!function(e){e[e.Verbose=0]="Verbose",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error",e[e.Off=99]="Off"}(r=t.LogLevel||(t.LogLevel={}));var i=function(){function e(){n(this,e)}return o(e,null,[{key:"subscribe",value:function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];n.map(function(t){return e.instance.subscribe(t)})}},{key:"clearSubscribers",value:function(){return e.instance.clearSubscribers()}},{key:"write",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.Verbose;e.instance.log({level:n,message:t})}},{key:"writeJSON",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.Verbose;e.instance.log({level:n,message:JSON.stringify(t)})}},{key:"log",value:function(t){e.instance.log(t)}},{key:"measure",value:function(t,n){return e.instance.measure(t,n)}},{key:"activeLogLevel",get:function(){return e.instance.activeLogLevel},set:function(t){e.instance.activeLogLevel=t}},{key:"instance",get:function(){return"undefined"!=typeof e._instance&&null!==e._instance||(e._instance=new a),e._instance}},{key:"count",get:function(){return e.instance.count}}]),e}();t.Logger=i;var a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.Warning,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];n(this,e),this.activeLogLevel=t,this.subscribers=o}return o(e,[{key:"subscribe",value:function(e){this.subscribers.push(e)}},{key:"clearSubscribers",value:function(){var e=this.subscribers.slice(0);return this.subscribers.length=0,e}},{key:"write",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.Verbose;this.log({level:t,message:e})}},{key:"log",value:function(e){"undefined"==typeof e||e.level<this.activeLogLevel||this.subscribers.map(function(t){return t.log(e)})}},{key:"measure",value:function(e,t){console.profile(e);try{return t()}finally{console.profileEnd()}}},{key:"count",get:function(){return this.subscribers.length}}]),e}(),u=function(){function e(){n(this,e)}return o(e,[{key:"log",value:function(e){var t=this.format(e);switch(e.level){case r.Verbose:case r.Info:console.log(t);break;case r.Warning:console.warn(t);break;case r.Error:console.error(t)}}},{key:"format",value:function(e){return"Message: "+e.message+" Data: "+JSON.stringify(e.data)}}]),e}();t.ConsoleListener=u;var s=function(){function e(t){n(this,e),this.method=t}return o(e,[{key:"log",value:function(e){this.method(e)}}]),e}();t.FunctionListener=s},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e){s.set(e)}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(5),u=function(){function e(){r(this,e),this._headers=null,this._defaultCachingStore="session",this._defaultCachingTimeoutSeconds=30,this._globalCacheDisable=!1,this._fetchClientFactory=function(){return new a.FetchClient},this._baseUrl=null,this._spfxContext=null}return i(e,[{key:"set",value:function(e){e.hasOwnProperty("headers")&&(this._headers=e.headers),e.hasOwnProperty("globalCacheDisable")&&(this._globalCacheDisable=e.globalCacheDisable),e.hasOwnProperty("defaultCachingStore")&&(this._defaultCachingStore=e.defaultCachingStore),e.hasOwnProperty("defaultCachingTimeoutSeconds")&&(this._defaultCachingTimeoutSeconds=e.defaultCachingTimeoutSeconds),e.hasOwnProperty("fetchClientFactory")&&(this._fetchClientFactory=e.fetchClientFactory),e.hasOwnProperty("baseUrl")&&(this._baseUrl=e.baseUrl),e.hasOwnProperty("spFXContext")&&(this._spfxContext=e.spfxContext)}},{key:"headers",get:function(){return this._headers}},{key:"defaultCachingStore",get:function(){return this._defaultCachingStore}},{key:"defaultCachingTimeoutSeconds",get:function(){return this._defaultCachingTimeoutSeconds}},{key:"globalCacheDisable",get:function(){return this._globalCacheDisable}},{key:"fetchClientFactory",get:function(){return this._fetchClientFactory}},{key:"baseUrl",get:function(){return null!==this._baseUrl?this._baseUrl:null!==this._spfxContext?this._spfxContext.pageContext.web.absoluteUrl:null}}]),e}();t.RuntimeConfigImpl=u;var s=new u;t.RuntimeConfig=s,t.setRuntimeConfig=o},function(e,t){(function(e){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function t(){n(this,t)}return r(t,[{key:"fetch",value:function(t,n){return e.fetch(t,n)}}]),t}();t.FetchClient=o}).call(t,function(){return this}())},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(1),a=function(){function e(t,n){r(this,e),this.store=t,this.defaultTimeoutMinutes=n,this.defaultTimeoutMinutes=void 0===n?5:n,this.enabled=this.test()}return o(e,[{key:"get",value:function(e){if(!this.enabled)return null;var t=this.store.getItem(e);if(null==t)return null;var n=JSON.parse(t);return new Date(n.expiration)<=new Date?(this.delete(e),null):n.value}},{key:"put",value:function(e,t,n){this.enabled&&this.store.setItem(e,this.createPersistable(t,n))}},{key:"delete",value:function(e){this.enabled&&this.store.removeItem(e)}},{key:"getOrPut",value:function(e,t,n){var r=this;return this.enabled?new Promise(function(o){var i=r.get(e);null==i?t().then(function(t){r.put(e,t,n),o(t)}):o(i)}):t()}},{key:"test",value:function(){var e="test";try{return this.store.setItem(e,e),this.store.removeItem(e),!0}catch(e){return!1}}},{key:"createPersistable",value:function(e,t){return"undefined"==typeof t&&(t=i.Util.dateAdd(new Date,"minute",this.defaultTimeoutMinutes)),JSON.stringify({expiration:t,value:e})}}]),e}();t.PnPClientStorageWrapper=a;var u=function e(){r(this,e),this.local="undefined"!=typeof localStorage?new a(localStorage):null,this.session="undefined"!=typeof sessionStorage?new a(sessionStorage):null};t.PnPClientStorage=u},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(8),a=function(){function e(){r(this,e),this._settings=new i.Dictionary}return o(e,[{key:"add",value:function(e,t){this._settings.add(e,t)}},{key:"addJSON",value:function(e,t){this._settings.add(e,JSON.stringify(t))}},{key:"apply",value:function(e){var t=this;return new Promise(function(n,r){try{t._settings.merge(e),n()}catch(e){r(e)}})}},{key:"load",value:function(e){var t=this;return new Promise(function(n,r){e.getConfiguration().then(function(e){t._settings.merge(e),n()}).catch(function(e){r(e)})})}},{key:"get",value:function(e){return this._settings.get(e)}},{key:"getJSON",value:function(e){var t=this.get(e);return"undefined"==typeof t||null===t?t:JSON.parse(t)}}]),e}();t.Settings=a},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];n(this,e),this.keys=t,this.values=r}return r(e,[{key:"get",value:function(e){var t=this.keys.indexOf(e);return t<0?null:this.values[t]}},{key:"add",value:function(e,t){var n=this.keys.indexOf(e);n>-1?this.values[n]=t:(this.keys.push(e),this.values.push(t))}},{key:"merge",value:function(e){var t=this;if("getKeys"in e)!function(){var n=e;n.getKeys().map(function(e){t.add(e,n.get(e))})}();else{var n=e;for(var r in n)n.hasOwnProperty(r)&&this.add(r,n[r])}}},{key:"remove",value:function(e){var t=this.keys.indexOf(e);if(t<0)return null;var n=this.values[t];return this.keys.splice(t,1),this.values.splice(t,1),n}},{key:"getKeys",value:function(){return this.keys}},{key:"getValues",value:function(){return this.values}},{key:"clear",value:function(){this.keys=[],this.values=[]}},{key:"count",value:function(){return this.keys.length}}]),e}();t.Dictionary=o},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(10),a=n(18),u=n(19),s=n(20),l=n(1),c=n(40),f=n(15),h=function(){function e(){r(this,e)}return o(e,[{key:"searchSuggest",value:function(e){var t=void 0;return t="string"==typeof e?{querytext:e}:e,new a.SearchSuggest("").execute(t)}},{key:"search",value:function(e){var t=void 0;return t="string"==typeof e?{Querytext:e}:e,new i.Search("").execute(t)}},{key:"createBatch",value:function(){return this.web.createBatch()}},{key:"crossDomainSite",value:function(e,t){return this._cdImpl(u.Site,e,t,"site")}},{key:"crossDomainWeb",value:function(e,t){return this._cdImpl(s.Web,e,t,"web")}},{key:"_cdImpl",value:function(e,t,n,r){if(!l.Util.isUrlAbsolute(t))throw new f.UrlException("The addInWebUrl parameter must be an absolute url.");if(!l.Util.isUrlAbsolute(n))throw new f.UrlException("The hostWebUrl parameter must be an absolute url.");var o=l.Util.combinePaths(t,"_api/SP.AppContextSite(@target)"),i=new e(o,r);return i.query.add("@target","'"+encodeURIComponent(n)+"'"),i}},{key:"site",get:function(){return new u.Site("")}},{key:"web",get:function(){return new s.Web("")}},{key:"profiles",get:function(){return new c.UserProfileQuery("")}}]),e}();t.Rest=h},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(11),s=n(1),l=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"_api/search/postquery";return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),a(t,[{key:"execute",value:function(e){var t=void 0;t=e,t.SelectProperties&&(t.SelectProperties={results:e.SelectProperties}),t.RefinementFilters&&(t.RefinementFilters={results:e.RefinementFilters}),t.SortList&&(t.SortList={results:e.SortList}),t.HithighlightedProperties&&(t.HithighlightedProperties={results:e.HithighlightedProperties}),t.ReorderingRules&&(t.ReorderingRules={results:e.ReorderingRules}),t.Properties&&(t.Properties={results:e.Properties});var n=JSON.stringify({request:s.Util.extend({__metadata:{type:"Microsoft.Office.Server.Search.REST.SearchRequest"}},t)});return this.post({body:n}).then(function(e){return new c(e)})}}]),t}(u.QueryableInstance);t.Search=l;var c=function(){function e(t){r(this,e);var n=t.postquery?t.postquery:t;this.PrimarySearchResults=this.formatSearchResults(n.PrimaryQueryResult.RelevantResults.Table.Rows),this.RawSearchResults=n,this.ElapsedTime=n.ElapsedTime,this.RowCount=n.PrimaryQueryResult.RelevantResults.RowCount,this.TotalRows=n.PrimaryQueryResult.RelevantResults.TotalRows,this.TotalRowsIncludingDuplicates=n.PrimaryQueryResult.RelevantResults.TotalRowsIncludingDuplicates}return a(e,[{key:"formatSearchResults",value:function(e){var t=new Array,n=e.results?e.results:e,r=!0,o=!1,i=void 0;try{for(var a,u=n[Symbol.iterator]();!(r=(a=u.next()).done);r=!0){var s=a.value;t.push(new f(s.Cells))}}catch(e){o=!0,i=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw i}}return t}}]),e}();t.SearchResults=c;var f=function e(t){r(this,e);var n=t.results?t.results:t,o=!0,i=!1,a=void 0;try{for(var u,s=n[Symbol.iterator]();!(o=(u=s.next()).done);o=!0){var l=u.value;Object.defineProperty(this,l.Key,{configurable:!1,enumerable:!1,value:l.Value,writable:!1})}}catch(e){i=!0,a=e}finally{try{!o&&s.return&&s.return()}finally{if(i)throw a}}};t.SearchResult=f;var h;!function(e){e[e.Ascending=0]="Ascending",e[e.Descending=1]="Descending",e[e.FQLFormula=2]="FQLFormula"}(h=t.SortDirection||(t.SortDirection={}));var p;!function(e){e[e.ResultContainsKeyword=0]="ResultContainsKeyword",e[e.TitleContainsKeyword=1]="TitleContainsKeyword",e[e.TitleMatchesKeyword=2]="TitleMatchesKeyword",e[e.UrlStartsWith=3]="UrlStartsWith",e[e.UrlExactlyMatches=4]="UrlExactlyMatches",e[e.ContentTypeIs=5]="ContentTypeIs",e[e.FileExtensionMatches=6]="FileExtensionMatches",e[e.ResultHasTag=7]="ResultHasTag",e[e.ManualCondition=8]="ManualCondition"}(p=t.ReorderingRuleMatchType||(t.ReorderingRuleMatchType={}));var y;!function(e){e[e.None=0]="None",e[e.StringType=1]="StringType",e[e.Int32TYpe=2]="Int32TYpe",e[e.BooleanType=3]="BooleanType",e[e.StringArrayType=4]="StringArrayType",e[e.UnSupportedType=5]="UnSupportedType"}(y=t.QueryPropertyValueType||(t.QueryPropertyValueType={}))},function(e,t,n){"use strict";function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(1),s=n(8),l=n(12),c=n(4),f=n(15),h=n(16),p=function(){function e(t,n){if(i(this,e),this._query=new s.Dictionary,this._batch=null,"string"==typeof t){var r=t;if(u.Util.isUrlAbsolute(r)||r.lastIndexOf("/")<0)this._parentUrl=r,this._url=u.Util.combinePaths(r,n);else if(r.lastIndexOf("/")>r.lastIndexOf("(")){var o=r.lastIndexOf("/");this._parentUrl=r.slice(0,o),n=u.Util.combinePaths(r.slice(o),n),this._url=u.Util.combinePaths(this._parentUrl,n)}else{var a=r.lastIndexOf("(");this._parentUrl=r.slice(0,a),this._url=u.Util.combinePaths(r,n)}}else{var l=t;this._parentUrl=l._url;var c=l._query.get("@target");null!==c&&this._query.add("@target",c),this._url=u.Util.combinePaths(this._parentUrl,n)}}return a(e,[{key:"concat",value:function(e){this._url+=e}},{key:"append",value:function(e){this._url=u.Util.combinePaths(this._url,e)}},{key:"addBatchDependency",value:function(){return this.hasBatch?this._batch.addBatchDependency():function(){return null}}},{key:"hasBatch",get:function(){return null!==this._batch}},{key:"parentUrl",get:function(){return this._parentUrl}},{key:"query",get:function(){return this._query}}]),a(e,[{key:"inBatch",value:function(e){if(null!==this._batch)throw new f.AlreadyInBatchException;return this._batch=e,this}},{key:"usingCaching",value:function(e){return c.RuntimeConfig.globalCacheDisable||(this._useCaching=!0,this._cachingOptions=e),this}},{key:"toUrl",value:function(){return this._url}},{key:"toUrlAndQuery",value:function(){var e=this,t=this.toUrl();return this._query.count()>0&&(t+="?"+this._query.getKeys().map(function(t){return t+"="+e._query.get(t)}).join("&")),t}},{key:"getParent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.parentUrl,n=arguments[2],r=new e(t,n),o=this.query.get("@target");return null!==o&&r.query.add("@target",o),r}},{key:"get",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new l.ODataDefaultParser,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.toRequestContext("GET",t,e).then(function(e){return h.pipe(e)})}},{key:"getAs",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new l.ODataDefaultParser,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.toRequestContext("GET",t,e).then(function(e){return h.pipe(e)})}},{key:"post",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new l.ODataDefaultParser;return this.toRequestContext("POST",e,t).then(function(e){return h.pipe(e)})}},{key:"postAs",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new l.ODataDefaultParser;return this.toRequestContext("POST",e,t).then(function(e){return h.pipe(e)})}},{key:"patch",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new l.ODataDefaultParser;return this.toRequestContext("PATCH",e,t).then(function(e){return h.pipe(e)})}},{key:"delete",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new l.ODataDefaultParser;return this.toRequestContext("DELETE",e,t).then(function(e){return h.pipe(e)})}},{key:"toRequestContext",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments[2],o=this.hasBatch?this.addBatchDependency():function(){};return u.Util.toAbsoluteUrl(this.toUrlAndQuery()).then(function(i){var a={batch:t._batch,batchDependency:o,cachingOptions:t._cachingOptions,isBatched:t.hasBatch,isCached:t._useCaching,options:n,parser:r,requestAbsoluteUrl:i,requestId:u.Util.getGUID(),verb:e};return a})}}]),e}();t.Queryable=p;var y=function(e){function t(){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),a(t,[{key:"filter",value:function(e){return this._query.add("$filter",e),this}},{key:"select",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return this._query.add("$select",t.join(",")),this}},{key:"expand",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return this._query.add("$expand",t.join(",")),this}},{key:"orderBy",value:function(e){for(var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this._query.getKeys(),r=[],o=t?" asc":" desc",i=0;i<n.length;i++)if("$orderby"===n[i]){r.push(this._query.get("$orderby"));break}return r.push(""+e+o),this._query.add("$orderby",r.join(",")),this}},{key:"skip",value:function(e){return this._query.add("$skip",e.toString()),this}},{key:"top",value:function(e){return this._query.add("$top",e.toString()),this}}]),t}(p);t.QueryableCollection=y;var d=function(e){function t(){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),a(t,[{key:"select",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return this._query.add("$select",t.join(",")),this}},{key:"expand",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return this._query.add("$expand",t.join(",")),this}}]),t}(p);t.QueryableInstance=d},function(e,t,n){"use strict";function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e){if(e.hasOwnProperty("odata.id"))return e["odata.id"];if(e.hasOwnProperty("__metadata")&&e.__metadata.hasOwnProperty("id"))return e.__metadata.id;throw new g.ODataIdException(e)}function u(e){return e.hasOwnProperty("odata.editLink")?p.Util.combinePaths("_api",e["odata.editLink"]):e.hasOwnProperty("__metadata")?e.__metadata.uri:(y.Logger.write("No uri information found in ODataEntity parsing, chaining will fail for this object.",y.LogLevel.Warning),"")}function s(){return new P}function l(e){return new O(e)}function c(e){return new k(e)}var f=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},h=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),p=n(1),y=n(3),d=n(13),v=n(4),g=n(15),b=n(15);t.extractOdataId=a;var w=function(){function e(){i(this,e)}return h(e,[{key:"parse",value:function(e){var t=this;return new Promise(function(n,r){t.handleError(e,r)&&(e.headers.has("Content-Length")&&0===parseFloat(e.headers.get("Content-Length"))||204===e.status?n({}):e.json().then(function(e){return n(t.parseODataJSON(e))}))})}},{key:"handleError",value:function(e,t){return e.ok||e.json().then(function(n){t(new b.ProcessHttpClientResponseException(e.status,e.statusText,n))}),e.ok}},{key:"parseODataJSON",value:function(e){var t=e;return e.hasOwnProperty("d")?t=e.d.hasOwnProperty("results")?e.d.results:e.d:e.hasOwnProperty("value")&&(t=e.value),t}}]),e}();t.ODataParserBase=w;var m=function(e){function t(){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),t}(w);t.ODataDefaultParser=m;var _=function(){function e(){i(this,e)}return h(e,[{key:"parse",value:function(e){return e.json()}}]),e}();t.ODataRawParserImpl=_;var P=function(e){function t(){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),h(t,[{key:"parse",value:function(e){return f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"parse",this).call(this,e).then(function(e){return e})}}]),t}(w),O=function(e){function t(e){i(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.factory=e,n}return o(t,e),h(t,[{key:"parse",value:function(e){var n=this;return f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"parse",this).call(this,e).then(function(e){var t=new n.factory(u(e),null);return p.Util.extend(t,e)})}}]),t}(w),k=function(e){function t(e){i(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.factory=e,n}return o(t,e),h(t,[{key:"parse",value:function(e){var n=this;return f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"parse",this).call(this,e).then(function(e){return e.map(function(e){var t=new n.factory(u(e),null);return p.Util.extend(t,e)})})}}]),t}(w);t.ODataRaw=new _,t.ODataValue=s,t.ODataEntity=l,t.ODataEntityArray=c;var T=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p.Util.getGUID();i(this,e),this.baseUrl=t,this._batchId=n,this._requests=[],this._batchDependencies=Promise.resolve()}return h(e,[{key:"add",value:function(e,t,n,r){var o={method:t.toUpperCase(),options:n,parser:r,reject:null,resolve:null,url:e},i=new Promise(function(e,t){o.resolve=e,o.reject=t});return this._requests.push(o),i}},{key:"addBatchDependency",value:function(){var e=void 0,t=new Promise(function(t){e=t});return this._batchDependencies=this._batchDependencies.then(function(){return t}),e}},{key:"execute",value:function(){var e=this;return this._batchDependencies.then(function(){return e.executeImpl()})}},{key:"executeImpl",value:function(){var e=this;if(y.Logger.write("Executing batch with "+this._requests.length+" requests.",y.LogLevel.Info),this._requests.length<1)return y.Logger.write("Resolving empty batch.",y.LogLevel.Info),Promise.resolve();
var t=new d.HttpClient;return p.Util.toAbsoluteUrl(this.baseUrl).then(function(n){var r=[],o="";e._requests.map(function(t){"GET"===t.method?(o.length>0&&(r.push("--changeset_"+o+"--\n\n"),o=""),r.push("--batch_"+e._batchId+"\n")):(o.length<1&&(o=p.Util.getGUID(),r.push("--batch_"+e._batchId+"\n"),r.push('Content-Type: multipart/mixed; boundary="changeset_'+o+'"\n\n')),r.push("--changeset_"+o+"\n")),r.push("Content-Type: application/http\n"),r.push("Content-Transfer-Encoding: binary\n\n");var i={Accept:"application/json;"},a=p.Util.isUrlAbsolute(t.url)?t.url:p.Util.combinePaths(n,t.url);if(y.Logger.write("Adding request "+t.method+" "+a+" to batch.",y.LogLevel.Verbose),"GET"!==t.method){var u=t.method;t.hasOwnProperty("options")&&t.options.hasOwnProperty("headers")&&"undefined"!=typeof t.options.headers["X-HTTP-Method"]&&(u=t.options.headers["X-HTTP-Method"],delete t.options.headers["X-HTTP-Method"]),r.push(u+" "+a+" HTTP/1.1\n"),i=p.Util.extend(i,{"Content-Type":"application/json;odata=verbose;charset=utf-8"})}else r.push(t.method+" "+a+" HTTP/1.1\n");"undefined"!=typeof v.RuntimeConfig.headers&&(i=p.Util.extend(i,v.RuntimeConfig.headers)),t.options&&t.options.headers&&(i=p.Util.extend(i,t.options.headers));for(var s in i)i.hasOwnProperty(s)&&r.push(s+": "+i[s]+"\n");r.push("\n"),t.options.body&&r.push(t.options.body+"\n\n")}),o.length>0&&(r.push("--changeset_"+o+"--\n\n"),o=""),r.push("--batch_"+e._batchId+"--\n");var i={"Content-Type":"multipart/mixed; boundary=batch_"+e._batchId},a={body:r.join(""),headers:i};return y.Logger.write("Sending batch request.",y.LogLevel.Info),t.post(p.Util.combinePaths(n,"/_api/$batch"),a).then(function(e){return e.text()}).then(e._parseResponse).then(function(t){if(t.length!==e._requests.length)throw new g.BatchParseException("Could not properly parse responses to match requests in batch.");return y.Logger.write("Resolving batched requests.",y.LogLevel.Info),t.reduce(function(t,n,r){var o=e._requests[r];return y.Logger.write("Resolving request "+o.method+" "+o.url+".",y.LogLevel.Verbose),t.then(function(e){return o.parser.parse(n).then(o.resolve).catch(o.reject)})},Promise.resolve())})})}},{key:"_parseResponse",value:function(e){return new Promise(function(t,n){for(var r=[],o="--batchresponse_",i=new RegExp("^HTTP/[0-9.]+ +([0-9]+) +(.*)","i"),a=e.split("\n"),u="batch",s=void 0,l=void 0,c=0;c<a.length;++c){var f=a[c];switch(u){case"batch":if(f.substr(0,o.length)===o)u="batchHeaders";else if(""!==f.trim())throw new g.BatchParseException("Invalid response, line "+c);break;case"batchHeaders":""===f.trim()&&(u="status");break;case"status":var h=i.exec(f);if(3!==h.length)throw new g.BatchParseException("Invalid status, line "+c);s=parseInt(h[1],10),l=h[2],u="statusHeaders";break;case"statusHeaders":""===f.trim()&&(u="body");break;case"body":r.push(204===s?new Response:new Response(f,{status:s,statusText:l})),u="batch"}}"status"!==u&&n(new g.BatchParseException("Unexpected end of input")),t(r)})}}]),e}();t.ODataBatch=T;var S=function(){function e(){i(this,e)}return h(e,[{key:"parse",value:function(e){return e.text()}}]),e}();t.TextFileParser=S;var C=function(){function e(){i(this,e)}return h(e,[{key:"parse",value:function(e){return e.blob()}}]),e}();t.BlobFileParser=C;var x=function(){function e(){i(this,e)}return h(e,[{key:"parse",value:function(e){return e.json()}}]),e}();t.JSONFileParser=x;var E=function(){function e(){i(this,e)}return h(e,[{key:"parse",value:function(e){return p.Util.isFunction(e.arrayBuffer)?e.arrayBuffer():e.buffer()}}]),e}();t.BufferFileParser=E},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(14),a=n(1),u=n(4),s=n(15),l=function(){function e(){r(this,e),this._impl=u.RuntimeConfig.fetchClientFactory(),this._digestCache=new i.DigestCache(this)}return o(e,[{key:"fetch",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=a.Util.extend(n,{cache:"no-cache",credentials:"same-origin"},!0),o=new Headers;if(this.mergeHeaders(o,u.RuntimeConfig.headers),this.mergeHeaders(o,n.headers),o.has("Accept")||o.append("Accept","application/json"),o.has("Content-Type")||o.append("Content-Type","application/json;odata=verbose;charset=utf-8"),o.has("X-ClientService-ClientTag")||o.append("X-ClientService-ClientTag","PnPCoreJS:2.0.1"),r=a.Util.extend(r,{headers:o}),r.method&&"GET"!==r.method.toUpperCase()&&!o.has("X-RequestDigest")){var i=e.indexOf("_api/");if(i<0)throw new s.APIUrlException;var l=e.substr(0,i);return this._digestCache.getDigest(l).then(function(n){return o.append("X-RequestDigest",n),t.fetchRaw(e,r)})}return this.fetchRaw(e,r)}},{key:"fetchRaw",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new Headers;this.mergeHeaders(r,n.headers),n=a.Util.extend(n,{headers:r});var o=function r(o){t._impl.fetch(e,n).then(function(e){return o.resolve(e)}).catch(function(e){var n=o.delay;429!==e.status&&503!==e.status&&o.reject(e),o.delay*=2,o.attempts++,o.retryCount<=o.attempts&&o.reject(e),setTimeout(a.Util.getCtxCallback(t,r,o),n)})};return new Promise(function(e,n){var r={attempts:0,delay:100,reject:n,resolve:e,retryCount:7};o.call(t,r)})}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=a.Util.extend(t,{method:"GET"});return this.fetch(e,n)}},{key:"post",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=a.Util.extend(t,{method:"POST"});return this.fetch(e,n)}},{key:"patch",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=a.Util.extend(t,{method:"PATCH"});return this.fetch(e,n)}},{key:"delete",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=a.Util.extend(t,{method:"DELETE"});return this.fetch(e,n)}},{key:"mergeHeaders",value:function(e,t){if("undefined"!=typeof t&&null!==t){var n=new Request("",{headers:t});n.headers.forEach(function(t,n){e.append(n,t)})}}}]),e}();t.HttpClient=l},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(8),a=n(1),u=n(12),s=function e(){r(this,e)};t.CachedDigest=s;var l=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new i.Dictionary;r(this,e),this._httpClient=t,this._digests=n}return o(e,[{key:"getDigest",value:function(e){var t=this,n=this._digests.get(e);if(null!==n){var r=new Date;if(r<n.expiration)return Promise.resolve(n.value)}var o=a.Util.combinePaths(e,"/_api/contextinfo");return this._httpClient.fetchRaw(o,{cache:"no-cache",credentials:"same-origin",headers:{Accept:"application/json;odata=verbose","Content-type":"application/json;odata=verbose;charset=utf-8"},method:"POST"}).then(function(e){var t=new u.ODataDefaultParser;return t.parse(e).then(function(e){return e.GetContextWebInformation})}).then(function(n){var r=new s;r.value=n.FormDigestValue;var o=n.FormDigestTimeoutSeconds,i=new Date;return i.setTime(i.getTime()+1e3*o),r.expiration=i,t._digests.add(e,r),r.value})}},{key:"clear",value:function(){this._digests.clear()}}]),e}();t.DigestCache=l},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){u.Logger.log({data:{},level:u.LogLevel.Error,message:"["+e.name+"]::"+e.message})}var u=n(3),s=function(e){function t(e,n,i){r(this,t);var a=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Error making HttpClient request in queryable: ["+e+"] "+n));return a.status=e,a.statusText=n,a.data=i,a.name="ProcessHttpClientResponseException",u.Logger.log({data:a.data,level:u.LogLevel.Error,message:a.message}),a}return i(t,e),t}(Error);t.ProcessHttpClientResponseException=s;var l=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Cannot create a caching configuration provider since cache is not available.";r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.name="NoCacheAvailableException",a(n),n}return i(t,e),t}(Error);t.NoCacheAvailableException=l;var c=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unable to determine API url.";r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.name="APIUrlException",a(n),n}return i(t,e),t}(Error);t.APIUrlException=c;var f=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Auth URL Endpoint could not be determined from data. Data logged.";r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.name="APIUrlException",u.Logger.log({data:e,level:u.LogLevel.Error,message:i.message}),i}return i(t,e),t}(Error);t.AuthUrlException=f;var h=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Using NodeFetchClient in the browser is not supported.";r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.name="NodeFetchClientUnsupportedException",a(n),n}return i(t,e),t}(Error);t.NodeFetchClientUnsupportedException=h;var p=function(e){function t(){r(this,t);var e=["SP.RequestExecutor is undefined. ","Load the SP.RequestExecutor.js library (/_layouts/15/SP.RequestExecutor.js) before loading the PnP JS Core library."].join(" "),n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.name="SPRequestExecutorUndefinedException",a(n),n}return i(t,e),t}(Error);t.SPRequestExecutorUndefinedException=p;var y=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"The maximum comment length is 1023 characters.";r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.name="MaxCommentLengthException",a(n),n}return i(t,e),t}(Error);t.MaxCommentLengthException=y;var d=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"This operation";r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e+" is not supported as part of a batch."));return n.name="NotSupportedInBatchException",a(n),n}return i(t,e),t}(Error);t.NotSupportedInBatchException=d;var v=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Could not extract odata id in object, you may be using nometadata. Object data logged to logger.";r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i.name="ODataIdException",u.Logger.log({data:e,level:u.LogLevel.Error,message:i.message}),i}return i(t,e),t}(Error);t.ODataIdException=v;var g=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.name="BatchParseException",a(n),n}return i(t,e),t}(Error);t.BatchParseException=g;var b=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"This query is already part of a batch.";r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.name="AlreadyInBatchException",a(n),n}return i(t,e),t}(Error);t.AlreadyInBatchException=b;var w=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"This query is already part of a batch.";r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.name="FunctionExpectedException",a(n),n}return i(t,e),t}(Error);t.FunctionExpectedException=w;var m=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.name="UrlException",a(n),n}return i(t,e),t}(Error);t.UrlException=m},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e){var t=[p.logStart,p.caching,p.send,p.logEnd];return t.reduce(function(e,t){return e.then(function(e){return t(e)})},Promise.resolve(e)).then(function(e){return p.returnResult(e)}).catch(function(e){throw f.Logger.log({data:e,level:f.LogLevel.Error,message:"Error in request pipeline: "+e.message}),e})}function i(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(t,n,r){var o=r.value;r.value=function(){for(var r=arguments.length,i=Array(r),a=0;a<r;a++)i[a]=arguments[a];return!e&&i.length>0&&i[0].hasOwnProperty("hasResult")&&i[0].hasResult?(f.Logger.write("["+i[0].requestId+"] ("+(new Date).getTime()+") Skipping request pipeline method "+n+", existing result in pipeline.",f.LogLevel.Verbose),Promise.resolve(i[0])):(f.Logger.write("["+i[0].requestId+"] ("+(new Date).getTime()+") Calling request pipeline method "+n+".",f.LogLevel.Verbose),o.apply(t,i))}}}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":u(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},l=n(17),c=n(13),f=n(3),h=n(1);t.pipe=o;var p=function(){function e(){r(this,e)}return a(e,null,[{key:"logStart",value:function(e){return new Promise(function(t){f.Logger.log({data:f.Logger.activeLogLevel===f.LogLevel.Info?{}:e,level:f.LogLevel.Info,message:"["+e.requestId+"] ("+(new Date).getTime()+") Beginning "+e.verb+" request to "+e.requestAbsoluteUrl}),t(e)})}},{key:"caching",value:function(t){return new Promise(function(n){if("GET"===t.verb&&t.isCached){f.Logger.write("["+t.requestId+"] ("+(new Date).getTime()+") Caching is enabled for request, checking cache...",f.LogLevel.Info);var r=new l.CachingOptions(t.requestAbsoluteUrl.toLowerCase());if("undefined"!=typeof t.cachingOptions&&(r=h.Util.extend(r,t.cachingOptions)),null!==r.store){var o=r.store.get(r.key);if(null!==o)return f.Logger.log({data:f.Logger.activeLogLevel===f.LogLevel.Info?{}:o,level:f.LogLevel.Info,message:"["+t.requestId+"] ("+(new Date).getTime()+") Value returned from cache."}),t.batchDependency(),e.setResult(t,o).then(function(e){return n(e)})}f.Logger.write("["+t.requestId+"] ("+(new Date).getTime()+") Value not found in cache.",f.LogLevel.Info),t.parser=new l.CachingParserWrapper(t.parser,r)}return n(t)})}},{key:"send",value:function(t){return new Promise(function(n,r){if(t.isBatched){var o=t.batch.add(t.requestAbsoluteUrl,t.verb,t.options,t.parser);t.batchDependency(),f.Logger.write("["+t.requestId+"] ("+(new Date).getTime()+") Batching request.",f.LogLevel.Info),n(o.then(function(n){return e.setResult(t,n)}))}else{f.Logger.write("["+t.requestId+"] ("+(new Date).getTime()+") Sending request.",f.LogLevel.Info);var i=new c.HttpClient,a=h.Util.extend(t.options,{method:t.verb});i.fetch(t.requestAbsoluteUrl,a).then(function(e){return t.parser.parse(e)}).then(function(n){return e.setResult(t,n)}).then(function(e){return n(e)}).catch(function(e){return r(e)})}})}},{key:"logEnd",value:function(e){return new Promise(function(t){f.Logger.log({data:f.Logger.activeLogLevel===f.LogLevel.Info?{}:e,level:f.LogLevel.Info,message:"["+e.requestId+"] ("+(new Date).getTime()+") Completing "+e.verb+" request to "+e.requestAbsoluteUrl}),t(e)})}},{key:"returnResult",value:function(e){return f.Logger.log({data:e.result,level:f.LogLevel.Verbose,message:"["+e.requestId+"] ("+(new Date).getTime()+") Returning, see data property for value."}),Promise.resolve(e.result)}},{key:"setResult",value:function(e,t){return new Promise(function(n){e.result=t,e.hasResult=!0,n(e)})}}]),e}();s([i(!0)],p,"logStart",null),s([i()],p,"caching",null),s([i()],p,"send",null),s([i(!0)],p,"logEnd",null),s([i(!0)],p,"returnResult",null)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(6),a=n(1),u=n(4),s=function(){function e(t){r(this,e),this.key=t,this.expiration=a.Util.dateAdd(new Date,"second",u.RuntimeConfig.defaultCachingTimeoutSeconds),this.storeName=u.RuntimeConfig.defaultCachingStore}return o(e,[{key:"store",get:function(){return"local"===this.storeName?e.storage.local:e.storage.session}}]),e}();s.storage=new i.PnPClientStorage,t.CachingOptions=s;var l=function(){function e(t,n){r(this,e),this._parser=t,this._cacheOptions=n}return o(e,[{key:"parse",value:function(e){var t=this;return this._parser.parse(e).then(function(e){return null!==t._cacheOptions.store&&t._cacheOptions.store.put(t._cacheOptions.key,e,t._cacheOptions.expiration),e})}}]),e}();t.CachingParserWrapper=l},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(11),s=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"_api/search/suggest";return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),a(t,[{key:"execute",value:function(e){return this.mapQueryToQueryString(e),this.get().then(function(e){return new l(e)})}},{key:"mapQueryToQueryString",value:function(e){this.query.add("querytext","'"+e.querytext+"'"),e.hasOwnProperty("count")&&this.query.add("inumberofquerysuggestions",e.count.toString()),e.hasOwnProperty("personalCount")&&this.query.add("inumberofresultsuggestions",e.personalCount.toString()),e.hasOwnProperty("preQuery")&&this.query.add("fprequerysuggestions",e.preQuery.toString()),e.hasOwnProperty("hitHighlighting")&&this.query.add("fhithighlighting",e.hitHighlighting.toString()),e.hasOwnProperty("capitalize")&&this.query.add("fcapitalizefirstletters",e.capitalize.toString()),e.hasOwnProperty("culture")&&this.query.add("culture",e.culture.toString()),e.hasOwnProperty("stemming")&&this.query.add("enablestemming",e.stemming.toString()),e.hasOwnProperty("includePeople")&&this.query.add("showpeoplenamesuggestions",e.includePeople.toString()),e.hasOwnProperty("queryRules")&&this.query.add("enablequeryrules",e.queryRules.toString()),e.hasOwnProperty("prefixMatch")&&this.query.add("fprefixmatchallterms",e.prefixMatch.toString())}}]),t}(u.QueryableInstance);t.SearchSuggest=s;var l=function e(t){r(this,e),t.hasOwnProperty("suggest")?(this.PeopleNames=t.suggest.PeopleNames.results,this.PersonalResults=t.suggest.PersonalResults.results,this.Queries=t.suggest.Queries.results):(this.PeopleNames=t.PeopleNames,this.PersonalResults=t.PersonalResults,this.Queries=t.Queries)};t.SearchSuggestResult=l},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(11),s=n(20),l=n(37),c=n(12),f=n(39),h=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"_api/site";return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),a(t,[{key:"getContextInfo",value:function(){var e=new t(this.parentUrl,"_api/contextinfo");return e.post().then(function(e){if(e.hasOwnProperty("GetContextWebInformation")){var t=e.GetContextWebInformation;return t.SupportedSchemaVersions=t.SupportedSchemaVersions.results,t}return e})}},{key:"getDocumentLibraries",value:function(e){var t=new u.Queryable("","_api/sp.web.getdocumentlibraries(@v)");return t.query.add("@v","'"+e+"'"),t.get().then(function(e){return e.hasOwnProperty("GetDocumentLibraries")?e.GetDocumentLibraries:e})}},{key:"getWebUrlFromPageUrl",value:function(e){var t=new u.Queryable("","_api/sp.web.getweburlfrompageurl(@v)");return t.query.add("@v","'"+e+"'"),t.get().then(function(e){return e.hasOwnProperty("GetWebUrlFromPageUrl")?e.GetWebUrlFromPageUrl:e})}},{key:"createBatch",value:function(){return new c.ODataBatch(this.parentUrl)}},{key:"rootWeb",get:function(){return new s.Web(this,"rootweb")}},{key:"features",get:function(){return new f.Features(this)}},{key:"userCustomActions",get:function(){return new l.UserCustomActions(this)}}]),t}(u.QueryableInstance);t.Site=h},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(11),l=n(21),c=n(25),f=n(33),h=n(38),p=n(23),y=n(30),d=n(27),v=n(22),g=n(28),b=n(1),w=n(25),m=n(24),_=n(37),P=n(12),O=n(39),k=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"webs";return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),u(t,[{key:"add",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"STS",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1033,a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},s=b.Util.extend({Description:r,Language:i,Title:e,Url:n,UseSamePermissionsAsParentSite:a,WebTemplate:o},u),l=JSON.stringify({parameters:b.Util.extend({__metadata:{type:"SP.WebCreationInformation"}},s)}),c=new t(this,"add");return c.post({body:l}).then(function(e){return{data:e,web:new T(P.extractOdataId(e).replace(/_api\/web\/?/i,""))}})}}]),t}(s.QueryableCollection);t.Webs=k;var T=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"_api/web";return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),u(t,[{key:"createBatch",value:function(){return new P.ODataBatch(this.parentUrl)}},{key:"getFolderByServerRelativeUrl",value:function(e){return new d.Folder(this,"getFolderByServerRelativeUrl('"+e+"')")}},{key:"getFileByServerRelativeUrl",value:function(e){return new g.File(this,"getFileByServerRelativeUrl('"+e+"')")}},{key:"getList",value:function(e){return new w.List(this,"getList('"+e+"')")}},{key:"update",value:function(e){var t=this,n=JSON.stringify(b.Util.extend({__metadata:{type:"SP.Web"}},e));return this.post({body:n,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,web:t}})}},{key:"delete",value:function(){return a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"delete",this).call(this)}},{key:"applyTheme",value:function(e,n,r,o){var i=JSON.stringify({backgroundImageUrl:r,colorPaletteUrl:e,fontSchemeUrl:n,shareGenerated:o}),a=new t(this,"applytheme");return a.post({body:i})}},{key:"applyWebTemplate",value:function(e){var n=new t(this,"applywebtemplate");return n.concat("(@t)"),n.query.add("@t",e),n.post()}},{key:"doesUserHavePermissions",value:function(e){var n=new t(this,"doesuserhavepermissions");return n.concat("(@p)"),n.query.add("@p",JSON.stringify(e)),n.get()}},{key:"ensureUser",value:function(e){var n=JSON.stringify({logonName:e}),r=new t(this,"ensureuser");return r.post({body:n})}},{key:"availableWebTemplates",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1033,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new s.QueryableCollection(this,"getavailablewebtemplates(lcid="+e+", doincludecrosslanguage="+t+")")}},{key:"getCatalog",value:function(e){var n=new t(this,"getcatalog("+e+")");return n.select("Id"),n.get().then(function(e){return new w.List(P.extractOdataId(e))})}},{key:"getChanges",value:function(e){var n=JSON.stringify({query:b.Util.extend({__metadata:{type:"SP.ChangeQuery"}},e)}),r=new t(this,"getchanges");return r.post({body:n})}},{key:"getUserById",value:function(e){return new m.SiteUser(this,"getUserById("+e+")")}},{key:"mapToIcon",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=new t(this,"maptoicon(filename='"+e+"', progid='"+r+"', size="+n+")");return o.get()}},{key:"webs",get:function(){return new k(this)}},{key:"contentTypes",get:function(){return new y.ContentTypes(this)}},{key:"lists",get:function(){return new c.Lists(this)}},{key:"fields",get:function(){return new f.Fields(this)}},{key:"features",get:function(){return new O.Features(this)}},{key:"availablefields",get:function(){return new f.Fields(this,"availablefields")}},{key:"navigation",get:function(){return new h.Navigation(this)}},{key:"siteUsers",get:function(){return new m.SiteUsers(this)}},{key:"siteGroups",get:function(){return new p.SiteGroups(this)}},{key:"currentUser",get:function(){return new m.CurrentUser(this)}},{key:"folders",get:function(){return new d.Folders(this)}},{key:"userCustomActions",get:function(){return new _.UserCustomActions(this)}},{key:"roleDefinitions",get:function(){return new v.RoleDefinitions(this)}},{key:"customListTemplate",get:function(){return new s.QueryableCollection(this,"getcustomlisttemplates")}}]),t}(l.QueryableSecurable);t.Web=T},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(22),s=n(11),l=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),a(t,[{key:"getUserEffectivePermissions",value:function(e){var t=new s.Queryable(this,"getUserEffectivePermissions(@user)");return t.query.add("@user","'"+encodeURIComponent(e)+"'"),t}},{key:"breakRoleInheritance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=function(e){function t(e,n,i){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,"breakroleinheritance(copyroleassignments="+n+", clearsubscopes="+i+")"))}return i(t,e),a(t,[{key:"break",value:function(){return this.post()}}]),t}(s.Queryable),u=new n(this,e,t);return u.break()}},{key:"resetRoleInheritance",value:function(){var e=function(e){function t(e){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,"resetroleinheritance"))}return i(t,e),a(t,[{key:"reset",value:function(){return this.post()}}]),t}(s.Queryable),t=new e(this);return t.reset()}},{key:"roleAssignments",get:function(){return new u.RoleAssignments(this)}},{key:"firstUniqueAncestorSecurableObject",get:function(){return new s.QueryableInstance(this,"FirstUniqueAncestorSecurableObject")}}]),t}(s.QueryableInstance);t.QueryableSecurable=l},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(11),s=n(23),l=n(1),c=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"roleassignments";return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),a(t,[{key:"add",value:function(e,n){var r=new t(this,"addroleassignment(principalid="+e+", roledefid="+n+")");return r.post()}},{key:"remove",value:function(e,n){
var r=new t(this,"removeroleassignment(principalid="+e+", roledefid="+n+")");return r.post()}},{key:"getById",value:function(e){var t=new f(this);return t.concat("("+e+")"),t}}]),t}(u.QueryableCollection);t.RoleAssignments=c;var f=function(e){function t(e,n){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),a(t,[{key:"delete",value:function(){return this.post({headers:{"X-HTTP-Method":"DELETE"}})}},{key:"groups",get:function(){return new s.SiteGroups(this,"groups")}},{key:"bindings",get:function(){return new y(this)}}]),t}(u.QueryableInstance);t.RoleAssignment=f;var h=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"roledefinitions";return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),a(t,[{key:"getById",value:function(e){return new p(this,"getById("+e+")")}},{key:"getByName",value:function(e){return new p(this,"getbyname('"+e+"')")}},{key:"getByType",value:function(e){return new p(this,"getbytype("+e+")")}},{key:"add",value:function(e,t,n,r){var o=this,i=JSON.stringify({BasePermissions:l.Util.extend({__metadata:{type:"SP.BasePermissions"}},r),Description:t,Name:e,Order:n,__metadata:{type:"SP.RoleDefinition"}});return this.post({body:i}).then(function(e){return{data:e,definition:o.getById(e.Id)}})}}]),t}(u.QueryableCollection);t.RoleDefinitions=h;var p=function(e){function t(e,n){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),a(t,[{key:"update",value:function(e){var t=this;"undefined"!=typeof e.hasOwnProperty("BasePermissions")&&(e.BasePermissions=l.Util.extend({__metadata:{type:"SP.BasePermissions"}},e.BasePermissions));var n=JSON.stringify(l.Util.extend({__metadata:{type:"SP.RoleDefinition"}},e));return this.post({body:n,headers:{"X-HTTP-Method":"MERGE"}}).then(function(n){var r=t;if(e.hasOwnProperty("Name")){var o=t.getParent(h,t.parentUrl,"");r=o.getByName(e.Name)}return{data:n,definition:r}})}},{key:"delete",value:function(){return this.post({headers:{"X-HTTP-Method":"DELETE"}})}}]),t}(u.QueryableInstance);t.RoleDefinition=p;var y=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"roledefinitionbindings";return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),t}(u.QueryableCollection);t.RoleDefinitionBindings=y},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a,u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(11),l=n(24),c=n(1);!function(e){e[e.None=0]="None",e[e.User=1]="User",e[e.DistributionList=2]="DistributionList",e[e.SecurityGroup=4]="SecurityGroup",e[e.SharePointGroup=8]="SharePointGroup",e[e.All=15]="All"}(a=t.PrincipalType||(t.PrincipalType={}));var f=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"sitegroups";return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),u(t,[{key:"add",value:function(e){var t=this,n=JSON.stringify(c.Util.extend({__metadata:{type:"SP.Group"}},e));return this.post({body:n}).then(function(e){return{data:e,group:t.getById(e.Id)}})}},{key:"getByName",value:function(e){return new h(this,"getByName('"+e+"')")}},{key:"getById",value:function(e){var t=new h(this);return t.concat("("+e+")"),t}},{key:"removeById",value:function(e){var n=new t(this,"removeById('"+e+"')");return n.post()}},{key:"removeByLoginName",value:function(e){var n=new t(this,"removeByLoginName('"+e+"')");return n.post()}}]),t}(s.QueryableCollection);t.SiteGroups=f;var h=function(e){function t(e,n){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),u(t,[{key:"update",value:function(e){var n=this,r=c.Util.extend({__metadata:{type:"SP.Group"}},e);return this.post({body:JSON.stringify(r),headers:{"X-HTTP-Method":"MERGE"}}).then(function(r){var o=n;return e.hasOwnProperty("Title")&&(o=n.getParent(t,n.parentUrl,"getByName('"+e.Title+"')")),{data:r,group:o}})}},{key:"users",get:function(){return new l.SiteUsers(this,"users")}}]),t}(s.QueryableInstance);t.SiteGroup=h},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(11),s=n(23),l=n(1),c=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"siteusers";return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),a(t,[{key:"getByEmail",value:function(e){return new f(this,"getByEmail('"+e+"')")}},{key:"getById",value:function(e){return new f(this,"getById("+e+")")}},{key:"getByLoginName",value:function(e){var t=new f(this);return t.concat("(@v)"),t.query.add("@v",encodeURIComponent(e)),t}},{key:"removeById",value:function(e){var n=new t(this,"removeById("+e+")");return n.post()}},{key:"removeByLoginName",value:function(e){var n=new t(this,"removeByLoginName(@v)");return n.query.add("@v",encodeURIComponent(e)),n.post()}},{key:"add",value:function(e){var t=this,n=JSON.stringify({__metadata:{type:"SP.User"},LoginName:e});return this.post({body:n}).then(function(){return t.getByLoginName(e)})}}]),t}(u.QueryableCollection);t.SiteUsers=c;var f=function(e){function t(e,n){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),a(t,[{key:"update",value:function(e){var t=this,n=l.Util.extend({__metadata:{type:"SP.User"}},e);return this.post({body:JSON.stringify(n),headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,user:t}})}},{key:"delete",value:function(){return this.post({headers:{"X-HTTP-Method":"DELETE"}})}},{key:"groups",get:function(){return new s.SiteGroups(this,"groups")}}]),t}(u.QueryableInstance);t.SiteUser=f;var h=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"currentuser";return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),t}(u.QueryableInstance);t.CurrentUser=h},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(26),s=n(32),l=n(30),c=n(33),f=n(35),h=n(36),p=n(11),y=n(21),d=n(1),v=n(37),g=n(12),b=n(15),w=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"lists";return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),a(t,[{key:"getByTitle",value:function(e){return new m(this,"getByTitle('"+e+"')")}},{key:"getById",value:function(e){var t=new m(this);return t.concat("('"+e+"')"),t}},{key:"add",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,r=this,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=JSON.stringify(d.Util.extend({AllowContentTypes:o,BaseTemplate:n,ContentTypesEnabled:o,Description:t,Title:e,__metadata:{type:"SP.List"}},i));return this.post({body:a}).then(function(t){return{data:t,list:r.getByTitle(e)}})}},{key:"ensure",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,r=this,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};if(this.hasBatch)throw new b.NotSupportedInBatchException("The ensure list method");return new Promise(function(a,u){var s=r.getByTitle(e);s.get().then(function(e){s.update(i).then(function(e){a({created:!1,data:e,list:s})}).catch(function(e){return u(e)})}).catch(function(s){r.add(e,t,n,o,i).then(function(t){a({created:!0,data:t.data,list:r.getByTitle(e)})}).catch(function(e){return u(e)})})})}},{key:"ensureSiteAssetsLibrary",value:function(){var e=new t(this,"ensuresiteassetslibrary");return e.post().then(function(e){return new m(g.extractOdataId(e))})}},{key:"ensureSitePagesLibrary",value:function(){var e=new t(this,"ensuresitepageslibrary");return e.post().then(function(e){return new m(g.extractOdataId(e))})}}]),t}(p.QueryableCollection);t.Lists=w;var m=function(e){function t(e,n){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),a(t,[{key:"getView",value:function(e){return new s.View(this,"getView('"+e+"')")}},{key:"update",value:function(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"*",o=JSON.stringify(d.Util.extend({__metadata:{type:"SP.List"}},e));return this.post({body:o,headers:{"IF-Match":r,"X-HTTP-Method":"MERGE"}}).then(function(r){var o=n;return e.hasOwnProperty("Title")&&(o=n.getParent(t,n.parentUrl,"getByTitle('"+e.Title+"')")),{data:r,list:o}})}},{key:"delete",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"*";return this.post({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})}},{key:"getChanges",value:function(e){var n=JSON.stringify({query:d.Util.extend({__metadata:{type:"SP.ChangeQuery"}},e)}),r=new t(this,"getchanges");return r.post({body:n})}},{key:"getItemsByCAMLQuery",value:function(e){for(var n=JSON.stringify({query:d.Util.extend({__metadata:{type:"SP.CamlQuery"}},e)}),r=new t(this,"getitems"),o=arguments.length,i=Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];return r=r.expand.apply(r,i),r.post({body:n})}},{key:"getListItemChangesSinceToken",value:function(e){var n=JSON.stringify({query:d.Util.extend({__metadata:{type:"SP.ChangeLogItemQuery"}},e)}),r=new t(this,"getlistitemchangessincetoken");return r.post({body:n},{parse:function(e){return e.text()}})}},{key:"recycle",value:function(){return this.append("recycle"),this.post().then(function(e){return e.hasOwnProperty("Recycle")?e.Recycle:e})}},{key:"renderListData",value:function(e){var n=new t(this,"renderlistdata(@viewXml)");return n.query.add("@viewXml","'"+e+"'"),n.post().then(function(e){return e=JSON.parse(e),e.hasOwnProperty("RenderListData")?e.RenderListData:e})}},{key:"renderListFormData",value:function(e,n,r){var o=new t(this,"renderlistformdata(itemid="+e+", formid='"+n+"', mode="+r+")");return o.post().then(function(e){return e=JSON.parse(e),e.hasOwnProperty("ListData")?e.ListData:e})}},{key:"reserveListItemId",value:function(){var e=new t(this,"reservelistitemid");return e.post().then(function(e){return e.hasOwnProperty("ReserveListItemId")?e.ReserveListItemId:e})}},{key:"getListItemEntityTypeFullName",value:function(){var e=new p.QueryableInstance(this);return e.select("ListItemEntityTypeFullName").getAs().then(function(e){return e.ListItemEntityTypeFullName})}},{key:"contentTypes",get:function(){return new l.ContentTypes(this)}},{key:"items",get:function(){return new u.Items(this)}},{key:"views",get:function(){return new s.Views(this)}},{key:"fields",get:function(){return new c.Fields(this)}},{key:"forms",get:function(){return new f.Forms(this)}},{key:"defaultView",get:function(){return new p.QueryableInstance(this,"DefaultView")}},{key:"userCustomActions",get:function(){return new v.UserCustomActions(this)}},{key:"effectiveBasePermissions",get:function(){return new p.Queryable(this,"EffectiveBasePermissions")}},{key:"eventReceivers",get:function(){return new p.QueryableCollection(this,"EventReceivers")}},{key:"relatedFields",get:function(){return new p.Queryable(this,"getRelatedFields")}},{key:"informationRightsManagementSettings",get:function(){return new p.Queryable(this,"InformationRightsManagementSettings")}},{key:"subscriptions",get:function(){return new h.Subscriptions(this)}}]),t}(y.QueryableSecurable);t.List=m},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(11),l=n(21),c=n(27),f=n(28),h=n(30),p=n(1),y=n(12),d=n(31),v=n(25),g=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"items";return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),u(t,[{key:"getById",value:function(e){var t=new b(this);return t.concat("("+e+")"),t}},{key:"skip",value:function(e){return this._query.add("$skiptoken",encodeURIComponent("Paged=TRUE&p_ID="+e)),this}},{key:"getPaged",value:function(){return this.getAs(new m)}},{key:"add",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=function(n){var r=JSON.stringify(p.Util.extend({__metadata:{type:n}},t));return e.postAs({body:r}).then(function(t){return{data:t,item:e.getById(t.Id)}})};if(n)return r(n);var o=function(){var t=e.getParent(v.List),n=e.addBatchDependency();return{v:t.getListItemEntityTypeFullName().then(function(e){var t=r(e);return n(),t})}}();return"object"===("undefined"==typeof o?"undefined":a(o))?o.v:void 0}}]),t}(s.QueryableCollection);t.Items=g;var b=function(e){function t(e,n){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),u(t,[{key:"update",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"*";return new Promise(function(r,o){var i=t.addBatchDependency(),a=t.getParent(s.QueryableInstance,t.parentUrl.substr(0,t.parentUrl.lastIndexOf("/")));a.select("ListItemEntityTypeFullName").getAs().then(function(o){var a=JSON.stringify(p.Util.extend({__metadata:{type:o.ListItemEntityTypeFullName}},e));t.post({body:a,headers:{"IF-Match":n,"X-HTTP-Method":"MERGE"}},new _).then(function(e){i(),r({data:e,item:t})})}).catch(function(e){return o(e)})})}},{key:"delete",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"*";return this.post({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})}},{key:"recycle",value:function(){var e=new t(this,"recycle");return e.post()}},{key:"getWopiFrameUrl",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=new t(this,"getWOPIFrameUrl(@action)");return n._query.add("@action",e),n.post().then(function(e){return e.GetWOPIFrameUrl})}},{key:"validateUpdateListItem",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=JSON.stringify({formValues:e,bNewDocumentUpdate:n}),o=new t(this,"validateupdatelistitem");return o.post({body:r})}},{key:"attachmentFiles",get:function(){return new d.AttachmentFiles(this)}},{key:"contentType",get:function(){return new h.ContentType(this,"ContentType")}},{key:"effectiveBasePermissions",get:function(){return new s.Queryable(this,"EffectiveBasePermissions")}},{key:"effectiveBasePermissionsForUI",get:function(){return new s.Queryable(this,"EffectiveBasePermissionsForUI")}},{key:"fieldValuesAsHTML",get:function(){return new s.QueryableInstance(this,"FieldValuesAsHTML")}},{key:"fieldValuesAsText",get:function(){return new s.QueryableInstance(this,"FieldValuesAsText")}},{key:"fieldValuesForEdit",get:function(){return new s.QueryableInstance(this,"FieldValuesForEdit")}},{key:"folder",get:function(){return new c.Folder(this,"folder")}},{key:"file",get:function(){return new f.File(this,"file")}}]),t}(l.QueryableSecurable);t.Item=b;var w=function(){function e(t,n){r(this,e),this.nextUrl=t,this.results=n}return u(e,[{key:"getNext",value:function(){if(this.hasNext){var e=new g(this.nextUrl,null);return e.getPaged()}return new Promise(function(e){return e(null)})}},{key:"hasNext",get:function(){return"string"==typeof this.nextUrl&&this.nextUrl.length>0}}]),e}();t.PagedItemCollection=w;var m=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),u(t,[{key:"parse",value:function(e){var t=this;return new Promise(function(n,r){t.handleError(e,r)&&e.json().then(function(e){var r=e.hasOwnProperty("d")&&e.d.hasOwnProperty("__next")?e.d.__next:e["odata.nextLink"];n(new w(r,t.parseODataJSON(e)))})})}}]),t}(y.ODataParserBase),_=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),u(t,[{key:"parse",value:function(e){var t=this;return new Promise(function(n,r){t.handleError(e,r)&&n({"odata.etag":e.headers.get("etag")})})}}]),t}(y.ODataParserBase)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(11),s=n(28),l=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"folders";return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),a(t,[{key:"getByName",value:function(e){var t=new c(this);return t.concat("('"+e+"')"),t}},{key:"add",value:function(e){var n=this;return new t(this,"add('"+e+"')").post().then(function(t){return{data:t,folder:n.getByName(e)}})}}]),t}(u.QueryableCollection);t.Folders=l;var c=function(e){function t(e,n){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),a(t,[{key:"delete",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"*";return new t(this).post({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})}},{key:"recycle",value:function(){return new t(this,"recycle").post()}},{key:"contentTypeOrder",get:function(){return new u.QueryableCollection(this,"contentTypeOrder")}},{key:"files",get:function(){return new s.Files(this)}},{key:"folders",get:function(){return new l(this)}},{key:"listItemAllFields",get:function(){return new u.QueryableCollection(this,"listItemAllFields")}},{key:"parentFolder",get:function(){return new t(this,"parentFolder")}},{key:"properties",get:function(){return new u.QueryableInstance(this,"properties")}},{key:"serverRelativeUrl",get:function(){return new u.Queryable(this,"serverRelativeUrl")}},{key:"uniqueContentTypeOrder",get:function(){return new u.QueryableCollection(this,"uniqueContentTypeOrder")}}]),t}(u.QueryableInstance);t.Folder=c},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(11),s=n(12),l=n(1),c=n(15),f=n(29),h=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"files";return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),a(t,[{key:"getByName",value:function(e){var t=new p(this);return t.concat("('"+e+"')"),t}},{key:"add",value:function(e,n){var r=this,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return new t(this,"add(overwrite="+o+",url='"+e+"')").post({body:n}).then(function(t){return{data:t,file:r.getByName(e)}})}},{key:"addChunked",value:function(e,n,r){var o=this,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:10485760,u=new t(this,"add(overwrite="+i+",url='"+e+"')");return u.post().then(function(){return o.getByName(e)}).then(function(e){return e.setContentChunked(n,r,a)}).then(function(t){return{data:t,file:o.getByName(e)}})}},{key:"addTemplateFile",value:function(e,n){var r=this;return new t(this,"addTemplateFile(urloffile='"+e+"',templatefiletype="+n+")").post().then(function(t){return{data:t,file:r.getByName(e)}})}}]),t}(u.QueryableCollection);t.Files=h;var p=function(e){function t(e,n){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),a(t,[{key:"approve",value:function(e){return new t(this,"approve(comment='"+e+"')").post()}},{key:"cancelUpload",value:function(e){return new t(this,"cancelUpload(uploadId=guid'"+e+"')").post()}},{key:"checkin",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v.Major;return new t(this,"checkin(comment='"+e+"',checkintype="+n+")").post()}},{key:"checkout",value:function(){return new t(this,"checkout").post()}},{key:"copyTo",value:function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new t(this,"copyTo(strnewurl='"+e+"',boverwrite="+n+")").post()}},{key:"delete",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"*";return new t(this).post({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})}},{key:"deny",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return new t(this,"deny(comment='"+e+"')").post()}},{key:"getLimitedWebPartManager",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g.Shared;return new f.LimitedWebPartManager(this,"getLimitedWebPartManager(scope="+e+")")}},{key:"moveTo",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:b.Overwrite;return new t(this,"moveTo(newurl='"+e+"',flags="+n+")").post()}},{key:"publish",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return new t(this,"publish(comment='"+e+"')").post()}},{key:"recycle",value:function(){return new t(this,"recycle").post()}},{key:"undoCheckout",value:function(){return new t(this,"undoCheckout").post()}},{key:"unpublish",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(e.length>1023)throw new c.MaxCommentLengthException;return new t(this,"unpublish(comment='"+e+"')").post()}},{key:"getText",value:function(){return new t(this,"$value").get(new s.TextFileParser,{headers:{binaryStringResponseBody:"true"}})}},{key:"getBlob",value:function(){return new t(this,"$value").get(new s.BlobFileParser,{headers:{binaryStringResponseBody:"true"}})}},{key:"getBuffer",value:function(){return new t(this,"$value").get(new s.BufferFileParser,{headers:{binaryStringResponseBody:"true"}})}},{key:"getJSON",value:function(){return new t(this,"$value").get(new s.JSONFileParser,{headers:{binaryStringResponseBody:"true"}})}},{key:"setContent",value:function(e){var n=this,r=new t(this,"$value");return r.post({body:e,headers:{"X-HTTP-Method":"PUT"}}).then(function(e){return new t(n)})}},{key:"setContentChunked",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10485760;"undefined"==typeof t&&(t=function(){return null});var r=this,o=e.size,i=parseInt((e.size/n).toString(),10)+(e.size%n===0?1:0),a=l.Util.getGUID();t({blockNumber:1,chunkSize:n,currentPointer:0,fileSize:o,stage:"starting",totalBlocks:i});for(var u=r.startUpload(a,e.slice(0,n)),s=function(s){u=u.then(function(u){return t({blockNumber:s,chunkSize:n,currentPointer:u,fileSize:o,stage:"continue",totalBlocks:i}),r.continueUpload(a,u,e.slice(u,u+n))})},c=2;c<i;c++)s(c);return u.then(function(u){return t({blockNumber:i,chunkSize:n,currentPointer:u,fileSize:o,stage:"finishing",totalBlocks:i}),r.finishUpload(a,u,e.slice(u))}).then(function(e){return r})}},{key:"startUpload",value:function(e,n){return new t(this,"startUpload(uploadId=guid'"+e+"')").postAs({body:n}).then(function(e){return parseFloat(e)})}},{key:"continueUpload",value:function(e,n,r){return new t(this,"continueUpload(uploadId=guid'"+e+"',fileOffset="+n+")").postAs({body:r}).then(function(e){return parseFloat(e)})}},{key:"finishUpload",value:function(e,n,r){return new t(this,"finishUpload(uploadId=guid'"+e+"',fileOffset="+n+")").postAs({body:r}).then(function(e){return{data:e,file:new t(e.ServerRelativeUrl)}})}},{key:"listItemAllFields",get:function(){return new u.QueryableCollection(this,"listItemAllFields")}},{key:"versions",get:function(){return new y(this)}}]),t}(u.QueryableInstance);t.File=p;var y=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"versions";return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),a(t,[{key:"getById",value:function(e){var t=new d(this);return t.concat("("+e+")"),t}},{key:"deleteAll",value:function(){return new t(this,"deleteAll").post()}},{key:"deleteById",value:function(e){return new t(this,"deleteById(vid="+e+")").post()}},{key:"deleteByLabel",value:function(e){return new t(this,"deleteByLabel(versionlabel='"+e+"')").post()}},{key:"restoreByLabel",value:function(e){return new t(this,"restoreByLabel(versionlabel='"+e+"')").post()}}]),t}(u.QueryableCollection);t.Versions=y;var d=function(e){function t(e,n){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),a(t,[{key:"delete",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"*";return this.post({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})}}]),t}(u.QueryableInstance);t.Version=d;var v;!function(e){e[e.Minor=0]="Minor",e[e.Major=1]="Major",e[e.Overwrite=2]="Overwrite"}(v=t.CheckinType||(t.CheckinType={}));var g;!function(e){e[e.User=0]="User",e[e.Shared=1]="Shared"}(g=t.WebPartsPersonalizationScope||(t.WebPartsPersonalizationScope={}));var b;!function(e){e[e.Overwrite=1]="Overwrite",e[e.AllowBrokenThickets=8]="AllowBrokenThickets"}(b=t.MoveOperations||(t.MoveOperations={}));var w;!function(e){e[e.StandardPage=0]="StandardPage",e[e.WikiPage=1]="WikiPage",e[e.FormPage=2]="FormPage"}(w=t.TemplateFileType||(t.TemplateFileType={}))},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(11),s=function(e){function t(e,n){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),a(t,[{key:"export",value:function(e){var n=new t(this,"ExportWebPart");return n.post({body:JSON.stringify({webPartId:e})})}},{key:"import",value:function(e){var n=new t(this,"ImportWebPart");return n.post({body:JSON.stringify({webPartXml:e})})}},{key:"webparts",get:function(){return new l(this,"webparts")}}]),t}(u.Queryable);t.LimitedWebPartManager=s;var l=function(e){function t(e,n){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),a(t,[{key:"getById",value:function(e){return new c(this,"getbyid('"+e+"')")}}]),t}(u.QueryableCollection);t.WebPartDefinitions=l;var c=function(e){function t(e,n){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),a(t,[{key:"delete",value:function(){var e=new t(this,"DeleteWebPart");return e.post()}},{key:"webpart",get:function(){return new f(this)}}]),t}(u.QueryableInstance);t.WebPartDefinition=c;var f=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"webpart";return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),t}(u.QueryableInstance);t.WebPart=f},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{
constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(1),s=n(11),l=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"contenttypes";return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),a(t,[{key:"getById",value:function(e){var t=new c(this);return t.concat("('"+e+"')"),t}},{key:"addAvailableContentType",value:function(e){var n=this,r=JSON.stringify({contentTypeId:e});return new t(this,"addAvailableContentType").postAs({body:r}).then(function(e){return{contentType:n.getById(e.id),data:e}})}},{key:"add",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Custom Content Types",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=JSON.stringify(u.Util.extend({Description:n,Group:o,Id:{StringValue:e},Name:t,__metadata:{type:"SP.ContentType"}},i));return this.post({body:a}).then(function(e){return{contentType:r.getById(e.id),data:e}})}}]),t}(s.QueryableCollection);t.ContentTypes=l;var c=function(e){function t(e,n){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),a(t,[{key:"fieldLinks",get:function(){return new f(this)}},{key:"fields",get:function(){return new s.QueryableCollection(this,"fields")}},{key:"parent",get:function(){return new t(this,"parent")}},{key:"workflowAssociations",get:function(){return new s.QueryableCollection(this,"workflowAssociations")}}]),t}(s.QueryableInstance);t.ContentType=c;var f=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"fieldlinks";return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),a(t,[{key:"getById",value:function(e){var t=new h(this);return t.concat("(guid'"+e+"')"),t}}]),t}(s.QueryableCollection);t.FieldLinks=f;var h=function(e){function t(e,n){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),t}(s.QueryableInstance);t.FieldLink=h},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(11),s=n(12),l=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"AttachmentFiles";return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),a(t,[{key:"getByName",value:function(e){var t=new c(this);return t.concat("('"+e+"')"),t}},{key:"add",value:function(e,n){var r=this;return new t(this,"add(FileName='"+e+"')").post({body:n}).then(function(t){return{data:t,file:r.getByName(e)}})}}]),t}(u.QueryableCollection);t.AttachmentFiles=l;var c=function(e){function t(e,n){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),a(t,[{key:"getText",value:function(){return new t(this,"$value").get(new s.TextFileParser)}},{key:"getBlob",value:function(){return new t(this,"$value").get(new s.BlobFileParser)}},{key:"getBuffer",value:function(){return new t(this,"$value").get(new s.BufferFileParser)}},{key:"getJSON",value:function(){return new t(this,"$value").get(new s.JSONFileParser)}},{key:"setContent",value:function(e){var n=this,r=new t(this,"$value");return r.post({body:e,headers:{"X-HTTP-Method":"PUT"}}).then(function(e){return new t(n)})}},{key:"delete",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"*";return this.post({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})}}]),t}(u.QueryableInstance);t.AttachmentFile=c},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(11),s=n(1),l=function(e){function t(e){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,"views"))}return i(t,e),a(t,[{key:"getById",value:function(e){var t=new c(this);return t.concat("('"+e+"')"),t}},{key:"getByTitle",value:function(e){return new c(this,"getByTitle('"+e+"')")}},{key:"add",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=JSON.stringify(s.Util.extend({PersonalView:n,Title:e,__metadata:{type:"SP.View"}},r));return this.postAs({body:o}).then(function(e){return{data:e,view:t.getById(e.Id)}})}}]),t}(u.QueryableCollection);t.Views=l;var c=function(e){function t(e,n){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),a(t,[{key:"update",value:function(e){var t=this,n=JSON.stringify(s.Util.extend({__metadata:{type:"SP.View"}},e));return this.post({body:n,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,view:t}})}},{key:"delete",value:function(){return this.post({headers:{"X-HTTP-Method":"DELETE"}})}},{key:"renderAsHtml",value:function(){var e=new u.Queryable(this,"renderashtml");return e.get()}},{key:"fields",get:function(){return new f(this)}}]),t}(u.QueryableInstance);t.View=c;var f=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"viewfields";return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),a(t,[{key:"getSchemaXml",value:function(){var e=new u.Queryable(this,"schemaxml");return e.get()}},{key:"add",value:function(e){var n=new t(this,"addviewfield('"+e+"')");return n.post()}},{key:"move",value:function(e,n){var r=new t(this,"moveviewfieldto"),o=JSON.stringify({field:e,index:n});return r.post({body:o})}},{key:"removeAll",value:function(){var e=new t(this,"removeallviewfields");return e.post()}},{key:"remove",value:function(e){var n=new t(this,"removeviewfield('"+e+"')");return n.post()}}]),t}(u.QueryableCollection);t.ViewFields=f},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(11),s=n(1),l=n(34),c=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"fields";return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),a(t,[{key:"getByTitle",value:function(e){return new f(this,"getByTitle('"+e+"')")}},{key:"getByInternalNameOrTitle",value:function(e){return new f(this,"getByInternalNameOrTitle('"+e+"')")}},{key:"getById",value:function(e){var t=new f(this);return t.concat("('"+e+"')"),t}},{key:"createFieldAsXml",value:function(e){var n=this,r=void 0;r="string"==typeof e?{SchemaXml:e}:e;var o=JSON.stringify({parameters:s.Util.extend({__metadata:{type:"SP.XmlSchemaFieldCreationInformation"}},r)}),i=new t(this,"createfieldasxml");return i.postAs({body:o}).then(function(e){return{data:e,field:n.getById(e.Id)}})}},{key:"add",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=JSON.stringify(s.Util.extend({Title:e,__metadata:{type:t}},r));return this.postAs({body:o}).then(function(e){return{data:e,field:n.getById(e.Id)}})}},{key:"addText",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:255,n=arguments[2],r={FieldTypeKind:2,MaxLength:t};return this.add(e,"SP.FieldText",s.Util.extend(r,n))}},{key:"addCalculated",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:l.FieldTypes.Text,o=arguments[4],i={DateFormat:n,FieldTypeKind:17,Formula:t,OutputType:r};return this.add(e,"SP.FieldCalculated",s.Util.extend(i,o))}},{key:"addDateTime",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l.DateTimeFieldFormatType.DateOnly,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l.CalendarType.Gregorian,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments[4],i={DateTimeCalendarType:n,DisplayFormat:t,FieldTypeKind:4,FriendlyDisplayFormat:r};return this.add(e,"SP.FieldDateTime",s.Util.extend(i,o))}},{key:"addNumber",value:function(e,t,n,r){var o={FieldTypeKind:9};return"undefined"!=typeof t&&(o=s.Util.extend({MinimumValue:t},o)),"undefined"!=typeof n&&(o=s.Util.extend({MaximumValue:n},o)),this.add(e,"SP.FieldNumber",s.Util.extend(o,r))}},{key:"addCurrency",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1033,o=arguments[4],i={CurrencyLocaleId:r,FieldTypeKind:10};return"undefined"!=typeof t&&(i=s.Util.extend({MinimumValue:t},i)),"undefined"!=typeof n&&(i=s.Util.extend({MaximumValue:n},i)),this.add(e,"SP.FieldCurrency",s.Util.extend(i,o))}},{key:"addMultilineText",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],a=arguments[6],u={AllowHyperlink:i,AppendOnly:o,FieldTypeKind:3,NumberOfLines:t,RestrictedMode:r,RichText:n};return this.add(e,"SP.FieldMultiLineText",s.Util.extend(u,a))}},{key:"addUrl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l.UrlFieldFormatType.Hyperlink,n=arguments[2],r={DisplayFormat:t,FieldTypeKind:11};return this.add(e,"SP.FieldUrl",s.Util.extend(r,n))}}]),t}(u.QueryableCollection);t.Fields=c;var f=function(e){function t(e,n){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),a(t,[{key:"update",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"SP.Field",r=JSON.stringify(s.Util.extend({__metadata:{type:n}},e));return this.post({body:r,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,field:t}})}},{key:"delete",value:function(){return this.post({headers:{"X-HTTP-Method":"DELETE"}})}},{key:"setShowInDisplayForm",value:function(e){var n=new t(this,"setshowindisplayform("+e+")");return n.post()}},{key:"setShowInEditForm",value:function(e){var n=new t(this,"setshowineditform("+e+")");return n.post()}},{key:"setShowInNewForm",value:function(e){var n=new t(this,"setshowinnewform("+e+")");return n.post()}}]),t}(u.QueryableInstance);t.Field=f},function(e,t){"use strict";var n;!function(e){e[e.Display=1]="Display",e[e.Edit=2]="Edit",e[e.New=3]="New"}(n=t.ControlMode||(t.ControlMode={}));var r;!function(e){e[e.Invalid=0]="Invalid",e[e.Integer=1]="Integer",e[e.Text=2]="Text",e[e.Note=3]="Note",e[e.DateTime=4]="DateTime",e[e.Counter=5]="Counter",e[e.Choice=6]="Choice",e[e.Lookup=7]="Lookup",e[e.Boolean=8]="Boolean",e[e.Number=9]="Number",e[e.Currency=10]="Currency",e[e.URL=11]="URL",e[e.Computed=12]="Computed",e[e.Threading=13]="Threading",e[e.Guid=14]="Guid",e[e.MultiChoice=15]="MultiChoice",e[e.GridChoice=16]="GridChoice",e[e.Calculated=17]="Calculated",e[e.File=18]="File",e[e.Attachments=19]="Attachments",e[e.User=20]="User",e[e.Recurrence=21]="Recurrence",e[e.CrossProjectLink=22]="CrossProjectLink",e[e.ModStat=23]="ModStat",e[e.Error=24]="Error",e[e.ContentTypeId=25]="ContentTypeId",e[e.PageSeparator=26]="PageSeparator",e[e.ThreadIndex=27]="ThreadIndex",e[e.WorkflowStatus=28]="WorkflowStatus",e[e.AllDayEvent=29]="AllDayEvent",e[e.WorkflowEventType=30]="WorkflowEventType"}(r=t.FieldTypes||(t.FieldTypes={}));var o;!function(e){e[e.DateOnly=0]="DateOnly",e[e.DateTime=1]="DateTime"}(o=t.DateTimeFieldFormatType||(t.DateTimeFieldFormatType={}));var i;!function(e){e[e.DefaultValue=0]="DefaultValue",e[e.AddToDefaultContentType=1]="AddToDefaultContentType",e[e.AddToNoContentType=2]="AddToNoContentType",e[e.AddToAllContentTypes=4]="AddToAllContentTypes",e[e.AddFieldInternalNameHint=8]="AddFieldInternalNameHint",e[e.AddFieldToDefaultView=16]="AddFieldToDefaultView",e[e.AddFieldCheckDisplayName=32]="AddFieldCheckDisplayName"}(i=t.AddFieldOptions||(t.AddFieldOptions={}));var a;!function(e){e[e.Gregorian=1]="Gregorian",e[e.Japan=3]="Japan",e[e.Taiwan=4]="Taiwan",e[e.Korea=5]="Korea",e[e.Hijri=6]="Hijri",e[e.Thai=7]="Thai",e[e.Hebrew=8]="Hebrew",e[e.GregorianMEFrench=9]="GregorianMEFrench",e[e.GregorianArabic=10]="GregorianArabic",e[e.GregorianXLITEnglish=11]="GregorianXLITEnglish",e[e.GregorianXLITFrench=12]="GregorianXLITFrench",e[e.KoreaJapanLunar=14]="KoreaJapanLunar",e[e.ChineseLunar=15]="ChineseLunar",e[e.SakaEra=16]="SakaEra",e[e.UmAlQura=23]="UmAlQura"}(a=t.CalendarType||(t.CalendarType={}));var u;!function(e){e[e.Hyperlink=0]="Hyperlink",e[e.Image=1]="Image"}(u=t.UrlFieldFormatType||(t.UrlFieldFormatType={}));var s;!function(e){e[e.None=0]="None",e[e.User=1]="User",e[e.DistributionList=2]="DistributionList",e[e.SecurityGroup=4]="SecurityGroup",e[e.SharePointGroup=8]="SharePointGroup",e[e.All=15]="All"}(s=t.PrincipalType||(t.PrincipalType={}));var l;!function(e){e[e.Invalid=-1]="Invalid",e[e.DefaultView=0]="DefaultView",e[e.NormalView=1]="NormalView",e[e.DialogView=2]="DialogView",e[e.View=3]="View",e[e.DisplayForm=4]="DisplayForm",e[e.DisplayFormDialog=5]="DisplayFormDialog",e[e.EditForm=6]="EditForm",e[e.EditFormDialog=7]="EditFormDialog",e[e.NewForm=8]="NewForm",e[e.NewFormDialog=9]="NewFormDialog",e[e.SolutionForm=10]="SolutionForm",e[e.PAGE_MAXITEMS=11]="PAGE_MAXITEMS"}(l=t.PageType||(t.PageType={}))},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(11),s=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"forms";return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),a(t,[{key:"getById",value:function(e){var t=new l(this);return t.concat("('"+e+"')"),t}}]),t}(u.QueryableCollection);t.Forms=s;var l=function(e){function t(e,n){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),t}(u.QueryableInstance);t.Form=l},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(11),l=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"subscriptions";return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),u(t,[{key:"getById",value:function(e){var t=new c(this);return t.concat("('"+e+"')"),t}},{key:"add",value:function(e,t,n){var r=this,o=JSON.stringify({clientState:n||"pnp-js-core-subscription",expirationDateTime:t,notificationUrl:e,resource:this.toUrl()});return this.post({body:o,headers:{"Content-Type":"application/json"}}).then(function(e){return{data:e,subscription:r.getById(e.id)}})}}]),t}(s.QueryableCollection);t.Subscriptions=l;var c=function(e){function t(e,n){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),u(t,[{key:"update",value:function(e){var t=this,n=JSON.stringify({expirationDateTime:e});return this.patch({body:n,headers:{"Content-Type":"application/json"}}).then(function(e){return{data:e,subscription:t}})}},{key:"delete",value:function(){return a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"delete",this).call(this)}}]),t}(s.QueryableInstance);t.Subscription=c},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(11),l=n(1),c=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"usercustomactions";return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),u(t,[{key:"getById",value:function(e){var t=new f(this);return t.concat("('"+e+"')"),t}},{key:"add",value:function(e){var t=this,n=JSON.stringify(l.Util.extend({__metadata:{type:"SP.UserCustomAction"}},e));return this.post({body:n}).then(function(e){return{action:t.getById(e.Id),data:e}})}},{key:"clear",value:function(){var e=new t(this,"clear");return e.post()}}]),t}(s.QueryableCollection);t.UserCustomActions=c;var f=function(e){function t(e,n){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),u(t,[{key:"update",value:function(e){var t=this,n=JSON.stringify(l.Util.extend({__metadata:{type:"SP.UserCustomAction"}},e));return this.post({body:n,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{action:t,data:e}})}},{key:"delete",value:function(){return a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"delete",this).call(this)}}]),t}(s.QueryableInstance);t.UserCustomAction=f},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(1),l=n(11),c=function(e){function t(e,n){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),u(t,[{key:"getById",value:function(e){var t=new f(this);return t.concat("("+e+")"),t}},{key:"add",value:function(e,n){var r=this,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=JSON.stringify({IsVisible:o,Title:e,Url:n,__metadata:{type:"SP.NavigationNode"}}),a=new t(this);return a.post({body:i}).then(function(e){return{data:e,node:r.getById(e.Id)}})}},{key:"moveAfter",value:function(e,n){var r=JSON.stringify({nodeId:e,previousNodeId:n}),o=new t(this,"MoveAfter");return o.post({body:r})}}]),t}(l.QueryableCollection);t.NavigationNodes=c;var f=function(e){function t(e,n){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),u(t,[{key:"update",value:function(e){var t=this,n=JSON.stringify(s.Util.extend({__metadata:{type:"SP.NavigationNode"}},e));return this.post({body:n,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,node:t}})}},{key:"delete",value:function(){return a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"delete",this).call(this)}},{key:"children",get:function(){return new c(this,"Children")}}]),t}(l.QueryableInstance);t.NavigationNode=f;var h=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"navigation";return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),u(t,[{key:"quicklaunch",get:function(){return new c(this,"quicklaunch")}},{key:"topNavigationBar",get:function(){return new c(this,"topnavigationbar")}}]),t}(l.Queryable);t.Navigation=h},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(11),s=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"features";return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),a(t,[{key:"getById",value:function(e){var t=new l(this);return t.concat("('"+e+"')"),t}},{key:"add",value:function(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=new t(this,"add");return o.post({body:JSON.stringify({featdefScope:0,featureId:e,force:r})}).then(function(t){return{data:t,feature:n.getById(e)}})}},{key:"remove",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=new t(this,"remove");return r.post({body:JSON.stringify({featureId:e,force:n})})}}]),t}(u.QueryableCollection);t.Features=s;var l=function(e){function t(e,n){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),a(t,[{key:"deactivate",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=this.addBatchDependency(),o=new t(this).select("DefinitionId");return o.getAs().then(function(t){var o=e.getParent(s,e.parentUrl,"").remove(t.DefinitionId,n);return r(),o})}}]),t}(u.QueryableInstance);t.Feature=l},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(11),s=n(41),l=n(12),c=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"_api/sp.userprofiles.peoplemanager";r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.profileLoader=new f(e),i}return i(t,e),a(t,[{key:"amIFollowedBy",value:function(e){var n=new t(this,"amifollowedby(@v)");return n.query.add("@v","'"+encodeURIComponent(e)+"'"),n.get()}},{key:"amIFollowing",value:function(e){var n=new t(this,"amifollowing(@v)");return n.query.add("@v","'"+encodeURIComponent(e)+"'"),n.get()}},{key:"getFollowedTags",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20,n=new t(this,"getfollowedtags("+e+")");return n.get()}},{key:"getFollowersFor",value:function(e){var n=new t(this,"getfollowersfor(@v)");return n.query.add("@v","'"+encodeURIComponent(e)+"'"),n.get()}},{key:"getPeopleFollowedBy",value:function(e){var n=new t(this,"getpeoplefollowedby(@v)");return n.query.add("@v","'"+encodeURIComponent(e)+"'"),n.get()}},{key:"getPropertiesFor",value:function(e){var n=new t(this,"getpropertiesfor(@v)");return n.query.add("@v","'"+encodeURIComponent(e)+"'"),n.get()}},{key:"getUserProfilePropertyFor",value:function(e,n){var r=new t(this,"getuserprofilepropertyfor(accountname=@v, propertyname='"+n+"')");return r.query.add("@v","'"+encodeURIComponent(e)+"'"),r.get()}},{key:"hideSuggestion",value:function(e){var n=new t(this,"hidesuggestion(@v)");return n.query.add("@v","'"+encodeURIComponent(e)+"'"),n.post()}},{key:"isFollowing",value:function(e,n){var r=new t(this,null);return r.concat(".isfollowing(possiblefolloweraccountname=@v, possiblefolloweeaccountname=@y)"),r.query.add("@v","'"+encodeURIComponent(e)+"'"),r.query.add("@y","'"+encodeURIComponent(n)+"'"),r.get()}},{key:"setMyProfilePic",value:function(e){var n=this;return new Promise(function(r,o){s.readBlobAsArrayBuffer(e).then(function(e){var o=new t(n,"setmyprofilepicture");o.post({body:String.fromCharCode.apply(null,new Uint16Array(e))}).then(function(e){return r()})}).catch(function(e){return o(e)})})}},{key:"createPersonalSiteEnqueueBulk",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.profileLoader.createPersonalSiteEnqueueBulk(t)}},{key:"createPersonalSite",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.profileLoader.createPersonalSite(e)}},{key:"shareAllSocialData",value:function(e){return this.profileLoader.shareAllSocialData(e)}},{key:"editProfileLink",get:function(){var e=new t(this,"EditProfileLink");return e.getAs(l.ODataValue())}},{key:"isMyPeopleListPublic",get:function(){var e=new t(this,"IsMyPeopleListPublic");return e.getAs(l.ODataValue())}},{key:"myFollowers",get:function(){return new u.QueryableCollection(this,"getmyfollowers")}},{key:"myProperties",get:function(){return new t(this,"getmyproperties")}},{key:"trendingTags",get:function(){var e=new t(this,null);return e.concat(".gettrendingtags"),e.get()}},{key:"ownerUserProfile",get:function(){return this.profileLoader.ownerUserProfile}},{key:"userProfile",get:function(){return this.profileLoader.userProfile}}]),t}(u.QueryableInstance);t.UserProfileQuery=c;var f=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"_api/sp.userprofiles.profileloader.getprofileloader";return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return i(t,e),a(t,[{key:"createPersonalSiteEnqueueBulk",value:function(e){var n=new t(this,"createpersonalsiteenqueuebulk"),r=JSON.stringify({emailIDs:e});return n.post({body:r})}},{key:"createPersonalSite",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=new t(this,"getuserprofile/createpersonalsiteenque("+e+')",');return n.post()}},{key:"shareAllSocialData",value:function(e){var n=new t(this,"getuserprofile/shareallsocialdata("+e+')",');return n.post()}},{key:"ownerUserProfile",get:function(){var e=this.getParent(t,this.parentUrl,"_api/sp.userprofiles.profileloader.getowneruserprofile");return e.postAs()}},{key:"userProfile",get:function(){var e=new t(this,"getuserprofile");return e.postAs()}}]),t}(u.Queryable)},function(e,t){"use strict";function n(e){return o(e,"string")}function r(e){return o(e,"buffer")}function o(e,t){return new Promise(function(n,r){try{var o=new FileReader;switch(o.onload=function(e){n(e.target.result)},t){case"string":o.readAsText(e);break;case"buffer":o.readAsArrayBuffer(e)}}catch(e){r(e)}})}t.readBlobAsText=n,t.readBlobAsArrayBuffer=r},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}r(n(43));var o=n(13);t.HttpClient=o.HttpClient;var i=n(44);t.SPRequestExecutorClient=i.SPRequestExecutorClient;var a=n(45);t.NodeFetchClient=a.NodeFetchClient;var u=n(5);t.FetchClient=u.FetchClient,r(n(46));var s=n(8);t.Dictionary=s.Dictionary;var l=n(1);t.Util=l.Util,
r(n(3)),r(n(15))},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}r(n(17));var o=n(28);t.CheckinType=o.CheckinType,t.WebPartsPersonalizationScope=o.WebPartsPersonalizationScope,t.MoveOperations=o.MoveOperations,t.TemplateFileType=o.TemplateFileType;var i=n(26);t.Item=i.Item,t.PagedItemCollection=i.PagedItemCollection;var a=n(38);t.NavigationNodes=a.NavigationNodes,t.NavigationNode=a.NavigationNode;var u=n(25);t.List=u.List;var s=n(12);t.extractOdataId=s.extractOdataId,t.ODataParserBase=s.ODataParserBase,t.ODataDefaultParser=s.ODataDefaultParser,t.ODataRaw=s.ODataRaw,t.ODataValue=s.ODataValue,t.ODataEntity=s.ODataEntity,t.ODataEntityArray=s.ODataEntityArray,t.TextFileParser=s.TextFileParser,t.BlobFileParser=s.BlobFileParser,t.BufferFileParser=s.BufferFileParser,t.JSONFileParser=s.JSONFileParser;var l=n(22);t.RoleDefinitionBindings=l.RoleDefinitionBindings;var c=n(10);t.Search=c.Search,t.SearchResult=c.SearchResult,t.SearchResults=c.SearchResults,t.SortDirection=c.SortDirection,t.ReorderingRuleMatchType=c.ReorderingRuleMatchType,t.QueryPropertyValueType=c.QueryPropertyValueType;var f=n(18);t.SearchSuggest=f.SearchSuggest,t.SearchSuggestResult=f.SearchSuggestResult;var h=n(19);t.Site=h.Site,r(n(34));var p=n(20);t.Web=p.Web},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(1),a=n(15),u=function(){function e(){r(this,e),this.convertToResponse=function(e){var t=new Headers;for(var n in e.headers)e.headers[n]&&t.append(n,e.headers[n]);var r=204===e.statusCode?null:e.body;return new Response(r,{headers:t,status:e.statusCode,statusText:e.statusText})}}return o(e,[{key:"fetch",value:function(e,t){var n=this;if("undefined"==typeof SP||"undefined"==typeof SP.RequestExecutor)throw new a.SPRequestExecutorUndefinedException;var r=e.substring(0,e.indexOf("/_api")),o=new SP.RequestExecutor(r),u={},s=void 0,l=void 0;if(t.headers&&t.headers instanceof Headers)for(s=t.headers.entries(),l=s.next();!l.done;)u[l.value[0]]=l.value[1],l=s.next();else u=t.headers;return new Promise(function(r,a){var s={error:function(e){a(n.convertToResponse(e))},headers:u,method:t.method,success:function(e){r(n.convertToResponse(e))},url:e};s=t.body?i.Util.extend(s,{body:t.body}):i.Util.extend(s,{binaryStringRequestBody:!0}),o.executeAsync(s)})}}]),e}();t.SPRequestExecutorClient=u},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(15),a=function(){function e(){r(this,e)}return o(e,[{key:"fetch",value:function(){throw new i.NodeFetchClientUnsupportedException}}]),e}();t.NodeFetchClient=a},function(e,t,n){"use strict";var r=n(47);t.CachingConfigurationProvider=r.default;var o=n(48);t.SPListConfigurationProvider=o.default},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(6),a=n(15),u=function(){function e(t,n,o){r(this,e),this.wrappedProvider=t,this.store=o?o:this.selectPnPCache(),this.cacheKey="_configcache_"+n}return o(e,[{key:"getWrappedProvider",value:function(){return this.wrappedProvider}},{key:"getConfiguration",value:function(){var e=this;if(!this.store||!this.store.enabled)return this.wrappedProvider.getConfiguration();var t=this.store.get(this.cacheKey);if(t)return new Promise(function(e){e(t)});var n=this.wrappedProvider.getConfiguration();return n.then(function(t){e.store.put(e.cacheKey,t)}),n}},{key:"selectPnPCache",value:function(){var e=new i.PnPClientStorage;if(e.local&&e.local.enabled)return e.local;if(e.session&&e.session.enabled)return e.session;throw new a.NoCacheAvailableException}}]),e}();Object.defineProperty(t,"__esModule",{value:!0}),t.default=u},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(47),a=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"config";r(this,e),this.sourceWeb=t,this.sourceListTitle=n}return o(e,[{key:"getConfiguration",value:function(){return this.web.lists.getByTitle(this.listTitle).items.select("Title","Value").getAs().then(function(e){return e.reduce(function(e,t){return Object.defineProperty(e,t.Title,{configurable:!1,enumerable:!1,value:t.Value,writable:!1})},{})})}},{key:"asCaching",value:function(){var e="splist_"+this.web.toUrl()+"+"+this.listTitle;return new i.default(this,e)}},{key:"web",get:function(){return this.sourceWeb}},{key:"listTitle",get:function(){return this.sourceListTitle}}]),e}();Object.defineProperty(t,"__esModule",{value:!0}),t.default=a}])});
//# sourceMappingURL=pnp.min.js.map