/*! asynquence-contrib
    v0.11.0 (c) Kyle Simpson
    MIT License: http://getify.mit-license.org
*/
!function UMD(e,n){"undefined"!=typeof module&&module.exports?(module.exports=function $$inject$dependency(e){if("string"==typeof e)try{e=require(e)}catch(r){return $$inject$dependency}return n(e)},"string"==typeof e&&(module.exports=module.exports(require("path").join("..",e)))):"function"==typeof define&&define.amd?define([e],n):n(e)}(this.ASQ||"asynquence",function DEF(e){"use strict";var n=Array.prototype.slice,r=Object.create(null),t="__ASQ__",a=e.__schedule,u=e.__tapSequence;return function IIFE(){var u;e.iterable=function $$iterable(){function throwSequenceErrors(){throw 1===$.length?$[0]:$}function notifyErrors(){var e;if(l=null,o)for(0!==f.length||c||(c=!0,throwSequenceErrors());f.length>0;){c=!0,e=f.shift();try{e.apply(r,$)}catch(n){checkBranding(n)?$=$.concat(n):$.push(n),0===f.length&&throwSequenceErrors()}}}function val(){return o||s||0===arguments.length?i:(p.push.apply(p,arguments),i)}function or(){return s||0===arguments.length?i:(f.push.apply(f,arguments),l||(l=a(notifyErrors)),i)}function pipe(){return s||0===arguments.length?i:(n.call(arguments).forEach(function $$each(e){val(e).or(e.fail)}),i)}function next(){if(o||s||0===p.length)return p.length>0&&$throw$("Sequence cannot be iterated"),{done:!0};try{return{value:p.shift().apply(r,arguments)}}catch(n){return e.isMessageWrapper(n)?$throw$.apply(r,n):$throw$(n),{}}}function $throw$(){return o||s?i:($.push.apply($,arguments),o=!0,l||(l=a(notifyErrors)),i)}function $return$(e){return(o||s)&&(e=void 0),abort(),{done:!0,value:e}}function abort(){o||s||(s=!0,clearTimeout(l),l=null,p.length=f.length=$.length=0)}function duplicate(){var n;return u={val_queue:p.slice(),or_queue:f.slice()},n=e.iterable(),u=null,n}function defer(){return f.push(function $$ignored(){}),i}function brandIt(e){return Object.defineProperty(e,t,{enumerable:!1,value:!0}),e}var i,l,o=!1,c=!1,s=!1,p=[],f=[],$=[];return i=brandIt({val:val,then:val,or:or,pipe:pipe,next:next,"throw":$throw$,"return":$return$,abort:abort,duplicate:duplicate,defer:defer}),i["function"==typeof Symbol&&Symbol.iterator||"@@iterator"]=function $$iter(){return i},u&&(p=u.val_queue.slice(0),f=u.or_queue.slice(0)),i.val.apply(r,arguments),i}}(),e.extend("race",function $$extend(t,a){return function $$race(){if(a("seq_error")||a("seq_aborted")||0===arguments.length)return t;var i=n.call(arguments).map(function $$map(n){var r;return e.isSequence(n)?(r={seq:n},u(r),function $$fn(e){r.seq.pipe(e)}):n});return t.then(function $$then(e){var t=n.call(arguments);i.forEach(function $$each(e){e.apply(r,t)})}),t}}),e.extend("runner",function $$extend(t,u){return function $$runner(){if(u("seq_error")||u("seq_aborted")||0===arguments.length)return t;var i=n.call(arguments);return t.then(function $$then(t){function wrap(n){var a=n;return a="function"==typeof n?n.call(r,p):e.isSequence(n)&&"next"in n?n.duplicate():e.iterable().val(n),e.isSequence(a)&&a.or(function $$or(){t.fail.apply(r,arguments)}),a}function addWrapped(){c.push.apply(c,n.call(arguments).map(wrap))}var l,o,c=i,s={messages:n.call(arguments,1),add:addWrapped},p=s;c=c.map(wrap),function iterate(){var n,i;l=c.shift();try{o=e.isMessageWrapper(p)&&e.isSequence(l)?l.next.apply(l,p):l.next(p)}catch(f){return t.fail(f)}u("seq_aborted")||(o.value===s?(c.push(l),p=s,a(iterate)):(e.isSequence(o.value)||(n=typeof o.value,null===o.value||"object"!==n&&"function"!==n||"function"!=typeof o.value.then?"function"===n?(i=o.value,o.value=e(function $$ASQ(e){i(e.errfcb)})):e.isMessageWrapper(o.value)?o.value=e.apply(r,o.value.length>0?o.value:e.messages(void 0)):"undefined"!=typeof o.value?o.value=e(o.value):o.value=e():o.value=e().promise(o.value)),o.value.val(function $$val(){u("seq_aborted")||(arguments.length>0&&(p=arguments.length>1?e.messages.apply(r,arguments):arguments[0]),o.done||(p===s?c.push(l):c.unshift(l)),c.length>0?iterate():"undefined"!=typeof p?e.isMessageWrapper(p)?t.apply(r,p):t(p):t())}).or(function $$or(){if(!u("seq_aborted"))try{l["throw"].apply(l,arguments)}catch(e){t.fail(e)}})))}()}),t}}),e.extend("toPromise",function $$extend(t,a){return function $$to$promise(){return new Promise(function $$executor(a,u){t.val(function $$val(){var t=n.call(arguments);return a.call(r,t.length>1?t:t[0]),e.messages.apply(r,t)}).or(function $$or(){var e=n.call(arguments);u.call(r,e.length>1?e:e[0])})})}}),e.wrap=function $$wrap(t,a){function checkThis(e,n){return!e||"undefined"!=typeof window&&e===window||"undefined"!=typeof global&&e===global?n:e}var u,i,l,o;if(a=a&&"object"==typeof a?a:{},a.errfcb&&a.splitcb||a.errfcb&&a.simplecb||a.splitcb&&a.simplecb||"errfcb"in a&&!a.errfcb&&!a.splitcb&&!a.simplecb||a.params_first&&a.params_last)throw Error("Invalid options");return o=a["this"]&&"object"==typeof a["this"]?a["this"]:r,u=a.errfcb||!(a.splitcb||a.simplecb),i=!!a.params_first||!a.params_last&&!("params_first"in a||a.params_first)||"params_last"in a&&!a.params_first&&!a.params_last,l=i?"push":"unshift",a.gen?function $$wrapped$gen(){return e.apply(r,arguments).runner(t)}:u?function $$wrapped$errfcb(){var r=n.call(arguments),a=checkThis(this,o);return e(function $$asq(e){r[l](e.errfcb),t.apply(a,r)})}:a.splitcb?function $$wrapped$splitcb(){var r=n.call(arguments),a=checkThis(this,o);return e(function $$asq(e){r[l](e,e.fail),t.apply(a,r)})}:a.simplecb?function $$wrapped$simplecb(){var r=n.call(arguments),a=checkThis(this,o);return e(function $$asq(e){r[l](e),t.apply(a,r)})}:void 0},e});
