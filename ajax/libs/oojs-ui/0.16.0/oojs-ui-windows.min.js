/*!
 * OOjs UI v0.16.0
 * https://www.mediawiki.org/wiki/OOjs_UI
 *
 * Copyright 2011â€“2016 OOjs UI Team and other contributors.
 * Released under the MIT license
 * http://oojs.mit-license.org
 *
 * Date: 2016-02-22T22:33:33Z
 */
!function(t){"use strict";t.ui.ActionWidget=function(i){i=$.extend({framed:!1},i),t.ui.ActionWidget.parent.call(this,i),t.ui.mixin.PendingElement.call(this,i),this.action=i.action||"",this.modes=i.modes||[],this.width=0,this.height=0,this.$element.addClass("oo-ui-actionWidget")},t.inheritClass(t.ui.ActionWidget,t.ui.ButtonWidget),t.mixinClass(t.ui.ActionWidget,t.ui.mixin.PendingElement),t.ui.ActionWidget.prototype.hasMode=function(t){return this.modes.indexOf(t)!==-1},t.ui.ActionWidget.prototype.getAction=function(){return this.action},t.ui.ActionWidget.prototype.getModes=function(){return this.modes.slice()},t.ui.ActionWidget.prototype.propagateResize=function(){var t,i;return this.isElementAttached()&&(t=this.$element.width(),i=this.$element.height(),t===this.width&&i===this.height||(this.width=t,this.height=i,this.emit("resize"))),this},t.ui.ActionWidget.prototype.setIcon=function(){return t.ui.mixin.IconElement.prototype.setIcon.apply(this,arguments),this.propagateResize(),this},t.ui.ActionWidget.prototype.setLabel=function(){return t.ui.mixin.LabelElement.prototype.setLabel.apply(this,arguments),this.propagateResize(),this},t.ui.ActionWidget.prototype.setFlags=function(){return t.ui.mixin.FlaggedElement.prototype.setFlags.apply(this,arguments),this.propagateResize(),this},t.ui.ActionWidget.prototype.clearFlags=function(){return t.ui.mixin.FlaggedElement.prototype.clearFlags.apply(this,arguments),this.propagateResize(),this},t.ui.ActionWidget.prototype.toggle=function(){return t.ui.ActionWidget.parent.prototype.toggle.apply(this,arguments),this.propagateResize(),this},t.ui.ActionSet=function(i){i=i||{},t.EventEmitter.call(this),this.list=[],this.categories={actions:"getAction",flags:"getFlags",modes:"getModes"},this.categorized={},this.special={},this.others=[],this.organized=!1,this.changing=!1,this.changed=!1},t.mixinClass(t.ui.ActionSet,t.EventEmitter),t.ui.ActionSet.static.specialFlags=["safe","primary"],t.ui.ActionSet.prototype.onActionChange=function(){this.organized=!1,this.changing?this.changed=!0:this.emit("change")},t.ui.ActionSet.prototype.isSpecial=function(t){var i;for(i in this.special)if(t===this.special[i])return!0;return!1},t.ui.ActionSet.prototype.get=function(t){var i,e,o,n,s,r,a,c;if(t){this.organize(),c=[];for(n in this.categorized)if(o=t[n])for(Array.isArray(o)||(o=[o]),i=0,e=o.length;i<e;i++)s=this.categorized[n][o[i]],Array.isArray(s)&&c.push.apply(c,s);for(i=0,e=c.length;i<e;i++)a=c[i],(void 0!==t.visible&&a.isVisible()!==t.visible||void 0!==t.disabled&&a.isDisabled()!==t.disabled)&&(c.splice(i,1),e--,i--);for(i=0,e=c.length;i<e;i++)for(a=c[i],r=c.lastIndexOf(a);r!==i;)c.splice(r,1),e--,r=c.lastIndexOf(a);return c}return this.list.slice()},t.ui.ActionSet.prototype.getSpecial=function(){return this.organize(),$.extend({},this.special)},t.ui.ActionSet.prototype.getOthers=function(){return this.organize(),this.others.slice()},t.ui.ActionSet.prototype.setMode=function(t){var i,e,o;for(this.changing=!0,i=0,e=this.list.length;i<e;i++)o=this.list[i],o.toggle(o.hasMode(t));return this.organized=!1,this.changing=!1,this.emit("change"),this},t.ui.ActionSet.prototype.setAbilities=function(t){var i,e,o,n;for(i=0,e=this.list.length;i<e;i++)n=this.list[i],o=n.getAction(),void 0!==t[o]&&n.setDisabled(!t[o]);return this},t.ui.ActionSet.prototype.forEach=function(t,i){return this.changed=!1,this.changing=!0,this.get(t).forEach(i),this.changing=!1,this.changed&&this.emit("change"),this},t.ui.ActionSet.prototype.add=function(t){var i,e,o;for(this.changing=!0,i=0,e=t.length;i<e;i++)o=t[i],o.connect(this,{click:["emit","click",o],resize:["emit","resize",o],toggle:["onActionChange"]}),this.list.push(o);return this.organized=!1,this.emit("add",t),this.changing=!1,this.emit("change"),this},t.ui.ActionSet.prototype.remove=function(t){var i,e,o,n;for(this.changing=!0,i=0,e=t.length;i<e;i++)n=t[i],o=this.list.indexOf(n),o!==-1&&(n.disconnect(this),this.list.splice(o,1));return this.organized=!1,this.emit("remove",t),this.changing=!1,this.emit("change"),this},t.ui.ActionSet.prototype.clear=function(){var t,i,e,o=this.list.slice();for(this.changing=!0,t=0,i=this.list.length;t<i;t++)e=this.list[t],e.disconnect(this);return this.list=[],this.organized=!1,this.emit("remove",o),this.changing=!1,this.emit("change"),this},t.ui.ActionSet.prototype.organize=function(){var t,i,e,o,n,s,r,a,c,h,u=this.constructor.static.specialFlags;if(!this.organized){for(this.categorized={},this.special={},this.others=[],t=0,i=this.list.length;t<i;t++)if(s=this.list[t],s.isVisible()){for(r in this.categories)for(this.categorized[r]||(this.categorized[r]={}),a=s[this.categories[r]](),Array.isArray(a)||(a=[a]),e=0,o=a.length;e<o;e++)c=a[e],this.categorized[r][c]||(this.categorized[r][c]=[]),this.categorized[r][c].push(s);for(h=!1,e=0,o=u.length;e<o;e++)if(n=u[e],!this.special[n]&&s.hasFlag(n)){this.special[n]=s,h=!0;break}h||this.others.push(s)}this.organized=!0}return this},t.ui.Error=function(i,e){t.isPlainObject(i)&&void 0===e&&(e=i,i=e.message),e=e||{},this.message=i instanceof jQuery?i:String(i),this.recoverable=void 0===e.recoverable||!!e.recoverable,this.warning=!!e.warning},t.initClass(t.ui.Error),t.ui.Error.prototype.isRecoverable=function(){return this.recoverable},t.ui.Error.prototype.isWarning=function(){return this.warning},t.ui.Error.prototype.getMessage=function(){return this.message instanceof jQuery?this.message.clone():$("<div>").text(this.message).contents()},t.ui.Error.prototype.getMessageText=function(){return this.message instanceof jQuery?this.message.text():this.message},t.ui.Process=function(t,i){this.steps=[],void 0!==t&&this.next(t,i)},t.initClass(t.ui.Process),t.ui.Process.prototype.execute=function(){function i(i){return function(){var e,o=i.callback.call(i.context);if(o===!1)return $.Deferred().reject([]).promise();if("number"==typeof o){if(o<0)throw new Error("Cannot go back in time: flux capacitor is out of service");return e=$.Deferred(),setTimeout(e.resolve,o),e.promise()}return o instanceof t.ui.Error?$.Deferred().reject([o]).promise():Array.isArray(o)&&o.length&&o[0]instanceof t.ui.Error?$.Deferred().reject(o).promise():o&&$.isFunction(o.promise)?o.promise():$.Deferred().resolve().promise()}}var e,o,n;if(this.steps.length)for(n=i(this.steps[0])(),e=1,o=this.steps.length;e<o;e++)n=n.then(i(this.steps[e]));else n=$.Deferred().resolve().promise();return n},t.ui.Process.prototype.createStep=function(t,i){if("number"==typeof t||$.isFunction(t.promise))return{callback:function(){return t},context:null};if($.isFunction(t))return{callback:t,context:i};throw new Error("Cannot create process step: number, promise or function expected")},t.ui.Process.prototype.first=function(t,i){return this.steps.unshift(this.createStep(t,i)),this},t.ui.Process.prototype.next=function(t,i){return this.steps.push(this.createStep(t,i)),this},t.ui.WindowManager=function(i){i=i||{},t.ui.WindowManager.parent.call(this,i),t.EventEmitter.call(this),this.factory=i.factory,this.modal=void 0===i.modal||!!i.modal,this.windows={},this.opening=null,this.opened=null,this.closing=null,this.preparingToOpen=null,this.preparingToClose=null,this.currentWindow=null,this.globalEvents=!1,this.$ariaHidden=null,this.onWindowResizeTimeout=null,this.onWindowResizeHandler=this.onWindowResize.bind(this),this.afterWindowResizeHandler=this.afterWindowResize.bind(this),this.$element.addClass("oo-ui-windowManager").toggleClass("oo-ui-windowManager-modal",this.modal)},t.inheritClass(t.ui.WindowManager,t.ui.Element),t.mixinClass(t.ui.WindowManager,t.EventEmitter),t.ui.WindowManager.static.sizes={small:{width:300},medium:{width:500},large:{width:700},larger:{width:900},full:{width:"100%",height:"100%"}},t.ui.WindowManager.static.defaultSize="medium",t.ui.WindowManager.prototype.onWindowResize=function(){clearTimeout(this.onWindowResizeTimeout),this.onWindowResizeTimeout=setTimeout(this.afterWindowResizeHandler,200)},t.ui.WindowManager.prototype.afterWindowResize=function(){this.currentWindow&&this.updateWindowSize(this.currentWindow)},t.ui.WindowManager.prototype.isOpening=function(t){return t===this.currentWindow&&!!this.opening&&"pending"===this.opening.state()},t.ui.WindowManager.prototype.isClosing=function(t){return t===this.currentWindow&&!!this.closing&&"pending"===this.closing.state()},t.ui.WindowManager.prototype.isOpened=function(t){return t===this.currentWindow&&!!this.opened&&"pending"===this.opened.state()},t.ui.WindowManager.prototype.hasWindow=function(t){var i;for(i in this.windows)if(this.windows[i]===t)return!0;return!1},t.ui.WindowManager.prototype.getSetupDelay=function(){return 0},t.ui.WindowManager.prototype.getReadyDelay=function(){return 0},t.ui.WindowManager.prototype.getHoldDelay=function(){return 0},t.ui.WindowManager.prototype.getTeardownDelay=function(){return this.modal?250:0},t.ui.WindowManager.prototype.getWindow=function(i){var e=$.Deferred(),o=this.windows[i];return o instanceof t.ui.Window?e.resolve(o):this.factory?this.factory.lookup(i)?(o=this.factory.create(i),this.addWindows([o]),e.resolve(o)):e.reject(new t.ui.Error("Cannot auto-instantiate window: symbolic name is unrecognized by the factory")):e.reject(new t.ui.Error("Cannot get unmanaged window: symbolic name unrecognized as a managed window")),e.promise()},t.ui.WindowManager.prototype.getCurrentWindow=function(){return this.currentWindow},t.ui.WindowManager.prototype.openWindow=function(i,e){var o=this,n=$.Deferred();return"string"==typeof i?this.getWindow(i).then(function(t){return o.openWindow(t,e)}):(this.hasWindow(i)?(this.preparingToOpen||this.opening||this.opened)&&n.reject(new t.ui.Error("Cannot open window: another window is opening or open")):n.reject(new t.ui.Error("Cannot open window: window is not attached to manager")),"rejected"!==n.state()&&(this.preparingToOpen=$.when(this.closing),this.preparingToOpen.done(function(){o.modal&&(o.toggleGlobalEvents(!0),o.toggleAriaIsolation(!0)),o.currentWindow=i,o.opening=n,o.preparingToOpen=null,o.emit("opening",i,n,e),setTimeout(function(){i.setup(e).then(function(){o.updateWindowSize(i),o.opening.notify({state:"setup"}),setTimeout(function(){i.ready(e).then(function(){o.opening.notify({state:"ready"}),o.opening=null,o.opened=$.Deferred(),n.resolve(o.opened.promise(),e)},function(){o.opening=null,o.opened=$.Deferred(),n.reject(),o.closeWindow(i)})},o.getReadyDelay())},function(){o.opening=null,o.opened=$.Deferred(),n.reject(),o.closeWindow(i)})},o.getSetupDelay())})),n.promise())},t.ui.WindowManager.prototype.closeWindow=function(i,e){var o,n=this,s=$.Deferred();return"string"==typeof i?i=this.windows[i]:this.hasWindow(i)||(i=null),i?i!==this.currentWindow?s.reject(new t.ui.Error("Cannot close window: window already closed with different data")):(this.preparingToClose||this.closing)&&s.reject(new t.ui.Error("Cannot close window: window already closing with different data")):s.reject(new t.ui.Error("Cannot close window: window is not attached to manager")),"rejected"!==s.state()&&(this.preparingToClose=$.when(this.opening),this.preparingToClose.always(function(){n.closing=s,n.preparingToClose=null,n.emit("closing",i,s,e),o=n.opened,n.opened=null,o.resolve(s.promise(),e),setTimeout(function(){i.hold(e).then(function(){s.notify({state:"hold"}),setTimeout(function(){i.teardown(e).then(function(){s.notify({state:"teardown"}),n.modal&&(n.toggleGlobalEvents(!1),n.toggleAriaIsolation(!1)),n.closing=null,n.currentWindow=null,s.resolve(e)})},n.getTeardownDelay())})},n.getHoldDelay())})),s.promise()},t.ui.WindowManager.prototype.addWindows=function(i){var e,o,n,s,r;if(Array.isArray(i))for(r={},e=0,o=i.length;e<o;e++){if(s=i[e].constructor.static.name,"string"!=typeof s)throw new Error("Cannot add window");r[s]=i[e]}else t.isPlainObject(i)&&(r=i);for(s in r)n=r[s],this.windows[s]=n.toggle(!1),this.$element.append(n.$element),n.setManager(this)},t.ui.WindowManager.prototype.removeWindows=function(t){var i,e,o,n,s,r=this,a=[],c=function(t,i){delete r.windows[t],i.$element.detach()};for(i=0,e=t.length;i<e;i++){if(n=t[i],o=this.windows[n],!o)throw new Error("Cannot remove window");s=c.bind(null,n,o),a.push(this.closeWindow(n).then(s,s))}return $.when.apply($,a)},t.ui.WindowManager.prototype.clearWindows=function(){return this.removeWindows(Object.keys(this.windows))},t.ui.WindowManager.prototype.updateWindowSize=function(t){var i;if(t===this.currentWindow)return i="full"===t.getSize(),this.$element.toggleClass("oo-ui-windowManager-fullscreen",i),this.$element.toggleClass("oo-ui-windowManager-floating",!i),t.setDimensions(t.getSizeProperties()),this.emit("resize",t),this},t.ui.WindowManager.prototype.toggleGlobalEvents=function(t){var i,e,o=$(this.getElementDocument().body),n=o.data("windowManagerGlobalEvents")||0;return t=void 0===t?!!this.globalEvents:!!t,t?this.globalEvents||($(this.getElementWindow()).on({"orientationchange resize":this.onWindowResizeHandler}),0===n&&(i=window.innerWidth-document.documentElement.clientWidth,e=parseFloat(o.css("margin-right"))||0,o.css({overflow:"hidden","margin-right":e+i})),n++,this.globalEvents=!0):this.globalEvents&&($(this.getElementWindow()).off({"orientationchange resize":this.onWindowResizeHandler}),n--,0===n&&o.css({overflow:"","margin-right":""}),this.globalEvents=!1),o.data("windowManagerGlobalEvents",n),this},t.ui.WindowManager.prototype.toggleAriaIsolation=function(t){return t=void 0===t?!this.$ariaHidden:!!t,t?this.$ariaHidden||(this.$ariaHidden=$("body").children().not(this.$element.parentsUntil("body").last()).attr("aria-hidden","")):this.$ariaHidden&&(this.$ariaHidden.removeAttr("aria-hidden"),this.$ariaHidden=null),this},t.ui.WindowManager.prototype.destroy=function(){this.toggleGlobalEvents(!1),this.toggleAriaIsolation(!1),this.clearWindows(),this.$element.remove()},t.ui.Window=function(i){i=i||{},t.ui.Window.parent.call(this,i),t.EventEmitter.call(this),this.manager=null,this.size=i.size||this.constructor.static.size,this.$frame=$("<div>"),this.$overlay=$("<div>"),this.$content=$("<div>"),this.$focusTrapBefore=$("<div>").prop("tabIndex",0),this.$focusTrapAfter=$("<div>").prop("tabIndex",0),this.$focusTraps=this.$focusTrapBefore.add(this.$focusTrapAfter),this.$overlay.addClass("oo-ui-window-overlay"),this.$content.addClass("oo-ui-window-content").attr("tabindex",0),this.$frame.addClass("oo-ui-window-frame").append(this.$focusTrapBefore,this.$content,this.$focusTrapAfter),this.$element.addClass("oo-ui-window").append(this.$frame,this.$overlay),this.visible=!1,this.$element.addClass("oo-ui-element-hidden")},t.inheritClass(t.ui.Window,t.ui.Element),t.mixinClass(t.ui.Window,t.EventEmitter),t.ui.Window.static.size="medium",t.ui.Window.prototype.onMouseDown=function(t){if(t.target===this.$element[0])return!1},t.ui.Window.prototype.isInitialized=function(){return!!this.manager},t.ui.Window.prototype.isVisible=function(){return this.visible},t.ui.Window.prototype.isOpening=function(){return this.manager.isOpening(this)},t.ui.Window.prototype.isClosing=function(){return this.manager.isClosing(this)},t.ui.Window.prototype.isOpened=function(){return this.manager.isOpened(this)},t.ui.Window.prototype.getManager=function(){return this.manager},t.ui.Window.prototype.getSize=function(){var i=t.ui.Element.static.getDimensions(this.getElementWindow()),e=this.manager.constructor.static.sizes,o=this.size;return e[o]||(o=this.manager.constructor.static.defaultSize),"full"!==o&&i.rect.right-i.rect.left<e[o].width&&(o="full"),o},t.ui.Window.prototype.getSizeProperties=function(){return this.manager.constructor.static.sizes[this.getSize()]},t.ui.Window.prototype.withoutSizeTransitions=function(t){var i,e=this.$frame[0].style;i=e.transition||e.OTransition||e.MsTransition||e.MozTransition||e.WebkitTransition,e.transition=e.OTransition=e.MsTransition=e.MozTransition=e.WebkitTransition="none",t(),this.$frame.height(),e.transition=e.OTransition=e.MsTransition=e.MozTransition=e.WebkitTransition=i},t.ui.Window.prototype.getContentHeight=function(){var t,i=this,e=this.$body[0].style,o=this.$frame[0].style;return this.withoutSizeTransitions(function(){var n=o.height,s=e.position;o.height="1px",e.position="relative",t=i.getBodyHeight(),o.height=n,e.position=s}),this.$frame.outerHeight()-this.$frame.innerHeight()+(this.$head.outerHeight(!0)+t+this.$foot.outerHeight(!0))},t.ui.Window.prototype.getBodyHeight=function(){return this.$body[0].scrollHeight},t.ui.Window.prototype.getDir=function(){return t.ui.Element.static.getDir(this.$content)||"ltr"},t.ui.Window.prototype.getSetupProcess=function(){return new t.ui.Process},t.ui.Window.prototype.getReadyProcess=function(){return new t.ui.Process},t.ui.Window.prototype.getHoldProcess=function(){return new t.ui.Process},t.ui.Window.prototype.getTeardownProcess=function(){return new t.ui.Process},t.ui.Window.prototype.setManager=function(t){if(this.manager)throw new Error("Cannot set window manager, window already has a manager");return this.manager=t,this.initialize(),this},t.ui.Window.prototype.setSize=function(t){return this.size=t,this.updateSize(),this},t.ui.Window.prototype.updateSize=function(){if(!this.manager)throw new Error("Cannot update window size, must be attached to a manager");return this.manager.updateWindowSize(this),this},t.ui.Window.prototype.setDimensions=function(t){var i,e=this,o=this.$frame[0].style;return void 0===t.height?this.withoutSizeTransitions(function(){var n=o.width;e.$frame.css("width",t.width||""),i=e.getContentHeight(),o.width=n}):i=t.height,this.$frame.css({width:t.width||"",minWidth:t.minWidth||"",maxWidth:t.maxWidth||"",height:i||"",minHeight:t.minHeight||"",maxHeight:t.maxHeight||""}),this},t.ui.Window.prototype.initialize=function(){if(!this.manager)throw new Error("Cannot initialize window, must be attached to a manager");return this.$head=$("<div>"),this.$body=$("<div>"),this.$foot=$("<div>"),this.$document=$(this.getElementDocument()),this.$element.on("mousedown",this.onMouseDown.bind(this)),this.$head.addClass("oo-ui-window-head"),this.$body.addClass("oo-ui-window-body"),this.$foot.addClass("oo-ui-window-foot"),this.$content.append(this.$head,this.$body,this.$foot),this},t.ui.Window.prototype.onFocusTrapFocused=function(i){this.$focusTrapBefore.is(i.target)?t.ui.findFocusable(this.$content,!0).focus():this.$content.focus()},t.ui.Window.prototype.open=function(t){if(!this.manager)throw new Error("Cannot open window, must be attached to a manager");return this.manager.openWindow(this,t)},t.ui.Window.prototype.close=function(t){if(!this.manager)throw new Error("Cannot close window, must be attached to a manager");return this.manager.closeWindow(this,t)},t.ui.Window.prototype.setup=function(i){var e=this;return this.toggle(!0),this.focusTrapHandler=t.ui.bind(this.onFocusTrapFocused,this),this.$focusTraps.on("focus",this.focusTrapHandler),this.getSetupProcess(i).execute().then(function(){e.$element.addClass("oo-ui-window-active oo-ui-window-setup").width(),e.$content.addClass("oo-ui-window-content-setup").width()})},t.ui.Window.prototype.ready=function(t){var i=this;return this.$content.focus(),this.getReadyProcess(t).execute().then(function(){i.$element.addClass("oo-ui-window-ready").width(),i.$content.addClass("oo-ui-window-content-ready").width()})},t.ui.Window.prototype.hold=function(i){var e=this;return this.getHoldProcess(i).execute().then(function(){var i=e.$content.find(t.ui.Element.static.getDocument(e.$content).activeElement);i.length&&i[0].blur(),e.$element.removeClass("oo-ui-window-ready").width(),e.$content.removeClass("oo-ui-window-content-ready").width()})},t.ui.Window.prototype.teardown=function(t){var i=this;return this.getTeardownProcess(t).execute().then(function(){i.$element.removeClass("oo-ui-window-active oo-ui-window-setup").width(),i.$content.removeClass("oo-ui-window-content-setup").width(),i.$focusTraps.off("focus",i.focusTrapHandler),i.toggle(!1)})},t.ui.Dialog=function(i){t.ui.Dialog.parent.call(this,i),t.ui.mixin.PendingElement.call(this),this.actions=new t.ui.ActionSet,this.attachedActions=[],this.currentAction=null,this.onDialogKeyDownHandler=this.onDialogKeyDown.bind(this),this.actions.connect(this,{click:"onActionClick",resize:"onActionResize",change:"onActionsChange"}),this.$element.addClass("oo-ui-dialog").attr("role","dialog")},t.inheritClass(t.ui.Dialog,t.ui.Window),t.mixinClass(t.ui.Dialog,t.ui.mixin.PendingElement),t.ui.Dialog.static.name="",t.ui.Dialog.static.title="",t.ui.Dialog.static.actions=[],t.ui.Dialog.static.escapable=!0,t.ui.Dialog.prototype.onDialogKeyDown=function(i){i.which===t.ui.Keys.ESCAPE&&(this.executeAction(""),i.preventDefault(),i.stopPropagation())},t.ui.Dialog.prototype.onActionResize=function(){},t.ui.Dialog.prototype.onActionClick=function(t){this.isPending()||this.executeAction(t.getAction())},t.ui.Dialog.prototype.onActionsChange=function(){this.detachActions(),this.isClosing()||this.attachActions()},t.ui.Dialog.prototype.getActions=function(){return this.actions},t.ui.Dialog.prototype.getActionProcess=function(i){return(new t.ui.Process).next(function(){i||this.close()},this)},t.ui.Dialog.prototype.getSetupProcess=function(i){return i=i||{},t.ui.Dialog.parent.prototype.getSetupProcess.call(this,i).next(function(){var t=this.constructor.static,e=void 0!==i.actions?i.actions:t.actions;this.title.setLabel(void 0!==i.title?i.title:this.constructor.static.title),this.actions.add(this.getActionWidgets(e)),this.constructor.static.escapable&&this.$element.on("keydown",this.onDialogKeyDownHandler)},this)},t.ui.Dialog.prototype.getTeardownProcess=function(i){return t.ui.Dialog.parent.prototype.getTeardownProcess.call(this,i).first(function(){this.constructor.static.escapable&&this.$element.off("keydown",this.onDialogKeyDownHandler),this.actions.clear(),this.currentAction=null},this)},t.ui.Dialog.prototype.initialize=function(){var i;t.ui.Dialog.parent.prototype.initialize.call(this),i=t.ui.generateElementId(),this.title=new t.ui.LabelWidget({id:i}),this.$content.addClass("oo-ui-dialog-content"),this.$element.attr("aria-labelledby",i),this.setPendingElement(this.$head)},t.ui.Dialog.prototype.getActionWidgets=function(i){var e,o,n=[];for(e=0,o=i.length;e<o;e++)n.push(new t.ui.ActionWidget(i[e]));return n},t.ui.Dialog.prototype.attachActions=function(){this.attachedActions=this.actions.get()},t.ui.Dialog.prototype.detachActions=function(){var t,i;for(t=0,i=this.attachedActions.length;t<i;t++)this.attachedActions[t].$element.detach();this.attachedActions=[]},t.ui.Dialog.prototype.executeAction=function(t){return this.pushPending(),this.currentAction=t,this.getActionProcess(t).execute().always(this.popPending.bind(this))},t.ui.MessageDialog=function(i){t.ui.MessageDialog.parent.call(this,i),this.verticalActionLayout=null,this.$element.addClass("oo-ui-messageDialog")},t.inheritClass(t.ui.MessageDialog,t.ui.Dialog),t.ui.MessageDialog.static.name="message",t.ui.MessageDialog.static.size="small",t.ui.MessageDialog.static.verbose=!1,t.ui.MessageDialog.static.title=null,t.ui.MessageDialog.static.message=null,t.ui.MessageDialog.static.actions=[{action:"accept",label:t.ui.deferMsg("ooui-dialog-message-accept"),flags:"primary"},{action:"reject",label:t.ui.deferMsg("ooui-dialog-message-reject"),flags:"safe"}],t.ui.MessageDialog.prototype.setManager=function(i){return t.ui.MessageDialog.parent.prototype.setManager.call(this,i),this.manager.connect(this,{resize:"onResize"}),this},t.ui.MessageDialog.prototype.onActionResize=function(i){return this.fitActions(),t.ui.MessageDialog.parent.prototype.onActionResize.call(this,i)},t.ui.MessageDialog.prototype.onResize=function(){var t=this;t.fitActions(),setTimeout(function(){t.fitActions()},300)},t.ui.MessageDialog.prototype.toggleVerticalActionLayout=function(t){return t=void 0===t?!this.verticalActionLayout:!!t,t!==this.verticalActionLayout&&(this.verticalActionLayout=t,this.$actions.toggleClass("oo-ui-messageDialog-actions-vertical",t).toggleClass("oo-ui-messageDialog-actions-horizontal",!t)),this},t.ui.MessageDialog.prototype.getActionProcess=function(i){return i?new t.ui.Process(function(){this.close({action:i})},this):t.ui.MessageDialog.parent.prototype.getActionProcess.call(this,i)},t.ui.MessageDialog.prototype.getSetupProcess=function(i){return i=i||{},t.ui.MessageDialog.parent.prototype.getSetupProcess.call(this,i).next(function(){this.title.setLabel(void 0!==i.title?i.title:this.constructor.static.title),this.message.setLabel(void 0!==i.message?i.message:this.constructor.static.message),this.message.$element.toggleClass("oo-ui-messageDialog-message-verbose",void 0!==i.verbose?i.verbose:this.constructor.static.verbose)},this)},t.ui.MessageDialog.prototype.getReadyProcess=function(i){return i=i||{},t.ui.MessageDialog.parent.prototype.getReadyProcess.call(this,i).next(function(){var t=this.actions.get();t=t.filter(function(t){return t.getFlags().indexOf("primary")>-1}),t.length>0&&t[0].$button.focus()},this)},t.ui.MessageDialog.prototype.getBodyHeight=function(){var i,e,o=this.container.$element;return e=o[0].style.overflow,o[0].style.overflow="hidden",t.ui.Element.static.reconsiderScrollbars(o[0]),i=this.text.$element.outerHeight(!0),o[0].style.overflow=e,i},t.ui.MessageDialog.prototype.setDimensions=function(i){var e=this.container.$element;return t.ui.MessageDialog.parent.prototype.setDimensions.call(this,i),setTimeout(function(){var i=e[0].style.overflow;e[0].style.overflow="hidden",t.ui.Element.static.reconsiderScrollbars(e[0]),e[0].style.overflow=i},300),this},t.ui.MessageDialog.prototype.initialize=function(){t.ui.MessageDialog.parent.prototype.initialize.call(this),this.$actions=$("<div>"),this.container=new t.ui.PanelLayout({scrollable:!0,classes:["oo-ui-messageDialog-container"]}),this.text=new t.ui.PanelLayout({padded:!0,expanded:!1,classes:["oo-ui-messageDialog-text"]}),this.message=new t.ui.LabelWidget({classes:["oo-ui-messageDialog-message"]}),this.title.$element.addClass("oo-ui-messageDialog-title"),this.$content.addClass("oo-ui-messageDialog-content"),this.container.$element.append(this.text.$element),this.text.$element.append(this.title.$element,this.message.$element),this.$body.append(this.container.$element),this.$actions.addClass("oo-ui-messageDialog-actions"),this.$foot.append(this.$actions)},t.ui.MessageDialog.prototype.attachActions=function(){var i,e,o,n,s;if(t.ui.MessageDialog.parent.prototype.attachActions.call(this),n=this.actions.getSpecial(),s=this.actions.getOthers(),n.safe&&(this.$actions.append(n.safe.$element),n.safe.toggleFramed(!1)),s.length)for(i=0,e=s.length;i<e;i++)o=s[i],this.$actions.append(o.$element),o.toggleFramed(!1);n.primary&&(this.$actions.append(n.primary.$element),n.primary.toggleFramed(!1)),this.isOpening()||this.updateSize()},t.ui.MessageDialog.prototype.fitActions=function(){var t,i,e,o=this.verticalActionLayout,n=this.actions.get();for(this.toggleVerticalActionLayout(!1),t=0,i=n.length;t<i;t++)if(e=n[t],e.$element.innerWidth()<e.$label.outerWidth(!0)){this.toggleVerticalActionLayout(!0);break}this.$body.css("bottom",this.$foot.outerHeight(!0)),this.verticalActionLayout!==o&&this.updateSize()},t.ui.ProcessDialog=function(i){t.ui.ProcessDialog.parent.call(this,i),this.fitOnOpen=!1,this.$element.addClass("oo-ui-processDialog")},t.inheritClass(t.ui.ProcessDialog,t.ui.Dialog),t.ui.ProcessDialog.prototype.onDismissErrorButtonClick=function(){this.hideErrors()},t.ui.ProcessDialog.prototype.onRetryButtonClick=function(){this.hideErrors(),this.executeAction(this.currentAction)},t.ui.ProcessDialog.prototype.onActionResize=function(i){return this.actions.isSpecial(i)&&this.fitLabel(),t.ui.ProcessDialog.parent.prototype.onActionResize.call(this,i)},t.ui.ProcessDialog.prototype.initialize=function(){t.ui.ProcessDialog.parent.prototype.initialize.call(this),this.$navigation=$("<div>"),this.$location=$("<div>"),this.$safeActions=$("<div>"),this.$primaryActions=$("<div>"),this.$otherActions=$("<div>"),this.dismissButton=new t.ui.ButtonWidget({label:t.ui.msg("ooui-dialog-process-dismiss")}),this.retryButton=new t.ui.ButtonWidget,this.$errors=$("<div>"),this.$errorsTitle=$("<div>"),this.dismissButton.connect(this,{click:"onDismissErrorButtonClick"}),this.retryButton.connect(this,{click:"onRetryButtonClick"}),this.title.$element.addClass("oo-ui-processDialog-title"),this.$location.append(this.title.$element).addClass("oo-ui-processDialog-location"),this.$safeActions.addClass("oo-ui-processDialog-actions-safe"),this.$primaryActions.addClass("oo-ui-processDialog-actions-primary"),this.$otherActions.addClass("oo-ui-processDialog-actions-other"),this.$errorsTitle.addClass("oo-ui-processDialog-errors-title").text(t.ui.msg("ooui-dialog-process-error")),this.$errors.addClass("oo-ui-processDialog-errors oo-ui-element-hidden").append(this.$errorsTitle,this.dismissButton.$element,this.retryButton.$element),this.$content.addClass("oo-ui-processDialog-content").append(this.$errors),this.$navigation.addClass("oo-ui-processDialog-navigation").append(this.$safeActions,this.$location,this.$primaryActions),this.$head.append(this.$navigation),this.$foot.append(this.$otherActions)},t.ui.ProcessDialog.prototype.getActionWidgets=function(i){var e,o,n=[];for(e=0,o=i.length;e<o;e++)n.push(new t.ui.ActionWidget($.extend({framed:!0},i[e])));return n},t.ui.ProcessDialog.prototype.attachActions=function(){var i,e,o,n,s;for(t.ui.ProcessDialog.parent.prototype.attachActions.call(this),n=this.actions.getSpecial(),s=this.actions.getOthers(),n.primary&&this.$primaryActions.append(n.primary.$element),i=0,e=s.length;i<e;i++)o=s[i],this.$otherActions.append(o.$element);n.safe&&this.$safeActions.append(n.safe.$element),this.fitLabel(),this.$body.css("bottom",this.$foot.outerHeight(!0))},t.ui.ProcessDialog.prototype.executeAction=function(i){var e=this;return t.ui.ProcessDialog.parent.prototype.executeAction.call(this,i).fail(function(t){e.showErrors(t||[])})},t.ui.ProcessDialog.prototype.setDimensions=function(){t.ui.ProcessDialog.parent.prototype.setDimensions.apply(this,arguments),this.fitLabel()},t.ui.ProcessDialog.prototype.fitLabel=function(){var t,i,e,o,n,s,r,a=this.getSizeProperties();if("number"!=typeof a.width){if(!this.isOpened())return this.isOpening()?void(this.fitOnOpen||(this.manager.opening.done(this.fitLabel.bind(this)),this.fitOnOpen=!0)):void 0;n=this.$head.width()-20}else n=a.width-20;return t=this.$safeActions.is(":visible")?this.$safeActions.width():0,i=this.$primaryActions.is(":visible")?this.$primaryActions.width():0,e=Math.max(t,i),o=this.title.$element.width(),2*e+o<n?s=r=e:"ltr"===this.getDir()?(s=t,r=i):(s=i,r=t),this.$location.css({paddingLeft:s,paddingRight:r}),this},t.ui.ProcessDialog.prototype.showErrors=function(i){var e,o,n,s,r=[],a={},c=!0,h=!1;for(i instanceof t.ui.Error&&(i=[i]),e=0,o=i.length;e<o;e++)i[e].isRecoverable()||(c=!1),i[e].isWarning()&&(h=!0),n=$("<div>").addClass("oo-ui-processDialog-error").append(i[e].getMessage()),r.push(n[0]);this.$errorItems=$(r),c?(a[this.currentAction]=!0,s=this.actions.get({actions:this.currentAction}),s.length&&this.retryButton.clearFlags().setFlags(s[0].getFlags())):(a[this.currentAction]=!1,this.actions.setAbilities(a)),h?this.retryButton.setLabel(t.ui.msg("ooui-dialog-process-continue")):this.retryButton.setLabel(t.ui.msg("ooui-dialog-process-retry")),this.retryButton.toggle(c),this.$errorsTitle.after(this.$errorItems),this.$errors.removeClass("oo-ui-element-hidden").scrollTop(0)},t.ui.ProcessDialog.prototype.hideErrors=function(){this.$errors.addClass("oo-ui-element-hidden"),this.$errorItems&&(this.$errorItems.remove(),this.$errorItems=null)},t.ui.ProcessDialog.prototype.getTeardownProcess=function(i){return t.ui.ProcessDialog.parent.prototype.getTeardownProcess.call(this,i).first(function(){this.hideErrors(),this.fitOnOpen=!1},this)},t.ui.getWindowManager=function(){return t.ui.windowManager||(t.ui.windowManager=new t.ui.WindowManager,$("body").append(t.ui.windowManager.$element),t.ui.windowManager.addWindows({messageDialog:new t.ui.MessageDialog})),t.ui.windowManager},t.ui.alert=function(i,e){return t.ui.getWindowManager().openWindow("messageDialog",$.extend({
message:i,verbose:!0,actions:[t.ui.MessageDialog.static.actions[0]]},e)).then(function(t){return t.then(function(t){return t.then(function(){return $.Deferred().resolve()})})})},t.ui.confirm=function(i,e){return t.ui.getWindowManager().openWindow("messageDialog",$.extend({message:i,verbose:!0},e)).then(function(t){return t.then(function(t){return t.then(function(t){return $.Deferred().resolve(!(!t||"accept"!==t.action))})})})}}(OO);
//# sourceMappingURL=oojs-ui-windows.min.js.map