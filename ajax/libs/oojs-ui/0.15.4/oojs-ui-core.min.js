/*!
 * OOjs UI v0.15.4
 * https://www.mediawiki.org/wiki/OOjs_UI
 *
 * Copyright 2011â€“2016 OOjs UI Team and other contributors.
 * Released under the MIT license
 * http://oojs.mit-license.org
 *
 * Date: 2016-02-17T02:03:23Z
 */
!function(t){"use strict";t.ui={},t.ui.bind=$.proxy,t.ui.Keys={UNDEFINED:0,BACKSPACE:8,DELETE:46,LEFT:37,RIGHT:39,UP:38,DOWN:40,ENTER:13,END:35,HOME:36,TAB:9,PAGEUP:33,PAGEDOWN:34,ESCAPE:27,SHIFT:16,SPACE:32},t.ui.MouseButtons={LEFT:1,MIDDLE:2,RIGHT:3},t.ui.elementId=0,t.ui.generateElementId=function(){return t.ui.elementId+=1,"oojsui-"+t.ui.elementId},t.ui.isFocusableElement=function(t){var e,i=t[0];return!i.disabled&&(!(!$.expr.filters.visible(i)||t.parents().addBack().filter(function(){return"hidden"===$.css(this,"visibility")}).length)&&("true"===i.contentEditable||(t.prop("tabIndex")>=0||(e=i.nodeName.toLowerCase(),["input","select","textarea","button","object"].indexOf(e)!==-1||("a"===e||"area"===e)&&void 0!==t.attr("href")))))},t.ui.findFocusable=function(e,i){var n=$([]),s=e.find("input, select, textarea, button, object, a, area, [contenteditable], [tabindex]");return i&&(s=Array.prototype.reverse.call(s)),s.each(function(){var e=$(this);if(t.ui.isFocusableElement(e))return n=e,!1}),n},t.ui.getUserLanguages=function(){return["en"]},t.ui.getLocalValue=function(e,i,n){var s,o,l;if(e[i])return e[i];for(l=t.ui.getUserLanguages(),s=0,o=l.length;s<o;s++)if(i=l[s],e[i])return e[i];if(e[n])return e[n];for(i in e)return e[i]},t.ui.contains=function(t,e,i){var n;for(Array.isArray(t)||(t=[t]),n=t.length-1;n>=0;n--)if(i&&e===t[n]||$.contains(t[n],e))return!0;return!1},t.ui.debounce=function(t,e,i){var n;return function(){var s=this,o=arguments,l=function(){n=null,i||t.apply(s,o)};i&&!n&&t.apply(s,o),clearTimeout(n),n=setTimeout(l,e)}},t.ui.addCaptureEventListener=function(t,e,i){t.addEventListener(e,i,!0)},t.ui.removeCaptureEventListener=function(t,e,i){t.removeEventListener(e,i,!0)},t.ui.infuse=function(e){return t.ui.Element.static.infuse(e)},function(){var e={"ooui-outline-control-move-down":"Move item down","ooui-outline-control-move-up":"Move item up","ooui-outline-control-remove":"Remove item","ooui-toolbar-more":"More","ooui-toolgroup-expand":"More","ooui-toolgroup-collapse":"Fewer","ooui-dialog-message-accept":"OK","ooui-dialog-message-reject":"Cancel","ooui-dialog-process-error":"Something went wrong","ooui-dialog-process-dismiss":"Dismiss","ooui-dialog-process-retry":"Try again","ooui-dialog-process-continue":"Continue","ooui-selectfile-button-select":"Select a file","ooui-selectfile-not-supported":"File selection is not supported","ooui-selectfile-placeholder":"No file is selected","ooui-selectfile-dragdrop-placeholder":"Drop file here"};t.ui.msg=function(t){var i=e[t],n=Array.prototype.slice.call(arguments,1);return i="string"==typeof i?i.replace(/\$(\d+)/g,function(t,e){var i=parseInt(e,10);return void 0!==n[i-1]?n[i-1]:"$"+e}):"["+t+"]"}}(),t.ui.deferMsg=function(){var e=arguments;return function(){return t.ui.msg.apply(t.ui,e)}},t.ui.resolveMsg=function(t){return $.isFunction(t)?t():t},t.ui.isSafeUrl=function(t){function e(t,e){return t.substr(0,e.length)===e}var i,n;if(n=["bitcoin","ftp","ftps","geo","git","gopher","http","https","irc","ircs","magnet","mailto","mms","news","nntp","redis","sftp","sip","sips","sms","ssh","svn","tel","telnet","urn","worldwind","xmpp"],""===t)return!0;for(i=0;i<n.length;i++)if(e(t,n[i]+":"))return!0;return!(!e(t,"/")&&!e(t,"./"))||!(!e(t,"?")&&!e(t,"#"))},/*!
 * Mixin namespace.
 */
t.ui.mixin={},t.ui.Element=function(e){e=e||{},this.$=$,this.visible=!0,this.data=e.data,this.$element=e.$element||$(document.createElement(this.getTagName())),this.elementGroup=null,this.debouncedUpdateThemeClassesHandler=t.ui.debounce(this.debouncedUpdateThemeClasses),Array.isArray(e.classes)&&this.$element.addClass(e.classes.join(" ")),e.id&&this.$element.attr("id",e.id),e.text&&this.$element.text(e.text),e.content&&this.$element.append(e.content.map(function(e){return"string"==typeof e?document.createTextNode(e):e instanceof t.ui.HtmlSnippet?e.toString():e instanceof t.ui.Element?e.$element:e})),e.$content&&this.$element.append(e.$content)},t.initClass(t.ui.Element),t.ui.Element.static.tagName="div",t.ui.Element.static.infuse=function(e){var i=t.ui.Element.static.unsafeInfuse(e,!1);return i},t.ui.Element.static.unsafeInfuse=function(e,i){var n,s,o,l,u,a,r,h,d,p;if("string"==typeof e?(n=e,s=$(document.getElementById(n))):(s=$(e),n=s.attr("id")),!s.length)throw new Error("Widget not found: "+n);if(s[0].oouiInfused&&(s=s[0].oouiInfused),o=s.data("ooui-infused")){if(o===!0)throw new Error("Circular dependency! "+n);return i&&(d=o.gatherPreInfuseState(s),i.done(o.restorePreInfuseState.bind(o,d)),p=s.data("ooui-infused-children"),p&&p.length&&p.forEach(function(t){var e=t.gatherPreInfuseState(s);i.done(t.restorePreInfuseState.bind(t,e))})),o}if(o=s.attr("data-ooui"),!o)throw new Error("No infusion data found: "+n);try{o=$.parseJSON(o)}catch(t){o=null}if(!o||!o._)throw new Error("No valid infusion data found: "+n);if("Tag"===o._)return new t.ui.Element({$element:s});if(u=o._.split("."),l=t.getProp.apply(t,[window].concat(u)),void 0===l&&(l=t.getProp.apply(t,[t.ui].concat(u)),void 0===l))throw new Error("Unknown widget type: id: "+n+", class: "+o._);for(a=l.parent;void 0!==a&&a!==t.ui.Element;)a=a.parent;if(a!==t.ui.Element)throw new Error("Unknown widget type: id: "+n+", class: "+o._);return i===!1&&(h=$.Deferred(),i=h.promise()),s.data("ooui-infused",!0),o.id=n,p=[],o=t.copy(o,null,function(e){var n;if(t.isPlainObject(e)){if(e.tag)return n=t.ui.Element.static.unsafeInfuse(e.tag,i),p.push(n),p.push.apply(p,n.$element.data("ooui-infused-children")||[]),n.$element.removeData("ooui-infused-children"),n;if(e.html)return new t.ui.HtmlSnippet(e.html)}}),o=l.static.reusePreInfuseDOM(s[0],o),d=l.static.gatherPreInfuseState(s[0],o),r=new l(o),h&&(s[0]!==r.$element[0]&&(s.replaceWith(r.$element),s[0].oouiInfused=r.$element),h.resolve()),r.$element.data("ooui-infused",r),r.$element.data("ooui-infused-children",p),r.$element.attr("data-ooui",""),i.done(r.restorePreInfuseState.bind(r,d)),r},t.ui.Element.static.reusePreInfuseDOM=function(t,e){return e},t.ui.Element.static.gatherPreInfuseState=function(){return{}},t.ui.Element.static.getJQuery=function(t,e){function i(t){return $(t,i.context)}return i.context=this.getDocument(t),e&&(i.$iframe=e),i},t.ui.Element.static.getDocument=function(t){return t[0]&&t[0].ownerDocument||t.context||t.ownerDocument||t.document||9===t.nodeType&&t||null},t.ui.Element.static.getWindow=function(t){var e=this.getDocument(t);return e.defaultView},t.ui.Element.static.getDir=function(t){var e,i;return t instanceof jQuery&&(t=t[0]),e=9===t.nodeType,i=void 0!==t.document,(e||i)&&(i&&(t=t.document),t=t.body),$(t).css("direction")},t.ui.Element.static.getFrameOffset=function(t,e,i){var n,s,o,l,u;if(e||(e=window),i||(i={top:0,left:0}),t.parent===t)return i;for(o=t.parent.document.getElementsByTagName("iframe"),n=0,s=o.length;n<s;n++)if(o[n].contentWindow===t){l=o[n];break}return l&&(u=l.getBoundingClientRect(),i.left+=u.left,i.top+=u.top,t!==e&&this.getFrameOffset(t.parent,i)),i},t.ui.Element.static.getRelativePosition=function(t,e){for(var i,n,s=t.offset(),o=e.offset(),l=this.getDocument(t),u=this.getDocument(e);l!==u;){if(i=l.defaultView.frameElement,!i)throw new Error("$element frame is not contained in $anchor frame");n=$(i).offset(),s.left+=n.left,s.top+=n.top,l=i.ownerDocument}return s.left-=o.left,s.top-=o.top,s},t.ui.Element.static.getBorders=function(t){var e=t.ownerDocument,i=e.defaultView,n=i.getComputedStyle(t,null),s=$(t),o=parseFloat(n?n.borderTopWidth:s.css("borderTopWidth"))||0,l=parseFloat(n?n.borderLeftWidth:s.css("borderLeftWidth"))||0,u=parseFloat(n?n.borderBottomWidth:s.css("borderBottomWidth"))||0,a=parseFloat(n?n.borderRightWidth:s.css("borderRightWidth"))||0;return{top:o,left:l,bottom:u,right:a}},t.ui.Element.static.getDimensions=function(t){var e,i,n=t.ownerDocument||t.document,s=n.defaultView;return s===t||t===n.documentElement?(i=$(s),{borders:{top:0,left:0,bottom:0,right:0},scroll:{top:i.scrollTop(),left:i.scrollLeft()},scrollbar:{right:0,bottom:0},rect:{top:0,left:0,bottom:i.innerHeight(),right:i.innerWidth()}}):(e=$(t),{borders:this.getBorders(t),scroll:{top:e.scrollTop(),left:e.scrollLeft()},scrollbar:{right:e.innerWidth()-t.clientWidth,bottom:e.innerHeight()-t.clientHeight},rect:t.getBoundingClientRect()})},t.ui.Element.static.getRootScrollableElement=function(e){var i,n;return void 0===t.ui.scrollableElement&&(n=e.ownerDocument.body,i=n.scrollTop,n.scrollTop=1,1===n.scrollTop?(n.scrollTop=i,t.ui.scrollableElement="body"):t.ui.scrollableElement="documentElement"),e.ownerDocument[t.ui.scrollableElement]},t.ui.Element.static.getClosestScrollableContainer=function(t,e){var i,n,s=["overflow-x","overflow-y"],o=$(t).parent();for("x"!==e&&"y"!==e||(s=["overflow-"+e]);o.length;){if(o[0]===this.getRootScrollableElement(t))return o[0];for(i=s.length;i--;)if(n=o.css(s[i]),"auto"===n||"scroll"===n)return o[0];o=o.parent()}return this.getDocument(t).body},t.ui.Element.static.scrollIntoView=function(t,e){var i,n,s,o,l,u,a,r,h=$.Deferred();return e=e||{},n={},s="function"==typeof e.complete&&e.complete,o=this.getClosestScrollableContainer(t,e.direction),l=$(o),u=this.getDimensions(t),a=this.getDimensions(o),r=$(this.getWindow(t)),i=l.is("html, body")?{top:u.rect.top,bottom:r.innerHeight()-u.rect.bottom,left:u.rect.left,right:r.innerWidth()-u.rect.right}:{top:u.rect.top-(a.rect.top+a.borders.top),bottom:a.rect.bottom-a.borders.bottom-a.scrollbar.bottom-u.rect.bottom,left:u.rect.left-(a.rect.left+a.borders.left),right:a.rect.right-a.borders.right-a.scrollbar.right-u.rect.right},e.direction&&"y"!==e.direction||(i.top<0?n.scrollTop=a.scroll.top+i.top:i.top>0&&i.bottom<0&&(n.scrollTop=a.scroll.top+Math.min(i.top,-i.bottom))),e.direction&&"x"!==e.direction||(i.left<0?n.scrollLeft=a.scroll.left+i.left:i.left>0&&i.right<0&&(n.scrollLeft=a.scroll.left+Math.min(i.left,-i.right))),$.isEmptyObject(n)?(s&&s(),h.resolve()):(l.stop(!0).animate(n,void 0===e.duration?"fast":e.duration),l.queue(function(t){s&&s(),h.resolve(),t()})),h.promise()},t.ui.Element.static.reconsiderScrollbars=function(t){var e,i,n,s,o=[];for(n=t.scrollLeft,s=t.scrollTop;t.firstChild;)o.push(t.firstChild),t.removeChild(t.firstChild);for(void t.offsetHeight,e=0,i=o.length;e<i;e++)t.appendChild(o[e]);t.scrollLeft=n,t.scrollTop=s},t.ui.Element.prototype.toggle=function(t){return t=void 0===t?!this.visible:!!t,t!==this.isVisible()&&(this.visible=t,this.$element.toggleClass("oo-ui-element-hidden",!this.visible),this.emit("toggle",t)),this},t.ui.Element.prototype.isVisible=function(){return this.visible},t.ui.Element.prototype.getData=function(){return this.data},t.ui.Element.prototype.setData=function(t){return this.data=t,this},t.ui.Element.prototype.supports=function(t){var e,i,n=0;for(t=Array.isArray(t)?t:[t],e=0,i=t.length;e<i;e++)$.isFunction(this[t[e]])&&n++;return t.length===n},t.ui.Element.prototype.updateThemeClasses=function(){this.debouncedUpdateThemeClassesHandler()},t.ui.Element.prototype.debouncedUpdateThemeClasses=function(){t.ui.theme.updateElementClasses(this)},t.ui.Element.prototype.getTagName=function(){return this.constructor.static.tagName},t.ui.Element.prototype.isElementAttached=function(){return $.contains(this.getElementDocument(),this.$element[0])},t.ui.Element.prototype.getElementDocument=function(){return t.ui.Element.static.getDocument(this.$element)},t.ui.Element.prototype.getElementWindow=function(){return t.ui.Element.static.getWindow(this.$element)},t.ui.Element.prototype.getClosestScrollableElementContainer=function(){return t.ui.Element.static.getClosestScrollableContainer(this.$element[0])},t.ui.Element.prototype.getElementGroup=function(){return this.elementGroup},t.ui.Element.prototype.setElementGroup=function(t){return this.elementGroup=t,this},t.ui.Element.prototype.scrollElementIntoView=function(e){return t.ui.Element.static.scrollIntoView(this.$element[0],e)},t.ui.Element.prototype.restorePreInfuseState=function(){},t.ui.HtmlSnippet=function(t){this.content=t},t.initClass(t.ui.HtmlSnippet),t.ui.HtmlSnippet.prototype.toString=function(){return this.content},t.ui.Layout=function(e){e=e||{},t.ui.Layout.parent.call(this,e),t.EventEmitter.call(this),this.$element.addClass("oo-ui-layout")},t.inheritClass(t.ui.Layout,t.ui.Element),t.mixinClass(t.ui.Layout,t.EventEmitter),t.ui.Widget=function(e){e=$.extend({disabled:!1},e),t.ui.Widget.parent.call(this,e),t.EventEmitter.call(this),this.disabled=null,this.wasDisabled=null,this.$element.addClass("oo-ui-widget"),this.setDisabled(!!e.disabled)},t.inheritClass(t.ui.Widget,t.ui.Element),t.mixinClass(t.ui.Widget,t.EventEmitter),t.ui.Widget.static.supportsSimpleLabel=!1,t.ui.Widget.prototype.isDisabled=function(){return this.disabled},t.ui.Widget.prototype.setDisabled=function(t){var e;return this.disabled=!!t,e=this.isDisabled(),e!==this.wasDisabled&&(this.$element.toggleClass("oo-ui-widget-disabled",e),this.$element.toggleClass("oo-ui-widget-enabled",!e),this.$element.attr("aria-disabled",e.toString()),this.emit("disable",e),this.updateThemeClasses()),this.wasDisabled=e,this},t.ui.Widget.prototype.updateDisabled=function(){return this.setDisabled(this.disabled),this},t.ui.Theme=function(t){t=t||{}},t.initClass(t.ui.Theme),t.ui.Theme.prototype.getElementClasses=function(){return{on:[],off:[]}},t.ui.Theme.prototype.updateElementClasses=function(t){var e=$([]),i=this.getElementClasses(t);t.$icon&&(e=e.add(t.$icon)),t.$indicator&&(e=e.add(t.$indicator)),e.removeClass(i.off.join(" ")).addClass(i.on.join(" "))},t.ui.mixin.TabIndexedElement=function(t){t=$.extend({tabIndex:0},t),this.$tabIndexed=null,this.tabIndex=null,this.connect(this,{disable:"onTabIndexedElementDisable"}),this.setTabIndex(t.tabIndex),this.setTabIndexedElement(t.$tabIndexed||this.$element)},t.initClass(t.ui.mixin.TabIndexedElement),t.ui.mixin.TabIndexedElement.prototype.setTabIndexedElement=function(t){var e=this.tabIndex;return this.setTabIndex(null),this.$tabIndexed=t,this.tabIndex=e,this.updateTabIndex()},t.ui.mixin.TabIndexedElement.prototype.setTabIndex=function(t){return t="number"==typeof t?t:null,this.tabIndex!==t&&(this.tabIndex=t,this.updateTabIndex()),this},t.ui.mixin.TabIndexedElement.prototype.updateTabIndex=function(){return this.$tabIndexed&&(null!==this.tabIndex?this.$tabIndexed.attr({tabindex:this.isDisabled()?-1:this.tabIndex,"aria-disabled":this.isDisabled().toString()}):this.$tabIndexed.removeAttr("tabindex aria-disabled")),this},t.ui.mixin.TabIndexedElement.prototype.onTabIndexedElementDisable=function(){this.updateTabIndex()},t.ui.mixin.TabIndexedElement.prototype.getTabIndex=function(){return this.tabIndex},t.ui.mixin.ButtonElement=function(t){t=t||{},this.$button=null,this.framed=null,this.active=!1,this.onMouseUpHandler=this.onMouseUp.bind(this),this.onMouseDownHandler=this.onMouseDown.bind(this),this.onKeyDownHandler=this.onKeyDown.bind(this),this.onKeyUpHandler=this.onKeyUp.bind(this),this.onClickHandler=this.onClick.bind(this),this.onKeyPressHandler=this.onKeyPress.bind(this),this.$element.addClass("oo-ui-buttonElement"),this.toggleFramed(void 0===t.framed||t.framed),this.setButtonElement(t.$button||$("<a>"))},t.initClass(t.ui.mixin.ButtonElement),t.ui.mixin.ButtonElement.static.cancelButtonMouseDownEvents=!0,t.ui.mixin.ButtonElement.prototype.setButtonElement=function(t){this.$button&&this.$button.removeClass("oo-ui-buttonElement-button").removeAttr("role accesskey").off({mousedown:this.onMouseDownHandler,keydown:this.onKeyDownHandler,click:this.onClickHandler,keypress:this.onKeyPressHandler}),this.$button=t.addClass("oo-ui-buttonElement-button").attr({role:"button"}).on({mousedown:this.onMouseDownHandler,keydown:this.onKeyDownHandler,click:this.onClickHandler,keypress:this.onKeyPressHandler})},t.ui.mixin.ButtonElement.prototype.onMouseDown=function(e){if(!this.isDisabled()&&e.which===t.ui.MouseButtons.LEFT)return this.$element.addClass("oo-ui-buttonElement-pressed"),this.getElementDocument().addEventListener("mouseup",this.onMouseUpHandler,!0),!this.constructor.static.cancelButtonMouseDownEvents&&void 0},t.ui.mixin.ButtonElement.prototype.onMouseUp=function(e){this.isDisabled()||e.which!==t.ui.MouseButtons.LEFT||(this.$element.removeClass("oo-ui-buttonElement-pressed"),this.getElementDocument().removeEventListener("mouseup",this.onMouseUpHandler,!0))},t.ui.mixin.ButtonElement.prototype.onClick=function(e){if(!this.isDisabled()&&e.which===t.ui.MouseButtons.LEFT&&this.emit("click"))return!1},t.ui.mixin.ButtonElement.prototype.onKeyDown=function(e){this.isDisabled()||e.which!==t.ui.Keys.SPACE&&e.which!==t.ui.Keys.ENTER||(this.$element.addClass("oo-ui-buttonElement-pressed"),this.getElementDocument().addEventListener("keyup",this.onKeyUpHandler,!0))},t.ui.mixin.ButtonElement.prototype.onKeyUp=function(e){this.isDisabled()||e.which!==t.ui.Keys.SPACE&&e.which!==t.ui.Keys.ENTER||(this.$element.removeClass("oo-ui-buttonElement-pressed"),this.getElementDocument().removeEventListener("keyup",this.onKeyUpHandler,!0))},t.ui.mixin.ButtonElement.prototype.onKeyPress=function(e){if(!this.isDisabled()&&(e.which===t.ui.Keys.SPACE||e.which===t.ui.Keys.ENTER)&&this.emit("click"))return!1},t.ui.mixin.ButtonElement.prototype.isFramed=function(){return this.framed},t.ui.mixin.ButtonElement.prototype.toggleFramed=function(t){return t=void 0===t?!this.framed:!!t,t!==this.framed&&(this.framed=t,this.$element.toggleClass("oo-ui-buttonElement-frameless",!t).toggleClass("oo-ui-buttonElement-framed",t),this.updateThemeClasses()),this},t.ui.mixin.ButtonElement.prototype.setActive=function(t){return this.active=!!t,this.$element.toggleClass("oo-ui-buttonElement-active",this.active),this},t.ui.mixin.ButtonElement.prototype.isActive=function(){return this.active},t.ui.mixin.GroupElement=function(t){t=t||{},this.$group=null,this.items=[],this.aggregateItemEvents={},this.setGroupElement(t.$group||$("<div>"))},t.ui.mixin.GroupElement.prototype.setGroupElement=function(t){var e,i;for(this.$group=t,e=0,i=this.items.length;e<i;e++)this.$group.append(this.items[e].$element)},t.ui.mixin.GroupElement.prototype.isEmpty=function(){return!this.items.length},t.ui.mixin.GroupElement.prototype.getItems=function(){return this.items.slice(0)},t.ui.mixin.GroupElement.prototype.getItemFromData=function(e){var i,n,s,o=t.getHash(e);for(i=0,n=this.items.length;i<n;i++)if(s=this.items[i],o===t.getHash(s.getData()))return s;return null},t.ui.mixin.GroupElement.prototype.getItemsFromData=function(e){var i,n,s,o=t.getHash(e),l=[];for(i=0,n=this.items.length;i<n;i++)s=this.items[i],o===t.getHash(s.getData())&&l.push(s);return l},t.ui.mixin.GroupElement.prototype.aggregate=function(t){var e,i,n,s,o,l,u;for(l in t){if(u=t[l],Object.prototype.hasOwnProperty.call(this.aggregateItemEvents,l)){if(u)throw new Error("Duplicate item event aggregation for "+l);for(e=0,i=this.items.length;e<i;e++)n=this.items[e],n.connect&&n.disconnect&&(o={},o[l]=["emit",this.aggregateItemEvents[l],n],n.disconnect(this,o));delete this.aggregateItemEvents[l]}if(u)for(this.aggregateItemEvents[l]=u,e=0,i=this.items.length;e<i;e++)n=this.items[e],n.connect&&n.disconnect&&(s={},s[l]=["emit",u,n],n.connect(this,s))}},t.ui.mixin.GroupElement.prototype.addItems=function(t,e){var i,n,s,o,l,u,a=[];for(i=0,n=t.length;i<n;i++){if(s=t[i],u=this.items.indexOf(s),u>=0&&(this.removeItems([s]),u<e&&e--),s.connect&&s.disconnect&&!$.isEmptyObject(this.aggregateItemEvents)){l={};for(o in this.aggregateItemEvents)l[o]=["emit",this.aggregateItemEvents[o],s];s.connect(this,l)}s.setElementGroup(this),a.push(s.$element.get(0))}return void 0===e||e<0||e>=this.items.length?(this.$group.append(a),this.items.push.apply(this.items,t)):0===e?(this.$group.prepend(a),this.items.unshift.apply(this.items,t)):(this.items[e].$element.before(a),this.items.splice.apply(this.items,[e,0].concat(t))),this},t.ui.mixin.GroupElement.prototype.removeItems=function(t){var e,i,n,s,o,l;for(e=0,i=t.length;e<i;e++)n=t[e],s=this.items.indexOf(n),s!==-1&&(n.connect&&n.disconnect&&!$.isEmptyObject(this.aggregateItemEvents)&&(o={},Object.prototype.hasOwnProperty.call(this.aggregateItemEvents,l)&&(o[l]=["emit",this.aggregateItemEvents[l],n]),n.disconnect(this,o)),n.setElementGroup(null),this.items.splice(s,1),n.$element.detach());return this},t.ui.mixin.GroupElement.prototype.clearItems=function(){var t,e,i,n,s;for(t=0,e=this.items.length;t<e;t++)i=this.items[t],i.connect&&i.disconnect&&!$.isEmptyObject(this.aggregateItemEvents)&&(n={},Object.prototype.hasOwnProperty.call(this.aggregateItemEvents,s)&&(n[s]=["emit",this.aggregateItemEvents[s],i]),i.disconnect(this,n)),i.setElementGroup(null),i.$element.detach();return this.items=[],this},t.ui.mixin.IconElement=function(t){t=t||{},this.$icon=null,this.icon=null,this.iconTitle=null,this.setIcon(t.icon||this.constructor.static.icon),this.setIconTitle(t.iconTitle||this.constructor.static.iconTitle),this.setIconElement(t.$icon||$("<span>"))},t.initClass(t.ui.mixin.IconElement),t.ui.mixin.IconElement.static.icon=null,t.ui.mixin.IconElement.static.iconTitle=null,t.ui.mixin.IconElement.prototype.setIconElement=function(t){this.$icon&&this.$icon.removeClass("oo-ui-iconElement-icon oo-ui-icon-"+this.icon).removeAttr("title"),this.$icon=t.addClass("oo-ui-iconElement-icon").toggleClass("oo-ui-icon-"+this.icon,!!this.icon),null!==this.iconTitle&&this.$icon.attr("title",this.iconTitle),this.updateThemeClasses()},t.ui.mixin.IconElement.prototype.setIcon=function(e){return e=t.isPlainObject(e)?t.ui.getLocalValue(e,null,"default"):e,e="string"==typeof e&&e.trim().length?e.trim():null,this.icon!==e&&(this.$icon&&(null!==this.icon&&this.$icon.removeClass("oo-ui-icon-"+this.icon),null!==e&&this.$icon.addClass("oo-ui-icon-"+e)),this.icon=e),this.$element.toggleClass("oo-ui-iconElement",!!this.icon),this.updateThemeClasses(),this},t.ui.mixin.IconElement.prototype.setIconTitle=function(e){return e="function"==typeof e||"string"==typeof e&&e.length?t.ui.resolveMsg(e):null,this.iconTitle!==e&&(this.iconTitle=e,this.$icon&&(null!==this.iconTitle?this.$icon.attr("title",e):this.$icon.removeAttr("title"))),this},t.ui.mixin.IconElement.prototype.getIcon=function(){return this.icon},t.ui.mixin.IconElement.prototype.getIconTitle=function(){return this.iconTitle},t.ui.mixin.IndicatorElement=function(t){t=t||{},this.$indicator=null,this.indicator=null,this.indicatorTitle=null,this.setIndicator(t.indicator||this.constructor.static.indicator),this.setIndicatorTitle(t.indicatorTitle||this.constructor.static.indicatorTitle),this.setIndicatorElement(t.$indicator||$("<span>"))},t.initClass(t.ui.mixin.IndicatorElement),t.ui.mixin.IndicatorElement.static.indicator=null,t.ui.mixin.IndicatorElement.static.indicatorTitle=null,t.ui.mixin.IndicatorElement.prototype.setIndicatorElement=function(t){this.$indicator&&this.$indicator.removeClass("oo-ui-indicatorElement-indicator oo-ui-indicator-"+this.indicator).removeAttr("title"),this.$indicator=t.addClass("oo-ui-indicatorElement-indicator").toggleClass("oo-ui-indicator-"+this.indicator,!!this.indicator),null!==this.indicatorTitle&&this.$indicator.attr("title",this.indicatorTitle),this.updateThemeClasses()},t.ui.mixin.IndicatorElement.prototype.setIndicator=function(t){return t="string"==typeof t&&t.length?t.trim():null,this.indicator!==t&&(this.$indicator&&(null!==this.indicator&&this.$indicator.removeClass("oo-ui-indicator-"+this.indicator),null!==t&&this.$indicator.addClass("oo-ui-indicator-"+t)),this.indicator=t),this.$element.toggleClass("oo-ui-indicatorElement",!!this.indicator),this.updateThemeClasses(),this},t.ui.mixin.IndicatorElement.prototype.setIndicatorTitle=function(e){return e="function"==typeof e||"string"==typeof e&&e.length?t.ui.resolveMsg(e):null,this.indicatorTitle!==e&&(this.indicatorTitle=e,this.$indicator&&(null!==this.indicatorTitle?this.$indicator.attr("title",e):this.$indicator.removeAttr("title"))),this},t.ui.mixin.IndicatorElement.prototype.getIndicator=function(){return this.indicator},t.ui.mixin.IndicatorElement.prototype.getIndicatorTitle=function(){return this.indicatorTitle},t.ui.mixin.LabelElement=function(t){t=t||{},this.$label=null,this.label=null,this.autoFitLabel=void 0===t.autoFitLabel||!!t.autoFitLabel,this.setLabel(t.label||this.constructor.static.label),this.setLabelElement(t.$label||$("<span>"))},t.initClass(t.ui.mixin.LabelElement),t.ui.mixin.LabelElement.static.label=null,t.ui.mixin.LabelElement.prototype.setLabelElement=function(t){this.$label&&this.$label.removeClass("oo-ui-labelElement-label").empty(),this.$label=t.addClass("oo-ui-labelElement-label"),this.setLabelContent(this.label)},t.ui.mixin.LabelElement.prototype.setLabel=function(e){return e="function"==typeof e?t.ui.resolveMsg(e):e,e="string"==typeof e&&e.length||e instanceof jQuery||e instanceof t.ui.HtmlSnippet?e:null,this.$element.toggleClass("oo-ui-labelElement",!!e),this.label!==e&&(this.$label&&this.setLabelContent(e),this.label=e,this.emit("labelChange")),this},t.ui.mixin.LabelElement.prototype.getLabel=function(){return this.label},t.ui.mixin.LabelElement.prototype.fitLabel=function(){return this.$label&&this.$label.autoEllipsis&&this.autoFitLabel&&this.$label.autoEllipsis({hasSpan:!1,tooltip:!0}),this},t.ui.mixin.LabelElement.prototype.setLabelContent=function(e){"string"==typeof e?e.match(/^\s*$/)?this.$label.html("&nbsp;"):this.$label.text(e):e instanceof t.ui.HtmlSnippet?this.$label.html(e.toString()):e instanceof jQuery?this.$label.empty().append(e):this.$label.empty()},t.ui.mixin.FlaggedElement=function(t){t=t||{},this.flags={},this.$flagged=null,this.setFlags(t.flags),this.setFlaggedElement(t.$flagged||this.$element)},t.ui.mixin.FlaggedElement.prototype.setFlaggedElement=function(t){var e=Object.keys(this.flags).map(function(t){return"oo-ui-flaggedElement-"+t}).join(" ");this.$flagged&&this.$flagged.removeClass(e),this.$flagged=t.addClass(e)},t.ui.mixin.FlaggedElement.prototype.hasFlag=function(t){return this.flags&&t in this.flags},t.ui.mixin.FlaggedElement.prototype.getFlags=function(){return Object.keys(this.flags||{})},t.ui.mixin.FlaggedElement.prototype.clearFlags=function(){var t,e,i={},n=[],s="oo-ui-flaggedElement-";for(t in this.flags)e=s+t,i[t]=!1,delete this.flags[t],n.push(e);return this.$flagged&&this.$flagged.removeClass(n.join(" ")),this.updateThemeClasses(),this.emit("flag",i),this},t.ui.mixin.FlaggedElement.prototype.setFlags=function(e){var i,n,s,o,l={},u=[],a=[],r="oo-ui-flaggedElement-";if("string"==typeof e)o=r+e,this.flags[e]||(this.flags[e]=!0,u.push(o));else if(Array.isArray(e))for(i=0,n=e.length;i<n;i++)s=e[i],o=r+s,this.flags[s]||(l[s]=!0,this.flags[s]=!0,u.push(o));else if(t.isPlainObject(e))for(s in e)o=r+s,e[s]?this.flags[s]||(l[s]=!0,this.flags[s]=!0,u.push(o)):this.flags[s]&&(l[s]=!1,delete this.flags[s],a.push(o));return this.$flagged&&this.$flagged.addClass(u.join(" ")).removeClass(a.join(" ")),this.updateThemeClasses(),this.emit("flag",l),this},t.ui.mixin.TitledElement=function(t){t=t||{},this.$titled=null,this.title=null,this.setTitle(t.title||this.constructor.static.title),this.setTitledElement(t.$titled||this.$element)},t.initClass(t.ui.mixin.TitledElement),t.ui.mixin.TitledElement.static.title=null,t.ui.mixin.TitledElement.prototype.setTitledElement=function(t){this.$titled&&this.$titled.removeAttr("title"),this.$titled=t,this.title&&this.$titled.attr("title",this.title)},t.ui.mixin.TitledElement.prototype.setTitle=function(e){return e="function"==typeof e?t.ui.resolveMsg(e):e,e="string"==typeof e&&e.length?e:null,this.title!==e&&(this.$titled&&(null!==e?this.$titled.attr("title",e):this.$titled.removeAttr("title")),this.title=e),this},t.ui.mixin.TitledElement.prototype.getTitle=function(){return this.title},t.ui.mixin.AccessKeyedElement=function(t){t=t||{},this.$accessKeyed=null,this.accessKey=null,this.setAccessKey(t.accessKey||null),this.setAccessKeyedElement(t.$accessKeyed||this.$element)},t.initClass(t.ui.mixin.AccessKeyedElement),t.ui.mixin.AccessKeyedElement.static.accessKey=null,t.ui.mixin.AccessKeyedElement.prototype.setAccessKeyedElement=function(t){this.$accessKeyed&&this.$accessKeyed.removeAttr("accesskey"),this.$accessKeyed=t,this.accessKey&&this.$accessKeyed.attr("accesskey",this.accessKey)},t.ui.mixin.AccessKeyedElement.prototype.setAccessKey=function(e){return e="string"==typeof e?t.ui.resolveMsg(e):null,this.accessKey!==e&&(this.$accessKeyed&&(null!==e?this.$accessKeyed.attr("accesskey",e):this.$accessKeyed.removeAttr("accesskey")),this.accessKey=e),this},t.ui.mixin.AccessKeyedElement.prototype.getAccessKey=function(){return this.accessKey},t.ui.ButtonWidget=function(e){e=e||{},t.ui.ButtonWidget.parent.call(this,e),t.ui.mixin.ButtonElement.call(this,e),t.ui.mixin.IconElement.call(this,e),t.ui.mixin.IndicatorElement.call(this,e),t.ui.mixin.LabelElement.call(this,e),t.ui.mixin.TitledElement.call(this,$.extend({},e,{$titled:this.$button})),t.ui.mixin.FlaggedElement.call(this,e),t.ui.mixin.TabIndexedElement.call(this,$.extend({},e,{$tabIndexed:this.$button})),t.ui.mixin.AccessKeyedElement.call(this,$.extend({},e,{$accessKeyed:this.$button})),this.href=null,this.target=null,this.noFollow=!1,this.connect(this,{disable:"onDisable"}),this.$button.append(this.$icon,this.$label,this.$indicator),this.$element.addClass("oo-ui-buttonWidget").append(this.$button),this.setHref(e.href),this.setTarget(e.target),this.setNoFollow(e.noFollow)},t.inheritClass(t.ui.ButtonWidget,t.ui.Widget),t.mixinClass(t.ui.ButtonWidget,t.ui.mixin.ButtonElement),t.mixinClass(t.ui.ButtonWidget,t.ui.mixin.IconElement),t.mixinClass(t.ui.ButtonWidget,t.ui.mixin.IndicatorElement),t.mixinClass(t.ui.ButtonWidget,t.ui.mixin.LabelElement),t.mixinClass(t.ui.ButtonWidget,t.ui.mixin.TitledElement),t.mixinClass(t.ui.ButtonWidget,t.ui.mixin.FlaggedElement),t.mixinClass(t.ui.ButtonWidget,t.ui.mixin.TabIndexedElement),t.mixinClass(t.ui.ButtonWidget,t.ui.mixin.AccessKeyedElement),t.ui.ButtonWidget.prototype.onMouseDown=function(e){return this.isDisabled()||this.$button.removeAttr("tabindex"),t.ui.mixin.ButtonElement.prototype.onMouseDown.call(this,e)},t.ui.ButtonWidget.prototype.onMouseUp=function(e){return this.isDisabled()||this.$button.attr("tabindex",this.tabIndex),t.ui.mixin.ButtonElement.prototype.onMouseUp.call(this,e)},t.ui.ButtonWidget.prototype.getHref=function(){return this.href},t.ui.ButtonWidget.prototype.getTarget=function(){return this.target},t.ui.ButtonWidget.prototype.getNoFollow=function(){return this.noFollow},t.ui.ButtonWidget.prototype.setHref=function(e){return e="string"==typeof e?e:null,null===e||t.ui.isSafeUrl(e)||(e="./"+e),e!==this.href&&(this.href=e,this.updateHref()),this},t.ui.ButtonWidget.prototype.updateHref=function(){return null===this.href||this.isDisabled()?this.$button.removeAttr("href"):this.$button.attr("href",this.href),this},t.ui.ButtonWidget.prototype.onDisable=function(){this.updateHref()},t.ui.ButtonWidget.prototype.setTarget=function(t){return t="string"==typeof t?t:null,t!==this.target&&(this.target=t,null!==t?this.$button.attr("target",t):this.$button.removeAttr("target")),this},t.ui.ButtonWidget.prototype.setNoFollow=function(t){return t="boolean"!=typeof t||t,t!==this.noFollow&&(this.noFollow=t,t?this.$button.attr("rel","nofollow"):this.$button.removeAttr("rel")),this},t.ui.ButtonGroupWidget=function(e){e=e||{},t.ui.ButtonGroupWidget.parent.call(this,e),t.ui.mixin.GroupElement.call(this,$.extend({},e,{$group:this.$element})),this.$element.addClass("oo-ui-buttonGroupWidget"),Array.isArray(e.items)&&this.addItems(e.items)},t.inheritClass(t.ui.ButtonGroupWidget,t.ui.Widget),t.mixinClass(t.ui.ButtonGroupWidget,t.ui.mixin.GroupElement),t.ui.IconWidget=function(e){e=e||{},t.ui.IconWidget.parent.call(this,e),t.ui.mixin.IconElement.call(this,$.extend({},e,{$icon:this.$element})),t.ui.mixin.TitledElement.call(this,$.extend({},e,{$titled:this.$element})),t.ui.mixin.FlaggedElement.call(this,$.extend({},e,{$flagged:this.$element})),this.$element.addClass("oo-ui-iconWidget")},t.inheritClass(t.ui.IconWidget,t.ui.Widget),t.mixinClass(t.ui.IconWidget,t.ui.mixin.IconElement),t.mixinClass(t.ui.IconWidget,t.ui.mixin.TitledElement),t.mixinClass(t.ui.IconWidget,t.ui.mixin.FlaggedElement),t.ui.IconWidget.static.tagName="span",t.ui.IndicatorWidget=function(e){e=e||{},t.ui.IndicatorWidget.parent.call(this,e),t.ui.mixin.IndicatorElement.call(this,$.extend({},e,{$indicator:this.$element})),t.ui.mixin.TitledElement.call(this,$.extend({},e,{$titled:this.$element})),this.$element.addClass("oo-ui-indicatorWidget")},t.inheritClass(t.ui.IndicatorWidget,t.ui.Widget),t.mixinClass(t.ui.IndicatorWidget,t.ui.mixin.IndicatorElement),t.mixinClass(t.ui.IndicatorWidget,t.ui.mixin.TitledElement),t.ui.IndicatorWidget.static.tagName="span",t.ui.LabelWidget=function(e){e=e||{},t.ui.LabelWidget.parent.call(this,e),t.ui.mixin.LabelElement.call(this,$.extend({},e,{$label:this.$element})),t.ui.mixin.TitledElement.call(this,e),this.input=e.input,this.input instanceof t.ui.InputWidget&&this.$element.on("click",this.onClick.bind(this)),this.$element.addClass("oo-ui-labelWidget")},t.inheritClass(t.ui.LabelWidget,t.ui.Widget),t.mixinClass(t.ui.LabelWidget,t.ui.mixin.LabelElement),t.mixinClass(t.ui.LabelWidget,t.ui.mixin.TitledElement),t.ui.LabelWidget.static.tagName="span",t.ui.LabelWidget.prototype.onClick=function(){return this.input.simulateLabelClick(),!1},t.ui.mixin.PendingElement=function(t){t=t||{},this.pending=0,this.$pending=null,this.setPendingElement(t.$pending||this.$element)},t.initClass(t.ui.mixin.PendingElement),t.ui.mixin.PendingElement.prototype.setPendingElement=function(t){this.$pending&&this.$pending.removeClass("oo-ui-pendingElement-pending"),this.$pending=t,this.pending>0&&this.$pending.addClass("oo-ui-pendingElement-pending")},t.ui.mixin.PendingElement.prototype.isPending=function(){return!!this.pending},t.ui.mixin.PendingElement.prototype.pushPending=function(){return 0===this.pending&&(this.$pending.addClass("oo-ui-pendingElement-pending"),this.updateThemeClasses()),this.pending++,this},t.ui.mixin.PendingElement.prototype.popPending=function(){return 1===this.pending&&(this.$pending.removeClass("oo-ui-pendingElement-pending"),this.updateThemeClasses()),this.pending=Math.max(0,this.pending-1),this},t.ui.mixin.ClippableElement=function(t){t=t||{},this.$clippable=null,this.$clippableContainer=null,this.clipping=!1,this.clippedHorizontally=!1,this.clippedVertically=!1,this.$clippableScrollableContainer=null,this.$clippableScroller=null,this.$clippableWindow=null,this.idealWidth=null,this.idealHeight=null,this.onClippableScrollHandler=this.clip.bind(this),this.onClippableWindowResizeHandler=this.clip.bind(this),t.$clippableContainer&&this.setClippableContainer(t.$clippableContainer),this.setClippableElement(t.$clippable||this.$element)},t.ui.mixin.ClippableElement.prototype.setClippableElement=function(e){this.$clippable&&(this.$clippable.removeClass("oo-ui-clippableElement-clippable"),this.$clippable.css({width:"",height:"",overflowX:"",overflowY:""}),t.ui.Element.static.reconsiderScrollbars(this.$clippable[0])),this.$clippable=e.addClass("oo-ui-clippableElement-clippable"),this.clip()},t.ui.mixin.ClippableElement.prototype.setClippableContainer=function(t){this.$clippableContainer=t,this.$clippable&&this.clip()},t.ui.mixin.ClippableElement.prototype.toggleClipping=function(e){return e=void 0===e?!this.clipping:!!e,this.clipping!==e&&(this.clipping=e,e?(this.$clippableScrollableContainer=$(this.getClosestScrollableElementContainer()),
this.$clippableScroller=this.$clippableScrollableContainer.is("html, body")?$(t.ui.Element.static.getWindow(this.$clippableScrollableContainer)):this.$clippableScrollableContainer,this.$clippableScroller.on("scroll",this.onClippableScrollHandler),this.$clippableWindow=$(this.getElementWindow()).on("resize",this.onClippableWindowResizeHandler),this.clip()):(this.$clippable.css({width:"",height:"",overflowX:"",overflowY:""}),t.ui.Element.static.reconsiderScrollbars(this.$clippable[0]),this.$clippableScrollableContainer=null,this.$clippableScroller.off("scroll",this.onClippableScrollHandler),this.$clippableScroller=null,this.$clippableWindow.off("resize",this.onClippableWindowResizeHandler),this.$clippableWindow=null)),this},t.ui.mixin.ClippableElement.prototype.isClipping=function(){return this.clipping},t.ui.mixin.ClippableElement.prototype.isClipped=function(){return this.clippedHorizontally||this.clippedVertically},t.ui.mixin.ClippableElement.prototype.isClippedHorizontally=function(){return this.clippedHorizontally};t.ui.mixin.ClippableElement.prototype.isClippedVertically=function(){return this.clippedVertically};t.ui.mixin.ClippableElement.prototype.setIdealSize=function(t,e){this.idealWidth=t,this.idealHeight=e,this.clipping||this.$clippable.css({width:t,height:e})},t.ui.mixin.ClippableElement.prototype.clip=function(){var e,i,n,s,o,l,u,a,r,h,d,p,c,m,g,f,b,y,$,W,I=7;return this.clipping?(e=this.$clippableContainer||this.$clippable,i=e.outerHeight()-this.$clippable.outerHeight(),n=e.outerWidth()-this.$clippable.outerWidth(),s=e.offset(),o=this.$clippableScrollableContainer.is("html, body")?this.$clippableWindow:this.$clippableScrollableContainer,l=o.offset()||{top:0,left:0},u=o.innerHeight()-I,a=o.innerWidth()-I,r=e.outerWidth()+I,h=this.$clippableScroller[0]===this.$clippableWindow[0],d=h?this.$clippableScroller.scrollTop():0,p=h?this.$clippableScroller.scrollLeft():0,c=s.left<0?r+s.left:l.left+p+a-s.left,m=l.top+d+u-s.top,g=Math.ceil(c-n),f=Math.ceil(m-i),b=this.$clippable.prop("scrollWidth"),y=this.$clippable.prop("scrollHeight"),$=g<b,W=f<y,$?this.$clippable.css({overflowX:"scroll",width:Math.max(0,g)}):this.$clippable.css({width:this.idealWidth?this.idealWidth-n:"",overflowX:""}),W?this.$clippable.css({overflowY:"scroll",height:Math.max(0,f)}):this.$clippable.css({height:this.idealHeight?this.idealHeight-i:"",overflowY:""}),(this.clippedHorizontally&&!$||this.clippedVertically&&!W)&&t.ui.Element.static.reconsiderScrollbars(this.$clippable[0]),this.clippedHorizontally=$,this.clippedVertically=W,this):this},t.ui.PopupWidget=function(e){e=e||{},t.ui.PopupWidget.parent.call(this,e),this.$body=$("<div>"),this.$popup=$("<div>"),t.ui.mixin.LabelElement.call(this,e),t.ui.mixin.ClippableElement.call(this,$.extend({},e,{$clippable:this.$body,$clippableContainer:this.$popup})),this.$anchor=$("<div>"),this.$container=e.$container,this.containerPadding=void 0!==e.containerPadding?e.containerPadding:10,this.autoClose=!!e.autoClose,this.$autoCloseIgnore=e.$autoCloseIgnore,this.transitionTimeout=null,this.anchor=null,this.width=void 0!==e.width?e.width:320,this.height=void 0!==e.height?e.height:null,this.setAlignment(e.align),this.onMouseDownHandler=this.onMouseDown.bind(this),this.onDocumentKeyDownHandler=this.onDocumentKeyDown.bind(this),this.toggleAnchor(void 0===e.anchor||e.anchor),this.$body.addClass("oo-ui-popupWidget-body"),this.$anchor.addClass("oo-ui-popupWidget-anchor"),this.$popup.addClass("oo-ui-popupWidget-popup").append(this.$body),this.$element.addClass("oo-ui-popupWidget").append(this.$popup,this.$anchor),e.$content instanceof jQuery&&this.$body.append(e.$content),e.padded&&this.$body.addClass("oo-ui-popupWidget-body-padded"),e.head&&(this.closeButton=new t.ui.ButtonWidget({framed:!1,icon:"close"}),this.closeButton.connect(this,{click:"onCloseButtonClick"}),this.$head=$("<div>").addClass("oo-ui-popupWidget-head").append(this.$label,this.closeButton.$element),this.$popup.prepend(this.$head)),e.$footer&&(this.$footer=$("<div>").addClass("oo-ui-popupWidget-footer").append(e.$footer),this.$popup.append(this.$footer)),this.visible=!1,this.$element.addClass("oo-ui-element-hidden")},t.inheritClass(t.ui.PopupWidget,t.ui.Widget),t.mixinClass(t.ui.PopupWidget,t.ui.mixin.LabelElement),t.mixinClass(t.ui.PopupWidget,t.ui.mixin.ClippableElement),t.ui.PopupWidget.prototype.onMouseDown=function(t){!this.isVisible()||$.contains(this.$element[0],t.target)||this.$autoCloseIgnore&&this.$autoCloseIgnore.has(t.target).length||this.toggle(!1)},t.ui.PopupWidget.prototype.bindMouseDownListener=function(){this.getElementWindow().addEventListener("mousedown",this.onMouseDownHandler,!0)},t.ui.PopupWidget.prototype.onCloseButtonClick=function(){this.isVisible()&&this.toggle(!1)},t.ui.PopupWidget.prototype.unbindMouseDownListener=function(){this.getElementWindow().removeEventListener("mousedown",this.onMouseDownHandler,!0)},t.ui.PopupWidget.prototype.onDocumentKeyDown=function(e){e.which===t.ui.Keys.ESCAPE&&this.isVisible()&&(this.toggle(!1),e.preventDefault(),e.stopPropagation())},t.ui.PopupWidget.prototype.bindKeyDownListener=function(){this.getElementWindow().addEventListener("keydown",this.onDocumentKeyDownHandler,!0)},t.ui.PopupWidget.prototype.unbindKeyDownListener=function(){this.getElementWindow().removeEventListener("keydown",this.onDocumentKeyDownHandler,!0)},t.ui.PopupWidget.prototype.toggleAnchor=function(t){t=void 0===t?!this.anchored:!!t,this.anchored!==t&&(t?this.$element.addClass("oo-ui-popupWidget-anchored"):this.$element.removeClass("oo-ui-popupWidget-anchored"),this.anchored=t)},t.ui.PopupWidget.prototype.hasAnchor=function(){return this.anchor},t.ui.PopupWidget.prototype.toggle=function(e){var i;return e=void 0===e?!this.isVisible():!!e,i=e!==this.isVisible(),t.ui.PopupWidget.parent.prototype.toggle.call(this,e),i&&(e?(this.autoClose&&(this.bindMouseDownListener(),this.bindKeyDownListener()),this.updateDimensions(),this.toggleClipping(!0)):(this.toggleClipping(!1),this.autoClose&&(this.unbindMouseDownListener(),this.unbindKeyDownListener()))),this},t.ui.PopupWidget.prototype.setSize=function(t,e,i){this.width=t,this.height=void 0!==e?e:null,this.isVisible()&&this.updateDimensions(i)},t.ui.PopupWidget.prototype.updateDimensions=function(t){var e,i,n,s,o,l,u,a,r,h,d=this.align,p=this;return this.$container||(this.$container=$(this.getClosestScrollableElementContainer())),this.$popup.css({width:this.width,height:null!==this.height?this.height:"auto"}),"forwards"!==d&&"backwards"!==d||(d="rtl"===this.$container.css("direction")?{forwards:"force-left",backwards:"force-right"}[this.align]:{forwards:"force-right",backwards:"force-left"}[this.align]),e=this.width*{"force-left":-1,center:-.5,"force-right":0}[d],i=this.$element.offset().left,n=this.$container.offset().left,s=this.$container.innerWidth(),o=n+s,l=e-this.containerPadding,u=e+this.containerPadding+this.width+this.containerPadding,a=i+l-n,r=o-(i+u),r<0?e+=r:a<0&&(e-=a),h=2*this.$anchor[0].scrollWidth,e+this.width<h?e=h-this.width:-e<h&&(e=-h),clearTimeout(this.transitionTimeout),t&&this.$element.addClass("oo-ui-popupWidget-transitioning"),this.$popup.css("margin-left",e),t?this.transitionTimeout=setTimeout(function(){p.$element.removeClass("oo-ui-popupWidget-transitioning")},200):this.$element.removeClass("oo-ui-popupWidget-transitioning"),this.clip(),this},t.ui.PopupWidget.prototype.setAlignment=function(t){["left","right","force-left","force-right","backwards","forwards","center"].indexOf(t)>-1?this.align={left:"force-right",right:"force-left"}[t]||t:this.align="center"},t.ui.PopupWidget.prototype.getAlignment=function(){return this.align},t.ui.mixin.PopupElement=function(e){e=e||{},this.popup=new t.ui.PopupWidget($.extend({autoClose:!0},e.popup,{$autoCloseIgnore:this.$element}))},t.ui.mixin.PopupElement.prototype.getPopup=function(){return this.popup},t.ui.PopupButtonWidget=function(e){t.ui.PopupButtonWidget.parent.call(this,e),t.ui.mixin.PopupElement.call(this,e),this.connect(this,{click:"onAction"}),this.$element.addClass("oo-ui-popupButtonWidget").attr("aria-haspopup","true").append(this.popup.$element)},t.inheritClass(t.ui.PopupButtonWidget,t.ui.ButtonWidget),t.mixinClass(t.ui.PopupButtonWidget,t.ui.mixin.PopupElement),t.ui.PopupButtonWidget.prototype.onAction=function(){this.popup.toggle()},t.ui.mixin.GroupWidget=function(e){t.ui.mixin.GroupWidget.parent.call(this,e)},t.inheritClass(t.ui.mixin.GroupWidget,t.ui.mixin.GroupElement),t.ui.mixin.GroupWidget.prototype.setDisabled=function(e){var i,n;if(t.ui.Widget.prototype.setDisabled.call(this,e),this.items)for(i=0,n=this.items.length;i<n;i++)this.items[i].updateDisabled();return this},t.ui.mixin.ItemWidget=function(){},t.ui.mixin.ItemWidget.prototype.isDisabled=function(){return this.disabled||this.elementGroup instanceof t.ui.Widget&&this.elementGroup.isDisabled()},t.ui.mixin.ItemWidget.prototype.setElementGroup=function(e){return t.ui.Element.prototype.setElementGroup.call(this,e),this.updateDisabled(),this},t.ui.OptionWidget=function(e){e=e||{},t.ui.OptionWidget.parent.call(this,e),t.ui.mixin.ItemWidget.call(this),t.ui.mixin.LabelElement.call(this,e),t.ui.mixin.FlaggedElement.call(this,e),this.selected=!1,this.highlighted=!1,this.pressed=!1,this.$element.data("oo-ui-optionWidget",this).attr("role","option").attr("aria-selected","false").addClass("oo-ui-optionWidget").append(this.$label)},t.inheritClass(t.ui.OptionWidget,t.ui.Widget),t.mixinClass(t.ui.OptionWidget,t.ui.mixin.ItemWidget),t.mixinClass(t.ui.OptionWidget,t.ui.mixin.LabelElement),t.mixinClass(t.ui.OptionWidget,t.ui.mixin.FlaggedElement),t.ui.OptionWidget.static.selectable=!0,t.ui.OptionWidget.static.highlightable=!0,t.ui.OptionWidget.static.pressable=!0,t.ui.OptionWidget.static.scrollIntoViewOnSelect=!1,t.ui.OptionWidget.prototype.isSelectable=function(){return this.constructor.static.selectable&&!this.isDisabled()&&this.isVisible()},t.ui.OptionWidget.prototype.isHighlightable=function(){return this.constructor.static.highlightable&&!this.isDisabled()&&this.isVisible()},t.ui.OptionWidget.prototype.isPressable=function(){return this.constructor.static.pressable&&!this.isDisabled()&&this.isVisible()},t.ui.OptionWidget.prototype.isSelected=function(){return this.selected},t.ui.OptionWidget.prototype.isHighlighted=function(){return this.highlighted},t.ui.OptionWidget.prototype.isPressed=function(){return this.pressed},t.ui.OptionWidget.prototype.setSelected=function(t){return this.constructor.static.selectable&&(this.selected=!!t,this.$element.toggleClass("oo-ui-optionWidget-selected",t).attr("aria-selected",t.toString()),t&&this.constructor.static.scrollIntoViewOnSelect&&this.scrollElementIntoView(),this.updateThemeClasses()),this},t.ui.OptionWidget.prototype.setHighlighted=function(t){return this.constructor.static.highlightable&&(this.highlighted=!!t,this.$element.toggleClass("oo-ui-optionWidget-highlighted",t),this.updateThemeClasses()),this},t.ui.OptionWidget.prototype.setPressed=function(t){return this.constructor.static.pressable&&(this.pressed=!!t,this.$element.toggleClass("oo-ui-optionWidget-pressed",t),this.updateThemeClasses()),this},t.ui.SelectWidget=function(e){e=e||{},t.ui.SelectWidget.parent.call(this,e),t.ui.mixin.GroupWidget.call(this,$.extend({},e,{$group:this.$element})),this.pressed=!1,this.selecting=null,this.onMouseUpHandler=this.onMouseUp.bind(this),this.onMouseMoveHandler=this.onMouseMove.bind(this),this.onKeyDownHandler=this.onKeyDown.bind(this),this.onKeyPressHandler=this.onKeyPress.bind(this),this.keyPressBuffer="",this.keyPressBufferTimer=null,this.blockMouseOverEvents=0,this.connect(this,{toggle:"onToggle"}),this.$element.on({mousedown:this.onMouseDown.bind(this),mouseover:this.onMouseOver.bind(this),mouseleave:this.onMouseLeave.bind(this)}),this.$element.addClass("oo-ui-selectWidget oo-ui-selectWidget-depressed").attr("role","listbox"),Array.isArray(e.items)&&this.addItems(e.items)},t.inheritClass(t.ui.SelectWidget,t.ui.Widget),t.mixinClass(t.ui.SelectWidget,t.ui.mixin.GroupElement),t.mixinClass(t.ui.SelectWidget,t.ui.mixin.GroupWidget),t.ui.SelectWidget.static.passAllFilter=function(){return!0},t.ui.SelectWidget.prototype.onMouseDown=function(e){var i;return this.isDisabled()||e.which!==t.ui.MouseButtons.LEFT||(this.togglePressed(!0),i=this.getTargetItem(e),i&&i.isSelectable()&&(this.pressItem(i),this.selecting=i,this.getElementDocument().addEventListener("mouseup",this.onMouseUpHandler,!0),this.getElementDocument().addEventListener("mousemove",this.onMouseMoveHandler,!0))),!1},t.ui.SelectWidget.prototype.onMouseUp=function(e){var i;return this.togglePressed(!1),this.selecting||(i=this.getTargetItem(e),i&&i.isSelectable()&&(this.selecting=i)),!this.isDisabled()&&e.which===t.ui.MouseButtons.LEFT&&this.selecting&&(this.pressItem(null),this.chooseItem(this.selecting),this.selecting=null),this.getElementDocument().removeEventListener("mouseup",this.onMouseUpHandler,!0),this.getElementDocument().removeEventListener("mousemove",this.onMouseMoveHandler,!0),!1},t.ui.SelectWidget.prototype.onMouseMove=function(t){var e;!this.isDisabled()&&this.pressed&&(e=this.getTargetItem(t),e&&e!==this.selecting&&e.isSelectable()&&(this.pressItem(e),this.selecting=e))},t.ui.SelectWidget.prototype.onMouseOver=function(t){var e;if(!this.blockMouseOverEvents)return this.isDisabled()||(e=this.getTargetItem(t),this.highlightItem(e&&e.isHighlightable()?e:null)),!1},t.ui.SelectWidget.prototype.onMouseLeave=function(){return this.isDisabled()||this.highlightItem(null),!1},t.ui.SelectWidget.prototype.onKeyDown=function(e){var i,n=!1,s=this.getHighlightedItem()||this.getSelectedItem();if(!this.isDisabled()&&this.isVisible()){switch(e.keyCode){case t.ui.Keys.ENTER:s&&s.constructor.static.highlightable&&(this.chooseItem(s),n=!0);break;case t.ui.Keys.UP:case t.ui.Keys.LEFT:this.clearKeyPressBuffer(),i=this.getRelativeSelectableItem(s,-1),n=!0;break;case t.ui.Keys.DOWN:case t.ui.Keys.RIGHT:this.clearKeyPressBuffer(),i=this.getRelativeSelectableItem(s,1),n=!0;break;case t.ui.Keys.ESCAPE:case t.ui.Keys.TAB:s&&s.constructor.static.highlightable&&s.setHighlighted(!1),this.unbindKeyDownListener(),this.unbindKeyPressListener(),n=!1}i&&(i.constructor.static.highlightable?this.highlightItem(i):this.chooseItem(i),this.scrollItemIntoView(i)),n&&(e.preventDefault(),e.stopPropagation())}},t.ui.SelectWidget.prototype.bindKeyDownListener=function(){this.getElementWindow().addEventListener("keydown",this.onKeyDownHandler,!0)},t.ui.SelectWidget.prototype.unbindKeyDownListener=function(){this.getElementWindow().removeEventListener("keydown",this.onKeyDownHandler,!0)},t.ui.SelectWidget.prototype.scrollItemIntoView=function(t){var e=this;this.blockMouseOverEvents++,t.scrollElementIntoView().done(function(){setTimeout(function(){e.blockMouseOverEvents--},200)})},t.ui.SelectWidget.prototype.clearKeyPressBuffer=function(){this.keyPressBufferTimer&&(clearTimeout(this.keyPressBufferTimer),this.keyPressBufferTimer=null),this.keyPressBuffer=""},t.ui.SelectWidget.prototype.onKeyPress=function(e){var i,n,s;if(e.charCode)i=String.fromCodePoint?String.fromCodePoint(e.charCode):String.fromCharCode(e.charCode),this.keyPressBufferTimer&&clearTimeout(this.keyPressBufferTimer),this.keyPressBufferTimer=setTimeout(this.clearKeyPressBuffer.bind(this),1500),s=this.getHighlightedItem()||this.getSelectedItem(),this.keyPressBuffer===i?s&&(s=this.getRelativeSelectableItem(s,1)):this.keyPressBuffer+=i,n=this.getItemMatcher(this.keyPressBuffer,!1),s&&n(s)||(s=this.getRelativeSelectableItem(s,1,n)),s&&(s.constructor.static.highlightable?this.highlightItem(s):this.chooseItem(s),this.scrollItemIntoView(s)),e.preventDefault(),e.stopPropagation();else if(e.keyCode===t.ui.Keys.BACKSPACE&&""!==this.keyPressBuffer)return this.keyPressBuffer=this.keyPressBuffer.substr(0,this.keyPressBuffer.length-1),!1},t.ui.SelectWidget.prototype.getItemMatcher=function(t,e){var i;return t.normalize&&(t=t.normalize()),t=e?t.trim():t.replace(/^\s+/,""),i="^\\s*"+t.replace(/([\\{}()|.?*+\-\^$\[\]])/g,"\\$1").replace(/\s+/g,"\\s+"),e&&(i+="\\s*$"),i=new RegExp(i,"i"),function(t){var e=t.getLabel();return"string"!=typeof e&&(e=t.$label.text()),e.normalize&&(e=e.normalize()),i.test(e)}},t.ui.SelectWidget.prototype.bindKeyPressListener=function(){this.getElementWindow().addEventListener("keypress",this.onKeyPressHandler,!0)},t.ui.SelectWidget.prototype.unbindKeyPressListener=function(){this.getElementWindow().removeEventListener("keypress",this.onKeyPressHandler,!0),this.clearKeyPressBuffer()},t.ui.SelectWidget.prototype.onToggle=function(t){t||this.clearKeyPressBuffer()},t.ui.SelectWidget.prototype.getTargetItem=function(t){return $(t.target).closest(".oo-ui-optionWidget").data("oo-ui-optionWidget")||null},t.ui.SelectWidget.prototype.getSelectedItem=function(){var t,e;for(t=0,e=this.items.length;t<e;t++)if(this.items[t].isSelected())return this.items[t];return null},t.ui.SelectWidget.prototype.getHighlightedItem=function(){var t,e;for(t=0,e=this.items.length;t<e;t++)if(this.items[t].isHighlighted())return this.items[t];return null},t.ui.SelectWidget.prototype.togglePressed=function(t){void 0===t&&(t=!this.pressed),t!==this.pressed&&(this.$element.toggleClass("oo-ui-selectWidget-pressed",t).toggleClass("oo-ui-selectWidget-depressed",!t),this.pressed=t)},t.ui.SelectWidget.prototype.highlightItem=function(t){var e,i,n,s=!1;for(e=0,i=this.items.length;e<i;e++)n=this.items[e]===t,this.items[e].isHighlighted()!==n&&(this.items[e].setHighlighted(n),s=!0);return s&&this.emit("highlight",t),this},t.ui.SelectWidget.prototype.getItemFromLabel=function(e,i){var n,s,o,l=this.items.length,u=this.getItemMatcher(e,!0);for(n=0;n<l;n++)if(s=this.items[n],s instanceof t.ui.OptionWidget&&s.isSelectable()&&u(s))return s;if(i){for(o=null,u=this.getItemMatcher(e,!1),n=0;n<l;n++)if(s=this.items[n],s instanceof t.ui.OptionWidget&&s.isSelectable()&&u(s)){if(o)return null;o=s}if(o)return o}return null},t.ui.SelectWidget.prototype.selectItemByLabel=function(t,e){var i=this.getItemFromLabel(t,!!e);return void 0!==t&&i?this.selectItem(i):this.selectItem()},t.ui.SelectWidget.prototype.selectItemByData=function(t){var e=this.getItemFromData(t);return void 0!==t&&e?this.selectItem(e):this.selectItem()},t.ui.SelectWidget.prototype.selectItem=function(t){var e,i,n,s=!1;for(e=0,i=this.items.length;e<i;e++)n=this.items[e]===t,this.items[e].isSelected()!==n&&(this.items[e].setSelected(n),s=!0);return s&&this.emit("select",t),this},t.ui.SelectWidget.prototype.pressItem=function(t){var e,i,n,s=!1;for(e=0,i=this.items.length;e<i;e++)n=this.items[e]===t,this.items[e].isPressed()!==n&&(this.items[e].setPressed(n),s=!0);return s&&this.emit("press",t),this},t.ui.SelectWidget.prototype.chooseItem=function(t){return t&&(this.selectItem(t),this.emit("choose",t)),this},t.ui.SelectWidget.prototype.getRelativeSelectableItem=function(e,i,n){var s,o,l,u=i>0?1:-1,a=this.items.length;for($.isFunction(n)||(n=t.ui.SelectWidget.static.passAllFilter),e instanceof t.ui.OptionWidget?(s=this.items.indexOf(e),o=(s+u+a)%a):o=i>0?0:a-1,l=0;l<a;l++){if(e=this.items[o],e instanceof t.ui.OptionWidget&&e.isSelectable()&&n(e))return e;o=(o+u+a)%a}return null},t.ui.SelectWidget.prototype.getFirstSelectableItem=function(){var e,i,n;for(e=0,i=this.items.length;e<i;e++)if(n=this.items[e],n instanceof t.ui.OptionWidget&&n.isSelectable())return n;return null},t.ui.SelectWidget.prototype.addItems=function(e,i){return t.ui.mixin.GroupWidget.prototype.addItems.call(this,e,i),this.emit("add",e,void 0===i?this.items.length-e.length-1:i),this},t.ui.SelectWidget.prototype.removeItems=function(e){var i,n,s;for(i=0,n=e.length;i<n;i++)s=e[i],s.isSelected()&&this.selectItem(null);return t.ui.mixin.GroupWidget.prototype.removeItems.call(this,e),this.emit("remove",e),this},t.ui.SelectWidget.prototype.clearItems=function(){var e=this.items.slice();return t.ui.mixin.GroupWidget.prototype.clearItems.call(this),this.selectItem(null),this.emit("remove",e),this},t.ui.DecoratedOptionWidget=function(e){t.ui.DecoratedOptionWidget.parent.call(this,e),t.ui.mixin.IconElement.call(this,e),t.ui.mixin.IndicatorElement.call(this,e),this.$element.addClass("oo-ui-decoratedOptionWidget").prepend(this.$icon).append(this.$indicator)},t.inheritClass(t.ui.DecoratedOptionWidget,t.ui.OptionWidget),t.mixinClass(t.ui.DecoratedOptionWidget,t.ui.mixin.IconElement),t.mixinClass(t.ui.DecoratedOptionWidget,t.ui.mixin.IndicatorElement),t.ui.MenuOptionWidget=function(e){e=$.extend({icon:"check"},e),t.ui.MenuOptionWidget.parent.call(this,e),this.$element.attr("role","menuitem").addClass("oo-ui-menuOptionWidget")},t.inheritClass(t.ui.MenuOptionWidget,t.ui.DecoratedOptionWidget),t.ui.MenuOptionWidget.static.scrollIntoViewOnSelect=!0,t.ui.MenuSectionOptionWidget=function(e){t.ui.MenuSectionOptionWidget.parent.call(this,e),this.$element.addClass("oo-ui-menuSectionOptionWidget")},t.inheritClass(t.ui.MenuSectionOptionWidget,t.ui.DecoratedOptionWidget),t.ui.MenuSectionOptionWidget.static.selectable=!1,t.ui.MenuSectionOptionWidget.static.highlightable=!1,t.ui.MenuSelectWidget=function(e){e=e||{},t.ui.MenuSelectWidget.parent.call(this,e),t.ui.mixin.ClippableElement.call(this,$.extend({},e,{$clippable:this.$group})),this.newItems=null,this.autoHide=void 0===e.autoHide||!!e.autoHide,this.filterFromInput=!!e.filterFromInput,this.$input=e.$input?e.$input:e.input?e.input.$input:null,this.$widget=e.widget?e.widget.$element:null,this.onDocumentMouseDownHandler=this.onDocumentMouseDown.bind(this),this.onInputEditHandler=t.ui.debounce(this.updateItemVisibility.bind(this),100),this.$element.addClass("oo-ui-menuSelectWidget").attr("role","menu"),this.visible=!1,this.$element.addClass("oo-ui-element-hidden")},t.inheritClass(t.ui.MenuSelectWidget,t.ui.SelectWidget),t.mixinClass(t.ui.MenuSelectWidget,t.ui.mixin.ClippableElement),t.ui.MenuSelectWidget.prototype.onDocumentMouseDown=function(e){t.ui.contains(this.$element[0],e.target,!0)||this.$widget&&t.ui.contains(this.$widget[0],e.target,!0)||this.toggle(!1)},t.ui.MenuSelectWidget.prototype.onKeyDown=function(e){var i=this.getHighlightedItem()||this.getSelectedItem();if(!this.isDisabled()&&this.isVisible())switch(e.keyCode){case t.ui.Keys.LEFT:case t.ui.Keys.RIGHT:this.$input||t.ui.MenuSelectWidget.parent.prototype.onKeyDown.call(this,e);break;case t.ui.Keys.ESCAPE:case t.ui.Keys.TAB:i&&i.setHighlighted(!1),this.toggle(!1),e.keyCode===t.ui.Keys.ESCAPE&&(e.preventDefault(),e.stopPropagation());break;default:return void t.ui.MenuSelectWidget.parent.prototype.onKeyDown.call(this,e)}},t.ui.MenuSelectWidget.prototype.updateItemVisibility=function(){var e,i,n=this.items.length,s=!this.isVisible(),o=s?null:this.getItemMatcher(this.$input.val());for(e=0;e<n;e++)i=this.items[e],i instanceof t.ui.OptionWidget&&i.toggle(s||o(i));this.clip()},t.ui.MenuSelectWidget.prototype.bindKeyDownListener=function(){this.$input?this.$input.on("keydown",this.onKeyDownHandler):t.ui.MenuSelectWidget.parent.prototype.bindKeyDownListener.call(this)},t.ui.MenuSelectWidget.prototype.unbindKeyDownListener=function(){this.$input?this.$input.off("keydown",this.onKeyDownHandler):t.ui.MenuSelectWidget.parent.prototype.unbindKeyDownListener.call(this)},t.ui.MenuSelectWidget.prototype.bindKeyPressListener=function(){this.$input?this.filterFromInput&&this.$input.on("keydown mouseup cut paste change input select",this.onInputEditHandler):t.ui.MenuSelectWidget.parent.prototype.bindKeyPressListener.call(this)},t.ui.MenuSelectWidget.prototype.unbindKeyPressListener=function(){this.$input?this.filterFromInput&&(this.$input.off("keydown mouseup cut paste change input select",this.onInputEditHandler),this.updateItemVisibility()):t.ui.MenuSelectWidget.parent.prototype.unbindKeyPressListener.call(this)},t.ui.MenuSelectWidget.prototype.chooseItem=function(e){return t.ui.MenuSelectWidget.parent.prototype.chooseItem.call(this,e),this.toggle(!1),this},t.ui.MenuSelectWidget.prototype.addItems=function(e,i){var n,s,o;for(t.ui.MenuSelectWidget.parent.prototype.addItems.call(this,e,i),this.newItems||(this.newItems=[]),n=0,s=e.length;n<s;n++)o=e[n],this.isVisible()?o.fitLabel():this.newItems.push(o);return this.clip(),this},t.ui.MenuSelectWidget.prototype.removeItems=function(e){return t.ui.MenuSelectWidget.parent.prototype.removeItems.call(this,e),this.clip(),this},t.ui.MenuSelectWidget.prototype.clearItems=function(){return t.ui.MenuSelectWidget.parent.prototype.clearItems.call(this),this.clip(),this},t.ui.MenuSelectWidget.prototype.toggle=function(e){var i,n,s;if(e=(void 0===e?!this.visible:!!e)&&!!this.items.length,s=e!==this.isVisible(),t.ui.MenuSelectWidget.parent.prototype.toggle.call(this,e),s)if(e){if(this.bindKeyDownListener(),this.bindKeyPressListener(),this.newItems&&this.newItems.length){for(i=0,n=this.newItems.length;i<n;i++)this.newItems[i].fitLabel();this.newItems=null}this.toggleClipping(!0),this.getSelectedItem()&&this.getSelectedItem().scrollElementIntoView({duration:0}),this.autoHide&&this.getElementDocument().addEventListener("mousedown",this.onDocumentMouseDownHandler,!0)}else this.unbindKeyDownListener(),this.unbindKeyPressListener(),this.getElementDocument().removeEventListener("mousedown",this.onDocumentMouseDownHandler,!0),this.toggleClipping(!1);return this},t.ui.DropdownWidget=function(e){e=$.extend({indicator:"down"},e),t.ui.DropdownWidget.parent.call(this,e),this.$handle=this.$("<span>"),this.$overlay=e.$overlay||this.$element,t.ui.mixin.IconElement.call(this,e),t.ui.mixin.IndicatorElement.call(this,e),t.ui.mixin.LabelElement.call(this,e),t.ui.mixin.TitledElement.call(this,$.extend({},e,{$titled:this.$label})),t.ui.mixin.TabIndexedElement.call(this,$.extend({},e,{$tabIndexed:this.$handle})),this.menu=new t.ui.FloatingMenuSelectWidget($.extend({widget:this,$container:this.$element},e.menu)),this.$handle.on({click:this.onClick.bind(this),keydown:this.onKeyDown.bind(this)}),this.menu.connect(this,{select:"onMenuSelect"}),this.$handle.addClass("oo-ui-dropdownWidget-handle").append(this.$icon,this.$label,this.$indicator),this.$element.addClass("oo-ui-dropdownWidget").append(this.$handle),this.$overlay.append(this.menu.$element)},t.inheritClass(t.ui.DropdownWidget,t.ui.Widget),t.mixinClass(t.ui.DropdownWidget,t.ui.mixin.IconElement),t.mixinClass(t.ui.DropdownWidget,t.ui.mixin.IndicatorElement),t.mixinClass(t.ui.DropdownWidget,t.ui.mixin.LabelElement),t.mixinClass(t.ui.DropdownWidget,t.ui.mixin.TitledElement),t.mixinClass(t.ui.DropdownWidget,t.ui.mixin.TabIndexedElement),t.ui.DropdownWidget.prototype.getMenu=function(){return this.menu},t.ui.DropdownWidget.prototype.onMenuSelect=function(t){var e;return t?(e=t.getLabel(),e instanceof jQuery&&(e=e.clone()),void this.setLabel(e)):void this.setLabel(null)},t.ui.DropdownWidget.prototype.onClick=function(e){return this.isDisabled()||e.which!==t.ui.MouseButtons.LEFT||this.menu.toggle(),!1},t.ui.DropdownWidget.prototype.onKeyDown=function(e){if(!(this.isDisabled()||e.which!==t.ui.Keys.ENTER&&(this.menu.isVisible()||e.which!==t.ui.Keys.SPACE&&e.which!==t.ui.Keys.UP&&e.which!==t.ui.Keys.DOWN)))return this.menu.toggle(),!1},t.ui.RadioOptionWidget=function(e){e=e||{},this.radio=new t.ui.RadioInputWidget({value:e.data,tabIndex:-1}),t.ui.RadioOptionWidget.parent.call(this,e),this.radio.$input.on("focus",this.onInputFocus.bind(this)),this.radio.$input.attr("role","presentation"),this.$element.addClass("oo-ui-radioOptionWidget").attr("role","radio").attr("aria-checked","false").removeAttr("aria-selected").prepend(this.radio.$element)},t.inheritClass(t.ui.RadioOptionWidget,t.ui.OptionWidget),t.ui.RadioOptionWidget.static.highlightable=!1,t.ui.RadioOptionWidget.static.scrollIntoViewOnSelect=!0,t.ui.RadioOptionWidget.static.pressable=!1,t.ui.RadioOptionWidget.static.tagName="label",t.ui.RadioOptionWidget.prototype.onInputFocus=function(){this.radio.$input.blur(),this.$element.parent().focus()},t.ui.RadioOptionWidget.prototype.setSelected=function(e){return t.ui.RadioOptionWidget.parent.prototype.setSelected.call(this,e),this.radio.setSelected(e),this.$element.attr("aria-checked",e.toString()).removeAttr("aria-selected"),this},t.ui.RadioOptionWidget.prototype.setDisabled=function(e){return t.ui.RadioOptionWidget.parent.prototype.setDisabled.call(this,e),this.radio.setDisabled(this.isDisabled()),this},t.ui.RadioSelectWidget=function(e){t.ui.RadioSelectWidget.parent.call(this,e),t.ui.mixin.TabIndexedElement.call(this,e),this.$element.on({focus:this.bindKeyDownListener.bind(this),blur:this.unbindKeyDownListener.bind(this)}),this.$element.addClass("oo-ui-radioSelectWidget").attr("role","radiogroup")},t.inheritClass(t.ui.RadioSelectWidget,t.ui.SelectWidget),t.mixinClass(t.ui.RadioSelectWidget,t.ui.mixin.TabIndexedElement),t.ui.mixin.FloatableElement=function(t){t=t||{},this.$floatable=null,this.$floatableContainer=null,this.$floatableWindow=null,this.$floatableClosestScrollable=null,this.onFloatableScrollHandler=this.position.bind(this),this.onFloatableWindowResizeHandler=this.position.bind(this),this.setFloatableContainer(t.$floatableContainer),this.setFloatableElement(t.$floatable||this.$element)},t.ui.mixin.FloatableElement.prototype.setFloatableElement=function(t){this.$floatable&&(this.$floatable.removeClass("oo-ui-floatableElement-floatable"),this.$floatable.css({left:"",top:""})),this.$floatable=t.addClass("oo-ui-floatableElement-floatable"),this.position()},t.ui.mixin.FloatableElement.prototype.setFloatableContainer=function(t){this.$floatableContainer=t,this.$floatable&&this.position()},t.ui.mixin.FloatableElement.prototype.togglePositioning=function(e){var i,n;return e=void 0===e?!this.positioning:!!e,this.positioning!==e&&(this.positioning=e,i=t.ui.Element.static.getClosestScrollableContainer(this.$floatableContainer[0]),n=t.ui.Element.static.getClosestScrollableContainer(this.$floatable[0]),i!==n&&$(i).is("html, body")&&(i=t.ui.Element.static.getWindow(i)),e?(this.$floatableWindow=$(this.getElementWindow()),this.$floatableWindow.on("resize",this.onFloatableWindowResizeHandler),i!==n&&(this.$floatableClosestScrollable=$(i),this.$floatableClosestScrollable.on("scroll",this.onFloatableScrollHandler)),this.position()):(this.$floatableWindow&&(this.$floatableWindow.off("resize",this.onFloatableWindowResizeHandler),this.$floatableWindow=null),this.$floatableClosestScrollable&&(this.$floatableClosestScrollable.off("scroll",this.onFloatableScrollHandler),this.$floatableClosestScrollable=null),this.$floatable.css({left:"",top:""}))),this},t.ui.mixin.FloatableElement.prototype.position=function(){var e;return this.positioning?(e=t.ui.Element.static.getRelativePosition(this.$floatableContainer,this.$floatable.offsetParent()),e.top+=this.$floatableContainer.height(),this.$floatable.css(e),this.clip&&this.clip(),this):this},t.ui.FloatingMenuSelectWidget=function(e,i){t.isPlainObject(e)&&void 0===i&&(i=e,e=i.inputWidget),i=i||{},t.ui.FloatingMenuSelectWidget.parent.call(this,i),this.inputWidget=e,this.$container=i.$container||this.inputWidget.$element,t.ui.mixin.FloatableElement.call(this,$.extend({},i,{$floatableContainer:this.$container})),this.$element.addClass("oo-ui-floatingMenuSelectWidget"),this.$element.addClass("oo-ui-textInputMenuSelectWidget")},t.inheritClass(t.ui.FloatingMenuSelectWidget,t.ui.MenuSelectWidget),t.mixinClass(t.ui.FloatingMenuSelectWidget,t.ui.mixin.FloatableElement),t.ui.TextInputMenuSelectWidget=t.ui.FloatingMenuSelectWidget,t.ui.FloatingMenuSelectWidget.prototype.toggle=function(e){var i;return e=void 0===e?!this.isVisible():!!e,i=e!==this.isVisible(),i&&e&&this.setIdealSize(this.$container.width()),t.ui.FloatingMenuSelectWidget.parent.prototype.toggle.call(this,e),i&&this.togglePositioning(this.isVisible()),this},t.ui.InputWidget=function(e){e=e||{},t.ui.InputWidget.parent.call(this,e),this.$input=this.getInputElement(e),this.value="",this.inputFilter=e.inputFilter,t.ui.mixin.FlaggedElement.call(this,e),t.ui.mixin.TabIndexedElement.call(this,$.extend({},e,{$tabIndexed:this.$input})),t.ui.mixin.TitledElement.call(this,$.extend({},e,{$titled:this.$input})),t.ui.mixin.AccessKeyedElement.call(this,$.extend({},e,{
$accessKeyed:this.$input})),this.$input.on("keydown mouseup cut paste change input select",this.onEdit.bind(this)),this.$input.addClass("oo-ui-inputWidget-input").attr("name",e.name).prop("disabled",this.isDisabled()),this.$element.addClass("oo-ui-inputWidget").append(this.$input),this.setValue(e.value),e.dir&&this.setDir(e.dir)},t.inheritClass(t.ui.InputWidget,t.ui.Widget),t.mixinClass(t.ui.InputWidget,t.ui.mixin.FlaggedElement),t.mixinClass(t.ui.InputWidget,t.ui.mixin.TabIndexedElement),t.mixinClass(t.ui.InputWidget,t.ui.mixin.TitledElement),t.mixinClass(t.ui.InputWidget,t.ui.mixin.AccessKeyedElement),t.ui.InputWidget.static.supportsSimpleLabel=!0,t.ui.InputWidget.static.reusePreInfuseDOM=function(e,i){return i=t.ui.InputWidget.parent.static.reusePreInfuseDOM(e,i),i.$input=$(e).find(".oo-ui-inputWidget-input"),i},t.ui.InputWidget.static.gatherPreInfuseState=function(e,i){var n=t.ui.InputWidget.parent.static.gatherPreInfuseState(e,i);return n.value=i.$input.val(),n.focus=i.$input.is(":focus"),n},t.ui.InputWidget.prototype.getInputElement=function(t){return t.$input||$("<input>")},t.ui.InputWidget.prototype.onEdit=function(){var t=this;this.isDisabled()||setTimeout(function(){t.setValue(t.$input.val())})},t.ui.InputWidget.prototype.getValue=function(){var t=this.$input.val();return this.value!==t&&this.setValue(t),this.value},t.ui.InputWidget.prototype.setRTL=function(t){return this.setDir(t?"rtl":"ltr"),this},t.ui.InputWidget.prototype.setDir=function(t){return this.$input.prop("dir",t),this},t.ui.InputWidget.prototype.setValue=function(t){return t=this.cleanUpValue(t),this.$input.val()!==t&&this.$input.val(t),this.value!==t&&(this.value=t,this.emit("change",this.value)),this},t.ui.InputWidget.prototype.cleanUpValue=function(t){return void 0===t||null===t?"":this.inputFilter?this.inputFilter(String(t)):String(t)},t.ui.InputWidget.prototype.simulateLabelClick=function(){this.isDisabled()||(this.$input.is(":checkbox, :radio")&&this.$input.click(),this.$input.is(":input")&&this.$input[0].focus())},t.ui.InputWidget.prototype.setDisabled=function(e){return t.ui.InputWidget.parent.prototype.setDisabled.call(this,e),this.$input&&this.$input.prop("disabled",this.isDisabled()),this},t.ui.InputWidget.prototype.focus=function(){return this.$input[0].focus(),this},t.ui.InputWidget.prototype.blur=function(){return this.$input[0].blur(),this},t.ui.InputWidget.prototype.restorePreInfuseState=function(e){t.ui.InputWidget.parent.prototype.restorePreInfuseState.call(this,e),void 0!==e.value&&e.value!==this.getValue()&&this.setValue(e.value),e.focus&&this.focus()},t.ui.ButtonInputWidget=function(e){e=$.extend({type:"button",useInputTag:!1},e),this.useInputTag=e.useInputTag,t.ui.ButtonInputWidget.parent.call(this,e),t.ui.mixin.ButtonElement.call(this,$.extend({},e,{$button:this.$input})),t.ui.mixin.IconElement.call(this,e),t.ui.mixin.IndicatorElement.call(this,e),t.ui.mixin.LabelElement.call(this,e),t.ui.mixin.TitledElement.call(this,$.extend({},e,{$titled:this.$input})),e.useInputTag||this.$input.append(this.$icon,this.$label,this.$indicator),this.$element.addClass("oo-ui-buttonInputWidget")},t.inheritClass(t.ui.ButtonInputWidget,t.ui.InputWidget),t.mixinClass(t.ui.ButtonInputWidget,t.ui.mixin.ButtonElement),t.mixinClass(t.ui.ButtonInputWidget,t.ui.mixin.IconElement),t.mixinClass(t.ui.ButtonInputWidget,t.ui.mixin.IndicatorElement),t.mixinClass(t.ui.ButtonInputWidget,t.ui.mixin.LabelElement),t.mixinClass(t.ui.ButtonInputWidget,t.ui.mixin.TitledElement),t.ui.ButtonInputWidget.static.supportsSimpleLabel=!1,t.ui.ButtonInputWidget.prototype.getInputElement=function(t){var e;return t.$input?t.$input.empty():(e=["button","submit","reset"].indexOf(t.type)!==-1?t.type:"button",$("<"+(t.useInputTag?"input":"button")+' type="'+e+'">'))},t.ui.ButtonInputWidget.prototype.setLabel=function(e){return t.ui.mixin.LabelElement.prototype.setLabel.call(this,e),this.useInputTag&&("function"==typeof e&&(e=t.ui.resolveMsg(e)),e instanceof jQuery&&(e=e.text()),e||(e=""),this.$input.val(e)),this},t.ui.ButtonInputWidget.prototype.setValue=function(e){return this.useInputTag||t.ui.ButtonInputWidget.parent.prototype.setValue.call(this,e),this},t.ui.CheckboxInputWidget=function(e){e=e||{},t.ui.CheckboxInputWidget.parent.call(this,e),this.$element.addClass("oo-ui-checkboxInputWidget").append($("<span>")),this.setSelected(void 0!==e.selected&&e.selected)},t.inheritClass(t.ui.CheckboxInputWidget,t.ui.InputWidget),t.ui.CheckboxInputWidget.static.gatherPreInfuseState=function(e,i){var n=t.ui.CheckboxInputWidget.parent.static.gatherPreInfuseState(e,i);return n.checked=i.$input.prop("checked"),n},t.ui.CheckboxInputWidget.prototype.getInputElement=function(){return $('<input type="checkbox" />')},t.ui.CheckboxInputWidget.prototype.onEdit=function(){var t=this;this.isDisabled()||setTimeout(function(){t.setSelected(t.$input.prop("checked"))})},t.ui.CheckboxInputWidget.prototype.setSelected=function(t){return t=!!t,this.selected!==t&&(this.selected=t,this.$input.prop("checked",this.selected),this.emit("change",this.selected)),this},t.ui.CheckboxInputWidget.prototype.isSelected=function(){var t=this.$input.prop("checked");return this.selected!==t&&this.setSelected(t),this.selected},t.ui.CheckboxInputWidget.prototype.restorePreInfuseState=function(e){t.ui.CheckboxInputWidget.parent.prototype.restorePreInfuseState.call(this,e),void 0!==e.checked&&e.checked!==this.isSelected()&&this.setSelected(e.checked)},t.ui.DropdownInputWidget=function(e){e=e||{},this.dropdownWidget=new t.ui.DropdownWidget(e.dropdown),t.ui.DropdownInputWidget.parent.call(this,e),t.ui.mixin.TitledElement.call(this,e),this.dropdownWidget.getMenu().connect(this,{select:"onMenuSelect"}),this.setOptions(e.options||[]),this.$element.addClass("oo-ui-dropdownInputWidget").append(this.dropdownWidget.$element)},t.inheritClass(t.ui.DropdownInputWidget,t.ui.InputWidget),t.mixinClass(t.ui.DropdownInputWidget,t.ui.mixin.TitledElement),t.ui.DropdownInputWidget.prototype.getInputElement=function(t){return t.$input?t.$input.addClass("oo-ui-element-hidden"):$('<input type="hidden">')},t.ui.DropdownInputWidget.prototype.onMenuSelect=function(t){this.setValue(t.getData())},t.ui.DropdownInputWidget.prototype.setValue=function(e){return e=this.cleanUpValue(e),this.dropdownWidget.getMenu().selectItemByData(e),t.ui.DropdownInputWidget.parent.prototype.setValue.call(this,e),this},t.ui.DropdownInputWidget.prototype.setDisabled=function(e){return this.dropdownWidget.setDisabled(e),t.ui.DropdownInputWidget.parent.prototype.setDisabled.call(this,e),this},t.ui.DropdownInputWidget.prototype.setOptions=function(e){var i=this.getValue(),n=this;return this.dropdownWidget.getMenu().clearItems().addItems(e.map(function(e){var i=n.cleanUpValue(e.data);return new t.ui.MenuOptionWidget({data:i,label:void 0!==e.label?e.label:i})})),this.dropdownWidget.getMenu().getItemFromData(i)?this.setValue(i):e.length&&this.setValue(e[0].data),this},t.ui.DropdownInputWidget.prototype.focus=function(){return this.dropdownWidget.getMenu().toggle(!0),this},t.ui.DropdownInputWidget.prototype.blur=function(){return this.dropdownWidget.getMenu().toggle(!1),this},t.ui.RadioInputWidget=function(e){e=e||{},t.ui.RadioInputWidget.parent.call(this,e),this.$element.addClass("oo-ui-radioInputWidget").append($("<span>")),this.setSelected(void 0!==e.selected&&e.selected)},t.inheritClass(t.ui.RadioInputWidget,t.ui.InputWidget),t.ui.RadioInputWidget.static.gatherPreInfuseState=function(e,i){var n=t.ui.RadioInputWidget.parent.static.gatherPreInfuseState(e,i);return n.checked=i.$input.prop("checked"),n},t.ui.RadioInputWidget.prototype.getInputElement=function(){return $('<input type="radio" />')},t.ui.RadioInputWidget.prototype.onEdit=function(){};t.ui.RadioInputWidget.prototype.setSelected=function(t){return this.$input.prop("checked",t),this};t.ui.RadioInputWidget.prototype.isSelected=function(){return this.$input.prop("checked")},t.ui.RadioInputWidget.prototype.restorePreInfuseState=function(e){t.ui.RadioInputWidget.parent.prototype.restorePreInfuseState.call(this,e),void 0!==e.checked&&e.checked!==this.isSelected()&&this.setSelected(e.checked)},t.ui.RadioSelectInputWidget=function(e){e=e||{},this.radioSelectWidget=new t.ui.RadioSelectWidget,t.ui.RadioSelectInputWidget.parent.call(this,e),this.radioSelectWidget.connect(this,{select:"onMenuSelect"}),this.setOptions(e.options||[]),this.$element.addClass("oo-ui-radioSelectInputWidget").append(this.radioSelectWidget.$element)},t.inheritClass(t.ui.RadioSelectInputWidget,t.ui.InputWidget),t.ui.RadioSelectInputWidget.static.supportsSimpleLabel=!1,t.ui.RadioSelectInputWidget.static.gatherPreInfuseState=function(e,i){var n=t.ui.RadioSelectInputWidget.parent.static.gatherPreInfuseState(e,i);return n.value=$(e).find(".oo-ui-radioInputWidget .oo-ui-inputWidget-input:checked").val(),n},t.ui.RadioSelectInputWidget.prototype.getInputElement=function(){return $('<input type="hidden">')},t.ui.RadioSelectInputWidget.prototype.onMenuSelect=function(t){this.setValue(t.getData())},t.ui.RadioSelectInputWidget.prototype.setValue=function(e){return e=this.cleanUpValue(e),this.radioSelectWidget.selectItemByData(e),t.ui.RadioSelectInputWidget.parent.prototype.setValue.call(this,e),this},t.ui.RadioSelectInputWidget.prototype.setDisabled=function(e){return this.radioSelectWidget.setDisabled(e),t.ui.RadioSelectInputWidget.parent.prototype.setDisabled.call(this,e),this},t.ui.RadioSelectInputWidget.prototype.setOptions=function(e){var i=this.getValue(),n=this;return this.radioSelectWidget.clearItems().addItems(e.map(function(e){var i=n.cleanUpValue(e.data);return new t.ui.RadioOptionWidget({data:i,label:void 0!==e.label?e.label:i})})),this.radioSelectWidget.getItemFromData(i)?this.setValue(i):e.length&&this.setValue(e[0].data),this},t.ui.TextInputWidget=function(e){e=$.extend({type:"text",labelPosition:"after"},e),"search"===e.type&&void 0===e.icon&&(e.icon="search"),e.required&&void 0===e.indicator&&(e.indicator="required"),t.ui.TextInputWidget.parent.call(this,e),t.ui.mixin.IconElement.call(this,e),t.ui.mixin.IndicatorElement.call(this,e),t.ui.mixin.PendingElement.call(this,$.extend({},e,{$pending:this.$input})),t.ui.mixin.LabelElement.call(this,e),this.type=this.getSaneType(e),this.readOnly=!1,this.multiline=!!e.multiline,this.autosize=!!e.autosize,this.minRows=void 0!==e.rows?e.rows:"",this.maxRows=e.maxRows||Math.max(2*(this.minRows||0),10),this.validate=null,this.styleHeight=null,this.scrollWidth=null,this.autosize&&(this.$clone=this.$input.clone().insertAfter(this.$input).attr("aria-hidden","true").addClass("oo-ui-element-hidden")),this.setValidation(e.validate),this.setLabelPosition(e.labelPosition),this.$input.on({keypress:this.onKeyPress.bind(this),blur:this.onBlur.bind(this)}),this.$input.one({focus:this.onElementAttach.bind(this)}),this.$icon.on("mousedown",this.onIconMouseDown.bind(this)),this.$indicator.on("mousedown",this.onIndicatorMouseDown.bind(this)),this.on("labelChange",this.updatePosition.bind(this)),this.connect(this,{change:"onChange",disable:"onDisable"}),this.$element.addClass("oo-ui-textInputWidget oo-ui-textInputWidget-type-"+this.type).append(this.$icon,this.$indicator),this.setReadOnly(!!e.readOnly),this.updateSearchIndicator(),e.placeholder&&this.$input.attr("placeholder",e.placeholder),void 0!==e.maxLength&&this.$input.attr("maxlength",e.maxLength),e.autofocus&&this.$input.attr("autofocus","autofocus"),e.required&&(this.$input.attr("required","required"),this.$input.attr("aria-required","true")),e.autocomplete===!1&&(this.$input.attr("autocomplete","off"),$(window).on({beforeunload:function(){this.$input.removeAttr("autocomplete")}.bind(this),pageshow:function(){this.$input.attr("autocomplete","off")}.bind(this)})),this.multiline&&e.rows&&this.$input.attr("rows",e.rows),(this.label||e.autosize)&&this.installParentChangeDetector()},t.inheritClass(t.ui.TextInputWidget,t.ui.InputWidget),t.mixinClass(t.ui.TextInputWidget,t.ui.mixin.IconElement),t.mixinClass(t.ui.TextInputWidget,t.ui.mixin.IndicatorElement),t.mixinClass(t.ui.TextInputWidget,t.ui.mixin.PendingElement),t.mixinClass(t.ui.TextInputWidget,t.ui.mixin.LabelElement),t.ui.TextInputWidget.static.validationPatterns={"non-empty":/.+/,integer:/^\d+$/},t.ui.TextInputWidget.static.gatherPreInfuseState=function(e,i){var n=t.ui.TextInputWidget.parent.static.gatherPreInfuseState(e,i);return i.multiline&&(n.scrollTop=i.$input.scrollTop()),n},t.ui.TextInputWidget.prototype.onIconMouseDown=function(e){if(e.which===t.ui.MouseButtons.LEFT)return this.$input[0].focus(),!1},t.ui.TextInputWidget.prototype.onIndicatorMouseDown=function(e){if(e.which===t.ui.MouseButtons.LEFT)return"search"===this.type&&this.setValue(""),this.$input[0].focus(),!1},t.ui.TextInputWidget.prototype.onKeyPress=function(e){e.which!==t.ui.Keys.ENTER||this.multiline||this.emit("enter",e)},t.ui.TextInputWidget.prototype.onBlur=function(){this.setValidityFlag()},t.ui.TextInputWidget.prototype.onElementAttach=function(){this.valCache=null,this.adjustSize(),this.positionLabel()},t.ui.TextInputWidget.prototype.onChange=function(){this.updateSearchIndicator(),this.setValidityFlag(),this.adjustSize()},t.ui.TextInputWidget.prototype.onDisable=function(){this.updateSearchIndicator()},t.ui.TextInputWidget.prototype.isReadOnly=function(){return this.readOnly},t.ui.TextInputWidget.prototype.setReadOnly=function(t){return this.readOnly=!!t,this.$input.prop("readOnly",this.readOnly),this.updateSearchIndicator(),this},t.ui.TextInputWidget.prototype.installParentChangeDetector=function(){var t,e,i,n,s=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,o=this;if(s){if(this.$element.closest("html").length)return;for(i=this.$element[0];i.parentNode;)i=i.parentNode;t=new s(function(t){var n,s,o;for(n=0;n<t.length;n++)for(o=t[n].removedNodes,s=0;s<o.length;s++)if(o[s]===i)return void setTimeout(e,0)}),e=function(){o.$element.closest("html").length&&o.onElementAttach(),t.disconnect(),o.installParentChangeDetector()},n=$("<div>").append(i)[0],t.observe(n,{childList:!0})}else this.$element.on("DOMNodeInsertedIntoDocument",this.onElementAttach.bind(this))},t.ui.TextInputWidget.prototype.adjustSize=function(){var t,e,i,n,s,o,l,u,a;return this.multiline&&this.$input.val()!==this.valCache&&(this.autosize&&(this.$clone.val(this.$input.val()).attr("rows",this.minRows).css("height",0),this.$clone.removeClass("oo-ui-element-hidden"),this.valCache=this.$input.val(),t=this.$clone[0].scrollHeight,this.$clone.css("height",""),e=this.$clone.innerHeight(),i=this.$clone.outerHeight(),this.$clone.attr("rows",this.maxRows).css("height","auto").val(""),n=this.$clone.innerHeight(),s=n-this.$clone[0].scrollHeight,o=Math.min(n,t+s),this.$clone.addClass("oo-ui-element-hidden"),l=o>e?o+(i-e):"",l!==this.styleHeight&&(this.$input.css("height",l),this.styleHeight=l,this.emit("resize"))),u=this.$input[0].offsetWidth-this.$input[0].clientWidth,u!==this.scrollWidth&&(a="rtl"===this.$element.css("direction")?"left":"right",this.$label.css({right:"",left:""}),this.$indicator.css({right:"",left:""}),u&&(this.$indicator.css(a,u),"after"===this.labelPosition&&this.$label.css(a,u)),this.scrollWidth=u,this.positionLabel())),this},t.ui.TextInputWidget.prototype.getInputElement=function(t){return t.multiline?$("<textarea>"):$('<input type="'+this.getSaneType(t)+'" />')},t.ui.TextInputWidget.prototype.getSaneType=function(t){var e=["text","password","search","email","url"].indexOf(t.type)!==-1?t.type:"text";return t.multiline?"multiline":e},t.ui.TextInputWidget.prototype.isMultiline=function(){return!!this.multiline},t.ui.TextInputWidget.prototype.isAutosizing=function(){return!!this.autosize},t.ui.TextInputWidget.prototype.selectRange=function(t,e){var i,n,s,o=this.$input[0];return e=e||t,i=e<t,n=i?e:t,s=i?t:e,this.focus(),o.setSelectionRange(n,s,i?"backward":"forward"),this},t.ui.TextInputWidget.prototype.getRange=function(){var t=this.$input[0],e=t.selectionStart,i=t.selectionEnd,n="backward"===t.selectionDirection;return{from:n?i:e,to:n?e:i}},t.ui.TextInputWidget.prototype.getInputLength=function(){return this.$input[0].value.length},t.ui.TextInputWidget.prototype.select=function(){return this.selectRange(0,this.getInputLength())},t.ui.TextInputWidget.prototype.moveCursorToStart=function(){return this.selectRange(0)},t.ui.TextInputWidget.prototype.moveCursorToEnd=function(){return this.selectRange(this.getInputLength())},t.ui.TextInputWidget.prototype.insertContent=function(t){var e,i,n=this.getRange(),s=this.getValue();return e=Math.min(n.from,n.to),i=Math.max(n.from,n.to),this.setValue(s.slice(0,e)+t+s.slice(i)),this.selectRange(e+t.length),this},t.ui.TextInputWidget.prototype.encapsulateContent=function(t,e){var i,n,s=this.getRange(),o=t.length;return i=Math.min(s.from,s.to),n=Math.max(s.from,s.to),this.selectRange(i).insertContent(t),this.selectRange(o+n).insertContent(e),this.selectRange(o+i,o+n),this},t.ui.TextInputWidget.prototype.setValidation=function(t){t instanceof RegExp||t instanceof Function?this.validate=t:this.validate=this.constructor.static.validationPatterns[t]||/.*/},t.ui.TextInputWidget.prototype.setValidityFlag=function(t){var e=this,i=function(t){t?e.$input.removeAttr("aria-invalid"):e.$input.attr("aria-invalid","true"),e.setFlags({invalid:!t})};void 0!==t?i(t):this.getValidity().then(function(){i(!0)},function(){i(!1)})},t.ui.TextInputWidget.prototype.isValid=function(){var t;return this.validate instanceof Function?(t=this.validate(this.getValue()),t&&$.isFunction(t.promise)?t.promise():$.Deferred().resolve(!!t).promise()):$.Deferred().resolve(!!this.getValue().match(this.validate)).promise()},t.ui.TextInputWidget.prototype.getValidity=function(){function t(t){return t?$.Deferred().resolve().promise():$.Deferred().reject().promise()}var e;return this.validate instanceof Function?(e=this.validate(this.getValue()),e&&$.isFunction(e.promise)?e.promise().then(function(e){return t(e)}):t(e)):t(this.getValue().match(this.validate))},t.ui.TextInputWidget.prototype.setLabelPosition=function(t){return this.labelPosition=t,this.updatePosition(),this},t.ui.TextInputWidget.prototype.updatePosition=function(){var t="after"===this.labelPosition;return this.$element.toggleClass("oo-ui-textInputWidget-labelPosition-after",!!this.label&&t).toggleClass("oo-ui-textInputWidget-labelPosition-before",!!this.label&&!t),this.valCache=null,this.scrollWidth=null,this.adjustSize(),this.positionLabel(),this},t.ui.TextInputWidget.prototype.updateSearchIndicator=function(){"search"===this.type&&(""===this.getValue()||this.isDisabled()||this.isReadOnly()?this.setIndicator(null):this.setIndicator("clear"))},t.ui.TextInputWidget.prototype.positionLabel=function(){var t,e,i;return this.$input.css({"padding-right":"","padding-left":""}),this.label?(this.$element.append(this.$label),t="after"===this.labelPosition,e="rtl"===this.$element.css("direction"),i=t===e?"padding-left":"padding-right",this.$input.css(i,this.$label.outerWidth(!0)+(t?this.scrollWidth:0)),this):void this.$label.detach()},t.ui.TextInputWidget.prototype.restorePreInfuseState=function(e){t.ui.TextInputWidget.parent.prototype.restorePreInfuseState.call(this,e),void 0!==e.scrollTop&&this.$input.scrollTop(e.scrollTop)},t.ui.ComboBoxInputWidget=function(e){e=$.extend({indicator:"down"},e),$.extend(e,e.input),t.ui.ComboBoxInputWidget.parent.call(this,e),this.$overlay=e.$overlay||this.$element,this.menu=new t.ui.FloatingMenuSelectWidget($.extend({widget:this,input:this,$container:this.$element,disabled:this.isDisabled()},e.menu)),this.input=this,this.$indicator.on({click:this.onIndicatorClick.bind(this),keypress:this.onIndicatorKeyPress.bind(this)}),this.connect(this,{change:"onInputChange",enter:"onInputEnter"}),this.menu.connect(this,{choose:"onMenuChoose",add:"onMenuItemsChange",remove:"onMenuItemsChange"}),this.$input.attr({role:"combobox","aria-autocomplete":"list"}),void 0!==e.options&&this.setOptions(e.options),this.$element.addClass("oo-ui-comboBoxInputWidget oo-ui-comboBoxWidget"),this.$overlay.append(this.menu.$element),this.onMenuItemsChange()},t.inheritClass(t.ui.ComboBoxInputWidget,t.ui.TextInputWidget),t.ui.ComboBoxInputWidget.prototype.getMenu=function(){return this.menu},t.ui.ComboBoxInputWidget.prototype.getInput=function(){return this},t.ui.ComboBoxInputWidget.prototype.onInputChange=function(t){var e=this.menu.getItemFromData(t);this.menu.selectItem(e),this.menu.getHighlightedItem()&&this.menu.highlightItem(e),this.isDisabled()||this.menu.toggle(!0)},t.ui.ComboBoxInputWidget.prototype.onIndicatorClick=function(e){return this.isDisabled()||e.which!==t.ui.MouseButtons.LEFT||(this.menu.toggle(),this.$input[0].focus()),!1},t.ui.ComboBoxInputWidget.prototype.onIndicatorKeyPress=function(e){if(!this.isDisabled()&&(e.which===t.ui.Keys.SPACE||e.which===t.ui.Keys.ENTER))return this.menu.toggle(),this.$input[0].focus(),!1},t.ui.ComboBoxInputWidget.prototype.onInputEnter=function(){this.isDisabled()||this.menu.toggle(!1)},t.ui.ComboBoxInputWidget.prototype.onMenuChoose=function(t){this.setValue(t.getData())},t.ui.ComboBoxInputWidget.prototype.onMenuItemsChange=function(){var t=this.menu.getItemFromData(this.getValue());this.menu.selectItem(t),this.menu.getHighlightedItem()&&this.menu.highlightItem(t),this.$element.toggleClass("oo-ui-comboBoxInputWidget-empty",this.menu.isEmpty())},t.ui.ComboBoxInputWidget.prototype.setDisabled=function(e){return t.ui.ComboBoxInputWidget.parent.prototype.setDisabled.call(this,e),this.menu&&this.menu.setDisabled(this.isDisabled()),this},t.ui.ComboBoxInputWidget.prototype.setOptions=function(e){return this.getMenu().clearItems().addItems(e.map(function(e){return new t.ui.MenuOptionWidget({data:e.data,label:void 0!==e.label?e.label:e.data})})),this},t.ui.ComboBoxWidget=t.ui.ComboBoxInputWidget,t.ui.FieldLayout=function(e,i){var n,s;if(t.isPlainObject(e)&&void 0===i&&(i=e,e=i.fieldWidget),void 0===e)throw new Error("Widget not found");n=e.constructor.static.supportsSimpleLabel,i=$.extend({align:"left"},i),t.ui.FieldLayout.parent.call(this,i),t.ui.mixin.LabelElement.call(this,i),t.ui.mixin.TitledElement.call(this,$.extend({},i,{$titled:this.$label})),this.fieldWidget=e,this.errors=[],this.notices=[],this.$field=$("<div>"),this.$messages=$("<ul>"),this.$body=$("<"+(n?"label":"div")+">"),this.align=null,i.help?(this.popupButtonWidget=new t.ui.PopupButtonWidget({classes:["oo-ui-fieldLayout-help"],framed:!1,icon:"info"}),s=$("<div>"),i.help instanceof t.ui.HtmlSnippet?s.html(i.help.toString()):s.text(i.help),this.popupButtonWidget.getPopup().$body.append(s.addClass("oo-ui-fieldLayout-help-content")),this.$help=this.popupButtonWidget.$element):this.$help=$([]),n&&this.$label.on("click",this.onLabelClick.bind(this)),this.fieldWidget.connect(this,{disable:"onFieldDisable"}),this.$element.addClass("oo-ui-fieldLayout").append(this.$help,this.$body),this.$body.addClass("oo-ui-fieldLayout-body"),this.$messages.addClass("oo-ui-fieldLayout-messages"),this.$field.addClass("oo-ui-fieldLayout-field").toggleClass("oo-ui-fieldLayout-disable",this.fieldWidget.isDisabled()).append(this.fieldWidget.$element),this.setErrors(i.errors||[]),this.setNotices(i.notices||[]),this.setAlignment(i.align)},t.inheritClass(t.ui.FieldLayout,t.ui.Layout),t.mixinClass(t.ui.FieldLayout,t.ui.mixin.LabelElement),t.mixinClass(t.ui.FieldLayout,t.ui.mixin.TitledElement),t.ui.FieldLayout.prototype.onFieldDisable=function(t){this.$element.toggleClass("oo-ui-fieldLayout-disabled",t)},t.ui.FieldLayout.prototype.onLabelClick=function(){return this.fieldWidget.simulateLabelClick(),!1},t.ui.FieldLayout.prototype.getField=function(){return this.fieldWidget},t.ui.FieldLayout.prototype.makeMessage=function(e,i){var n,s,o;return n=$("<li>"),s="error"===e?new t.ui.IconWidget({icon:"alert",flags:["warning"]}).$element:"notice"===e?new t.ui.IconWidget({icon:"info"}).$element:"",o=new t.ui.LabelWidget({label:i}),n.append(s,o.$element).addClass("oo-ui-fieldLayout-messages-"+e),n},t.ui.FieldLayout.prototype.setAlignment=function(t){return t!==this.align&&(["left","right","top","inline"].indexOf(t)===-1&&(t="left"),"inline"===t?this.$body.append(this.$field,this.$label):this.$body.append(this.$label,this.$field),this.align&&this.$element.removeClass("oo-ui-fieldLayout-align-"+this.align),this.$element.addClass("oo-ui-fieldLayout-align-"+t),this.align=t),this},t.ui.FieldLayout.prototype.setErrors=function(t){return this.errors=t.slice(),this.updateMessages(),this},t.ui.FieldLayout.prototype.setNotices=function(t){return this.notices=t.slice(),this.updateMessages(),this},t.ui.FieldLayout.prototype.updateMessages=function(){var t;if(this.$messages.empty(),!this.errors.length&&!this.notices.length)return void this.$messages.remove();for(this.$body.after(this.$messages),t=0;t<this.notices.length;t++)this.$messages.append(this.makeMessage("notice",this.notices[t]));for(t=0;t<this.errors.length;t++)this.$messages.append(this.makeMessage("error",this.errors[t]))},t.ui.ActionFieldLayout=function(e,i,n){t.isPlainObject(e)&&void 0===n&&(n=e,e=n.fieldWidget,i=n.buttonWidget),t.ui.ActionFieldLayout.parent.call(this,e,n),this.buttonWidget=i,this.$button=$("<div>"),this.$input=$("<div>"),this.$element.addClass("oo-ui-actionFieldLayout"),this.$button.addClass("oo-ui-actionFieldLayout-button").append(this.buttonWidget.$element),this.$input.addClass("oo-ui-actionFieldLayout-input").append(this.fieldWidget.$element),this.$field.append(this.$input,this.$button)},t.inheritClass(t.ui.ActionFieldLayout,t.ui.FieldLayout),t.ui.FieldsetLayout=function(e){e=e||{},t.ui.FieldsetLayout.parent.call(this,e),t.ui.mixin.IconElement.call(this,e),t.ui.mixin.LabelElement.call(this,e),t.ui.mixin.GroupElement.call(this,e),e.help?(this.popupButtonWidget=new t.ui.PopupButtonWidget({classes:["oo-ui-fieldsetLayout-help"],framed:!1,icon:"info"}),this.popupButtonWidget.getPopup().$body.append($("<div>").text(e.help).addClass("oo-ui-fieldsetLayout-help-content")),this.$help=this.popupButtonWidget.$element):this.$help=$([]),this.$element.addClass("oo-ui-fieldsetLayout").prepend(this.$help,this.$icon,this.$label,this.$group),Array.isArray(e.items)&&this.addItems(e.items)},t.inheritClass(t.ui.FieldsetLayout,t.ui.Layout),t.mixinClass(t.ui.FieldsetLayout,t.ui.mixin.IconElement),t.mixinClass(t.ui.FieldsetLayout,t.ui.mixin.LabelElement),t.mixinClass(t.ui.FieldsetLayout,t.ui.mixin.GroupElement),t.ui.FormLayout=function(e){var i;e=e||{},t.ui.FormLayout.parent.call(this,e),t.ui.mixin.GroupElement.call(this,$.extend({},e,{$group:this.$element})),this.$element.on("submit",this.onFormSubmit.bind(this)),i=e.action,void 0===i||t.ui.isSafeUrl(i)||(i="./"+i),this.$element.addClass("oo-ui-formLayout").attr({method:e.method,action:i,enctype:e.enctype}),Array.isArray(e.items)&&this.addItems(e.items)},t.inheritClass(t.ui.FormLayout,t.ui.Layout),t.mixinClass(t.ui.FormLayout,t.ui.mixin.GroupElement),t.ui.FormLayout.static.tagName="form",t.ui.FormLayout.prototype.onFormSubmit=function(){if(this.emit("submit"))return!1},t.ui.PanelLayout=function(e){e=$.extend({scrollable:!1,padded:!1,expanded:!0,framed:!1},e),t.ui.PanelLayout.parent.call(this,e),this.$element.addClass("oo-ui-panelLayout"),e.scrollable&&this.$element.addClass("oo-ui-panelLayout-scrollable"),e.padded&&this.$element.addClass("oo-ui-panelLayout-padded"),e.expanded&&this.$element.addClass("oo-ui-panelLayout-expanded"),e.framed&&this.$element.addClass("oo-ui-panelLayout-framed")},t.inheritClass(t.ui.PanelLayout,t.ui.Layout),t.ui.PanelLayout.prototype.focus=function(){t.ui.findFocusable(this.$element).focus()},t.ui.HorizontalLayout=function(e){e=e||{},t.ui.HorizontalLayout.parent.call(this,e),t.ui.mixin.GroupElement.call(this,$.extend({},e,{$group:this.$element})),this.$element.addClass("oo-ui-horizontalLayout"),Array.isArray(e.items)&&this.addItems(e.items)},t.inheritClass(t.ui.HorizontalLayout,t.ui.Layout),t.mixinClass(t.ui.HorizontalLayout,t.ui.mixin.GroupElement)}(OO);
//# sourceMappingURL=oojs-ui-core.min.js.map