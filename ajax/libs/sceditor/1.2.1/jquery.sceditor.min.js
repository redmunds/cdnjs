(function(a){a.sceditor=function(i,m){var n=this;var B=a(i);var v=i;var k=null;var G=null;var u=null;var t=null;var q=null;var g=null;var h=false;var p=[];var d=null;var j=[];n.commands={bold:{execCommand:"bold",tooltip:"Bold"},italic:{execCommand:"italic",tooltip:"Italic"},underline:{execCommand:"underline",tooltip:"Underline"},strike:{execCommand:"strikethrough",tooltip:"Strikethrough"},subscript:{execCommand:"subscript",tooltip:"Subscript"},superscript:{execCommand:"superscript",tooltip:"Superscript"},left:{execCommand:"justifyleft",tooltip:"Align left"},center:{execCommand:"justifycenter",tooltip:"Center"},right:{execCommand:"justifyright",tooltip:"Align right"},justify:{execCommand:"justifyfull",tooltip:"Justify"},font:{execFunction:function(H){var K=n.options.fonts.split(",");var J=a("<span />");for(var I=0;I<K.length;I++){J.append(a('<a class="sceditor-font-option" href="#"><font face="'+K[I]+'">'+K[I]+"</font></a>").data("sceditor-font",K[I]).click(function(L){n.execCommand("fontname",a(this).data("sceditor-font"));c();n.focus();L.preventDefault()}))}f(H,"font-picker",J)},tooltip:"Font Name"},size:{execFunction:function(H){var J=a("<span />");for(var I=1;I<=7;I++){J.append(a('<a class="sceditor-fontsize-option" href="#"><font size="'+I+'">'+I+"</font></a>").data("sceditor-fontsize",I).click(function(K){n.execCommand("fontsize",a(this).data("sceditor-fontsize"));c();n.focus();K.preventDefault()}))}f(H,"fontsize-picker",J)},tooltip:"Font Size"},color:{execFunction:function(J){var I={r:255,g:255,b:255};var O=a("<span />");var M=n.options.colors?n.options.colors.split("|"):new Array(21);var N=[];var Q=0;for(var L=0;L<M.length;++L){var H=(typeof M[L]!="undefined")?M[L].split(","):new Array(21);N[Q++]='<div class="sceditor-color-column">';for(var P=0;P<H.length;++P){var K=(typeof H[P]!="undefined")?H[P]:"#"+I.r.toString(16)+I.g.toString(16)+I.b.toString(16);N[Q++]='<a href="#" class="sceditor-color-option" style="background-color: '+K+'"></a>';if(P%5==0){I={r:I.r,g:I.g-51,b:255}}else{I={r:I.r,g:I.g,b:I.b-51}}}N[Q++]="</div>";if(L%5==0){I={r:I.r-51,g:255,b:255}}else{I={r:I.r,g:255,b:255}}}O.append(N.join("")).find("a").click(function(R){n.execCommand("forecolor",a(this).css("background-color"));c();n.focus();R.preventDefault()});f(J,"color-picker",O)},tooltip:"Font Color"},removeformat:{execCommand:"removeformat",tooltip:"Remove Formatting"},cut:{execCommand:"cut",tooltip:"Cut",errorMessage:"Your browser dose not allow the cut command. Please use the keyboard shortcut Ctrl/Cmd-X"},copy:{execCommand:"copy",tooltip:"Copy",errorMessage:"Your browser dose not allow the copy command. Please use the keyboard shortcut Ctrl/Cmd-C"},paste:{execCommand:"paste",tooltip:"Paste",errorMessage:"Your browser dose not allow the paste command. Please use the keyboard shortcut Ctrl/Cmd-V"},pastetext:{execFunction:function(H){var I=a('<form><div><label for="txt">Paste your text inside the following								 box:</label> <textarea cols="20" rows="7" id="txt"></textarea>								</div></form>').submit(function(){return false});I.append(a('<div><input type="button" class="button" value="Insert" /></div>').click(function(J){b(a(this).parent("form").find("#txt").val());c();n.focus();J.preventDefault()}));f(H,"pastetext",I)},tooltip:"Paste Text"},bulletlist:{execCommand:"insertunorderedlist",tooltip:"Bullet list"},orderedlist:{execCommand:"insertorderedlist",tooltip:"Numbered list"},undo:{execCommand:"undo",tooltip:"Undo"},redo:{execCommand:"redo",tooltip:"Redo"},table:{execFunction:function(H){var I=a('<form>						<div><label for="rows">Rows:</label><input type="text" id="rows" value="2" /></div>						<div><label for="cols">Cols:</label><input type="text" id="cols" value="2" /></div>						</form>').submit(function(){return false});I.append(a('<div><input type="button" class="button" value="Insert" /></div>').click(function(N){var L=a(this).parent("form").find("#rows").val()-0;var M=a(this).parent("form").find("#cols").val()-0;var K="<table>";for(var O=0;O<L;O++){K+="<tr>";for(var J=0;J<M;J++){if(a.browser.msie){K+="<td></td>"}else{K+='<td><br class="sceditor-ignore" /></td>'}}K+="</tr>"}K+="</table>";D(K);c();n.focus();N.preventDefault()}));f(H,"inserttable",I)},tooltip:"Insert a table"},horizontalrule:{execCommand:"inserthorizontalrule",tooltip:"Insert a horizontal rule"},code:{execFunction:function(H){D("<code>","<br /></code>")},tooltip:"Code"},image:{execFunction:function(H){var I=a('<form><div><label for="link">URL:</label> <input type="text" id="image" value="http://" /></div>							<div><label for="width">Width (optional):</label> <input type="text" id="width" size="2" /></div>							<div><label for="height">Height (optional):</label> <input type="text" id="height" size="2" /></div></form>').submit(function(){return false});I.append(a('<div><input type="button" class="button" value="Insert" /></div>').click(function(K){var L=a(this).parent("form").find("#image").val();var J="";if((width=a(this).parent("form").find("#width").val())!=""){J+=' width="'+width+'"'}if((width=a(this).parent("form").find("#height").val())!=""){J+=' height="'+width+'"'}if(L!=""&&L!="http://"){D("<img"+J+' src="'+L+'" />')}c();n.focus();K.preventDefault()}));f(H,"insertimage",I)},tooltip:"Insert an image"},email:{execFunction:function(H){var I=a('<form><div><label for="email">E-mail:</label> <input type="text" id="email" value="" /></div></form>').submit(function(){return false});I.append(a('<div><input type="button" class="button" value="Insert" /></div>').click(function(J){var K=a(this).parent("form").find("#email").val();if(K!=""){n.focus();if(x().type=="None"||x().type=="Caret"){D('<a href="mailto:'+K+'">'+K+"</a>")}else{n.execCommand("createlink","mailto:"+K)}}c();n.focus();J.preventDefault()}));f(H,"insertemail",I)},tooltip:"Insert an email"},link:{execFunction:function(H){var I=a('<form><div><label for="link">URL:</label> <input type="text" id="link" value="http://" /></div></form>').submit(function(){return false});I.append(a('<div><input type="button" class="button" value="Insert" /></div>').click(function(J){var K=a(this).parent("form").find("#link").val();if(K!=""&&K!="http://"){n.focus();if(x().type=="None"||x().type=="Caret"){D('<a href="'+K+'">'+K+"</a>")}else{n.execCommand("createlink",K)}}c();n.focus();J.preventDefault()}));f(H,"insertlink",I)},tooltip:"Insert a link"},unlink:{execCommand:"unlink",tooltip:"Unlink"},quote:{execFunction:function(H){D("<blockquote>","<br /></blockquote>")},tooltip:"Insert a Quote"},emoticon:{execFunction:function(I){var K=a("<div />");var H=a("<div />");var J=a("<div />");a.each(n.options.emoticons.dropdown,function(M,L){H.append(a('<img src="'+L+'" />').data("sceditor-emoticon",M).click(function(N){a(this).data("sceditor-emoticon");D('<img src="'+a(this).attr("src")+'" data-sceditor-emoticon="'+a(this).data("sceditor-emoticon")+'" />');c();n.focus();N.preventDefault()}));if(H.children().length>3){K.append(H);H=a("<div />")}});if(H.children().length>0){K.append(H)}if(typeof n.options.emoticons.more!="undefined"){var J=a('<a class="sceditor-more">More</a>').click(function(){var L=a.extend({},n.options.emoticons.dropdown,n.options.emoticons.more);K=a("<div />");a.each(L,function(N,M){H.append(a('<img src="'+M+'" />').data("sceditor-emoticon",N).click(function(O){a(this).data("sceditor-emoticon");D('<img src="'+a(this).attr("src")+'" data-sceditor-emoticon="'+a(this).data("sceditor-emoticon")+'" />');c();n.focus();O.preventDefault()}));if(H.children().length>4){K.append(H);H=a("<div />")}});if(H.children().length>0){K.append(H)}f(I,"insertemoticon",K)});K.append(J)}f(I,"insertemoticon",K)},keyPress:function(J){var H=null;if(t.contentWindow&&t.contentWindow.getSelection){H=t.contentWindow.getSelection().getRangeAt(0)}if(H==null){return}var I=a.extend({},n.options.emoticons.more,n.options.emoticons.dropdown);a.each(I,function(N,M){var O="";if(H.startContainer){var K=N.length-1;var P=(H.startOffset>K?H.startOffset-K:0);var L=(H.startOffset>K?K:H.startOffset);O=H.startContainer.textContent.substr(P,L)}O+=String.fromCharCode(J.which);if(O==N){H.setStart(H.startContainer,P);H.deleteContents();D('<img src="'+M+'" data-sceditor-emoticon="'+N+'" />');J.preventDefault();J.stopPropagation();return false}})},tooltip:"Insert an emoticon"},date:{execFunction:function(J){var I=new Date();var K=I.getYear();var L=I.getMonth();var H=I.getDate();if(K<2000){K=1900+K}if(L<10){L="0"+L}if(H<10){H="0"+H}D("<span>"+K+"-"+L+"-"+H+"</span>")},tooltip:"Insert current date"},time:{execFunction:function(J){var I=new Date();var H=I.getHours();var L=I.getMinutes();var K=I.getSeconds();if(H<10){H="0"+H}if(L<10){L="0"+L}if(K<10){K="0"+K}D("<span>"+H+":"+L+":"+K+"</span>")},tooltip:"Insert current time"},print:{execCommand:"print",tooltip:"Print"},source:{execFunction:function(H){n.toggleTextMode()},tooltip:"View source"}};var z=function(){B.data("sceditor",n);n.options=a.extend({},a.sceditor.defaultOptions,m);if(n.options.height!=null){B.height(n.options.height)}if(n.options.width!=null){B.width(n.options.width)}k=a('<div class="sceditor-container" />').height(B.outerHeight()).width(B.outerWidth());B.after(k);F();s();E();B.parents("form").submit(function(){if(q.is(":visible")){n.toggleTextMode()}B.val(n.getWysiwygEditorValue())});a(document).click(l);var H=B.hide().val();if(n.options.getTextHandler){H=n.options.getTextHandler(H)}n.setWysiwygEditorValue(H);C()};var s=function(){var I,J;var H=B.height()-(n.options.toolbarContainer===null?G.outerHeight():0);var K=B.width();q=a("<textarea></textarea>").hide().height(H).width(K);u=a(window.location.protocol!=="https:"?"<iframe></iframe>":'<iframe src="javascript:false"></iframe>').attr("frameborder",0).height(H).width(K);k.append(u).append(q);t=u[0];I=u.height();J=u.width();u.height(I+((I-u.outerHeight(true))/2));u.width(J+((J-u.outerWidth(true))/2));I=q.height();J=q.width();q.height(I+((I-q.outerHeight(true))/2));q.width(J+((J-q.outerWidth(true))/2));y().designMode="On";y().open();y().write('<html><head><link rel="stylesheet" type="text/css" href="'+n.options.style+'" /></head><body></body></html>');y().close();a(y()).find("body").keypress(e);a(y()).keypress(e);a(y()).mousedown(w);a(y()).bind("beforedeactivate keypress",saveRange)};var F=function(){G=a('<div class="sceditor-toolbar" />');var I=n.options.toolbar.split("|");for(var K=0;K<I.length;K++){var M=a('<div class="sceditor-group" />');var L=I[K].split(",");for(var H=0;H<L.length;H++){if(!n.commands.hasOwnProperty(L[H])){continue}var J=a('<a class="sceditor-button sceditor-button-'+L[H]+' "><div /></a>');if(n.commands[L[H]].hasOwnProperty("tooltip")){J.attr("title",n.commands[L[H]].tooltip)}J.data("sceditor-command",L[H]);J.click(function(N){A(a(this),n.commands[a(this).data("sceditor-command")]);N.preventDefault()});M.append(J)}G.append(M)}if(n.options.toolbarContainer===null){k.append(G)}else{a(n.options.toolbarContainer).append(G)}};var E=function(){a.each(n.commands,function(I,H){if(typeof H.keyPress!="undefined"){p.push(H.keyPress)}})};var C=function(){var H=a.extend({},n.options.emoticons.more,n.options.emoticons.dropdown);a.each(H,function(K,I){var J=document.createElement("img");J.src=I;j.push(J)})};var f=function(I,K,J){if(g!=null){c()}var H=I.position();g=a('<div class="sceditor-dropdown sceditor-'+K+'" />').css({top:H.top,left:H.left}).append(J);k.after(g);h=true;g.click(function(L){L.stopPropagation()})};var l=function(){if(!h){c()}h=false};var c=function(){if(g!=null){g.remove();g=null}};var y=function(){if(t.contentDocument){return t.contentDocument}if(t.contentWindow&&t.contentWindow.document){return t.contentWindow.document}if(t.document){return t.document}return null};var D=function(I,K){n.focus();if(a(r()).is("code")||a(r()).parents("code").length!==0){return}if(typeof K!="undefined"){I=I+n.getWysiwygSelectedHtml()+K}if(y().getSelection){var H=x();var J=y().createElement("div");J.innerHTML=I;J=J.children[0];H.deleteContents();H.insertNode(J);H=H.cloneRange();H.setStartAfter(J);t.contentWindow.getSelection().removeAllRanges();t.contentWindow.getSelection().addRange(H)}else{if(y().selection&&y().selection.createRange){y().selection.createRange().pasteHTML(I)}else{n.execCommand("insertHtml",I)}}d=null};var b=function(H){H=H.replace(/&/g,"&amp;");H=H.replace(/</g,"&lt;");H=H.replace(/>/g,"&gt;");H=H.replace(/ /g,"&nbsp;");H=H.replace(/\r\n|\r/g,"\n");H=H.replace(/\n/g,"<br />");D(H)};var x=function(){var H;if(t.contentWindow&&t.contentWindow.getSelection){H=t.contentWindow.getSelection()}else{if(y().selection){H=y().selection}}if(H.getRangeAt){return H.getRangeAt(0)}else{if(H.createRange){return H.createRange()}}return null};n.getWysiwygSelectedHtml=function(){var I=x();if(I===null){return""}if(document.selection&&document.selection.createRange){if(typeof I.htmlText!="undefined"){return I.htmlText}else{if(I.length>=1){return I.item(0).outerHTML}}}if(window.getSelection&&window.XMLSerializer){var H="";a(I.cloneContents().childNodes).each(function(){H+=new XMLSerializer().serializeToString(this)});return H}};var r=function(){var H=x();if(H===null){return null}if(document.selection&&document.selection.createRange){return H.parentElement()}if(window.getSelection&&window.XMLSerializer){return H.commonAncestorContainer}};n.getWysiwygEditorValue=function(){var H=u.contents().find("body").html();if(n.options.getHtmlHandler){H=n.options.getHtmlHandler(H,u.contents().find("body"))}return H};n.getTextareaValue=function(){var H=q.val();if(n.options.getTextHandler){H=n.options.getTextHandler(H)}return H};n.setWysiwygEditorValue=function(H){H=o(H);y().body.innerHTML=H};n.setTextareaValue=function(H){q.val(H)};var o=function(H){var I=a.extend({},n.options.emoticons.more,n.options.emoticons.dropdown);a.each(I,function(K,J){var L=K.replace(/[\$\?\[\]\.\*\(\)\|]/g,"\\$&").replace("<","&lt;").replace(">","&gt;")+"(?=([^<>]*?<(?!/code)|[^<>]*?$))";H=H.replace(new RegExp(L,"g"),'<img src="'+J+'" data-sceditor-emoticon="'+K+'" />')});return H};n.toggleTextMode=function(){if(q.is(":visible")){n.setWysiwygEditorValue(n.getTextareaValue())}else{n.setTextareaValue(n.getWysiwygEditorValue())}d=null;q.toggle();u.toggle()};var A=function(H,I){if(I.hasOwnProperty("execFunction")){I.execFunction(H)}else{n.execCommand(I.execCommand,I.hasOwnProperty("execParam")?I.execParam:null)}};n.focus=function(){t.contentWindow.focus();if(d!=null){if(window.document.createRange){window.getSelection().addRange(d)}else{if(window.document.selection){d.select()}}}};saveRange=function(){if(!a.browser.msie){return}d=x()};n.execCommand=function(K,J){var H=false;n.focus();if(a(r()).is("code")||a(r()).parents("code").length!==0){return}if(y()){try{H=y().execCommand(K,false,J)}catch(I){}}if(!H&&typeof n.commands[K]!="undefined"&&typeof n.commands[K].errorMessage!="undefined"){alert(n.commands[K].errorMessage)}};var e=function(I){c();if(a(r()).is("code")||a(r()).parents("code").length!==0){return}for(var H=0;H<p.length;++H){p[H](I)}};var w=function(H){c()};z()};a.sceditor.defaultOptions={toolbar:"bold,italic,underline,strike,subscript,superscript|left,center,right,justify|font,size,color,removeformat|cut,copy,paste,pastetext|bulletlist,orderedlist|undo,redo|table|code,quote|horizontalrule,image,email,link,unlink|emoticon,date,time|print,source",style:"jquery.sceditor.default.css",fonts:"Arial,Arial Black,Comic Sans MS,Courier New,Georgia,Impact,Sans-serif,Serif,Times New Roman,Trebuchet MS,Verdana",colors:null,emoticons:{dropdown:{":)":"emoticons/smile.png",":angel:":"emoticons/angel.png",":angry:":"emoticons/angry.png","8-)":"emoticons/cool.png",":'(":"emoticons/cwy.png",":ermm:":"emoticons/ermm.png",":D":"emoticons/grin.png","<3":"emoticons/heart.png",":(":"emoticons/sad.png",":O":"emoticons/shocked.png",":P":"emoticons/tongue.png",";)":"emoticons/wink.png"},more:{":alien:":"emoticons/alien.png",":blink:":"emoticons/blink.png",":blush:":"emoticons/blush.png",":cheerful:":"emoticons/cheerful.png",":devil:":"emoticons/devil.png",":dizzy:":"emoticons/dizzy.png",":getlost:":"emoticons/getlost.png",":happy:":"emoticons/happy.png",":kissing:":"emoticons/kissing.png",":ninja:":"emoticons/ninja.png",":pinch:":"emoticons/pinch.png",":pouty:":"emoticons/pouty.png",":sick:":"emoticons/sick.png",":sideways:":"emoticons/sideways.png",":silly:":"emoticons/silly.png",":sleeping:":"emoticons/sleeping.png",":unsure:":"emoticons/unsure.png",":woot:":"emoticons/w00t.png",":wassat:":"emoticons/wassat.png",":whistling:":"emoticons/whistling.png",":love:":"emoticons/wub.png"}},width:null,height:null,getHtmlHandler:null,getTextHandler:null,toolbarContainer:null};a.fn.sceditor=function(b){return this.each(function(){(new a.sceditor(this,b))})}})(jQuery);(function(a){a.sceditorBBCodePlugin=function(e,m){var c=this;c.bbcodes={b:{styles:{"font-weight":["bold","bolder","401","700","800","900"]},format:"[b]{0}[/b]",html:"<strong>{0}</strong>"},i:{styles:{"font-style":["italic","oblique"]},format:"[i]{0}[/i]",html:"<em>{0}</em>"},u:{styles:{"text-decoration":["underline"]},format:"[u]{0}[/u]",html:"<u>{0}</u>"},s:{styles:{"text-decoration":["line-through"]},format:"[s]{0}[/s]",html:"<s>{0}</s>"},sub:{tags:{sub:null},format:"[sub]{0}[/sub]",html:"<sub>{0}</sub>"},sup:{tags:{sup:null},format:"[sup]{0}[/sup]",html:"<sup>{0}</sup>"},left:{styles:{"text-align":["left"]},format:"[left]{0}[/left]",html:'<div style="text-align: left">{0}</div>'},center:{styles:{"text-align":["center"]},format:"[center]{0}[/center]",html:'<div style="text-align: center">{0}</div>'},right:{styles:{"text-align":["right"]},format:"[right]{0}[/right]",html:'<div style="text-align: right">{0}</div>'},justify:{styles:{"text-align":["justify"]},format:"[justify]{0}[/justify]",html:'<div style="text-align: justify">{0}</div>'},font:{styles:{"font-family":null},format:function(n,o){if(n.css("font-family")==c.options.defaultFont){return o}return"[font="+f(n.css("font-family"))+"]"+o+"[/font]"},html:function(o,n,p){return'<font face="'+n.defaultAttr+'">'+p+"</font>"}},size:{styles:{"font-size":null},format:function(o,p){var q=o.css("fontSize");var n=1;if(q==c.options.defaultSize){return p}if(q.indexOf("px")>-1){q=q.replace("px","")-0;if(q>12){n=2}if(q>15){n=3}if(q>17){n=4}if(q>23){n=5}if(q>31){n=6}if(q>47){n=7}}else{n=q}return"[size="+n+"]"+p+"[/size]"},html:function(o,n,p){return'<font size="'+n.defaultAttr+'">'+p+"</font>"}},color:{styles:{color:null},format:function(o,p){var n=g(o.css("color"));if(n==c.options.defaultColor){return p}return"[color="+n+"]"+p+"[/color]"},html:function(o,n,p){return'<font color="'+n.defaultAttr+'">'+p+"</font>"}},ul:{tags:{ul:null},format:"[ul]{0}[/ul]",html:"<ul>{0}</ul>"},list:{html:"<ul>{0}</ul>"},ol:{tags:{ol:null},format:"[ol]{0}[/ol]",html:"<ol>{0}</ol>"},li:{tags:{li:null},format:"[li]{0}[/li]",html:"<li>{0}</li>"},"*":{html:"<li>{0}</li>"},table:{tags:{table:null},format:"[table]{0}[/table]",html:"<table>{0}</table>"},tr:{tags:{tr:null},format:"[tr]{0}[/tr]",html:"<tr>{0}</tr>"},th:{tags:{th:null},format:"[th]{0}[/th]",html:"<th>{0}</th>"},td:{tags:{td:null},format:"[td]{0}[/td]",html:'<td>{0}<br class="sceditor-ignore" /></td>'},emoticon:{tags:{img:{src:null,"data-sceditor-emoticon":null}},format:function(n,o){return n.attr("data-sceditor-emoticon")+o},html:"{0}"},horizontalrule:{tags:{hr:null},format:"[hr]{0}",html:"<hr />"},img:{tags:{img:{src:null}},format:function(n,o){if(typeof n.attr("data-sceditor-emoticon")!="undefined"){return o}var p="="+a(n).width()+"x"+a(n).height();return"[img"+p+"]"+n.attr("src")+"[/img]"},html:function(o,n,p){var r="";if(typeof n.width!="undefined"){r+=' width="'+n.width+'"'}if(typeof n.height!="undefined"){r+=' height="'+n.height+'"'}if(typeof n.defaultAttr!=="undefined"){var q=n.defaultAttr.split(/x/i);r=' width="'+q[0]+'" height="'+(q.length===2?q[1]:q[0])+'"'}return"<img "+r+' src="'+p+'" />'}},url:{tags:{a:{href:null}},format:function(n,o){if(n.attr("href").substr(0,7)=="mailto:"){return"[email="+n.attr("href").substr(7)+"]"+o+"[/email]"}return"[url="+encodeURI(n.attr("href")).replace("=","%3D")+"]"+o+"[/url]"},html:function(o,n,p){if(typeof n.defaultAttr==="undefined"){n.defaultAttr=p}return'<a href="'+n.defaultAttr+'">'+p+"</a>"}},email:{html:function(o,n,p){if(typeof n.defaultAttr==="undefined"){n.defaultAttr=p}return'<a href="mailto:'+n.defaultAttr+'">'+p+"</a>"}},quote:{tags:{blockquote:null},format:function(o,p){var n="";if(a(o).children("cite:first").length==1){n="="+a(o).children("cite:first").text();p="";a(o).children("cite:first").remove();a(o).contents().each(function(){p+=k(a(this))})}return"[quote"+n+"]"+p+"[/quote]"},html:function(o,n,p){if(typeof n.defaultAttr!=="undefined"){p="<cite>"+n.defaultAttr+"</cite>"+p}return"<blockquote>"+p+"</blockquote>"}},code:{tags:{code:null},format:"[code]{0}[/code]",html:"<code>{0}</code>"}};var j={};var b={};var l=function(){c.options=a.extend({},a.sceditor.defaultOptions,a.sceditorBBCodePlugin.defaultOptions,m);c.buildBbcodeCache();(new a.sceditor(e,a.extend({},c.options,{getHtmlHandler:c.getHtmlHandler,getTextHandler:c.getTextHandler})))};var g=function(p){var o;function n(q){q=parseInt(q,10);if(isNaN(q)){return"00"}q=Math.max(0,Math.min(q,255)).toString(16);return q.length<2?"0"+q:q}if(o=p.match(/rgb\((\d+),\s*?(\d+),\s*?(\d+)\)/i)){return"#"+n(o[1])+n(o[2]-0)+n(o[3]-0)}return p};c.buildBbcodeCache=function(){a.each(c.bbcodes,function(n,o){if(typeof c.bbcodes[n].tags!="undefined"){a.each(c.bbcodes[n].tags,function(p,q){j[p]=(j[p]||{});j[p][n]=q})}if(typeof c.bbcodes[n].styles!="undefined"){a.each(c.bbcodes[n].styles,function(q,p){b[q]=(b[q]||{});b[q][n]=p})}})};var h=function(n,o){a.each(b,function(q,p){if(n.get(0).nodeName.toLowerCase()=="a"&&(q=="color"||q=="text-decoration")){return}else{if(n.get(0).nodeName.toLowerCase()=="code"&&(q=="font-family")){return}}elementPropVal=n.css(q);if(n.parent().css(q)==elementPropVal){return}a.each(p,function(s,r){if(r==null||a.inArray(elementPropVal.toString(),r)>-1){if(a.isFunction(c.bbcodes[s].format)){o=c.bbcodes[s].format(n,o)}else{o=d(c.bbcodes[s].format,o)}}})});return o};var i=function(o,p){var n=o.get(0).nodeName.toLowerCase();if(typeof j[n]!="undefined"){a.each(j[n],function(r,s){var q=false;if(s==null){q=true}else{a.each(s,function(u,t){if(typeof o.attr(u)=="undefined"){return}if(t!=null&&a.inArray(o.attr(u),t)<0){return}q=true;return false})}if(!q){return}if(a.isFunction(c.bbcodes[r].format)){p=c.bbcodes[r].format(o,p)}else{p=d(c.bbcodes[r].format,p)}})}if(n=="br"||n=="div"||n=="p"){p+="\n"}return p};var d=function(){var n=arguments;return n[0].replace(/{(\d+)}/g,function(p,o){return typeof n[0-o+1]!="undefined"?n[0-o+1]:"{"+o+"}"})};var f=function(n){return n.replace(/^["']+/,"").replace(/["']+$/,"")};c.getHtmlHandler=function(n,o){return k(a(o))};var k=function(o){if(typeof o.get(0)==="undefined"){return""}if(o.get(0).nodeType===3){return o.get(0).nodeValue}var n="";if(o.is("code")){n=o.text()}else{if(o.contents().length>0){a.each(o.contents(),function(){n+=k(a(this))})}}if(!o.is("code")){n=h(o,n)}n=i(o,n);return n};c.getTextHandler=function(q){var p=/\[([^\[\s=]*?)(?:([^\[]*?))?]((?:[\s\S(?!=\[\\\1)](?!\[\1))*?)\[\/(\1)\]/g;var o=/(\S+)=((?:(?:(["'])(?:\\\3|[^\3])*?\3))|(?:[^'"\s]+))/g;var n;q=q.replace(/&/g,"&amp;");q=q.replace(/</g,"&lt;");q=q.replace(/>/g,"&gt;");q=q.replace(/\r/g,"");q=q.replace(/(\[\/?(?:left|center|right|justify)\])\n/g,"$1");q=q.replace(/\n/g,"<br />");while(q!=n){n=q;q=q.replace(p,function(w,s,r,u){var t={};if(typeof r!="undefined"){var v;r=a.trim(r);if(r.charAt(0)=="="&&(r.split("=").length-1)<=1){t.defaultAttr=f(r.substr(1))}else{if(r.charAt(0)=="="){r="defaultAttr"+r}while((v=o.exec(r))){t[v[1].toLowerCase()]=f(v[2])}}}if(typeof c.bbcodes[s]=="undefined"){return w}if(a.isFunction(c.bbcodes[s].html)){return c.bbcodes[s].html(s,t,u)}else{return d(c.bbcodes[s].html,u)}})}q=q.replace(/\[hr\]/gi,"<hr>");return q.replace(/  (?=([^\<\>]*?<|[^\<\>]*?$))/g," &nbsp;")};l()};a.sceditorBBCodePlugin.defaultOptions={defaultSize:13,defaultColor:"#111111",defaultFont:"Verdana, Arial, Helvetica, sans-serif"};a.fn.sceditorBBCodePlugin=function(b){return this.each(function(){(new a.sceditorBBCodePlugin(this,b))})}})(jQuery);