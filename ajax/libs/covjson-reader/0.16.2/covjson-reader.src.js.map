{"version":3,"file":"covjson-reader.src.js","sources":["../../../../../\u0000commonjsHelpers","node_modules/ndarray/node_modules/iota-array/iota.js","node_modules/ndarray/node_modules/is-buffer/index.js","node_modules/ndarray/ndarray.js","node_modules/url-template/lib/url-template.js","src/constants.js","src/util.js","src/http-common.js","src/http.js","../../../../../\u0000babelHelpers","src/Coverage.js","src/CoverageCollection.js","src/reader.js"],"sourcesContent":["\nexport var commonjsGlobal = typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {}\n\nexport function interopDefault(ex) {\n\treturn ex && typeof ex === 'object' && 'default' in ex ? ex['default'] : ex;\n}\n\nexport function createCommonjsModule(fn, module) {\n\treturn module = { exports: {} }, fn(module, module.exports), module.exports;\n}","\"use strict\"\n\nfunction iota(n) {\n  var result = new Array(n)\n  for(var i=0; i<n; ++i) {\n    result[i] = i\n  }\n  return result\n}\n\nmodule.exports = iota","/*!\n * Determine if an object is a Buffer\n *\n * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>\n * @license  MIT\n */\n\n// The _isBuffer check is for Safari 5-7 support, because it's missing\n// Object.prototype.constructor. Remove this eventually\nmodule.exports = function (obj) {\n  return obj != null && (isBuffer(obj) || isSlowBuffer(obj) || !!obj._isBuffer)\n}\n\nfunction isBuffer (obj) {\n  return !!obj.constructor && typeof obj.constructor.isBuffer === 'function' && obj.constructor.isBuffer(obj)\n}\n\n// For Node v0.10 support. Remove this eventually.\nfunction isSlowBuffer (obj) {\n  return typeof obj.readFloatLE === 'function' && typeof obj.slice === 'function' && isBuffer(obj.slice(0, 0))\n}\n","var iota = require(\"iota-array\")\nvar isBuffer = require(\"is-buffer\")\n\nvar hasTypedArrays  = ((typeof Float64Array) !== \"undefined\")\n\nfunction compare1st(a, b) {\n  return a[0] - b[0]\n}\n\nfunction order() {\n  var stride = this.stride\n  var terms = new Array(stride.length)\n  var i\n  for(i=0; i<terms.length; ++i) {\n    terms[i] = [Math.abs(stride[i]), i]\n  }\n  terms.sort(compare1st)\n  var result = new Array(terms.length)\n  for(i=0; i<result.length; ++i) {\n    result[i] = terms[i][1]\n  }\n  return result\n}\n\nfunction compileConstructor(dtype, dimension) {\n  var className = [\"View\", dimension, \"d\", dtype].join(\"\")\n  if(dimension < 0) {\n    className = \"View_Nil\" + dtype\n  }\n  var useGetters = (dtype === \"generic\")\n\n  if(dimension === -1) {\n    //Special case for trivial arrays\n    var code =\n      \"function \"+className+\"(a){this.data=a;};\\\nvar proto=\"+className+\".prototype;\\\nproto.dtype='\"+dtype+\"';\\\nproto.index=function(){return -1};\\\nproto.size=0;\\\nproto.dimension=-1;\\\nproto.shape=proto.stride=proto.order=[];\\\nproto.lo=proto.hi=proto.transpose=proto.step=\\\nfunction(){return new \"+className+\"(this.data);};\\\nproto.get=proto.set=function(){};\\\nproto.pick=function(){return null};\\\nreturn function construct_\"+className+\"(a){return new \"+className+\"(a);}\"\n    var procedure = new Function(code)\n    return procedure()\n  } else if(dimension === 0) {\n    //Special case for 0d arrays\n    var code =\n      \"function \"+className+\"(a,d) {\\\nthis.data = a;\\\nthis.offset = d\\\n};\\\nvar proto=\"+className+\".prototype;\\\nproto.dtype='\"+dtype+\"';\\\nproto.index=function(){return this.offset};\\\nproto.dimension=0;\\\nproto.size=1;\\\nproto.shape=\\\nproto.stride=\\\nproto.order=[];\\\nproto.lo=\\\nproto.hi=\\\nproto.transpose=\\\nproto.step=function \"+className+\"_copy() {\\\nreturn new \"+className+\"(this.data,this.offset)\\\n};\\\nproto.pick=function \"+className+\"_pick(){\\\nreturn TrivialArray(this.data);\\\n};\\\nproto.valueOf=proto.get=function \"+className+\"_get(){\\\nreturn \"+(useGetters ? \"this.data.get(this.offset)\" : \"this.data[this.offset]\")+\n\"};\\\nproto.set=function \"+className+\"_set(v){\\\nreturn \"+(useGetters ? \"this.data.set(this.offset,v)\" : \"this.data[this.offset]=v\")+\"\\\n};\\\nreturn function construct_\"+className+\"(a,b,c,d){return new \"+className+\"(a,d)}\"\n    var procedure = new Function(\"TrivialArray\", code)\n    return procedure(CACHED_CONSTRUCTORS[dtype][0])\n  }\n\n  var code = [\"'use strict'\"]\n\n  //Create constructor for view\n  var indices = iota(dimension)\n  var args = indices.map(function(i) { return \"i\"+i })\n  var index_str = \"this.offset+\" + indices.map(function(i) {\n        return \"this.stride[\" + i + \"]*i\" + i\n      }).join(\"+\")\n  var shapeArg = indices.map(function(i) {\n      return \"b\"+i\n    }).join(\",\")\n  var strideArg = indices.map(function(i) {\n      return \"c\"+i\n    }).join(\",\")\n  code.push(\n    \"function \"+className+\"(a,\" + shapeArg + \",\" + strideArg + \",d){this.data=a\",\n      \"this.shape=[\" + shapeArg + \"]\",\n      \"this.stride=[\" + strideArg + \"]\",\n      \"this.offset=d|0}\",\n    \"var proto=\"+className+\".prototype\",\n    \"proto.dtype='\"+dtype+\"'\",\n    \"proto.dimension=\"+dimension)\n\n  //view.size:\n  code.push(\"Object.defineProperty(proto,'size',{get:function \"+className+\"_size(){\\\nreturn \"+indices.map(function(i) { return \"this.shape[\"+i+\"]\" }).join(\"*\"),\n\"}})\")\n\n  //view.order:\n  if(dimension === 1) {\n    code.push(\"proto.order=[0]\")\n  } else {\n    code.push(\"Object.defineProperty(proto,'order',{get:\")\n    if(dimension < 4) {\n      code.push(\"function \"+className+\"_order(){\")\n      if(dimension === 2) {\n        code.push(\"return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})\")\n      } else if(dimension === 3) {\n        code.push(\n\"var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);\\\nif(s0>s1){\\\nif(s1>s2){\\\nreturn [2,1,0];\\\n}else if(s0>s2){\\\nreturn [1,2,0];\\\n}else{\\\nreturn [1,0,2];\\\n}\\\n}else if(s0>s2){\\\nreturn [2,0,1];\\\n}else if(s2>s1){\\\nreturn [0,1,2];\\\n}else{\\\nreturn [0,2,1];\\\n}}})\")\n      }\n    } else {\n      code.push(\"ORDER})\")\n    }\n  }\n\n  //view.set(i0, ..., v):\n  code.push(\n\"proto.set=function \"+className+\"_set(\"+args.join(\",\")+\",v){\")\n  if(useGetters) {\n    code.push(\"return this.data.set(\"+index_str+\",v)}\")\n  } else {\n    code.push(\"return this.data[\"+index_str+\"]=v}\")\n  }\n\n  //view.get(i0, ...):\n  code.push(\"proto.get=function \"+className+\"_get(\"+args.join(\",\")+\"){\")\n  if(useGetters) {\n    code.push(\"return this.data.get(\"+index_str+\")}\")\n  } else {\n    code.push(\"return this.data[\"+index_str+\"]}\")\n  }\n\n  //view.index:\n  code.push(\n    \"proto.index=function \"+className+\"_index(\", args.join(), \"){return \"+index_str+\"}\")\n\n  //view.hi():\n  code.push(\"proto.hi=function \"+className+\"_hi(\"+args.join(\",\")+\"){return new \"+className+\"(this.data,\"+\n    indices.map(function(i) {\n      return [\"(typeof i\",i,\"!=='number'||i\",i,\"<0)?this.shape[\", i, \"]:i\", i,\"|0\"].join(\"\")\n    }).join(\",\")+\",\"+\n    indices.map(function(i) {\n      return \"this.stride[\"+i + \"]\"\n    }).join(\",\")+\",this.offset)}\")\n\n  //view.lo():\n  var a_vars = indices.map(function(i) { return \"a\"+i+\"=this.shape[\"+i+\"]\" })\n  var c_vars = indices.map(function(i) { return \"c\"+i+\"=this.stride[\"+i+\"]\" })\n  code.push(\"proto.lo=function \"+className+\"_lo(\"+args.join(\",\")+\"){var b=this.offset,d=0,\"+a_vars.join(\",\")+\",\"+c_vars.join(\",\"))\n  for(var i=0; i<dimension; ++i) {\n    code.push(\n\"if(typeof i\"+i+\"==='number'&&i\"+i+\">=0){\\\nd=i\"+i+\"|0;\\\nb+=c\"+i+\"*d;\\\na\"+i+\"-=d}\")\n  }\n  code.push(\"return new \"+className+\"(this.data,\"+\n    indices.map(function(i) {\n      return \"a\"+i\n    }).join(\",\")+\",\"+\n    indices.map(function(i) {\n      return \"c\"+i\n    }).join(\",\")+\",b)}\")\n\n  //view.step():\n  code.push(\"proto.step=function \"+className+\"_step(\"+args.join(\",\")+\"){var \"+\n    indices.map(function(i) {\n      return \"a\"+i+\"=this.shape[\"+i+\"]\"\n    }).join(\",\")+\",\"+\n    indices.map(function(i) {\n      return \"b\"+i+\"=this.stride[\"+i+\"]\"\n    }).join(\",\")+\",c=this.offset,d=0,ceil=Math.ceil\")\n  for(var i=0; i<dimension; ++i) {\n    code.push(\n\"if(typeof i\"+i+\"==='number'){\\\nd=i\"+i+\"|0;\\\nif(d<0){\\\nc+=b\"+i+\"*(a\"+i+\"-1);\\\na\"+i+\"=ceil(-a\"+i+\"/d)\\\n}else{\\\na\"+i+\"=ceil(a\"+i+\"/d)\\\n}\\\nb\"+i+\"*=d\\\n}\")\n  }\n  code.push(\"return new \"+className+\"(this.data,\"+\n    indices.map(function(i) {\n      return \"a\" + i\n    }).join(\",\")+\",\"+\n    indices.map(function(i) {\n      return \"b\" + i\n    }).join(\",\")+\",c)}\")\n\n  //view.transpose():\n  var tShape = new Array(dimension)\n  var tStride = new Array(dimension)\n  for(var i=0; i<dimension; ++i) {\n    tShape[i] = \"a[i\"+i+\"]\"\n    tStride[i] = \"b[i\"+i+\"]\"\n  }\n  code.push(\"proto.transpose=function \"+className+\"_transpose(\"+args+\"){\"+\n    args.map(function(n,idx) { return n + \"=(\" + n + \"===undefined?\" + idx + \":\" + n + \"|0)\"}).join(\";\"),\n    \"var a=this.shape,b=this.stride;return new \"+className+\"(this.data,\"+tShape.join(\",\")+\",\"+tStride.join(\",\")+\",this.offset)}\")\n\n  //view.pick():\n  code.push(\"proto.pick=function \"+className+\"_pick(\"+args+\"){var a=[],b=[],c=this.offset\")\n  for(var i=0; i<dimension; ++i) {\n    code.push(\"if(typeof i\"+i+\"==='number'&&i\"+i+\">=0){c=(c+this.stride[\"+i+\"]*i\"+i+\")|0}else{a.push(this.shape[\"+i+\"]);b.push(this.stride[\"+i+\"])}\")\n  }\n  code.push(\"var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}\")\n\n  //Add return statement\n  code.push(\"return function construct_\"+className+\"(data,shape,stride,offset){return new \"+className+\"(data,\"+\n    indices.map(function(i) {\n      return \"shape[\"+i+\"]\"\n    }).join(\",\")+\",\"+\n    indices.map(function(i) {\n      return \"stride[\"+i+\"]\"\n    }).join(\",\")+\",offset)}\")\n\n  //Compile procedure\n  var procedure = new Function(\"CTOR_LIST\", \"ORDER\", code.join(\"\\n\"))\n  return procedure(CACHED_CONSTRUCTORS[dtype], order)\n}\n\nfunction arrayDType(data) {\n  if(isBuffer(data)) {\n    return \"buffer\"\n  }\n  if(hasTypedArrays) {\n    switch(Object.prototype.toString.call(data)) {\n      case \"[object Float64Array]\":\n        return \"float64\"\n      case \"[object Float32Array]\":\n        return \"float32\"\n      case \"[object Int8Array]\":\n        return \"int8\"\n      case \"[object Int16Array]\":\n        return \"int16\"\n      case \"[object Int32Array]\":\n        return \"int32\"\n      case \"[object Uint8Array]\":\n        return \"uint8\"\n      case \"[object Uint16Array]\":\n        return \"uint16\"\n      case \"[object Uint32Array]\":\n        return \"uint32\"\n      case \"[object Uint8ClampedArray]\":\n        return \"uint8_clamped\"\n    }\n  }\n  if(Array.isArray(data)) {\n    return \"array\"\n  }\n  return \"generic\"\n}\n\nvar CACHED_CONSTRUCTORS = {\n  \"float32\":[],\n  \"float64\":[],\n  \"int8\":[],\n  \"int16\":[],\n  \"int32\":[],\n  \"uint8\":[],\n  \"uint16\":[],\n  \"uint32\":[],\n  \"array\":[],\n  \"uint8_clamped\":[],\n  \"buffer\":[],\n  \"generic\":[]\n}\n\n;(function() {\n  for(var id in CACHED_CONSTRUCTORS) {\n    CACHED_CONSTRUCTORS[id].push(compileConstructor(id, -1))\n  }\n});\n\nfunction wrappedNDArrayCtor(data, shape, stride, offset) {\n  if(data === undefined) {\n    var ctor = CACHED_CONSTRUCTORS.array[0]\n    return ctor([])\n  } else if(typeof data === \"number\") {\n    data = [data]\n  }\n  if(shape === undefined) {\n    shape = [ data.length ]\n  }\n  var d = shape.length\n  if(stride === undefined) {\n    stride = new Array(d)\n    for(var i=d-1, sz=1; i>=0; --i) {\n      stride[i] = sz\n      sz *= shape[i]\n    }\n  }\n  if(offset === undefined) {\n    offset = 0\n    for(var i=0; i<d; ++i) {\n      if(stride[i] < 0) {\n        offset -= (shape[i]-1)*stride[i]\n      }\n    }\n  }\n  var dtype = arrayDType(data)\n  var ctor_list = CACHED_CONSTRUCTORS[dtype]\n  while(ctor_list.length <= d+1) {\n    ctor_list.push(compileConstructor(dtype, ctor_list.length-1))\n  }\n  var ctor = ctor_list[d+1]\n  return ctor(data, shape, stride, offset)\n}\n\nmodule.exports = wrappedNDArrayCtor\n","(function (root, factory) {\n    if (typeof exports === 'object') {\n        module.exports = factory();\n    } else if (typeof define === 'function' && define.amd) {\n        define([], factory);\n    } else {\n        root.urltemplate = factory();\n    }\n}(this, function () {\n  /**\n   * @constructor\n   */\n  function UrlTemplate() {\n  }\n\n  /**\n   * @private\n   * @param {string} str\n   * @return {string}\n   */\n  UrlTemplate.prototype.encodeReserved = function (str) {\n    return str.split(/(%[0-9A-Fa-f]{2})/g).map(function (part) {\n      if (!/%[0-9A-Fa-f]/.test(part)) {\n        part = encodeURI(part).replace(/%5B/g, '[').replace(/%5D/g, ']');\n      }\n      return part;\n    }).join('');\n  };\n\n  /**\n   * @private\n   * @param {string} str\n   * @return {string}\n   */\n  UrlTemplate.prototype.encodeUnreserved = function (str) {\n    return encodeURIComponent(str).replace(/[!'()*]/g, function (c) {\n      return '%' + c.charCodeAt(0).toString(16).toUpperCase();\n    });\n  }\n\n  /**\n   * @private\n   * @param {string} operator\n   * @param {string} value\n   * @param {string} key\n   * @return {string}\n   */\n  UrlTemplate.prototype.encodeValue = function (operator, value, key) {\n    value = (operator === '+' || operator === '#') ? this.encodeReserved(value) : this.encodeUnreserved(value);\n\n    if (key) {\n      return this.encodeUnreserved(key) + '=' + value;\n    } else {\n      return value;\n    }\n  };\n\n  /**\n   * @private\n   * @param {*} value\n   * @return {boolean}\n   */\n  UrlTemplate.prototype.isDefined = function (value) {\n    return value !== undefined && value !== null;\n  };\n\n  /**\n   * @private\n   * @param {string}\n   * @return {boolean}\n   */\n  UrlTemplate.prototype.isKeyOperator = function (operator) {\n    return operator === ';' || operator === '&' || operator === '?';\n  };\n\n  /**\n   * @private\n   * @param {Object} context\n   * @param {string} operator\n   * @param {string} key\n   * @param {string} modifier\n   */\n  UrlTemplate.prototype.getValues = function (context, operator, key, modifier) {\n    var value = context[key],\n        result = [];\n\n    if (this.isDefined(value) && value !== '') {\n      if (typeof value === 'string' || typeof value === 'number' || typeof value === 'boolean') {\n        value = value.toString();\n\n        if (modifier && modifier !== '*') {\n          value = value.substring(0, parseInt(modifier, 10));\n        }\n\n        result.push(this.encodeValue(operator, value, this.isKeyOperator(operator) ? key : null));\n      } else {\n        if (modifier === '*') {\n          if (Array.isArray(value)) {\n            value.filter(this.isDefined).forEach(function (value) {\n              result.push(this.encodeValue(operator, value, this.isKeyOperator(operator) ? key : null));\n            }, this);\n          } else {\n            Object.keys(value).forEach(function (k) {\n              if (this.isDefined(value[k])) {\n                result.push(this.encodeValue(operator, value[k], k));\n              }\n            }, this);\n          }\n        } else {\n          var tmp = [];\n\n          if (Array.isArray(value)) {\n            value.filter(this.isDefined).forEach(function (value) {\n              tmp.push(this.encodeValue(operator, value));\n            }, this);\n          } else {\n            Object.keys(value).forEach(function (k) {\n              if (this.isDefined(value[k])) {\n                tmp.push(this.encodeUnreserved(k));\n                tmp.push(this.encodeValue(operator, value[k].toString()));\n              }\n            }, this);\n          }\n\n          if (this.isKeyOperator(operator)) {\n            result.push(this.encodeUnreserved(key) + '=' + tmp.join(','));\n          } else if (tmp.length !== 0) {\n            result.push(tmp.join(','));\n          }\n        }\n      }\n    } else {\n      if (operator === ';') {\n        if (this.isDefined(value)) {\n          result.push(this.encodeUnreserved(key));\n        }\n      } else if (value === '' && (operator === '&' || operator === '?')) {\n        result.push(this.encodeUnreserved(key) + '=');\n      } else if (value === '') {\n        result.push('');\n      }\n    }\n    return result;\n  };\n\n  /**\n   * @param {string} template\n   * @return {function(Object):string}\n   */\n  UrlTemplate.prototype.parse = function (template) {\n    var that = this;\n    var operators = ['+', '#', '.', '/', ';', '?', '&'];\n\n    return {\n      expand: function (context) {\n        return template.replace(/\\{([^\\{\\}]+)\\}|([^\\{\\}]+)/g, function (_, expression, literal) {\n          if (expression) {\n            var operator = null,\n                values = [];\n\n            if (operators.indexOf(expression.charAt(0)) !== -1) {\n              operator = expression.charAt(0);\n              expression = expression.substr(1);\n            }\n\n            expression.split(/,/g).forEach(function (variable) {\n              var tmp = /([^:\\*]*)(?::(\\d+)|(\\*))?/.exec(variable);\n              values.push.apply(values, that.getValues(context, operator, tmp[1], tmp[2] || tmp[3]));\n            });\n\n            if (operator && operator !== '+') {\n              var separator = ',';\n\n              if (operator === '?') {\n                separator = '&';\n              } else if (operator !== '#') {\n                separator = operator;\n              }\n              return (values.length !== 0 ? operator : '') + values.join(separator);\n            } else {\n              return values.join(',');\n            }\n          } else {\n            return that.encodeReserved(literal);\n          }\n        });\n      }\n    };\n  };\n\n  return new UrlTemplate();\n}));\n","export {DOMAIN, COVERAGE, COVERAGECOLLECTION} from 'covutils'\r\nexport const LINKRELPREFIX = 'http://www.iana.org/assignments/relation/'","export {minMax, indicesOfNearest, indexOfNearest} from 'covutils'\r\n\r\nconst PREFIX = 'https://covjson.org/def/'\r\nexport const CORE_PREFIX = PREFIX + 'core#'\r\nexport const DOMAINTYPES_PREFIX = PREFIX + 'domainTypes#'\r\n\r\n/**\r\n * @ignore\r\n */\r\nexport function assert (condition, message) {\r\n  if (!condition) {\r\n    message = message || 'Assertion failed'\r\n    throw new Error(message)\r\n  }\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\nexport function shallowcopy (obj) {\r\n  let copy = Object.create(Object.getPrototypeOf(obj))\r\n  for (let prop in obj) {\r\n    copy[prop] = obj[prop]\r\n  }\r\n  return copy\r\n}\r\n\r\n/**\r\n * Extracts all the directly included namespaces from the `@context` field,\r\n * not following remote JSON-LD contexts.\r\n * \r\n * @ignore\r\n * @param doc A JSON-LD document. \r\n * @returns {Map<string,string>} \r\n */\r\nexport function getNamespacePrefixes (doc) {\r\n  let context = doc['@context']\r\n  if (!context) {\r\n    return\r\n  }\r\n  if (!Array.isArray(context)) {\r\n    context = [context]\r\n  }\r\n  let prefixes = new Map()\r\n  for (let item of context) {\r\n    if (typeof item === 'string') {\r\n      continue\r\n    }\r\n    for (let key of Object.keys(item)) {\r\n      if (typeof item[key] === 'string') {\r\n        prefixes.set(key, item[key])\r\n      }\r\n    }\r\n  }\r\n  return prefixes\r\n}","export const MEDIATYPE = {\r\n  COVJSON: 'application/prs.coverage+json',\r\n  JSONLD: 'application/ld+json',\r\n  JSON: 'application/json',\r\n  TEXT: 'text/plain'\r\n}\r\n\r\nexport const EXT = {\r\n  COVJSON: '.covjson'\r\n}\r\n\r\nimport {CORE_PREFIX} from './util.js'\r\nexport const COVJSON_PROFILE_STANDALONE = CORE_PREFIX + 'standalone'\r\n\r\n/**\r\n * Returns an Accept header value for requesting CoverageJSON documents.\r\n * \r\n * @param {bool} standalone Whether to include the standalone profile of CoverageJSON or not.\r\n */\r\nexport function getAcceptHeader (standalone) {\r\n  let covjsonProfile = standalone ? '; profile=\"' + COVJSON_PROFILE_STANDALONE + '\"' : ''\r\n  let accept =\r\n    MEDIATYPE.COVJSON + covjsonProfile + '; q=1.0, ' + \r\n    MEDIATYPE.JSONLD + '; q=0.1, ' + \r\n    MEDIATYPE.JSON + '; q=0.1'\r\n  return accept\r\n}\r\n\r\n/**\r\n * Checks if a media type matches any given media types, ignoring any parameters. \r\n * \r\n * @param {string} mediaType The media type.\r\n * @param {string|Array} matchingMediaTypes The media type(s) to match against.\r\n * @return {bool} True if there is a match.\r\n */\r\nexport function matchesMediaTypes (mediaType, matchingMediaTypes) {\r\n  if (!Array.isArray(matchingMediaTypes)) {\r\n    matchingMediaTypes = [matchingMediaTypes]\r\n  }\r\n  return matchingMediaTypes.some(t => mediaType.indexOf(t) === 0)\r\n}\r\n","import {getAcceptHeader} from './http-common.js'\r\n\r\n/**\r\n * See reader.js#load for docs.\r\n * \r\n * Browser implementation.\r\n */\r\nexport function load (url, options = {}, responseType='arraybuffer') {\r\n  if (['arraybuffer', 'text'].indexOf(responseType) === -1) {\r\n    throw new Error()\r\n  }\r\n  let headers = options.headers || {}\r\n  return new Promise((resolve, reject) => {\r\n    var req = new XMLHttpRequest()\r\n    req.open('GET', url)\r\n    req.responseType = responseType\r\n    let accept = getAcceptHeader(options.eagerload)\r\n    req.setRequestHeader('Accept', accept)\r\n    if (headers) {\r\n      for (let header of Object.keys(headers)) {\r\n        req.setRequestHeader(header, headers[header])\r\n      }\r\n    }\r\n\r\n    req.addEventListener('load', () => {\r\n      try {\r\n        if (!(req.status >= 200 && req.status < 300 || req.status === 304)) { // as in jquery\r\n          reject(new Error('Resource \"' + url + '\" not found, HTTP status code: ' + req.status))\r\n          return\r\n        }\r\n        \r\n        let data\r\n        if (responseType === 'arraybuffer') {\r\n          if (window.TextDecoder) {\r\n            let t0 = new Date()\r\n            data = JSON.parse(new TextDecoder().decode(new DataView(req.response)))\r\n            console.log('JSON decoding: ' + (new Date()-t0) + 'ms')\r\n          } else {\r\n            // load again (from cache) to get correct response type\r\n            // Note we use 'text' and not 'json' as we want to throw parsing errors.\r\n            // With 'json', the response is just 'null'.\r\n            reject({responseType: 'text'})\r\n            return\r\n          }\r\n        } else {\r\n          let t0 = new Date()\r\n          data = JSON.parse(req.response)\r\n          console.log('JSON decoding (slow path): ' + (new Date()-t0) + 'ms')\r\n        }\r\n        let responseHeaders = parseResponseHeaders(req.getAllResponseHeaders())\r\n        resolve({\r\n          data,\r\n          headers: responseHeaders\r\n        })\r\n      } catch (e) {\r\n        reject(e)\r\n      }\r\n    })\r\n    req.addEventListener('error', () => {\r\n      reject(new Error('Network error loading resource at ' + url))\r\n    })\r\n\r\n    req.send()\r\n  }).catch(e => {\r\n    if (e.responseType) {\r\n      return load(url, headers, e.responseType)\r\n    } else {\r\n      throw e\r\n    }\r\n  })\r\n}\r\n\r\n/**\r\n * XmlHttpRequest's getAllResponseHeaders() method returns a string of response\r\n * headers according to the format described here:\r\n * http://www.w3.org/TR/XMLHttpRequest/#the-getallresponseheaders-method\r\n * This method parses that string into a user-friendly key/value pair object.\r\n * Header names are lower-cased.\r\n * \r\n * https://gist.github.com/monsur/706839\r\n */\r\nfunction parseResponseHeaders (headerStr) {\r\n  var headers = {};\r\n  if (!headerStr) {\r\n    return headers;\r\n  }\r\n  var headerPairs = headerStr.split('\\u000d\\u000a');\r\n  for (var i = 0; i < headerPairs.length; i++) {\r\n    var headerPair = headerPairs[i];\r\n    // Can't use split() here because it does the wrong thing\r\n    // if the header value has the string \": \" in it.\r\n    var index = headerPair.indexOf('\\u003a\\u0020');\r\n    if (index > 0) {\r\n      var key = headerPair.substring(0, index).toLowerCase();\r\n      var val = headerPair.substring(index + 2);\r\n      headers[key] = val;\r\n    }\r\n  }\r\n  return headers;\r\n}\r\n","var babelHelpers = {};\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) {\n  return typeof obj;\n} : function (obj) {\n  return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n};\n\nexport var jsx = function () {\n  var REACT_ELEMENT_TYPE = typeof Symbol === \"function\" && Symbol.for && Symbol.for(\"react.element\") || 0xeac7;\n  return function createRawReactElement(type, props, key, children) {\n    var defaultProps = type && type.defaultProps;\n    var childrenLength = arguments.length - 3;\n\n    if (!props && childrenLength !== 0) {\n      props = {};\n    }\n\n    if (props && defaultProps) {\n      for (var propName in defaultProps) {\n        if (props[propName] === void 0) {\n          props[propName] = defaultProps[propName];\n        }\n      }\n    } else if (!props) {\n      props = defaultProps || {};\n    }\n\n    if (childrenLength === 1) {\n      props.children = children;\n    } else if (childrenLength > 1) {\n      var childArray = Array(childrenLength);\n\n      for (var i = 0; i < childrenLength; i++) {\n        childArray[i] = arguments[i + 3];\n      }\n\n      props.children = childArray;\n    }\n\n    return {\n      $$typeof: REACT_ELEMENT_TYPE,\n      type: type,\n      key: key === undefined ? null : '' + key,\n      ref: null,\n      props: props,\n      _owner: null\n    };\n  };\n}();\n\nexport var asyncIterator = function (iterable) {\n  if (typeof Symbol === \"function\") {\n    if (Symbol.asyncIterator) {\n      var method = iterable[Symbol.asyncIterator];\n      if (method != null) return method.call(iterable);\n    }\n\n    if (Symbol.iterator) {\n      return iterable[Symbol.iterator]();\n    }\n  }\n\n  throw new TypeError(\"Object is not async iterable\");\n};\n\nexport var asyncGenerator = function () {\n  function AwaitValue(value) {\n    this.value = value;\n  }\n\n  function AsyncGenerator(gen) {\n    var front, back;\n\n    function send(key, arg) {\n      return new Promise(function (resolve, reject) {\n        var request = {\n          key: key,\n          arg: arg,\n          resolve: resolve,\n          reject: reject,\n          next: null\n        };\n\n        if (back) {\n          back = back.next = request;\n        } else {\n          front = back = request;\n          resume(key, arg);\n        }\n      });\n    }\n\n    function resume(key, arg) {\n      try {\n        var result = gen[key](arg);\n        var value = result.value;\n\n        if (value instanceof AwaitValue) {\n          Promise.resolve(value.value).then(function (arg) {\n            resume(\"next\", arg);\n          }, function (arg) {\n            resume(\"throw\", arg);\n          });\n        } else {\n          settle(result.done ? \"return\" : \"normal\", result.value);\n        }\n      } catch (err) {\n        settle(\"throw\", err);\n      }\n    }\n\n    function settle(type, value) {\n      switch (type) {\n        case \"return\":\n          front.resolve({\n            value: value,\n            done: true\n          });\n          break;\n\n        case \"throw\":\n          front.reject(value);\n          break;\n\n        default:\n          front.resolve({\n            value: value,\n            done: false\n          });\n          break;\n      }\n\n      front = front.next;\n\n      if (front) {\n        resume(front.key, front.arg);\n      } else {\n        back = null;\n      }\n    }\n\n    this._invoke = send;\n\n    if (typeof gen.return !== \"function\") {\n      this.return = undefined;\n    }\n  }\n\n  if (typeof Symbol === \"function\" && Symbol.asyncIterator) {\n    AsyncGenerator.prototype[Symbol.asyncIterator] = function () {\n      return this;\n    };\n  }\n\n  AsyncGenerator.prototype.next = function (arg) {\n    return this._invoke(\"next\", arg);\n  };\n\n  AsyncGenerator.prototype.throw = function (arg) {\n    return this._invoke(\"throw\", arg);\n  };\n\n  AsyncGenerator.prototype.return = function (arg) {\n    return this._invoke(\"return\", arg);\n  };\n\n  return {\n    wrap: function (fn) {\n      return function () {\n        return new AsyncGenerator(fn.apply(this, arguments));\n      };\n    },\n    await: function (value) {\n      return new AwaitValue(value);\n    }\n  };\n}();\n\nexport var asyncGeneratorDelegate = function (inner, awaitWrap) {\n  var iter = {},\n      waiting = false;\n\n  function pump(key, value) {\n    waiting = true;\n    value = new Promise(function (resolve) {\n      resolve(inner[key](value));\n    });\n    return {\n      done: false,\n      value: awaitWrap(value)\n    };\n  }\n\n  ;\n\n  if (typeof Symbol === \"function\" && Symbol.iterator) {\n    iter[Symbol.iterator] = function () {\n      return this;\n    };\n  }\n\n  iter.next = function (value) {\n    if (waiting) {\n      waiting = false;\n      return value;\n    }\n\n    return pump(\"next\", value);\n  };\n\n  if (typeof inner.throw === \"function\") {\n    iter.throw = function (value) {\n      if (waiting) {\n        waiting = false;\n        throw value;\n      }\n\n      return pump(\"throw\", value);\n    };\n  }\n\n  if (typeof inner.return === \"function\") {\n    iter.return = function (value) {\n      return pump(\"return\", value);\n    };\n  }\n\n  return iter;\n};\n\nexport var asyncToGenerator = function (fn) {\n  return function () {\n    var gen = fn.apply(this, arguments);\n    return new Promise(function (resolve, reject) {\n      function step(key, arg) {\n        try {\n          var info = gen[key](arg);\n          var value = info.value;\n        } catch (error) {\n          reject(error);\n          return;\n        }\n\n        if (info.done) {\n          resolve(value);\n        } else {\n          return Promise.resolve(value).then(function (value) {\n            step(\"next\", value);\n          }, function (err) {\n            step(\"throw\", err);\n          });\n        }\n      }\n\n      return step(\"next\");\n    });\n  };\n};\n\nexport var classCallCheck = function (instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n};\n\nexport var createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nexport var defineEnumerableProperties = function (obj, descs) {\n  for (var key in descs) {\n    var desc = descs[key];\n    desc.configurable = desc.enumerable = true;\n    if (\"value\" in desc) desc.writable = true;\n    Object.defineProperty(obj, key, desc);\n  }\n\n  return obj;\n};\n\nexport var defaults = function (obj, defaults) {\n  var keys = Object.getOwnPropertyNames(defaults);\n\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    var value = Object.getOwnPropertyDescriptor(defaults, key);\n\n    if (value && value.configurable && obj[key] === undefined) {\n      Object.defineProperty(obj, key, value);\n    }\n  }\n\n  return obj;\n};\n\nexport var defineProperty = function (obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n};\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nexport var get = function get(object, property, receiver) {\n  if (object === null) object = Function.prototype;\n  var desc = Object.getOwnPropertyDescriptor(object, property);\n\n  if (desc === undefined) {\n    var parent = Object.getPrototypeOf(object);\n\n    if (parent === null) {\n      return undefined;\n    } else {\n      return get(parent, property, receiver);\n    }\n  } else if (\"value\" in desc) {\n    return desc.value;\n  } else {\n    var getter = desc.get;\n\n    if (getter === undefined) {\n      return undefined;\n    }\n\n    return getter.call(receiver);\n  }\n};\n\nexport var inherits = function (subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n};\n\nvar _instanceof = function (left, right) {\n  if (right != null && typeof Symbol !== \"undefined\" && right[Symbol.hasInstance]) {\n    return right[Symbol.hasInstance](left);\n  } else {\n    return left instanceof right;\n  }\n};\n\nexport var interopRequireDefault = function (obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n};\n\nexport var interopRequireWildcard = function (obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  } else {\n    var newObj = {};\n\n    if (obj != null) {\n      for (var key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];\n      }\n    }\n\n    newObj.default = obj;\n    return newObj;\n  }\n};\n\nexport var newArrowCheck = function (innerThis, boundThis) {\n  if (innerThis !== boundThis) {\n    throw new TypeError(\"Cannot instantiate an arrow function\");\n  }\n};\n\nexport var objectDestructuringEmpty = function (obj) {\n  if (obj == null) throw new TypeError(\"Cannot destructure undefined\");\n};\n\nexport var objectWithoutProperties = function (obj, keys) {\n  var target = {};\n\n  for (var i in obj) {\n    if (keys.indexOf(i) >= 0) continue;\n    if (!Object.prototype.hasOwnProperty.call(obj, i)) continue;\n    target[i] = obj[i];\n  }\n\n  return target;\n};\n\nexport var possibleConstructorReturn = function (self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n};\n\nexport var selfGlobal = typeof global === \"undefined\" ? self : global;\n\nexport var set = function set(object, property, value, receiver) {\n  var desc = Object.getOwnPropertyDescriptor(object, property);\n\n  if (desc === undefined) {\n    var parent = Object.getPrototypeOf(object);\n\n    if (parent !== null) {\n      set(parent, property, value, receiver);\n    }\n  } else if (\"value\" in desc && desc.writable) {\n    desc.value = value;\n  } else {\n    var setter = desc.set;\n\n    if (setter !== undefined) {\n      setter.call(receiver, value);\n    }\n  }\n\n  return value;\n};\n\nexport var slicedToArray = function () {\n  function sliceIterator(arr, i) {\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _e = undefined;\n\n    try {\n      for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n        _arr.push(_s.value);\n\n        if (i && _arr.length === i) break;\n      }\n    } catch (err) {\n      _d = true;\n      _e = err;\n    } finally {\n      try {\n        if (!_n && _i[\"return\"]) _i[\"return\"]();\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n\n    return _arr;\n  }\n\n  return function (arr, i) {\n    if (Array.isArray(arr)) {\n      return arr;\n    } else if (Symbol.iterator in Object(arr)) {\n      return sliceIterator(arr, i);\n    } else {\n      throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n    }\n  };\n}();\n\nexport var slicedToArrayLoose = function (arr, i) {\n  if (Array.isArray(arr)) {\n    return arr;\n  } else if (Symbol.iterator in Object(arr)) {\n    var _arr = [];\n\n    for (var _iterator = arr[Symbol.iterator](), _step; !(_step = _iterator.next()).done;) {\n      _arr.push(_step.value);\n\n      if (i && _arr.length === i) break;\n    }\n\n    return _arr;\n  } else {\n    throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n  }\n};\n\nexport var taggedTemplateLiteral = function (strings, raw) {\n  return Object.freeze(Object.defineProperties(strings, {\n    raw: {\n      value: Object.freeze(raw)\n    }\n  }));\n};\n\nexport var taggedTemplateLiteralLoose = function (strings, raw) {\n  strings.raw = raw;\n  return strings;\n};\n\nexport var temporalRef = function (val, name, undef) {\n  if (val === undef) {\n    throw new ReferenceError(name + \" is not defined - temporal dead zone\");\n  } else {\n    return val;\n  }\n};\n\nexport var temporalUndefined = {};\n\nexport var toArray = function (arr) {\n  return Array.isArray(arr) ? arr : Array.from(arr);\n};\n\nexport var toConsumableArray = function (arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) arr2[i] = arr[i];\n\n    return arr2;\n  } else {\n    return Array.from(arr);\n  }\n};\n\nbabelHelpers;\n\nexport { _typeof as typeof, _extends as extends, _instanceof as instanceof }","/**\r\n * @external {Parameter} https://github.com/Reading-eScience-Centre/coverage-jsapi/blob/master/Parameter.md\r\n * @external {Domain} https://github.com/Reading-eScience-Centre/coverage-jsapi/blob/master/Domain.md\r\n * @external {Range} https://github.com/Reading-eScience-Centre/coverage-jsapi/blob/master/Range.md\r\n */\r\n\r\nimport ndarray from 'ndarray'\r\nimport template from 'url-template'\r\n\r\nimport {minMax, subsetDomainByIndex, subsetByValue as subsetCoverageByValue, normalizeIndexSubsetConstraints} from 'covutils'\r\n\r\nimport {COVERAGE} from './constants.js'\r\nimport {shallowcopy, getNamespacePrefixes, CORE_PREFIX, DOMAINTYPES_PREFIX} from './util.js'\r\n\r\n  \r\n  \r\n//NO FILE EXTENSION, to work around JSPM bug in handling package.json's \"browser\" field\r\n//see https://github.com/jspm/jspm-cli/issues/1062#issuecomment-170342414\r\nimport {load} from './http'\r\n\r\n/** \r\n * Wraps a CoverageJSON Coverage object as a Coverage API object.\r\n * \r\n * @see https://github.com/Reading-eScience-Centre/coverage-jsapi\r\n */\r\nexport default class Coverage {\r\n  \r\n  /**\r\n   * Create a Coverage instance.\r\n   * \r\n   * @param {Object} covjson A CoverageJSON Coverage object.\r\n   * @param {Object} [options] \r\n   * @param {boolean} [options.cacheRanges]\r\n   *   If true, then any range that was loaded remotely is cached.\r\n   *   (The domain is always cached.)\r\n   * @param {Array} [options.referencing]\r\n   *   Referencing info to use (e.g. from containing collection).                        \r\n   */\r\n  constructor (covjson, options) {\r\n    this._covjson = covjson\r\n    \r\n    /**\r\n     * The constant \"Coverage\".\r\n     * \r\n     * @type {string}\r\n     */\r\n    this.type = COVERAGE\r\n    \r\n    /**\r\n     * JSON-LD document\r\n     * \r\n     * @type {Object}\r\n     */\r\n    this.ld = {}\r\n    \r\n    this._exposeLd(covjson)\r\n    \r\n    this.prefixes = getNamespacePrefixes(this.ld)\r\n    \r\n    /**\r\n     * The options object that was passed in to the constructor. \r\n     * \r\n     * @type {Object} \r\n     */\r\n    this.options = options ? shallowcopy(options) : {}\r\n    \r\n    /** \r\n     * ID of the coverage.\r\n     * \r\n     * @type {string|undefined} \r\n     */\r\n    this.id = covjson.id\r\n    \r\n    /**\r\n     * A Map from key to {@link Parameter} object.\r\n     * The key is a short alias of a {@link Parameter}, typically what is called a \"variable name\" or similar.\r\n     * \r\n     * @type {Map<string,Parameter>}\r\n     */\r\n    this.parameters = new Map()\r\n    for (let key of Object.keys(covjson.parameters)) {\r\n      transformParameter(covjson.parameters, key)\r\n      this.parameters.set(key, covjson.parameters[key])\r\n    }\r\n            \r\n    let domainType\r\n    if (typeof this._covjson.domain === 'string') {\r\n      domainType = this._covjson.domainType\r\n    } else {\r\n      domainType = this._covjson.domain.domainType || this._covjson.domainType\r\n    }\r\n    if (domainType && domainType.indexOf(':') === -1) {\r\n      domainType = DOMAINTYPES_PREFIX + domainType\r\n    }\r\n\r\n    /**\r\n     * If defined, then the coverage has a domain that follows the given domain type,\r\n     * either a full URI or a namespace-prefixed term. (See .prefixes)\r\n     *  \r\n     * @type {string|undefined} \r\n     */\r\n    this.domainType = domainType\r\n    \r\n    this._updateLoadStatus()\r\n  }\r\n    \r\n  _updateLoadStatus () {\r\n    let isLoaded = prop => typeof prop === 'object' \r\n    let domainLoaded = isLoaded(this._covjson.domain)\r\n    let rangesLoaded = Object.keys(this._covjson.ranges).every(key => isLoaded(this._covjson.ranges[key]))\r\n    \r\n    /**\r\n     * A boolean which indicates whether all coverage data is already loaded in memory.\r\n     * If true then this typically means that calls to .loadDomain(), .loadRange(),\r\n     * .loadRanges(), .subsetByIndex(), and .subsetByValue() will not invoke a network request.\r\n     * \r\n     * @type {boolean}\r\n     */\r\n    this.loaded = domainLoaded && rangesLoaded\r\n  }\r\n  \r\n  _exposeLd (covjson) {\r\n    if (!covjson['@context']) {\r\n      // no LD love here...\r\n      return\r\n    }\r\n    // make a deep copy since the object gets modified in-place later\r\n    // but first, remove domain and range which may be embedded\r\n    let copy = shallowcopy(covjson)\r\n    delete copy.domain\r\n    delete copy.ranges\r\n    this.ld = JSON.parse(JSON.stringify(copy))\r\n  }\r\n    \r\n  /**\r\n   * Returns a Promise succeeding with a {@link Domain} object.\r\n   * \r\n   * @return {Promise<Domain>}\r\n   */\r\n  loadDomain () {\r\n    let domainOrUrl = this._covjson.domain\r\n    if (this._domainPromise) return this._domainPromise\r\n    let promise\r\n    if (typeof domainOrUrl === 'object') {\r\n      let domain = domainOrUrl\r\n      transformDomain(domain, this.options.referencing, this.domainType)\r\n      promise = Promise.resolve(domain)\r\n    } else {\r\n      let url = domainOrUrl\r\n      promise = load(url).then(result => {\r\n        let domain = result.data\r\n        transformDomain(domain, this.options.referencing, this.domainType)\r\n        this._covjson.domain = domain\r\n        this._updateLoadStatus()\r\n        return domain\r\n      })\r\n    }\r\n    /* The promise gets cached so that the domain is not loaded twice remotely.\r\n     * This might otherwise happen when loadDomain and loadRange is used\r\n     * with Promise.all(). Remember that loadRange also invokes loadDomain.\r\n     */ \r\n    this._domainPromise = promise\r\n    return promise\r\n  }\r\n  \r\n  /**\r\n   * Returns a Promise succeeding with a {@link Range} object.\r\n   * \r\n   * Note that this method implicitly loads the domain as well. \r\n   * \r\n   * @example\r\n   * cov.loadRange('salinity').then(function (sal) {\r\n   *   // work with Range object\r\n   * }).catch(function (e) {\r\n   *   // there was an error when loading the range\r\n   *   console.log(e.message)\r\n   * }) \r\n   * @param {string} paramKey The key of the Parameter for which to load the range.\r\n   * @return {Promise<Range>} A Promise object which loads the requested range data and succeeds with a Range object.\r\n   */\r\n  loadRange (paramKey) {\r\n    return loadRangeFn(this)(paramKey)\r\n  }\r\n  \r\n  /**\r\n   * Returns the requested range data as a Promise.\r\n   * \r\n   * Note that this method implicitly loads the domain as well. \r\n   * \r\n   * @example\r\n   * cov.loadRanges(['salinity','temp']).then(function (ranges) {\r\n   *   // work with Map object\r\n   *   console.log(ranges.get('salinity').values)\r\n   * }).catch(function (e) {\r\n   *   // there was an error when loading the range data\r\n   *   console.log(e)\r\n   * }) \r\n   * @param {iterable<string>} [paramKeys] An iterable of parameter keys for which to load the range data. If not given, loads all range data.\r\n   * @return {Promise<Map<string,Range>>} A Promise object which loads the requested range data and succeeds with a Map object.\r\n   */\r\n  loadRanges (paramKeys) {\r\n    return loadRangesFn(this)(paramKeys)\r\n  }\r\n  \r\n  /**\r\n   * Returns a Promise object which provides a copy of this Coverage object\r\n   * with the domain subsetted by the given indices specification.\r\n   * \r\n   * Note that the coverage type and/or domain type of the resulting coverage\r\n   * may be different than in the original coverage.\r\n   * \r\n   * Note that the subsetted ranges are a view over the original ranges, meaning\r\n   * that no copying is done but also no memory is released if the original\r\n   * coverage is garbage collected.\r\n   * \r\n   * @example\r\n   * cov.subsetByIndex({t: 4, z: {start: 10, stop: 20} }).then(function(subsetCov) {\r\n   *   // work with subsetted coverage\r\n   * })\r\n   * @param {Object} constraints An object which describes the subsetting constraints.\r\n   *   Every property of it refers to an axis name as defined in Domain.names,\r\n   *   and its value must either be an integer\r\n   *   or an object with start, stop, and optionally step (defaults to 1) properties\r\n   *   whose values are integers.\r\n   *   Properties that have the values undefined or null are ignored. \r\n   *   All integers must be non-negative, step must not be zero.\r\n   *   An integer constrains the axis to the given index,\r\n   *   a start/stop/step object to a range of indices:\r\n   *   If step=1, this includes all indices starting at start and ending at stop (exclusive);\r\n   *   if step>1, all indices start, start + step, ..., start + (q + r - 1) step where \r\n   *   q and r are the quotient and remainder obtained by dividing stop - start by step.\r\n   * @returns {Promise<Coverage>} A Promise object with the subsetted coverage object as result.\r\n   */\r\n  subsetByIndex (constraints) {\r\n    return subsetByIndexFn(this)(constraints)\r\n  }\r\n  \r\n  /**\r\n   * Returns a Promise object which provides a copy of this Coverage object\r\n   * with the domain subsetted by the given value specification.\r\n   * \r\n   * Note that the coverage type and/or domain type of the resulting coverage\r\n   * may be different than in the original coverage.\r\n   * \r\n   * Note that the subsetted ranges are a view over the original ranges, meaning\r\n   * that no copying is done but also no memory is released if the original\r\n   * coverage is garbage collected.\r\n   * \r\n   * @example\r\n   * cov.subsetByValue({\r\n   *   t: '2015-01-01T01:00:00',\r\n   *   z: {start: -10, stop: -5} \r\n   * }).then(function(subsetCov) {\r\n   *   // work with subsetted coverage\r\n   * })\r\n   * @example\r\n   * cov.subsetByValue({z: {target: -10} }).then(function(subsetCov) {\r\n   *   // work with subsetted coverage\r\n   * }\r\n   * @param {Object} constraints An object which describes the subsetting constraints.\r\n   *  Every property of it refers to an axis name as defined in Domain.names,\r\n   *  and its value must either be a number or string, or,\r\n   *  if the axis has an ordering relation, an object with start and stop properties\r\n   *  whose values are numbers or strings, or an object with a target property\r\n   *  whose value is a number or string.\r\n   *  Properties that have the values undefined or null are ignored.\r\n   *  A number or string constrains the axis to exactly the given value,\r\n   *  a start/stop object to the values intersecting the extent,\r\n   *  and a target object to the value closest to the given value.\r\n   * @returns {Promise<Coverage>} A Promise object with the subsetted coverage object as result.\r\n   */\r\n  subsetByValue (constraints) {\r\n    return subsetCoverageByValue(this, constraints)\r\n  }\r\n}\r\n\r\nfunction getRangeAxisOrder (domain, range) {\r\n  if (!domain) {\r\n    return range._axisNames\r\n  }\r\n  // backwards-compatibility, in the future the range always has an explicit axis ordering\r\n  let needsRangeAxisOrder = [...domain.axes.values()].filter(axis => axis.values.length > 1).length > 1\r\n  \r\n  // domain is checked for backwards-compatibility\r\n  let axisOrder = domain._rangeAxisOrder || range._axisNames\r\n  if (needsRangeAxisOrder && !axisOrder) {\r\n    throw new Error('Range axis order missing')\r\n  }\r\n  axisOrder = axisOrder || [...domain.axes.keys()]\r\n  return axisOrder\r\n}\r\n\r\nfunction getRangeShapeArray (domain, range) {\r\n  if (!domain) {\r\n    return range._shape\r\n  }\r\n  // mostly backwards-compatibility, in the future this just returns range._shape\r\n  let axisOrder = getRangeAxisOrder(domain, range)\r\n  let shape = axisOrder.map(k => domain.axes.get(k).values.length)\r\n  if (range._shape) {\r\n    let matchesDomain = range._shape.length === shape.length && range._shape.every((v,i) => v === shape[i])\r\n    if (!matchesDomain) {\r\n      throw new Error('range.shape must match domain axis sizes')\r\n    }\r\n  }\r\n  return shape\r\n}\r\n\r\nfunction loadRangesFn (cov) {\r\n  return paramKeys => {\r\n    if (paramKeys === undefined) paramKeys = cov.parameters.keys()\r\n    paramKeys = Array.from(paramKeys)\r\n    return Promise.all(paramKeys.map(k => cov.loadRange(k))).then(ranges => {\r\n      let map = new Map()\r\n      for (let i=0; i < paramKeys.length; i++) {\r\n        map.set(paramKeys[i], ranges[i])\r\n      }\r\n      return map\r\n    })\r\n  }\r\n}\r\n\r\nfunction loadRangeFn (cov, globalConstraints) {\r\n  return paramKey => {\r\n    // Since the shape of the range array is derived from the domain, it has to be loaded as well.\r\n    return cov.loadDomain().then(() => {\r\n      let rangeOrUrl = cov._covjson.ranges[paramKey]\r\n      if (typeof rangeOrUrl === 'object') {\r\n        let rawRange = rangeOrUrl\r\n        // we need the original domain here, not a potentially subsetted one,\r\n        // therefore we access cov._covjson directly\r\n        // this legacy code will disappear once the old range format is not supported anymore\r\n        return doLoadRange(cov, paramKey, rawRange, cov._covjson.domain, globalConstraints)\r\n      } else {\r\n        let url = rangeOrUrl\r\n        return load(url).then(result => {\r\n          let rawRange = result.data\r\n          return doLoadRange(cov, paramKey, rawRange, cov._covjson.domain, globalConstraints)\r\n        })\r\n      }\r\n    })\r\n  }\r\n}\r\n\r\nfunction doLoadRange (cov, paramKey, range, domain, globalConstraints={}) {\r\n  globalConstraints = normalizeIndexSubsetConstraints(domain, globalConstraints)\r\n  \r\n  if (range.type === 'NdArray' || range.type === 'Range') {\r\n    // if an NdArray, then we modify it in-place (only done the first time)\r\n    transformNdArrayRange(range, domain)\r\n    if (cov.options.cacheRanges) {\r\n      cov._covjson.ranges[paramKey] = range\r\n      cov._updateLoadStatus()\r\n    }\r\n    \r\n    let newrange = subsetNdArrayRangeByIndex(range, domain, globalConstraints)    \r\n    return Promise.resolve(newrange)\r\n    \r\n  } else if (range.type === 'TiledNdArray') {\r\n    return loadTiledNdArraySubset(range, globalConstraints)\r\n    \r\n  } else {\r\n    throw new Error('Unsupported: ' + range.type)\r\n  }\r\n}\r\n\r\n/**\r\n * \r\n * @param {object} range TiledNdArray range object\r\n * @param {object} constraints subsetting constraints\r\n * @returns {Promise<Range>}\r\n */\r\nfunction loadTiledNdArraySubset (range, constraints) {\r\n  let constraintsArr = range.axisNames.map(name => constraints[name])\r\n  \r\n  // step 1: select tileset with least network effort\r\n  let fillNulls = tileShape => tileShape.map((v,i) => v === null ? range.shape[i] : v)    \r\n  let tilesetsStats = range.tileSets.map(ts => getTilesetStats(fillNulls(ts.tileShape), constraintsArr))\r\n  let idxBestTileset = indexOfBestTileset(tilesetsStats)\r\n  let tileset = range.tileSets[idxBestTileset]\r\n  let urlTemplate = template.parse(tileset.urlTemplate)\r\n  let tileShape = fillNulls(tileset.tileShape)\r\n      \r\n  // step 2: determine the tiles to load\r\n  let subsetTilesetAxes = []\r\n  for (let ax=0; ax < tileShape.length; ax++) {\r\n    let {start,stop,step} = constraintsArr[ax]\r\n    let tileSize = tileShape[ax]\r\n    \r\n    // the indices of the first and last tile containing the subsetting constraints\r\n    let tileStart = Math.floor(start / tileSize) // inclusive\r\n    let tileStop = Math.ceil(stop / tileSize) // exclusive\r\n    \r\n    let tilesetAxis = []\r\n    for (let t=tileStart; t < tileStop; t++) {\r\n      let mid = (t + 0.5) * tileSize\r\n      // regard the subset constraint as a list of [x,y) half-closed intervals and find out where 'mid' falls into\r\n      let iv = Math.floor((mid - start) / step)\r\n      \r\n      // start and end point of the interval in range index space\r\n      let ivStart = start + iv * step\r\n      let ivStop = start + (iv + 1) * step\r\n      \r\n      // tile start and end in range index space\r\n      let tileStartR = t * tileSize\r\n      let tileStopR = (t + 1) * tileSize\r\n      \r\n      // check if the start or end point of the interval lies within the tile\r\n      if (ivStart >= tileStartR || tileStopR <= ivStop) {\r\n        tilesetAxis.push(t)\r\n      }\r\n    }\r\n    subsetTilesetAxes.push(tilesetAxis)\r\n  }\r\n  \r\n  let tiles = cartesianProduct(subsetTilesetAxes)\r\n  let subsetShape = constraintsArr.map(({start,stop,step}) => Math.floor((stop - start) / step) + (stop - start) % step)\r\n\r\n  function getTileUrl (tile) {\r\n      let tileUrlVars = {}\r\n      tile.forEach((v,i) => tileUrlVars[range.axisNames[i]] = v)\r\n      return urlTemplate.expand(tileUrlVars)\r\n  }\r\n  \r\n  // step 3a: check if only a single tile will be loaded and avoid copying data around in that case\r\n  if (tiles.length === 1 && subsetShape.every((v,i) => v === tileShape[i])) {\r\n    let url = getTileUrl(tiles[0])\r\n    return load(url).then(result => {\r\n      let tileRange = result.data\r\n      transformNdArrayRange(tileRange)\r\n      return tileRange\r\n    })\r\n  } else {\r\n    // step 3b: create an empty ndarray of the subset shape that will be filled with tile data\r\n    let subsetSize = subsetShape.reduce((l,r) => l*r)\r\n    let subsetNdArr = ndarray(new Array(subsetSize), subsetShape)\r\n    \r\n    // step 4: load tiles and fill subset ndarray\r\n    let promises = tiles.map(tile => {\r\n      let url = getTileUrl(tile)\r\n      return load(url).then(result => {\r\n        let tileRange = result.data\r\n        transformNdArrayRange(tileRange)\r\n        \r\n        // figure out which parts of the tile to copy into which part of the final ndarray\r\n        let tileOffsets = tile.map((v,i) => v * tileShape[i])\r\n        \r\n        // iterate all tile values and for each check if they are part of the subset\r\n        // TODO this code is probably quite slow, consider pre-compiling etc\r\n        //      -> use ndarray-ops#assign for fast copies\r\n        let tileAxesSubsetIndices = []\r\n        for (let ax=0; ax < tileShape.length; ax++) {\r\n          let {start,stop,step} = constraintsArr[ax]\r\n          let tileAxisSize = tileShape[ax]\r\n          let tileAxisOffset = tileOffsets[ax]\r\n          let tileAxisSubsetIndices = []\r\n          let startIdx = 0\r\n          if (tileAxisOffset < start) {\r\n            startIdx = start - tileAxisOffset\r\n          }\r\n          let stopIdx = tileAxisSize\r\n          if (tileAxisOffset + stopIdx > stop) {\r\n            stopIdx = stop - tileAxisOffset\r\n          }\r\n          \r\n          for (let i=startIdx; i < stopIdx; i++) {\r\n            let idx = tileAxisOffset + i\r\n            if ((idx - start) % step === 0) {\r\n              tileAxisSubsetIndices.push(i)\r\n            }\r\n          }\r\n          tileAxesSubsetIndices.push(tileAxisSubsetIndices)\r\n        }\r\n        let tileSubsetIndices = cartesianProduct(tileAxesSubsetIndices)\r\n        for (let tileInd of tileSubsetIndices) {\r\n          let val = tileRange._ndarr.get(...tileInd)\r\n          let subsetInd = tileInd.map((i,ax) => {\r\n            let idx = tileOffsets[ax] + i\r\n            return Math.floor((idx - constraintsArr[ax].start) / constraintsArr[ax].step)\r\n          })\r\n          subsetNdArr.set(...subsetInd, val)\r\n        }\r\n      })\r\n    })\r\n\r\n    // step 5: create and return the new range\r\n    return Promise.all(promises).then(() => {\r\n      let newrange = {\r\n        dataType: range.dataType,\r\n        get: createRangeGetFunction(subsetNdArr, range.axisNames),\r\n        _ndarr: subsetNdArr,\r\n        _axisNames: range.axisNames,\r\n        _shape: subsetShape\r\n      }\r\n      newrange.shape = new Map(range.axisNames.map((v,i) => [v, subsetNdArr.shape[i]]))\r\n      return newrange\r\n    })\r\n  } \r\n\r\n}\r\n\r\n/**\r\n * Return the cartesian product of the given arrays.\r\n * \r\n * @see http://stackoverflow.com/a/36234242\r\n */\r\nfunction cartesianProduct (arr) {\r\n  return arr.reduce((a,b) => a.map(x => b.map(y => x.concat(y))).reduce((a,b) => a.concat(b), []), [[]])\r\n}\r\n\r\n/**\r\n * Returns the number of tiles and values that have to be loaded, given a set of subsetting constraints.\r\n * \r\n * @param {Array<number>} tileShape\r\n * @param {Array<object>} constraints - start/stop/step subset constraints for each axis, stop is exclusive\r\n * @returns {number}\r\n */\r\nfunction getTilesetStats (tileShape, constraints) {\r\n  let tileCount = 1\r\n  for (let i=0; i < tileShape.length; i++) {\r\n    let {start, stop, step} = constraints[i]\r\n    let tileSize = tileShape[i]\r\n    \r\n    // the indices of the first and last tile containing the subsetting constraints\r\n    let tileStart = Math.floor(start / tileSize) // inclusive\r\n    let tileStop = Math.ceil(stop / tileSize) // exclusive\r\n    \r\n    // total number of values within the tiles containing the subsetting constraints\r\n    let nvalues = tileSize * (tileStop - tileStart)\r\n\r\n    // number of tiles that intersect with the subsetting constraints\r\n    tileCount *= Math.ceil(nvalues / (Math.max(step, tileSize)))\r\n  }\r\n  // the value count is an upper bound as it doesn't account for edge tiles that may be smaller\r\n  let valueCount = tileCount * tileShape.reduce((l,r) => l*r)\r\n  \r\n  return {tileCount, valueCount}\r\n}\r\n\r\n/**\r\n * Returns the index of the tileset with minimum network effort based on the given tileset statistics.\r\n * Effort here means a combination of number of requested tiles and values.\r\n * \r\n * @param {Array<object>} tilesetsStats\r\n * @returns {number} index of the tileset with minimum network effort\r\n */\r\nfunction indexOfBestTileset (tilesetsStats) {\r\n  // one tile request shall have an equal effort as receiving 1000 values\r\n  let tileValueRatio = 1000\r\n  let efforts = tilesetsStats.map(s => s.tileCount + s.valueCount / tileValueRatio)\r\n  let minEffortIdx = efforts.reduce((imin, x, i, arr) => x < arr[imin] ? i : imin, 0)\r\n  return minEffortIdx\r\n}\r\n\r\nfunction subsetNdArrayRangeByIndex (range, domain, constraints) {\r\n  let ndarr = range._ndarr\r\n        \r\n  // fast ndarray view\r\n  let axisNames = getRangeAxisOrder(domain, range)\r\n  let los = axisNames.map(name => constraints[name].start)\r\n  let his = axisNames.map(name => constraints[name].stop)\r\n  let steps = axisNames.map(name => constraints[name].step)\r\n  let newndarr = ndarr.hi(...his).lo(...los).step(...steps)\r\n  \r\n  let newrange = {\r\n    dataType: range.dataType,\r\n    get: createRangeGetFunction(newndarr, axisNames),\r\n    _ndarr: newndarr,\r\n    _axisNames: axisNames,\r\n    _shape: newndarr.shape\r\n  }\r\n  newrange.shape = new Map(axisNames.map((v,i) => [v, newndarr.shape[i]]))\r\n  return newrange\r\n}\r\n\r\nfunction subsetByIndexFn (cov, globalConstraints) {\r\n  return constraints => {\r\n    return cov.loadDomain().then(domain => {\r\n      constraints = normalizeIndexSubsetConstraints(domain, constraints)\r\n      let newdomain = subsetDomainByIndex(domain, constraints)\r\n      \r\n      let newGlobalConstraints = toGlobalSubsetConstraints(constraints, globalConstraints)\r\n      \r\n      // backwards-compatibility\r\n      if (domain._rangeAxisOrder) {\r\n        newdomain._rangeAxisOrder = domain._rangeAxisOrder\r\n      }\r\n      \r\n      // assemble everything to a new coverage\r\n      let newcov = {\r\n        _covjson: cov._covjson,\r\n        options: cov.options,\r\n        type: COVERAGE,\r\n        // TODO are the profiles still valid?\r\n        domainProfiles: cov.domainProfiles,\r\n        domainType: cov.domainType,\r\n        parameters: cov.parameters,\r\n        loadDomain: () => Promise.resolve(newdomain)\r\n      }\r\n      newcov.loadRange = loadRangeFn(newcov, newGlobalConstraints)\r\n      newcov.loadRanges = loadRangesFn(newcov)\r\n      newcov.subsetByIndex = subsetByIndexFn(newcov, newGlobalConstraints)\r\n      newcov.subsetByValue = subsetCoverageByValue.bind(null, newcov)\r\n      return newcov\r\n    })\r\n  }\r\n}\r\n\r\n/**\r\n * Currently unused, but may need in future.\r\n * This determines the best array type for categorical data which\r\n * doesn't have missing values.\r\n */\r\n/*\r\nfunction arrayType (validMin, validMax) {\r\n  let type\r\n  if (validMin !== undefined) {\r\n    if (validMin >= 0) {\r\n      if (validMax < Math.pow(2,8)) {\r\n        type = Uint8Array\r\n      } else if (validMax < Math.pow(2,16)) {\r\n        type = Uint16Array\r\n      } else if (validMax < Math.pow(2,32)) {\r\n        type = Uint32Array\r\n      } else {\r\n        type = Array\r\n      }\r\n    } else {\r\n      let max = Math.max(Math.abs(validMin), validMax)\r\n      if (max < Math.pow(2,8)) {\r\n        type = Int8Array\r\n      } else if (validMax < Math.pow(2,16)) {\r\n        type = Int16Array\r\n      } else if (validMax < Math.pow(2,32)) {\r\n        type = Int32Array\r\n      } else {\r\n        type = Array\r\n      }\r\n    }\r\n  } else {\r\n    type = Array\r\n  }\r\n  return type\r\n}\r\n*/\r\n\r\n/**\r\n * Transforms a CoverageJSON parameter to the Coverage API format, that is,\r\n * some elements are converted from objects to Maps. Transformation is made in-place.\r\n * \r\n * @param {Object} param The original parameter.\r\n * @access private\r\n */\r\nexport function transformParameter (params, key) {\r\n  if ('__transformDone' in params[key]) return\r\n  let param = params[key]\r\n  param.key = key\r\n  if (param.unit) {\r\n    if (typeof param.unit.symbol === 'string') {\r\n      param.unit.symbol = {\r\n        value: param.unit.symbol\r\n        // no type member, since the scheme is unknown\r\n      }\r\n    }\r\n  }\r\n  if (param.categoryEncoding) {\r\n    let map = new Map()\r\n    for (let category of Object.keys(param.categoryEncoding)) {\r\n      let vals = param.categoryEncoding[category]\r\n      if (!Array.isArray(vals)) {\r\n        vals = [vals]\r\n      }\r\n      map.set(category, vals)\r\n    }\r\n    param.categoryEncoding = map\r\n  }\r\n  param.__transformDone = true  \r\n}\r\n\r\n/**\r\n * Transforms a CoverageJSON NdArray range to the Coverage API format. Transformation is made in-place.\r\n * \r\n * @param {Object} range The original NdArray range.\r\n * @param {Object} [domain] The CoverageJSON domain object. \r\n * @return {Object} The transformed range.\r\n */\r\nfunction transformNdArrayRange (range, domain) {\r\n  if ('__transformDone' in range) return\r\n  \r\n  const values = range.values\r\n    \r\n  if (range.actualMin === undefined) {\r\n    let [min,max] = minMax(values)\r\n    if (min !== null) {\r\n      range.actualMin = min\r\n      range.actualMax = max\r\n    }\r\n  }\r\n  \r\n  // store the array as we will expose a Map on range.shape in the next step\r\n  if (range.shape) {\r\n    range._shape = range.shape\r\n  }\r\n  if (range.axisNames) {\r\n    // not part of public API\r\n    range._axisNames = range.axisNames\r\n    delete range.axisNames\r\n  }\r\n  \r\n  let axisNames = getRangeAxisOrder(domain, range)\r\n  let shapeArr = getRangeShapeArray(domain, range)\r\n  \r\n  let ndarr = ndarray(values, shapeArr)\r\n  range._ndarr = ndarr\r\n  range.get = createRangeGetFunction(ndarr, axisNames)\r\n  range.shape = new Map(axisNames.map((v,i) => [v, shapeArr[i]]))\r\n  \r\n  range.__transformDone = true  \r\n  return range\r\n}\r\n\r\n/**\r\n * \r\n * @param axisOrder An array of axis names.\r\n * @returns Function\r\n */\r\nfunction createRangeGetFunction (ndarr, axisOrder) {\r\n  // see below for slower reference version\r\n  let ndargs = ''\r\n  for (let i=0; i < axisOrder.length; i++) {\r\n    if (ndargs) ndargs += ','\r\n    ndargs += `'${axisOrder[i]}' in obj ? obj['${axisOrder[i]}'] : 0`\r\n  }\r\n  let fn = new Function('ndarr', `return function ndarrget (obj) { return ndarr.get(${ndargs}) }`)(ndarr)\r\n  return fn\r\n}\r\n\r\n/*\r\n * Reference version of createRangeGetFunction().\r\n * Around 50% slower (on Chrome 46) compared to precompiled version.\r\n * \r\nfunction createRangeGetFunction (ndarr, axisOrder) {\r\n  axisOrder = axisOrder.slice() // help the JIT (possibly..)\r\n  const axisCount = axisOrder.length\r\n  return obj => {\r\n    let indices = new Array(axisCount)\r\n    for (let i=0; i < axisCount; i++) {\r\n      indices[i] = axisOrder[i] in obj ? obj[axisOrder[i]] : 0\r\n    }\r\n    return ndarr.get(...indices)\r\n  }\r\n}\r\n*/\r\n\r\n/**\r\n * Transforms a CoverageJSON domain to the Coverage API format.\r\n * Transformation is made in-place.\r\n * \r\n * @param {Object} domain The original domain object.\r\n * @param {Array} [referencing] Referencing info to inject.\r\n * @return {Object} The transformed domain object.\r\n * @access private\r\n */\r\nexport function transformDomain (domain, referencing, domainType) {\r\n  if ('__transformDone' in domain) return\r\n  \r\n  domainType = domain.domainType || domainType\r\n  if (domainType && domainType.indexOf(':') === -1) {\r\n    domainType = DOMAINTYPES_PREFIX + domainType\r\n  }\r\n  domain.domainType = domainType\r\n\r\n  let axes = new Map() // axis name -> axis object\r\n  \r\n  for (let axisName of Object.keys(domain.axes)) {\r\n    axes.set(axisName, domain.axes[axisName])\r\n  }\r\n  domain.axes = axes\r\n  \r\n  // expand start/stop/num regular axes\r\n  // replace 1D numeric axis arrays with typed arrays for efficiency\r\n  for (let [key, axis] of axes) {\r\n    axis.key = key\r\n    \r\n    if (axis.dataType && axis.dataType.indexOf(':') === -1) {\r\n      axis.dataType = CORE_PREFIX + axis.dataType\r\n    }\r\n    \r\n    // TODO remove this if-block later, just here for backwards-compatibility \r\n    if (axis.components) {\r\n      axis.coordinates = axis.components\r\n    }\r\n    \r\n    if (!axis.coordinates) {\r\n      axis.coordinates = [key]\r\n    }\r\n    \r\n    // TODO remove this line later, just here for backwards-compatibility \r\n    axis.components = axis.coordinates\r\n    \r\n    \r\n    if ('start' in axis && 'stop' in axis && 'num' in axis) {\r\n      let arr = new Float64Array(axis.num)\r\n      let step\r\n      if (axis.num === 1) {\r\n        if (axis.start !== axis.stop) {\r\n          throw new Error('regular axis of length 1 must have equal start/stop values')\r\n        }\r\n        step = 0\r\n      } else {\r\n        step = (axis.stop - axis.start) / (axis.num - 1)\r\n      }\r\n      for (let i=0; i < axis.num; i++) {\r\n        arr[i] = axis.start + i * step\r\n      }\r\n      \r\n      axis.values = arr\r\n      delete axis.start\r\n      delete axis.stop\r\n      delete axis.num\r\n    }\r\n    \r\n    if (Array.isArray(axis.values) && typeof axis.values[0] === 'number') {\r\n      let arr = new Float64Array(axis.values.length)\r\n      for (let i=0; i < axis.values.length; i++) {\r\n        arr[i] = axis.values[i]\r\n      }\r\n      axis.values = arr\r\n    }\r\n    \r\n    axis.bounds = wrapBounds(axis)\r\n  }\r\n  \r\n  if (referencing) {\r\n    domain.referencing = referencing\r\n  }\r\n  \r\n  // TODO remove this later, just here for backwards-compatibility \r\n  for (let obj of domain.referencing) {\r\n    if (obj.components) {\r\n      obj.coordinates = obj.components\r\n    }\r\n  }\r\n  \r\n  if (domain.rangeAxisOrder) {\r\n    domain._rangeAxisOrder = domain.rangeAxisOrder\r\n    delete domain.rangeAxisOrder\r\n  }\r\n  \r\n  domain.__transformDone = true\r\n  \r\n  return domain\r\n}\r\n\r\n/**\r\n * Applies the local index subset constraints to the existing global constraints.\r\n * Both constraint objects must be normalized, that is, must contain the same axes\r\n * as start/stop/step objects.\r\n * \r\n * @example\r\n * var local = {x: {start: 0, stop: 50, step: 2}}\r\n * var global = {x: {start: 500, stop: 1000}}\r\n * var newGlobal = toGlobalSubsetConstraints(local, global)\r\n * // newGlobal == {x: {start: 500, stop: 550, step: 2}}\r\n * \r\n * @example\r\n * var local = {x: {start: 5, stop: 10, step: 2}} // 5, 7, 9\r\n * var global = {x: {start: 500, stop: 1000, step: 10}} // 500, 510, 520,...\r\n * var newGlobal = toGlobalSubsetConstraints(local, global) \r\n * // newGlobal == {x: {start: 550, stop: 600, step: 20}} // 550, 570, 590\r\n */\r\nfunction toGlobalSubsetConstraints (localConstraints, globalConstraints={}) {\r\n  let res = {}\r\n  for (let axis of Object.keys(localConstraints)) {\r\n    let local = localConstraints[axis]\r\n    let {start: globalStart=0, step: globalStep=1} = globalConstraints[axis] || {}\r\n    res[axis] = {\r\n      start: globalStart + globalStep*local.start,\r\n      stop: globalStart + globalStep*local.stop,\r\n      step: globalStep * local.step\r\n    }\r\n  }\r\n  return res\r\n}\r\n\r\nfunction wrapBounds (axis) {\r\n  if (axis.bounds) {\r\n    let bounds = axis.bounds\r\n    return {\r\n      get: i => [bounds[2*i], bounds[2*i + 1]]\r\n    }\r\n  }\r\n}\r\n","/**\r\n * @external {CollectionQuery} https://github.com/Reading-eScience-Centre/coverage-jsapi/blob/master/CoverageCollectionQuery.md\r\n */\r\n\r\nimport {COVERAGECOLLECTION} from './constants.js'\r\nimport {default as Coverage, transformDomain, transformParameter} from './Coverage.js'\r\nimport {shallowcopy, getNamespacePrefixes, DOMAINTYPES_PREFIX} from './util.js'\r\nimport {CollectionQuery} from 'covutils'\r\n\r\n/** \r\n * Wraps a CoverageJSON Collection object as a CoverageCollection API object.\r\n * \r\n * @see https://github.com/Reading-eScience-Centre/coverage-jsapi\r\n * \r\n */\r\nexport default class CoverageCollection {\r\n  /**\r\n   * @param {Object} covjson The CoverageJSON Collection document.\r\n   */\r\n  constructor(covjson) {\r\n    /**\r\n     * The constant \"CoverageCollection\".\r\n     * \r\n     * @type {string}\r\n     */\r\n    this.type = COVERAGECOLLECTION\r\n    \r\n    /**\r\n     * JSON-LD document\r\n     * \r\n     * @type {Object}\r\n     */\r\n    this.ld = {}\r\n    \r\n    this._exposeLd(covjson)\r\n    \r\n    this.prefixes = getNamespacePrefixes(this.ld)\r\n    \r\n    /** \r\n     * ID of the coverage collection.\r\n     * \r\n     * @type {string|undefined} \r\n     */\r\n    this.id = covjson.id\r\n    \r\n    \r\n    let domainType = covjson.domainType\r\n    if (domainType && domainType.indexOf(':') === -1) {\r\n      domainType = DOMAINTYPES_PREFIX + domainType\r\n    }\r\n\r\n    /**\r\n     * If defined, every coverage in the collection has the given domain type, typically a URI.\r\n     * \r\n     * @type {string|undefined}\r\n     */\r\n    this.domainType = domainType\r\n    \r\n    \r\n    let covs = []\r\n    let rootParams = covjson.parameters ? covjson.parameters : {}\r\n    // generate local parameter IDs if not existing\r\n    // this is to keep track of same parameters when copied into the coverages\r\n    // (e.g. to synchronize legends etc.)\r\n    for (let key of Object.keys(rootParams)) {\r\n      let param = rootParams[key]\r\n      if (!param.id) {\r\n        param.id = Math.round(new Date().getTime() * Math.random()).toString()\r\n      }\r\n    }\r\n    \r\n    let covOptions = {}\r\n    if (covjson.referencing) {\r\n      covOptions.referencing = covjson.referencing\r\n    }\r\n    for (let coverage of covjson.coverages) {\r\n      if (!coverage.domainType) {\r\n        coverage.domainType = domainType\r\n      }\r\n      if (!coverage.parameters) {\r\n        coverage.parameters = {}\r\n      }\r\n      for (let key of Object.keys(rootParams)) {\r\n        if (key in coverage.ranges) {\r\n          coverage.parameters[key] = rootParams[key]\r\n        }\r\n      }\r\n      if (covjson['@context']) {\r\n        coverage['@context'] = covjson['@context']\r\n      }\r\n      covs.push(new Coverage(coverage, covOptions))\r\n    }\r\n    \r\n    /** \r\n     * The Coverages of this collection.\r\n     * \r\n     * @type {Array<Coverage>} \r\n     */\r\n    this.coverages = covs\r\n    if (covjson.parameters) {\r\n      /**\r\n       * A Map from key to {@link Parameter} object.\r\n       * The key is a short alias of a {@link Parameter}, typically what is called a \"variable name\" or similar.\r\n       * \r\n       * @type {Map<string,Parameter>}\r\n       */\r\n      this.parameters = new Map()\r\n      for (let key of Object.keys(covjson.parameters)) {\r\n        transformParameter(covjson.parameters, key)\r\n        this.parameters.set(key, covjson.parameters[key])\r\n      }\r\n    }\r\n    if (covjson.domainTemplate) {\r\n      transformDomain(covjson.domainTemplate)\r\n      /**\r\n       * @ignore\r\n       */\r\n      this.domainTemplate = covjson.domainTemplate\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * \r\n   * @return {CollectionQuery}\r\n   */\r\n  query () {\r\n    return new CollectionQuery(this)\r\n  }\r\n  \r\n  _exposeLd (covjson) {\r\n    if (!covjson['@context']) {\r\n      // no LD love here...\r\n      return\r\n    }\r\n    // make a deep copy since the object gets modified in-place later\r\n    // but first, remove the coverages (those have their own .ld property)\r\n    let copy = shallowcopy(covjson)\r\n    delete copy.coverages\r\n    this.ld = JSON.parse(JSON.stringify(copy))\r\n  }\r\n}\r\n","import Coverage from './Coverage.js'\r\nimport {transformDomain} from './Coverage.js'\r\nimport CoverageCollection from './CoverageCollection.js'\r\nimport {assert} from './util.js'\r\nimport {COVERAGE, COVERAGECOLLECTION, DOMAIN, LINKRELPREFIX} from './constants.js'\r\n\r\n// NO FILE EXTENSION, to work around JSPM bug in handling package.json's \"browser\" field\r\n// see https://github.com/jspm/jspm-cli/issues/1062#issuecomment-170342414\r\nimport * as http from './http'\r\n\r\n/**\r\n * Loads a CoverageJSON document from a given URL and returns a {@link Promise} object\r\n * that succeeds with the unmodified CoverageJSON object.\r\n * \r\n * @param {string} url The URL to load the CoverageJSON document from.\r\n * @param {Object} [options] An options object. \r\n * @param {Object} [options.headers] Additional HTTP headers to send if input is a URL.\r\n * @param {Object} [options.eagerload]\r\n *   Request a stand-alone CoverageJSON document (with domain and ranges embedded) if input is a URL.\r\n *   Note that the server may ignore that preference.\r\n * @return {Promise}\r\n *   A Promise succeeding with an object <code>{data, headers}</code> where data is the CoverageJSON object\r\n *   and headers are the HTTP response headers with lower-cased header names as object keys.\r\n *   The promise fails if the resource at the given URL is not a valid JSON or CBOR document. \r\n */\r\nexport function load (url, options) {\r\n  return http.load(url, options)\r\n}\r\n\r\n/**\r\n * Reads a CoverageJSON document and returns a {@link Promise} that succeeds with\r\n * a Domain, {@link Coverage}, or {@link CoverageCollection} object.\r\n * \r\n * Note that if the document references external domain or range documents,\r\n * then these are not loaded immediately. \r\n * \r\n * \r\n * @example\r\n * CovJSON.read('http://example.com/coverage.covjson').then(function (cov) {\r\n *   // work with Coverage data object\r\n * }).catch(function (e) {\r\n *   // there was an error when loading the coverage data\r\n *   console.log(e)\r\n * })\r\n * @param {Object|string} input \r\n *    A CoverageJSON Domain, Coverage, or Coverage Collection document, as URL or object.\r\n * @param {Object} [options]\r\n *   An options object. \r\n * @param {Object} [options.headers]\r\n *   Additional HTTP headers to send if input is a URL.\r\n * @param {Object} [options.eagerload]\r\n *   Request a stand-alone CoverageJSON document (with domain and ranges embedded) if input is a URL.\r\n *   Note that the server may ignore that preference. \r\n * @return {Promise} \r\n *    A promise object succeeding with a Domain, {@link Coverage}, or {@link CoverageCollection} object,\r\n *    and failing with an {@link Error} object.\r\n */\r\nexport function read (input, options = {}) {\r\n  if (typeof input === 'object') {\r\n    return Promise.resolve().then(() => transformCovJSON(input))\r\n  } else {\r\n    return load(input, options).then(({data,headers}) => transformCovJSON(data, headers))\r\n  }\r\n}\r\n\r\n/**\r\n * Transforms a CoverageJSON object into one or more Coverage objects.\r\n *  \r\n * @param {object} obj A CoverageJSON object of type Coverage or CoverageCollection.\r\n * @param {array} headers An optional array of HTTP headers. Keys are lower-cased header names.\r\n * @return {Coverage|Array of Coverage}\r\n */\r\nfunction transformCovJSON (obj, headers) {\r\n  checkValidCovJSON(obj)\r\n  if ([COVERAGE, COVERAGECOLLECTION, DOMAIN].indexOf(obj.type) === -1) {\r\n    throw new Error('CoverageJSON document must be of Coverage, CoverageCollection, or Domain type')\r\n  }\r\n  \r\n  let result\r\n  if (obj.type === DOMAIN) {\r\n    transformDomain(obj)\r\n    result = obj\r\n  } else  if (obj.type === COVERAGE) {\r\n    result = new Coverage(obj)\r\n  } else {\r\n    result = new CoverageCollection(obj)\r\n  }\r\n  \r\n  if (obj.type === COVERAGE || obj.type === COVERAGECOLLECTION) {\r\n    addLinkRelations(result, headers)\r\n  }\r\n    \r\n  return result\r\n}\r\n\r\n/**\r\n * Scans the supplied HTTP headers for Link relations and adds them\r\n * to the .ld property of the Coverage/CoverageCollection.\r\n */    \r\nfunction addLinkRelations (cov, headers) {  \r\n  if (!headers || !headers['link']) {\r\n    return\r\n  }\r\n  \r\n  let ld = cov.ld\r\n  \r\n  for (let link of headers['link'].split(',')) {\r\n    link = link.trim()\r\n    // FIXME this will fail if the URL contains a \";\" which is valid (see RFC5988)\r\n    let parts = link.split(';')\r\n    let url = parts[0].substr(1, parts[0].length-2)\r\n    for (let param of parts.slice(1)) {\r\n      let relStart = param.indexOf('rel=')\r\n      if (relStart === -1) {\r\n        continue\r\n      }\r\n      let rel = param.substring(relStart+5, param.length-1)\r\n      if (!rel.startsWith('http://') && !rel.startsWith('https://')) {\r\n        rel = LINKRELPREFIX + rel\r\n      }\r\n      if (ld[rel]) {\r\n        if (Array.isArray(ld[rel])) {\r\n          ld[rel].push(url)\r\n        } else {\r\n          ld[rel] = [ld[rel], url]\r\n        }\r\n      } else {\r\n        ld[rel] = url\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Performs basic structural checks to validate whether a given object is a CoverageJSON object.\r\n * \r\n * Note that this method is not comprehensive and should not be used for checking\r\n * whether an object fully conforms to the CoverageJSON specification.\r\n * \r\n * @param obj\r\n * @throws {Error} when obj is not a valid CoverageJSON document \r\n */\r\nfunction checkValidCovJSON (obj) {\r\n  assert('type' in obj, '\"type\" missing')\r\n  if (obj.type === COVERAGE) {\r\n    assert('parameters' in obj, '\"parameters\" missing')\r\n    assert('domain' in obj, '\"domain\" missing')\r\n    assert('ranges' in obj, '\"ranges\" missing')\r\n  } else if (obj.type === COVERAGECOLLECTION) {\r\n    assert(Array.isArray(obj.coverages), '\"coverages\" must be an array')\r\n  }\r\n}\r\n"],"names":["commonjsHelpers.interopDefault","this","LINKRELPREFIX","PREFIX","CORE_PREFIX","DOMAINTYPES_PREFIX","assert","condition","message","Error","shallowcopy","obj","copy","Object","create","getPrototypeOf","prop","getNamespacePrefixes","doc","context","Array","isArray","prefixes","Map","item","keys","key","set","MEDIATYPE","COVJSON","JSONLD","JSON","TEXT","COVJSON_PROFILE_STANDALONE","getAcceptHeader","standalone","covjsonProfile","accept","load","url","options","responseType","indexOf","headers","Promise","resolve","reject","req","XMLHttpRequest","open","eagerload","setRequestHeader","header","addEventListener","status","data","window","TextDecoder","t0","Date","parse","decode","DataView","response","console","log","responseHeaders","parseResponseHeaders","getAllResponseHeaders","e","send","catch","headerStr","headerPairs","split","i","length","headerPair","index","substring","toLowerCase","val","Coverage","covjson","_covjson","type","COVERAGE","ld","_exposeLd","id","parameters","transformParameter","domainType","domain","_updateLoadStatus","isLoaded","domainLoaded","rangesLoaded","ranges","every","loaded","stringify","domainOrUrl","_domainPromise","promise","transformDomain","referencing","then","result","paramKey","loadRangeFn","paramKeys","loadRangesFn","constraints","subsetByIndexFn","subsetCoverageByValue","getRangeAxisOrder","range","_axisNames","needsRangeAxisOrder","axes","values","filter","axis","axisOrder","_rangeAxisOrder","getRangeShapeArray","_shape","shape","map","get","k","matchesDomain","v","cov","undefined","from","all","loadRange","globalConstraints","loadDomain","rangeOrUrl","rawRange","doLoadRange","normalizeIndexSubsetConstraints","transformNdArrayRange","cacheRanges","newrange","subsetNdArrayRangeByIndex","loadTiledNdArraySubset","constraintsArr","axisNames","name","fillNulls","tileShape","tilesetsStats","tileSets","getTilesetStats","ts","idxBestTileset","indexOfBestTileset","tileset","urlTemplate","template","subsetTilesetAxes","ax","start","stop","step","tileSize","tileStart","Math","floor","tileStop","ceil","tilesetAxis","t","mid","iv","ivStart","ivStop","tileStartR","tileStopR","push","tiles","cartesianProduct","subsetShape","getTileUrl","tile","tileUrlVars","forEach","expand","tileRange","subsetSize","reduce","l","r","subsetNdArr","ndarray","promises","tileOffsets","tileAxesSubsetIndices","tileAxisSize","tileAxisOffset","tileAxisSubsetIndices","startIdx","stopIdx","idx","tileSubsetIndices","tileInd","_ndarr","subsetInd","dataType","createRangeGetFunction","arr","a","b","x","concat","y","tileCount","nvalues","max","valueCount","tileValueRatio","efforts","s","minEffortIdx","imin","ndarr","los","his","steps","newndarr","hi","lo","newdomain","subsetDomainByIndex","newGlobalConstraints","toGlobalSubsetConstraints","newcov","domainProfiles","loadRanges","subsetByIndex","subsetByValue","bind","params","param","unit","symbol","value","categoryEncoding","category","vals","__transformDone","actualMin","minMax","min","actualMax","shapeArr","ndargs","fn","Function","axisName","components","coordinates","Float64Array","num","bounds","wrapBounds","rangeAxisOrder","localConstraints","res","local","globalStart","globalStep","CoverageCollection","COVERAGECOLLECTION","covs","rootParams","round","getTime","random","toString","covOptions","coverages","coverage","domainTemplate","CollectionQuery","http","read","input","transformCovJSON","checkValidCovJSON","DOMAIN","addLinkRelations","link","trim","parts","substr","slice","relStart","rel","startsWith"],"mappings":"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"}