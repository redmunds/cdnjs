!function(t,e){"use strict";function r(t){return t&&"object"==typeof t&&"default"in t?t.default:t}function n(t,e){return e={exports:{}},t(e,e.exports),e.exports}function o(t,e){if(!t)throw e=e||"Assertion failed",new Error(e)}function a(t){var e=Object.create(Object.getPrototypeOf(t));for(var r in t)e[r]=t[r];return e}function i(t){var e=t["@context"];if(e){Array.isArray(e)||(e=[e]);var r=new Map,n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var u=i.value;if("string"!=typeof u){var f=!0,c=!1,p=void 0;try{for(var d,l=Object.keys(u)[Symbol.iterator]();!(f=(d=l.next()).done);f=!0){var h=d.value;"string"==typeof u[h]&&r.set(h,u[h])}}catch(t){c=!0,p=t}finally{try{!f&&l.return&&l.return()}finally{if(c)throw p}}}}}catch(t){o=!0,a=t}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}}function s(t){var e=t?'; profile="'+W+'"':"",r=K.COVJSON+e+"; q=1.0, "+K.JSONLD+"; q=0.1, "+K.JSON+"; q=0.1";return r}function u(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"arraybuffer";if(["arraybuffer","text"].indexOf(r)===-1)throw new Error;var n=e.headers||{};return new Promise(function(o,a){var i=new XMLHttpRequest;i.open("GET",t),i.responseType=r;var u=s(e.eagerload);if(i.setRequestHeader("Accept",u),n){var c=!0,p=!1,d=void 0;try{for(var l,h=Object.keys(n)[Symbol.iterator]();!(c=(l=h.next()).done);c=!0){var v=l.value;i.setRequestHeader(v,n[v])}}catch(t){p=!0,d=t}finally{try{!c&&h.return&&h.return()}finally{if(p)throw d}}}i.addEventListener("load",function(){try{if(!(i.status>=200&&i.status<300||304===i.status))return void a(new Error('Resource "'+t+'" not found, HTTP status code: '+i.status));var e=void 0;if("arraybuffer"===r){if(!window.TextDecoder)return void a({responseType:"text"});var n=new Date;e=JSON.parse((new TextDecoder).decode(new DataView(i.response))),console.log("JSON decoding: "+(new Date-n)+"ms")}else{var s=new Date;e=JSON.parse(i.response),console.log("JSON decoding (slow path): "+(new Date-s)+"ms")}var u=f(i.getAllResponseHeaders());o({data:e,headers:u})}catch(t){a(t)}}),i.addEventListener("error",function(){a(new Error("Network error loading resource at "+t))}),i.send()}).catch(function(e){if(e.responseType)return u(t,n,e.responseType);throw e})}function f(t){var e={};if(!t)return e;for(var r=t.split("\r\n"),n=0;n<r.length;n++){var o=r[n],a=o.indexOf(": ");if(a>0){var i=o.substring(0,a).toLowerCase(),s=o.substring(a+2);e[i]=s}}return e}function c(t,e){if(!t)return e._axisNames;var r=[].concat($(t.axes.values())).filter(function(t){return t.values.length>1}).length>1,n=t._rangeAxisOrder||e._axisNames;if(r&&!n)throw new Error("Range axis order missing");return n=n||[].concat($(t.axes.keys()))}function p(t,e){if(!t)return e._shape;var r=c(t,e),n=r.map(function(e){return t.axes.get(e).values.length});if(e._shape){var o=e._shape.length===n.length&&e._shape.every(function(t,e){return t===n[e]});if(!o)throw new Error("range.shape must match domain axis sizes")}return n}function d(t){return function(e){return void 0===e&&(e=t.parameters.keys()),e=Array.from(e),Promise.all(e.map(function(e){return t.loadRange(e)})).then(function(t){for(var r=new Map,n=0;n<e.length;n++)r.set(e[n],t[n]);return r})}}function l(t,e){return function(r){return t.loadDomain().then(function(){var n=t._covjson.ranges[r];if("object"===("undefined"==typeof n?"undefined":X(n))){var o=n;return h(t,r,o,t._covjson.domain,e)}var a=n;return u(a).then(function(n){var o=n.data;return h(t,r,o,t._covjson.domain,e)})})}}function h(t,r,n,o){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};if(a=e.normalizeIndexSubsetConstraints(o,a),"NdArray"===n.type||"Range"===n.type){j(n,o),t.options.cacheRanges&&(t._covjson.ranges[r]=n,t._updateLoadStatus());var i=b(n,o,a);return Promise.resolve(i)}if("TiledNdArray"===n.type)return v(n,a);throw new Error("Unsupported: "+n.type)}function v(t,e){function r(e){var r={};return e.forEach(function(e,n){return r[t.axisNames[n]]=e}),f.expand(r)}for(var n=t.axisNames.map(function(t){return e[t]}),o=function(e){return e.map(function(e,r){return null===e?t.shape[r]:e})},a=t.tileSets.map(function(t){return m(o(t.tileShape),n)}),i=g(a),s=t.tileSets[i],f=B.parse(s.urlTemplate),c=o(s.tileShape),p=[],d=0;d<c.length;d++){for(var l=n[d],h=l.start,v=l.stop,b=l.step,w=c[d],x=Math.floor(h/w),O=Math.ceil(v/w),A=[],S=x;S<O;S++){var T=(S+.5)*w,E=Math.floor((T-h)/b),k=h+E*b,C=h+(E+1)*b,N=S*w,D=(S+1)*w;(k>=N||D<=C)&&A.push(S)}p.push(A)}var M=y(p),R=n.map(function(t){var e=t.start,r=t.stop,n=t.step;return Math.floor((r-e)/n)+(r-e)%n});if(1===M.length&&R.every(function(t,e){return t===c[e]})){var V=r(M[0]);return u(V).then(function(t){var e=t.data;return j(e),e})}var L=function(){var e=R.reduce(function(t,e){return t*e}),o=U(new Array(e),R),a=M.map(function(t){var e=r(t);return u(e).then(function(e){var r=e.data;j(r);for(var a=t.map(function(t,e){return t*c[e]}),i=[],s=0;s<c.length;s++){var u=n[s],f=u.start,p=u.stop,d=u.step,l=c[s],h=a[s],v=[],m=0;h<f&&(m=f-h);var g=l;h+g>p&&(g=p-h);for(var b=m;b<g;b++){var w=h+b;(w-f)%d===0&&v.push(b)}i.push(v)}var x=y(i),_=!0,O=!1,A=void 0;try{for(var S,T=x[Symbol.iterator]();!(_=(S=T.next()).done);_=!0){var E,k=S.value,C=(E=r._ndarr).get.apply(E,$(k)),N=k.map(function(t,e){var r=a[e]+t;return Math.floor((r-n[e].start)/n[e].step)});o.set.apply(o,$(N).concat([C]))}}catch(t){O=!0,A=t}finally{try{!_&&T.return&&T.return()}finally{if(O)throw A}}})});return{v:Promise.all(a).then(function(){var e={dataType:t.dataType,get:_(o,t.axisNames),_ndarr:o,_axisNames:t.axisNames,_shape:R};return e.shape=new Map(t.axisNames.map(function(t,e){return[t,o.shape[e]]})),e})}}();if("object"===("undefined"==typeof L?"undefined":X(L)))return L.v}function y(t){return t.reduce(function(t,e){return t.map(function(t){return e.map(function(e){return t.concat(e)})}).reduce(function(t,e){return t.concat(e)},[])},[[]])}function m(t,e){for(var r=1,n=0;n<t.length;n++){var o=e[n],a=o.start,i=o.stop,s=o.step,u=t[n],f=Math.floor(a/u),c=Math.ceil(i/u),p=u*(c-f);r*=Math.ceil(p/Math.max(s,u))}var d=r*t.reduce(function(t,e){return t*e});return{tileCount:r,valueCount:d}}function g(t){var e=1e3,r=t.map(function(t){return t.tileCount+t.valueCount/e}),n=r.reduce(function(t,e,r,n){return e<n[t]?r:t},0);return n}function b(t,e,r){var n,o,a=t._ndarr,i=c(e,t),s=i.map(function(t){return r[t].start}),u=i.map(function(t){return r[t].stop}),f=i.map(function(t){return r[t].step}),p=(n=(o=a.hi.apply(a,$(u))).lo.apply(o,$(s))).step.apply(n,$(f)),d={dataType:t.dataType,get:_(p,i),_ndarr:p,_axisNames:i,_shape:p.shape};return d.shape=new Map(i.map(function(t,e){return[t,p.shape[e]]})),d}function w(t,r){return function(n){return t.loadDomain().then(function(o){n=e.normalizeIndexSubsetConstraints(o,n);var a=e.subsetDomainByIndex(o,n),i=A(n,r);o._rangeAxisOrder&&(a._rangeAxisOrder=o._rangeAxisOrder);var s={_covjson:t._covjson,options:t.options,type:e.COVERAGE,domainProfiles:t.domainProfiles,domainType:t.domainType,parameters:t.parameters,loadDomain:function(){return Promise.resolve(a)}};return s.loadRange=l(s,i),s.loadRanges=d(s),s.subsetByIndex=w(s,i),s.subsetByValue=e.subsetByValue.bind(null,s),s})}}function x(t,e){if(!("__transformDone"in t[e])){var r=t[e];if(r.key=e,r.unit&&"string"==typeof r.unit.symbol&&(r.unit.symbol={value:r.unit.symbol}),r.categoryEncoding){var n=new Map,o=!0,a=!1,i=void 0;try{for(var s,u=Object.keys(r.categoryEncoding)[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var f=s.value,c=r.categoryEncoding[f];Array.isArray(c)||(c=[c]),n.set(f,c)}}catch(t){a=!0,i=t}finally{try{!o&&u.return&&u.return()}finally{if(a)throw i}}r.categoryEncoding=n}r.__transformDone=!0}}function j(t,r){if(!("__transformDone"in t)){var n=t.values;if(void 0===t.actualMin){var o=e.minMax(n),a=Z(o,2),i=a[0],s=a[1];null!==i&&(t.actualMin=i,t.actualMax=s)}t.shape&&(t._shape=t.shape),t.axisNames&&(t._axisNames=t.axisNames,delete t.axisNames);var u=c(r,t),f=p(r,t),d=U(n,f);return t._ndarr=d,t.get=_(d,u),t.shape=new Map(u.map(function(t,e){return[t,f[e]]})),t.__transformDone=!0,t}}function _(t,e){for(var r="",n=0;n<e.length;n++)r&&(r+=","),r+="'"+e[n]+"' in obj ? obj['"+e[n]+"'] : 0";var o=new Function("ndarr","return function ndarrget (obj) { return ndarr.get("+r+") }")(t);return o}function O(t,e,r){if(!("__transformDone"in t)){r=t.domainType||r,r&&r.indexOf(":")===-1&&(r=H+r),t.domainType=r;var n=new Map,o=!0,a=!1,i=void 0;try{for(var s,u=Object.keys(t.axes)[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var f=s.value;n.set(f,t.axes[f])}}catch(t){a=!0,i=t}finally{try{!o&&u.return&&u.return()}finally{if(a)throw i}}t.axes=n;var c=!0,p=!1,d=void 0;try{for(var l,h=n[Symbol.iterator]();!(c=(l=h.next()).done);c=!0){var v=Z(l.value,2),y=v[0],m=v[1];if(m.key=y,m.dataType&&m.dataType.indexOf(":")===-1&&(m.dataType=q+m.dataType),m.components&&(m.coordinates=m.components),m.coordinates||(m.coordinates=[y]),m.components=m.coordinates,"start"in m&&"stop"in m&&"num"in m){var g=new Float64Array(m.num),b=void 0;if(1===m.num){if(m.start!==m.stop)throw new Error("regular axis of length 1 must have equal start/stop values");b=0}else b=(m.stop-m.start)/(m.num-1);for(var w=0;w<m.num;w++)g[w]=m.start+w*b;m.values=g,delete m.start,delete m.stop,delete m.num}if(Array.isArray(m.values)&&"number"==typeof m.values[0]){for(var x=new Float64Array(m.values.length),j=0;j<m.values.length;j++)x[j]=m.values[j];m.values=x}m.bounds=S(m)}}catch(t){p=!0,d=t}finally{try{!c&&h.return&&h.return()}finally{if(p)throw d}}e&&(t.referencing=e);var _=!0,O=!1,A=void 0;try{for(var T,E=t.referencing[Symbol.iterator]();!(_=(T=E.next()).done);_=!0){var k=T.value;k.components&&(k.coordinates=k.components)}}catch(t){O=!0,A=t}finally{try{!_&&E.return&&E.return()}finally{if(O)throw A}}return t.rangeAxisOrder&&(t._rangeAxisOrder=t.rangeAxisOrder,delete t.rangeAxisOrder),t.__transformDone=!0,t}}function A(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={},n=!0,o=!1,a=void 0;try{for(var i,s=Object.keys(t)[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var u=i.value,f=t[u],c=e[u]||{},p=c.start,d=void 0===p?0:p,l=c.step,h=void 0===l?1:l;r[u]={start:d+h*f.start,stop:d+h*f.stop,step:h*f.step}}}catch(t){o=!0,a=t}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}function S(t){if(t.bounds){var e=function(){var e=t.bounds;return{v:{get:function(t){return[e[2*t],e[2*t+1]]}}}}();if("object"===("undefined"==typeof e?"undefined":X(e)))return e.v}}function T(t,e){return u(t,e)}function E(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"object"===("undefined"==typeof t?"undefined":X(t))?Promise.resolve().then(function(){return k(t)}):T(t,e).then(function(t){var e=t.data,r=t.headers;return k(e,r)})}function k(t,r){if(N(t),[e.COVERAGE,e.COVERAGECOLLECTION,e.DOMAIN].indexOf(t.type)===-1)throw new Error("CoverageJSON document must be of Coverage, CoverageCollection, or Domain type");var n=void 0;return t.type===e.DOMAIN?(O(t),n=t):n=t.type===e.COVERAGE?new tt(t):new et(t),t.type!==e.COVERAGE&&t.type!==e.COVERAGECOLLECTION||C(n,r),n}function C(t,e){if(e&&e.link){var r=t.ld,n=!0,o=!1,a=void 0;try{for(var i,s=e.link.split(",")[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var u=i.value;u=u.trim();var f=u.split(";"),c=f[0].substr(1,f[0].length-2),p=!0,d=!1,l=void 0;try{for(var h,v=f.slice(1)[Symbol.iterator]();!(p=(h=v.next()).done);p=!0){var y=h.value,m=y.indexOf("rel=");if(m!==-1){var g=y.substring(m+5,y.length-1);g.startsWith("http://")||g.startsWith("https://")||(g=G+g),r[g]?Array.isArray(r[g])?r[g].push(c):r[g]=[r[g],c]:r[g]=c}}}catch(t){d=!0,l=t}finally{try{!p&&v.return&&v.return()}finally{if(d)throw l}}}}catch(t){o=!0,a=t}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}}}function N(t){o("type"in t,'"type" missing'),t.type===e.COVERAGE?(o("parameters"in t,'"parameters" missing'),o("domain"in t,'"domain" missing'),o("ranges"in t,'"ranges" missing')):t.type===e.COVERAGECOLLECTION&&o(Array.isArray(t.coverages),'"coverages" must be an array')}var D="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},M=n(function(t){function e(t){for(var e=new Array(t),r=0;r<t;++r)e[r]=r;return e}t.exports=e}),R=r(M),V=Object.freeze({default:R}),L=n(function(t){function e(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}function r(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&e(t.slice(0,0))}t.exports=function(t){return null!=t&&(e(t)||r(t)||!!t._isBuffer)}}),I=r(L),P=Object.freeze({default:I}),J=n(function(t){function e(t,e){return t[0]-e[0]}function n(){var t,r=this.stride,n=new Array(r.length);for(t=0;t<n.length;++t)n[t]=[Math.abs(r[t]),t];n.sort(e);var o=new Array(n.length);for(t=0;t<o.length;++t)o[t]=n[t][1];return o}function o(t,e){var r=["View",e,"d",t].join("");e<0&&(r="View_Nil"+t);var o="generic"===t;if(e===-1){var a="function "+r+"(a){this.data=a;};var proto="+r+".prototype;proto.dtype='"+t+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+r+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+r+"(a){return new "+r+"(a);}",i=new Function(a);return i()}if(0===e){var a="function "+r+"(a,d) {this.data = a;this.offset = d};var proto="+r+".prototype;proto.dtype='"+t+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+r+"_copy() {return new "+r+"(this.data,this.offset)};proto.pick=function "+r+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+r+"_get(){return "+(o?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+r+"_set(v){return "+(o?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+r+"(a,b,c,d){return new "+r+"(a,d)}",i=new Function("TrivialArray",a);return i(c[t][0])}var a=["'use strict'"],u=s(e),f=u.map(function(t){return"i"+t}),p="this.offset+"+u.map(function(t){return"this.stride["+t+"]*i"+t}).join("+"),d=u.map(function(t){return"b"+t}).join(","),l=u.map(function(t){return"c"+t}).join(",");a.push("function "+r+"(a,"+d+","+l+",d){this.data=a","this.shape=["+d+"]","this.stride=["+l+"]","this.offset=d|0}","var proto="+r+".prototype","proto.dtype='"+t+"'","proto.dimension="+e),a.push("Object.defineProperty(proto,'size',{get:function "+r+"_size(){return "+u.map(function(t){return"this.shape["+t+"]"}).join("*"),"}})"),1===e?a.push("proto.order=[0]"):(a.push("Object.defineProperty(proto,'order',{get:"),e<4?(a.push("function "+r+"_order(){"),2===e?a.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===e&&a.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):a.push("ORDER})")),a.push("proto.set=function "+r+"_set("+f.join(",")+",v){"),o?a.push("return this.data.set("+p+",v)}"):a.push("return this.data["+p+"]=v}"),a.push("proto.get=function "+r+"_get("+f.join(",")+"){"),o?a.push("return this.data.get("+p+")}"):a.push("return this.data["+p+"]}"),a.push("proto.index=function "+r+"_index(",f.join(),"){return "+p+"}"),a.push("proto.hi=function "+r+"_hi("+f.join(",")+"){return new "+r+"(this.data,"+u.map(function(t){return["(typeof i",t,"!=='number'||i",t,"<0)?this.shape[",t,"]:i",t,"|0"].join("")}).join(",")+","+u.map(function(t){return"this.stride["+t+"]"}).join(",")+",this.offset)}");var h=u.map(function(t){return"a"+t+"=this.shape["+t+"]"}),v=u.map(function(t){return"c"+t+"=this.stride["+t+"]"});a.push("proto.lo=function "+r+"_lo("+f.join(",")+"){var b=this.offset,d=0,"+h.join(",")+","+v.join(","));for(var y=0;y<e;++y)a.push("if(typeof i"+y+"==='number'&&i"+y+">=0){d=i"+y+"|0;b+=c"+y+"*d;a"+y+"-=d}");a.push("return new "+r+"(this.data,"+u.map(function(t){return"a"+t}).join(",")+","+u.map(function(t){return"c"+t}).join(",")+",b)}"),a.push("proto.step=function "+r+"_step("+f.join(",")+"){var "+u.map(function(t){return"a"+t+"=this.shape["+t+"]"}).join(",")+","+u.map(function(t){return"b"+t+"=this.stride["+t+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var y=0;y<e;++y)a.push("if(typeof i"+y+"==='number'){d=i"+y+"|0;if(d<0){c+=b"+y+"*(a"+y+"-1);a"+y+"=ceil(-a"+y+"/d)}else{a"+y+"=ceil(a"+y+"/d)}b"+y+"*=d}");a.push("return new "+r+"(this.data,"+u.map(function(t){return"a"+t}).join(",")+","+u.map(function(t){return"b"+t}).join(",")+",c)}");for(var m=new Array(e),g=new Array(e),y=0;y<e;++y)m[y]="a[i"+y+"]",g[y]="b[i"+y+"]";a.push("proto.transpose=function "+r+"_transpose("+f+"){"+f.map(function(t,e){return t+"=("+t+"===undefined?"+e+":"+t+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+r+"(this.data,"+m.join(",")+","+g.join(",")+",this.offset)}"),a.push("proto.pick=function "+r+"_pick("+f+"){var a=[],b=[],c=this.offset");for(var y=0;y<e;++y)a.push("if(typeof i"+y+"==='number'&&i"+y+">=0){c=(c+this.stride["+y+"]*i"+y+")|0}else{a.push(this.shape["+y+"]);b.push(this.stride["+y+"])}");a.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),a.push("return function construct_"+r+"(data,shape,stride,offset){return new "+r+"(data,"+u.map(function(t){return"shape["+t+"]"}).join(",")+","+u.map(function(t){return"stride["+t+"]"}).join(",")+",offset)}");var i=new Function("CTOR_LIST","ORDER",a.join("\n"));return i(c[t],n)}function a(t){if(u(t))return"buffer";if(f)switch(Object.prototype.toString.call(t)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped"}return Array.isArray(t)?"array":"generic"}function i(t,e,r,n){if(void 0===t){var i=c.array[0];return i([])}"number"==typeof t&&(t=[t]),void 0===e&&(e=[t.length]);var s=e.length;if(void 0===r){r=new Array(s);for(var u=s-1,f=1;u>=0;--u)r[u]=f,f*=e[u]}if(void 0===n){n=0;for(var u=0;u<s;++u)r[u]<0&&(n-=(e[u]-1)*r[u])}for(var p=a(t),d=c[p];d.length<=s+1;)d.push(o(p,d.length-1));var i=d[s+1];return i(t,e,r,n)}var s=r(V),u=r(P),f="undefined"!=typeof Float64Array,c={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};t.exports=i}),U=r(J),F=n(function(t,e){!function(r,n){"object"==typeof e?t.exports=n():"function"==typeof define&&define.amd?define([],n):r.urltemplate=n()}(D,function(){function t(){}return t.prototype.encodeReserved=function(t){return t.split(/(%[0-9A-Fa-f]{2})/g).map(function(t){return/%[0-9A-Fa-f]/.test(t)||(t=encodeURI(t).replace(/%5B/g,"[").replace(/%5D/g,"]")),t}).join("")},t.prototype.encodeUnreserved=function(t){return encodeURIComponent(t).replace(/[!'()*]/g,function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()})},t.prototype.encodeValue=function(t,e,r){return e="+"===t||"#"===t?this.encodeReserved(e):this.encodeUnreserved(e),r?this.encodeUnreserved(r)+"="+e:e},t.prototype.isDefined=function(t){return void 0!==t&&null!==t},t.prototype.isKeyOperator=function(t){return";"===t||"&"===t||"?"===t},t.prototype.getValues=function(t,e,r,n){var o=t[r],a=[];if(this.isDefined(o)&&""!==o)if("string"==typeof o||"number"==typeof o||"boolean"==typeof o)o=o.toString(),n&&"*"!==n&&(o=o.substring(0,parseInt(n,10))),a.push(this.encodeValue(e,o,this.isKeyOperator(e)?r:null));else if("*"===n)Array.isArray(o)?o.filter(this.isDefined).forEach(function(t){a.push(this.encodeValue(e,t,this.isKeyOperator(e)?r:null))},this):Object.keys(o).forEach(function(t){this.isDefined(o[t])&&a.push(this.encodeValue(e,o[t],t))},this);else{var i=[];Array.isArray(o)?o.filter(this.isDefined).forEach(function(t){i.push(this.encodeValue(e,t))},this):Object.keys(o).forEach(function(t){this.isDefined(o[t])&&(i.push(this.encodeUnreserved(t)),i.push(this.encodeValue(e,o[t].toString())))},this),this.isKeyOperator(e)?a.push(this.encodeUnreserved(r)+"="+i.join(",")):0!==i.length&&a.push(i.join(","))}else";"===e?this.isDefined(o)&&a.push(this.encodeUnreserved(r)):""!==o||"&"!==e&&"?"!==e?""===o&&a.push(""):a.push(this.encodeUnreserved(r)+"=");return a},t.prototype.parse=function(t){var e=this,r=["+","#",".","/",";","?","&"];return{expand:function(n){return t.replace(/\{([^\{\}]+)\}|([^\{\}]+)/g,function(t,o,a){if(o){var i=null,s=[];if(r.indexOf(o.charAt(0))!==-1&&(i=o.charAt(0),o=o.substr(1)),o.split(/,/g).forEach(function(t){var r=/([^:\*]*)(?::(\d+)|(\*))?/.exec(t);s.push.apply(s,e.getValues(n,i,r[1],r[2]||r[3]))}),i&&"+"!==i){var u=",";return"?"===i?u="&":"#"!==i&&(u=i),(0!==s.length?i:"")+s.join(u)}return s.join(",")}return e.encodeReserved(a)})}}},new t})}),B=r(F),G="http://www.iana.org/assignments/relation/",z="https://covjson.org/def/",q=z+"core#",H=z+"domainTypes#",K={COVJSON:"application/prs.coverage+json",JSONLD:"application/ld+json",JSON:"application/json",TEXT:"text/plain"},W=q+"standalone",X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Q=(function(){function t(t){this.value=t}function e(e){function r(t,e){return new Promise(function(r,o){var s={key:t,arg:e,resolve:r,reject:o,next:null};i?i=i.next=s:(a=i=s,n(t,e))})}function n(r,a){try{var i=e[r](a),s=i.value;s instanceof t?Promise.resolve(s.value).then(function(t){n("next",t)},function(t){n("throw",t)}):o(i.done?"return":"normal",i.value)}catch(t){o("throw",t)}}function o(t,e){switch(t){case"return":a.resolve({value:e,done:!0});break;case"throw":a.reject(e);break;default:a.resolve({value:e,done:!1})}a=a.next,a?n(a.key,a.arg):i=null}var a,i;this._invoke=r,"function"!=typeof e.return&&(this.return=void 0)}return"function"==typeof Symbol&&Symbol.asyncIterator&&(e.prototype[Symbol.asyncIterator]=function(){return this}),e.prototype.next=function(t){return this._invoke("next",t)},e.prototype.throw=function(t){return this._invoke("throw",t)},e.prototype.return=function(t){return this._invoke("return",t)},{wrap:function(t){return function(){return new e(t.apply(this,arguments))}},await:function(e){return new t(e)}}}(),function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}),Y=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),Z=function(){function t(t,e){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=t[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!e||r.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),$=function(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)},tt=function(){function t(r,n){Q(this,t),this._covjson=r,this.type=e.COVERAGE,this.ld={},this._exposeLd(r),this.prefixes=i(this.ld),this.options=n?a(n):{},this.id=r.id,this.parameters=new Map;var o=!0,s=!1,u=void 0;try{for(var f,c=Object.keys(r.parameters)[Symbol.iterator]();!(o=(f=c.next()).done);o=!0){var p=f.value;x(r.parameters,p),this.parameters.set(p,r.parameters[p])}}catch(t){s=!0,u=t}finally{try{!o&&c.return&&c.return()}finally{if(s)throw u}}var d=void 0;d="string"==typeof this._covjson.domain?this._covjson.domainType:this._covjson.domain.domainType||this._covjson.domainType,d&&d.indexOf(":")===-1&&(d=H+d),this.domainType=d,this._updateLoadStatus()}return Y(t,[{key:"_updateLoadStatus",value:function(){var t=this,e=function(t){return"object"===("undefined"==typeof t?"undefined":X(t))},r=e(this._covjson.domain),n=Object.keys(this._covjson.ranges).every(function(r){return e(t._covjson.ranges[r])});this.loaded=r&&n}},{key:"_exposeLd",value:function(t){if(t["@context"]){var e=a(t);delete e.domain,delete e.ranges,this.ld=JSON.parse(JSON.stringify(e))}}},{key:"loadDomain",value:function(){var t=this,e=this._covjson.domain;if(this._domainPromise)return this._domainPromise;var r=void 0;if("object"===("undefined"==typeof e?"undefined":X(e))){var n=e;O(n,this.options.referencing,this.domainType),r=Promise.resolve(n)}else{var o=e;r=u(o).then(function(e){var r=e.data;return O(r,t.options.referencing,t.domainType),t._covjson.domain=r,t._updateLoadStatus(),r})}return this._domainPromise=r,r}},{key:"loadRange",value:function(t){return l(this)(t)}},{key:"loadRanges",value:function(t){return d(this)(t)}},{key:"subsetByIndex",value:function(t){return w(this)(t)}},{key:"subsetByValue",value:function(t){return e.subsetByValue(this,t)}}]),t}(),et=function(){function t(r){Q(this,t),this.type=e.COVERAGECOLLECTION,this.ld={},this._exposeLd(r),this.prefixes=i(this.ld),this.id=r.id;var n=r.domainType;n&&n.indexOf(":")===-1&&(n=H+n),this.domainType=n;var o=[],a=r.parameters?r.parameters:{},s=!0,u=!1,f=void 0;try{for(var c,p=Object.keys(a)[Symbol.iterator]();!(s=(c=p.next()).done);s=!0){var d=c.value,l=a[d];l.id||(l.id=Math.round((new Date).getTime()*Math.random()).toString())}}catch(t){u=!0,f=t}finally{try{!s&&p.return&&p.return()}finally{if(u)throw f}}var h={};r.referencing&&(h.referencing=r.referencing);var v=!0,y=!1,m=void 0;try{for(var g,b=r.coverages[Symbol.iterator]();!(v=(g=b.next()).done);v=!0){var w=g.value;w.domainType||(w.domainType=n),w.parameters||(w.parameters={});var j=!0,_=!1,A=void 0;try{for(var S,T=Object.keys(a)[Symbol.iterator]();!(j=(S=T.next()).done);j=!0){var E=S.value;E in w.ranges&&(w.parameters[E]=a[E])}}catch(t){_=!0,A=t}finally{try{!j&&T.return&&T.return()}finally{if(_)throw A}}r["@context"]&&(w["@context"]=r["@context"]),o.push(new tt(w,h))}}catch(t){y=!0,m=t}finally{try{!v&&b.return&&b.return()}finally{if(y)throw m}}if(this.coverages=o,r.parameters){this.parameters=new Map;var k=!0,C=!1,N=void 0;try{for(var D,M=Object.keys(r.parameters)[Symbol.iterator]();!(k=(D=M.next()).done);k=!0){var R=D.value;x(r.parameters,R),this.parameters.set(R,r.parameters[R])}}catch(t){C=!0,N=t}finally{try{!k&&M.return&&M.return()}finally{if(C)throw N}}}r.domainTemplate&&(O(r.domainTemplate),this.domainTemplate=r.domainTemplate)}return Y(t,[{key:"query",value:function(){return new e.CollectionQuery(this)}},{key:"_exposeLd",value:function(t){if(t["@context"]){var e=a(t);delete e.coverages,this.ld=JSON.parse(JSON.stringify(e))}}}]),t}();t.load=T,t.read=E}(this.CovJSON=this.CovJSON||{},CovUtils);
//# sourceMappingURL=covjson-reader.min.js.map