!function(t,e){"use strict";function r(t,e){return e={exports:{}},t(e,e.exports),e.exports}function n(t,e){if(!t)throw e=e||"Assertion failed",new Error(e)}function o(t){var e=Object.create(Object.getPrototypeOf(t));for(var r in t)e[r]=t[r];return e}function a(t){var e=t["@context"];if(e){Array.isArray(e)||(e=[e]);var r=new Map,n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var u=i.value;if("string"!=typeof u){var f=!0,c=!1,p=void 0;try{for(var d,l=Object.keys(u)[Symbol.iterator]();!(f=(d=l.next()).done);f=!0){var h=d.value;"string"==typeof u[h]&&r.set(h,u[h])}}catch(v){c=!0,p=v}finally{try{!f&&l["return"]&&l["return"]()}finally{if(c)throw p}}}}}catch(v){o=!0,a=v}finally{try{!n&&s["return"]&&s["return"]()}finally{if(o)throw a}}return r}}function i(t){var e=t?'; profile="'+z+'"':"",r=q.COVJSON+e+"; q=1.0, "+q.JSONLD+"; q=0.1, "+q.JSON+"; q=0.1";return r}function s(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=arguments.length<=2||void 0===arguments[2]?"arraybuffer":arguments[2];if(-1===["arraybuffer","text"].indexOf(r))throw new Error;var n=e.headers||{};return new Promise(function(o,a){var s=new XMLHttpRequest;s.open("GET",t),s.responseType=r;var f=i(e.eagerload);if(s.setRequestHeader("Accept",f),n){var c=!0,p=!1,d=void 0;try{for(var l,h=Object.keys(n)[Symbol.iterator]();!(c=(l=h.next()).done);c=!0){var v=l.value;s.setRequestHeader(v,n[v])}}catch(y){p=!0,d=y}finally{try{!c&&h["return"]&&h["return"]()}finally{if(p)throw d}}}s.addEventListener("load",function(){try{if(!(s.status>=200&&s.status<300||304===s.status))return void a(new Error('Resource "'+t+'" not found, HTTP status code: '+s.status));var e=void 0;if("arraybuffer"===r){if(!window.TextDecoder)return void a({responseType:"text"});var n=new Date;e=JSON.parse((new TextDecoder).decode(new DataView(s.response))),console.log("JSON decoding: "+(new Date-n)+"ms")}else{var i=new Date;e=JSON.parse(s.response),console.log("JSON decoding (slow path): "+(new Date-i)+"ms")}var f=u(s.getAllResponseHeaders());o({data:e,headers:f})}catch(c){a(c)}}),s.addEventListener("error",function(){a(new Error("Network error loading resource at "+t))}),s.send()})["catch"](function(e){if(e.responseType)return s(t,n,e.responseType);throw e})}function u(t){var e={};if(!t)return e;for(var r=t.split("\r\n"),n=0;n<r.length;n++){var o=r[n],a=o.indexOf(": ");if(a>0){var i=o.substring(0,a).toLowerCase(),s=o.substring(a+2);e[i]=s}}return e}function f(t,e){if(!t)return e._axisNames;var r=[].concat(Q(t.axes.values())).filter(function(t){return t.values.length>1}).length>1,n=t._rangeAxisOrder||e._axisNames;if(r&&!n)throw new Error("Range axis order missing");return n=n||[].concat(Q(t.axes.keys()))}function c(t,e){if(!t)return e._shape;var r=f(t,e),n=r.map(function(e){return t.axes.get(e).values.length});if(e._shape){var o=e._shape.length===n.length&&e._shape.every(function(t,e){return t===n[e]});if(!o)throw new Error("range.shape must match domain axis sizes")}return n}function p(t){var e=this;return function(r){return void 0===r&&(r=e.parameters.keys()),r=Array.from(r),Promise.all(r.map(function(e){return t.loadRange(e)})).then(function(t){for(var e=new Map,n=0;n<r.length;n++)e.set(r[n],t[n]);return e})}}function d(t,e){return function(r){return t.loadDomain().then(function(){var n=t._covjson.ranges[r];if("object"===("undefined"==typeof n?"undefined":H(n))){var o=n;return l(t,r,o,t._covjson.domain,e)}var a=n;return s(a).then(function(n){var o=n.data;return l(t,r,o,t._covjson.domain,e)})})}}function l(t,r,n,o){var a=arguments.length<=4||void 0===arguments[4]?{}:arguments[4];if(a=e.normalizeIndexSubsetConstraints(o,a),"NdArray"===n.type||"Range"===n.type){x(n,o),t.options.cacheRanges&&(t._covjson.ranges[r]=n,t._updateLoadStatus());var i=g(n,o,a);return Promise.resolve(i)}if("TiledNdArray"===n.type)return h(n,a);throw new Error("Unsupported: "+n.type)}function h(t,e){for(var r=t.axisNames.map(function(t){return e[t]}),n=function(e){return e.map(function(e,r){return null===e?t.shape[r]:e})},o=t.tileSets.map(function(t){return y(n(t.tileShape),r)}),a=m(o),i=t.tileSets[a],u=n(i.tileShape),f=[],c=0;c<u.length;c++){for(var p=r[c],d=p.start,l=p.stop,h=p.step,g=u[c],b=Math.floor(d/g),w=Math.ceil(l/g),O=[],_=b;w>_;_++){var A=(_+.5)*g,S=Math.floor((A-d)/h),T=d+S*h,E=d+(S+1)*h,C=_*g,N=(_+1)*g;(T>=C||E>=N)&&O.push(_)}f.push(O)}var k=r.map(function(t){var e=t.start,r=t.stop,n=t.step;return Math.floor((r-e)/n)+(r-e)%n}),M=k.reduce(function(t,e){return t*e}),R=I(new Array(M),k),D=P.parse(i.urlTemplate),V=v(f),L=V.map(function(e){var n={};e.forEach(function(e,r){return n[t.axisNames[r]]=e});var o=D.expand(n);return s(o).then(function(t){var n=t.data;x(n);for(var o=e.map(function(t,e){return t*u[e]}),a=[],i=0;i<u.length;i++){var s=r[i],f=s.start,c=s.stop,p=s.step,d=u[i],l=o[i],h=[],y=0;f>l&&(y=f-l);var m=d;l+m>c&&(m=c-l);for(var g=y;m>g;g++){var b=l+g;(b-f)%p===0&&h.push(g)}a.push(h)}var w=v(a),j=!0,O=!1,_=void 0;try{for(var A,S=w[Symbol.iterator]();!(j=(A=S.next()).done);j=!0){var T,E=A.value,C=(T=n._ndarr).get.apply(T,Q(E)),N=E.map(function(t,e){var n=o[e]+t;return Math.floor((n-r[e].start)/r[e].step)});R.set.apply(R,Q(N).concat([C]))}}catch(k){O=!0,_=k}finally{try{!j&&S["return"]&&S["return"]()}finally{if(O)throw _}}})});return Promise.all(L).then(function(){var e={dataType:t.dataType,get:j(R,t.axisNames),_ndarr:R,_axisNames:t.axisNames,_shape:k};return e.shape=new Map(t.axisNames.map(function(t,e){return[t,R.shape[e]]})),e})}function v(t){return t.reduce(function(t,e){return t.map(function(t){return e.map(function(e){return t.concat(e)})}).reduce(function(t,e){return t.concat(e)},[])},[[]])}function y(t,e){for(var r=1,n=0;n<t.length;n++){var o=e[n],a=o.start,i=o.stop,s=o.step,u=t[n],f=Math.floor(a/u),c=Math.ceil(i/u),p=u*(c-f);r*=Math.ceil(p/Math.max(s,u))}var d=r*t.reduce(function(t,e){return t*e});return{tileCount:r,valueCount:d}}function m(t){var e=1e3,r=t.map(function(t){return t.tileCount+t.valueCount/e}),n=r.reduce(function(t,e,r,n){return e<n[t]?r:t},0);return n}function g(t,e,r){var n,o,a=t._ndarr,i=f(e,t),s=i.map(function(t){return r[t].start}),u=i.map(function(t){return r[t].stop}),c=i.map(function(t){return r[t].step}),p=(n=(o=a.hi.apply(a,Q(u))).lo.apply(o,Q(s))).step.apply(n,Q(c)),d={dataType:t.dataType,get:j(p,i),_ndarr:p,_axisNames:i,_shape:p.shape};return d.shape=new Map(i.map(function(t,e){return[t,p.shape[e]]})),d}function b(t,r){return function(n){return t.loadDomain().then(function(o){n=e.normalizeIndexSubsetConstraints(o,n);var a=e.subsetDomainByIndex(o,n),i=_(n,r);o._rangeAxisOrder&&(a._rangeAxisOrder=o._rangeAxisOrder);var s={_covjson:t._covjson,options:t.options,type:e.COVERAGE,domainProfiles:t.domainProfiles,domainType:t.domainType,parameters:t.parameters,loadDomain:function(){return Promise.resolve(a)}};return s.loadRange=d(s,i),s.loadRanges=p(s),s.subsetByIndex=b(s,i),s.subsetByValue=e.subsetByValue.bind(null,s),s})}}function w(t,e){if(!("__transformDone"in t[e])){var r=t[e];if(r.key=e,r.unit&&"string"==typeof r.unit.symbol&&(r.unit.symbol={value:r.unit.symbol}),r.categoryEncoding){var n=new Map,o=!0,a=!1,i=void 0;try{for(var s,u=Object.keys(r.categoryEncoding)[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var f=s.value,c=r.categoryEncoding[f];Array.isArray(c)||(c=[c]),n.set(f,c)}}catch(p){a=!0,i=p}finally{try{!o&&u["return"]&&u["return"]()}finally{if(a)throw i}}r.categoryEncoding=n}r.__transformDone=!0}}function x(t,r){if(!("__transformDone"in t)){var n=t.values;if(void 0===t.actualMin){var o=e.minMax(n),a=X(o,2),i=a[0],s=a[1];null!==i&&(t.actualMin=i,t.actualMax=s)}t.shape&&(t._shape=t.shape),t.axisNames&&(t._axisNames=t.axisNames,delete t.axisNames);var u=f(r,t),p=c(r,t),d=I(n,p);return t._ndarr=d,t.get=j(d,u),t.shape=new Map(u.map(function(t,e){return[t,p[e]]})),t.__transformDone=!0,t}}function j(t,e){for(var r="",n=0;n<e.length;n++)r&&(r+=","),r+="'"+e[n]+"' in obj ? obj['"+e[n]+"'] : 0";var o=new Function("ndarr","return function ndarrget (obj) { return ndarr.get("+r+") }")(t);return o}function O(t,e,r){if(!("__transformDone"in t)){r=t.domainType||r,r&&-1===r.indexOf(":")&&(r=G+r),t.domainType=r;var n=new Map,o=!0,a=!1,i=void 0;try{for(var s,u=Object.keys(t.axes)[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var f=s.value;n.set(f,t.axes[f])}}catch(c){a=!0,i=c}finally{try{!o&&u["return"]&&u["return"]()}finally{if(a)throw i}}t.axes=n;var p=!0,d=!1,l=void 0;try{for(var h,v=n[Symbol.iterator]();!(p=(h=v.next()).done);p=!0){var y=X(h.value,2),m=y[0],g=y[1];if(g.key=m,g.dataType&&-1===g.dataType.indexOf(":")&&(g.dataType=F+g.dataType),g.dimensions&&(g.components=g.dimensions),g.components||(g.components=[m]),g.dimensions=g.components,"start"in g&&"stop"in g&&"num"in g){var b=new Float64Array(g.num),w=void 0;if(1===g.num){if(g.start!==g.stop)throw new Error("regular axis of length 1 must have equal start/stop values");w=0}else w=(g.stop-g.start)/(g.num-1);for(var x=0;x<g.num;x++)b[x]=g.start+x*w;g.values=b,delete g.start,delete g.stop,delete g.num}if(Array.isArray(g.values)&&"number"==typeof g.values[0]){for(var j=new Float64Array(g.values.length),O=0;O<g.values.length;O++)j[O]=g.values[O];g.values=j}g.bounds=A(g)}}catch(c){d=!0,l=c}finally{try{!p&&v["return"]&&v["return"]()}finally{if(d)throw l}}e&&(t.referencing=e);var _=!0,S=!1,T=void 0;try{for(var E,C=t.referencing[Symbol.iterator]();!(_=(E=C.next()).done);_=!0){var N=E.value;if(N.system)break;N.system=N.srs||N.trs||N.rs,N.dimensions&&(N.components=N.dimensions),delete N.srs,delete N.trs,delete N.rs}}catch(c){S=!0,T=c}finally{try{!_&&C["return"]&&C["return"]()}finally{if(S)throw T}}return t.rangeAxisOrder&&(t._rangeAxisOrder=t.rangeAxisOrder,delete t.rangeAxisOrder),t.__transformDone=!0,t}}function _(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r={},n=!0,o=!1,a=void 0;try{for(var i,s=Object.keys(t)[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var u=i.value,f=t[u],c=e[u]||{},p=c.start,d=void 0===p?0:p,l=c.step,h=void 0===l?1:l;r[u]={start:d+h*f.start,stop:d+h*f.stop,step:h*f.step}}}catch(v){o=!0,a=v}finally{try{!n&&s["return"]&&s["return"]()}finally{if(o)throw a}}return r}function A(t){if(t.bounds){var e=function(){var e=t.bounds;return{v:{get:function(t){return[e[2*t],e[2*t+1]]}}}}();if("object"===("undefined"==typeof e?"undefined":H(e)))return e.v}}function S(t,e){return s(t,e)}function T(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return"object"===("undefined"==typeof t?"undefined":H(t))?Promise.resolve().then(function(){return E(t)}):S(t,e).then(function(t){var e=t.data,r=t.headers;return E(e,r)})}function E(t,r){if(N(t),-1===[e.COVERAGE,e.COVERAGECOLLECTION,e.DOMAIN].indexOf(t.type))throw new Error("CoverageJSON document must be of Coverage, CoverageCollection, or Domain type");var n=void 0;return t.type===e.DOMAIN?(O(t),n=t):n=t.type===e.COVERAGE?new Y(t):new Z(t),t.type!==e.COVERAGE&&t.type!==e.COVERAGECOLLECTION||C(n,r),n}function C(t,e){if(e&&e.link){var r=t.ld,n=!0,o=!1,a=void 0;try{for(var i,s=e.link.split(",")[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var u=i.value;u=u.trim();var f=u.split(";"),c=f[0].substr(1,f[0].length-2),p=!0,d=!1,l=void 0;try{for(var h,v=f.slice(1)[Symbol.iterator]();!(p=(h=v.next()).done);p=!0){var y=h.value,m=y.indexOf("rel=");if(-1!==m){var g=y.substring(m+5,y.length-1);g.startsWith("http://")||g.startsWith("https://")||(g=U+g),r[g]?Array.isArray(r[g])?r[g].push(c):r[g]=[r[g],c]:r[g]=c}}}catch(b){d=!0,l=b}finally{try{!p&&v["return"]&&v["return"]()}finally{if(d)throw l}}}}catch(b){o=!0,a=b}finally{try{!n&&s["return"]&&s["return"]()}finally{if(o)throw a}}}}function N(t){n("type"in t,'"type" missing'),t.type===e.COVERAGE?(n("parameters"in t,'"parameters" missing'),n("domain"in t,'"domain" missing'),n("ranges"in t,'"ranges" missing')):t.type===e.COVERAGECOLLECTION&&n(Array.isArray(t.coverages),'"coverages" must be an array')}var k="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},M=r(function(t){t.exports=function(t){return!(null==t||!(t._isBuffer||t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)))}}),R=M&&"object"==typeof M&&"default"in M?M["default"]:M,D=r(function(t){function e(t){for(var e=new Array(t),r=0;t>r;++r)e[r]=r;return e}t.exports=e}),V=D&&"object"==typeof D&&"default"in D?D["default"]:D,L=r(function(t){function e(t,e){return t[0]-e[0]}function r(){var t,r=this.stride,n=new Array(r.length);for(t=0;t<n.length;++t)n[t]=[Math.abs(r[t]),t];n.sort(e);var o=new Array(n.length);for(t=0;t<o.length;++t)o[t]=n[t][1];return o}function n(t,e){var n=["View",e,"d",t].join("");0>e&&(n="View_Nil"+t);var o="generic"===t;if(-1===e){var a="function "+n+"(a){this.data=a;};var proto="+n+".prototype;proto.dtype='"+t+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+n+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+n+"(a){return new "+n+"(a);}",s=new Function(a);return s()}if(0===e){var a="function "+n+"(a,d) {this.data = a;this.offset = d};var proto="+n+".prototype;proto.dtype='"+t+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+n+"_copy() {return new "+n+"(this.data,this.offset)};proto.pick=function "+n+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+n+"_get(){return "+(o?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+n+"_set(v){return "+(o?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+n+"(a,b,c,d){return new "+n+"(a,d)}",s=new Function("TrivialArray",a);return s(f[t][0])}var a=["'use strict'"],u=i(e),c=u.map(function(t){return"i"+t}),p="this.offset+"+u.map(function(t){return"this.stride["+t+"]*i"+t}).join("+"),d=u.map(function(t){return"b"+t}).join(","),l=u.map(function(t){return"c"+t}).join(",");a.push("function "+n+"(a,"+d+","+l+",d){this.data=a","this.shape=["+d+"]","this.stride=["+l+"]","this.offset=d|0}","var proto="+n+".prototype","proto.dtype='"+t+"'","proto.dimension="+e),a.push("Object.defineProperty(proto,'size',{get:function "+n+"_size(){return "+u.map(function(t){return"this.shape["+t+"]"}).join("*"),"}})"),1===e?a.push("proto.order=[0]"):(a.push("Object.defineProperty(proto,'order',{get:"),4>e?(a.push("function "+n+"_order(){"),2===e?a.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===e&&a.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):a.push("ORDER})")),a.push("proto.set=function "+n+"_set("+c.join(",")+",v){"),o?a.push("return this.data.set("+p+",v)}"):a.push("return this.data["+p+"]=v}"),a.push("proto.get=function "+n+"_get("+c.join(",")+"){"),o?a.push("return this.data.get("+p+")}"):a.push("return this.data["+p+"]}"),a.push("proto.index=function "+n+"_index(",c.join(),"){return "+p+"}"),a.push("proto.hi=function "+n+"_hi("+c.join(",")+"){return new "+n+"(this.data,"+u.map(function(t){return["(typeof i",t,"!=='number'||i",t,"<0)?this.shape[",t,"]:i",t,"|0"].join("")}).join(",")+","+u.map(function(t){return"this.stride["+t+"]"}).join(",")+",this.offset)}");var h=u.map(function(t){return"a"+t+"=this.shape["+t+"]"}),v=u.map(function(t){return"c"+t+"=this.stride["+t+"]"});a.push("proto.lo=function "+n+"_lo("+c.join(",")+"){var b=this.offset,d=0,"+h.join(",")+","+v.join(","));for(var y=0;e>y;++y)a.push("if(typeof i"+y+"==='number'&&i"+y+">=0){d=i"+y+"|0;b+=c"+y+"*d;a"+y+"-=d}");a.push("return new "+n+"(this.data,"+u.map(function(t){return"a"+t}).join(",")+","+u.map(function(t){return"c"+t}).join(",")+",b)}"),a.push("proto.step=function "+n+"_step("+c.join(",")+"){var "+u.map(function(t){return"a"+t+"=this.shape["+t+"]"}).join(",")+","+u.map(function(t){return"b"+t+"=this.stride["+t+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var y=0;e>y;++y)a.push("if(typeof i"+y+"==='number'){d=i"+y+"|0;if(d<0){c+=b"+y+"*(a"+y+"-1);a"+y+"=ceil(-a"+y+"/d)}else{a"+y+"=ceil(a"+y+"/d)}b"+y+"*=d}");a.push("return new "+n+"(this.data,"+u.map(function(t){return"a"+t}).join(",")+","+u.map(function(t){return"b"+t}).join(",")+",c)}");for(var m=new Array(e),g=new Array(e),y=0;e>y;++y)m[y]="a[i"+y+"]",g[y]="b[i"+y+"]";a.push("proto.transpose=function "+n+"_transpose("+c+"){"+c.map(function(t,e){return t+"=("+t+"===undefined?"+e+":"+t+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+n+"(this.data,"+m.join(",")+","+g.join(",")+",this.offset)}"),a.push("proto.pick=function "+n+"_pick("+c+"){var a=[],b=[],c=this.offset");for(var y=0;e>y;++y)a.push("if(typeof i"+y+"==='number'&&i"+y+">=0){c=(c+this.stride["+y+"]*i"+y+")|0}else{a.push(this.shape["+y+"]);b.push(this.stride["+y+"])}");a.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),a.push("return function construct_"+n+"(data,shape,stride,offset){return new "+n+"(data,"+u.map(function(t){return"shape["+t+"]"}).join(",")+","+u.map(function(t){return"stride["+t+"]"}).join(",")+",offset)}");var s=new Function("CTOR_LIST","ORDER",a.join("\n"));return s(f[t],r)}function o(t){if(s(t))return"buffer";if(u)switch(Object.prototype.toString.call(t)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped"}return Array.isArray(t)?"array":"generic"}function a(t,e,r,a){if(void 0===t){var i=f.array[0];return i([])}"number"==typeof t&&(t=[t]),void 0===e&&(e=[t.length]);var s=e.length;if(void 0===r){r=new Array(s);for(var u=s-1,c=1;u>=0;--u)r[u]=c,c*=e[u]}if(void 0===a){a=0;for(var u=0;s>u;++u)r[u]<0&&(a-=(e[u]-1)*r[u])}for(var p=o(t),d=f[p];d.length<=s+1;)d.push(n(p,d.length-1));var i=d[s+1];return i(t,e,r,a)}var i=V,s=R,u="undefined"!=typeof Float64Array,f={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};t.exports=a}),I=L&&"object"==typeof L&&"default"in L?L["default"]:L,J=r(function(t,e){!function(r,n){"object"==typeof e?t.exports=n():"function"==typeof define&&define.amd?define([],n):r.urltemplate=n()}(k,function(){function t(){}return t.prototype.encodeReserved=function(t){return t.split(/(%[0-9A-Fa-f]{2})/g).map(function(t){return/%[0-9A-Fa-f]/.test(t)||(t=encodeURI(t).replace(/%5B/g,"[").replace(/%5D/g,"]")),t}).join("")},t.prototype.encodeUnreserved=function(t){return encodeURIComponent(t).replace(/[!'()*]/g,function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()})},t.prototype.encodeValue=function(t,e,r){return e="+"===t||"#"===t?this.encodeReserved(e):this.encodeUnreserved(e),r?this.encodeUnreserved(r)+"="+e:e},t.prototype.isDefined=function(t){return void 0!==t&&null!==t},t.prototype.isKeyOperator=function(t){return";"===t||"&"===t||"?"===t},t.prototype.getValues=function(t,e,r,n){var o=t[r],a=[];if(this.isDefined(o)&&""!==o)if("string"==typeof o||"number"==typeof o||"boolean"==typeof o)o=o.toString(),n&&"*"!==n&&(o=o.substring(0,parseInt(n,10))),a.push(this.encodeValue(e,o,this.isKeyOperator(e)?r:null));else if("*"===n)Array.isArray(o)?o.filter(this.isDefined).forEach(function(t){a.push(this.encodeValue(e,t,this.isKeyOperator(e)?r:null))},this):Object.keys(o).forEach(function(t){this.isDefined(o[t])&&a.push(this.encodeValue(e,o[t],t))},this);else{var i=[];Array.isArray(o)?o.filter(this.isDefined).forEach(function(t){i.push(this.encodeValue(e,t))},this):Object.keys(o).forEach(function(t){this.isDefined(o[t])&&(i.push(this.encodeUnreserved(t)),i.push(this.encodeValue(e,o[t].toString())))},this),this.isKeyOperator(e)?a.push(this.encodeUnreserved(r)+"="+i.join(",")):0!==i.length&&a.push(i.join(","))}else";"===e?a.push(this.encodeUnreserved(r)):""!==o||"&"!==e&&"?"!==e?""===o&&a.push(""):a.push(this.encodeUnreserved(r)+"=");return a},t.prototype.parse=function(t){var e=this,r=["+","#",".","/",";","?","&"];return{expand:function(n){return t.replace(/\{([^\{\}]+)\}|([^\{\}]+)/g,function(t,o,a){if(o){var i=null,s=[];if(-1!==r.indexOf(o.charAt(0))&&(i=o.charAt(0),o=o.substr(1)),o.split(/,/g).forEach(function(t){var r=/([^:\*]*)(?::(\d+)|(\*))?/.exec(t);s.push.apply(s,e.getValues(n,i,r[1],r[2]||r[3]))}),i&&"+"!==i){var u=",";return"?"===i?u="&":"#"!==i&&(u=i),(0!==s.length?i:"")+s.join(u)}return s.join(",")}return e.encodeReserved(a)})}}},new t})}),P=J&&"object"==typeof J&&"default"in J?J["default"]:J,U="http://www.iana.org/assignments/relation/",B="http://covjson.org/def/",F=B+"core#",G=B+"domainTypes#",q={COVJSON:"application/prs.coverage+json",JSONLD:"application/ld+json",JSON:"application/json",TEXT:"text/plain"},z=F+"standalone",H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},K=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},W=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),X=function(){function t(t,e){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=t[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!e||r.length!==e);n=!0);}catch(u){o=!0,a=u}finally{try{!n&&s["return"]&&s["return"]()}finally{if(o)throw a}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),Q=function(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)},Y=function(){function t(r,n){K(this,t),this._covjson=r,this.type=e.COVERAGE,this.ld={},this._exposeLd(r),this.prefixes=a(this.ld),this.options=n?o(n):{},this.id=r.id,this.parameters=new Map;var i=!0,s=!1,u=void 0;try{for(var f,c=Object.keys(r.parameters)[Symbol.iterator]();!(i=(f=c.next()).done);i=!0){var p=f.value;w(r.parameters,p),this.parameters.set(p,r.parameters[p])}}catch(d){s=!0,u=d}finally{try{!i&&c["return"]&&c["return"]()}finally{if(s)throw u}}var l=void 0;l="string"==typeof this._covjson.domain?this._covjson.domainType:this._covjson.domain.domainType||this._covjson.domainType,l&&-1===l.indexOf(":")&&(l=G+l),this.domainType=l,this._updateLoadStatus()}return W(t,[{key:"_updateLoadStatus",value:function(){var t=this,e=function(t){return"object"===("undefined"==typeof t?"undefined":H(t))},r=e(this._covjson.domain),n=Object.keys(this._covjson.ranges).every(function(r){return e(t._covjson.ranges[r])});this.loaded=r&&n}},{key:"_exposeLd",value:function(t){if(t["@context"]){var e=o(t);delete e.domain,delete e.ranges,this.ld=JSON.parse(JSON.stringify(e))}}},{key:"loadDomain",value:function(){var t=this,e=this._covjson.domain;if(this._domainPromise)return this._domainPromise;var r=void 0;if("object"===("undefined"==typeof e?"undefined":H(e))){var n=e;O(n,this.options.referencing,this.domainType),r=Promise.resolve(n)}else{var o=e;r=s(o).then(function(e){var r=e.data;return O(r,t.options.referencing,t.domainType),t._covjson.domain=r,t._updateLoadStatus(),r})}return this._domainPromise=r,r}},{key:"loadRange",value:function(t){return d(this)(t)}},{key:"loadRanges",value:function(t){return p(this)(t)}},{key:"subsetByIndex",value:function(t){return b(this)(t)}},{key:"subsetByValue",value:function(t){return e.subsetByValue(this,t)}}]),t}(),Z=function(){function t(r){K(this,t),this.type=e.COVERAGECOLLECTION,this.ld={},this._exposeLd(r),this.prefixes=a(this.ld),this.id=r.id;var n=r.domainType;n&&-1===n.indexOf(":")&&(n=G+n),this.domainType=n;var o=[],i=r.parameters?r.parameters:{},s=!0,u=!1,f=void 0;try{for(var c,p=Object.keys(i)[Symbol.iterator]();!(s=(c=p.next()).done);s=!0){var d=c.value,l=i[d];l.id||(l.id=Math.round((new Date).getTime()*Math.random()).toString())}}catch(h){u=!0,f=h}finally{try{!s&&p["return"]&&p["return"]()}finally{if(u)throw f}}var v={};r.referencing&&(v.referencing=r.referencing);var y=!0,m=!1,g=void 0;try{for(var b,x=r.coverages[Symbol.iterator]();!(y=(b=x.next()).done);y=!0){var j=b.value;j.domainType||(j.domainType=n),j.parameters||(j.parameters={});var _=!0,A=!1,S=void 0;try{for(var T,E=Object.keys(i)[Symbol.iterator]();!(_=(T=E.next()).done);_=!0){var C=T.value;C in j.ranges&&(j.parameters[C]=i[C])}}catch(h){A=!0,S=h}finally{try{!_&&E["return"]&&E["return"]()}finally{if(A)throw S}}r["@context"]&&(j["@context"]=r["@context"]),o.push(new Y(j,v))}}catch(h){m=!0,g=h}finally{try{!y&&x["return"]&&x["return"]()}finally{if(m)throw g}}if(this.coverages=o,r.parameters){this.parameters=new Map;var N=!0,k=!1,M=void 0;try{for(var R,D=Object.keys(r.parameters)[Symbol.iterator]();!(N=(R=D.next()).done);N=!0){var V=R.value;w(r.parameters,V),this.parameters.set(V,r.parameters[V])}}catch(h){k=!0,M=h}finally{try{!N&&D["return"]&&D["return"]()}finally{if(k)throw M}}}r.domainTemplate&&(O(r.domainTemplate),this.domainTemplate=r.domainTemplate)}return W(t,[{key:"query",value:function(){return new e.CollectionQuery(this)}},{key:"_exposeLd",value:function(t){if(t["@context"]){var e=o(t);delete e.coverages,this.ld=JSON.parse(JSON.stringify(e))}}}]),t}();t.load=S,t.read=T}(this.CovJSON=this.CovJSON||{},CovUtils);
//# sourceMappingURL=covjson-reader.min.js.map