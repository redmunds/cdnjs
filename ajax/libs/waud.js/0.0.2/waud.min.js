/*!
 * waud.js - v0.0.2
 * Compiled on 11-12-2015 02:12:45
 * waud.js is licensed under the MIT License.
 * Copyright (c) 2015-2016 Adi Reddy Mora
*/
!function(a,b){"use strict";function c(a,b){function c(){}c.prototype=a;var d=new c;for(var e in b)d[e]=b[e];return b.toString!==Object.prototype.toString&&(d.toString=b.toString),d}function d(a,b){if(null==b)return null;null==b.__id__&&(b.__id__=t++);var c;return null==a.hx__closures__?a.hx__closures__={}:c=a.hx__closures__[b.__id__],null==c&&(c=function(){return c.method.apply(c.scope,arguments)},c.scope=a,c.method=b,a.hx__closures__[b.__id__]=c),c}var e=function(a,b){b=b.split("u").join(""),this.r=new RegExp(a,b)};e.__name__=!0,e.prototype={match:function(a){return this.r.global&&(this.r.lastIndex=0),this.r.m=this.r.exec(a),this.r.s=a,null!=this.r.m},__class__:e},Math.__name__=!0;var f=function(){};f.__name__=!0,f.field=function(a,b){try{return a[b]}catch(c){return c instanceof q&&(c=c.val),null}};var g=function(){};g.__name__=!0,g.string=function(a){return r.__string_rec(a,"")};var h=function(){};h.__name__=!0,h.createInstance=function(a,b){var c=b.length;switch(c){case 0:return new a;case 1:return new a(b[0]);case 2:return new a(b[0],b[1]);case 3:return new a(b[0],b[1],b[2]);case 4:return new a(b[0],b[1],b[2],b[3]);case 5:return new a(b[0],b[1],b[2],b[3],b[4]);case 6:return new a(b[0],b[1],b[2],b[3],b[4],b[5]);case 7:return new a(b[0],b[1],b[2],b[3],b[4],b[5],b[6]);case 8:return new a(b[0],b[1],b[2],b[3],b[4],b[5],b[6],b[7]);default:throw new q("Too many arguments")}return null};var i=function(){};i.__name__=!0,i.isiOS=function(){return new e("(iPad|iPhone|iPod)","i").match(window.navigator.userAgent)};var j=b.Waud=function(){};j.__name__=!0,j.init=function(){j.audioContext=j.createAudioContext(),j.checkAudioContext(j.sampleRate),j.webAudioAPI=!1,j.defaults=new k,j.defaults.autoplay=!1,j.defaults.formats=[],j.defaults.loop=!1,j.defaults.preload="metadata",j.defaults.volume=1,j.defaults.document=window.document,j.sounds=new p,j.types=new p,j.types.set("mp3","audio/mpeg"),j.types.set("ogg","audio/ogg"),j.types.set("wav","audio/wav"),j.types.set("aac","audio/aac"),j.types.set("m4a","audio/x-m4a"),j.iOS&&window.document.addEventListener("touchend",j.unlockAudio,!0),window.addEventListener("unload",j.destroyContext,!0)},j.mute=function(){for(var a=j.sounds.iterator();a.hasNext();){var b=a.next();b.mute()}},j.unmute=function(){for(var a=j.sounds.iterator();a.hasNext();){var b=a.next();b.unmute()}},j.destroyContext=function(){null!=j.audioContext&&(null!=j.audioContext.close&&j.audioContext.close(),j.audioContext=null)},j.suspendContext=function(){null!=j.audioContext&&null!=j.audioContext.suspend&&j.audioContext.suspend()},j.resumeContext=function(){null!=j.audioContext&&null!=j.audioContext.resume&&j.audioContext.resume()},j.getSupportString=function(){var a="OGG: "+j.audioElement.canPlayType('audio/ogg; codecs="vorbis"');return a+=", WAV: "+j.audioElement.canPlayType('audio/wav; codecs="1"'),a+=", MP3: "+j.audioElement.canPlayType("audio/mpeg;"),a+=", AAC: "+j.audioElement.canPlayType("audio/aac;"),a+=", M4A: "+j.audioElement.canPlayType("audio/x-m4a;")},j.createAudioContext=function(){if(null==j.audioContext)try{null!=j.ac&&(j.audioContext=h.createInstance(j.ac,[]))}catch(a){a instanceof q&&(a=a.val),j.audioContext=null}return j.audioContext},j.checkAudioContext=function(a){null!=j.audioContext&&j.audioContext.sampleRate!=a&&(j.destroyContext(),j.audioContext=j.createAudioContext())},j.unlockAudio=function(){if(!j.unlocked&&null!=j.audioContext){var a=j.audioContext.createBuffer(1,1,j.sampleRate),b=j.audioContext.createBufferSource();b.buffer=a,b.connect(j.audioContext.destination),null!=b.noteOn?b.noteOn(0):b.start(0),n.delay(function(){(b.playbackState==b.PLAYING_STATE||b.playbackState==b.FINISHED_STATE)&&(j.unlocked=!0,null!=j.touchUnlock&&j.touchUnlock(),window.document.removeEventListener("touchend",j.unlockAudio,!0))},1)}},j.isSupported=function(){return null!=(s=j.audioElement,d(s,s.canPlayType))},j.isOGGSupported=function(){var a=j.audioElement.canPlayType('audio/ogg; codecs="vorbis"');return null!=(s=j.audioElement,d(s,s.canPlayType))&&null!=a&&("probably"==a||"maybe"==a)},j.isWAVSupported=function(){var a=j.audioElement.canPlayType('audio/wav; codecs="1"');return null!=(s=j.audioElement,d(s,s.canPlayType))&&null!=a&&("probably"==a||"maybe"==a)},j.isMP3Supported=function(){var a=j.audioElement.canPlayType("audio/mpeg;");return null!=(s=j.audioElement,d(s,s.canPlayType))&&null!=a&&("probably"==a||"maybe"==a)},j.isAACSupported=function(){var a=j.audioElement.canPlayType("audio/aac;");return null!=(s=j.audioElement,d(s,s.canPlayType))&&null!=a&&("probably"==a||"maybe"==a)},j.isM4ASupported=function(){var a=j.audioElement.canPlayType("audio/x-m4a;");return null!=(s=j.audioElement,d(s,s.canPlayType))&&null!=a&&("probably"==a||"maybe"==a)};var k=function(){};k.__name__=!0,k.prototype={__class__:k};var l=b.WaudSound=function(a,b){var c=this;if(null!=j.defaults&&(null==b&&(b={}),null!=b.document?this.doc=b.document:this.doc=j.defaults.document,this.pid=0,this.events=[],this.supported=null!=(s=j.audioElement,d(s,s.canPlayType)),null!=b.autoplay?b.autoplay=b.autoplay:b.autoplay=j.defaults.autoplay,null!=b.formats?b.formats=b.formats:b.formats=j.defaults.formats,null!=b.loop?b.loop=b.loop:b.loop=j.defaults.loop,null!=b.preload?b.preload=b.preload:b.preload=j.defaults.preload,null!=b.volume&&b.volume>=0&&b.volume<=1?b.volume=b.volume:b.volume=j.defaults.volume,this.supported&&null!=a&&""!=a)){var e=window.document;if(this.sound=e.createElement("audio"),this.sound.crossOrigin="anonymous",j.webAudioAPI&&null!=j.audioContext&&null!=j.audioContext&&(this.source=j.audioContext.createMediaElementSource(this.sound),r.__cast(this.source,MediaElementAudioSourceNode).connect(j.audioContext.destination)),b.formats.length>0)for(var f=0,h=b.formats;f<h.length;){var i=h[f];++f,this.addSource(a+"."+i)}else this.addSource(a);b.loop&&(this.sound.loop=!0),b.autoplay&&(this.sound.autoplay=!0),this.sound.volume=b.volume,"true"==g.string(b.preload)?this.sound.preload="auto":"false"==g.string(b.preload)?this.sound.preload="none":this.sound.preload="metadata",null!=b.onload&&(this.sound.onloadeddata=function(){b.onload(c)}),null!=b.onend&&(this.sound.onended=function(){b.onend(c)}),null!=b.onerror&&(this.sound.onerror=function(){b.onerror(c)}),j.sounds.set(a,this),this.sound.load()}};l.__name__=!0,l.prototype={addSource:function(a){var b=window.document;if(this.source=b.createElement("source"),this.source.src=a,null!=function(b){var c,d=b.getExt(a);return c=j.types.get(d)}(this)){var c=this.getExt(a);this.source.type=j.types.get(c)}return this.sound.appendChild(this.source),this.source},getExt:function(a){return a.split(".").pop()},set_volume:function(a){return a>=0&&1>=a&&(this.sound.volume=a),this.volume=a},mute:function(){this.sound.muted=!0},unmute:function(){this.sound.muted=!1},loop:function(){this.sound.loop=!0},unloop:function(){this.sound.loop=!1},play:function(){this.sound.play()},stop:function(){this.sound.pause(),this.sound.currentTime=0},__class__:l};var m=function(){};m.__name__=!0;var n=function(a){var b=this;this.id=setInterval(function(){b.run()},a)};n.__name__=!0,n.delay=function(a,b){var c=new n(b);return c.run=function(){c.stop(),a()},c},n.prototype={stop:function(){null!=this.id&&(clearInterval(this.id),this.id=null)},run:function(){},__class__:n};var o=function(a,b){this.map=a,this.keys=b,this.index=0,this.count=b.length};o.__name__=!0,o.prototype={hasNext:function(){return this.index<this.count},next:function(){return this.map.get(this.keys[this.index++])},__class__:o};var p=function(){this.h={}};p.__name__=!0,p.__interfaces__=[m],p.prototype={set:function(a,b){null!=A[a]?this.setReserved(a,b):this.h[a]=b},get:function(a){return null!=A[a]?this.getReserved(a):this.h[a]},setReserved:function(a,b){null==this.rh&&(this.rh={}),this.rh["$"+a]=b},getReserved:function(a){return null==this.rh?null:this.rh["$"+a]},arrayKeys:function(){var a=[];for(var b in this.h)this.h.hasOwnProperty(b)&&a.push(b);if(null!=this.rh)for(var b in this.rh)36==b.charCodeAt(0)&&a.push(b.substr(1));return a},iterator:function(){return new o(this,this.arrayKeys())},__class__:p};var q=function(a){Error.call(this),this.val=a,this.message=String(a),Error.captureStackTrace&&Error.captureStackTrace(this,q)};q.__name__=!0,q.__super__=Error,q.prototype=c(Error.prototype,{__class__:q});var r=function(){};r.__name__=!0,r.getClass=function(a){if(a instanceof Array&&null==a.__enum__)return Array;var b=a.__class__;if(null!=b)return b;var c=r.__nativeClassName(a);return null!=c?r.__resolveNativeClass(c):null},r.__string_rec=function(a,b){if(null==a)return"null";if(b.length>=5)return"<...>";var c=typeof a;switch("function"==c&&(a.__name__||a.__ename__)&&(c="object"),c){case"object":if(a instanceof Array){if(a.__enum__){if(2==a.length)return a[0];var d=a[0]+"(";b+="	";for(var e=2,f=a.length;f>e;){var g=e++;d+=2!=g?","+r.__string_rec(a[g],b):r.__string_rec(a[g],b)}return d+")"}var h=a.length,i="[";b+="	";for(var j=0;h>j;){var k=j++;i+=(k>0?",":"")+r.__string_rec(a[k],b)}return i+="]"}var l;try{l=a.toString}catch(m){return m instanceof q&&(m=m.val),"???"}if(null!=l&&l!=Object.toString&&"function"==typeof l){var n=a.toString();if("[object Object]"!=n)return n}var o=null,p="{\n";b+="	";var s=null!=a.hasOwnProperty;for(var o in a)(!s||a.hasOwnProperty(o))&&"prototype"!=o&&"__class__"!=o&&"__super__"!=o&&"__interfaces__"!=o&&"__properties__"!=o&&(2!=p.length&&(p+=", \n"),p+=b+o+" : "+r.__string_rec(a[o],b));return b=b.substring(1),p+="\n"+b+"}";case"function":return"<function>";case"string":return a;default:return String(a)}},r.__interfLoop=function(a,b){if(null==a)return!1;if(a==b)return!0;var c=a.__interfaces__;if(null!=c)for(var d=0,e=c.length;e>d;){var f=d++,g=c[f];if(g==b||r.__interfLoop(g,b))return!0}return r.__interfLoop(a.__super__,b)},r.__instanceof=function(a,b){if(null==b)return!1;switch(b){case u:return(0|a)===a;case w:return"number"==typeof a;case x:return"boolean"==typeof a;case String:return"string"==typeof a;case Array:return a instanceof Array&&null==a.__enum__;case v:return!0;default:if(null==a)return!1;if("function"==typeof b){if(a instanceof b)return!0;if(r.__interfLoop(r.getClass(a),b))return!0}else if("object"==typeof b&&r.__isNativeObj(b)&&a instanceof b)return!0;return b==y&&null!=a.__name__?!0:b==z&&null!=a.__ename__?!0:a.__enum__==b}},r.__cast=function(a,b){if(r.__instanceof(a,b))return a;throw new q("Cannot cast "+g.string(a)+" to "+g.string(b))},r.__nativeClassName=function(a){var b=r.__toStr.call(a).slice(8,-1);return"Object"==b||"Function"==b||"Math"==b||"JSON"==b?null:b},r.__isNativeObj=function(a){return null!=r.__nativeClassName(a)},r.__resolveNativeClass=function(a){return Function("return typeof "+a+' != "undefined" ? '+a+" : null")()};var s,t=0;String.prototype.__class__=String,String.__name__=!0,Array.__name__=!0;var u={__name__:["Int"]},v={__name__:["Dynamic"]},w=Number;w.__name__=["Float"];var x=Boolean;x.__ename__=["Bool"];var y={__name__:["Class"]},z={},A={};j.sampleRate=44100,j.ac=null!=f.field(window,"AudioContext")?f.field(window,"AudioContext"):f.field(window,"webkitAudioContext"),j.audioElement=function(a){var b,c=window.document;return b=c.createElement("audio")}(this),j.iOS=i.isiOS(),j.unlocked=!1,r.__toStr={}.toString}("undefined"!=typeof console?console:{log:function(){}},"undefined"!=typeof window?window:exports);