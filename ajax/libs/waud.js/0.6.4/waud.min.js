(function(v,r,J){function D(a,b){function d(){}d.prototype=a;var c=new d,e;for(e in b)c[e]=b[e];b.toString!==Object.prototype.toString&&(c.toString=b.toString);return c}function e(a,b){if(null==b)return null;null==b.__id__&&(b.__id__=K++);var d;null==a.hx__closures__?a.hx__closures__={}:d=a.hx__closures__[b.__id__];null==d&&(d=function(){return d.method.apply(d.scope,arguments)},d.scope=a,d.method=b,a.hx__closures__[b.__id__]=d);return d}var t=function(){this.bufferList=new n;this.types=new n;this.types.set("mp3",
"audio/mpeg");this.types.set("ogg","audio/ogg");this.types.set("wav","audio/wav");this.types.set("aac","audio/aac");this.types.set("m4a","audio/x-m4a")};t.__name__=!0;t.prototype={checkWebAudioAPISupport:function(){return null!=f.field(window,"AudioContext")?(t.AudioContextClass=f.field(window,"AudioContext"),!0):null!=f.field(window,"webkitAudioContext")?(t.AudioContextClass=f.field(window,"webkitAudioContext"),!0):!1},unlockAudio:function(){if(null!=this.audioContext){var a=this.audioContext.createBuffer(1,
1,c.preferredSampleRate),b=this.audioContext.createBufferSource();b.buffer=a;b.connect(this.audioContext.destination);null!=f.field(b,"start")?b.start(0):b.noteOn(0);null!=b.onended?b.onended=e(this,this._unlockCallback):p.delay(e(this,this._unlockCallback),1)}else a=window.document.createElement("audio"),b=window.document.createElement("source"),b.src="data:audio/wave;base64,UklGRjIAAABXQVZFZm10IBIAAAABAAEAQB8AAEAfAAABAAgAAABmYWN0BAAAAAAAAABkYXRhAAAAAA==",a.appendChild(b),window.document.appendChild(a),
a.play(),null!=c.__touchUnlockCallback&&c.__touchUnlockCallback(),c.dom.ontouchend=null},_unlockCallback:function(){null!=c.__touchUnlockCallback&&c.__touchUnlockCallback();c.dom.ontouchend=null},createAudioContext:function(){if(null==this.audioContext)try{null!=t.AudioContextClass&&(this.audioContext=E.createInstance(t.AudioContextClass,[]))}catch(a){a instanceof l&&(a=a.val),this.audioContext=null}return this.audioContext},destroy:function(){null!=this.audioContext&&null!=this.audioContext.close&&
""!=this.audioContext.close&&this.audioContext.close();this.types=this.bufferList=this.audioContext=null},__class__:t};var q=function(a,b){this._b64=new h("(^data:audio).*(;base64,)","i");null!=a&&""!=a&&null!=c.audioManager&&(this.duration=0,this.isSpriteSound=!1,this.url=a,this._muted=this._isPlaying=this._isLoaded=!1,null==b&&(b={}),b.autoplay=null!=b.autoplay?b.autoplay:c.defaults.autoplay,b.autostop=null!=b.autostop?b.autostop:c.defaults.autostop,b.webaudio=null!=b.webaudio?b.webaudio:c.defaults.webaudio,
b.preload=null!=b.preload?b.preload:c.defaults.preload,b.loop=null!=b.loop?b.loop:c.defaults.loop,b.volume=null!=b.volume&&0<=b.volume&&1>=b.volume?b.volume:c.defaults.volume,b.onload=null!=b.onload?b.onload:c.defaults.onload,b.onend=null!=b.onend?b.onend:c.defaults.onend,b.onerror=null!=b.onerror?b.onerror:c.defaults.onerror,this._options=b)};q.__name__=!0;q.prototype={get_duration:function(){return 0},isReady:function(){return this._isLoaded},__class__:q};var h=function(a,b){b=b.split("u").join("");
this.r=new RegExp(a,b)};h.__name__=!0;h.prototype={match:function(a){this.r.global&&(this.r.lastIndex=0);this.r.m=this.r.exec(a);this.r.s=a;return null!=this.r.m},matched:function(a){if(null!=this.r.m&&0<=a&&a<this.r.m.length)return this.r.m[a];throw new l("EReg::matched");},__class__:h};v=function(){};v.__name__=!0;v.prototype={__class__:v};var w=function(a,b,d){q.call(this,a,b);this._snd=c.dom.createElement("audio");null==d?this._addSource(a):this._snd.appendChild(d);this._options.preload&&this.load();
this._b64.match(a)};w.__name__=!0;w.__interfaces__=[v];w.__super__=q;w.prototype=D(q.prototype,{load:function(a){var b=this;this._isLoaded||(this._snd.autoplay=this._options.autoplay,this._snd.loop=this._options.loop,this._snd.volume=this._options.volume,null!=a&&(this._options.onload=a),this._snd.preload=this._options.preload?"auto":"metadata",null!=this._options.onload&&(this._isLoaded=!0,this._snd.onloadeddata=function(){b._options.onload(b)}),this._snd.onplaying=function(){b._isPlaying=!0},this._snd.onended=
function(){b._isPlaying=!1;if(null!=b._options.onend)b._options.onend(b)},null!=this._options.onerror&&(this._snd.onerror=function(){b._options.onerror(b)}),this._snd.load());return this},get_duration:function(){return this._isLoaded?this.duration=this._snd.duration:0},_addSource:function(a){this._src=c.dom.createElement("source");this._src.src=a;var b=this._getExt(a);null!=c.audioManager.types.get(b)&&(a=this._getExt(a),this._src.type=c.audioManager.types.get(a));this._snd.appendChild(this._src);
return this._src},_getExt:function(a){return a.split(".").pop()},setVolume:function(a,b){0<=a&&1>=a&&(this._options.volume=a);this._isLoaded&&(this._snd.volume=this._options.volume)},getVolume:function(a){return this._options.volume},mute:function(a,b){this._isLoaded&&(this._snd.muted=a,m.isiOS()&&(a&&this.isPlaying()?(this._muted=!0,this._snd.pause()):this._muted&&(this._muted=!1,this._snd.play())))},toggleMute:function(a){this.mute(!this._muted)},play:function(a,b){var d=this;this.spriteName=a;
if(!this._isLoaded||null==this._snd)return-1;if(this._isPlaying)if(this._options.autostop)this.stop(this.spriteName);else{var c;c=g.__cast(this._snd.cloneNode(!0),HTMLAudioElement);p.delay(e(c,c.play),100)}if(this._muted)return-1;this.isSpriteSound&&null!=b&&(this._snd.currentTime=null==this._pauseTime?b.start:this._pauseTime,null!=this._tmr&&this._tmr.stop(),this._tmr=p.delay(function(){null!=b.loop&&b.loop?d.play(d.spriteName,b):d.stop(d.spriteName)},Math.ceil(1E3*b.duration)));p.delay((y=this._snd,
e(y,y.play)),100);this._pauseTime=null;return 0},togglePlay:function(a){this._isPlaying?this.pause():this.play()},isPlaying:function(a){return this._isPlaying},loop:function(a){this._isLoaded&&null!=this._snd&&(this._snd.loop=a)},stop:function(a){this._isLoaded&&null!=this._snd&&(this._snd.currentTime=0,this._snd.pause(),this._isPlaying=!1,null!=this._tmr&&this._tmr.stop())},pause:function(a){this._isLoaded&&null!=this._snd&&(this._snd.pause(),this._pauseTime=this._snd.currentTime,this._isPlaying=
!1,null!=this._tmr&&this._tmr.stop())},setTime:function(a){!this._isLoaded||null==this._snd||a>this._snd.duration||(this._snd.currentTime=a)},getTime:function(){return null!=this._snd&&this._isLoaded&&this._isPlaying?this._snd.currentTime:0},onEnd:function(a,b){this._options.onend=a;return this},onLoad:function(a){this._options.onload=a;return this},onError:function(a){this._options.onerror=a;return this},destroy:function(){null!=this._snd&&(this._snd.pause(),this._snd.removeChild(this._src),this._snd=
this._src=null);this._isPlaying=!1},__class__:w});var u=function(){};u.__name__=!0;u.cca=function(a,b){var d=a.charCodeAt(b);return d!=d?void 0:d};u.indexOf=function(a,b,d){var c=a.length;0>d&&(d+=c,0>d&&(d=0));for(;d<c;){if(a[d]===b)return d;d++}return-1};Math.__name__=!0;var f=function(){};f.__name__=!0;f.field=function(a,b){try{return a[b]}catch(d){return d instanceof l&&(d=d.val),null}};f.fields=function(a){var b=[];if(null!=a){var d=Object.prototype.hasOwnProperty,c;for(c in a)"__id__"!=c&&"hx__closures__"!=
c&&d.call(a,c)&&b.push(c)}return b};var z=function(){};z.__name__=!0;z.string=function(a){return g.__string_rec(a,"")};z.parseInt=function(a){var b=parseInt(a,10);0!=b||120!=u.cca(a,1)&&88!=u.cca(a,1)||(b=parseInt(a));return isNaN(b)?null:b};var E=function(){};E.__name__=!0;E.createInstance=function(a,b){switch(b.length){case 0:return new a;case 1:return new a(b[0]);case 2:return new a(b[0],b[1]);case 3:return new a(b[0],b[1],b[2]);case 4:return new a(b[0],b[1],b[2],b[3]);case 5:return new a(b[0],
b[1],b[2],b[3],b[4]);case 6:return new a(b[0],b[1],b[2],b[3],b[4],b[5]);case 7:return new a(b[0],b[1],b[2],b[3],b[4],b[5],b[6]);case 8:return new a(b[0],b[1],b[2],b[3],b[4],b[5],b[6],b[7]);default:throw new l("Too many arguments");}};var c=r.Waud=function(){};c.__name__=!0;c.init=function(a){null==c.__audioElement&&(null==a&&(a=window.document),c.dom=a,c.__audioElement=c.dom.createElement("audio"),null==c.audioManager&&(c.audioManager=new t),c.isWebAudioSupported=c.audioManager.checkWebAudioAPISupport(),
c.isHTML5AudioSupported=null!=f.field(window,"Audio"),c.isWebAudioSupported&&(c.audioContext=c.audioManager.createAudioContext()),c.sounds=new n)};c.autoMute=function(){c._focusManager=new k;c._focusManager.focus=function(){if(!c.isMuted&&null!=c.sounds)for(var a=c.sounds.iterator();a.hasNext();)a.next().mute(!1)};c._focusManager.blur=function(){if(null!=c.sounds)for(var a=c.sounds.iterator();a.hasNext();)a.next().mute(!0)}};c.enableTouchUnlock=function(a){c.__touchUnlockCallback=a;c.dom.ontouchend=
(y=c.audioManager,e(y,y.unlockAudio))};c.mute=function(a){null==a&&(a=!0);c.isMuted=a;if(null!=c.sounds)for(var b=c.sounds.iterator();b.hasNext();)b.next().mute(a)};c.stop=function(){if(null!=c.sounds)for(var a=c.sounds.iterator();a.hasNext();)a.next().stop()};c.pause=function(){if(null!=c.sounds)for(var a=c.sounds.iterator();a.hasNext();)a.next().pause()};c.getFormatSupportString=function(){var a="OGG: "+c.__audioElement.canPlayType('audio/ogg; codecs="vorbis"'),a=a+(", WAV: "+c.__audioElement.canPlayType('audio/wav; codecs="1"')),
a=a+(", MP3: "+c.__audioElement.canPlayType("audio/mpeg;")),a=a+(", AAC: "+c.__audioElement.canPlayType("audio/aac;"));return a+=", M4A: "+c.__audioElement.canPlayType("audio/x-m4a;")};c.isSupported=function(){if(null==c.isWebAudioSupported||null==c.isHTML5AudioSupported)c.isWebAudioSupported=c.audioManager.checkWebAudioAPISupport(),c.isHTML5AudioSupported=null!=f.field(window,"Audio");return c.isWebAudioSupported||c.isHTML5AudioSupported};c.isOGGSupported=function(){var a=c.__audioElement.canPlayType('audio/ogg; codecs="vorbis"');
return c.isHTML5AudioSupported&&null!=a&&("probably"==a||"maybe"==a)};c.isWAVSupported=function(){var a=c.__audioElement.canPlayType('audio/wav; codecs="1"');return c.isHTML5AudioSupported&&null!=a&&("probably"==a||"maybe"==a)};c.isMP3Supported=function(){var a=c.__audioElement.canPlayType("audio/mpeg;");return c.isHTML5AudioSupported&&null!=a&&("probably"==a||"maybe"==a)};c.isAACSupported=function(){var a=c.__audioElement.canPlayType("audio/aac;");return c.isHTML5AudioSupported&&null!=a&&("probably"==
a||"maybe"==a)};c.isM4ASupported=function(){var a=c.__audioElement.canPlayType("audio/x-m4a;");return c.isHTML5AudioSupported&&null!=a&&("probably"==a||"maybe"==a)};c.destroy=function(){if(null!=c.sounds)for(var a=c.sounds.iterator();a.hasNext();)a.next().destroy();c.sounds=null;null!=c.audioManager&&c.audioManager.destroy();c.audioManager=null;c.audioContext=null;c.__audioElement=null;null!=c._focusManager&&(c._focusManager.clearEvents(),c._focusManager.blur=null,c._focusManager.focus=null)};var F=
r.WaudBase64Pack=function(a,b,d){null!=c.audioManager&&0<a.indexOf(".json")&&(this._loadCount=this._soundCount=0,this._onLoaded=b,this._onError=d,this._sounds=new n,this._loadBase64Json(a))};F.__name__=!0;F.prototype={_loadBase64Json:function(a){var b=this,d=new XMLHttpRequest;d.open("GET",a,!0);d.onreadystatechange=function(){if(4==d.readyState&&200==d.status)for(var a=JSON.parse(d.responseText),c=0,e=f.fields(a);c<e.length;){var g=e[c];++c;b._soundCount++;b._createSound(g,f.field(a,g))}};d.send(null)},
_createSound:function(a,b){var d=this;new B(b,{onload:function(b){d._loadCount++;d._sounds.set(a,b);c.sounds.set(a,b);d._loadCount==d._soundCount&&null!=d._onLoaded&&d._onLoaded(d._sounds)},onerror:function(b){d._loadCount++;d._sounds.set(a,null);d._loadCount==d._soundCount&&null!=d._onLoaded&&(d._onLoaded(d._sounds),null!=d._onError&&d._onError())}})},__class__:F};var k=r.WaudFocusManager=function(){var a=this;this._currentState=this._visibilityChange=this._hidden="";null!=f.field(window.document,
"hidden")?(this._hidden="hidden",this._visibilityChange="visibilitychange"):null!=f.field(window.document,"mozHidden")?(this._hidden="mozHidden",this._visibilityChange="mozvisibilitychange"):null!=f.field(window.document,"msHidden")?(this._hidden="msHidden",this._visibilityChange="msvisibilitychange"):null!=f.field(window.document,"webkitHidden")&&(this._hidden="webkitHidden",this._visibilityChange="webkitvisibilitychange");null!=f.field(window,"addEventListener")?(window.addEventListener("focus",
e(this,this._focus)),window.addEventListener("blur",e(this,this._blur)),window.addEventListener("pageshow",e(this,this._focus)),window.addEventListener("pagehide",e(this,this._blur)),document.addEventListener(this._visibilityChange,e(this,this._handleVisibilityChange))):null!=f.field(window,"attachEvent")?(window.attachEvent("onfocus",e(this,this._focus)),window.attachEvent("onblur",e(this,this._blur)),window.attachEvent("pageshow",e(this,this._focus)),window.attachEvent("pagehide",e(this,this._blur)),
document.attachEvent(this._visibilityChange,e(this,this._handleVisibilityChange))):window.onload=function(){window.onfocus=e(a,a._focus);window.onblur=e(a,a._blur);window.onpageshow=e(a,a._focus);window.onpagehide=e(a,a._blur)}};k.__name__=!0;k.prototype={_handleVisibilityChange:function(){null!=f.field(window.document,this._hidden)&&f.field(window.document,this._hidden)&&null!=this.blur?this.blur():null!=this.focus&&this.focus()},_focus:function(){"focus"!=this._currentState&&null!=this.focus&&this.focus();
this._currentState="focus"},_blur:function(){"blur"!=this._currentState&&null!=this.blur&&this.blur();this._currentState="blur"},clearEvents:function(){null!=f.field(window,"removeEventListener")?(window.removeEventListener("focus",e(this,this._focus)),window.removeEventListener("blur",e(this,this._blur)),window.removeEventListener("pageshow",e(this,this._focus)),window.removeEventListener("pagehide",e(this,this._blur)),window.removeEventListener(this._visibilityChange,e(this,this._handleVisibilityChange))):
null!=f.field(window,"removeEvent")?(window.removeEvent("onfocus",e(this,this._focus)),window.removeEvent("onblur",e(this,this._blur)),window.removeEvent("pageshow",e(this,this._focus)),window.removeEvent("pagehide",e(this,this._blur)),window.removeEvent(this._visibilityChange,e(this,this._handleVisibilityChange))):(window.onfocus=null,window.onblur=null,window.onpageshow=null,window.onpagehide=null)},__class__:k};var B=r.WaudSound=function(a,b){if(null!=c.audioManager)if(this._options=b,0<a.indexOf(".json")?
(this.isSpriteSound=!0,this._spriteDuration=0,this._spriteSounds=new n,this._spriteSoundEndCallbacks=new n,this._loadSpriteJson(a)):(this.isSpriteSound=!1,this._init(a)),(new h("(^data:audio).*(;base64,)","i")).match(a)){var d="snd"+(new Date).getTime();c.sounds.set(d,this)}else c.sounds.set(a,this)};B.__name__=!0;B.__interfaces__=[v];B.prototype={_loadSpriteJson:function(a){var b=this,d=new XMLHttpRequest;d.open("GET",a,!0);d.onreadystatechange=function(){if(4==d.readyState&&200==d.status){b._spriteData=
JSON.parse(d.responseText);var c=b._spriteData.src;-1<a.indexOf("/")&&(c=a.substring(0,a.lastIndexOf("/")+1)+c);b._init(c)}};d.send(null)},_init:function(a){this.url=a;if(c.isWebAudioSupported&&c.useWebAudio&&(null==this._options||null==this._options.webaudio||this._options.webaudio))this.isSpriteSound?this._loadSpriteSound(this.url):this._snd=new x(this.url,this._options);else if(c.isHTML5AudioSupported)if(null!=this._spriteData&&null!=this._spriteData.sprite){a=0;for(var b=this._spriteData.sprite;a<
b.length;){var d=b[a];++a;var A=new w(this.url,this._options);A.isSpriteSound=!0;this._spriteSounds.set(d.name,A)}}else this._snd=new w(this.url,this._options)},get_duration:function(){return this.isSpriteSound?this._spriteDuration:null==this._snd?0:this._snd.get_duration()},setVolume:function(a,b){this.isSpriteSound?null!=b&&null!=this._spriteSounds.get(b)&&this._spriteSounds.get(b).setVolume(a):null!=this._snd&&this._snd.setVolume(a)},getVolume:function(a){return this.isSpriteSound?null!=a&&null!=
this._spriteSounds.get(a)?this._spriteSounds.get(a).getVolume():0:null==this._snd?0:this._snd.getVolume()},mute:function(a,b){if(this.isSpriteSound)if(null!=b&&null!=this._spriteSounds.get(b))this._spriteSounds.get(b).mute(a);else for(var d=this._spriteSounds.iterator();d.hasNext();)d.next().mute(a);else null!=this._snd&&this._snd.mute(a)},toggleMute:function(a){if(this.isSpriteSound)if(null!=a&&null!=this._spriteSounds.get(a))this._spriteSounds.get(a).toggleMute();else for(a=this._spriteSounds.iterator();a.hasNext();)a.next().toggleMute();
else null!=this._snd&&this._snd.toggleMute()},load:function(a){if(null==this._snd||this.isSpriteSound)return null;this._snd.load(a);return this},isReady:function(){if(this.isSpriteSound)for(var a=this._spriteSounds.iterator();a.hasNext();)return a.next().isReady();return this._snd.isReady()},play:function(a,b){if(this.isSpriteSound)if(null!=a){for(var d=0,c=this._spriteData.sprite;d<c.length;){var e=c[d];++d;if(e.name==a){b=e;break}}if(null==b)return null;if(null!=this._spriteSounds.get(a))return this._spriteSounds.get(a).stop(),
this._spriteSounds.get(a).play(a,b)}else return null;return null==this._snd?null:this._snd.play(a,b)},togglePlay:function(a){this.isSpriteSound?null!=a&&null!=this._spriteSounds.get(a)&&this._spriteSounds.get(a).togglePlay():null!=this._snd&&this._snd.togglePlay()},isPlaying:function(a){return this.isSpriteSound?null!=a&&null!=this._spriteSounds.get(a)?this._spriteSounds.get(a).isPlaying():!1:null==this._snd?!1:this._snd.isPlaying()},loop:function(a){null==this._snd||this.isSpriteSound||this._snd.loop(a)},
stop:function(a){if(this.isSpriteSound)if(null!=a&&null!=this._spriteSounds.get(a))this._spriteSounds.get(a).stop();else for(a=this._spriteSounds.iterator();a.hasNext();)a.next().stop();else null!=this._snd&&this._snd.stop()},pause:function(a){if(this.isSpriteSound)if(null!=a&&null!=this._spriteSounds.get(a))this._spriteSounds.get(a).pause();else for(a=this._spriteSounds.iterator();a.hasNext();)a.next().pause();else null!=this._snd&&this._snd.pause()},setTime:function(a){null==this._snd||this.isSpriteSound||
this._snd.setTime(a)},getTime:function(){return null==this._snd||this.isSpriteSound?0:this._snd.getTime()},onEnd:function(a,b){if(this.isSpriteSound)return null!=b&&(this._spriteSoundEndCallbacks.set(b,a),a),this;if(null==this._snd)return null;this._snd.onEnd(a);return this},onLoad:function(a){if(null==this._snd||this.isSpriteSound)return null;this._snd.onLoad(a);return this},onError:function(a){if(null==this._snd||this.isSpriteSound)return null;this._snd.onError(a);return this},destroy:function(){if(this.isSpriteSound)for(var a=
this._spriteSounds.iterator();a.hasNext();)a.next().destroy();else null!=this._snd&&(this._snd.destroy(),this._snd=null)},_loadSpriteSound:function(a){var b=new XMLHttpRequest;b.open("GET",a,!0);b.responseType="arraybuffer";b.onload=e(this,this._onSpriteSoundLoaded);b.onerror=e(this,this._onSpriteSoundError);b.send()},_onSpriteSoundLoaded:function(a){c.audioManager.audioContext.decodeAudioData(a.target.response,e(this,this._decodeSuccess),e(this,this._onSpriteSoundError))},_onSpriteSoundError:function(){if(null!=
this._options&&null!=this._options.onerror)this._options.onerror(this)},_decodeSuccess:function(a){if(null==a)this._onSpriteSoundError();else{c.audioManager.bufferList.set(this.url,a);this._spriteDuration=a.duration;if(null!=this._options&&null!=this._options.onload)this._options.onload(this);for(var b=0,d=this._spriteData.sprite;b<d.length;){var A=d[b];++b;var g=new x(this.url,this._options,!0,a.duration);g.isSpriteSound=!0;this._spriteSounds.set(A.name,g);g.onEnd(e(this,this._spriteOnEnd),A.name)}}},
_spriteOnEnd:function(a){null!=this._spriteSoundEndCallbacks.get(a.spriteName)&&this._spriteSoundEndCallbacks.get(a.spriteName)(a)},__class__:B};var m=r.WaudUtils=function(){};m.__name__=!0;m.isAndroid=function(a){null==a&&(a=window.navigator.userAgent);return(new h("Android","i")).match(a)};m.isiOS=function(a){null==a&&(a=window.navigator.userAgent);return(new h("(iPad|iPhone|iPod)","i")).match(a)};m.isWindowsPhone=function(a){null==a&&(a=window.navigator.userAgent);return(new h("(IEMobile|Windows Phone)",
"i")).match(a)};m.isFirefox=function(a){null==a&&(a=window.navigator.userAgent);return(new h("Firefox","i")).match(a)};m.isOpera=function(a){null==a&&(a=window.navigator.userAgent);return(new h("Opera","i")).match(a)||null!=f.field(window,"opera")};m.isChrome=function(a){null==a&&(a=window.navigator.userAgent);return(new h("Chrome","i")).match(a)};m.isSafari=function(a){null==a&&(a=window.navigator.userAgent);return(new h("Safari","i")).match(a)};m.isMobile=function(a){null==a&&(a=window.navigator.userAgent);
return(new h("(iPad|iPhone|iPod|Android|webOS|BlackBerry|Windows Phone|IEMobile)","i")).match(a)};m.getiOSVersion=function(a){null==a&&(a=window.navigator.userAgent);var b=new h("[0-9_]+?[0-9_]+?[0-9_]+","i"),d=[];if(b.match(a)){a=b.matched(0).split("_");b=[];for(d=0;d<a.length;){var c=a[d];++d;b.push(z.parseInt(c))}d=b}return d};var x=function(a,b,d,e){null==e&&(e=0);null==d&&(d=!1);q.call(this,a,b);this._pauseTime=this._playStartTime=0;this._srcNodes=[];this._gainNodes=[];this._currentSoundProps=
null;this._isLoaded=d;this.duration=e;this._manager=c.audioManager;this._b64.match(a)?this._decodeAudio(this._base64ToArrayBuffer(a)):this._options.preload&&!d&&this.load()};x.__name__=!0;x.__interfaces__=[v];x.__super__=q;x.prototype=D(q.prototype,{load:function(a){if(!this._isLoaded){var b=new XMLHttpRequest;b.open("GET",this.url,!0);b.responseType="arraybuffer";b.onload=e(this,this._onSoundLoaded);b.onerror=e(this,this._error);b.send();null!=a&&(this._options.onload=a)}return this},_base64ToArrayBuffer:function(a){a=
window.atob(a.split(",")[1]);for(var b=a.length,d=new Uint8Array(new ArrayBuffer(b)),c=0;c<b;){var e=c++;d[e]=u.cca(a,e)}return d.buffer},_onSoundLoaded:function(a){this._manager.audioContext.decodeAudioData(a.target.response,e(this,this._decodeSuccess),e(this,this._error))},_decodeAudio:function(a){this._manager.audioContext.decodeAudioData(a,e(this,this._decodeSuccess),e(this,this._error))},_error:function(){if(null!=this._options.onerror)this._options.onerror(this)},_decodeSuccess:function(a){if(null==
a)this._error();else{this._manager.bufferList.set(this.url,a);this._isLoaded=!0;this.duration=a.duration;if(null!=this._options.onload)this._options.onload(this);this._options.autoplay&&this.play()}},_makeSource:function(a){var b=this._manager.audioContext.createBufferSource();b.buffer=a;this._gainNode=null!=this._manager.audioContext.createGain?this._manager.audioContext.createGain():this._manager.audioContext.createGainNode();b.connect(this._gainNode);this._gainNode.connect(this._manager.audioContext.destination);
this._srcNodes.push(b);this._gainNodes.push(this._gainNode);this._gainNode.gain.value=this._muted?0:this._options.volume;return b},get_duration:function(){return this._isLoaded?this.duration:0},play:function(a,b){var d=this;this.spriteName=a;this._isPlaying&&this._options.autostop&&this.stop(this.spriteName);if(!this._isLoaded)return-1;var c=0,e=-1;this.isSpriteSound&&null!=b&&(this._currentSoundProps=b,c=b.start+this._pauseTime,e=b.duration);var g=this._manager.bufferList.get(this.url);null!=g&&
(this._snd=this._makeSource(g),0<=c&&-1<e?null!=f.field(this._snd,"start")?this._snd.start(0,c,e):this._snd.noteGrainOn(0,c,e):(null!=f.field(this._snd,"start")?this._snd.start(0,this._pauseTime,this._snd.buffer.duration):this._snd.noteGrainOn(0,this._pauseTime,this._snd.buffer.duration),this._snd.loop=this._options.loop),this._playStartTime=this._manager.audioContext.currentTime,this._isPlaying=!0,this._snd.onended=function(){d._pauseTime=0;d._isPlaying=!1;if(d.isSpriteSound&&null!=b&&null!=b.loop&&
b.loop&&0<=c&&-1<e)d.destroy(),d.play(d.spriteName,b);else if(null!=d._options.onend)d._options.onend(d)});return u.indexOf(this._srcNodes,this._snd,0)},togglePlay:function(a){this._isPlaying?this.pause():this.play()},isPlaying:function(a){return this._isPlaying},loop:function(a){this._options.loop=a;null!=this._snd&&(this._snd.loop=a)},setVolume:function(a,b){this._options.volume=a;null!=this._gainNode&&this._isLoaded&&(this._gainNode.gain.value=this._options.volume)},getVolume:function(a){return this._options.volume},
mute:function(a,b){this._muted=a;null!=this._gainNode&&this._isLoaded&&(this._gainNode.gain.value=a?0:this._options.volume)},toggleMute:function(a){this.mute(!this._muted)},stop:function(a){this._pauseTime=0;null!=this._snd&&this._isLoaded&&this._isPlaying&&this.destroy()},pause:function(a){null!=this._snd&&this._isLoaded&&this._isPlaying&&(this.destroy(),this._pauseTime+=this._manager.audioContext.currentTime-this._playStartTime)},setTime:function(a){!this._isLoaded||a>this.get_duration()||(this._isPlaying?
(this.stop(),this._pauseTime=a,this.play()):this._pauseTime=a)},getTime:function(){return null!=this._snd&&this._isLoaded&&this._isPlaying?this._manager.audioContext.currentTime-this._playStartTime+this._pauseTime:0},onEnd:function(a,b){this._options.onend=a;return this},onLoad:function(a){this._options.onload=a;return this},onError:function(a){this._options.onerror=a;return this},destroy:function(){for(var a=0,b=this._srcNodes;a<b.length;){var c=b[a];++a;if(null!=f.field(c,"stop"))c.stop(0);else if(null!=
f.field(c,"noteOff"))try{this.src.noteOff(0)}catch(e){e instanceof l&&(e=e.val)}c.disconnect()}a=0;for(b=this._gainNodes;a<b.length;)c=b[a],++a,c.disconnect();this._srcNodes=[];this._gainNodes=[];this._isPlaying=!1},__class__:x});r=function(){};r.__name__=!0;var p=function(a){var b=this;this.id=setInterval(function(){b.run()},a)};p.__name__=!0;p.delay=function(a,b){var c=new p(b);c.run=function(){c.stop();a()};return c};p.prototype={stop:function(){null!=this.id&&(clearInterval(this.id),this.id=null)},
run:function(){},__class__:p};var C=function(a,b){this.map=a;this.keys=b;this.index=0;this.count=b.length};C.__name__=!0;C.prototype={hasNext:function(){return this.index<this.count},next:function(){return this.map.get(this.keys[this.index++])},__class__:C};var n=function(){this.h={}};n.__name__=!0;n.__interfaces__=[r];n.prototype={set:function(a,b){null!=G[a]?this.setReserved(a,b):this.h[a]=b},get:function(a){return null!=G[a]?this.getReserved(a):this.h[a]},setReserved:function(a,b){null==this.rh&&
(this.rh={});this.rh["$"+a]=b},getReserved:function(a){return null==this.rh?null:this.rh["$"+a]},arrayKeys:function(){var a=[],b;for(b in this.h)this.h.hasOwnProperty(b)&&a.push(b);if(null!=this.rh)for(b in this.rh)36==b.charCodeAt(0)&&a.push(b.substr(1));return a},iterator:function(){return new C(this,this.arrayKeys())},__class__:n};var l=function(a){Error.call(this);this.val=a;this.message=String(a);Error.captureStackTrace&&Error.captureStackTrace(this,l)};l.__name__=!0;l.__super__=Error;l.prototype=
D(Error.prototype,{__class__:l});var g=function(){};g.__name__=!0;g.getClass=function(a){if(a instanceof Array&&null==a.__enum__)return Array;var b=a.__class__;if(null!=b)return b;a=g.__nativeClassName(a);return null!=a?g.__resolveNativeClass(a):null};g.__string_rec=function(a,b){if(null==a)return"null";if(5<=b.length)return"<...>";var c=typeof a;"function"==c&&(a.__name__||a.__ename__)&&(c="object");switch(c){case "object":if(a instanceof Array){if(a.__enum__){if(2==a.length)return a[0];c=a[0]+"(";
b+="\t";for(var e=2,f=a.length;e<f;)var h=e++,c=2!=h?c+(","+g.__string_rec(a[h],b)):c+g.__string_rec(a[h],b);return c+")"}c=a.length;e="[";b+="\t";for(f=0;f<c;)h=f++,e+=(0<h?",":"")+g.__string_rec(a[h],b);return e+"]"}try{e=a.toString}catch(k){return k instanceof l&&(k=k.val),"???"}if(null!=e&&e!=Object.toString&&"function"==typeof e&&(c=a.toString(),"[object Object]"!=c))return c;c=null;e="{\n";b+="\t";f=null!=a.hasOwnProperty;for(c in a)f&&!a.hasOwnProperty(c)||"prototype"==c||"__class__"==c||"__super__"==
c||"__interfaces__"==c||"__properties__"==c||(2!=e.length&&(e+=", \n"),e+=b+c+" : "+g.__string_rec(a[c],b));b=b.substring(1);return e+("\n"+b+"}");case "function":return"<function>";case "string":return a;default:return String(a)}};g.__interfLoop=function(a,b){if(null==a)return!1;if(a==b)return!0;var c=a.__interfaces__;if(null!=c)for(var e=0,f=c.length;e<f;){var h=e++,h=c[h];if(h==b||g.__interfLoop(h,b))return!0}return g.__interfLoop(a.__super__,b)};g.__instanceof=function(a,b){if(null==b)return!1;
switch(b){case L:return(a|0)===a;case H:return"number"==typeof a;case I:return"boolean"==typeof a;case String:return"string"==typeof a;case Array:return a instanceof Array&&null==a.__enum__;case M:return!0;default:if(null!=a)if("function"==typeof b){if(a instanceof b||g.__interfLoop(g.getClass(a),b))return!0}else{if("object"==typeof b&&g.__isNativeObj(b)&&a instanceof b)return!0}else return!1;return b==N&&null!=a.__name__||b==O&&null!=a.__ename__?!0:a.__enum__==b}};g.__cast=function(a,b){if(g.__instanceof(a,
b))return a;throw new l("Cannot cast "+z.string(a)+" to "+z.string(b));};g.__nativeClassName=function(a){a=g.__toStr.call(a).slice(8,-1);return"Object"==a||"Function"==a||"Math"==a||"JSON"==a?null:a};g.__isNativeObj=function(a){return null!=g.__nativeClassName(a)};g.__resolveNativeClass=function(a){return J[a]};var y,K=0;Array.prototype.indexOf&&(u.indexOf=function(a,b,c){return Array.prototype.indexOf.call(a,b,c)});String.prototype.__class__=String;String.__name__=!0;Array.__name__=!0;Date.prototype.__class__=
Date;Date.__name__=["Date"];var L={__name__:["Int"]},M={__name__:["Dynamic"]},H=Number;H.__name__=["Float"];var I=Boolean;I.__ename__=["Bool"];var N={__name__:["Class"]},O={},G={};c.PROBABLY="probably";c.MAYBE="maybe";c.version="0.6.3";c.useWebAudio=!0;c.defaults={autoplay:!1,autostop:!0,loop:!1,preload:!0,webaudio:!0,volume:1};c.preferredSampleRate=44100;c.isMuted=!1;k.FOCUS_STATE="focus";k.BLUR_STATE="blur";k.ON_FOCUS="onfocus";k.ON_BLUR="onblur";k.PAGE_SHOW="pageshow";k.PAGE_HIDE="pagehide";k.WINDOW=
"window";k.DOCUMENT="document";g.__toStr={}.toString})("undefined"!=typeof console?console:{log:function(){}},"undefined"!=typeof window?window:exports,"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);
