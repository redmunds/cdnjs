/*!
 * waud.js - v0.0.3
 * Compiled on 12-12-2015 07:12:20
 * waud.js is licensed under the MIT License.
 * Copyright (c) 2015-2016 Adi Reddy Mora
*/
!function(a,b){"use strict";function c(a,b){function c(){}c.prototype=a;var d=new c;for(var e in b)d[e]=b[e];return b.toString!==Object.prototype.toString&&(d.toString=b.toString),d}function d(a,b){if(null==b)return null;null==b.__id__&&(b.__id__=s++);var c;return null==a.hx__closures__?a.hx__closures__={}:c=a.hx__closures__[b.__id__],null==c&&(c=function(){return c.method.apply(c.scope,arguments)},c.scope=a,c.method=b,a.hx__closures__[b.__id__]=c),c}var e=function(){this.bufferList=new o,this.playingSounds=new o};e.__name__=!0,e.prototype={checkWebAudioAPISupport:function(){return null!=i.field(window,"AudioContext")?(e.AudioContextClass=i.field(window,"AudioContext"),!0):null!=i.field(window,"webkitAudioContext")?(e.AudioContextClass=i.field(window,"webkitAudioContext"),!0):!1},unlockAudio:function(){var a=this;if(null!=this.audioContext){var b=this.audioContext.createBuffer(1,1,44100),c=this.audioContext.createBufferSource();c.buffer=b,c.connect(this.audioContext.destination),c.start(0),c.onended=function(){null!=l.__touchUnlockCallback&&l.__touchUnlockCallback(),l.dom.removeEventListener("touchend",d(a,a.unlockAudio),!0)}}},createAudioContext:function(){if(null==this.audioContext)try{null!=e.AudioContextClass&&(this.audioContext=k.createInstance(e.AudioContextClass,[]))}catch(a){a instanceof p&&(a=a.val),this.audioContext=null}}};var f=function(a,b){null!=l.defaults&&(null==b&&(b={}),null!=b.autoplay?b.autoplay=b.autoplay:b.autoplay=l.defaults.autoplay,null!=b.preload?b.preload=b.preload:b.preload=l.defaults.preload,null!=b.loop?b.loop=b.loop:b.loop=l.defaults.loop,null!=b.volume&&b.volume>=0&&b.volume<=1?b.volume=b.volume:b.volume=l.defaults.volume,this._options=b)};f.__name__=!0;var g=function(){};g.__name__=!0;var h=b.HTML5Sound=function(a,b){var c=this;if(f.call(this,a,b),null!=(r=l.audioElement,d(r,r.canPlayType))&&null!=a&&""!=a){var e=window.document;this._snd=e.createElement("audio"),this.addSource(a),b.autoplay&&(this._snd.autoplay=!0),this._snd.volume=b.volume,"true"==j.string(b.preload)?this._snd.preload="auto":"false"==j.string(b.preload)?this._snd.preload="none":this._snd.preload="metadata",null!=b.onload&&(this._snd.onloadeddata=function(){b.onload(c)}),null!=b.onend&&(this._snd.onended=function(){b.onend(c)}),null!=b.onerror&&(this._snd.onerror=function(){b.onerror(c)}),l.sounds.set(a,this),this._snd.load()}};h.__name__=!0,h.__interfaces__=[g],h.__super__=f,h.prototype=c(f.prototype,{addSource:function(a){var b=window.document;if(this._src=b.createElement("source"),this._src.src=a,null!=function(b){var c,d=b._getExt(a);return c=l.types.get(d)}(this)){var c=this._getExt(a);this._src.type=l.types.get(c)}return this._snd.appendChild(this._src),this._src},_getExt:function(a){return a.split(".").pop()},setVolume:function(a){a>=0&&1>=a&&(this._snd.volume=a,this._options.volume=a)},getVolume:function(){return this._options.volume},mute:function(a){this._snd.muted=a},play:function(a){null==a&&(a=!1),this._snd.play(),this._snd.loop=a},loop:function(a){this._snd.loop=a},stop:function(){this._snd.pause(),this._snd.currentTime=0}}),Math.__name__=!0;var i=function(){};i.__name__=!0,i.field=function(a,b){try{return a[b]}catch(c){return c instanceof p&&(c=c.val),null}};var j=function(){};j.__name__=!0,j.string=function(a){return q.__string_rec(a,"")};var k=function(){};k.__name__=!0,k.createInstance=function(a,b){var c=b.length;switch(c){case 0:return new a;case 1:return new a(b[0]);case 2:return new a(b[0],b[1]);case 3:return new a(b[0],b[1],b[2]);case 4:return new a(b[0],b[1],b[2],b[3]);case 5:return new a(b[0],b[1],b[2],b[3],b[4]);case 6:return new a(b[0],b[1],b[2],b[3],b[4],b[5]);case 7:return new a(b[0],b[1],b[2],b[3],b[4],b[5],b[6]);case 8:return new a(b[0],b[1],b[2],b[3],b[4],b[5],b[6],b[7]);default:throw new p("Too many arguments")}return null};var l=b.Waud=function(){};l.__name__=!0,l.init=function(a){null==a&&(a=window.document),l.dom=a;var b=window.document;l.audioElement=b.createElement("audio"),null==l.audioManager&&(l.audioManager=new e),l.isWebAudioSupported=l.audioManager.checkWebAudioAPISupport(),l.isWebAudioSupported&&l.audioManager.createAudioContext(),l.defaults.autoplay=!1,l.defaults.loop=!1,l.defaults.preload="metadata",l.defaults.volume=1,l.sounds=new o,l.types=new o,l.types.set("mp3","audio/mpeg"),l.types.set("ogg","audio/ogg"),l.types.set("wav","audio/wav"),l.types.set("aac","audio/aac"),l.types.set("m4a","audio/x-m4a")},l.enableTouchUnlock=function(a){l.__touchUnlockCallback=a,l.dom.addEventListener("touchend",(r=l.audioManager,d(r,r.unlockAudio)),!0)},l.mute=function(a){for(var b=l.sounds.iterator();b.hasNext();){var c=b.next();c.mute(a)}},l.getSupportString=function(){var a="OGG: "+l.audioElement.canPlayType('audio/ogg; codecs="vorbis"');return a+=", WAV: "+l.audioElement.canPlayType('audio/wav; codecs="1"'),a+=", MP3: "+l.audioElement.canPlayType("audio/mpeg;"),a+=", AAC: "+l.audioElement.canPlayType("audio/aac;"),a+=", M4A: "+l.audioElement.canPlayType("audio/x-m4a;")},l.isSupported=function(){return null!=(r=l.audioElement,d(r,r.canPlayType))},l.isOGGSupported=function(){var a=l.audioElement.canPlayType('audio/ogg; codecs="vorbis"');return null!=(r=l.audioElement,d(r,r.canPlayType))&&null!=a&&("probably"==a||"maybe"==a)},l.isWAVSupported=function(){var a=l.audioElement.canPlayType('audio/wav; codecs="1"');return null!=(r=l.audioElement,d(r,r.canPlayType))&&null!=a&&("probably"==a||"maybe"==a)},l.isMP3Supported=function(){var a=l.audioElement.canPlayType("audio/mpeg;");return null!=(r=l.audioElement,d(r,r.canPlayType))&&null!=a&&("probably"==a||"maybe"==a)},l.isAACSupported=function(){var a=l.audioElement.canPlayType("audio/aac;");return null!=(r=l.audioElement,d(r,r.canPlayType))&&null!=a&&("probably"==a||"maybe"==a)},l.isM4ASupported=function(){var a=l.audioElement.canPlayType("audio/x-m4a;");return null!=(r=l.audioElement,d(r,r.canPlayType))&&null!=a&&("probably"==a||"maybe"==a)};var m=function(){};m.__name__=!0;var n=function(a,b){this.map=a,this.keys=b,this.index=0,this.count=b.length};n.__name__=!0,n.prototype={hasNext:function(){return this.index<this.count},next:function(){return this.map.get(this.keys[this.index++])}};var o=function(){this.h={}};o.__name__=!0,o.__interfaces__=[m],o.prototype={set:function(a,b){null!=t[a]?this.setReserved(a,b):this.h[a]=b},get:function(a){return null!=t[a]?this.getReserved(a):this.h[a]},setReserved:function(a,b){null==this.rh&&(this.rh={}),this.rh["$"+a]=b},getReserved:function(a){return null==this.rh?null:this.rh["$"+a]},arrayKeys:function(){var a=[];for(var b in this.h)this.h.hasOwnProperty(b)&&a.push(b);if(null!=this.rh)for(var b in this.rh)36==b.charCodeAt(0)&&a.push(b.substr(1));return a},iterator:function(){return new n(this,this.arrayKeys())}};var p=function(a){Error.call(this),this.val=a,this.message=String(a),Error.captureStackTrace&&Error.captureStackTrace(this,p)};p.__name__=!0,p.__super__=Error,p.prototype=c(Error.prototype,{});var q=function(){};q.__name__=!0,q.__string_rec=function(a,b){if(null==a)return"null";if(b.length>=5)return"<...>";var c=typeof a;switch("function"==c&&(a.__name__||a.__ename__)&&(c="object"),c){case"object":if(a instanceof Array){if(a.__enum__){if(2==a.length)return a[0];var d=a[0]+"(";b+="	";for(var e=2,f=a.length;f>e;){var g=e++;d+=2!=g?","+q.__string_rec(a[g],b):q.__string_rec(a[g],b)}return d+")"}var h=a.length,i="[";b+="	";for(var j=0;h>j;){var k=j++;i+=(k>0?",":"")+q.__string_rec(a[k],b)}return i+="]"}var l;try{l=a.toString}catch(m){return m instanceof p&&(m=m.val),"???"}if(null!=l&&l!=Object.toString&&"function"==typeof l){var n=a.toString();if("[object Object]"!=n)return n}var o=null,r="{\n";b+="	";var s=null!=a.hasOwnProperty;for(var o in a)(!s||a.hasOwnProperty(o))&&"prototype"!=o&&"__class__"!=o&&"__super__"!=o&&"__interfaces__"!=o&&"__properties__"!=o&&(2!=r.length&&(r+=", \n"),r+=b+o+" : "+q.__string_rec(a[o],b));return b=b.substring(1),r+="\n"+b+"}";case"function":return"<function>";case"string":return a;default:return String(a)}};var r,s=0;String.__name__=!0,Array.__name__=!0;var t={};l.isWebAudioSupported=!1,l.sampleRate=44100,l.defaults={},l.unlocked=!1}("undefined"!=typeof console?console:{log:function(){}},"undefined"!=typeof window?window:exports);