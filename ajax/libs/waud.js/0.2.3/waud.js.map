{
"version":3,
"file":"waud.js",
"sourceRoot":"file:///",
"sources":["/haxe/waud/src/AudioManager.hx","/haxe/waud/src/BaseSound.hx","/usr/lib/haxe/std/js/_std/EReg.hx","/haxe/waud/src/FocusManager.hx","/haxe/waud/src/HTML5Sound.hx","/usr/lib/haxe/std/js/_std/Reflect.hx","/usr/lib/haxe/std/js/_std/Std.hx","/usr/lib/haxe/std/js/_std/Type.hx","/haxe/waud/src/Utils.hx","/haxe/waud/src/Waud.hx","/haxe/waud/src/WaudSound.hx","/haxe/waud/src/WebAudioAPISound.hx","/usr/lib/haxe/std/haxe/Timer.hx","/usr/lib/haxe/std/js/_std/haxe/ds/StringMap.hx","/usr/lib/haxe/std/js/Boot.hx"],
"sourcesContent":["import js.html.audio.AudioBufferSourceNode;\nimport js.html.audio.AudioContext;\nimport js.Browser;\n\nclass AudioManager {\n\n\tpublic var audioContext:AudioContext;\n\tpublic var bufferList:Map<String, Dynamic>;\n\tpublic var playingSounds:Map<String, Dynamic>;\n\n\tstatic var AudioContextClass:Dynamic;\n\n\tpublic function new() {\n\t\tbufferList = new Map();\n\t\tplayingSounds = new Map();\n\t}\n\n\tpublic function checkWebAudioAPISupport():Bool {\n\t\tif (Reflect.field(Browser.window, \"AudioContext\") != null) {\n\t\t\tAudioContextClass = Reflect.field(Browser.window, \"AudioContext\");\n\t\t\treturn true;\n\t\t}\n\t\telse if (Reflect.field(Browser.window, \"webkitAudioContext\") != null) {\n\t\t\tAudioContextClass = Reflect.field(Browser.window, \"webkitAudioContext\");\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tpublic function unlockAudio() {\n\t\tif (audioContext == null) return;\n\t\tvar bfr = audioContext.createBuffer(1, 1, Waud.preferredSampleRate);\n\t\tvar src:AudioBufferSourceNode = audioContext.createBufferSource();\n\t\tsrc.buffer = bfr;\n\t\tsrc.connect(audioContext.destination);\n\t\tsrc.start(0);\n\t\tif (src.onended != null) src.onended = _unlockCallback;\n\t\telse haxe.Timer.delay(_unlockCallback, 1);\n\t}\n\n\tinline function _unlockCallback() {\n\t\tif (Waud.__touchUnlockCallback != null) Waud.__touchUnlockCallback();\n\t\tWaud.dom.ontouchend = null;\n\t}\n\n\tpublic function createAudioContext() {\n\t\tif (audioContext == null) {\n\t\t\ttry {\n\t\t\t\tif (AudioContextClass != null) audioContext = cast Type.createInstance(AudioContextClass, []);\n\t\t\t}\n\t\t\tcatch(e:Dynamic) {\n\t\t\t\taudioContext = null;\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic function destroyContext() {\n\t\tif (audioContext != null && untyped __js__(\"this.audioContext\").close != null && untyped __js__(\"this.audioContext\").close != \"\") {\n\t\t\tuntyped __js__(\"this.audioContext\").close();\n\t\t}\n\t\taudioContext = null;\n\t}\n\n\tpublic function suspendContext() {\n\t\tif (audioContext != null) {\n\t\t\tif (untyped __js__(\"this.audioContext\").suspend != null) untyped __js__(\"this.audioContext\").suspend();\n\t\t}\n\t}\n\n\tpublic function resumeContext() {\n\t\tif (audioContext != null) {\n\t\t\tif (untyped __js__(\"this.audioContext\").resume != null) untyped __js__(\"this.audioContext\").resume();\n\t\t}\n\t}\n}","@:keep class BaseSound {\n\n\tpublic var isSpriteSound:Bool;\n\n\tvar _options:WaudSoundOptions;\n\tvar _isPlaying:Bool;\n\tvar _muted:Bool;\n\n\tpublic function new(url:String, ?options:WaudSoundOptions = null) {\n\t\tif (url == null || url == \"\") {\n\t\t\ttrace(\"invalid sound url\");\n\t\t\treturn;\n\t\t}\n\t\tif (Waud.audioManager == null) {\n\t\t\ttrace(\"initialise Waud using Waud.init() before loading sounds\");\n\t\t\treturn;\n\t\t}\n\t\tisSpriteSound = false;\n\t\t_isPlaying = false;\n\t\t_muted = false;\n\t\tif (options == null) options = {};\n\n\t\toptions.autoplay = (options.autoplay != null) ? options.autoplay : Waud.defaults.autoplay;\n\t\toptions.preload = (options.preload != null) ? options.preload : Waud.defaults.preload;\n\t\toptions.loop = (options.loop != null) ? options.loop : Waud.defaults.loop;\n\t\toptions.volume = (options.volume != null && options.volume >= 0 && options.volume <= 1) ? options.volume : Waud.defaults.volume;\n\n\t\t_options = options;\n\t}\n}","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n@:coreApi class EReg {\n\n\tvar r : HaxeRegExp;\n\n\tpublic function new( r : String, opt : String ) : Void {\n\t\topt = opt.split(\"u\").join(\"\"); // 'u' (utf8) depends on page encoding\n\t\tthis.r = new HaxeRegExp(r, opt);\n\t}\n\n\tpublic function match( s : String ) : Bool {\n\t\tif( r.global ) r.lastIndex = 0;\n\t\tr.m = r.exec(s);\n\t\tr.s = s;\n\t\treturn (r.m != null);\n\t}\n\n\tpublic function matched( n : Int ) : String {\n\t\treturn if( r.m != null && n >= 0 && n < r.m.length ) r.m[n] else throw \"EReg::matched\";\n\t}\n\n\tpublic function matchedLeft() : String {\n\t\tif( r.m == null ) throw \"No string matched\";\n\t\treturn r.s.substr(0,r.m.index);\n\t}\n\n\tpublic function matchedRight() : String {\n\t\tif( r.m == null ) throw \"No string matched\";\n\t\tvar sz = r.m.index+r.m[0].length;\n\t\treturn r.s.substr(sz,r.s.length-sz);\n\t}\n\n\tpublic function matchedPos() : { pos : Int, len : Int } {\n\t\tif( r.m == null ) throw \"No string matched\";\n\t\treturn { pos : r.m.index, len : r.m[0].length };\n\t}\n\n\tpublic function matchSub( s : String, pos : Int, len : Int = -1):Bool {\n\t\treturn if (r.global) {\n\t\t\tr.lastIndex = pos;\n\t\t\tr.m = r.exec(len < 0 ? s : s.substr(0, pos + len));\n\t\t\tvar b = r.m != null;\n\t\t\tif (b) {\n\t\t\t\tr.s = s;\n\t\t\t}\n\t\t\tb;\n\t\t} else {\n\t\t\t// TODO: check some ^/$ related corner cases\n\t\t\tvar b = match( len < 0 ? s.substr(pos) : s.substr(pos,len) );\n\t\t\tif (b) {\n\t\t\t\tr.s = s;\n\t\t\t\tr.m.index += pos;\n\t\t\t}\n\t\t\tb;\n\t\t}\n\t}\n\n\tpublic function split( s : String ) : Array<String> {\n\t\t// we can't use directly s.split because it's ignoring the 'g' flag\n\t\tvar d = \"#__delim__#\";\n\t\treturn untyped s.replace(r,d).split(d);\n\t}\n\n\tpublic function replace( s : String, by : String ) : String {\n\t\treturn untyped s.replace(r,by);\n\t}\n\n\tpublic function map( s : String, f : EReg -> String ) : String {\n\t\tvar offset = 0;\n\t\tvar buf = new StringBuf();\n\t\tdo {\n\t\t\tif (offset >= s.length)\n\t\t\t\tbreak;\n\t\t\telse if (!matchSub(s, offset)) {\n\t\t\t\tbuf.add(s.substr(offset));\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tvar p = matchedPos();\n\t\t\tbuf.add(s.substr(offset, p.pos - offset));\n\t\t\tbuf.add(f(this));\n\t\t\tif (p.len == 0) {\n\t\t\t\tbuf.add(s.substr(p.pos, 1));\n\t\t\t\toffset = p.pos + 1;\n\t\t\t}\n\t\t\telse\n\t\t\t\toffset = p.pos + p.len;\n\t\t} while (r.global);\n\t\tif (!r.global && offset > 0 && offset < s.length)\n\t\t\tbuf.add(s.substr(offset));\n\t\treturn buf.toString();\n\t}\n}\n\n@:native(\"RegExp\")\nprivate extern class HaxeRegExp extends js.RegExp {\n\tvar m:js.RegExp.RegExpMatch;\n\tvar s:String;\n}\n","import js.Browser;\n\nclass FocusManager {\n\n\tpublic static function addEvents(focus:Void -> Void, blur:Void -> Void) {\n\t\tif (Reflect.field(Browser.window, \"addEventListener\") != null) {\n\t\t\tuntyped __js__(\"window\").addEventListener(\"focus\", focus);\n\t\t\tuntyped __js__(\"window\").addEventListener(\"blur\", blur);\n\t\t}\n\t\telse if (Reflect.field(Browser.window, \"attachEvent\") != null) { //IE\n\t\t\tuntyped __js__(\"window\").attachEvent(\"onfocus\", focus);\n\t\t\tuntyped __js__(\"window\").attachEvent(\"onblur\", blur);\n\t\t}\n\t\telse {\n\t\t\tBrowser.window.onload = function () {\n\t\t\t\tBrowser.window.onfocus = focus;\n\t\t\t\tBrowser.window.onblur = blur;\n\t\t\t};\n\t\t}\n\t}\n\n\tpublic static function removeEvents(focus:Void -> Void, blur:Void -> Void) {\n\t\tif (Reflect.field(Browser.window, \"removeEventListener\") != null) {\n\t\t\tuntyped __js__(\"window\").removeEventListener(\"focus\", focus);\n\t\t\tuntyped __js__(\"window\").removeEventListener(\"blur\", blur);\n\t\t}\n\t\telse if (Reflect.field(Browser.window, \"removeEvent\") != null) { //IE\n\t\t\tuntyped __js__(\"window\").removeEvent(\"onfocus\", focus);\n\t\t\tuntyped __js__(\"window\").removeEvent(\"onblur\", blur);\n\t\t}\n\t\telse {\n\t\t\tBrowser.window.onfocus = null;\n\t\t\tBrowser.window.onblur = null;\n\t\t}\n\t}\n}","import haxe.Timer;\nimport js.html.SourceElement;\nimport js.html.AudioElement;\n\n@:expose @:keep class HTML5Sound extends BaseSound implements IWaudSound {\n\n\tvar _snd:AudioElement;\n\tvar _src:SourceElement;\n\tvar _tmr:Timer;\n\n\tpublic function new(url:String, ?options:WaudSoundOptions = null) {\n\t\tsuper(url, options);\n\t\t_snd = Waud.dom.createAudioElement();\n\t\t_addSource(url);\n\n\t\t_snd.autoplay = _options.autoplay;\n\t\t_snd.loop = _options.loop;\n\t\t_snd.volume = _options.volume;\n\n\t\tif (Std.string(_options.preload) == \"true\") _snd.preload = \"auto\";\n\t\telse if (Std.string(_options.preload) == \"false\") _snd.preload = \"none\";\n\t\telse _snd.preload = \"metadata\";\n\n\t\tif (_options.onload != null) {\n\t\t\t_snd.onloadeddata = function() {\n\t\t\t\t_options.onload(this);\n\t\t\t}\n\t\t}\n\n\t\t_snd.onplaying = function() {\n\t\t\t_isPlaying = true;\n\t\t}\n\n\t\t_snd.onended = function() {\n\t\t\t_isPlaying = false;\n\t\t\tif (_options.onend != null) _options.onend(this);\n\t\t}\n\n\t\tif (_options.onerror != null) {\n\t\t\t_snd.onerror = function() {\n\t\t\t\t_options.onerror(this);\n\t\t\t}\n\t\t}\n\n\t\tWaud.sounds.set(url, this);\n\n\t\t_snd.load();\n\t}\n\n\tfunction _addSource(src:String):SourceElement {\n\t\t_src = Waud.dom.createSourceElement();\n\t\t_src.src = src;\n\n\t\tif (Waud.types.get(_getExt(src)) != null) _src.type = Waud.types.get(_getExt(src));\n\t\t_snd.appendChild(_src);\n\n\t\treturn _src;\n\t}\n\n\tfunction _getExt(filename:String):String {\n\t\treturn filename.split(\".\").pop();\n\t}\n\n\tpublic function setVolume(val:Float) {\n\t\tif (val >= 0 && val <= 1) {\n\t\t\t_snd.volume = val;\n\t\t\t_options.volume = val;\n\t\t}\n\t}\n\n\tpublic function getVolume():Float {\n\t\treturn _options.volume;\n\t}\n\n\tpublic function mute(val:Bool) {\n\t\t_snd.muted = val;\n\t\tif (Utils.isiOS()) {\n\t\t\tif (val && isPlaying()) {\n\t\t\t\t_muted = true;\n\t\t\t\t_snd.pause();\n\t\t\t}\n\t\t\telse if (_muted) {\n\t\t\t\t_muted = false;\n\t\t\t\t_snd.play();\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic function play(?spriteName:String, ?soundProps:AudioSpriteSoundProperties):IWaudSound {\n\t\tif (_muted) return this;\n\t\tif (isSpriteSound && soundProps != null) {\n\t\t\t_snd.currentTime = soundProps.start;\n\t\t\tif (_tmr != null) _tmr.stop();\n\t\t\t_tmr = Timer.delay(function() {\n\t\t\t\tif (soundProps.loop != null && soundProps.loop) {\n\t\t\t\t\tplay(spriteName, soundProps);\n\t\t\t\t}\n\t\t\t\telse stop();\n\t\t\t}, Math.ceil(soundProps.duration * 1000));\n\t\t}\n\t\t_snd.play();\n\t\treturn this;\n\t}\n\n\tpublic function isPlaying():Bool {\n\t\treturn _isPlaying;\n\t}\n\n\tpublic function loop(val:Bool) {\n\t\t_snd.loop = val;\n\t}\n\n\tpublic function stop() {\n\t\t_snd.pause();\n\t\t_snd.currentTime = 0;\n\t}\n\n\tpublic function onEnd(callback:IWaudSound -> Void):IWaudSound {\n\t\t_options.onend = callback;\n\t\treturn this;\n\t}\n\n\tpublic function destroy() {\n\t\tif (_snd != null) {\n\t\t\t_snd.pause();\n\t\t\t_snd.removeChild(_src);\n\t\t\t_src = null;\n\t\t\t_snd = null;\n\t\t}\n\t}\n}","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n@:coreApi class Reflect {\n\n\tpublic inline static function hasField( o : Dynamic, field : String ) : Bool {\n\t\treturn untyped __js__('Object').prototype.hasOwnProperty.call(o, field);\n\t}\n\n\tpublic static function field( o : Dynamic, field : String ) : Dynamic {\n\t\ttry return untyped o[field] catch( e : Dynamic ) return null;\n\t}\n\n\tpublic inline static function setField( o : Dynamic, field : String, value : Dynamic ) : Void untyped {\n\t\to[field] = value;\n\t}\n\n\tpublic static inline function getProperty( o : Dynamic, field : String ) : Dynamic untyped {\n\t\tvar tmp;\n\t\treturn if( o == null ) __define_feature__(\"Reflect.getProperty\",null) else if( o.__properties__ && (tmp=o.__properties__[\"get_\"+field]) ) o[tmp]() else o[field];\n\t}\n\n\tpublic static inline function setProperty( o : Dynamic, field : String, value : Dynamic ) : Void untyped {\n\t\tvar tmp;\n\t\tif( o.__properties__ && (tmp=o.__properties__[\"set_\"+field]) ) o[tmp](value) else o[field] = __define_feature__(\"Reflect.setProperty\",value);\n\t}\n\n\tpublic inline static function callMethod( o : Dynamic, func : haxe.Constraints.Function, args : Array<Dynamic> ) : Dynamic untyped {\n\t\treturn func.apply(o,args);\n\t}\n\n\tpublic static function fields( o : Dynamic ) : Array<String> {\n\t\tvar a = [];\n\t\tif (o != null) untyped {\n\t\t\tvar hasOwnProperty = __js__('Object').prototype.hasOwnProperty;\n\t\t\t__js__(\"for( var f in o ) {\");\n\t\t\tif( f != \"__id__\" && f != \"hx__closures__\" && hasOwnProperty.call(o, f) ) a.push(f);\n\t\t\t__js__(\"}\");\n\t\t}\n\t\treturn a;\n\t}\n\n\tpublic static function isFunction( f : Dynamic ) : Bool untyped {\n\t\treturn __js__(\"typeof(f)\") == \"function\" && !(js.Boot.isClass(f) || js.Boot.isEnum(f));\n\t}\n\n\tpublic static function compare<T>( a : T, b : T ) : Int {\n\t\treturn ( a == b ) ? 0 : (((cast a) > (cast b)) ? 1 : -1);\n\t}\n\n\tpublic static function compareMethods( f1 : Dynamic, f2 : Dynamic ) : Bool {\n\t\tif( f1 == f2 )\n\t\t\treturn true;\n\t\tif( !isFunction(f1) || !isFunction(f2) )\n\t\t\treturn false;\n\t\treturn f1.scope == f2.scope && f1.method == f2.method && f1.method != null;\n\t}\n\n\tpublic static function isObject( v : Dynamic ) : Bool untyped {\n\t\tif( v == null )\n\t\t\treturn false;\n\t\tvar t = __js__(\"typeof(v)\");\n\t\treturn (t == \"string\" || (t == \"object\" && v.__enum__ == null)) || (t == \"function\" && (js.Boot.isClass(v) || js.Boot.isEnum(v)) != null);\n\t}\n\n\tpublic static function isEnumValue( v : Dynamic ) : Bool {\n\t\treturn v != null && v.__enum__ != null;\n\t}\n\n\tpublic static function deleteField( o : Dynamic, field : String ) : Bool untyped {\n\t\tif( !hasField(o,field) ) return false;\n\t\t__js__(\"delete\")(o[field]);\n\t\treturn true;\n\t}\n\n\tpublic static function copy<T>( o : T ) : T {\n\t\tvar o2 : Dynamic = {};\n\t\tfor( f in Reflect.fields(o) )\n\t\t\tReflect.setField(o2,f,Reflect.field(o,f));\n\t\treturn o2;\n\t}\n\n\t@:overload(function( f : Array<Dynamic> -> Void ) : Dynamic {})\n\tpublic static function makeVarArgs( f : Array<Dynamic> -> Dynamic ) : Dynamic {\n\t\treturn function() {\n\t\t\tvar a = untyped Array.prototype.slice.call(__js__(\"arguments\"));\n\t\t\treturn f(a);\n\t\t};\n\t}\n\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\nimport js.Boot;\n\n@:keepInit\n@:coreApi class Std {\n\n\tpublic static inline function is( v : Dynamic, t : Dynamic ) : Bool {\n\t\treturn untyped js.Boot.__instanceof(v,t);\n\t}\n\n\tpublic static inline function instance<T:{},S:T>( value : T, c : Class<S> ) : S {\n\t\treturn untyped __instanceof__(value, c) ? cast value : null;\n\t}\n\n\tpublic static function string( s : Dynamic ) : String {\n\t\treturn untyped js.Boot.__string_rec(s,\"\");\n\t}\n\n\tpublic static inline function int( x : Float ) : Int {\n\t\treturn (cast x) | 0;\n\t}\n\n\tpublic static function parseInt( x : String ) : Null<Int> {\n\t\tvar v = untyped __js__(\"parseInt\")(x, 10);\n\t\t// parse again if hexadecimal\n\t\tif( v == 0 && (x.charCodeAt(1) == 'x'.code || x.charCodeAt(1) == 'X'.code) )\n\t\t\tv = untyped __js__(\"parseInt\")(x);\n\t\tif( untyped __js__(\"isNaN\")(v) )\n\t\t\treturn null;\n\t\treturn cast v;\n\t}\n\n\tpublic static inline function parseFloat( x : String ) : Float {\n\t\treturn untyped __js__(\"parseFloat\")(x);\n\t}\n\n\tpublic static function random( x : Int ) : Int {\n\t\treturn untyped x <= 0 ? 0 : Math.floor(Math.random()*x);\n\t}\n\n\tstatic function __init__() : Void untyped {\n\t\t__feature__(\"js.Boot.getClass\",String.prototype.__class__ = __feature__(\"Type.resolveClass\",$hxClasses[\"String\"] = String,String));\n\t\t__feature__(\"js.Boot.isClass\",String.__name__ = __feature__(\"Type.getClassName\",[\"String\"],true));\n\t\t__feature__(\"Type.resolveClass\",$hxClasses[\"Array\"] = Array);\n\t\t__feature__(\"js.Boot.isClass\",Array.__name__ = __feature__(\"Type.getClassName\",[\"Array\"],true));\n\t\t__feature__(\"Date.*\", {\n\t\t\t__feature__(\"js.Boot.getClass\",__js__('Date').prototype.__class__ = __feature__(\"Type.resolveClass\",$hxClasses[\"Date\"] = __js__('Date'),__js__('Date')));\n\t\t\t__feature__(\"js.Boot.isClass\",__js__('Date').__name__ = [\"Date\"]);\n\t\t});\n\t\t__feature__(\"Int.*\",{\n\t\t\tvar Int = __feature__(\"Type.resolveClass\", $hxClasses[\"Int\"] = { __name__ : [\"Int\"] }, { __name__ : [\"Int\"] });\n\t\t});\n\t\t__feature__(\"Dynamic.*\",{\n\t\t\tvar Dynamic = __feature__(\"Type.resolveClass\", $hxClasses[\"Dynamic\"] = { __name__ : [\"Dynamic\"] }, { __name__ : [\"Dynamic\"] });\n\t\t});\n\t\t__feature__(\"Float.*\",{\n\t\t\tvar Float = __feature__(\"Type.resolveClass\", $hxClasses[\"Float\"] = __js__(\"Number\"), __js__(\"Number\"));\n\t\t\tFloat.__name__ = [\"Float\"];\n\t\t});\n\t\t__feature__(\"Bool.*\",{\n\t\t\tvar Bool = __feature__(\"Type.resolveEnum\",$hxClasses[\"Bool\"] = __js__(\"Boolean\"), __js__(\"Boolean\"));\n\t\t\tBool.__ename__ = [\"Bool\"];\n\t\t});\n\t\t__feature__(\"Class.*\",{\n\t\t\tvar Class = __feature__(\"Type.resolveClass\", $hxClasses[\"Class\"] = { __name__ : [\"Class\"] }, { __name__ : [\"Class\"] });\n\t\t});\n\t\t__feature__(\"Enum.*\",{\n\t\t\tvar Enum = {};\n\t\t});\n\t\t__feature__(\"Void.*\",{\n\t\t\tvar Void = __feature__(\"Type.resolveEnum\", $hxClasses[\"Void\"] = { __ename__ : [\"Void\"] }, { __ename__ : [\"Void\"] });\n\t\t});\n\n#if !js_es5\n\t\t__feature__(\"Array.map\",\n\t\t\tif( Array.prototype.map == null )\n\t\t\t\tArray.prototype.map = function(f) {\n\t\t\t\t\tvar a = [];\n\t\t\t\t\tfor( i in 0...__this__.length )\n\t\t\t\t\t\ta[i] = f(__this__[i]);\n\t\t\t\t\treturn a;\n\t\t\t\t}\n\t\t);\n\t\t__feature__(\"Array.filter\",\n\t\t\tif( Array.prototype.filter == null )\n\t\t\t\tArray.prototype.filter = function(f) {\n\t\t\t\t\tvar a = [];\n\t\t\t\t\tfor( i in 0...__this__.length ) {\n\t\t\t\t\t\tvar e = __this__[i];\n\t\t\t\t\t\tif( f(e) ) a.push(e);\n\t\t\t\t\t}\n\t\t\t\t\treturn a;\n\t\t\t\t}\n\t\t);\n#end\n\t}\n\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\nenum ValueType {\n\tTNull;\n\tTInt;\n\tTFloat;\n\tTBool;\n\tTObject;\n\tTFunction;\n\tTClass( c : Class<Dynamic> );\n\tTEnum( e : Enum<Dynamic> );\n\tTUnknown;\n}\n\n@:coreApi class Type {\n\n\tpublic static inline function getClass<T>( o : T ) : Class<T> {\n\t\treturn if (o == null) null else @:privateAccess js.Boot.getClass(o);\n\t}\n\n\tpublic static function getEnum( o : EnumValue ) : Enum<Dynamic> untyped {\n\t\tif( o == null )\n\t\t\treturn null;\n\t\treturn o.__enum__;\n\t}\n\n\tpublic static function getSuperClass( c : Class<Dynamic> ) : Class<Dynamic> untyped {\n\t\treturn c.__super__;\n\t}\n\n\n\tpublic static function getClassName( c : Class<Dynamic> ) : String {\n\t\tvar a : Array<String> = untyped c.__name__;\n\t\tif (a == null)\n\t\t\treturn null;\n\t\treturn a.join(\".\");\n\t}\n\n\tpublic static function getEnumName( e : Enum<Dynamic> ) : String {\n\t\tvar a : Array<String> = untyped e.__ename__;\n\t\treturn a.join(\".\");\n\t}\n\n\tpublic static function resolveClass( name : String ) : Class<Dynamic> untyped {\n\t\tvar cl : Class<Dynamic> = $hxClasses[name];\n\t\t// ensure that this is a class\n\t\tif( cl == null || !js.Boot.isClass(cl) )\n\t\t\treturn null;\n\t\treturn cl;\n\t}\n\n\tpublic static function resolveEnum( name : String ) : Enum<Dynamic> untyped {\n\t\tvar e : Dynamic = $hxClasses[name];\n\t\t// ensure that this is an enum\n\t\tif( e == null || !js.Boot.isEnum(e) )\n\t\t\treturn null;\n\t\treturn e;\n\t}\n\n\tpublic static function createInstance<T>( cl : Class<T>, args : Array<Dynamic> ) : T untyped {\n\t\tswitch( args.length ) {\n\t\tcase 0:\n\t\t\treturn __new__(cl);\n\t\tcase 1:\n\t\t\treturn __new__(cl,args[0]);\n\t\tcase 2:\n\t\t\treturn __new__(cl,args[0],args[1]);\n\t\tcase 3:\n\t\t\treturn __new__(cl,args[0],args[1],args[2]);\n\t\tcase 4:\n\t\t\treturn __new__(cl,args[0],args[1],args[2],args[3]);\n\t\tcase 5:\n\t\t\treturn __new__(cl,args[0],args[1],args[2],args[3],args[4]);\n\t\tcase 6:\n\t\t\treturn __new__(cl,args[0],args[1],args[2],args[3],args[4],args[5]);\n\t\tcase 7:\n\t\t\treturn __new__(cl,args[0],args[1],args[2],args[3],args[4],args[5],args[6]);\n\t\tcase 8:\n\t\t\treturn __new__(cl,args[0],args[1],args[2],args[3],args[4],args[5],args[6],args[7]);\n\t\tdefault:\n\t\t\tthrow \"Too many arguments\";\n\t\t}\n\t\treturn null;\n\t}\n\n\tpublic static function createEmptyInstance<T>( cl : Class<T> ) : T untyped {\n\t\t__js__(\"function empty() {}; empty.prototype = cl.prototype\");\n\t\treturn __js__(\"new empty()\");\n\t}\n\n\tpublic static function createEnum<T>( e : Enum<T>, constr : String, ?params : Array<Dynamic> ) : T {\n\t\tvar f:Dynamic = Reflect.field(e,constr);\n\t\tif( f == null ) throw \"No such constructor \"+constr;\n\t\tif( Reflect.isFunction(f) ) {\n\t\t\tif( params == null ) throw \"Constructor \"+constr+\" need parameters\";\n\t\t\treturn Reflect.callMethod(e,f,params);\n\t\t}\n\t\tif( params != null && params.length != 0 )\n\t\t\tthrow \"Constructor \"+constr+\" does not need parameters\";\n\t\treturn f;\n\t}\n\n\tpublic static function createEnumIndex<T>( e : Enum<T>, index : Int, ?params : Array<Dynamic> ) : T {\n\t\tvar c : String = (untyped e.__constructs__)[index];\n\t\tif( c == null ) throw index+\" is not a valid enum constructor index\";\n\t\treturn createEnum(e,c,params);\n\t}\n\n\tpublic static function getInstanceFields( c : Class<Dynamic> ) : Array<String> {\n\t\tvar a = [];\n\t\tuntyped __js__(\"for(var i in c.prototype) a.push(i)\");\n\t\ta.remove(\"__class__\");\n\t\ta.remove(\"__properties__\");\n\t\treturn a;\n\t}\n\n\tpublic static function getClassFields( c : Class<Dynamic> ) : Array<String> {\n\t\tvar a = Reflect.fields(c);\n\t\ta.remove(\"__name__\");\n\t\ta.remove(\"__interfaces__\");\n\t\ta.remove(\"__properties__\");\n\t\ta.remove(\"__super__\");\n\t\ta.remove(\"__meta__\");\n\t\ta.remove(\"prototype\");\n\t\treturn a;\n\t}\n\n\tpublic static function getEnumConstructs( e : Enum<Dynamic> ) : Array<String> {\n\t\tvar a : Array<String> = untyped e.__constructs__;\n\t\treturn a.copy();\n\t}\n\n\tpublic static function typeof( v : Dynamic ) : ValueType untyped {\n\t\tswitch( __js__(\"typeof\")(v) ) {\n\t\tcase \"boolean\": return TBool;\n\t\tcase \"string\": return TClass(String);\n\t\tcase \"number\":\n\t\t\t// this should handle all cases : NaN, +/-Inf and Floats outside range\n\t\t\tif( Math.ceil(v) == v%2147483648.0 )\n\t\t\t\treturn TInt;\n\t\t\treturn TFloat;\n\t\tcase \"object\":\n\t\t\tif( v == null )\n\t\t\t\treturn TNull;\n\t\t\tvar e = v.__enum__;\n\t\t\tif( e != null )\n\t\t\t\treturn TEnum(e);\n\t\t\tvar c = js.Boot.getClass(v);\n\t\t\tif( c != null )\n\t\t\t\treturn TClass(c);\n\t\t\treturn TObject;\n\t\tcase \"function\":\n\t\t\tif( js.Boot.isClass(v) || js.Boot.isEnum(v) )\n\t\t\t\treturn TObject;\n\t\t\treturn TFunction;\n\t\tcase \"undefined\":\n\t\t\treturn TNull;\n\t\tdefault:\n\t\t\treturn TUnknown;\n\t\t}\n\t}\n\n\tpublic static function enumEq<T>( a : T, b : T ) : Bool untyped {\n\t\tif( a == b )\n\t\t\treturn true;\n\t\ttry {\n\t\t\tif( a[0] != b[0] )\n\t\t\t\treturn false;\n\t\t\tfor( i in 2...a.length )\n\t\t\t\tif( !enumEq(a[i],b[i]) )\n\t\t\t\t\treturn false;\n\t\t\tvar e = a.__enum__;\n\t\t\tif( e != b.__enum__ || e == null )\n\t\t\t\treturn false;\n\t\t} catch( e : Dynamic ) {\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\tpublic inline static function enumConstructor( e : EnumValue ) : String {\n\t\treturn untyped e[0];\n\t}\n\n\tpublic inline static function enumParameters( e : EnumValue ) : Array<Dynamic> {\n\t\treturn untyped e.slice(2);\n\t}\n\n\tpublic inline static function enumIndex( e : EnumValue ) : Int {\n\t\treturn untyped e[1];\n\t}\n\n\tpublic static function allEnums<T>( e : Enum<T> ) : Array<T> {\n\t\treturn untyped e.__empty_constructs__;\n\t}\n\n}\n\n","import js.Browser;\n\nclass Utils {\n\n\tpublic static function isAndroid():Bool {\n\t\treturn ~/Android/i.match(Browser.navigator.userAgent);\n\t}\n\n\tpublic static function isiOS():Bool {\n\t\treturn ~/(iPad|iPhone|iPod)/i.match(Browser.navigator.userAgent);\n\t}\n\n\tpublic static function getiOSVersion():Array<Int> {\n\t\tvar v:EReg = ~/[0-9_]+?[0-9_]+?[0-9_]+/i;\n\t\tvar matched:Array<Int> = [];\n\t\tif (v.match(Browser.navigator.userAgent)) {\n\t\t\tvar match:Array<String> = v.matched(0).split(\"_\");\n\t\t\tmatched = [for (i in match) Std.parseInt(i)];\n\t\t}\n\t\treturn matched;\n\t}\n\n\tpublic static function isMobile():Bool {\n\t\tvar ua = Browser.navigator.userAgent;\n\t\treturn (~/Android/i.match(ua) || ~/webOS/i.match(ua)\n\t\t|| ~/iPhone/i.match(ua) || ~/iPad/i.match(ua) || ~/iPod/i.match(ua)\n\t\t|| ~/BlackBerry/i.match(ua) || ~/Windows Phone/i.match(ua));\n\t}\n\n\tpublic static function isChrome():Bool{\n\t\treturn Browser.navigator.userAgent.toLowerCase().indexOf(\"chrome\") > -1;\n\t}\n}","import js.html.HTMLDocument;\nimport js.html.AudioElement;\nimport js.Browser;\n\n@:expose @:keep class Waud {\n\n\tpublic static var isWebAudioSupported:Bool;\n\tpublic static var isHTML5AudioSupported:Bool;\n\tpublic static var audioManager:AudioManager;\n\tpublic static var defaults:WaudSoundOptions = {};\n\tpublic static var sounds:Map<String, IWaudSound>;\n\tpublic static var types:Map<String, String>;\n\tpublic static var dom:HTMLDocument;\n\tpublic static var preferredSampleRate:Int = 44100;\n\tpublic static var isMuted:Bool = false;\n\n\tstatic var audioElement:AudioElement;\n\n\tpublic static var __touchUnlockCallback:Void -> Void;\n\n\tpublic static function init(?d:HTMLDocument) {\n\t\tif (d == null) d = Browser.document;\n\t\tdom = d;\n\t\taudioElement = dom.createAudioElement();\n\t\tif (Waud.audioManager == null) Waud.audioManager = new AudioManager();\n\t\tisWebAudioSupported = Waud.audioManager.checkWebAudioAPISupport();\n\t\tisHTML5AudioSupported = (Reflect.field(Browser.window, \"Audio\") != null);\n\n\t\tif (isWebAudioSupported) Waud.audioManager.createAudioContext();\n\t\telse if (!isHTML5AudioSupported) trace(\"no audio support in this browser\");\n\n\t\tdefaults.autoplay = false;\n\t\tdefaults.loop = false;\n\t\tdefaults.preload = \"true\";\n\t\tdefaults.volume = 1;\n\n\t\tsounds = new Map();\n\n\t\ttypes = new Map();\n\t\ttypes.set(\"mp3\", \"audio/mpeg\");\n\t\ttypes.set(\"ogg\", \"audio/ogg\");\n\t\ttypes.set(\"wav\", \"audio/wav\");\n\t\ttypes.set(\"aac\", \"audio/aac\");\n\t\ttypes.set(\"m4a\", \"audio/x-m4a\");\n\t}\n\n\tpublic static function autoMute(?val:Bool = true) {\n\t\tvar blur = function() {\n\t\t\tfor (sound in sounds) sound.mute(true);\n\t\t};\n\n\t\tvar focus = function() {\n\t\t\tif (!isMuted) for (sound in sounds) sound.mute(false);\n\t\t};\n\n\t\tif (val) FocusManager.addEvents(focus, blur);\n\t\telse {\n\t\t\tFocusManager.removeEvents(focus, blur);\n\t\t\tfocus = null;\n\t\t\tblur = null;\n\t\t}\n\t}\n\n\tpublic static function enableTouchUnlock(?callback:Void -> Void) {\n\t\t__touchUnlockCallback = callback;\n\t\tdom.ontouchend = Waud.audioManager.unlockAudio;\n\t}\n\n\tpublic static function mute(?val:Bool = true) {\n\t\tisMuted = val;\n\t\tfor (sound in sounds) sound.mute(val);\n\t}\n\n\tpublic static function stop() {\n\t\tfor (sound in sounds) sound.stop();\n\t}\n\n\tpublic static function getFormatSupportString():String {\n\t\tvar support:String = \"OGG: \" + audioElement.canPlayType('audio/ogg; codecs=\"vorbis\"');\n\t\tsupport += \", WAV: \" + audioElement.canPlayType('audio/wav; codecs=\"1\"');\n\t\tsupport += \", MP3: \" + audioElement.canPlayType('audio/mpeg;');\n\t\tsupport += \", AAC: \" + audioElement.canPlayType('audio/aac;');\n\t\tsupport += \", M4A: \" + audioElement.canPlayType('audio/x-m4a;');\n\t\treturn support;\n\t}\n\n\tpublic static function isSupported():Bool {\n\t\tif (isWebAudioSupported == null || isHTML5AudioSupported == null) {\n\t\t\tisWebAudioSupported = Waud.audioManager.checkWebAudioAPISupport();\n\t\t\tisHTML5AudioSupported = (Reflect.field(Browser.window, \"Audio\") != null);\n\t\t}\n\t\treturn (isWebAudioSupported || isHTML5AudioSupported);\n\t}\n\n\tpublic static function isOGGSupported():Bool {\n\t\tvar canPlay = audioElement.canPlayType('audio/ogg; codecs=\"vorbis\"');\n\t\treturn (isHTML5AudioSupported && canPlay != null && (canPlay == \"probably\" || canPlay == \"maybe\"));\n\t}\n\n\tpublic static function isWAVSupported():Bool {\n\t\tvar canPlay = audioElement.canPlayType('audio/wav; codecs=\"1\"');\n\t\treturn (isHTML5AudioSupported && canPlay != null && (canPlay == \"probably\" || canPlay == \"maybe\"));\n\t}\n\n\tpublic static function isMP3Supported():Bool {\n\t\tvar canPlay = audioElement.canPlayType('audio/mpeg;');\n\t\treturn (isHTML5AudioSupported && canPlay != null && (canPlay == \"probably\" || canPlay == \"maybe\"));\n\t}\n\n\tpublic static function isAACSupported():Bool {\n\t\tvar canPlay = audioElement.canPlayType('audio/aac;');\n\t\treturn (isHTML5AudioSupported && canPlay != null && (canPlay == \"probably\" || canPlay == \"maybe\"));\n\t}\n\n\tpublic static function isM4ASupported():Bool {\n\t\tvar canPlay = audioElement.canPlayType('audio/x-m4a;');\n\t\treturn (isHTML5AudioSupported && canPlay != null && (canPlay == \"probably\" || canPlay == \"maybe\"));\n\t}\n}","import js.html.XMLHttpRequest;\nimport haxe.Json;\n\n@:expose @:keep class WaudSound implements IWaudSound {\n\n\tpublic var isSpriteSound:Bool;\n\n\tvar _snd:IWaudSound;\n\tvar _options:WaudSoundOptions;\n\tvar _spriteData:AudioSprite;\n\n\tpublic function new(src:String, ?options:WaudSoundOptions = null) {\n\t\tif (Waud.audioManager == null) {\n\t\t\ttrace(\"initialise Waud using Waud.init() before loading sounds\");\n\t\t\treturn;\n\t\t}\n\n\t\t_options = options;\n\n\t\tif (src.indexOf(\".json\") > 0) {\n\t\t\tisSpriteSound = true;\n\t\t\t_loadSpriteJson(src);\n\t\t}\n\t\telse {\n\t\t\tisSpriteSound = false;\n\t\t\t_init(src);\n\t\t}\n\t}\n\n\tfunction _loadSpriteJson(url:String) {\n\t\tvar xobj = new XMLHttpRequest();\n\t\txobj.overrideMimeType(\"application/json\");\n\t\txobj.open(\"GET\", url, true);\n\t\txobj.onreadystatechange = function() {\n\t\t\tif (xobj.readyState == 4 && xobj.status == 200) {\n\t\t\t\t_spriteData = Json.parse(xobj.response);\n\t\t\t\t_init(_spriteData.src);\n\t\t\t}\n\t\t};\n\t\txobj.send(null);\n\t}\n\n\tfunction _init(src:String) {\n\t\tif (Waud.isWebAudioSupported) _snd = new WebAudioAPISound(src, _options);\n\t\telse if (Waud.isHTML5AudioSupported) _snd = new HTML5Sound(src, _options);\n\t\telse trace(\"no audio support in this browser\");\n\n\t\t_snd.isSpriteSound = isSpriteSound;\n\t}\n\n\tpublic function setVolume(val:Float) {\n\t\t_snd.setVolume(val);\n\t}\n\n\tpublic function getVolume():Float {\n\t\treturn _snd.getVolume();\n\t}\n\n\tpublic function mute(val:Bool) {\n\t\t_snd.mute(val);\n\t}\n\n\tpublic function play(?spriteName:String, ?soundProps:AudioSpriteSoundProperties = null):IWaudSound {\n\t\tif (spriteName != null) {\n\t\t\tfor (snd in _spriteData.sprite) {\n\t\t\t\tif (snd.name == spriteName) {\n\t\t\t\t\tsoundProps = snd;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t_snd.play(spriteName, soundProps);\n\t\treturn this;\n\t}\n\n\tpublic function isPlaying():Bool {\n\t\treturn _snd.isPlaying();\n\t}\n\n\tpublic function loop(val:Bool) {\n\t\t_snd.loop(val);\n\t}\n\n\tpublic function stop() {\n\t\t_snd.stop();\n\t}\n\n\tpublic function onEnd(callback:IWaudSound -> Void):IWaudSound {\n\t\t_snd.onEnd(callback);\n\t\treturn this;\n\t}\n\n\tpublic function destroy() {\n\t\t_snd.destroy();\n\t\t_snd = null;\n\t}\n}","import js.html.XMLHttpRequestResponseType;\nimport js.html.XMLHttpRequest;\nimport js.html.audio.GainNode;\nimport js.html.audio.AudioBufferSourceNode;\nimport js.html.audio.AudioBuffer;\n\n@:expose @:keep class WebAudioAPISound extends BaseSound implements IWaudSound {\n\n\tvar _url:String;\n\tvar _manager:AudioManager;\n\tvar _snd:AudioBufferSourceNode;\n\tvar _gainNode:GainNode;\n\n\tpublic function new(url:String, ?options:WaudSoundOptions = null) {\n\t\tsuper(url, options);\n\n\t\t_url = url;\n\t\t_manager = Waud.audioManager;\n\n\t\tvar request = new XMLHttpRequest();\n\t\trequest.open(\"GET\", _url, true);\n\t\trequest.responseType = XMLHttpRequestResponseType.ARRAYBUFFER;\n\t\trequest.onload = _onSoundLoaded;\n\t\trequest.onerror = _error;\n\t\trequest.send();\n\n\t\tWaud.sounds.set(url, this);\n\t}\n\n\tfunction _onSoundLoaded(evt) {\n\t\t_manager.audioContext.decodeAudioData(evt.target.response, _decodeSuccess, _error);\n\t}\n\n\tfunction _decodeSuccess(buffer:AudioBuffer) {\n\t\tif (buffer == null) {\n\t\t\ttrace(\"empty buffer: \" + _url);\n\t\t\t_error();\n\t\t\treturn;\n\t\t}\n\t\t_manager.bufferList.set(_url, buffer);\n\t\tif (_options.onload != null) _options.onload(this);\n\t\tif (_options.autoplay) play();\n\t}\n\n\tinline function _error() {\n\t\tif (_options.onerror != null) _options.onerror(this);\n\t}\n\n\tfunction _makeSource(buffer:AudioBuffer):AudioBufferSourceNode {\n\t\tvar source:AudioBufferSourceNode = _manager.audioContext.createBufferSource();\n\t\t_gainNode = _manager.audioContext.createGain();\n\t\t_gainNode.gain.value = _options.volume;\n\t\tsource.buffer = buffer;\n\t\tsource.connect(_gainNode);\n\t\t_gainNode.connect(_manager.audioContext.destination);\n\t\treturn source;\n\t}\n\n\tpublic function play(?spriteName:String, ?soundProps:AudioSpriteSoundProperties):IWaudSound {\n\t\tif (_muted) return this;\n\t\tvar start:Float = 0;\n\t\tvar end:Float = -1;\n\t\tif (isSpriteSound && soundProps != null) {\n\t\t\tstart = soundProps.start;\n\t\t\tend = soundProps.duration;\n\t\t}\n\t\tvar buffer = _manager.bufferList.get(_url);\n\t\tif (buffer != null) {\n\t\t\t_snd = _makeSource(buffer);\n\t\t\tif (start >= 0 && end > -1) _snd.start(0, start, end);\n\t\t\telse {\n\t\t\t\t_snd.loop = _options.loop;\n\t\t\t\t_snd.start(0);\n\t\t\t}\n\n\t\t\t_isPlaying = true;\n\t\t\t_snd.onended = function() {\n\t\t\t\tif (isSpriteSound && soundProps != null && soundProps.loop && start >= 0 && end > -1) {\n\t\t\t\t\tplay(spriteName, soundProps);\n\t\t\t\t}\n\t\t\t\t_isPlaying = false;\n\t\t\t\tif (_options.onend != null) _options.onend(this);\n\t\t\t}\n\n\t\t\tif(_manager.playingSounds.get(_url) == null) _manager.playingSounds.set(_url, _snd);\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tpublic function isPlaying():Bool {\n\t\treturn _isPlaying;\n\t}\n\n\tpublic function loop(val:Bool) {\n\t\tif (_snd == null) return;\n\t\t_snd.loop = val;\n\t}\n\n\tpublic function setVolume(val:Float) {\n\t\tif (_gainNode == null) return;\n\t\t_options.volume = val;\n\t\t_gainNode.gain.value = _options.volume;\n\t}\n\n\tpublic function getVolume():Float {\n\t\treturn _options.volume;\n\t}\n\n\tpublic function mute(val:Bool) {\n\t\t_muted = val;\n\t\tif (_gainNode == null) return;\n\t\tif (val) _gainNode.gain.value = 0;\n\t\telse _gainNode.gain.value = _options.volume;\n\t}\n\n\tpublic function stop() {\n\t\tif (_snd == null) return;\n\t\t_snd.stop(0);\n\t}\n\n\tpublic function onEnd(callback:IWaudSound -> Void):IWaudSound {\n\t\t_options.onend = callback;\n\t\treturn this;\n\t}\n\n\tpublic function destroy() {\n\t\tif (_snd != null) {\n\t\t\t_snd.stop(0);\n\t\t\t_snd.disconnect();\n\t\t\t_snd = null;\n\t\t}\n\t\tif (_gainNode != null) {\n\t\t\t_gainNode.disconnect();\n\t\t\t_gainNode = null;\n\t\t}\n\t}\n}","/*\n * Copyright (C)2005-2013 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe;\n\n/**\n\tThe Timer class allows you to create asynchronous timers on platforms that\n\tsupport events.\n\n\tThe intended usage is to create an instance of the Timer class with a given\n\tinterval, set its run() method to a custom function to be invoked and\n\teventually call stop() to stop the Timer.\n\n\tNote that a running Timer may or may not prevent the program to exit\n\tautomatically when main() returns.\n\n\tIt is also possible to extend this class and override its run() method in\n\tthe child class.\n**/\nclass Timer {\n\t#if (flash || js || java || python)\n\n\t#if (flash || js)\n\t\tprivate var id : Null<Int>;\n\t#elseif java\n\t\tprivate var timer : java.util.Timer;\n\t\tprivate var task : java.util.TimerTask;\n\t#end\n\n\t/**\n\t\tCreates a new timer that will run every `time_ms` milliseconds.\n\n\t\tAfter creating the Timer instance, it calls `this].run` repeatedly,\n\t\twith delays of `time_ms` milliseconds, until `this.stop` is called.\n\n\t\tThe first invocation occurs after `time_ms` milliseconds, not\n\t\timmediately.\n\n\t\tThe accuracy of this may be platform-dependent.\n\t**/\n\tpublic function new( time_ms : Int ){\n\t\t#if flash\n\t\t\tvar me = this;\n\t\t\tid = untyped __global__[\"flash.utils.setInterval\"](function() { me.run(); },time_ms);\n\t\t#elseif js\n\t\t\tvar me = this;\n\t\t\tid = untyped setInterval(function() me.run(),time_ms);\n\t\t#elseif java\n\t\t\ttimer = new java.util.Timer();\n\t\t\ttimer.scheduleAtFixedRate(task = new TimerTask(this), haxe.Int64.ofInt(time_ms), haxe.Int64.ofInt(time_ms));\n\t\t#end\n\t}\n\n\t/**\n\t\tStops `this` Timer.\n\n\t\tAfter calling this method, no additional invocations of `this.run`\n\t\twill occur.\n\n\t\tIt is not possible to restart `this` Timer once stopped.\n\t**/\n\tpublic function stop() {\n\t\t#if (flash || js)\n\t\t\tif( id == null )\n\t\t\t\treturn;\n\t\t\t#if flash\n\t\t\t\tuntyped __global__[\"flash.utils.clearInterval\"](id);\n\t\t\t#elseif js\n\t\t\t\tuntyped clearInterval(id);\n\t\t\t#end\n\t\t\tid = null;\n\t\t#elseif java\n\t\t\ttimer.cancel();\n\t\t\ttimer = null;\n\t\t\ttask = null;\n\t\t#end\n\t}\n\n\t/**\n\t\tThis method is invoked repeatedly on `this` Timer.\n\n\t\tIt can be overridden in a subclass, or rebound directly to a custom\n\t\tfunction:\n\t\t\tvar timer = new haxe.Timer(1000); // 1000ms delay\n\t\t\ttimer.run = function() { ... }\n\n\t\tOnce bound, it can still be rebound to different functions until `this`\n\t\tTimer is stopped through a call to `this.stop`.\n\t**/\n\tpublic dynamic function run() {\n\n\t}\n\n\t/**\n\t\tInvokes `f` after `time_ms` milliseconds.\n\n\t\tThis is a convenience function for creating a new Timer instance with\n\t\t`time_ms` as argument, binding its run() method to `f` and then stopping\n\t\t`this` Timer upon the first invocation.\n\n\t\tIf `f` is null, the result is unspecified.\n\t**/\n\tpublic static function delay( f : Void -> Void, time_ms : Int ) {\n\t\tvar t = new haxe.Timer(time_ms);\n\t\tt.run = function() {\n\t\t\tt.stop();\n\t\t\tf();\n\t\t};\n\t\treturn t;\n\t}\n\n\t#end\n\n\t/**\n\t\tMeasures the time it takes to execute `f`, in seconds with fractions.\n\n\t\tThis is a convenience function for calculating the difference between\n\t\tTimer.stamp() before and after the invocation of `f`.\n\n\t\tThe difference is passed as argument to Log.trace(), with \"s\" appended\n\t\tto denote the unit. The optional `pos` argument is passed through.\n\n\t\tIf `f` is null, the result is unspecified.\n\t**/\n\tpublic static function measure<T>( f : Void -> T, ?pos : PosInfos ) : T {\n\t\tvar t0 = stamp();\n\t\tvar r = f();\n\t\tLog.trace((stamp() - t0) + \"s\", pos);\n\t\treturn r;\n\t}\n\n\t/**\n\t\tReturns a timestamp, in seconds with fractions.\n\n\t\tThe value itself might differ depending on platforms, only differences\n\t\tbetween two values make sense.\n\t**/\n\tpublic static function stamp() : Float {\n\t\t#if flash\n\t\t\treturn flash.Lib.getTimer() / 1000;\n\t\t#elseif (neko || php)\n\t\t\treturn Sys.time();\n\t\t#elseif js\n\t\t\treturn Date.now().getTime() / 1000;\n\t\t#elseif cpp\n\t\t\treturn untyped __global__.__time_stamp();\n\t\t#elseif sys\n\t\t\treturn Sys.time();\n\t\t#else\n\t\t\treturn 0;\n\t\t#end\n\t}\n\n}\n\n#if java\n@:nativeGen\nprivate class TimerTask extends java.util.TimerTask {\n\tvar timer:Timer;\n\tpublic function new(timer:Timer):Void {\n\t\tsuper();\n\t\tthis.timer = timer;\n\t}\n\n\t@:overload override public function run():Void {\n\t\ttimer.run();\n\t}\n}\n#end\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe.ds;\n\nprivate class StringMapIterator<T> {\n\tvar map : StringMap<T>;\n\tvar keys : Array<String>;\n\tvar index : Int;\n\tvar count : Int;\n\tpublic inline function new(map:StringMap<T>, keys:Array<String>) {\n\t\tthis.map = map;\n\t\tthis.keys = keys;\n\t\tthis.index = 0;\n\t\tthis.count = keys.length;\n\t}\n\tpublic inline function hasNext() {\n\t\treturn index < count;\n\t}\n\tpublic inline function next() {\n\t\treturn map.get(keys[index++]);\n\t}\n}\n\n@:coreApi class StringMap<T> implements haxe.Constraints.IMap<String,T> {\n\n\tprivate var h : Dynamic;\n\tprivate var rh : Dynamic;\n\n\tpublic inline function new() : Void {\n\t\th = {};\n\t}\n\n\tinline function isReserved(key:String) : Bool {\n\t\treturn untyped __js__(\"__map_reserved\")[key] != null;\n\t}\n\n\tpublic inline function set( key : String, value : T ) : Void {\n\t\tif( isReserved(key) )\n\t\t\tsetReserved(key, value);\n\t\telse\n\t\t\th[cast key] = value;\n\t}\n\n\tpublic inline function get( key : String ) : Null<T> {\n\t\tif( isReserved(key) )\n\t\t\treturn getReserved(key);\n\t\treturn h[cast key];\n\t}\n\n\tpublic inline function exists( key : String ) : Bool {\n\t\tif( isReserved(key) )\n\t\t\treturn existsReserved(key);\n\t\treturn h.hasOwnProperty(key);\n\t}\n\n\tfunction setReserved( key : String, value : T ) : Void {\n\t\tif( rh == null ) rh = {};\n\t\trh[cast \"$\"+key] = value;\n\t}\n\n\tfunction getReserved( key : String ) : Null<T> {\n\t\treturn rh == null ? null : rh[cast \"$\"+key];\n\t}\n\n\tfunction existsReserved( key : String ) : Bool {\n\t\tif( rh == null ) return false;\n\t\treturn untyped rh.hasOwnProperty(\"$\"+key);\n\t}\n\n\tpublic function remove( key : String ) : Bool {\n\t\tif( isReserved(key) ) {\n\t\t\tkey = \"$\" + key;\n\t\t\tif( rh == null || !rh.hasOwnProperty(key) ) return false;\n\t\t\tuntyped __js__(\"delete\")(rh[key]);\n\t\t\treturn true;\n\t\t} else {\n\t\t\tif( !h.hasOwnProperty(key) )\n\t\t\t\treturn false;\n\t\t\tuntyped __js__(\"delete\")(h[key]);\n\t\t\treturn true;\n\t\t}\n\t}\n\n\tpublic function keys() : Iterator<String> {\n\t\treturn arrayKeys().iterator();\n\t}\n\t\n\tfunction arrayKeys() : Array<String> {\n\t\tvar out = [];\n\t\tuntyped {\n\t\t\t__js__(\"for( var key in this.h ) {\");\n\t\t\t\tif( h.hasOwnProperty(key) )\n\t\t\t\t\tout.push(key);\n\t\t\t__js__(\"}\");\n\t\t}\n\t\tif( rh != null ) untyped {\n\t\t\t__js__(\"for( var key in this.rh ) {\");\n\t\t\t\tif( key.charCodeAt(0) == \"$\".code )\n\t\t\t\t\tout.push(key.substr(1));\n\t\t\t__js__(\"}\");\n\t\t}\n\t\treturn out;\n\t}\n\n\tpublic inline function iterator() : Iterator<T> {\n\t\treturn new StringMapIterator(this, arrayKeys());\n\t}\n\n\tpublic function toString() : String {\n\t\tvar s = new StringBuf();\n\t\ts.add(\"{\");\n\t\tvar keys = arrayKeys();\n\t\tfor( i in 0...keys.length ) {\n\t\t\tvar k = keys[i];\n\t\t\ts.add(k);\n\t\t\ts.add(\" => \");\n\t\t\ts.add(Std.string(get(k)));\n\t\t\tif( i < keys.length )\n\t\t\t\ts.add(\", \");\n\t\t}\n\t\ts.add(\"}\");\n\t\treturn s.toString();\n\t}\n\n\tstatic function __init__() : Void {\n\t\tuntyped __js__(\"var __map_reserved = {}\");\n\t}\n\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage js;\n\nprivate class HaxeError extends js.Error {\n\n\tvar val:Dynamic;\n\n\tpublic function new(val:Dynamic) untyped {\n\t\tsuper();\n\t\tthis.val = __define_feature__(\"js.Boot.HaxeError\", val);\n\t\tthis.message = String(val);\n\t\tif (js.Error.captureStackTrace) js.Error.captureStackTrace(this, HaxeError);\n\t}\n}\n\n@:dox(hide)\nclass Boot {\n\n\tprivate static function __unhtml(s : String) {\n\t\treturn s.split(\"&\").join(\"&amp;\").split(\"<\").join(\"&lt;\").split(\">\").join(\"&gt;\");\n\t}\n\n\tprivate static function __trace(v,i : haxe.PosInfos) {\n\t\tuntyped {\n\t\t\tvar msg = if( i != null ) i.fileName+\":\"+i.lineNumber+\": \" else \"\";\n\t\t\t#if jsfl\n\t\t\tmsg += __string_rec(v,\"\");\n\t\t\tfl.trace(msg);\n\t\t\t#else\n\t\t\tmsg += __string_rec(v, \"\");\n\t\t\tif( i != null && i.customParams != null )\n\t\t\t\tfor( v in i.customParams )\n\t\t\t\t\tmsg += \",\" + __string_rec(v, \"\");\n\t\t\tvar d;\n\t\t\tif( __js__(\"typeof\")(document) != \"undefined\" && (d = document.getElementById(\"haxe:trace\")) != null )\n\t\t\t\td.innerHTML += __unhtml(msg)+\"<br/>\";\n\t\t\telse if( __js__(\"typeof console\") != \"undefined\" && __js__(\"console\").log != null )\n\t\t\t\t__js__(\"console\").log(msg);\n\t\t\t#end\n\t\t}\n\t}\n\n\tprivate static function __clear_trace() {\n\t\tuntyped {\n\t\t\t#if jsfl\n\t\t\tfl.outputPanel.clear();\n\t\t\t#else\n\t\t\tvar d = document.getElementById(\"haxe:trace\");\n\t\t\tif( d != null )\n\t\t\t\td.innerHTML = \"\";\n\t\t\t#end\n\t\t}\n\t}\n\n\tstatic inline function isClass(o:Dynamic) : Bool {\n\t\treturn untyped __define_feature__(\"js.Boot.isClass\", o.__name__);\n\t}\n\n\tstatic inline function isEnum(e:Dynamic) : Bool {\n\t\treturn untyped __define_feature__(\"js.Boot.isEnum\", e.__ename__);\n\t}\n\n\tstatic function getClass(o:Dynamic) : Dynamic {\n\t\tif (Std.is(o, Array))\n\t\t\treturn Array;\n\t\telse {\n\t\t\tvar cl = untyped __define_feature__(\"js.Boot.getClass\", o.__class__);\n\t\t\tif (cl != null)\n\t\t\t\treturn cl;\n\t\t\tvar name = __nativeClassName(o);\n\t\t\tif (name != null)\n\t\t\t\treturn __resolveNativeClass(name);\n\t\t\treturn null;\n\t\t}\n\t}\n\n\t@:ifFeature(\"has_enum\")\n\tprivate static function __string_rec(o,s:String) {\n\t\tuntyped {\n\t\t\tif( o == null )\n\t\t\t    return \"null\";\n\t\t\tif( s.length >= 5 )\n\t\t\t\treturn \"<...>\"; // too much deep recursion\n\t\t\tvar t = __js__(\"typeof(o)\");\n\t\t\tif( t == \"function\" && (isClass(o) || isEnum(o)) )\n\t\t\t\tt = \"object\";\n\t\t\tswitch( t ) {\n\t\t\tcase \"object\":\n\t\t\t\tif( __js__(\"o instanceof Array\") ) {\n\t\t\t\t\tif( o.__enum__ ) {\n\t\t\t\t\t\tif( o.length == 2 )\n\t\t\t\t\t\t\treturn o[0];\n\t\t\t\t\t\tvar str = o[0]+\"(\";\n\t\t\t\t\t\ts += \"\\t\";\n\t\t\t\t\t\tfor( i in 2...o.length ) {\n\t\t\t\t\t\t\tif( i != 2 )\n\t\t\t\t\t\t\t\tstr += \",\" + __string_rec(o[i],s);\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tstr += __string_rec(o[i],s);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn str + \")\";\n\t\t\t\t\t}\n\t\t\t\t\tvar l = o.length;\n\t\t\t\t\tvar i;\n\t\t\t\t\tvar str = \"[\";\n\t\t\t\t\ts += \"\\t\";\n\t\t\t\t\tfor( i in 0...l )\n\t\t\t\t\t\tstr += (if (i > 0) \",\" else \"\")+__string_rec(o[i],s);\n\t\t\t\t\tstr += \"]\";\n\t\t\t\t\treturn str;\n\t\t\t\t}\n\t\t\t\tvar tostr;\n\t\t\t\ttry {\n\t\t\t\t\ttostr = untyped o.toString;\n\t\t\t\t} catch( e : Dynamic ) {\n\t\t\t\t\t// strange error on IE\n\t\t\t\t\treturn \"???\";\n\t\t\t\t}\n\t\t\t\tif( tostr != null && tostr != __js__(\"Object.toString\") && __typeof__(tostr) == \"function\" ) {\n\t\t\t\t\tvar s2 = o.toString();\n\t\t\t\t\tif( s2 != \"[object Object]\")\n\t\t\t\t\t\treturn s2;\n\t\t\t\t}\n\t\t\t\tvar k : String = null;\n\t\t\t\tvar str = \"{\\n\";\n\t\t\t\ts += \"\\t\";\n\t\t\t\tvar hasp = (o.hasOwnProperty != null);\n\t\t\t\t__js__(\"for( var k in o ) {\");\n\t\t\t\t\tif( hasp && !o.hasOwnProperty(k) )\n\t\t\t\t\t\t__js__(\"continue\");\n\t\t\t\t\tif( k == \"prototype\" || k == \"__class__\" || k == \"__super__\" || k == \"__interfaces__\" || k == \"__properties__\" )\n\t\t\t\t\t\t__js__(\"continue\");\n\t\t\t\t\tif( str.length != 2 )\n\t\t\t\t\t\tstr += \", \\n\";\n\t\t\t\t\tstr += s + k + \" : \"+__string_rec(o[k],s);\n\t\t\t\t__js__(\"}\");\n\t\t\t\ts = s.substring(1);\n\t\t\t\tstr += \"\\n\" + s + \"}\";\n\t\t\t\treturn str;\n\t\t\tcase \"function\":\n\t\t\t\treturn \"<function>\";\n\t\t\tcase \"string\":\n\t\t\t\treturn o;\n\t\t\tdefault:\n\t\t\t\treturn String(o);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate static function __interfLoop(cc : Dynamic,cl : Dynamic) {\n\t\tif( cc == null )\n\t\t\treturn false;\n\t\tif( cc == cl )\n\t\t\treturn true;\n\t\tvar intf : Dynamic = cc.__interfaces__;\n\t\tif( intf != null )\n\t\t\tfor( i in 0...intf.length ) {\n\t\t\t\tvar i : Dynamic = intf[i];\n\t\t\t\tif( i == cl || __interfLoop(i,cl) )\n\t\t\t\t\treturn true;\n\t\t\t}\n\t\treturn __interfLoop(cc.__super__,cl);\n\t}\n\n\t@:ifFeature(\"typed_catch\") private static function __instanceof(o : Dynamic,cl : Dynamic) {\n\t\tif( cl == null )\n\t\t\treturn false;\n\t\tswitch( cl ) {\n\t\tcase Int:\n\t\t\treturn (untyped __js__(\"(o|0) === o\"));\n\t\tcase Float:\n\t\t\treturn (untyped __js__(\"typeof\"))(o) == \"number\";\n\t\tcase Bool:\n\t\t\treturn (untyped __js__(\"typeof\"))(o) == \"boolean\";\n\t\tcase String:\n\t\t\treturn (untyped __js__(\"typeof\"))(o) == \"string\";\n\t\tcase Array:\n\t\t\treturn (untyped __js__(\"(o instanceof Array)\")) && o.__enum__ == null;\n\t\tcase Dynamic:\n\t\t\treturn true;\n\t\tdefault:\n\t\t\tif( o != null ) {\n\t\t\t\t// Check if o is an instance of a Haxe class or a native JS object\n\t\t\t\tif( (untyped __js__(\"typeof\"))(cl) == \"function\" ) {\n\t\t\t\t\tif( untyped __js__(\"o instanceof cl\") )\n\t\t\t\t\t\treturn true;\n\t\t\t\t\tif( __interfLoop(getClass(o),cl) )\n\t\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\telse if ( (untyped __js__(\"typeof\"))(cl) == \"object\" && __isNativeObj(cl) ) {\n\t\t\t\t\tif( untyped __js__(\"o instanceof cl\") )\n\t\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t// do not use isClass/isEnum here\n\t\t\tuntyped __feature__(\"Class.*\",if( cl == Class && o.__name__ != null ) return true);\n\t\t\tuntyped __feature__(\"Enum.*\",if( cl == Enum && o.__ename__ != null ) return true);\n\t\t\treturn o.__enum__ == cl;\n\t\t}\n\t}\n\n\t@:ifFeature(\"typed_cast\") private static function __cast(o : Dynamic, t : Dynamic) {\n\t\tif (__instanceof(o, t)) return o;\n\t\telse throw \"Cannot cast \" +Std.string(o) + \" to \" +Std.string(t);\n\t}\n\n\tstatic var __toStr = untyped __js__(\"{}.toString\");\n\t// get native JS [[Class]]\n\tstatic function __nativeClassName(o:Dynamic):String {\n\t\tvar name = untyped __toStr.call(o).slice(8, -1);\n\t\t// exclude general Object and Function\n\t\t// also exclude Math and JSON, because instanceof cannot be called on them\n\t\tif (name == \"Object\" || name == \"Function\" || name == \"Math\" || name == \"JSON\")\n\t\t\treturn null;\n\t\treturn name;\n\t}\n\n\t// check for usable native JS object\n\tstatic function __isNativeObj(o:Dynamic):Bool {\n\t\treturn __nativeClassName(o) != null;\n\t}\n\n\t// resolve native JS class in the global scope:\n\tstatic function __resolveNativeClass(name:String) untyped {\n\t\treturn untyped Function('return typeof $name != \"undefined\" ? $name : null')();\n\t}\n\n}\n"],
"names":[],
"mappings":"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"
}