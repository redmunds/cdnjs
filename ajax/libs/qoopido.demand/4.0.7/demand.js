/**! Qoopido.demand 4.0.7 (MIT OR GPL-3.0+) | https://github.com/dlueth/qoopido.demand | (c) 2017 Dirk Lueth */
!function(e,t,n,r,i){"use strict";function o(e,t,n,r){return{__proto__:V,value:e,enumerable:!!r,configurable:!!n,writable:!!t}}function u(e,t){return typeof e===t}function a(e){return e&&u(e,re)}function c(e){return u(e,oe)&&isFinite(e)&&Math.floor(e)===e&&e>=0}function s(e,t){return e instanceof t}function f(e,t,n){for(var r,i=Object.keys(e),o=0;(r=i[o])!==W&&t.call(n,r,e[r])!==Y;o++);}function l(){return+new Date}function d(e){return H.href=e,H.href}function h(e,t){var n=e.replace(Be,"");return Ue.test(n)||Le.test(n)||(n="/"+d((t&&d(t+"/../")||"/")+n).replace(Fe,"")),n}function p(e,t){var n=e.match(Be);return(n&&n[1]?"mock:":"")+(n&&n[3]||E.handler)+"!"+h(e,t)}function v(){return u(this.uuid,ee)&&T(this,"uuid",new o($e())),this}function m(){this.parent.constructor.call(this),O[this.uuid]={},e.storage=O[this.uuid]}function g(e,t,n){this.message=e,t&&(this.module=t),n&&(this.stack=C.call(n))}function y(e){function t(t,n){n&&e.handler.validate&&!e.handler.validate(n)?e.deferred.reject(new g(Me+" (content-type)",e.id)):(e.source=t,_e.emit(Re,e.type,e))}function n(t){e.deferred.reject(new g(Me+(t?" (status)":""),e.id))}function r(e,t,n){var r;return H.href=e,H.search=(r=(H.search||"").replace(u,""))+(r?"&":"?")+t+"="+n,H.href}function i(u){u=u||0,e.url=o?d(o.process(e.path,u)):e.path,_e.emit(qe,e.type,e),new Ve(r(e.url,L,+new Date)).then(t,o?function(){u++,o.location[u]?i(u):n()}:n)}var o,u=/^\?/;Le.test(e.path)||f(E.pattern,function(t,n){n.matches(e.path)&&(!o||o.weight<n.weight)&&(o=n)}),i()}function x(e){return"[object Array]"===A.call(e)}function w(e){for(var t=5381,n=e.length;n;)t=33*t^e.charCodeAt(--n);return t>>>0}function b(){this.parent.constructor.call(this),O[this.uuid]=[]}function j(e){var t=this.parent.constructor.call(this),n=O[t.uuid]={queue:e,current:V};demand.on(Pe+":"+e.uuid,function(){!n.current&&t.process()})}function q(e,t){for(var n,r;n=Xe.exec(t);)H.href=e,Le.test(n[2])?r=H.protocol+"//"+H.host+n[2]:(H.pathname+="/../"+n[2],r=H.protocol+"//"+H.host+H.pathname),t=t.replace(n[0],n[1]+" sourceMappingURL="+r+".map"+(n[3]?" "+n[3]:""));return t}function g(e,t,n){this.message=e,t&&(this.module=t),n&&(this.stack=C.call(n))}function R(e,t){provide(e,function(){return t})}var S,k,E={cache:{},timeout:8e3,pattern:{},modules:{},handler:"module"},O={},P=Array.prototype,C=P.slice,M=P.concat,I=Object.prototype,A=I.toString,D=Object.create,T=Object.defineProperty,$=Object.getOwnPropertyNames,N=Object.getOwnPropertyDescriptor,_=Function.prototype,H=t.createElement("a"),L="demand",U="provide",X="path",F="/"+L+"/",J=F+"abstract/",B=F+"handler/",G=F+"plugin/",Q=F+"function/",z=F+"validator/",K="mock:",V=null,W=void 0,Y=!1,Z=!0,ee="undefined",te="string",ne="boolean",re="object",ie="function",oe="number",ue=function(){},ae="pre",ce="post",se="Configure",fe=ae+se,le=ce+se,de="cache",he=de+"Miss",pe=de+"Hit",ve=de+"Clear",me=de+"Exceed",ge=ae+"Cache",ye=ce+"Cache",xe="Resolve",we=ae+xe,be=ce+xe,je="Request",qe=ae+je,Re=ce+je,Se="Process",ke=ae+Se,Ee=ce+Se,Oe="queue",Pe=Oe+"Enqueue",Ce=Oe+"Dequeue",Me="error loading",Ie="error providing",Ae="error resolving",De="unspecified anonymous provide";!function(){function e(e){var t,n=this,r=n.prototype,i={},u=$(r),a=0;for(e=e.prototype||e;t=u[a];a++)i[t]=N(r,t);return i.constructor=new o(n),i.parent=new o(e),n.prototype=D(e,i),n}T(_,"extends",new o(e))}();var Te=function(){function e(e,t){var n,r=this[e];t!==W&&(a(t)?(n=a(r),r=t.length!==W?n&&r.length!==W?r:[]:n&&r.length===W?r:{},this[e]=Te(r,t)):this[e]=t)}return function(){for(var t,n=arguments[0],r=1;(t=arguments[r])!==W;r++)f(t,e,n);return n}}(),$e=function(){function e(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}var t=new RegExp("[xy]","g"),n={};return function(){var r;do r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(t,e);while(n[r]);return n[r]=1,r}}(),Ne=function(){var n,i,o="setImmediate"in e;return"MutationObserver"in e?function(e){n=t.createElement("div"),new MutationObserver(function(){e()}).observe(n,{attributes:Z}),n.setAttribute("i","1")}:!o&&"postMessage"in e&&!("importScripts"in e)&&"addEventListener"in e?function(){function t(t){t.source===e&&t.data&&O[t.data]&&(O[t.data](),delete O[t.data])}return e.addEventListener("message",t,Y),function(t){var n=$e();O[n]=t,e.postMessage(n,"*")}}():!o&&"onreadystatechange"in(n=t.createElement("script"))?function(e){n.onreadystatechange=function(){n.onreadystatechange=V,n.parentNode.removeChild(n),e()},t.body.appendChild(n)}:(i=o?setImmediate:r,function(e){i(e)})}(),_e=function(){function e(e,t,r){var a,c;if(u(t,te)&&u(r,ie))for(t=t.split(" ");a=t.shift();)a=a.split(":"),i.test(a[0])&&((o[a[0]]||(o[a[0]]={on:[],after:[]}))[e].push({callback:r,filter:a[1]}),e===n&&a[0]===le&&(c=E.modules[a[1]])&&r(c))}function t(){}var n="on",r="after",i=/^cache(Miss|Hit|Clear|Exceed)|queue(En|De)queue|(pre|post)(Resolve|Configure|Request|Process|Cache)$/,o={};return t.prototype={emit:function(e,t){var i,u,a,c=o[e];if(c){for(i=C.call(arguments,2),u=0;a=c[n][u];u++)a.filter&&a.filter!==t||a.callback.apply(V,i);for(u=0;a=c[r][u];u++)a.filter&&a.filter!==t||a.callback.apply(V,i)}return this},on:function(t,r){return e(n,t,r),this},after:function(t,n){return e(r,t,n),this}},new t}(),He=function(){var e=/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g;return function(t){return t.replace(e,"\\$&")}}(),Le=/^(http(s?):)?\/\//i,Ue=/^\//,Xe=/((?:\/\/|\/\*)#)\s*sourceMappingURL\s*=\s*(?!(?:http[s]?:)?\/\/)(.+?)\.map(?:\s+)?(\*\/)?/g,Fe=new RegExp("^"+He(d("/"))),Je=new RegExp("^"+L+"|"+U+"|"+X+"$"),Be=/^(mock:)?([+-])?((?:[-\w]+\/?)+)?(?:@(\d+\.\d+.\d+))?(?:#(\d+))?!/,Ge=function(t){function n(e){var t;return e.cache!==V?e.cache:(f(E.cache,function(n,r){0===e.path.indexOf(n)&&(!t||r.weight>t.weight)&&(t=r)}),t?t.state:Y)}function r(e,t,n){_e.emit(e,t.id,t,n)}function i(){Ne(this.clear.expired.bind(this.clear))}var o,u="["+L+"]",a="[state]",c="[value]",s=new RegExp("^"+He(u)+"\\[(.+?)\\]"+He(a)+"$"),d=function(){try{return"localStorage"in e&&e.localStorage}catch(e){return Y}}(),h=d&&"remainingSpace"in localStorage,v={};return _e.on(he,function(e){Ne(function(){o.clear.path(e.id)})}).on(Re,function(e){e.source&&n(e)&&(v[e.id]=Z)}).after(Ee,function(e){v[e.id]&&Ne(function(){o.set(e)})}),i.prototype={get:function(){return d?function(e){var r,i;if(n(e)&&(r=u+"["+e.id+"]",i=t.parse(localStorage.getItem(r+a)),i&&i.version===e.version&&(!i.expires&&!e.lifetime||i.expires>l())))return e.source=localStorage.getItem(r+c),Z}:ue}(),resolve:function(){return d?function(e){var t=this;t.get(e)?r(pe,e):r(he,e)}:function(e){r(he,e)}}(),set:function(){return d?function(e){var i,o,s;if(n(e)){i={version:e.version,expires:e.lifetime?l()+e.lifetime:e.lifetime},o=u+"["+e.id+"]",r(ge,e,i);try{if(s=h?localStorage.remainingSpace:V,localStorage.setItem(o+c,e.source),localStorage.setItem(o+a,t.stringify(i)),s!==V&&localStorage.remainingSpace===s)throw new Error("QUOTA_EXCEEDED_ERR");r(ye,e,i)}catch(t){r(me,e)}}}:ue}(),clear:{path:function(){return d?function e(e){var t=p(e),n=u+"["+t+"]";localStorage[n+a]&&(localStorage.removeItem(n+a),localStorage.removeItem(n+c),r(ve,ze.get(t)||new ze(t,V,Y)))}:ue}(),all:function(){return d?function(){var e;f(localStorage,function(t){e=t.match(s),e&&this.path(e[1])},this)}:ue}(),expired:function(){return d?function(){var e,n,r=this;f(localStorage,function(i){e=i.match(s),e&&(n=t.parse(localStorage.getItem(u+"["+e[1]+"]"+a)),n&&n.expires>0&&n.expires<=l()&&r.path(e[1]))},this)}:ue}()}},o=new i}(JSON),Qe=function(){function e(){s[this.uuid].handle(a,arguments)}function t(){s[this.uuid].handle(c,arguments)}function n(e,t){var n,r,i=s[this.uuid];for(i.state===u&&(i.state=e,i.value=t);n=i[i.state].shift();)r=n.handler.apply(V,i.value),r&&"function"==typeof r.then?r.then(n.deferred.resolve,n.deferred.reject):n.deferred[i.state===a?"resolve":"reject"].apply(V,i.value);i[a].length=0,i[c].length=0}function r(e,t,n){e.then(function(){n.resolved[t]=C.call(arguments),n.count++,i(n)},function(){n.rejected.push(C.call(arguments)),i(n)})}function i(e){e.count===e.total?e.deferred.resolve.apply(V,M.apply([],e.resolved)):e.rejected.length+e.count===e.total&&e.deferred.reject.apply(V,M.apply([],e.rejected))}function o(r){var i=this.parent.constructor.call(this);s[i.uuid]={state:u,handle:n.bind(i),value:V,resolved:[],rejected:[],count:0},r(e.bind(i),t.bind(i))}var u="pending",a="resolved",c="rejected",s={};return o.prototype={catch:function(e){return this.then(ue,e)},always:function(e){return this.then(e,e)},then:function(e,t){var n=s[this.uuid],r=o.defer();return e&&n[a].push({handler:e,deferred:r}),t&&n[c].push({handler:t,deferred:r}),n.state!==u&&Ne(n.handle),r.pledge},isPending:function(){return s[this.uuid].state===u},isResolved:function(){return s[this.uuid].state===a},isRejected:function(){return s[this.uuid].state===c}},o.defer=function(){var e={};return e.pledge=new o(function(t,n){e.resolve=t,e.reject=n}),e},o.all=function(e){var t,n,i=o.defer(),u=0;if(e.length)for(t=s[$e()]={deferred:i,resolved:[],rejected:[],total:e.length,count:0};n=e[u];u++)r(n,u,t);else i.resolve();return i.pledge},o.race=function(e){for(var t,n=o.defer(),r=0;t=e[r];r++)t.then(n.resolve,n.reject);return e.length||n.resolve(),n.pledge},o.extends(v)}();m.prototype={get:function(e){return e?O[this.uuid][e]:O[this.uuid]},set:function(e,t){O[this.uuid][e]=t},remove:function(e){delete O[this.uuid][e]}},m.extends(v),g.prototype={toString:function(){var e=this,t=L+": "+e.message+" "+(e.module?'"'+e.module+'"':"");return e.stack&&(t=g.traverse(e.stack,t,1)),t}},g.traverse=function(e,t,n){for(var r,i=new Array(n+1).join(" "),o=0;r=e[o];o++)t+="\n"+i+"> "+r.message+" "+(r.module?'"'+r.module+'"':""),r.stack&&(t=g.traverse(r.stack,t,n+1));return t};var ze=function(){function e(e,t,n){var o=this,u=e.match(Be)||i;return o.path=h(e,t),o.mock=u[1]?Z:Y,o.cache=u[2]?"+"===u[1]:V,o.type=u[3]||E.handler,o.version=u[4]||E.version,o.lifetime=u[5]&&1e3*u[5]||E.lifetime,o.id=(o.mock?K:"")+o.type+"!"+o.path,o.uri=(o.mock?K:"")+o.type+"@"+o.version+(c(o.lifetime)&&o.lifetime>0?"#"+o.lifetime:"")+"!"+o.path,o.deferred=Qe.defer(),o.pledge=o.deferred.pledge,n!==Y&&r.set(o.id,o),o}var n="internal!",r=new m,i=[];return e.prototype={enqueue:!0},e.get=function(e,t){return r.get(p(e,t))},e.resolve=function(t,r){var i=r&&Je.test(t),o=i?this.get(n+r+"/"+t):this.get(t,r);if(!o)if(i)switch(o=new e(n+r+"/"+t),t){case L:o.deferred.resolve(function(){var e=demand.bind(r);return f(demand,function(t,n){e[t]=n}),e}());break;case U:o.deferred.resolve(provide.bind(r));break;case X:o.deferred.resolve(r)}else o=new e(t,r),demand(B+o.type).then(function(e){o.handler=e,o.mock?o.deferred.resolve(e):Ge.resolve(o)},function(){o.deferred.reject(new g(Me+" (handler)",self.id))});return o},e.remove=function(e,n,i){var o=p(e,n),u=t.querySelector("["+L+'-id="'+o+'"]');r.remove(o),r.remove(K+o),u&&u.parentNode.removeChild(u),i!==Y&&Ge.clear.path(o)},e.list={all:function(){return Object.keys(r.get())},pending:function(){var e=[];return f(r.get(),function(t,n){n.pledge.isPending()&&e.push(t)}),e},resolved:function(){var e=[];return f(r.get(),function(t,n){n.pledge.isResolved()&&e.push(t)}),e},rejected:function(){var e=[];return f(r.get(),function(t,n){n.pledge.isRejected()&&e.push(t)}),e}},e}(),Ke=function(){function e(e,n){var r=this;r.weight=e.length,r.match=new RegExp("^"+He(e)),r.location=[].concat(n),f(r.location,function(e,n){r.location[e]={url:d(n).replace(t,"$1"),match:new RegExp("^"+He(n))}})}var t=/(.+)\/$/;return e.prototype={matches:function(e){return this.match.test(e)},process:function(e,t){var n=this.location[t];if(n)return e.replace(this.match,n.url)}},e}(),Ve=function(t){function n(){this.readyState<4&&this.abort()}var o="XDomainRequest"in e&&e.XDomainRequest||t;return function(e){var u,a=n.bind(this),c=Qe.defer(),s=Fe.test(e)?new t:new o,f=E.timeout;return s.ontimeout=s.onerror=s.onabort=function(){c.reject(s.status)},s.onprogress=s.onreadystatechange=function(){i(u),u=r(a,E.timeout)},s.onload=function(){f=i(f),"status"in s&&200!==s.status?c.reject(s.status):c.resolve(s.responseText,s.getResponseHeader&&s.getResponseHeader("content-type"))},s.open("GET",e,Z),s.send(),u=r(a,E.timeout),c.pledge}}(XMLHttpRequest);e.demand=function(){function t(){var t,n,r=C.call(arguments),i=this!==e?this:V,o=0;for(_e.emit(we,V,r,i);t=r[o];o++)r[o]=ze.resolve(t,i).pledge;return n=r.length>1?Qe.all(r):r[0],n.always(function(){_e.emit(be,V,r,i)})}return t.configure=function(e){var n,r=e.cache,i=e.version,o=e.timeout,s=e.lifetime,l=e.base,d=e.pattern,h=e.modules,p=E.modules;return u(r,ne)?E.cache[""]={weight:0,state:r}:a(r)&&f(r,function(e,t){E.cache[e]={weight:e.length,state:t}}),u(i,te)&&(E.version=i),c(o)&&(E.timeout=1e3*Math.min(Math.max(o,2),12)),c(s)&&s>0&&(E.lifetime=1e3*s),u(l,te)&&""!==l&&(E.pattern.base=new Ke("",l)),a(d)&&f(d,function(e,t){"base"!==e&&(E.pattern[e]=new Ke(e,t))}),a(h)&&f(h,function(e,t){n=p[e]=p[e]||{},_e.emit(fe,e,n),Te(n,t),_e.emit(le,e,n)}),t},t.on=_e.on.bind(t),t.remove=ze.remove,t.list=ze.list,t.clear=Ge.clear,_e.after(he,function(e){new y(e)}).after(pe+" "+Re,function(e){_e.emit(ke,e.id,e)}).after(qe,function(e){var t=e.handler.onPreRequest;t&&t(e)}).after(Re,function(e){var t=e.handler.onPostRequest;t&&t(e)}).after(ke,function(e){var t=e.handler.onPreProcess;t&&t(e),e.pledge.then(function(){_e.emit(Ee,e.id,e)}),e.enqueue===!0?S.enqueue(e):s(e.enqueue,Qe)&&e.enqueue.then(function(){S.enqueue(e)})}),t}(),e.provide=function(){var t,n,r=u(arguments[0],te)?arguments[0]:V,i=this!==e?this:V,o=x(arguments[r?1:0])?arguments[r?1:0]:V,a=o?arguments[r?2:1]:arguments[r?1:0];!r&&k.current&&(t=k.current,r=t.uri,k.process()),r?(t=t||new ze(r,i),n=u(a,ie),o?demand.apply(t.path,o).then(function(){t.deferred.resolve(n?a.apply(V,arguments):a)},function(){t.deferred.reject(new g(Ie,t.id,arguments))}):t.deferred.resolve(n?a():a)):!u(console,ee)&&console.error(new g(De))},demand.configure({cache:Z,base:"/",pattern:{"/demand":d((n&&n.url||location.href)+"/../").slice(0,-1)}}),n&&n.settings&&demand.configure(n.settings),b.prototype={enqueue:function(){O[this.uuid]=O[this.uuid].concat(C.call(arguments)),_e.emit(Pe,this.uuid)},dequeue:function(){return _e.emit(Ce,this.uuid),O[this.uuid].shift()},get current(){return O[this.uuid][0]},get length(){return O[this.uuid].length}},b.extends(v),j.prototype={process:function(){var e,t=O[this.uuid];t.queue.length?(e=t.current=t.queue.dequeue(),e.handler.process&&e.handler.process(e)):t.current=V},get current(){return O[this.uuid].current}},j.extends(v);var We=function(){function e(){}return e.prototype={validate:V,onPreRequest:V,onPostRequest:V,onPreProcess:V,process:V},new e}(),Ye=function(){function e(){}var n=t.getElementsByTagName("head")[0],r=/^(application|text)\/(x-)?javascript/;return e.prototype={validate:function(e){return r.test(e)},onPreRequest:function(e){var t=e.url;e.url=".js"!==t.slice(-3)?t+".js":t},onPostRequest:function(e){e.source=q(e.url,e.source)},process:function(e){var r;e.source&&(r=t.createElement("script"),r.async=Z,r.text=e.source,r.setAttribute(L+"-id",e.id),n.appendChild(r))}},new(e.extends(We))}();g.prototype={toString:function(){var e=this,t=L+": "+e.message+" "+(e.module?'"'+e.module+'"':"");return e.stack&&(t=g.traverse(e.stack,t,1)),t}},g.traverse=function(e,t,n){for(var r,i=new Array(n+1).join(" "),o=0;r=e[o];o++)t+="\n"+i+"> "+r.message+" "+(r.module?'"'+r.module+'"':""),r.stack&&(t=g.traverse(r.stack,t,n+1));return t};var Ze=function(){function e(e){for(var t,n,i=0;n=e[i];i++)if(n=n.match(Be),n=n&&n[3]||r.handler,t){if(n!==t)return Y}else t=n;return t}function t(){}var n=B+"bundle",r={};return demand.on(le+":"+n,function(e){var t,n;a(e)&&(r=e,f(r,function(e,r){for(t=0;n=r[t];t++)u(n,te)&&(r[t]=p(n))}))}),t.prototype={validate:Ye.validate,onPreProcess:function(t){function n(){f.reject(new g(Ae,t.id,arguments))}var i,o,u,a,c,s=t.source,f=t.deferred,l=r[t.path];if(t.enqueue=!1,l&&(i=e(l))){for(;o=Xe.exec(s);)s=s.replace(o[0],"");for(t.source=s,u=[],c=0;a=l[c];c++)u.push(ze.resolve(K+a).pledge);Qe.all(u).then(function(){for(u.length=0,c=0;a=l[c];c++)a=l[c]=ze.get(a)||new ze(a),a.handler=arguments[c],u.push(a.pledge);"module"===i?(S.enqueue.apply(S,l),Ye.process(t)):(Ye.process(t),S.enqueue.apply(S,l)),Qe.all(u).then(f.resolve,n)},n)}else n()}},new(t.extends(We))}(),et=function(){function e(e){for(var t,n,r=0;t=o[r];r++)0===e.indexOf(t.prefix)&&(!n||t.weight>n.weight)&&(n=t);return n}function t(e){var t,n,r=e.matches,i={pattern:{},modules:{"/demand/handler/bundle":{}}},o=0;for(i.pattern[e.id]=e.fn(r),i.modules[B+"bundle"][e.id]=t=[];n=r[o];o++)t.push(n.path);return i}function n(){for(var e,t=0;e=this[t];t++)e.deferred.resolve(arguments[t])}function r(){for(var e,t=0;e=this[t];t++)e.deferred.reject(new g(Ae,e.id))}var i=G+"genie",o=[];return demand.on(le+":"+i,function(e){a(e)&&(o.length=0,f(e,function(e,t){o.push({prefix:e,weight:e.length,fn:t})}))}).on(we,function(o,a){var c,s,l,d,h={};for(c=0;s=o[c];c++)!u(s,te)||Je.test(s)||ze.get(s,a)||(s=new ze(s,a,Y),"module"===s.type&&(l=e(s.path))&&!Ge.get(s)&&(h[l.prefix]||(h[l.prefix]={fn:l.fn,matches:[]})).matches.push(s));f(h,function(e,o){if(d=o.matches,d.length>1){for(o.id=i+"/"+w(JSON.stringify(o.matches)),c=0;s=d[c];c++)d[c]=new ze(s.uri);demand.configure(t(o)),demand("bundle!"+o.id).then(n.bind(d),r.bind(d))}})}),Z}();if(S=new b,k=new j(S),R(J+"uuid",v),R(J+"handler",We),R(B+"module",Ye),R(B+"bundle",Ze),R(G+"genie",et),R(z+"isTypeOf",u),R(z+"isArray",x),R(z+"isObject",a),R(z+"isInstanceOf",s),R(Q+"resolveUrl",d),R(Q+"resolveSourcemaps",q),R(Q+"merge",Te),R(Q+"iterate",f),R(Q+"hash",w),R(Q+"defer",Ne),R(F+"descriptor",o),R(F+"pledge",Qe),R(F+"queue",b),R(F+"xhr",Ve),R(F+"failure",g),n&&n.main)switch(typeof n.main){case te:demand(n.main);break;case ie:provide("main",n.main())}}(this,document,"demand"in this&&demand,setTimeout,clearTimeout);
//# sourceMappingURL=demand.js.map
