{"version":3,"sources":["css.js","handler/css.js"],"names":["document","setTimeout","definition","resolveUrl","onPreRequest","self","this","url","slice","onPostRequest","match","base","source","regexMatchCssUrl","exec","replace","onPostProcess","style","createElement","type","media","styleSheet","cssText","innerHTML","setAttribute","path","target","appendChild","provide","getElementsByTagName","when"],"mappings":"AAAA;AACA,CCWE,SAASA,EAAUC,GACpB,YAKA,SAASC,GAAWC,GACnB,OAMCC,aAAc,WACb,GAAIC,GAAOC,KACVC,EAAOF,EAAKE,GAEbF,GAAKE,IAAwB,SAAlBA,EAAIC,MAAM,IAAiBD,EAAM,OAASA,GAStDE,cAAe,WAMd,IALA,GAGCC,GAHGL,EAASC,KACZK,EAASR,EAAWE,EAAKE,IAAM,OAC/BK,EAASP,EAAKO,OAGRF,EAAQG,EAAiBC,KAAKF,IACpCA,EAASA,EAAOG,QAAQL,EAAM,GAAI,OAASP,EAAWQ,EAAOD,EAAM,IAAM,IAG1EL,GAAKO,OAASA,GAOfI,cAAe,WACd,GAAIX,GAASC,KACZW,EAASjB,EAASkB,cAAc,SAChCN,EAASP,EAAKO,MAEfK,GAAME,KAAQ,WACdF,EAAMG,MAAQ,SAEXH,EAAMI,WACRJ,EAAMI,WAAWC,QAAUV,EAE3BK,EAAMM,UAAYX,EAGnBK,EAAMO,aAAa,cAAenB,EAAKc,MACvCF,EAAMO,aAAa,cAAenB,EAAKoB,MAEvCC,EAAOC,YAAYV,GAEnBhB,EAAW,WACV2B,QAAQ,WAAa,MAAOX,SA5DhC,GAAIS,GAAmB1B,EAAS6B,qBAAqB,QAAQ,GAC5DhB,EAAmB,2DAiEpBe,SAAQ1B,GACN4B,KAAK,iCACN9B,SAAUC","file":"handler/css.js","sourcesContent":[null,"/**\n * Qoopido.demand handler/css\n *\n * Copyright (c) 2015 Dirk Lueth\n *\n * Dual licensed under the MIT and GPL licenses.\n *  - http://www.opensource.org/licenses/mit-license.php\n *  - http://www.gnu.org/copyleft/gpl.html\n *\n * @author Dirk Lueth <info@qoopido.com>\n */\n\n;(function(document, setTimeout) {\n\t'use strict';\n\n\tvar target           = document.getElementsByTagName('head')[0],\n\t\tregexMatchCssUrl = /url\\(\\s*(?:\"|'|)(?!data:|http:|https:|\\/)(.+?)(?:\"|'|)\\)/g;\n\n\tfunction definition(resolveUrl) {\n\t\treturn {\n\t\t\t/**\n\t\t\t * Enables modification of the URL that gets requested\n\t\t\t *\n\t\t\t * @this Loader\n\t\t\t */\n\t\t\tonPreRequest: function() {\n\t\t\t\tvar self = this,\n\t\t\t\t\turl  = self.url;\n\n\t\t\t\tself.url = url.slice(-4) !== '.css' ? url + '.css' : url;\n\t\t\t},\n\t\t\t/**\n\t\t\t * handles modifying of CSS module's source prior to caching\n\t\t\t *\n\t\t\t * Rewrites relative CSS URLs to an absolute URL in relation to the URL the module was loaded from\n\t\t\t *\n\t\t\t * @this Loader\n\t\t\t */\n\t\t\tonPostRequest: function() {\n\t\t\t\tvar self   = this,\n\t\t\t\t\tbase   = resolveUrl(self.url + '/..'),\n\t\t\t\t\tsource = self.source,\n\t\t\t\t\tmatch;\n\n\t\t\t\twhile((match = regexMatchCssUrl.exec(source))) {\n\t\t\t\t\tsource = source.replace(match[0], 'url(' + resolveUrl(base + match[1]) + ')');\n\t\t\t\t}\n\n\t\t\t\tself.source = source;\n\t\t\t},\n\t\t\t/**\n\t\t\t * handles processing of loaded CSS modules\n\t\t\t *\n\t\t\t * @this Loader\n\t\t\t */\n\t\t\tonPostProcess: function() {\n\t\t\t\tvar self   = this,\n\t\t\t\t\tstyle  = document.createElement('style'),\n\t\t\t\t\tsource = self.source;\n\n\t\t\t\tstyle.type  = 'text/css';\n\t\t\t\tstyle.media = 'only x';\n\n\t\t\t\tif(style.styleSheet) {\n\t\t\t\t\tstyle.styleSheet.cssText = source;\n\t\t\t\t} else {\n\t\t\t\t\tstyle.innerHTML = source;\n\t\t\t\t}\n\n\t\t\t\tstyle.setAttribute('demand-type', self.type);\n\t\t\t\tstyle.setAttribute('demand-path', self.path);\n\n\t\t\t\ttarget.appendChild(style);\n\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tprovide(function() { return style; });\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t}\n\n\tprovide(definition)\n\t\t.when('/demand/function/resolve/url');\n}(document, setTimeout));"],"sourceRoot":"/source/"}