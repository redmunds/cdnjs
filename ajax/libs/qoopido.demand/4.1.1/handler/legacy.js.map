{"version":3,"sources":["handler/legacy.js"],"names":["definition","path","Failure","handlerModule","isObject","resolve","result","self","this","deferred","probe","settings","process","provide","reject","HandlerLegacy","demand","on","options","prototype","onPreProcess","dependency","dependencies","enqueue","apply","boundResolve","bind","then","arguments","extends"],"mappings":";CAAC,WACA,YAEA,SAASA,GAAWC,EAAMC,EAASC,EAAeC,GAQjD,QAASC,KACR,GAGCC,GAHGC,EAAWC,KACdC,EAAWF,EAAKE,SAChBC,EAAWC,EAASJ,EAAKN,OAASU,EAASJ,EAAKN,MAAMS,KAGvDP,GAAcS,QAAQL,GAEnBG,IAAUJ,EAASI,KACrBG,QAAQ,WAAa,MAAOP,KAE5BG,EAASK,OAAO,GAAIZ,GAAQ,gBAAiBK,EAAKN,OAIpD,QAASc,MAtBT,GAAIJ,KAiDJ,OA/CAK,QACEC,GAAG,iBAAmBhB,EAAM,SAASiB,GACrCP,EAAWP,EAASc,GAAWA,OAoBjCH,EAAcI,WACbC,aAAc,SAASC,GACtB,GAAIC,GAAeX,EAASU,EAAWpB,OAASU,EAASU,EAAWpB,MAAMqB,YAEvEA,KACFD,EAAWE,QAAUP,OAAOQ,MAAM,KAAMF,KAG1CV,QAAS,SAASS,GACjB,GAAII,GAAepB,EAAQqB,KAAKL,EAE7BA,GAAWE,WAAY,EACzBE,IAEAJ,EAAWE,QACTI,KACAF,EACA,WACCJ,EAAWZ,SAASK,OAAO,GAAIZ,GAAQ,kBAAmBmB,EAAWpB,KAAM2B,gBAO1E,IAAKb,EAAcc,QAAQ1B,IAGnCU,SAAU,OAAQ,kBAAmB,yBAA0B,8BAAgCb","file":"legacy.js","sourcesContent":["(function() {\n\t'use strict';\n\n\tfunction definition(path, Failure, handlerModule, isObject) {\n\t\tvar settings = {};\n\n\t\tdemand\n\t\t\t.on('postConfigure:' + path, function(options) {\n\t\t\t\tsettings = isObject(options) ? options : {};\n\t\t\t});\n\n\t\tfunction resolve() {\n\t\t\tvar self     = this,\n\t\t\t\tdeferred = self.deferred,\n\t\t\t\tprobe    = settings[self.path] && settings[self.path].probe,\n\t\t\t\tresult;\n\n\t\t\thandlerModule.process(self);\n\n\t\t\tif(probe && (result = probe())) {\n\t\t\t\tprovide(function() { return result; });\n\t\t\t} else {\n\t\t\t\tdeferred.reject(new Failure('error probing', self.path));\n\t\t\t}\n\t\t}\n\n\t\tfunction HandlerLegacy() {}\n\n\t\tHandlerLegacy.prototype = {\n\t\t\tonPreProcess: function(dependency) {\n\t\t\t\tvar dependencies = settings[dependency.path] && settings[dependency.path].dependencies;\n\n\t\t\t\tif(dependencies) {\n\t\t\t\t\tdependency.enqueue = demand.apply(null, dependencies);\n\t\t\t\t}\n\t\t\t},\n\t\t\tprocess: function(dependency) {\n\t\t\t\tvar boundResolve = resolve.bind(dependency);\n\n\t\t\t\tif(dependency.enqueue === true) {\n\t\t\t\t\tboundResolve();\n\t\t\t\t} else {\n\t\t\t\t\tdependency.enqueue\n\t\t\t\t\t\t.then(\n\t\t\t\t\t\t\tboundResolve,\n\t\t\t\t\t\t\tfunction() {\n\t\t\t\t\t\t\t\tdependency.deferred.reject(new Failure('error resolving', dependency.path, arguments));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\treturn new (HandlerLegacy.extends(handlerModule));\n\t}\n\n\tprovide([ 'path', '/demand/failure', '/demand/handler/module', '/demand/validator/isObject' ], definition);\n}());"]}