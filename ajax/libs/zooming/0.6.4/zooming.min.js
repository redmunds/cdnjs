!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):n.Zooming=e()}(this,function(){"use strict";var n="WebkitAppearance"in document.documentElement.style?"-webkit-":"",e=function(n){var e={},t=["webkitTransition","transition","mozTransition"],o=["webkitTransform","transform","mozTransform"],r={transition:"transitionend",mozTransition:"transitionend",webkitTransition:"webkitTransitionEnd"};return t.some(function(t){if(void 0!==n.style[t])return e.transitionProp=t,e.transEndEvent=r[t],!0}),o.some(function(t){if(void 0!==n.style[t])return e.transformProp=t,e.transformCssProp=t.replace(/(.*)Transform/,"-$1-transform"),!0}),e},t=function(n,e){return function(t,o,r){var i=void 0;o.transition&&(i=o.transition,delete o.transition,o[n]=i),o.transform&&(i=o.transform,delete o.transform,o[e]=i);var a=t.style,s={};for(var l in o)r&&(s[l]=a[l]||""),a[l]=o[l];return s}},o=function(n,e,t){var o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];e.forEach(function(e){o?n.addEventListener(e,t[e]):n.removeEventListener(e,t[e])})},r=function(n){return(new Image).src=n},i={defaultZoomable:'img[data-action="zoom"]',enableGrab:!0,preloadImage:!0,transitionDuration:.4,transitionTimingFunction:"cubic-bezier(0.4, 0, 0, 1)",bgColor:"rgb(255, 255, 255)",bgOpacity:1,scaleBase:1,scaleExtra:.5,scrollThreshold:40,onOpen:null,onClose:null,onRelease:null,onBeforeOpen:null,onBeforeClose:null,onBeforeGrab:null,onBeforeRelease:null},a=void 0,s=document.body,l=document.createElement("div"),u=void 0,c=void 0,d=!1,f=!1,m=!0,v=!1,p=null,g=void 0,y=void 0,b=void 0,h=void 0,x=void 0,E={close:null,open:null},w=e(l),T=w.transformCssProp,L=w.transEndEvent,k=t(w.transitionProp,w.transformProp),C=200,B=2,A=["mousedown","mousemove","mouseup","touchstart","touchmove","touchend"],z=function(n,e,t){return k(n,e,t)},D=function(){var n=u.getBoundingClientRect(),e=n.width/2,t=n.height/2,o={x:n.left+e,y:n.top+t},r={x:window.innerWidth/2,y:window.innerHeight/2},a={x:r.x-e,y:r.y-t},s=a.x/e,l=a.y/t;return g={x:r.x-o.x,y:r.y-o.y},y=i.scaleBase+Math.min(s,l),"translate("+g.x+"px, "+g.y+"px) scale("+y+")"},G=function(n,e){var t=n.length,o=n[0],r=n.length,i=0,a=0,s={x:o.clientX,y:o.clientY},l={x:o.clientX,y:o.clientY};for(v=t>1;r--;){var u=n[r],c=[u.clientX,u.clientY],d=c[0],f=c[1];i+=d,a+=f,v&&(d<s.x?s.x=d:d>l.x&&(l.x=d),f<s.y?s.y=f:f>l.y&&(l.y=f))}if(v){var m=l.x-s.x,p=l.y-s.y;x=m>p?m/window.innerWidth*B:p/window.innerHeight*B}e(i/t,a/t)},O={scroll:function(){var n=window.pageYOffset||(document.documentElement||s.parentNode||s).scrollTop;null===p&&(p=n);var e=p-n;Math.abs(e)>=i.scrollThreshold&&(p=null,I.close())},keydown:function(n){var e=n.key||n.code;"Escape"!==e&&27!==n.keyCode||I.close()},mousedown:function(n){n.preventDefault(),h=setTimeout(function(){I.grab(n.clientX,n.clientY,!0)},C)},mousemove:function(n){m||I.grab(n.clientX,n.clientY)},mouseup:function(){clearTimeout(h)},touchstart:function(n){n.preventDefault(),h=setTimeout(function(){G(n.touches,function(n,e){return I.grab(n,e,!0)})},C)},touchmove:function(n){m||G(n.touches,function(n,e){return I.grab(n,e)})},touchend:function(n){n.targetTouches.length>0||(clearTimeout(h),m?I.close():I.release())}};l.setAttribute("id","zoom-overlay"),z(l,{zIndex:998,backgroundColor:i.bgColor,position:"fixed",top:0,left:0,right:0,bottom:0,opacity:0,transition:"opacity\n    "+i.transitionDuration+"s\n    "+i.transitionTimingFunction}),l.addEventListener("click",function(){return I.close()}),document.addEventListener("DOMContentLoaded",function(){return I.listen(i.defaultZoomable)});var I={listen:function(e){if("string"==typeof e){for(var t=document.querySelectorAll(e),o=t.length;o--;)I.listen(t[o]);return a}if("IMG"===e.tagName)return e.style.cursor=n+"zoom-in",e.addEventListener("click",function(n){n.preventDefault(),d?m?I.close():I.release():I.open(e)}),i.preloadImage&&e.hasAttribute("data-original")&&r(e.getAttribute("data-original")),a},config:function(n){if(!n)return i;for(var e in n)i[e]=n[e];return z(l,{backgroundColor:i.bgColor,transition:"opacity\n        "+i.transitionDuration+"s\n        "+i.transitionTimingFunction}),a},open:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.onOpen;if(!d&&!f&&(u="string"==typeof e?document.querySelector(e):e,"IMG"===u.tagName))return i.onBeforeOpen&&i.onBeforeOpen(u),d=!0,f=!0,c=u.parentNode,u.offsetWidth,E.open={position:"relative",zIndex:999,cursor:""+n+(i.enableGrab?"grab":"zoom-out"),transition:T+"\n        "+i.transitionDuration+"s\n        "+i.transitionTimingFunction,transform:D()},E.close=z(u,E.open,!0),c.appendChild(l),setTimeout(function(){return l.style.opacity=i.bgOpacity},30),document.addEventListener("scroll",O.scroll),document.addEventListener("keydown",O.keydown),u.addEventListener(L,function n(){u.removeEventListener(L,n),i.enableGrab&&o(u,A,O,!0),f=!1,u.hasAttribute("data-original")&&(b=u.getAttribute("src"),u.setAttribute("src",u.getAttribute("data-original"))),t&&t(u)}),a},close:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.onClose;if(d&&!f)return f=!0,i.onBeforeClose&&i.onBeforeClose(u),u.offsetWidth,l.style.opacity=0,z(u,{transform:"none"}),document.removeEventListener("scroll",O.scroll),document.removeEventListener("keydown",O.keydown),u.addEventListener(L,function e(){u.removeEventListener(L,e),i.enableGrab&&o(u,A,O,!1),d=!1,f=!1,u.hasAttribute("data-original")&&u.setAttribute("src",b),z(u,E.close),c.removeChild(l),n&&n(u)}),a},grab:function(n,e,t,o){if(d&&!f){m=!1,i.onBeforeGrab&&i.onBeforeGrab(u);var r=window.innerWidth/2-n,a=window.innerHeight/2-e,s=v?x:i.scaleExtra,l=u.style.transform.replace(/translate\(.*?\)/i,"translate("+(g.x+r)+"px, "+(g.y+a)+"px)").replace(/scale\([0-9|\.]*\)/i,"scale("+(y+s)+")");z(u,{cursor:"move",transition:T+" "+(t?i.transitionDuration+"s "+i.transitionTimingFunction:"ease"),transform:l}),u.addEventListener(L,function n(){u.removeEventListener(L,n),o&&o(u)})}},release:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.onRelease;if(d&&!f)return f=!0,i.onBeforeRelease&&i.onBeforeRelease(u),z(u,E.open),u.addEventListener(L,function e(){u.removeEventListener(L,e),f=!1,m=!0,n&&n(u)}),a}};return I});
//# sourceMappingURL=zooming.min.js.map
