!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):n.Zooming=e()}(this,function(){"use strict";var n=document.body,e="WebkitAppearance"in document.documentElement.style?"-webkit-":"",t=function(n){return function(e){return e/n}},o=t(2),r=function(n){return(new Image).src=n},i=function(){return window.pageYOffset||(document.documentElement||n.parentNode||n).scrollTop},a=function(){return{x:o(window.innerWidth),y:o(window.innerHeight)}},s=function(n,e,t){var o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];e.forEach(function(e){o?n.addEventListener(e,t[e]):n.removeEventListener(e,t[e])})},u=function(n){var e={},t=["webkitTransition","transition","mozTransition"],o=["webkitTransform","transform","mozTransform"],r={transition:"transitionend",mozTransition:"transitionend",webkitTransition:"webkitTransitionEnd"};return t.some(function(t){if(void 0!==n.style[t])return e.transitionProp=t,e.transEndEvent=r[t],!0}),o.some(function(t){if(void 0!==n.style[t])return e.transformProp=t,e.transformCssProp=t.replace(/(.*)Transform/,"-$1-transform"),!0}),e},l=function(n,e){return function(t,o,r){var i=void 0;o.transition&&(i=o.transition,delete o.transition,o[n]=i),o.transform&&(i=o.transform,delete o.transform,o[e]=i);var a=t.style,s={};for(var u in o)r&&(s[u]=a[u]||""),a[u]=o[u];return s}},c=200,d=2,f=["mousedown","mousemove","mouseup","touchstart","touchmove","touchend"],m={defaultZoomable:'img[data-action="zoom"]',enableGrab:!0,preloadImage:!0,transitionDuration:.4,transitionTimingFunction:"cubic-bezier(0.4, 0, 0, 1)",bgColor:"rgb(255, 255, 255)",bgOpacity:1,scaleBase:1,scaleExtra:.5,scrollThreshold:40,onOpen:null,onClose:null,onRelease:null,onBeforeOpen:null,onBeforeClose:null,onBeforeGrab:null,onBeforeRelease:null},v=void 0,p=document.createElement("div"),g=void 0,y=void 0,b=!1,h=!1,x=!0,E=!1,w=null,T=void 0,L=void 0,k=void 0,C=void 0,B=void 0,A={close:null,open:null},z=u(p),D=z.transformCssProp,G=z.transEndEvent,O=l(z.transitionProp,z.transformProp),I=function(n,e,t){return O(n,e,t)},P=function(n){var e=a(),t={x:n.left+o(n.width),y:n.top+o(n.height)};return{x:e.x-t.x,y:e.y-t.y}},R=function(n,e){var t=a(),r=o(n.width),i=o(n.height),s={x:t.x-r,y:t.y-i},u=s.x/r,l=s.y/i;return e+Math.min(u,l)},Y=function(n,e){var t=n.length,o=n[0],r=n.length,i=0,a=0,s={x:o.clientX,y:o.clientY},u={x:o.clientX,y:o.clientY};for(E=t>1;r--;){var l=n[r],c=[l.clientX,l.clientY],f=c[0],m=c[1];i+=f,a+=m,E&&(f<s.x?s.x=f:f>u.x&&(u.x=f),m<s.y?s.y=m:m>u.y&&(u.y=m))}if(E){var v=u.x-s.x,p=u.y-s.y;B=v>p?v/window.innerWidth*d:p/window.innerHeight*d}e(i/t,a/t)},F={scroll:function(){var n=i();null===w&&(w=n);var e=w-n;Math.abs(e)>=m.scrollThreshold&&(w=null,M.close())},keydown:function(n){var e=n.key||n.code;"Escape"!==e&&27!==n.keyCode||M.close()},mousedown:function(n){n.preventDefault(),C=setTimeout(function(){M.grab(n.clientX,n.clientY,!0)},c)},mousemove:function(n){x||M.grab(n.clientX,n.clientY)},mouseup:function(){clearTimeout(C)},touchstart:function(n){n.preventDefault(),C=setTimeout(function(){Y(n.touches,function(n,e){return M.grab(n,e,!0)})},c)},touchmove:function(n){x||Y(n.touches,function(n,e){return M.grab(n,e)})},touchend:function(n){n.targetTouches.length>0||(clearTimeout(C),x?M.close():M.release())}},M={listen:function(n){if("string"==typeof n){for(var t=document.querySelectorAll(n),o=t.length;o--;)M.listen(t[o]);return v}if("IMG"===n.tagName)return n.style.cursor=e+"zoom-in",n.addEventListener("click",function(e){e.preventDefault(),b?x?M.close():M.release():M.open(n)}),m.preloadImage&&n.hasAttribute("data-original")&&r(n.getAttribute("data-original")),v},config:function(n){if(!n)return m;for(var e in n)m[e]=n[e];return I(p,{backgroundColor:m.bgColor,transition:"opacity\n        "+m.transitionDuration+"s\n        "+m.transitionTimingFunction}),v},open:function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m.onOpen;if(!b&&!h&&(g="string"==typeof n?document.querySelector(n):n,"IMG"===g.tagName)){m.onBeforeOpen&&m.onBeforeOpen(g),b=!0,h=!0,y=g.parentNode;var o=g.getBoundingClientRect();return T=P(o),L=R(o,m.scaleBase),g.offsetWidth,A.open={position:"relative",zIndex:999,cursor:""+e+(m.enableGrab?"grab":"zoom-out"),transition:D+"\n        "+m.transitionDuration+"s\n        "+m.transitionTimingFunction,transform:"translate("+T.x+"px, "+T.y+"px) scale("+L+")"},A.close=I(g,A.open,!0),y.appendChild(p),setTimeout(function(){return p.style.opacity=m.bgOpacity},30),document.addEventListener("scroll",F.scroll),document.addEventListener("keydown",F.keydown),g.addEventListener(G,function n(){g.removeEventListener(G,n),m.enableGrab&&s(g,f,F,!0),h=!1,g.hasAttribute("data-original")&&(k=g.getAttribute("src"),g.setAttribute("src",g.getAttribute("data-original"))),t&&t(g)}),v}},close:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m.onClose;if(b&&!h)return h=!0,m.onBeforeClose&&m.onBeforeClose(g),g.offsetWidth,p.style.opacity=0,I(g,{transform:"none"}),document.removeEventListener("scroll",F.scroll),document.removeEventListener("keydown",F.keydown),g.addEventListener(G,function e(){g.removeEventListener(G,e),m.enableGrab&&s(g,f,F,!1),b=!1,h=!1,g.hasAttribute("data-original")&&g.setAttribute("src",k),I(g,A.close),y.removeChild(p),n&&n(g)}),v},grab:function(n,e,t,o){if(b&&!h){x=!1,m.onBeforeGrab&&m.onBeforeGrab(g);var r=a(),i=r.x-n,s=r.y-e,u=E?B:m.scaleExtra,l=g.style.transform.replace(/translate\(.*?\)/i,"translate("+(T.x+i)+"px, "+(T.y+s)+"px)").replace(/scale\([0-9|\.]*\)/i,"scale("+(L+u)+")");I(g,{cursor:"move",transition:D+" "+(t?m.transitionDuration+"s "+m.transitionTimingFunction:"ease"),transform:l}),g.addEventListener(G,function n(){g.removeEventListener(G,n),o&&o(g)})}},release:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m.onRelease;if(b&&!h)return h=!0,m.onBeforeRelease&&m.onBeforeRelease(g),I(g,A.open),g.addEventListener(G,function e(){g.removeEventListener(G,e),h=!1,x=!0,n&&n(g)}),v}};return p.setAttribute("id","zoom-overlay"),I(p,{zIndex:998,backgroundColor:m.bgColor,position:"fixed",top:0,left:0,right:0,bottom:0,opacity:0,transition:"opacity\n    "+m.transitionDuration+"s\n    "+m.transitionTimingFunction}),p.addEventListener("click",function(){return M.close()}),document.addEventListener("DOMContentLoaded",function(){return M.listen(m.defaultZoomable)}),M});
//# sourceMappingURL=zooming.min.js.map
