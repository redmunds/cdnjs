!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.Zooming=n()}(this,function(){"use strict";var e="WebkitAppearance"in document.documentElement.style?"-webkit-":"",n=function(e){return function(n){return n/e}},t=n(2),o=function(e){return(new Image).src=e},r=function(){var e=document.body;return window.pageYOffset||(document.documentElement||e.parentNode||e).scrollTop},i=function(){return{x:t(window.innerWidth),y:t(window.innerHeight)}},a=function(e,n,t){var o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];n.forEach(function(n){o?e.addEventListener(n,t[n]):e.removeEventListener(n,t[n])})},s=200,u=2,c=["mousedown","mousemove","mouseup","touchstart","touchmove","touchend"],l={defaultZoomable:'img[data-action="zoom"]',enableGrab:!0,preloadImage:!0,transitionDuration:.4,transitionTimingFunction:"cubic-bezier(0.4, 0, 0, 1)",bgColor:"rgb(255, 255, 255)",bgOpacity:1,scaleBase:1,scaleExtra:.5,scrollThreshold:40,onOpen:null,onClose:null,onRelease:null,onBeforeOpen:null,onBeforeClose:null,onBeforeGrab:null,onBeforeMove:null,onBeforeRelease:null},d={target:{close:null,open:null},overlay:{init:{zIndex:998,backgroundColor:l.bgColor,position:"fixed",top:0,left:0,right:0,bottom:0,opacity:0,transition:"opacity\n        "+l.transitionDuration+"s\n        "+l.transitionTimingFunction}},cursor:{default:"auto",zoomIn:e+"zoom-in",zoomOut:e+"zoom-out",grab:e+"grab",move:"move"}},f=function(e){var n={},t=["webkitTransition","transition","mozTransition"],o=["webkitTransform","transform","mozTransform"],r={transition:"transitionend",mozTransition:"transitionend",webkitTransition:"webkitTransitionEnd"};return t.some(function(t){if(void 0!==e.style[t])return n.transitionProp=t,n.transEndEvent=r[t],!0}),o.some(function(t){if(void 0!==e.style[t])return n.transformProp=t,n.transformCssProp=t.replace(/(.*)Transform/,"-$1-transform"),!0}),n},m=function(e,n){return function(t,o,r){var i=void 0;o.transition&&(i=o.transition,delete o.transition,o[e]=i),o.transform&&(i=o.transform,delete o.transform,o[n]=i);var a=t.style,s={};for(var u in o)r&&(s[u]=a[u]||""),a[u]=o[u];return s}},v=function(e){var n=i(),o={x:e.left+t(e.width),y:e.top+t(e.height)};return{x:n.x-o.x,y:n.y-o.y}},g=function(e,n){var o=i(),r=t(e.width),a=t(e.height),s={x:o.x-r,y:o.y-a},u=s.x/r,c=s.y/a;return n+Math.min(u,c)},p=function(e,n){for(var t=e.length,o=e[0],r=t>1,i=l.scaleExtra,a=e.length,s=0,c=0,d={x:o.clientX,y:o.clientY},f={x:o.clientX,y:o.clientY};a--;){var m=e[a],v=[m.clientX,m.clientY],g=v[0],p=v[1];s+=g,c+=p,r&&(g<d.x?d.x=g:g>f.x&&(f.x=g),p<d.y?d.y=p:p>f.y&&(f.y=p))}if(r){var y=f.x-d.x,b=f.y-d.y;i=y>b?y/window.innerWidth*u:b/window.innerHeight*u}n(s/t,c/t,i)},y=void 0,b=document.body,h=document.createElement("div"),x=void 0,E=void 0,w=!1,T=!1,L=!0,k=null,B=void 0,C=void 0,z=void 0,A=void 0,O=f(h),D=O.transformCssProp,G=O.transEndEvent,I=m(O.transitionProp,O.transformProp),M=function(e,n,t){return I(e,n,t)},P={click:function(e){e.preventDefault(),w?L?R.close():R.release():R.open(e.currentTarget)},scroll:function(){var e=r();null===k&&(k=e);var n=k-e;Math.abs(n)>=l.scrollThreshold&&(k=null,R.close())},keydown:function(e){var n=e.key||e.code;"Escape"!==n&&27!==e.keyCode||R.close()},mousedown:function(e){e.preventDefault(),A=setTimeout(function(){R.grab(e.clientX,e.clientY)},s)},mousemove:function(e){L||R.move(e.clientX,e.clientY)},mouseup:function(){clearTimeout(A),L?R.close():R.release()},touchstart:function(e){e.preventDefault(),A=setTimeout(function(){p(e.touches,function(e,n,t){R.grab(e,n,t)})},s)},touchmove:function(e){L||p(e.touches,function(e,n,t){R.move(e,n,t)})},touchend:function(e){e.targetTouches.length>0||(clearTimeout(A),L?R.close():R.release())}},R={listen:function(e){if("string"==typeof e){for(var n=document.querySelectorAll(e),t=n.length;t--;)R.listen(n[t]);return y}if("IMG"===e.tagName)return e.style.cursor=d.cursor.zoomIn,e.addEventListener("click",P.click),l.preloadImage&&e.hasAttribute("data-original")&&o(e.getAttribute("data-original")),y},config:function(e){if(!e)return l;for(var n in e)l[n]=e[n];return M(h,{backgroundColor:l.bgColor,transition:"opacity "+l.transitionDuration+"s "+l.transitionTimingFunction}),y},open:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l.onOpen;if(!w&&!T&&(x="string"==typeof e?document.querySelector(e):e,"IMG"===x.tagName)){l.onBeforeOpen&&l.onBeforeOpen(x),w=!0,T=!0,E=x.parentNode;var t=x.getBoundingClientRect();return B=v(t),C=g(t,l.scaleBase),x.offsetWidth,d.target.open={position:"relative",zIndex:999,cursor:l.enableGrab?d.cursor.grab:d.cursor.zoomOut,transition:D+" "+l.transitionDuration+"s "+l.transitionTimingFunction,transform:"translate("+B.x+"px, "+B.y+"px) scale("+C+")"},d.target.close=M(x,d.target.open,!0),E.appendChild(h),setTimeout(function(){return h.style.opacity=l.bgOpacity},30),document.addEventListener("scroll",P.scroll),document.addEventListener("keydown",P.keydown),x.addEventListener(G,function e(){x.removeEventListener(G,e),l.enableGrab&&a(document,c,P,!0),T=!1,x.hasAttribute("data-original")&&(z=x.getAttribute("src"),x.setAttribute("src",x.getAttribute("data-original"))),n&&n(x)}),y}},close:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l.onClose;if(w&&!T)return T=!0,l.onBeforeClose&&l.onBeforeClose(x),x.offsetWidth,b.style.cursor=d.cursor.default,h.style.opacity=0,M(x,{transform:"none"}),document.removeEventListener("scroll",P.scroll),document.removeEventListener("keydown",P.keydown),x.addEventListener(G,function n(){x.removeEventListener(G,n),l.enableGrab&&a(document,c,P,!1),w=!1,T=!1,x.hasAttribute("data-original")&&x.setAttribute("src",z),M(x,d.target.close),E.removeChild(h),e&&e(x)}),y},grab:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l.scaleExtra,o=arguments[3];if(w&&!T){L=!1,l.onBeforeGrab&&l.onBeforeGrab(x);var r=i(),a=r.x-e,s=r.y-n;M(x,{cursor:d.cursor.move,transition:D+" "+l.transitionDuration+"s "+l.transitionTimingFunction,transform:"translate("+(B.x+a)+"px, "+(B.y+s)+"px) scale("+(C+t)+")"}),x.addEventListener(G,function e(){x.removeEventListener(G,e),o&&o(x)})}},move:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l.scaleExtra,o=arguments[3];if(w&&!T){L=!1,l.onBeforeMove&&l.onBeforeMove(x);var r=i(),a=r.x-e,s=r.y-n;M(x,{cursor:d.cursor.move,transition:D+" ease",transform:"translate("+(B.x+a)+"px, "+(B.y+s)+"px) scale("+(C+t)+")"}),b.style.cursor=d.cursor.move,x.addEventListener(G,function e(){x.removeEventListener(G,e),o&&o(x)})}},release:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l.onRelease;if(w&&!T)return T=!0,l.onBeforeRelease&&l.onBeforeRelease(x),M(x,d.target.open),b.style.cursor=d.cursor.default,x.addEventListener(G,function n(){x.removeEventListener(G,n),T=!1,L=!0,e&&e(x)}),y}};return M(h,d.overlay.init),h.setAttribute("id","zoom-overlay"),h.addEventListener("click",function(){return R.close()}),document.addEventListener("DOMContentLoaded",function(){return R.listen(l.defaultZoomable)}),R});
//# sourceMappingURL=zooming.min.js.map
