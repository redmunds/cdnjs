!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.Zooming=n()}(this,function(){"use strict";function e(e,n,t){return X(e,n,t)}function n(){var e=T.getBoundingClientRect(),n=e.width/2,t=e.height/2,o={x:e.left+n,y:e.top+t},r={x:window.innerWidth/2,y:window.innerHeight/2},i={x:r.x-n,y:r.y-t},a=i.x/n,s=i.y/t;return D={x:r.x-o.x,y:r.y-o.y},O=g.scaleBase+Math.min(a,s),"translate("+D.x+"px, "+D.y+"px) scale("+O+")"}function t(e){e.addEventListener("mousedown",s),e.addEventListener("mousemove",l),e.addEventListener("mouseup",u),e.addEventListener("touchstart",c),e.addEventListener("touchmove",d),e.addEventListener("touchend",f)}function o(e){e.removeEventListener("mousedown",s),e.removeEventListener("mousemove",l),e.removeEventListener("mouseup",u),e.removeEventListener("touchstart",c),e.removeEventListener("touchmove",d),e.removeEventListener("touchend",f)}function r(e,n){var t=e.length;A=t>1;for(var o=e.length,r=0,i=0,a=e[0].clientX,s=e[0].clientY,l=e[0].clientX,u=e[0].clientY;o--;){var c=e[o],d=c.clientX,f=c.clientY;r+=d,i+=f,A&&(d<a?a=d:d>l&&(l=d),f<s?s=f:f>u&&(u=f))}if(A){var m=l-a,v=u-s;R=m>v?m/window.innerWidth*p:v/window.innerHeight*p}n(r/e.length,i/e.length)}function i(){var e=window.pageYOffset||(document.documentElement||L.parentNode||L).scrollTop;null===z&&(z=e);var n=z-e;Math.abs(n)>=g.scrollThreshold&&(z=null,N.close())}function a(e){var n=e.key||e.code;"Escape"!==n&&27!==e.keyCode||N.close()}function s(e){e.preventDefault(),P=setTimeout(function(){k=!0,N.grab(e.clientX,e.clientY,!0)},v)}function l(e){k&&N.grab(e.clientX,e.clientY)}function u(){clearTimeout(P),k=!1,G?N.release():N.close()}function c(e){e.preventDefault(),P=setTimeout(function(){k=!0,r(e.touches,function(e,n){return N.grab(e,n,!0)})},v)}function d(e){k&&r(e.touches,function(e,n){return N.grab(e,n)})}function f(e){0===e.targetTouches.length&&(clearTimeout(P),k=!1,G?N.release():N.close())}var m="WebkitAppearance"in document.documentElement.style?"-webkit-":"",v=200,p=2,g={defaultZoomable:'img[data-action="zoom"]',enableGrab:!0,preloadImage:!0,transitionDuration:.4,transitionTimingFunction:"cubic-bezier(.4,0,0,1)",bgColor:"#fff",bgOpacity:1,scaleBase:1,scaleExtra:.5,scrollThreshold:40,onOpen:null,onClose:null,onGrab:null,onRelease:null,onBeforeOpen:null,onBeforeClose:null,onBeforeGrab:null,onBeforeRelease:null},b=function(e){var n={},t=["webkitTransition","transition","mozTransition"],o=["webkitTransform","transform","mozTransform"],r={transition:"transitionend",mozTransition:"transitionend",webkitTransition:"webkitTransitionEnd"};return t.some(function(t){if(void 0!==e.style[t])return n.transitionProp=t,n.transEndEvent=r[t],!0}),o.some(function(t){if(void 0!==e.style[t])return n.transformProp=t,n.transformCssProp=t.replace(/(.*)Transform/,"-$1-transform"),!0}),n},h=function(e,n){return function(t,o,r){var i=void 0;o.transition&&(i=o.transition,delete o.transition,o[e]=i),o.transform&&(i=o.transform,delete o.transform,o[n]=i);var a=t.style,s={};for(var l in o)r&&(s[l]=a[l]||""),a[l]=o[l];return s}},E=function(e){return(new Image).src=e},y=void 0,L=document.body,w=document.createElement("div"),T=void 0,x=void 0,C=!1,B=!1,k=!1,G=!1,A=!1,z=null,D=void 0,O=void 0,I=void 0,P=void 0,R=void 0,W={close:null,open:null},Y=b(w),F=Y.transformCssProp,M=Y.transEndEvent,X=h(Y.transitionProp,Y.transformProp),N={listen:function(e){if("string"==typeof e){for(var n=document.querySelectorAll(e),t=n.length;t--;)N.listen(n[t]);return y}if("IMG"===e.tagName)return e.style.cursor=m+"zoom-in",e.addEventListener("click",function(n){n.preventDefault(),C||N.open(e)}),g.preloadImage&&e.hasAttribute("data-original")&&E(e.getAttribute("data-original")),y},config:function(n){if(!n)return g;for(var t in n)g[t]=n[t];return e(w,{backgroundColor:g.bgColor,transition:"opacity\n        "+g.transitionDuration+"s\n        "+g.transitionTimingFunction}),y},open:function(o){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:g.onOpen;if(!C&&!B&&(T="string"==typeof o?document.querySelector(o):o,"IMG"===T.tagName))return g.onBeforeOpen&&g.onBeforeOpen(T),C=!0,B=!0,x=T.parentNode,T.offsetWidth,W.open={position:"relative",zIndex:999,cursor:""+m+(g.enableGrab?"grab":"zoom-out"),transition:F+"\n        "+g.transitionDuration+"s\n        "+g.transitionTimingFunction,transform:n()},W.close=e(T,W.open,!0),x.appendChild(w),setTimeout(function(){return w.style.opacity=g.bgOpacity},30),document.addEventListener("scroll",i),document.addEventListener("keydown",a),T.addEventListener(M,function e(){T.removeEventListener(M,e),g.enableGrab&&t(T),B=!1,T.hasAttribute("data-original")&&(I=T.getAttribute("src"),T.setAttribute("src",T.getAttribute("data-original"))),r&&r(T)}),y},close:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g.onClose;if(C&&!B)return B=!0,g.onBeforeClose&&g.onBeforeClose(T),T.offsetWidth,w.style.opacity=0,e(T,{transform:"none"}),document.removeEventListener("scroll",i),document.removeEventListener("keydown",a),T.addEventListener(M,function t(){T.removeEventListener(M,t),g.enableGrab&&o(T),C=!1,B=!1,T.hasAttribute("data-original")&&T.setAttribute("src",I),e(T,W.close),x.removeChild(w),n&&n(T)}),y},grab:function(n,t,o){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:g.onGrab;if(C&&!B){G=!0,g.onBeforeGrab&&g.onBeforeGrab(T);var i=window.innerWidth/2-n,a=window.innerHeight/2-t,s=A?R:g.scaleExtra,l=T.style.transform.replace(/translate\(.*?\)/i,"translate("+(D.x+i)+"px, "+(D.y+a)+"px)").replace(/scale\([0-9|\.]*\)/i,"scale("+(O+s)+")");e(T,{cursor:"move",transition:F+" "+(o?g.transitionDuration+"s "+g.transitionTimingFunction:"ease"),transform:l}),T.addEventListener(M,function e(){T.removeEventListener(M,e),r&&r(T)})}},release:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g.onRelease;if(C&&!B&&G)return g.onBeforeRelease&&g.onBeforeRelease(T),e(T,W.open),T.addEventListener(M,function e(){T.removeEventListener(M,e),G=!1,n&&n(T)}),y}};return e(w,{zIndex:998,background:g.bgColor,position:"fixed",top:0,left:0,right:0,bottom:0,opacity:0,transition:"opacity\n    "+g.transitionDuration+"s\n    "+g.transitionTimingFunction}),w.addEventListener("click",function(){return N.close()}),document.addEventListener("DOMContentLoaded",function(){return N.listen(g.defaultZoomable)}),N});
//# sourceMappingURL=zooming.min.js.map
