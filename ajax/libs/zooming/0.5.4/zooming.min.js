!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.Zooming=n()}(this,function(){"use strict";function e(e,n,t){return M(e,n,t)}function n(){P=L.getBoundingClientRect(),L.hasAttribute("data-original")&&(O=L.getAttribute("src"),e(L,{width:P.width+"px",height:P.height+"px"}),L.setAttribute("src",L.getAttribute("data-original"))),L.offsetWidth,z={position:"relative",zIndex:999,cursor:""+v+(p.enableGrab?"grab":"zoom-out"),transition:Y+"\n      "+p.transitionDuration+"\n      "+p.transitionTimingFunction,transform:t()},G=e(L,z,!0)}function t(){var e=P.width/2,n=P.height/2,t={x:P.left+e,y:P.top+n},o={x:window.innerWidth/2,y:window.innerHeight/2},r={x:o.x-e,y:o.y-n},i=r.x/e,a=r.y/n;return A={x:o.x-t.x,y:o.y-t.y},D=p.scaleBase+Math.min(i,a),"translate("+A.x+"px, "+A.y+"px) scale("+D+")"}function o(e){e.addEventListener("mousedown",s),e.addEventListener("mousemove",u),e.addEventListener("mouseup",l),e.addEventListener("touchstart",c),e.addEventListener("touchmove",d),e.addEventListener("touchend",f)}function r(e){e.removeEventListener("mousedown",s),e.removeEventListener("mousemove",u),e.removeEventListener("mouseup",l),e.removeEventListener("touchstart",c),e.removeEventListener("touchmove",d),e.removeEventListener("touchend",f)}function i(){var e=window.pageYOffset||(document.documentElement||E.parentNode||E).scrollTop;null===k&&(k=e);var n=k-e;Math.abs(n)>=p.scrollThreshold&&(k=null,W.close())}function a(e){var n=e.key||e.code;"Escape"!==n&&27!==e.keyCode||W.close()}function s(e){e.preventDefault(),R=setTimeout(function(){C=!0,W.grab(e.clientX,e.clientY,!0)},m)}function u(e){C&&W.grab(e.clientX,e.clientY)}function l(){clearTimeout(R),C=!1,W.release()}function c(e){e.preventDefault(),R=setTimeout(function(){C=!0;var n=e.touches[0];W.grab(n.clientX,n.clientY,!0)},m)}function d(e){if(C){var n=e.touches[0];W.grab(n.clientX,n.clientY)}}function f(){clearTimeout(R),C=!1,B?W.release():W.close()}var v="WebkitAppearance"in document.documentElement.style?"-webkit-":"",m=200,p={defaultZoomable:'img[data-action="zoom"]',enableGrab:!0,transitionDuration:".4s",transitionTimingFunction:"cubic-bezier(.4,0,0,1)",bgColor:"#fff",bgOpacity:1,scaleBase:1,scaleExtra:.5,scrollThreshold:40,onOpen:null,onClose:null,onGrab:null,onRelease:null,onBeforeOpen:null,onBeforeClose:null,onBeforeGrab:null,onBeforeRelease:null},b=function(e){var n={},t=["webkitTransition","transition","mozTransition"],o=["webkitTransform","transform","mozTransform"],r={transition:"transitionend",mozTransition:"transitionend",webkitTransition:"webkitTransitionEnd"};return t.some(function(t){if(void 0!==e.style[t])return n.transitionProp=t,n.transEndEvent=r[t],!0}),o.some(function(t){if(void 0!==e.style[t])return n.transformProp=t,n.transformCssProp=t.replace(/(.*)Transform/,"-$1-transform"),!0}),n},g=function(e,n){return function(t,o,r){var i=void 0;o.transition&&(i=o.transition,delete o.transition,o[e]=i),o.transform&&(i=o.transform,delete o.transform,o[n]=i);var a=t.style,s={};for(var u in o)r&&(s[u]=a[u]||""),a[u]=o[u];return s}},h=void 0,E=document.body,y=document.createElement("div"),L=void 0,w=void 0,x=!1,T=!1,C=!1,B=!1,k=null,G=void 0,z=void 0,A=void 0,D=void 0,O=void 0,P=void 0,R=void 0,F=b(y),Y=F.transformCssProp,I=F.transEndEvent,M=g(F.transitionProp,F.transformProp),W={listen:function(e){return"string"==typeof e?(document.querySelectorAll(e).forEach(function(e){return W.listen(e)}),h):(e.style.cursor=v+"zoom-in",e.addEventListener("click",function(n){n.preventDefault(),x?W.close():W.open(e)}),h)},config:function(n){if(!n)return p;for(var t in n)p[t]=n[t];return e(y,{backgroundColor:p.bgColor,transition:"opacity\n        "+p.transitionDuration+"\n        "+p.transitionTimingFunction}),h},open:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p.onOpen;if(!(x||T||B)&&(L="string"==typeof e?document.querySelector(e):e,"IMG"===L.tagName)){p.onBeforeOpen&&p.onBeforeOpen(L),x=!0,T=!0,w=L.parentNode;var r=new Image;return r.onload=n(),r.src=L.getAttribute("src"),w.appendChild(y),setTimeout(function(){return y.style.opacity=p.bgOpacity},30),document.addEventListener("scroll",i),document.addEventListener("keydown",a),L.addEventListener(I,function e(){L.removeEventListener(I,e),p.enableGrab&&o(L),T=!1,t&&t(L)}),h}},close:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p.onClose;if(x&&!T&&!B)return T=!0,p.onBeforeClose&&p.onBeforeClose(L),y.style.opacity=0,L.style.transform="",document.removeEventListener("scroll",i),document.removeEventListener("keydown",a),L.addEventListener(I,function t(){L.removeEventListener(I,t),p.enableGrab&&r(L),x=!1,T=!1,B=!1,e(L,G),w.removeChild(y),L.hasAttribute("data-original")&&L.setAttribute("src",O),n&&n(L)}),h},grab:function(n,t,o){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:p.onGrab;if(x&&!T){B=!0,p.onBeforeGrab&&p.onBeforeGrab(L);var i=n-window.innerWidth/2,a=t-window.innerHeight/2,s=L.style.transform.replace(/translate\(.*?\)/i,"translate("+(A.x+i)+"px, "+(A.y+a)+"px)").replace(/scale\([0-9|\.]*\)/i,"scale("+(D+p.scaleExtra)+")");e(L,{cursor:v+" grabbing",transition:Y+" "+(o?p.transitionDuration+" "+p.transitionTimingFunction:"ease"),transform:s}),L.addEventListener(I,function e(){L.removeEventListener(I,e),r&&r(L)})}},release:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p.onRelease;if(x&&!T&&B)return p.onBeforeRelease&&p.onBeforeRelease(L),e(L,z),L.addEventListener(I,function e(){L.removeEventListener(I,e),B=!1,n&&n(L)}),h}};return e(y,{zIndex:998,background:p.bgColor,position:"fixed",top:0,left:0,right:0,bottom:0,opacity:0,transition:"opacity\n    "+p.transitionDuration+"\n    "+p.transitionTimingFunction}),y.addEventListener("click",W.close),document.addEventListener("DOMContentLoaded",W.listen(p.defaultZoomable)),W});