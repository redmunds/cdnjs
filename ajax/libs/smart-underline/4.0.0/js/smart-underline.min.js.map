{"version":3,"sources":["smart-underline.js"],"names":["PHI","backgroundPositionYCache","calculateBaselineYRatio","calculateTextHighestY","calculateTypeMetrics","clearCanvas","containerIdAttrName","containsAnyNonInlineElements","containsInvalidElements","countParentContainers","destroy","fontAvailable","getBackgroundColor","getBackgroundColorNode","getFirstAvailableFont","getLinkColor","getUnderlineBackgroundPositionY","hasValidLinkContent","init","initLink","initLinkOnHover","isTransparent","linkAlwysAttrName","linkBgPosAttrName","linkColorAttrName","linkContainers","linkHoverAttrName","linkLargeAttrName","linkSmallAttrName","performanceTimes","renderStyles","selectionColor","sortContainersForCSSPrecendence","styleNode","time","uniqueLinkContainerID","window","SmartUnderline","document","documentElement","getAttribute","Date","id","canvas","context","clearRect","width","height","text","alpha","highestY","i","j","pixelData","r","ref","ref1","textWidth","x","y","fillStyle","measureText","fillText","getImageData","data","computedStyle","baselineY","descenderHeight","gLowestPixel","createElement","getContext","parseInt","fontSize","textBaseline","textAlign","fontStretch","angle","font","fontVariant","fontStyle","fontWeight","lineHeight","fontFamily","node","baselinePositionY","baselineYRatio","large","largeRect","small","smallRect","test","style","display","position","bottom","right","margin","padding","visibility","overflow","wordWrap","whiteSpace","innerHTML","appendChild","getBoundingClientRect","removeChild","top","Math","abs","fonts","len","split","length","baselineSize","newSize","adjustment","backgroundPositionY","backgroundPositionYPercent","cache","cacheKey","clientRects","descenderY","firstAvailableFont","fontSizeInt","minimumCloseness","textHeight","getComputedStyle","random","getClientRects","navigator","userAgent","toLowerCase","indexOf","max","round","color","rgbaAlphaMatch","match","parseFloat","backgroundColor","parentNode","reachedRootNode","backgroundImage","child","ref2","children","tagName","count","hasAttribute","containers","container","sorted","depth","push","sort","a","b","link","textDecoration","setAttribute","links","containersWithPrecedence","len1","linkBackgroundPositionYs","linkColors","linkSelector","styles","modifier","alreadyMadeSmart","madeSmart","this","options","startTime","querySelectorAll","location","removeEventListener","addEventListener","body","attribute","results","Array","prototype","forEach","call","removeAttribute","readyState"],"mappings":"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","file":"smart-underline.min.js"}