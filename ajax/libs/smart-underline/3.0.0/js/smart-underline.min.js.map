{"version":3,"sources":["smart-underline.js"],"names":["PHI","backgroundPositionYCache","calculateBaselineYRatio","calculateTextHighestY","calculateTypeMetrics","clearCanvas","containerIdAttrName","containsAnyNonInlineElements","containsInvalidElements","countParentContainers","destroy","getBackgroundColor","getBackgroundColorNode","getLinkColor","getUnderlineBackgroundPositionY","hasValidLinkContent","init","initLink","initLinkOnHover","isTransparent","linkAlwysAttrName","linkBgPosAttrName","linkColorAttrName","linkContainers","linkHoverAttrName","linkLargeAttrName","linkSmallAttrName","performanceTimes","renderStyles","selectionColor","sortContainersForCSSPrecendence","styleNode","time","uniqueLinkContainerID","window","SmartUnderline","document","documentElement","getAttribute","Date","id","canvas","context","clearRect","width","height","text","alpha","highestY","pixelData","r","textWidth","x","y","_i","_j","_ref","fillStyle","measureText","fillText","getImageData","data","computedStyle","baselineY","descenderHeight","gLowestPixel","createElement","getContext","parseInt","fontSize","textBaseline","textAlign","fontStretch","angle","font","fontVariant","fontStyle","fontWeight","lineHeight","fontFamily","node","baselinePositionY","baselineYRatio","large","largeRect","small","smallRect","test","style","display","position","bottom","right","margin","padding","visibility","overflow","innerHTML","appendChild","getBoundingClientRect","removeChild","top","Math","abs","adjustment","backgroundPositionY","backgroundPositionYPercent","cache","cacheKey","clientRects","descenderY","fontSizeInt","minimumCloseness","textHeight","getComputedStyle","getClientRects","length","navigator","userAgent","toLowerCase","indexOf","max","round","color","rgbaAlphaMatch","match","parseFloat","backgroundColor","parentNode","reachedRootNode","backgroundImage","child","_len","_ref1","_ref2","children","tagName","count","hasAttribute","containers","container","sorted","depth","push","sort","a","b","link","textDecoration","setAttribute","links","containersWithPrecedence","linkBackgroundPositionYs","linkColors","linkSelector","styles","_len1","modifier","alreadyMadeSmart","madeSmart","this","options","startTime","querySelectorAll","location","removeEventListener","addEventListener","body","attribute","_results","Array","prototype","forEach","call","removeAttribute","readyState"],"mappings":"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","file":"smart-underline.min.js"}