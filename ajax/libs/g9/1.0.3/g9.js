!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.g9=t():e.g9=t()}(this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){e.exports=r(4)},function(e,t){"use strict";function r(e,t,r){return Math.min(Math.max(e,t),r)}function n(e,t,r){var n,i,o,u,s=function(e){r(o+e.clientX-n,u+e.clientY-i)},c=function f(e){document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",f)};e.addEventListener("mousedown",function(e){e.preventDefault(),n=e.clientX,i=e.clientY;var r=t(e),f=a(r,2);o=f[0],u=f[1],o=o||0,u=u||0,document.addEventListener("mousemove",s),document.addEventListener("mouseup",c)})}function i(e,t){e&&Object.keys(e).forEach(function(r){return t(e[r],r)})}function o(e,t){var r=arguments.length<=2||void 0===arguments[2]?null:arguments[2];i(t,function(t,n){e.setAttributeNS(r,n,t)})}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(s){i=!0,o=s}finally{try{!n&&u["return"]&&u["return"]()}finally{if(i)throw o}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.clamp=r,t.makeDraggable=n,t.forIn=i,t.setAttributes=o;t.defaultBounds={xmin:-(1/0),xmax:1/0,ymin:-(1/0),ymax:1/0}},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function i(e){var t=e.type,r=e.renderer,n=e.base,i=e.options,o=e.shortcut,a=e.cost;p[t]={renderer:r,base:n,shortcut:o,options:i,cost:a}}Object.defineProperty(t,"__esModule",{value:!0}),t.addshape=i;var o=r(6),a=n(o),u=r(8),s=n(u),c=r(10),f=n(c),l=r(7),h=n(l),d=r(9),y=n(d),p={};i(a),i(s),i(f),i(h),i(y),t["default"]=p},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(t){function r(){return"auto"+p+d++}function n(e){return function(){if(y[y.length-1]++,null===i||(i+"|").startsWith(y.join("|"))){y.push(0);var t=d;d=0,p=y.join("|");var r=e.apply(this,arguments);y.pop(),d=t,p=y.join("|")}return r}}var i=arguments.length<=1||void 0===arguments[1]?null:arguments[1],u=arguments[2],f=u.width,l=u.height,h={},d=0,y=[0],p=y.join("|"),v={pure:n,width:f,height:l};return(0,c.forIn)(s["default"],function(e,t){v[t]=function(){for(var t=a({},e.base),n=[].concat(Array.prototype.slice.call(arguments)),i=0;i<n.length-1;i++)t[e.shortcut[i]]=n[i];if("object"===o(n[i])){var u=a({},n[i]);e.options.forEach(function(e){e in u&&(t[e]=u[e],delete u[e])}),t.attributes=u}else t[e.shortcut[i]]=n[i];t.id=r(),t.stack=y.join("|"),h[t.id]=t}}),e(t,v),h}}Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};t["default"]=i;var u=r(2),s=n(u),c=r(1)},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=r(3),a=n(o),u=r(5),s=n(u),c=r(2),f=n(c),l=r(1);e.exports=function(e,t){function r(){var e=arguments.length<=0||void 0===arguments[0]?"left":arguments[0],t=arguments.length<=1||void 0===arguments[1]?"top":arguments[1];return x=e,g=t,n(),this}function n(){var e=b.getBoundingClientRect();w=e.width,O=e.height,j=e.top,k=e.left,A="left"===x?0:"center"===x?w/2:w,N="top"===g?0:"center"===g?O/2:O,b.setAttribute("viewBox",[-A,-N,w,O].join(" ")),c()}function o(e){return"string"==typeof e?document.querySelector(e).appendChild(b):e.appendChild(b),n(),this}function u(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;t>n;n++)r[n-1]=arguments[n];var o=d[e],a=o.type,u=Object.keys(p);o.cares&&(u=o.cares);var l=u.map(function(e){return p[e]}),h=(0,s["default"])(function(t){var n,s=i({},p);u.forEach(function(e,r){s[e]=t[r]});var c=v(s,o.stack,{width:w,height:O}),l=c[e],h=(n=f["default"][a]).cost.apply(n,[l].concat(r));return h},l).solution;u.forEach(function(e,t){p[e]=h[t]}),c()}function c(){d=v(p,null,{width:w,height:O}),(0,l.forIn)(d,function(e,t){m[t]||(m[t]=new f["default"][e.type].renderer(t,b,u)),m[t].setOffset(j+N,k+A),m[t].render(e)}),(0,l.forIn)(m,function(e,t){t in d||(e.remove(),delete m[t])}),y(p,d)}function h(e){p=e,c()}var d,y=arguments.length<=2||void 0===arguments[2]?function(){}:arguments[2],p=e,v=(0,a["default"])(t),m={},b=document.createElementNS("http://www.w3.org/2000/svg","svg"),x="left",g="top",w=0,O=0,j=0,k=0,A=0,N=0;return window.addEventListener("load",n),window.addEventListener("resize",n),{setData:h,desire:u,align:r,insertInto:o}}},function(e,t){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function n(e,t){var n=t.length,i=e(t);if(isNaN(i))throw new Error("The gradient at ["+t.join(" ")+"] is NaN!");for(var o=Math.max,a=Math.abs,u=Math.min,s=[].concat(r(t)),c=Array(n),f=0;n>f;f++)for(var l=o(1e-6*i,1e-8),h=0;;h++){if(20==h)throw new Error("Gradient failed at index "+f+" of ["+t.join(" ")+"]");s[f]=t[f]+l;var d=e(s);s[f]=t[f]-l;var y=e(s);if(s[f]=t[f],!isNaN(d)&&!isNaN(y)){c[f]=(d-y)/(2*l);var p=t[f]-l,v=t[f],m=t[f]+l,b=(d-i)/l,x=(i-y)/l,g=u(o(a(b-c[f]),a(x-c[f]),a(b-x)),l),w=o(a(c[f]),a(d),a(i),a(y),a(p),a(v),a(m),1e-8);if(.001>g/w)break}l/=16}return c}function i(e){return Math.sqrt(e.reduce(function(e,t){return e+t*t},0))}function o(e){return Array.from(Array(e),function(t,r){return Array.from(Array(e),function(e,t){return+(r==t)})})}function a(e){return e.map(function(e){return-e})}function u(e,t){return Array.isArray(e[0])?e.map(function(e){return u(e,t)}):e.reduce(function(e,r,n){return e+r*t[n]},0)}function s(e,t){return Array.isArray(e[0])?e.map(function(e,r){return s(e,t[r])}):e.map(function(e,r){return e-t[r]})}function c(e,t){return Array.isArray(e[0])?e.map(function(e,r){return c(e,t[r])}):e.map(function(e,r){return e+t[r]})}function f(e,t){return e.map(function(e){return e.map(function(e){return e/t})})}function l(e,t){return Array.isArray(e[0])?e.map(function(e){return l(e,t)}):e.map(function(e){return e*t})}function h(e,t){return e.map(function(e,r){return l(t,e)})}function d(e,t){var d=arguments.length<=2||void 0===arguments[2]?1e-8:arguments[2],y=arguments.length<=3||void 0===arguments[3]?1e3:arguments[3];d=Math.max(d,2e-16),t=[].concat(r(t));var p=t.length,v=e(t);if(isNaN(v))throw new Error("minimize: f(x0) is a NaN!");for(var m=function(t){return n(e,t)},b=o(p),x=m(t),g=0;y>g;g++){if(!x.every(isFinite)){var w="Gradient has Infinity or NaN";break}var O=a(u(b,x));if(!O.every(isFinite)){var w="Search direction has Infinity or NaN";break}var j=i(O);if(d>j){var w="Newton step smaller than tol";break}for(var k,A=1,N=u(x,O),P=t;y>g&&A*j>=d;g++){k=l(O,A),P=c(t,k);var E=e(P);if(!(E-v>=.1*A*N||isNaN(E)))break;A*=.5}if(d>A*j){var w="Line search step size smaller than tol";break}if(g===y){var w="maxit reached during line search";break}var _=m(P),M=s(_,x),C=u(M,k),S=u(b,M);b=s(c(b,l(h(k,k),(C+u(M,S))/(C*C))),f(c(h(S,k),h(k,S)),C)),t=P,v=E,x=_}return{solution:t,f:v,gradient:x,invHessian:b,iterations:g,message:w}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=d},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t,r){t=(0,u.clamp)(t,e.xmin,e.xmax),r=(0,u.clamp)(r,e.ymin,e.ymax);var n=e.x-t,i=e.y-r;return n*n+i*i}Object.defineProperty(t,"__esModule",{value:!0}),t.renderer=t.shortcut=t.options=t.base=t.type=void 0;var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};t.cost=i;var u=r(1);t.type="circle",t.base=a({type:"circle"},u.defaultBounds),t.options=["x","y","xmin","xmax","ymin","ymax","cares"],t.shortcut=["x","y"],t.renderer=function(){function e(t,r,i){n(this,e),this.el=document.createElementNS("http://www.w3.org/2000/svg","circle"),(0,u.setAttributes)(this.el,{r:5,fill:"#000"}),r.appendChild(this.el),(0,u.makeDraggable)(this.el,this.getPos.bind(this),function(e,r){return i(t,e,r)})}return o(e,[{key:"remove",value:function(){this.el.parentNode.removeChild(this.el),delete this.el}},{key:"getPos",value:function(){return[this.renderable.x,this.renderable.y]}},{key:"setOffset",value:function(e,t){this.topOffset=e,this.leftOffset=t}},{key:"render",value:function(e){this.renderable=e,(0,u.setAttributes)(this.el,e.attributes),(0,u.setAttributes)(this.el,{cx:(0,u.clamp)(e.x,e.xmin,e.xmax),cy:(0,u.clamp)(e.y,e.ymin,e.ymax)})}}]),e}()},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t,r){t=(0,u.clamp)(t,e.xmin,e.xmax),r=(0,u.clamp)(r,e.ymin,e.ymax);var n=e.x-t,i=e.y-r;return n*n+i*i}Object.defineProperty(t,"__esModule",{value:!0}),t.renderer=t.shortcut=t.options=t.base=t.type=void 0;var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};t.cost=i;var u=r(1);t.type="image",t.base=a({type:"image"},u.defaultBounds),t.options=["href","x","y","width","height","xmin","xmax","ymin","ymax","cares"],t.shortcut=["href","x","y","width","height"],t.renderer=function(){function e(t,r,i){n(this,e),this.el=document.createElementNS("http://www.w3.org/2000/svg","image"),r.appendChild(this.el),(0,u.makeDraggable)(this.el,this.getPos.bind(this),function(e,r){return i(t,e,r)})}return o(e,[{key:"remove",value:function(){this.el.parentNode.removeChild(this.el),delete this.el}},{key:"getPos",value:function(){return[this.renderable.x,this.renderable.y]}},{key:"render",value:function(e){this.renderable=e,(0,u.setAttributes)(this.el,e.attributes),(0,u.setAttributes)(this.el,{href:c.href},"http://www.w3.org/1999/xlink"),(0,u.setAttributes)(this.el,{x:(0,u.clamp)(e.x-e.width/2,e.xmin,e.xmax),y:(0,u.clamp)(e.y-e.height/2,e.ymin,e.ymax),width:e.width,height:e.height})}}]),e}()},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t,r,n){var i=e.x1,o=e.y1,a=e.x2,u=e.y2,s=i+(a-i)*t-r,c=o+(u-o)*t-n;return s*s+c*c}Object.defineProperty(t,"__esModule",{value:!0}),t.renderer=t.base=t.shortcut=t.options=t.type=void 0;var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};t.cost=i;var u=r(1);t.type="line",t.options=["x1","y1","x2","y2","cares","xmin","xmax","ymin","ymax"],t.shortcut=["x1","y1","x2","y2"],t.base=a({type:"line"},u.defaultBounds),t.renderer=function(){function e(t,r,i){var o=this;n(this,e),this.el=document.createElementNS("http://www.w3.org/2000/svg","line"),(0,u.setAttributes)(this.el,{stroke:"#000"}),r.appendChild(this.el),(0,u.makeDraggable)(this.el,this.startDrag.bind(this),function(e,r){return i(t,o.r,e,r)})}return o(e,[{key:"remove",value:function(){this.el.parentNode.removeChild(this.el),delete this.el}},{key:"startDrag",value:function(e){var t=this.renderable,r=t.x1,n=t.y1,i=t.x2,o=t.y2,a=e.clientX,u=e.clientY,s=a-this.leftOffset,c=u-this.topOffset,f=i-r,l=o-n,h=s-r,d=c-n;return this.r=Math.sqrt(h*h+d*d)/Math.sqrt(f*f+l*l),[s,c]}},{key:"setOffset",value:function(e,t){this.topOffset=e,this.leftOffset=t}},{key:"render",value:function(e){this.renderable=e;var t=e.x1,r=e.y1,n=e.x2,i=e.y2,o=e.xmin,a=e.xmax,s=e.ymin,c=e.ymax,f=e.attributes;(0,u.setAttributes)(this.el,f),(0,u.setAttributes)(this.el,{x1:(0,u.clamp)(t,o,a),y1:(0,u.clamp)(r,s,c),x2:(0,u.clamp)(n,o,a),y2:(0,u.clamp)(i,s,c)})}}]),e}()},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t,r,n,i){n=(0,u.clamp)(n,e.xmin,e.xmax),i=(0,u.clamp)(i,e.ymin,e.ymax);var o=e.x+e.width*t-n,a=e.y+e.height*r-i;return o*o+a*a}Object.defineProperty(t,"__esModule",{value:!0}),t.renderer=t.shortcut=t.options=t.base=t.type=void 0;var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};t.cost=i;var u=r(1);t.type="rect",t.base=a({type:"rect"},u.defaultBounds),t.options=["x","y","width","height","xmin","xmax","ymin","ymax","cares"],t.shortcut=["x","y","width","height"],t.renderer=function(){function e(t,r,i){var o=this;n(this,e),this.el=document.createElementNS("http://www.w3.org/2000/svg","rect"),(0,u.setAttributes)(this.el,{fill:"#000"}),r.appendChild(this.el),(0,u.makeDraggable)(this.el,this.startDrag.bind(this),function(e,r){return i(t,o.rx,o.ry,e,r)})}return o(e,[{key:"remove",value:function(){this.el.parentNode.removeChild(this.el),delete this.el}},{key:"startDrag",value:function(e){var t=e.clientX,r=e.clientY,n=t-this.leftOffset,i=r-this.topOffset;return this.rx=(n-this.renderable.x)/this.renderable.width,this.ry=(i-this.renderable.y)/this.renderable.height,[n,i]}},{key:"setOffset",value:function(e,t){this.topOffset=e,this.leftOffset=t}},{key:"render",value:function(e){this.renderable=e;var t=e.x,r=e.y,n=e.width,i=e.height;0>n&&(t+=n,n=-n),0>i&&(r+=i,i=-i),(0,u.setAttributes)(this.el,e.attributes),(0,u.setAttributes)(this.el,{x:(0,u.clamp)(t,e.xmin,e.xmax),y:(0,u.clamp)(r,e.ymin,e.ymax),width:n,height:i})}}]),e}()},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t,r){t=(0,u.clamp)(t,e.xmin,e.xmax),r=(0,u.clamp)(r,e.ymin,e.ymax);var n=e.x-t,i=e.y-r;return n*n+i*i}Object.defineProperty(t,"__esModule",{value:!0}),t.renderer=t.shortcut=t.options=t.base=t.type=void 0;var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};t.cost=i;var u=r(1);t.type="text",t.base=a({type:"text"},u.defaultBounds),t.options=["text","x","y","xmin","xmax","ymin","ymax","cares"],t.shortcut=["text","x","y"],t.renderer=function(){function e(t,r,i){n(this,e),this.el=document.createElementNS("http://www.w3.org/2000/svg","text"),r.appendChild(this.el),(0,u.makeDraggable)(this.el,this.getPos.bind(this),function(e,r){return i(t,e,r)})}return o(e,[{key:"remove",value:function(){this.el.parentNode.removeChild(this.el),delete this.el}},{key:"getPos",value:function(){return[this.renderable.x,this.renderable.y]}},{key:"setOffset",value:function(e,t){this.topOffset=e,this.leftOffset=t}},{key:"render",value:function(e){this.renderable=e,(0,u.setAttributes)(this.el,e.attributes),(0,u.setAttributes)(this.el,{x:(0,u.clamp)(e.x,e.xmin,e.xmax),y:(0,u.clamp)(e.y,e.ymin,e.ymax)}),this.el.innerHTML=e.text}}]),e}()}])});