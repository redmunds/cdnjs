!function(){function t(t){return t.replace(/^\s+/g,"")}function e(e,i,n,s){function h(){return this.pos=0,this.token="",this.current_mode="CONTENT",this.tags={parent:"parent1",parentcount:1,parent1:""},this.tag_type="",this.token_text=this.last_token=this.last_text=this.token_type="",this.newlines=0,this.indent_content=a,this.Utils={whitespace:"\n\r	 ".split(""),single_token:"br,input,link,meta,!doctype,basefont,base,area,hr,wbr,param,img,isindex,?xml,embed,?php,?,?=".split(","),extra_liners:"head,body,/html".split(","),in_array:function(t,e){for(var i=0;i<e.length;i++)if(t===e[i])return!0;return!1}},this.traverse_whitespace=function(){var t="";if(t=this.input.charAt(this.pos),this.Utils.in_array(t,this.Utils.whitespace)){for(this.newlines=0;this.Utils.in_array(t,this.Utils.whitespace);)c&&"\n"===t&&this.newlines<=g&&(this.newlines+=1),this.pos++,t=this.input.charAt(this.pos);return!0}return!1},this.get_content=function(){for(var t="",e=[],i=!1;"<"!==this.input.charAt(this.pos);){if(this.pos>=this.input.length)return e.length?e.join(""):["","TK_EOF"];if(this.traverse_whitespace())e.length&&(i=!0);else{if(d){var n=this.input.substr(this.pos,3);if("{{#"===n||"{{/"===n)break;if("{{"===this.input.substr(this.pos,2)&&"{{else}}"===this.get_tag(!0))break}t=this.input.charAt(this.pos),this.pos++,i&&(this.line_char_count>=this.wrap_line_length?(this.print_newline(!1,e),this.print_indentation(e)):(this.line_char_count++,e.push(" ")),i=!1),this.line_char_count++,e.push(t)}}return e.length?e.join(""):""},this.get_contents_to=function(t){if(this.pos===this.input.length)return["","TK_EOF"];var e="",i=new RegExp("</"+t+"\\s*>","igm");i.lastIndex=this.pos;var n=i.exec(this.input),s=n?n.index:this.input.length;return this.pos<s&&(e=this.input.substring(this.pos,s),this.pos=s),e},this.record_tag=function(t){this.tags[t+"count"]?(this.tags[t+"count"]++,this.tags[t+this.tags[t+"count"]]=this.indent_level):(this.tags[t+"count"]=1,this.tags[t+this.tags[t+"count"]]=this.indent_level),this.tags[t+this.tags[t+"count"]+"parent"]=this.tags.parent,this.tags.parent=t+this.tags[t+"count"]},this.retrieve_tag=function(t){if(this.tags[t+"count"]){for(var e=this.tags.parent;e&&t+this.tags[t+"count"]!==e;)e=this.tags[e+"parent"];e&&(this.indent_level=this.tags[t+this.tags[t+"count"]],this.tags.parent=this.tags[e+"parent"]),delete this.tags[t+this.tags[t+"count"]+"parent"],delete this.tags[t+this.tags[t+"count"]],1===this.tags[t+"count"]?delete this.tags[t+"count"]:this.tags[t+"count"]--}},this.indent_to_tag=function(t){if(this.tags[t+"count"]){for(var e=this.tags.parent;e&&t+this.tags[t+"count"]!==e;)e=this.tags[e+"parent"];e&&(this.indent_level=this.tags[t+this.tags[t+"count"]])}},this.get_tag=function(t){var e,i,n,s="",h=[],r="",a=!1,_=this.pos,o=this.line_char_count;t=void 0!==t?t:!1;do{if(this.pos>=this.input.length)return t&&(this.pos=_,this.line_char_count=o),h.length?h.join(""):["","TK_EOF"];if(s=this.input.charAt(this.pos),this.pos++,this.Utils.in_array(s,this.Utils.whitespace))a=!0;else{if("'"!==s&&'"'!==s||(s+=this.get_unformatted(s),a=!0),"="===s&&(a=!1),h.length&&"="!==h[h.length-1]&&">"!==s&&a&&(this.line_char_count>=this.wrap_line_length?(this.print_newline(!1,h),this.print_indentation(h)):(h.push(" "),this.line_char_count++),a=!1),d&&"<"===n&&s+this.input.charAt(this.pos)==="{{"&&(s+=this.get_unformatted("}}"),h.length&&" "!==h[h.length-1]&&"<"!==h[h.length-1]&&(s=" "+s),a=!0),"<"!==s||n||(e=this.pos-1,n="<"),d&&!n&&h.length>=2&&"{"===h[h.length-1]&&"{"==h[h.length-2]&&(e="#"===s||"/"===s?this.pos-3:this.pos-2,n="{"),this.line_char_count++,h.push(s),h[1]&&"!"===h[1]){h=[this.get_comment(e)];break}if(d&&"{"===n&&h.length>2&&"}"===h[h.length-2]&&"}"===h[h.length-1])break}}while(">"!==s);var u,p,c=h.join("");u=-1!==c.indexOf(" ")?c.indexOf(" "):"{"===c[0]?c.indexOf("}"):c.indexOf(">"),p="<"!==c[0]&&d?"#"===c[2]?3:2:1;var g=c.substring(p,u).toLowerCase();return"/"===c.charAt(c.length-2)||this.Utils.in_array(g,this.Utils.single_token)?t||(this.tag_type="SINGLE"):d&&"{"===c[0]&&"else"===g?t||(this.indent_to_tag("if"),this.tag_type="HANDLEBARS_ELSE",this.indent_content=!0,this.traverse_whitespace()):this.is_unformatted(g,l)?(r=this.get_unformatted("</"+g+">",c),h.push(r),e>0&&this.Utils.in_array(this.input.charAt(e-1),this.Utils.whitespace)&&h.splice(0,0,this.input.charAt(e-1)),i=this.pos-1,this.Utils.in_array(this.input.charAt(i+1),this.Utils.whitespace)&&h.push(this.input.charAt(i+1)),this.tag_type="SINGLE"):"script"===g&&(-1===c.search("type")||c.search("type")>-1&&c.search(/\b(text|application)\/(x-)?(javascript|ecmascript|jscript|livescript)/)>-1)?t||(this.record_tag(g),this.tag_type="SCRIPT"):"style"===g&&(-1===c.search("type")||c.search("type")>-1&&c.search("text/css")>-1)?t||(this.record_tag(g),this.tag_type="STYLE"):"!"===g.charAt(0)?t||(this.tag_type="SINGLE",this.traverse_whitespace()):t||("/"===g.charAt(0)?(this.retrieve_tag(g.substring(1)),this.tag_type="END",this.traverse_whitespace()):(this.record_tag(g),"html"!==g.toLowerCase()&&(this.indent_content=!0),this.tag_type="START",this.traverse_whitespace()),this.Utils.in_array(g,this.Utils.extra_liners)&&(this.print_newline(!1,this.output),this.output.length&&"\n"!==this.output[this.output.length-2]&&this.print_newline(!0,this.output))),t&&(this.pos=_,this.line_char_count=o),h.join("")},this.get_comment=function(t){var e="",i=">",n=!1;for(this.pos=t,input_char=this.input.charAt(this.pos),this.pos++;this.pos<=this.input.length&&(e+=input_char,e[e.length-1]!==i[i.length-1]||-1===e.indexOf(i));)!n&&e.length<10&&(0===e.indexOf("<![if")?(i="<![endif]>",n=!0):0===e.indexOf("<![cdata[")?(i="]]>",n=!0):0===e.indexOf("<![")?(i="]>",n=!0):0===e.indexOf("<!--")&&(i="-->",n=!0)),input_char=this.input.charAt(this.pos),this.pos++;return e},this.get_unformatted=function(t,e){if(e&&-1!==e.toLowerCase().indexOf(t))return"";var i="",n="",s=0,h=!0;do{if(this.pos>=this.input.length)return n;if(i=this.input.charAt(this.pos),this.pos++,this.Utils.in_array(i,this.Utils.whitespace)){if(!h){this.line_char_count--;continue}if("\n"===i||"\r"===i){n+="\n",this.line_char_count=0;continue}}n+=i,this.line_char_count++,h=!0,d&&"{"===i&&n.length&&"{"===n[n.length-2]&&(n+=this.get_unformatted("}}"),s=n.length)}while(-1===n.toLowerCase().indexOf(t,s));return n},this.get_token=function(){var t;if("TK_TAG_SCRIPT"===this.last_token||"TK_TAG_STYLE"===this.last_token){var e=this.last_token.substr(7);return t=this.get_contents_to(e),"string"!=typeof t?t:[t,"TK_"+e]}if("CONTENT"===this.current_mode)return t=this.get_content(),"string"!=typeof t?t:[t,"TK_CONTENT"];if("TAG"===this.current_mode){if(t=this.get_tag(),"string"!=typeof t)return t;var i="TK_TAG_"+this.tag_type;return[t,i]}},this.get_full_indent=function(t){return t=this.indent_level+t||0,1>t?"":Array(t+1).join(this.indent_string)},this.is_unformatted=function(t,e){if(!this.Utils.in_array(t,e))return!1;if("a"!==t.toLowerCase()||!this.Utils.in_array("a",e))return!0;var i=this.get_tag(!0),n=(i||"").match(/^\s*<\s*\/?([a-z]*)\s*[^>]*>\s*$/);return!(n&&!this.Utils.in_array(n,e))},this.printer=function(e,i,n,s,h){this.input=e||"",this.output=[],this.indent_character=i,this.indent_string="",this.indent_size=n,this.brace_style=h,this.indent_level=0,this.wrap_line_length=s,this.line_char_count=0;for(var r=0;r<this.indent_size;r++)this.indent_string+=this.indent_character;this.print_newline=function(t,e){this.line_char_count=0,e&&e.length&&(t||"\n"!==e[e.length-1])&&e.push("\n")},this.print_indentation=function(t){for(var e=0;e<this.indent_level;e++)t.push(this.indent_string),this.line_char_count+=this.indent_string.length},this.print_token=function(e){(e||""!==e)&&this.output.length&&"\n"===this.output[this.output.length-1]&&(this.print_indentation(this.output),e=t(e)),this.print_token_raw(e)},this.print_token_raw=function(t){t&&""!==t&&(t.length>1&&"\n"===t[t.length-1]?(this.output.push(t.slice(0,-1)),this.print_newline(!1,this.output)):this.output.push(t));for(var e=0;e<this.newlines;e++)this.print_newline(e>0,this.output);this.newlines=0},this.indent=function(){this.indent_level++},this.unindent=function(){this.indent_level>0&&this.indent_level--}},this}var r,a,_,o,u,p,l,c,g,d,f;for(i=i||{},void 0!==i.wrap_line_length&&0!==parseInt(i.wrap_line_length,10)||void 0===i.max_char||0===parseInt(i.max_char,10)||(i.wrap_line_length=i.max_char),a=void 0===i.indent_inner_html?!1:i.indent_inner_html,_=void 0===i.indent_size?4:parseInt(i.indent_size,10),o=void 0===i.indent_char?" ":i.indent_char,p=void 0===i.brace_style?"collapse":i.brace_style,u=0===parseInt(i.wrap_line_length,10)?32786:parseInt(i.wrap_line_length||250,10),l=i.unformatted||["a","span","bdo","em","strong","dfn","code","samp","kbd","var","cite","abbr","acronym","q","sub","sup","tt","i","b","big","small","u","s","strike","font","ins","del","pre","address","dt","h1","h2","h3","h4","h5","h6"],c=void 0===i.preserve_newlines?!0:i.preserve_newlines,g=c?isNaN(parseInt(i.max_preserve_newlines,10))?32786:parseInt(i.max_preserve_newlines,10):0,d=void 0===i.indent_handlebars?!1:i.indent_handlebars,f=void 0===i.end_with_newline?!1:i.end_with_newline,r=new h,r.printer(e,o,_,u,p);;){var w=r.get_token();if(r.token_text=w[0],r.token_type=w[1],"TK_EOF"===r.token_type)break;switch(r.token_type){case"TK_TAG_START":r.print_newline(!1,r.output),r.print_token(r.token_text),r.indent_content&&(r.indent(),r.indent_content=!1),r.current_mode="CONTENT";break;case"TK_TAG_STYLE":case"TK_TAG_SCRIPT":r.print_newline(!1,r.output),r.print_token(r.token_text),r.current_mode="CONTENT";break;case"TK_TAG_END":if("TK_CONTENT"===r.last_token&&""===r.last_text){var y=r.token_text.match(/\w+/)[0],T=null;r.output.length&&(T=r.output[r.output.length-1].match(/(?:<|{{#)\s*(\w+)/)),null!==T&&T[1]===y||r.print_newline(!1,r.output)}r.print_token(r.token_text),r.current_mode="CONTENT";break;case"TK_TAG_SINGLE":var v=r.token_text.match(/^\s*<([a-z-]+)/i);v&&r.Utils.in_array(v[1],l)||r.print_newline(!1,r.output),r.print_token(r.token_text),r.current_mode="CONTENT";break;case"TK_TAG_HANDLEBARS_ELSE":r.print_token(r.token_text),r.indent_content&&(r.indent(),r.indent_content=!1),r.current_mode="CONTENT";break;case"TK_CONTENT":r.print_token(r.token_text),r.current_mode="TAG";break;case"TK_STYLE":case"TK_SCRIPT":if(""!==r.token_text){r.print_newline(!1,r.output);var k,b=r.token_text,m=1;"TK_SCRIPT"===r.token_type?k="function"==typeof n&&n:"TK_STYLE"===r.token_type&&(k="function"==typeof s&&s),"keep"===i.indent_scripts?m=0:"separate"===i.indent_scripts&&(m=-r.indent_level);var x=r.get_full_indent(m);if(k)b=k(b.replace(/^\s*/,x),i);else{var A=b.match(/^\s*/)[0],E=A.match(/[^\n\r]*$/)[0].split(r.indent_string).length-1,N=r.get_full_indent(m-E);b=b.replace(/^\s*/,x).replace(/\r\n|\r|\n/g,"\n"+N).replace(/\s+$/,"")}b&&(r.print_token_raw(b),r.print_newline(!0,r.output))}r.current_mode="TAG";break;default:""!==r.token_text&&r.print_token(r.token_text)}r.last_token=r.token_type,r.last_text=r.token_text}var O=r.output.join("").replace(/[\r\n\t ]+$/,"");return f&&(O+="\n"),O}if("function"==typeof define&&define.amd)define(["require","./beautify","./beautify-css"],function(t){var i=t("./beautify"),n=t("./beautify-css");return{html_beautify:function(t,s){return e(t,s,i.js_beautify,n.css_beautify)}}});else if("undefined"!=typeof exports){var i=require("./beautify.js"),n=require("./beautify-css.js");exports.html_beautify=function(t,s){return e(t,s,i.js_beautify,n.css_beautify)}}else"undefined"!=typeof window?window.html_beautify=function(t,i){return e(t,i,window.js_beautify,window.css_beautify)}:"undefined"!=typeof global&&(global.html_beautify=function(t,i){return e(t,i,global.js_beautify,global.css_beautify)})}();
//# sourceMappingURL=beautify-html.min.js.map