!function(){function t(t){return t.replace(/^\s+|\s+$/g,"")}function i(t){return t.replace(/^\s+/g,"")}function n(n,e,s,h){function r(){return this.pos=0,this.token="",this.current_mode="CONTENT",this.tags={parent:"parent1",parentcount:1,parent1:""},this.tag_type="",this.token_text=this.last_token=this.last_text=this.token_type="",this.newlines=0,this.indent_content=!1,this.Utils={whitespace:"\n\r	 ".split(""),single_token:"br,input,link,meta,!doctype,basefont,base,area,hr,wbr,param,img,isindex,?xml,embed,?php,?,?=".split(","),extra_liners:"head,body,/html".split(","),in_array:function(t,i){for(var n=0;n<i.length;n++)if(t===i[n])return!0;return!1}},this.traverse_whitespace=function(){var t="";if(t=this.input.charAt(this.pos),this.Utils.in_array(t,this.Utils.whitespace)){for(this.newlines=0;this.Utils.in_array(t,this.Utils.whitespace);)c&&"\n"===t&&this.newlines<=g&&(this.newlines+=1),this.pos++,t=this.input.charAt(this.pos);return!0}return!1},this.get_content=function(){for(var t="",i=[],n=!1;"<"!==this.input.charAt(this.pos);){if(this.pos>=this.input.length)return i.length?i.join(""):["","TK_EOF"];this.traverse_whitespace()?i.length&&(n=!0):(t=this.input.charAt(this.pos),this.pos++,n&&(this.line_char_count>=this.wrap_line_length?(this.print_newline(!1,i),this.print_indentation(i)):(this.line_char_count++,i.push(" ")),n=!1),this.line_char_count++,i.push(t))}return i.length?i.join(""):""},this.get_contents_to=function(t){if(this.pos===this.input.length)return["","TK_EOF"];var i="",n=new RegExp("</"+t+"\\s*>","igm");n.lastIndex=this.pos;var e=n.exec(this.input),s=e?e.index:this.input.length;return this.pos<s&&(i=this.input.substring(this.pos,s),this.pos=s),i},this.record_tag=function(t){this.tags[t+"count"]?(this.tags[t+"count"]++,this.tags[t+this.tags[t+"count"]]=this.indent_level):(this.tags[t+"count"]=1,this.tags[t+this.tags[t+"count"]]=this.indent_level),this.tags[t+this.tags[t+"count"]+"parent"]=this.tags.parent,this.tags.parent=t+this.tags[t+"count"]},this.retrieve_tag=function(t){if(this.tags[t+"count"]){for(var i=this.tags.parent;i&&t+this.tags[t+"count"]!==i;)i=this.tags[i+"parent"];i&&(this.indent_level=this.tags[t+this.tags[t+"count"]],this.tags.parent=this.tags[i+"parent"]),delete this.tags[t+this.tags[t+"count"]+"parent"],delete this.tags[t+this.tags[t+"count"]],1===this.tags[t+"count"]?delete this.tags[t+"count"]:this.tags[t+"count"]--}},this.get_tag=function(t){var i,n,e="",s=[],h="",r=!1,a=this.pos,o=this.line_char_count;t=void 0!==t?t:!1;do{if(this.pos>=this.input.length)return t&&(this.pos=a,this.line_char_count=o),s.length?s.join(""):["","TK_EOF"];if(e=this.input.charAt(this.pos),this.pos++,this.Utils.in_array(e,this.Utils.whitespace))r=!0;else if("'"!==e&&'"'!==e||(e+=this.get_unformatted(e),r=!0),"="===e&&(r=!1),s.length&&"="!==s[s.length-1]&&">"!==e&&r&&(this.line_char_count>=this.wrap_line_length?(this.print_newline(!1,s),this.print_indentation(s)):(s.push(" "),this.line_char_count++),r=!1),"<"!==e||i||(i=this.pos-1),this.line_char_count++,s.push(e),s[1]&&"!"===s[1]){s=[this.get_comment(i)];break}}while(">"!==e);var _,u=s.join("");_=-1!==u.indexOf(" ")?u.indexOf(" "):u.indexOf(">");var p=u.substring(1,_).toLowerCase();return"/"===u.charAt(u.length-2)||this.Utils.in_array(p,this.Utils.single_token)?t||(this.tag_type="SINGLE"):"script"===p?t||(this.record_tag(p),this.tag_type="SCRIPT"):"style"===p?t||(this.record_tag(p),this.tag_type="STYLE"):this.is_unformatted(p,l)?(h=this.get_unformatted("</"+p+">",u),s.push(h),i>0&&this.Utils.in_array(this.input.charAt(i-1),this.Utils.whitespace)&&s.splice(0,0,this.input.charAt(i-1)),n=this.pos-1,this.Utils.in_array(this.input.charAt(n+1),this.Utils.whitespace)&&s.push(this.input.charAt(n+1)),this.tag_type="SINGLE"):"!"===p.charAt(0)?t||(this.tag_type="SINGLE",this.traverse_whitespace()):t||("/"===p.charAt(0)?(this.retrieve_tag(p.substring(1)),this.tag_type="END",this.traverse_whitespace()):(this.record_tag(p),"html"!==p.toLowerCase()&&(this.indent_content=!0),this.tag_type="START",this.traverse_whitespace()),this.Utils.in_array(p,this.Utils.extra_liners)&&(this.print_newline(!1,this.output),this.output.length&&"\n"!==this.output[this.output.length-2]&&this.print_newline(!0,this.output))),t&&(this.pos=a,this.line_char_count=o),s.join("")},this.get_comment=function(t){var i="",n=">",e=!1;for(this.pos=t,input_char=this.input.charAt(this.pos),this.pos++;this.pos<=this.input.length&&(i+=input_char,i[i.length-1]!==n[n.length-1]||-1===i.indexOf(n));)!e&&i.length<10&&(0===i.indexOf("<![if")?(n="<![endif]>",e=!0):0===i.indexOf("<![cdata[")?(n="]]>",e=!0):0===i.indexOf("<![")?(n="]>",e=!0):0===i.indexOf("<!--")&&(n="-->",e=!0)),input_char=this.input.charAt(this.pos),this.pos++;return i},this.get_unformatted=function(t,i){if(i&&-1!==i.toLowerCase().indexOf(t))return"";var n="",e="",s=!0;do{if(this.pos>=this.input.length)return e;if(n=this.input.charAt(this.pos),this.pos++,this.Utils.in_array(n,this.Utils.whitespace)){if(!s){this.line_char_count--;continue}if("\n"===n||"\r"===n){e+="\n",this.line_char_count=0;continue}}e+=n,this.line_char_count++,s=!0}while(-1===e.toLowerCase().indexOf(t));return e},this.get_token=function(){var t;if("TK_TAG_SCRIPT"===this.last_token||"TK_TAG_STYLE"===this.last_token){var i=this.last_token.substr(7);return t=this.get_contents_to(i),"string"!=typeof t?t:[t,"TK_"+i]}if("CONTENT"===this.current_mode)return t=this.get_content(),"string"!=typeof t?t:[t,"TK_CONTENT"];if("TAG"===this.current_mode){if(t=this.get_tag(),"string"!=typeof t)return t;var n="TK_TAG_"+this.tag_type;return[t,n]}},this.get_full_indent=function(t){return t=this.indent_level+t||0,1>t?"":Array(t+1).join(this.indent_string)},this.is_unformatted=function(t,i){if(!this.Utils.in_array(t,i))return!1;if("a"!==t.toLowerCase()||!this.Utils.in_array("a",i))return!0;var n=this.get_tag(!0),e=(n||"").match(/^\s*<\s*\/?([a-z]*)\s*[^>]*>\s*$/);return!(e&&!this.Utils.in_array(e,i))},this.printer=function(t,n,e,s,h){this.input=t||"",this.output=[],this.indent_character=n,this.indent_string="",this.indent_size=e,this.brace_style=h,this.indent_level=0,this.wrap_line_length=s,this.line_char_count=0;for(var r=0;r<this.indent_size;r++)this.indent_string+=this.indent_character;this.print_newline=function(t,i){this.line_char_count=0,i&&i.length&&(t||"\n"!==i[i.length-1])&&i.push("\n")},this.print_indentation=function(t){for(var i=0;i<this.indent_level;i++)t.push(this.indent_string),this.line_char_count+=this.indent_string.length},this.print_token=function(t){(t||""!==t)&&this.output.length&&"\n"===this.output[this.output.length-1]&&(this.print_indentation(this.output),t=i(t)),this.print_token_raw(t)},this.print_token_raw=function(t){t&&""!==t&&(t.length>1&&"\n"===t[t.length-1]?(this.output.push(t.slice(0,-1)),this.print_newline(!1,this.output)):this.output.push(t));for(var i=0;i<this.newlines;i++)this.print_newline(i>0,this.output);this.newlines=0},this.indent=function(){this.indent_level++},this.unindent=function(){this.indent_level>0&&this.indent_level--}},this}var a,o,_,u,p,l,c,g;for(e=e||{},void 0==e.wrap_line_length&&void 0!=e.max_char&&(e.wrap_line_length=e.max_char),o=parseInt(e.indent_size||4),_=e.indent_char||" ",p=e.brace_style||"collapse",u=0===e.wrap_line_length?32786:parseInt(e.wrap_line_length||250),l=e.unformatted||["a","span","bdo","em","strong","dfn","code","samp","kbd","var","cite","abbr","acronym","q","sub","sup","tt","i","b","big","small","u","s","strike","font","ins","del","pre","address","dt","h1","h2","h3","h4","h5","h6"],c=e.preserve_newlines||!0,g=c?parseInt(e.max_preserve_newlines||32786):0,a=new r,a.printer(n,_,o,u,p);;){var f=a.get_token();if(a.token_text=f[0],a.token_type=f[1],"TK_EOF"===a.token_type)break;switch(a.token_type){case"TK_TAG_START":a.print_newline(!1,a.output),a.print_token(a.token_text),a.indent_content&&(a.indent(),a.indent_content=!1),a.current_mode="CONTENT";break;case"TK_TAG_STYLE":case"TK_TAG_SCRIPT":a.print_newline(!1,a.output),a.print_token(a.token_text),a.current_mode="CONTENT";break;case"TK_TAG_END":if("TK_CONTENT"===a.last_token&&""===a.last_text){var d=a.token_text.match(/\w+/)[0],w=a.output[a.output.length-1].match(/<\s*(\w+)/);null!==w&&w[1]===d||a.print_newline(!1,a.output)}a.print_token(a.token_text),a.current_mode="CONTENT";break;case"TK_TAG_SINGLE":var T=a.token_text.match(/^\s*<([a-z]+)/i);T&&a.Utils.in_array(T[1],l)||a.print_newline(!1,a.output),a.print_token(a.token_text),a.current_mode="CONTENT";break;case"TK_CONTENT":a.print_token(a.token_text),a.current_mode="TAG";break;case"TK_STYLE":case"TK_SCRIPT":if(""!==a.token_text){a.print_newline(!1,a.output);var y,k=a.token_text,v=1;"TK_SCRIPT"===a.token_type?y="function"==typeof s&&s:"TK_STYLE"===a.token_type&&(y="function"==typeof h&&h),"keep"===e.indent_scripts?v=0:"separate"===e.indent_scripts&&(v=-a.indent_level);var b=a.get_full_indent(v);if(y)k=y(k.replace(/^\s*/,b),e);else{var m=k.match(/^\s*/)[0],x=m.match(/[^\n\r]*$/)[0].split(a.indent_string).length-1,A=a.get_full_indent(v-x);k=k.replace(/^\s*/,b).replace(/\r\n|\r|\n/g,"\n"+A).replace(/\s+$/,"")}k&&(a.print_token_raw(b+t(k)),a.print_newline(!1,a.output))}a.current_mode="TAG"}a.last_token=a.token_type,a.last_text=a.token_text}return a.output.join("")}if("function"==typeof define)define(function(t,i,e){var s=t("./beautify.js").js_beautify,h=t("./beautify-css.js").css_beautify;i.html_beautify=function(t,i){return n(t,i,s,h)}});else if("undefined"!=typeof exports){var e=require("./beautify.js").js_beautify,s=require("./beautify-css.js").css_beautify;exports.html_beautify=function(t,i){return n(t,i,e,s)}}else"undefined"!=typeof window?window.html_beautify=function(t,i){return n(t,i,window.js_beautify,window.css_beautify)}:"undefined"!=typeof global&&(global.html_beautify=function(t,i){return n(t,i,global.js_beautify,global.css_beautify)})}();
//# sourceMappingURL=beautify-html.min.js.map