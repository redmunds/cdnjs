var Plates="undefined"!=typeof process&&"undefined"!=typeof process.title?exports:{};!function(t){function e(t){t&&this.mappings.push({});var e=this.mappings[this.mappings.length-1];return e&&e.attribute&&e.value&&e.dataKey&&e.replace?e.re=new RegExp(e.attribute+"=(['\"]?)"+e.value+"\\1"):delete e&&e.re,e}var a=Object.prototype.toString,r=Array.isArray||function(t){return"[object Array]"===a.call(t)},n=function(){};n.prototype={nest:[],tag:new RegExp(["<","(/?)","([-:\\w]+)","((?:[-\\w]+(?:","=","(?:\\w+|[\"|'](?:.*)[\"|']))?)*)","(/?)",">"].join("\\s*")),attr:/([\-\w]*)=(?:["\']([\-\.\w\s\/:;&#]*)["\'])/gi,hasClass:function(t,e){return t.split(" ").indexOf(e)>-1},iterate:function(t,e,a,n,i){var l="",s=t.slice(t.search(a.input),t.lastIndexOf(n)+n.length+1),c={};if(r(e)){for(var u=0,h=e.length;u<h;u++)i?c[i]=e[u]:c=e[u],l+=this.bind(s,c);return l}return"object"==typeof e?(s=s.slice(a.input.length,-(n.length+3)),l+=this.bind(s,e)):e},bind:function(t,e,a){if(r(e)){for(var n="",i=0,l=e.length;i<l;i++)n+=this.bind(t,e[i],a);return n}t=t||"",e=e||{};for(var s,c,u,h,o,f,p=this,d=0,g=a&&a.mappings,v=!1,y="",b=!1,w=!1,P=!1,K=a&&a.conf&&a.conf.create,j="",i=0,l=t.length;i<l;i++)if(o=t[i],"!"===o&&v&&!P)v=!1,j+=t.slice(f,i+1);else if("<"!==o||v)if(">"===o&&v){if(v=!1,h=t.slice(f,i+1),s=this.tag.exec(h),!s){v=!0;continue}if(b=s[1],y=s[2],c=s[3],w=s[4],P&&(b?d<=0?P=!1:--d:w||++d),!b&&!P)if(g&&g.length>0)for(var x=g.length-1;x>=0;x--){var m=!1,A=g[x].re&&c.match(g[x].re);if(h=h.replace(this.attr,function(a,n,i,l){var c=g[x].dataKey?e[g[x].dataKey]:e[n];if(A&&g[x].replace!==n)return a;if(A||"undefined"!=typeof g[x].replacePartial1)return m=!0,"undefined"!=typeof g[x].replacePartial2?c=i.replace(g[x].replacePartial1,g[x].replacePartial2):"undefined"!=typeof g[x].replacePartial1&&g[x].dataKey&&(c=i.replace(g[x].replacePartial1,e[g[x].dataKey])),n+'="'+(c||"")+'"';if(!g[x].replace&&g[x].attribute===n&&(g[x].value===i||p.hasClass(i,g[x].value||g.conf.where===n)||"[object RegExp]"==={}.toString.call(g[x].value)&&null!==g[x].value.exec(i))){var u=e[g[x].dataKey];c=h+c,r(u)?(c=p.iterate(t,u,s,y,i),p.nest.push(y)):"object"==typeof u&&(c=h+p.iterate(t,u,s,y,i)),j+=c||"",P=!0}return a}),K&&A&&!m){var E=w?2:1,O=w?"/>":">",f=h.substr(0,h.length-E);" "==f[f.length-1]&&(f=f.substr(0,f.length-1),w&&(O=" "+O)),h=[f," ",g[x].replace,'="',e[g[x].dataKey],'"',O].join("")}}else h.replace(this.attr,function(n,i,l,c){if(i===a&&a.conf.where||e[l]){var u=e[l],o=r(u),f=o||"object"==typeof u?p.iterate(t,u,s,y,l):u;o&&p.nest.push(y),j+=o?f:h+f,P=!0}});P||0!==p.nest.length?!P&&p.nest.length&&this.nest.pop():j+=h}else v||P||(j+=o);else u=!0,v=!0,f=i;return j}};var i=function t(e){return this instanceof t?(this.mappings=[],void(this.conf=e||{})):new t(e)};i.prototype={replace:function(t,a){var r=e.call(this);return r.replacePartial1=t,r.replacePartial2=a,this},use:function(t){return e.call(this).dataKey=t,e.call(this)&&this},to:function(t){return this.use(t)},where:function(t){return e.call(this,!0).attribute=t,e.call(this)&&this},class:function(t){return this.where("class").is(t)},tag:function(t){return e.call(this,!0).tag=t,this},is:function(t){return e.call(this).value=t,e.call(this)&&this},has:function(t){return e.call(this).value=t,this.replace(t),e.call(this)&&this},insert:function(t){var a=e.call(this);return a.replace=a.attribute,a.dataKey=t,e.call(this)&&this},as:function(t){return e.call(this).replace=t,e.call(this)&&this}},t.bind=function(t,e,a){var r=new n;return r.bind(t,e,a)},t.Map=i}(Plates);
//# sourceMappingURL=plates.min.js.map