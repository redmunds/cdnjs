{"version":3,"sources":["../node_modules/es-module-loader/core/common.js","../node_modules/es-module-loader/core/resolve.js","../src/common.js","../node_modules/es-module-loader/core/loader-polyfill.js","../node_modules/es-module-loader/core/register-loader.js","../src/fetch.js","../src/resolve.js","../src/config.js","../src/format-helpers.js","../src/instantiate.js","../src/systemjs-loader.js","../src/system.js"],"names":["createSymbol","name","hasSymbol","Symbol","LoaderError__Check_error_message_for_loader_stack","childErr","newMessage","isBrowser","replace","isWindows","err","message","errArgs","fileName","Error","lineNumber","stack","originalErr","isNode","resolveUrlToParentIfNotPlain","relUrl","parentUrl","throwResolveError","RangeError","protocolIndex","indexOf","match","substr","parentProtocol","length","pathname","parentIsPlain","undefined","segmented","lastIndexOf","output","segmentIndex","i","pop","push","join","warn","msg","force","this","warnings","console","loadNodeModule","key","baseURL","parentModuleContext","Module","_nodeRequire","base","paths","_nodeModulePaths","require","extend","a","b","prepend","p","hasOwnProperty","extendMeta","val","Array","concat","workerImport","src","resolve","reject","importScripts","e","scriptLoad","crossOrigin","integrity","load","cleanup","error","global","System","curSystem","curRequire","script","removeEventListener","document","head","removeChild","isWorker","createElement","type","charset","async","addEventListener","appendChild","readMemberExpression","value","pParts","split","shift","getMapMatch","map","bestMatch","bestMatchLength","curMatchLength","inlineSourceMap","sourceMapString","hasBuffer","sourceMapPrefix","Buffer","toString","btoa","unescape","encodeURIComponent","getSource","source","sourceMap","address","wrap","lastLineIndex","TypeError","JSON","stringify","preExec","loader","callCounter","SystemJS","postExec","scriptExec","nonce","body","documentElement","text","onerror","window","_e","addToError","apply","arguments","setAttribute","evaluate","noWrap","supportsScriptExec","vm","useVm","runInThisContext","filename","eval","arrayValues","arr","values","iterator","iterable","keys","Object","keyIndex","next","done","Loader","baseKey","baseURI","registry","Registry","_registry","baseObject","defineProperty","BASE_OBJECT","getOwnPropertyNames","forEach","extendNamespace","enumerable","get","RegisterLoader","REGISTERED_LAST_ANON","REGISTER_REGISTRY","trace","loads","ensureResolution","resolvedKey","parentKey","metadata","parentMetadata","Promise","then","normalize","catch","createLoadRecord","registration","module","importerSetters","linkRecord","instantiatePromise","dependencies","execute","moduleObj","setters","depsInstantiatePromise","dependencyInstantiations","linked","resolveInstantiate","registerRegistry","instantiate","parentLoad","createMetadata","call","link","registered","createProcessAnonRegister","registeredLastAnon","instantiation","traceLoad","default","__useDefault","registerDeclarative","resolveInstantiateDep","traceDepMap","deps","depMap","copyNamedExports","exports","props","defineOrCopyProperty","targetObj","sourceObj","propName","d","getOwnPropertyDescriptor","declare","locked","declared","ContextualLoader","instantiateDeps","seen","depsInstantiatePromises","all","setter","deepDepsInstantiatePromises","depLoad","depLink","clearLoadErrors","index","setterIndex","splice","dynamicExecuteCompat","executingRequire","id","ensureEvaluate","doEvaluate","makeDynamicRequire","nsEvaluate","doExecute","nullContext","set","context","args","ns","fetchFetch","url","authorization","asBuffer","hasXhr","xhrFetch","opts","headers","Accept","credentials","fetch","res","ok","arrayBuffer","status","statusText","xhr","response","responseText","XMLHttpRequest","responseType","onreadystatechange","readyState","open","setRequestHeader","withCredentials","send","nodeFetch","fs","readFile","data","dataString","noFetch","applyPaths","wildcard","pathMatch","outPath","getParentMetadata","config","CREATE_METADATA","parentPluginIndex","pluginFirst","pluginArgument","pluginKey","packageKey","getPackage","packageConfig","packages","CONFIG","booleanConditional","pluginResolve","normalized","interpolateConditional","setMeta","decanonicalize","parsed","parsePlugin","plugin","combinePluginParts","coreResolve","argument","normalizeSync","packageResolveSync","normalizePaths","path","pathsLocked","doMap","relativeResolved","mapMatch","has","packageResolve","skipExtensions","parentMap","parentMapMatch","mapped","doMapSync","pkgConfigMatch","getPackageConfigMatch","packageConfigKeys","createPackage","subPath","applyPackageConfigSync","createMeta","format","loadConfig","configured","loadPackageConfigPath","configPath","applyPackageConfig","extension","globals","encapsulateGlobal","cjsRequireDetection","cjsDeferDepsExecute","wildcardIndex","bestDepth","meta","depth","getMetaMatches","metaPattern","matchMeta","matchDepth","argumentKey","pluginIndex","curPkg","pkgLen","curPkgLen","addDefaultExtension","pkg","pkgKey","defaultExtension","metaMatch","main","mapPath","validMapping","conditionPromises","conditions","c","parseCondition","condition","import","conditionValues","prop","negate","createPkgConfigPathObj","lastWildcard","Math","max","regEx","RegExp","exactMatch","packageConfigPaths","packageConfigPath","pkgConfigPath","configLoader","pluginLoader","pkgConfig","setPkgConfig","pkgMeta","matchFn","dotRel","exactMeta","conditionExport","conditionModule","negation","conditionExportIndex","sysConditions","serializeCondition","conditionObj","resolveCondition","bool","m","conditionalMatch","interpolationRegEx","conditionValue","booleanIndex","envSet","cfg","envCallback","envConfigNames","envConfig","envModule","cloneObj","obj","maxDepth","clone","getConfigItem","cfgItem","getConfig","configName","configNames","configItem","setConfig","isEnvConfig","wasm","setProduction","production","build","pathsExtended","defaultJSExtensions","v","pkgName","packageLength","bundles","bundle","depCache","resolved","transpiler","prependConfig","formatHelpers","names","callback","errback","referer","prototype","dynamicRequires","modules","define","factory","req","depValues","uri","moduleIndex","exportsIndex","requireIndex","contextualRequire","toUrl","curMetaDeps","amdGetCJSDeps","registerDynamic","lastNamedDefine","multipleNamedDefines","newModule","requireResolve","bind","getPathVars","prepareGlobal","amd","amdDefine","amdRequire","stripOrigin","windowOrigin","request","parentId","moduleId","dirname","getCJSDeps","inLocation","locations","cjsRequireRegEx","lastIndex","commentRegEx","stringRegEx","stringLocations","commentLocations","exec","dep","globalIterator","globalName","ignoredGlobalProps","getGlobalValue","globalValue","moduleName","encapsulate","curDefine","oldGlobals","g","globalSnapshot","singleGlobal","multipleExports","params","fnBracketRegEx","requireAlias","wsRegEx","requireRegEx","requireRegExs","cjsRequirePre","cjsRequirePost","clearLastDefine","metaDeps","registerLastDefine","processAnonRegister","loadBundlesAndDepCache","supportsScriptLoad","initializePlugin","pluginModule","runPluginLoad","runFetchPipeline","pluginLoad","protectedCreateNamespace","bindings","ModuleNamespace","registerKey","pluginResult","emptyModule","matched","curModule","parts","substring","locate","fetched","translateAndInstantiate","bytes","Uint8Array","WebAssembly","compile","wasmModule","Instance","stringSource","TextDecoder","decode","readMetaSyntax","translate","traceOpts","translated","sanitizeSourceMap","detectRegisterFormat","esmRegEx","transpile","calledInstantiate","result","detectLegacyFormat","parse","pathVars","__cjsWrapper","cjsWrapper","hashBangRegEx","gl","exportName","retrieveGlobal","leadingCommentAndMeta","leadingCommentAndMetaRegEx","amdRegEx","cjsExportsRegEx","originalName","file","sources","depsPrefix","setMetaProperty","target","curPart","metaRegEx","metaParts","metaPartRegEx","len","firstChar","metaString","metaName","metaValue","SystemJSLoader","_loader","loadedBundles","scriptSrc","nodeRequire","isProduction","isBuilder","browser","node","dev","process","versions","platform","envGlobal","self","getElementsByTagName","bases","href","location","cwd","scripts","curScript","currentScript","defer","__filename","navigator","userAgent","chrome","constructor","parent","RESOLVE_INSTANTIATE","RESOLVE","iteratorSupport","entries","namespace","delete","create","toStringTag","processRegisterContext","processRegister","instantiated","register","contextKey","freeze","fetchFunction","fetch$1","protocol","hostname","port","INSTANTIATE","hasProxy","Proxy","option","version"],"mappings":"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","sourcesContent":["/*\n * Environment\n */\nexport var isBrowser = typeof window !== 'undefined' && typeof document !== 'undefined';\nexport var isNode = typeof process !== 'undefined' && process.versions && process.versions.node;\nexport var isWindows = typeof process !== 'undefined' && typeof process.platform === 'string' && process.platform.match(/^win/);\n\nvar envGlobal = typeof self !== 'undefined' ? self : global;\nexport { envGlobal as global }\n\n/*\n * Simple Symbol() shim\n */\nvar hasSymbol = typeof Symbol !== 'undefined';\nexport function createSymbol (name) {\n  return hasSymbol ? Symbol() : '@@' + name;\n}\n\nexport function pathToFileUrl (filePath) {\n  return 'file://' + (isWindows ? '/' : '') + filePath;\n}\n\nexport function fileUrlToPath (fileUrl) {\n  if (fileUrl.substr(0, 7) !== 'file://')\n    throw new RangeError(fileUrl + ' is not a valid file url');\n  if (isWindows)\n    return fileUrl.substr(8).replace(/\\//g, '/');\n  else\n    return fileUrl.substr(7);\n}\n\n/*\n * Environment baseURI\n */\nexport var baseURI;\n\n// environent baseURI detection\nif (typeof document != 'undefined' && document.getElementsByTagName) {\n  baseURI = document.baseURI;\n\n  if (!baseURI) {\n    var bases = document.getElementsByTagName('base');\n    baseURI = bases[0] && bases[0].href || window.location.href;\n  }\n}\nelse if (typeof location != 'undefined') {\n  baseURI = location.href;\n}\n\n// sanitize out the hash and querystring\nif (baseURI) {\n  baseURI = baseURI.split('#')[0].split('?')[0];\n  baseURI = baseURI.substr(0, baseURI.lastIndexOf('/') + 1);\n}\nelse if (typeof process != 'undefined' && process.cwd) {\n  baseURI = 'file://' + (isWindows ? '/' : '') + process.cwd();\n  if (isWindows)\n    baseURI = baseURI.replace(/\\\\/g, '/');\n}\nelse {\n  throw new TypeError('No environment baseURI');\n}\n\n// ensure baseURI has trailing \"/\"\nif (baseURI[baseURI.length - 1] !== '/')\n  baseURI += '/';\n\n/*\n * LoaderError with chaining for loader stacks\n */\nvar errArgs = new Error(0, '_').fileName == '_';\nfunction LoaderError__Check_error_message_for_loader_stack (childErr, newMessage) {\n  // Convert file:/// URLs to paths in Node\n  if (!isBrowser)\n    newMessage = newMessage.replace(isWindows ? /file:\\/\\/\\//g : /file:\\/\\//g, '');\n\n  var message = (childErr.message || childErr) + '\\n  ' + newMessage;\n\n  var err;\n  if (errArgs && childErr.fileName)\n    err = new Error(message, childErr.fileName, childErr.lineNumber);\n  else\n    err = new Error(message);\n\n\n  var stack = childErr.originalErr ? childErr.originalErr.stack : childErr.stack;\n\n  if (isNode)\n    // node doesn't show the message otherwise\n    err.stack = message + '\\n  ' + stack;\n  else\n    err.stack = stack;\n\n  err.originalErr = childErr.originalErr || childErr;\n\n  return err;\n}\nexport { LoaderError__Check_error_message_for_loader_stack as addToError }\n","import { isNode } from './common.js';\n\n/*\n * Optimized URL normalization assuming a syntax-valid URL parent\n */\nexport function resolveUrlToParentIfNotPlain (relUrl, parentUrl) {\n\n  function throwResolveError () {\n    throw new RangeError('Unable to resolve \"' + relUrl + '\" to ' + parentUrl);\n  }\n\n  var protocolIndex = relUrl.indexOf(':');\n  if (protocolIndex !== -1) {\n    if (isNode) {\n      // Windows filepath compatibility (unique to SystemJS, not in URL spec at all)\n      // C:\\x becomes file:///c:/x (we don't support C|\\x)\n      if (relUrl[1] === ':' && relUrl[2] === '\\\\' && relUrl[0].match(/[a-z]/i) && parentUrl.substr(0, 5) === 'file:')\n        return 'file:///' + relUrl.replace(/\\\\/g, '/');\n    }\n    return relUrl;\n  }\n\n  var parentProtocol = parentUrl && parentUrl.substr(0, parentUrl.indexOf(':') + 1);\n\n  // protocol-relative\n  if (relUrl[0] === '/' && relUrl[1] === '/') {\n    if (!parentProtocol)\n      throwResolveError();\n    return parentProtocol + relUrl;\n  }\n  // relative-url\n  else if (relUrl[0] === '.' && (relUrl[1] === '/' || relUrl[1] === '.' && (relUrl[2] === '/' || relUrl.length === 2) || relUrl.length === 1)\n      || relUrl[0] === '/') {\n    var parentIsPlain = !parentProtocol || parentUrl[parentProtocol.length] !== '/';\n\n    // read pathname from parent if a URL\n    // pathname taken to be part after leading \"/\"\n    var pathname;\n    if (parentIsPlain) {\n      // resolving to a plain parent -> skip standard URL prefix, and treat entire parent as pathname\n      if (parentUrl === undefined)\n        throwResolveError();\n      pathname = parentUrl;\n    }\n    else if (parentUrl[parentProtocol.length + 1] === '/') {\n      // resolving to a :// so we need to read out the auth and host\n      if (parentProtocol !== 'file:') {\n        pathname = parentUrl.substr(parentProtocol.length + 2);\n        pathname = pathname.substr(pathname.indexOf('/') + 1);\n      }\n      else {\n        pathname = parentUrl.substr(8);\n      }\n    }\n    else {\n      // resolving to :/ so pathname is the /... part\n      pathname = parentUrl.substr(parentProtocol.length + 1);\n    }\n\n    if (relUrl[0] === '/') {\n      if (parentIsPlain)\n        throwResolveError();\n      else\n        return parentUrl.substr(0, parentUrl.length - pathname.length - 1) + relUrl;\n    }\n\n    // join together and split for removal of .. and . segments\n    // looping the string instead of anything fancy for perf reasons\n    // '../../../../../z' resolved to 'x/y' is just 'z' regardless of parentIsPlain\n    var segmented = pathname.substr(0, pathname.lastIndexOf('/') + 1) + relUrl;\n\n    var output = [];\n    var segmentIndex = undefined;\n\n    for (var i = 0; i < segmented.length; i++) {\n      // busy reading a segment - only terminate on '/'\n      if (segmentIndex !== undefined) {\n        if (segmented[i] === '/') {\n          output.push(segmented.substr(segmentIndex, i - segmentIndex + 1));\n          segmentIndex = undefined;\n        }\n        continue;\n      }\n\n      // new segment - check if it is relative\n      if (segmented[i] === '.') {\n        // ../ segment\n        if (segmented[i + 1] === '.' && (segmented[i + 2] === '/' || i === segmented.length - 2)) {\n          output.pop();\n          i += 2;\n        }\n        // ./ segment\n        else if (segmented[i + 1] === '/' || i === segmented.length - 1) {\n          i += 1;\n        }\n        else {\n          // the start of a new segment as below\n          segmentIndex = i;\n          continue;\n        }\n\n        // this is the plain URI backtracking error (../, package:x -> error)\n        if (parentIsPlain && output.length === 0)\n          throwResolveError();\n\n        // trailing . or .. segment\n        if (i === segmented.length)\n          output.push('');\n        continue;\n      }\n\n      // it is the start of a new segment\n      segmentIndex = i;\n    }\n    // finish reading out the last segment\n    if (segmentIndex !== undefined)\n      output.push(segmented.substr(segmentIndex, segmented.length - segmentIndex));\n\n    return parentUrl.substr(0, parentUrl.length - pathname.length) + output.join('');\n  }\n\n  // plain name -> return undefined\n}\n","import { resolveUrlToParentIfNotPlain } from 'es-module-loader/core/resolve.js';\nimport { baseURI, isBrowser, isWindows, addToError, global, createSymbol } from 'es-module-loader/core/common.js';\n\nexport { baseURI, isBrowser, isWindows, addToError, global, createSymbol, resolveUrlToParentIfNotPlain }\n\nexport var isWorker = typeof window == 'undefined' && typeof self != 'undefined' && typeof importScripts != 'undefined';\n\nexport var scriptSrc;\n\n// Promise detection and error message\nif (typeof Promise === 'undefined')\n  throw new Error('SystemJS requires a global Promise polyfill to be set before loading.');\n\nif (typeof document !== 'undefined') {\n  var scripts = document.getElementsByTagName('script');\n  var curScript = scripts[scripts.length - 1];\n  if (document.currentScript && (curScript.defer || curScript.async))\n    curScript = document.currentScript;\n\n  scriptSrc = curScript.src;\n}\n// worker\nelse if (typeof importScripts !== 'undefined') {\n  try {\n    throw new Error('_');\n  }\n  catch (e) {\n    e.stack.replace(/(?:at|@).*(http.+):[\\d]+:[\\d]+/, function(m, url) {\n      scriptSrc = url;\n    });\n  }\n}\n// node\nelse if (typeof __filename !== 'undefined') {\n  scriptSrc = __filename;\n}\n\n// include the node require since we're overriding it\nexport var nodeRequire;\nif (typeof require !== 'undefined' && typeof process !== 'undefined' && !process.browser)\n  nodeRequire = require;\n\nexport function warn (msg, force) {\n  if (force || this.warnings && typeof console !== 'undefined' && console.warn)\n    console.warn(msg);\n}\n\nvar parentModuleContext;\nexport function loadNodeModule (key, baseURL) {\n  if (key[0] === '.')\n    throw new Error('Node module ' + key + ' can\\'t be loaded as it is not a package require.');\n\n  if (!parentModuleContext) {\n    var Module = this._nodeRequire('module');\n    var base = baseURL.substr(isWindows ? 8 : 7);\n    parentModuleContext = new Module(base);\n    parentModuleContext.paths = Module._nodeModulePaths(base);\n  }\n  return parentModuleContext.require(key);\n}\n\nexport function extend (a, b, prepend) {\n  for (var p in b) {\n    if (!b.hasOwnProperty(p))\n      continue;\n    if (!prepend || a[p] === undefined)\n      a[p] = b[p];\n  }\n  return a;\n}\n\n// meta first-level extends where:\n// array + array appends\n// object + object extends\n// other properties replace\nexport function extendMeta (a, b, prepend) {\n  for (var p in b) {\n    if (!b.hasOwnProperty(p))\n      continue;\n    var val = b[p];\n    if (a[p] === undefined)\n      a[p] = val;\n    else if (val instanceof Array && a[p] instanceof Array)\n      a[p] = [].concat(prepend ? val : a[p]).concat(prepend ? a[p] : val);\n    else if (typeof val == 'object' && val !== null && typeof a[p] == 'object')\n      a[p] = extend(extend({}, a[p]), val, prepend);\n    else if (!prepend)\n      a[p] = val;\n  }\n}\n\nfunction workerImport (src, resolve, reject) {\n  try {\n    importScripts(src);\n  }\n  catch (e) {\n    reject(e);\n  }\n  resolve();\n}\n\nvar curSystem, curRequire;\n\nexport var supportsScriptLoad = (isBrowser || isWorker) && typeof navigator !== 'undefined' && navigator.userAgent && !navigator.userAgent.match(/MSIE (9|10).0/);\n\nexport function scriptLoad (src, crossOrigin, integrity, resolve, reject) {\n  // percent encode just \"#\" for HTTP requests\n  src = src.replace(/#/g, '%23');\n\n  // subresource integrity is not supported in web workers\n  if (isWorker)\n    return workerImport(src, resolve, reject);\n\n  // if scriptLoad\n  curSystem = global.System;\n  curRequire = global.require;\n\n  var script = document.createElement('script');\n  script.type = 'text/javascript';\n  script.charset = 'utf-8';\n  script.async = true;\n\n  if (crossOrigin)\n    script.crossOrigin = crossOrigin;\n  if (integrity)\n    script.integrity = integrity;\n\n  script.addEventListener('load', load, false);\n  script.addEventListener('error', error, false);\n\n  script.src = src;\n  document.head.appendChild(script);\n\n  function load () {\n    resolve();\n    cleanup();\n  }\n\n  // note this does not catch execution errors\n  function error (err) {\n    cleanup();\n    reject(new Error('Fetching ' + src));\n  }\n\n  function cleanup () {\n    global.System = curSystem;\n    global.require = curRequire;\n    script.removeEventListener('load', load, false);\n    script.removeEventListener('error', error, false);\n    document.head.removeChild(script);\n  }\n}\n\nexport function readMemberExpression (p, value) {\n  var pParts = p.split('.');\n  while (pParts.length)\n    value = value[pParts.shift()];\n  return value;\n}\n\nexport function getMapMatch (map, name) {\n  var bestMatch, bestMatchLength = 0;\n\n  for (var p in map) {\n    if (name.substr(0, p.length) === p && (name.length === p.length || name[p.length] === '/')) {\n      var curMatchLength = p.split('/').length;\n      if (curMatchLength <= bestMatchLength)\n        continue;\n      bestMatch = p;\n      bestMatchLength = curMatchLength;\n    }\n  }\n\n  return bestMatch;\n}\n\nvar hasBuffer = typeof Buffer !== 'undefined';\ntry {\n  if (hasBuffer && new Buffer('a').toString('base64') !== 'YQ==')\n    hasBuffer = false;\n}\ncatch (e) {\n  hasBuffer = false;\n}\n\nvar sourceMapPrefix = '\\n//# sourceMapping' + 'URL=data:application/json;base64,';\nfunction inlineSourceMap (sourceMapString) {\n  if (hasBuffer)\n    return sourceMapPrefix + new Buffer(sourceMapString).toString('base64');\n  else if (typeof btoa !== 'undefined')\n    return sourceMapPrefix + btoa(unescape(encodeURIComponent(sourceMapString)));\n  else\n    return '';\n}\n\nfunction getSource(source, sourceMap, address, wrap) {\n  var lastLineIndex = source.lastIndexOf('\\n');\n\n  if (sourceMap) {\n    if (typeof sourceMap != 'object')\n      throw new TypeError('load.metadata.sourceMap must be set to an object.');\n\n    sourceMap = JSON.stringify(sourceMap);\n  }\n\n  return (wrap ? '(function(System, SystemJS) {' : '') + source + (wrap ? '\\n})(System, System);' : '')\n      // adds the sourceURL comment if not already present\n      + (source.substr(lastLineIndex, 15) != '\\n//# sourceURL='\n        ? '\\n//# sourceURL=' + address + (sourceMap ? '!transpiled' : '') : '')\n      // add sourceMappingURL if load.metadata.sourceMap is set\n      + (sourceMap && inlineSourceMap(sourceMap) || '');\n}\n\nvar callCounter = 0;\nfunction preExec (loader) {\n  if (callCounter++ == 0)\n    curSystem = global.System;\n  global.System = global.SystemJS = loader;\n}\nfunction postExec () {\n  if (--callCounter == 0)\n    global.System = global.SystemJS = curSystem;\n}\n\nvar supportsScriptExec = false;\nif (isBrowser && typeof document != 'undefined' && document.getElementsByTagName) {\n  if (!(window.chrome && window.chrome.extension || navigator.userAgent.match(/^Node\\.js/)))\n    supportsScriptExec = true;\n}\n\n// script execution via injecting a script tag into the page\n// this allows CSP nonce to be set for CSP environments\nvar head;\nfunction scriptExec(loader, source, sourceMap, address, nonce) {\n  if (!head)\n    head = document.head || document.body || document.documentElement;\n\n  var script = document.createElement('script');\n  script.text = getSource(source, sourceMap, address, false);\n  var onerror = window.onerror;\n  var e;\n  window.onerror = function(_e) {\n    e = addToError(_e, 'Evaluating ' + address);\n    if (onerror)\n      onerror.apply(this, arguments);\n  }\n  preExec(loader);\n\n  if (nonce)\n    script.setAttribute('nonce', nonce);\n\n  head.appendChild(script);\n  head.removeChild(script);\n  postExec();\n  window.onerror = onerror;\n  if (e)\n    return e;\n}\n\nvar vm;\nvar useVm;\n\nexport function evaluate (loader, source, sourceMap, address, integrity, nonce, noWrap) {\n  if (!source)\n    return;\n  if (nonce && supportsScriptExec)\n    return scriptExec(loader, source, sourceMap, address, nonce);\n  try {\n    preExec(loader);\n    // global scoped eval for node (avoids require scope leak)\n    if (!vm && loader._nodeRequire) {\n      vm = loader._nodeRequire('vm');\n      useVm = vm.runInThisContext(\"typeof System !== 'undefined' && System\") === loader;\n    }\n    if (useVm)\n      vm.runInThisContext(getSource(source, sourceMap, address, !noWrap), { filename: address + (sourceMap ? '!transpiled' : '') });\n    else\n      (0, eval)(getSource(source, sourceMap, address, !noWrap));\n    postExec();\n  }\n  catch (e) {\n    postExec();\n    return e;\n  }\n}\n\n// RegEx adjusted from https://github.com/jbrantly/yabble/blob/master/lib/yabble.js#L339\nexport var cjsRequireRegEx = /(?:^\\uFEFF?|[^$_a-zA-Z\\xA0-\\uFFFF.\"'])require\\s*\\(\\s*(\"[^\"\\\\]*(?:\\\\.[^\"\\\\]*)*\"|'[^'\\\\]*(?:\\\\.[^'\\\\]*)*')\\s*\\)/g;\n","import { baseURI, addToError, createSymbol } from './common.js';\n\n// multiple exports of Module for backwards compat\n// only ModuleNamespace will remain in next break!\nexport { Loader, Module, Module as InternalModuleNamespace, Module as ModuleNamespace }\n\n/*\n * Simple Array values shim\n */\nfunction arrayValues (arr) {\n  if (arr.values)\n    return arr.values();\n\n  if (typeof Symbol === 'undefined' || !Symbol.iterator)\n    throw new Error('Cannot return values iterator unless Symbol.iterator is defined');\n\n  var iterable = {};\n  iterable[Symbol.iterator] = function () {\n    var keys = Object.keys(arr);\n    var keyIndex = 0;\n    return {\n      next: function () {\n        if (keyIndex < keys.length)\n          return {\n            value: arr[keys[keyIndex++]],\n            done: false\n          };\n        else\n          return {\n            value: undefined,\n            done: true\n          };\n      }\n    };\n  };\n  return iterable;\n}\n\n/*\n * 3. Reflect.Loader\n *\n * We skip the entire native internal pipeline, just providing the bare API\n */\n// 3.1.1\nfunction Loader (baseKey) {\n  this.key = baseKey || baseURI;\n  this.registry = new Registry();\n}\n// 3.3.1\nLoader.prototype.constructor = Loader;\n// 3.3.2\nLoader.prototype.import = Loader.prototype.load = function (key, parent) {\n  if (typeof key !== 'string')\n    throw new TypeError('Loader import method must be passed a module key string');\n  // custom resolveInstantiate combined hook for better perf\n  return Promise.resolve(this[RESOLVE_INSTANTIATE](key, parent || this.key))\n  //.then(Module.evaluate)\n  .catch(function (err) {\n    throw addToError(err, 'Loading ' + key + (parent ? ' from ' + parent : ''));\n  });\n};\n// 3.3.3\nvar RESOLVE = Loader.resolve = createSymbol('resolve');\n\n/*\n * Combined resolve / instantiate hook\n *\n * Not in current reduced spec, but necessary to separate RESOLVE from RESOLVE + INSTANTIATE as described\n * in the spec notes of this repo to ensure that loader.resolve doesn't instantiate when not wanted.\n *\n * We implement RESOLVE_INSTANTIATE as a single hook instead of a separate INSTANTIATE in order to avoid\n * the need for double registry lookups as a performance optimization.\n */\nvar RESOLVE_INSTANTIATE = Loader.resolveInstantiate = createSymbol('resolveInstantiate');\n\n// default resolveInstantiate is just to call resolve and then get from the registry\n// this provides compatibility for the resolveInstantiate optimization\nLoader.prototype[RESOLVE_INSTANTIATE] = function (key, parent) {\n  var loader = this;\n  return this.resolve(key, parent)\n  .then(function (resolved) {\n    var module = loader.registry.get(resolved);\n    if (!module)\n      throw new Error('Resolve did not define the \"' + resolved + '\" module into the registry.');\n    return module;\n  });\n};\n\nLoader.prototype[RESOLVE] = function () {\n  throw new TypeError('No loader resolve hook implementation provided.');\n};\n\nLoader.prototype.resolve = function (key, parent) {\n  var loader = this;\n  return Promise.resolve()\n  .then(function() {\n    return loader[RESOLVE](key, parent);\n  })\n  .then(function (resolvedKey) {\n    if (resolvedKey === undefined)\n      throw new RangeError('No resolution found.');\n    return resolvedKey;\n  })\n  .catch(function (err) {\n    throw addToError(err, 'Resolving ' + key + (parent ? ' to ' + parent : ''));\n  });\n};\n\n// 3.3.4 (import without evaluate)\n// this is not documented because the use of deferred evaluation as in Module.evaluate is not\n// documented, as it is not considered a stable feature to be encouraged\n// Loader.prototype.load may well be deprecated if this stays disabled\n/* Loader.prototype.load = function (key, parent) {\n  return Promise.resolve(this[RESOLVE_INSTANTIATE](key, parent || this.key))\n  .catch(function (err) {\n    throw addToError(err, 'Loading ' + key + (parent ? ' from ' + parent : ''));\n  });\n}; */\n\n/*\n * 4. Registry\n *\n * Instead of structuring through a Map, just use a dictionary object\n * We throw for construction attempts so this doesn't affect the public API\n *\n * Registry has been adjusted to use Namespace objects over ModuleStatus objects\n * as part of simplifying loader API implementation\n */\nvar iteratorSupport = typeof Symbol !== 'undefined' && Symbol.iterator;\nfunction Registry() {\n  this._registry = {};\n}\n// 4.4.1\nRegistry.prototype.constructor = function () {\n  throw new TypeError('Custom registries cannot be created.');\n};\n\nif (iteratorSupport) {\n  // 4.4.2\n  Registry.prototype[Symbol.iterator] = function () {\n    return this.entries()[Symbol.iterator]();\n  };\n\n  // 4.4.3\n  Registry.prototype.entries = function () {\n    var registry = this._registry;\n    return arrayValues(Object.keys(registry).map(function (key) {\n      return [key, registry[key]];\n    }));\n  };\n}\n\n// 4.4.4\nRegistry.prototype.keys = function () {\n  return arrayValues(Object.keys(this._registry));\n};\n// 4.4.5\nRegistry.prototype.values = function () {\n  var registry = this._registry;\n  return arrayValues(Object.keys(registry).map(function (key) {\n    return registry[key];\n  }));\n};\n// 4.4.6\nRegistry.prototype.get = function (key) {\n  return this._registry[key];\n};\n// 4.4.7\nRegistry.prototype.set = function (key, namespace) {\n  if (!(namespace instanceof Module))\n    throw new Error('Registry must be set with an instance of Module Namespace');\n  this._registry[key] = namespace;\n  return this;\n};\n// 4.4.8\nRegistry.prototype.has = function (key) {\n  return !!this._registry[key];\n};\n// 4.4.9\nRegistry.prototype.delete = function (key) {\n  if (this._registry[key]) {\n    //delete this._registry[key];\n    // much faster...\n    this._registry[key] = undefined;\n    return true;\n  }\n  return false;\n};\n\n/*\n * Simple ModuleNamespace Exotic object based on a baseObject\n * We export this for allowing a fast-path for module namespace creation over Module descriptors\n */\n// var EVALUATE = createSymbol('evaluate');\nvar BASE_OBJECT = createSymbol('baseObject');\n\n// 8.3.1 Reflect.Module\n/*\n * Best-effort simplified non-spec implementation based on\n * a baseObject referenced via getters.\n *\n * Allows:\n *\n *   loader.registry.set('x', new Module({ default: 'x' }));\n *\n * Optional evaluation function provides experimental Module.evaluate\n * support for non-executed modules in registry.\n */\nfunction Module (baseObject/*, evaluate*/) {\n  Object.defineProperty(this, BASE_OBJECT, {\n    value: baseObject\n  });\n\n  // evaluate defers namespace population\n  /* if (evaluate) {\n    Object.defineProperty(this, EVALUATE, {\n      value: evaluate,\n      configurable: true,\n      writable: true\n    });\n  }\n  else { */\n    Object.getOwnPropertyNames(baseObject).forEach(extendNamespace, this);\n  //}\n};\n// 8.4.2\nModule.prototype = Object.create(null);\n\nif (typeof Symbol !== 'undefined' && Symbol.toStringTag)\n  Module.prototype[Symbol.toStringTag] = 'Module';\n\n// NB remove the toString fallback here in next major\nelse\n  Object.defineProperty(Module.prototype, 'toString', {\n    value: function () {\n      return '[object Module]';\n    }\n  });\n\nfunction extendNamespace (key) {\n  Object.defineProperty(this, key, {\n    enumerable: true,\n    get: function () {\n      return this[BASE_OBJECT][key];\n    }\n  });\n}\n\n/* function doEvaluate (evaluate, context) {\n  try {\n    evaluate.call(context);\n  }\n  catch (e) {\n    return e;\n  }\n}\n\n// 8.4.1 Module.evaluate... not documented or used because this is potentially unstable\nModule.evaluate = function (ns) {\n  var evaluate = ns[EVALUATE];\n  if (evaluate) {\n    ns[EVALUATE] = undefined;\n    var err = doEvaluate(evaluate);\n    if (err) {\n      // cache the error\n      ns[EVALUATE] = function () {\n        throw err;\n      };\n      throw err;\n    }\n    Object.keys(ns[BASE_OBJECT]).forEach(extendNamespace, ns);\n  }\n  // make chainable\n  return ns;\n}; */\n","import { Loader, Module, } from './loader-polyfill.js';\nimport { resolveUrlToParentIfNotPlain } from './resolve.js';\nimport { addToError, global, createSymbol } from './common.js';\n\nexport default RegisterLoader;\n\n/*\n * Register Loader\n *\n * Builds directly on top of loader polyfill to provide:\n * - loader.register support\n * - hookable higher-level resolve with metadata argument\n * - instantiate hook with metadata arugment returning a ModuleNamespace or undefined for es module loading\n * - loader error behaviour as in HTML and loader specs, clearing failed modules from registration cache synchronously\n * - build tracing support by providing a .trace=true and .loads object format\n */\n\nvar REGISTER_REGISTRY = createSymbol('registerRegistry');\nvar REGISTERED_LAST_ANON = createSymbol('registeredLastAnon');\n\nfunction RegisterLoader (baseKey) {\n  Loader.apply(this, arguments);\n\n  // last anonymous System.register call\n  this[REGISTERED_LAST_ANON] = undefined;\n\n  // in-flight es module load records\n  this[REGISTER_REGISTRY] = {};\n\n  // tracing\n  this.trace = false;\n  // trace load objects when tracing\n  this.loads = {};\n}\n\nRegisterLoader.prototype = Object.create(Loader.prototype);\nRegisterLoader.prototype.constructor = RegisterLoader;\n\n// NB replace with createSymbol('normalize'), ... for next major\nRegisterLoader.normalize = RegisterLoader.resolve = 'normalize';\nRegisterLoader.instantiate = 'instantiate';\nRegisterLoader.createMetadata = 'createMetadata';\nRegisterLoader.processRegisterContext = 'processRegisterContext';\n\n// default normalize is the WhatWG style normalizer\nRegisterLoader.prototype.normalize = function (key, parentKey, metadata, parentMetadata) {\n  // normalization shortpath for already in registry\n  if (this[REGISTER_REGISTRY][key] || this.registry._registry[key])\n    return key;\n  return resolveUrlToParentIfNotPlain(key, parentKey);\n};\n\nRegisterLoader.prototype.instantiate = function (key, processRegister, metadata) {};\n\n// this function is an optimization to allow loader extensions to\n// implement it to set the metadata object shape upfront to ensure\n// it can run as a single hidden class throughout the normalize\n// and instantiate pipeline hooks in the js engine\nRegisterLoader.prototype.createMetadata = function () {\n  return {\n    registered: false\n  };\n};\n\nfunction ensureResolution (resolvedKey) {\n  if (resolvedKey === undefined)\n    throw new RangeError('No resolution found.');\n  return resolvedKey;\n}\n\nfunction resolve (loader, key, parentKey, metadata, parentMetadata) {\n  return Promise.resolve()\n  .then(function () {\n    return loader.normalize(key, parentKey, metadata, parentMetadata);\n  })\n  .then(ensureResolution)\n  .catch(function (err) {\n    throw addToError(err, 'Resolving dependency \"' + key + '\" to ' + parentKey);\n  });\n}\n\nRegisterLoader.prototype[Loader.resolve] = function (key, parentKey) {\n  var parentLoad = parentKey && this[REGISTER_REGISTRY][parentKey];\n  return resolve(this, key, parentKey, this.createMetadata(), parentLoad && parentLoad.metadata);\n};\n\n// once evaluated, the linkRecord is set to undefined leaving just the other load record properties\n// this allows tracking new binding listeners for es modules through importerSetters\n// for dynamic modules, the load record is removed entirely.\nfunction createLoadRecord (key, registration) {\n  return this[REGISTER_REGISTRY][key] = {\n    key: key,\n\n    // defined System.register cache\n    registration: registration,\n\n    // load record metadata\n    metadata: undefined,\n\n    // module namespace object\n    module: undefined,\n\n    // es-only\n    // this sticks around so new module loads can listen to binding changes\n    // for already-loaded modules by adding themselves to their importerSetters\n    importerSetters: undefined,\n\n    // in-flight linking record\n    linkRecord: {\n      // promise for instantiated\n      instantiatePromise: undefined,\n      dependencies: undefined,\n      execute: undefined,\n      // underlying module object bindings\n      moduleObj: undefined,\n\n      // es only, also indicates if es or not\n      setters: undefined,\n\n      // promise for instantiated dependencies (dependencyInstantiations populated)\n      depsInstantiatePromise: undefined,\n      // will be the array of dependency load record or a module namespace\n      dependencyInstantiations: undefined,\n\n      // indicates if the load and all its dependencies are instantiated and linked\n      // but not yet executed\n      // mostly just a performance shortpath to avoid rechecking the promises above\n      linked: false,\n\n      error: undefined\n      // NB optimization and way of ensuring module objects in setters\n      // indicates setters which should run pre-execution of that dependency\n      // setters is then just for completely executed module objects\n      // alternatively we just pass the partially filled module objects as\n      // arguments into the execute function\n      // hoisted: undefined\n    }\n  };\n}\n\nRegisterLoader.prototype[Loader.resolveInstantiate] = function (key, parentKey) {\n  var loader = this;\n  var registry = loader.registry._registry;\n  var registerRegistry = loader[REGISTER_REGISTRY];\n\n  return resolveInstantiate(loader, key, parentKey, registry, registerRegistry)\n  .then(function (instantiated) {\n    if (instantiated instanceof Module)\n      return instantiated;\n\n    // if already beaten to linked, return\n    if (instantiated.module)\n      return instantiated.module;\n\n    // resolveInstantiate always returns a load record with a link record and no module value\n    if (instantiated.linkRecord.linked)\n      return ensureEvaluate(loader, instantiated, instantiated.linkRecord, registry, registerRegistry, undefined);\n\n    return instantiateDeps(loader, instantiated, instantiated.linkRecord, registry, registerRegistry, [instantiated])\n    .then(function () {\n      return ensureEvaluate(loader, instantiated, instantiated.linkRecord, registry, registerRegistry, undefined);\n    })\n    .catch(function (err) {\n      clearLoadErrors(loader, instantiated);\n      throw err;\n    });\n  });\n};\n\nfunction resolveInstantiate (loader, key, parentKey, registry, registerRegistry) {\n  // normalization shortpath for already-normalized key\n  // could add a plain name filter, but doesn't yet seem necessary for perf\n  var module = registry[key];\n  if (module)\n    return Promise.resolve(module);\n\n  var load = registerRegistry[key];\n\n  // already linked but not in main registry is ignored\n  if (load && !load.module)\n    return instantiate(loader, load, load.linkRecord, registry, registerRegistry);\n\n  var parentLoad = registerRegistry[parentKey];\n  var metadata = loader.createMetadata();\n  return resolve(loader, key, parentKey, metadata, parentLoad && parentLoad.metadata)\n  .then(function (resolvedKey) {\n    // main loader registry always takes preference\n    module = registry[resolvedKey];\n    if (module)\n      return module;\n\n    load = registerRegistry[resolvedKey];\n\n    // already has a module value but not already in the registry (load.module)\n    // means it was removed by registry.delete, so we should\n    // disgard the current load record creating a new one over it\n    // but keep any existing registration\n    if (!load || load.module)\n      load = createLoadRecord.call(loader, resolvedKey, load && load.registration);\n\n    var link = load.linkRecord;\n    if (!link)\n      return load;\n\n    if (!load.metadata) {\n      load.metadata = metadata;\n      if (load.registration)\n        load.metadata.registered = true;\n    }\n\n    return instantiate(loader, load, link, registry, registerRegistry);\n  });\n}\n\nfunction createProcessAnonRegister (loader, load) {\n  return function () {\n    var registeredLastAnon = loader[REGISTERED_LAST_ANON];\n\n    if (!registeredLastAnon)\n      return;\n\n    loader[REGISTERED_LAST_ANON] = undefined;\n\n    load.registration = registeredLastAnon;\n    load.metadata.registered = true;\n  };\n}\n\nfunction instantiate (loader, load, link, registry, registerRegistry) {\n  return link.instantiatePromise || (link.instantiatePromise =\n  // if there is already an existing registration, skip running instantiate\n  (load.registration ? Promise.resolve() : Promise.resolve().then(function () {\n    return loader.instantiate(load.key, load.metadata, loader.instantiate.length > 2 && createProcessAnonRegister(loader, load));\n  }))\n  .then(function (instantiation) {\n    // direct module return from instantiate -> we're done\n    if (instantiation !== undefined) {\n      if (!(instantiation instanceof Module))\n        throw new TypeError('Instantiate did not return a valid Module object.');\n\n      registerRegistry[load.key] = undefined;\n      if (loader.trace)\n        traceLoad(loader, load, link);\n      return registry[load.key] = instantiation;\n    }\n\n    // run the cached loader.register declaration if there is one\n    var registration = load.registration;\n    // clear to allow new registrations for future loads (combined with registry delete)\n    load.registration = undefined;\n    if (!registration)\n      throw new TypeError('Module instantiation did not call an anonymous or correctly named System.register.');\n\n    link.dependencies = registration[0];\n\n    load.importerSetters = [];\n\n    link.moduleObj = {};\n\n    // process System.registerDynamic declaration\n    if (registration[2]) {\n      link.moduleObj.default = {};\n      link.moduleObj.__useDefault = true;\n      link.execute = registration[1];\n    }\n\n    // process System.register declaration\n    else {\n      registerDeclarative(loader, load, link, registration[1]);\n    }\n\n    // shortpath to instantiateDeps\n    if (!link.dependencies.length) {\n      link.linked = true;\n      if (loader.trace)\n        traceLoad(loader, load, link);\n    }\n\n    return load;\n  })\n  .catch(function (err) {\n    throw link.error = addToError(err, 'Instantiating ' + load.key);\n  }));\n}\n\n// like resolveInstantiate, but returning load records for linking\nfunction resolveInstantiateDep (loader, key, parentKey, parentMetadata, registry, registerRegistry, traceDepMap) {\n  // normalization shortpaths for already-normalized key\n  // DISABLED to prioritise consistent resolver calls\n  // could add a plain name filter, but doesn't yet seem necessary for perf\n  /* var load = registerRegistry[key];\n  var module = registry[key];\n\n  if (module) {\n    if (traceDepMap)\n      traceDepMap[key] = key;\n\n    // registry authority check in case module was deleted or replaced in main registry\n    if (load && load.module && load.module === module)\n      return load;\n    else\n      return module;\n  }\n\n  // already linked but not in main registry is ignored\n  if (load && !load.module) {\n    if (traceDepMap)\n      traceDepMap[key] = key;\n    return instantiate(loader, load, load.linkRecord, registry, registerRegistry);\n  } */\n  var metadata = loader.createMetadata();\n  return resolve(loader, key, parentKey, metadata, parentMetadata)\n  .then(function (resolvedKey) {\n    if (traceDepMap)\n      traceDepMap[key] = key;\n\n    // normalization shortpaths for already-normalized key\n    var load = registerRegistry[resolvedKey];\n    var module = registry[resolvedKey];\n\n    // main loader registry always takes preference\n    if (module && (!load || load.module && module !== load.module))\n      return module;\n\n    // already has a module value but not already in the registry (load.module)\n    // means it was removed by registry.delete, so we should\n    // disgard the current load record creating a new one over it\n    // but keep any existing registration\n    if (!load || !module && load.module)\n      load = createLoadRecord.call(loader, resolvedKey, load && load.registration);\n\n    var link = load.linkRecord;\n    if (!link)\n      return load;\n\n    load.metadata = load.metadata || metadata;\n    if (load.registration)\n      load.metadata.registered = true;\n\n    return instantiate(loader, load, link, registry, registerRegistry);\n  });\n}\n\nfunction traceLoad (loader, load, link) {\n  loader.loads[load.key] = {\n    key: load.key,\n    // we provide both deps and dependencies\n    // NB dependencies will be deprecated\n    dependencies: link.dependencies,\n    deps: link.dependencies,\n    depMap: link.depMap || {},\n    metadata: load.metadata\n  };\n}\n\n/*\n * Convert a CJS module.exports into a valid object for new Module:\n *\n *   new Module(getEsModule(module.exports))\n *\n * Sets the default value to the module, while also reading off named exports carefully.\n */\n\n// NB re-evaluate if this will even exist, and if it should be restricted to valid identifiers only\nfunction copyNamedExports (exports, moduleObj) {\n  if ((typeof exports === 'object' || typeof exports === 'function') && exports !== global) {\n    var props = Object.getOwnPropertyNames(exports);\n    for (var i = 0; i < props.length; i++)\n      defineOrCopyProperty(moduleObj, exports, props[i]);\n  }\n  moduleObj.default = exports;\n}\n\nfunction defineOrCopyProperty (targetObj, sourceObj, propName) {\n  // don't trigger getters/setters in environments that support them\n  try {\n    var d;\n    if (d = Object.getOwnPropertyDescriptor(sourceObj, propName)) {\n      // only copy data descriptors\n      if (d.value)\n        targetObj[propName] = d.value;\n    }\n  }\n  catch (e) {\n    // Object.getOwnPropertyDescriptor threw an exception -> not own property\n  }\n}\n\nfunction registerDeclarative (loader, load, link, declare) {\n  var moduleObj = link.moduleObj;\n  var importerSetters = load.importerSetters;\n\n  var locked = false;\n\n  // closure especially not based on link to allow link record disposal\n  var declared = declare.call(global, function (name, value) {\n    // export setter propogation with locking to avoid cycles\n    if (locked)\n      return;\n\n    if (typeof name == 'object') {\n      for (var p in name)\n        if (p !== '__useDefault')\n          moduleObj[p] = name[p];\n    }\n    else {\n      moduleObj[name] = value;\n    }\n\n    locked = true;\n    for (var i = 0; i < importerSetters.length; i++)\n      importerSetters[i](moduleObj);\n    locked = false;\n\n    return value;\n  }, new ContextualLoader(loader, load.key));\n\n  if (typeof declared !== 'function') {\n    link.setters = declared.setters;\n    link.execute = declared.execute;\n  }\n  else {\n    link.setters = [];\n    link.execute = declared;\n  }\n}\n\nfunction instantiateDeps (loader, load, link, registry, registerRegistry, seen) {\n  return (link.depsInstantiatePromise || (link.depsInstantiatePromise = Promise.resolve()\n  .then(function () {\n    var depsInstantiatePromises = Array(link.dependencies.length);\n\n    for (var i = 0; i < link.dependencies.length; i++)\n      depsInstantiatePromises[i] = resolveInstantiateDep(loader, link.dependencies[i], load.key, load.metadata, registry, registerRegistry, loader.trace && (link.depMap = {}));\n\n    return Promise.all(depsInstantiatePromises);\n  })\n  .then(function (dependencyInstantiations) {\n    link.dependencyInstantiations = dependencyInstantiations;\n\n    // run setters to set up bindings to instantiated dependencies\n    if (link.setters) {\n      for (var i = 0; i < dependencyInstantiations.length; i++) {\n        var setter = link.setters[i];\n        if (setter) {\n          var instantiation = dependencyInstantiations[i];\n\n          if (instantiation instanceof Module) {\n            setter(instantiation);\n          }\n          else {\n            setter(instantiation.module || instantiation.linkRecord.moduleObj);\n            // this applies to both es and dynamic registrations\n            if (instantiation.importerSetters)\n              instantiation.importerSetters.push(setter);\n          }\n        }\n      }\n    }\n  })))\n  .then(function () {\n    // now deeply instantiateDeps on each dependencyInstantiation that is a load record\n    var deepDepsInstantiatePromises = [];\n\n    for (var i = 0; i < link.dependencies.length; i++) {\n      var depLoad = link.dependencyInstantiations[i];\n      var depLink = depLoad.linkRecord;\n\n      if (!depLink || depLink.linked)\n        continue;\n\n      if (seen.indexOf(depLoad) !== -1)\n        continue;\n      seen.push(depLoad);\n\n      deepDepsInstantiatePromises.push(instantiateDeps(loader, depLoad, depLoad.linkRecord, registry, registerRegistry, seen));\n    }\n\n    return Promise.all(deepDepsInstantiatePromises);\n  })\n  .then(function () {\n    // as soon as all dependencies instantiated, we are ready for evaluation so can add to the registry\n    // this can run multiple times, but so what\n    link.linked = true;\n    if (loader.trace)\n      traceLoad(loader, load, link);\n\n    return load;\n  })\n  .catch(function (err) {\n    err = addToError(err, 'Loading ' + load.key);\n\n    // throw up the instantiateDeps stack\n    // loads are then synchonously cleared at the top-level through the clearLoadErrors helper below\n    // this then ensures avoiding partially unloaded tree states\n    link.error = link.error || err;\n\n    throw err;\n  });\n}\n\n// clears an errored load and all its errored dependencies from the loads registry\nfunction clearLoadErrors (loader, load) {\n  // clear from loads\n  if (loader[REGISTER_REGISTRY][load.key] === load)\n    loader[REGISTER_REGISTRY][load.key] = undefined;\n\n  var link = load.linkRecord;\n\n  if (!link)\n    return;\n\n  if (link.dependencyInstantiations)\n    link.dependencyInstantiations.forEach(function (depLoad, index) {\n      if (!depLoad || depLoad instanceof Module)\n        return;\n\n      if (depLoad.linkRecord) {\n        if (depLoad.linkRecord.error) {\n          // provides a circular reference check\n          if (loader[REGISTER_REGISTRY][depLoad.key] === depLoad)\n            clearLoadErrors(loader, depLoad);\n        }\n\n        // unregister setters for es dependency load records that will remain\n        if (link.setters && depLoad.importerSetters) {\n          var setterIndex = depLoad.importerSetters.indexOf(link.setters[index]);\n          depLoad.importerSetters.splice(setterIndex, 1);\n        }\n      }\n    });\n}\n\n/*\n * System.register\n */\nRegisterLoader.prototype.register = function (key, deps, declare) {\n  // anonymous modules get stored as lastAnon\n  if (declare === undefined) {\n    this[REGISTERED_LAST_ANON] = [key, deps, false];\n  }\n\n  // everything else registers into the register cache\n  else {\n    var load = this[REGISTER_REGISTRY][key] || createLoadRecord.call(this, key, undefined);\n    load.registration = [deps, declare, false];\n    if (load.metadata)\n      load.metadata.registered = true;\n  }\n};\n\n/*\n * System.registerDyanmic\n */\nRegisterLoader.prototype.registerDynamic = function (key, deps, execute) {\n  // anonymous modules get stored as lastAnon\n  if (typeof key !== 'string') {\n    this[REGISTERED_LAST_ANON] = [key, typeof deps === 'boolean' ? dynamicExecuteCompat(key, deps, execute) : deps, true];\n  }\n\n  // everything else registers into the register cache\n  else {\n    var load = this[REGISTER_REGISTRY][key] || createLoadRecord.call(this, key, undefined);\n    load.registration = [deps, typeof execute === 'boolean' ? dynamicExecuteCompat(deps, execute, arguments[3]) : execute, true];\n    if (load.metadata)\n      load.metadata.registered = true;\n  }\n};\n\nfunction dynamicExecuteCompat (deps, executingRequire, execute) {\n  return function (require, exports, module) {\n    // evaluate deps first\n    if (!executingRequire)\n      for (var i = 0; i < deps.length; i++)\n        require(deps[i]);\n\n    // then run execution function\n    // also provide backwards compat for no return value\n    // previous 4 argument form of System.register had \"this\" as global value\n    module.exports = execute.apply(global, arguments) || module.exports;\n  };\n}\n\n// NB this is being deprecated\nRegisterLoader.prototype.processRegisterContext = function (contextKey) {\n  var registeredLastAnon = this[REGISTERED_LAST_ANON];\n\n  if (!registeredLastAnon)\n    return;\n\n  this[REGISTERED_LAST_ANON] = undefined;\n\n  // returning the defined value allows avoiding an extra lookup for custom instantiate\n  var load = this[REGISTER_REGISTRY][contextKey] || createLoadRecord.call(this, contextKey, undefined);\n  load.registration = registeredLastAnon;\n  load.metadata.registered = true;\n};\n\n// ContextualLoader class\n// backwards-compatible with previous System.register context argument by exposing .id\nfunction ContextualLoader (loader, key) {\n  this.loader = loader;\n  this.key = this.id = key;\n}\nContextualLoader.prototype.constructor = function () {\n  throw new TypeError('Cannot subclass the contextual loader only Reflect.Loader.');\n};\nContextualLoader.prototype.import = function (key) {\n  return this.loader.import(key, this.key);\n};\nContextualLoader.prototype.resolve = function (key) {\n  return this.loader.resolve(key, this.key);\n};\nContextualLoader.prototype.load = function (key) {\n  return this.loader.load(key, this.key);\n};\n\n// this is the execution function bound to the Module namespace record\nfunction ensureEvaluate (loader, load, link, registry, registerRegistry, seen) {\n  if (load.module)\n    return load.module;\n\n  if (link.error)\n    throw link.error;\n\n  if (seen && seen.indexOf(load) !== -1)\n    return load.linkRecord.moduleObj;\n\n  // for ES loads we always run ensureEvaluate on top-level, so empty seen is passed regardless\n  // for dynamic loads, we pass seen if also dynamic\n  var err = doEvaluate(loader, load, link, registry, registerRegistry, load.setters ? [] : seen || []);\n  if (err) {\n    clearLoadErrors(loader, load);\n    throw err;\n  }\n\n  return load.module;\n}\n\nfunction makeDynamicRequire (loader, key, dependencies, dependencyInstantiations, registry, registerRegistry, seen) {\n  // we can only require from already-known dependencies\n  return function (name) {\n    for (var i = 0; i < dependencies.length; i++) {\n      if (dependencies[i] === name) {\n        var depLoad = dependencyInstantiations[i];\n        var module;\n\n        if (depLoad instanceof Module)\n          module = depLoad;\n        else\n          module = ensureEvaluate(loader, depLoad, depLoad.linkRecord, registry, registerRegistry, seen);\n\n        return module.__useDefault ? module.default : module;\n      }\n    }\n    throw new Error('Module ' + name + ' not declared as a System.registerDynamic dependency of ' + key);\n  };\n}\n\n// ensures the given es load is evaluated\n// returns the error if any\nfunction doEvaluate (loader, load, link, registry, registerRegistry, seen) {\n  seen.push(load);\n\n  var err;\n\n  // es modules evaluate dependencies first\n  // non es modules explicitly call moduleEvaluate through require\n  if (link.setters) {\n    var depLoad, depLink;\n    for (var i = 0; i < link.dependencies.length; i++) {\n      depLoad = link.dependencyInstantiations[i];\n\n      // custom Module returned from instantiate\n      // it is the responsibility of the executor to remove the module from the registry on failure\n      if (depLoad instanceof Module) {\n        err = nsEvaluate(depLoad);\n      }\n\n      // ES or dynamic execute\n      else {\n        depLink = depLoad.linkRecord;\n        if (depLink && seen.indexOf(depLoad) === -1) {\n          if (depLink.error)\n            err = depLink.error;\n          else\n            // dynamic / declarative boundaries clear the \"seen\" list\n            // we just let cross format circular throw as would happen in real implementations\n            err = doEvaluate(loader, depLoad, depLink, registry, registerRegistry, depLink.setters ? seen : []);\n        }\n      }\n\n      if (err)\n        return link.error = addToError(err, 'Evaluating ' + load.key);\n    }\n  }\n\n  // link.execute won't exist for Module returns from instantiate on top-level load\n  if (link.execute) {\n    // ES System.register execute\n    // \"this\" is null in ES\n    if (link.setters) {\n      err = doExecute(link.execute, nullContext);\n    }\n    // System.registerDynamic execute\n    // \"this\" is \"exports\" in CJS\n    else {\n      var module = { id: load.key };\n      var moduleObj = link.moduleObj;\n      Object.defineProperty(module, 'exports', {\n        set: function (exports) {\n          moduleObj.default = exports;\n        },\n        get: function () {\n          return moduleObj.default;\n        }\n      });\n      err = doExecute(link.execute, module.exports, [\n        makeDynamicRequire(loader, load.key, link.dependencies, link.dependencyInstantiations, registry, registerRegistry, seen),\n        module.exports,\n        module\n      ]);\n\n      // copy module.exports onto the module object\n      if (!err)\n        copyNamedExports(module.exports, moduleObj);\n    }\n  }\n\n  if (err)\n    return link.error = addToError(err, 'Evaluating ' + load.key);\n\n  registry[load.key] = load.module = new Module(link.moduleObj);\n\n  // if not an esm module, run importer setters and clear them\n  // this allows dynamic modules to update themselves into es modules\n  // as soon as execution has completed\n  if (!link.setters) {\n    if (load.importerSetters)\n      for (var i = 0; i < load.importerSetters.length; i++)\n        load.importerSetters[i](load.module);\n    load.importerSetters = undefined;\n  }\n\n  // dispose link record\n  load.linkRecord = undefined;\n}\n\n// {} is the closest we can get to call(undefined)\nvar nullContext = {};\nif (Object.freeze)\n  Object.freeze(nullContext);\nfunction doExecute (execute, context, args) {\n  try {\n    execute.apply(context, args);\n  }\n  catch (e) {\n    return e;\n  }\n}\n\nfunction nsEvaluate (ns) {\n  try {\n    Module.evaluate(ns);\n  }\n  catch (e) {\n    return e;\n  }\n}\n","import { isWindows } from './common.js';\n\n/*\n * Source loading\n */\nfunction fetchFetch (url, authorization, integrity, asBuffer) {\n  // fetch doesn't support file:/// urls\n  if (url.substr(0, 8) === 'file:///') {\n    if (hasXhr)\n      return xhrFetch(url, authorization);\n    else\n      throw new Error('Unable to fetch file URLs in this environment.');\n  }\n\n  // percent encode just \"#\" for HTTP requests\n  url = url.replace(/#/g, '%23');\n\n  var opts = {\n    // NB deprecate\n    headers: { Accept: 'application/x-es-module, */*' }\n  };\n\n  if (integrity)\n    opts.integrity = integrity;\n\n  if (authorization) {\n    if (typeof authorization == 'string')\n      opts.headers['Authorization'] = authorization;\n    opts.credentials = 'include';\n  }\n\n  return fetch(url, opts)\n  .then(function(res) {\n    if (res.ok)\n      return asBuffer ? res.arrayBuffer() : res.text();\n    else\n      throw new Error('Fetch error: ' + res.status + ' ' + res.statusText);\n  });\n}\n\nfunction xhrFetch (url, authorization, integrity, asBuffer) {\n  return new Promise(function (resolve, reject) {\n    // percent encode just \"#\" for HTTP requests\n    url = url.replace(/#/g, '%23');\n\n    var xhr = new XMLHttpRequest();\n    if (asBuffer)\n      xhr.responseType = 'arraybuffer';\n    function load() {\n      resolve(asBuffer ? xhr.response : xhr.responseText);\n    }\n    function error() {\n      reject(new Error('XHR error' + (xhr.status ? ' (' + xhr.status + (xhr.statusText ? ' ' + xhr.statusText  : '') + ')' : '') + ' loading ' + url));\n    }\n\n    xhr.onreadystatechange = function () {\n      if (xhr.readyState === 4) {\n        // in Chrome on file:/// URLs, status is 0\n        if (xhr.status == 0) {\n          if (xhr.response) {\n            load();\n          }\n          else {\n            // when responseText is empty, wait for load or error event\n            // to inform if it is a 404 or empty file\n            xhr.addEventListener('error', error);\n            xhr.addEventListener('load', load);\n          }\n        }\n        else if (xhr.status === 200) {\n          load();\n        }\n        else {\n          error();\n        }\n      }\n    };\n    xhr.open(\"GET\", url, true);\n\n    if (xhr.setRequestHeader) {\n      xhr.setRequestHeader('Accept', 'application/x-es-module, */*');\n      // can set \"authorization: true\" to enable withCredentials only\n      if (authorization) {\n        if (typeof authorization == 'string')\n          xhr.setRequestHeader('Authorization', authorization);\n        xhr.withCredentials = true;\n      }\n    }\n\n    xhr.send(null);\n  });\n}\n\nvar fs;\nfunction nodeFetch (url, authorization, integrity, asBuffer) {\n  if (url.substr(0, 8) != 'file:///')\n    return Promise.reject(new Error('Unable to fetch \"' + url + '\". Only file URLs of the form file:/// supported running in Node.'));\n\n  fs = fs || require('fs');\n  if (isWindows)\n    url = url.replace(/\\//g, '\\\\').substr(8);\n  else\n    url = url.substr(7);\n\n  return new Promise(function (resolve, reject) {\n    fs.readFile(url, function(err, data) {\n      if (err) {\n        return reject(err);\n      }\n      else {\n        if (asBuffer) {\n          resolve(data);\n        }\n        else {\n          // Strip Byte Order Mark out if it's the leading char\n          var dataString = data + '';\n          if (dataString[0] === '\\ufeff')\n            dataString = dataString.substr(1);\n\n          resolve(dataString);\n        }\n      }\n    });\n  });\n}\n\nfunction noFetch () {\n  throw new Error('No fetch method is defined for this environment.');\n}\n\nvar fetchFunction;\n\nvar hasXhr = typeof XMLHttpRequest !== 'undefined';\n\nif (typeof self !== 'undefined' && typeof self.fetch !== 'undefined')\n fetchFunction = fetchFetch;\nelse if (hasXhr)\n  fetchFunction = xhrFetch;\nelse if (typeof require !== 'undefined' && typeof process !== 'undefined')\n  fetchFunction = nodeFetch;\nelse\n  fetchFunction = noFetch;\n\nexport default fetchFunction;\n","import SystemJSLoader, { CREATE_METADATA, CONFIG } from './systemjs-loader.js';\nimport { getMapMatch, readMemberExpression, extendMeta, addToError, resolveUrlToParentIfNotPlain, baseURI } from './common.js';\nimport { setPkgConfig, createPackage } from './config.js';\nimport fetch from './fetch.js';\n\n// separate out paths cache as a baseURL lock process\nexport function applyPaths (paths, key) {\n  // most specific (most number of slashes in path) match wins\n  var pathMatch = '', wildcard;\n\n  // check to see if we have a paths entry\n  for (var p in paths) {\n    if (!paths.hasOwnProperty(p))\n      continue;\n\n    // exact path match\n    if (key === p)\n      return paths[p];\n\n    // support trailing / in paths rules\n    else if ((key.length < p.length || key[p.length - 1] === p[p.length - 1]) && (paths[p][paths[p].length - 1] === '/' || paths[p] === '')\n        && key.substr(0, p.length - 1) === p.substr(0, p.length - 1))\n      return paths[p].substr(0, paths[p].length - 1) + (key.length > p.length ? (paths[p] && '/' || '') + key.substr(p.length) : '');\n  }\n\n  var outPath = paths[pathMatch];\n  if (typeof wildcard === 'string')\n    outPath = outPath.replace('*', wildcard);\n\n  return outPath;\n}\n\nfunction getParentMetadata (loader, config, metadata, parentKey) {\n  var parentMetadata = loader[CREATE_METADATA]();\n\n  if (parentKey) {\n    // detect parent plugin\n    // we just need pluginKey to be truthy for package configurations\n    // so we duplicate it as pluginArgument - although not correct its not used\n    var parentPluginIndex;\n    if (config.pluginFirst) {\n      if ((parentPluginIndex = parentKey.lastIndexOf('!')) !== -1)\n        parentMetadata.pluginArgument = parentMetadata.pluginKey = parentKey.substr(0, parentPluginIndex);\n    }\n    else {\n      if ((parentPluginIndex = parentKey.indexOf('!')) !== -1)\n        parentMetadata.pluginArgument = parentMetadata.pluginKey = parentKey.substr(parentPluginIndex + 1);\n    }\n\n    // detect parent package\n    parentMetadata.packageKey = getPackage(config, parentKey);\n    if (parentMetadata.packageKey)\n      parentMetadata.packageConfig = config.packages[parentMetadata.packageKey];\n  }\n\n  return parentMetadata;\n}\n\nexport function normalize (key, parentKey, metadata, parentMetadata) {\n  var config = this[CONFIG];\n\n  // these are because users can still call System.normalize('a', 'b')\n  // this will be fixed with deprecating normalize and even sooner with es-module-loader 2\n  // which doesn't need to share the \"normalize\" prototype method\n  metadata = metadata || this[CREATE_METADATA]();\n  parentMetadata = parentMetadata || getParentMetadata(this, config, metadata, parentKey);\n\n  var loader = this;\n  return booleanConditional.call(loader, key, parentKey)\n  .then(function (key) {\n    // pluginResolve wraps packageResolve wraps coreResolve\n    return pluginResolve.call(loader, config, key, parentKey, metadata, parentMetadata);\n  })\n  .then(function (normalized) {\n    return interpolateConditional.call(loader, normalized, parentKey, parentMetadata);\n  })\n  .then(function (normalized) {\n    setMeta.call(loader, config, normalized, metadata);\n\n    if (metadata.pluginKey || !metadata.load.loader)\n      return normalized;\n\n    // loader by configuration\n    // normalizes to parent to support package loaders\n    return loader.normalize(metadata.load.loader, normalized, loader[CREATE_METADATA](), metadata)\n    .then(function (pluginKey) {\n      metadata.pluginKey = pluginKey;\n      metadata.pluginArgument = normalized;\n      return normalized;\n    });\n  });\n}\n\n// normalization function used for registry keys\n// just does coreResolve without map + plugins\nexport function decanonicalize (config, key) {\n  var parsed = parsePlugin(config, key);\n\n  // plugin\n  if (parsed) {\n    var pluginKey = decanonicalize.call(this, config, parsed.plugin);\n    return combinePluginParts(config, coreResolve.call(this, config, parsed.argument, undefined, false), pluginKey);\n  }\n\n  return coreResolve.call(this, config, key, undefined, false);\n}\n\nexport function normalizeSync (key, parentKey) {\n  var config = this[CONFIG];\n\n  // normalizeSync is metadataless, so create metadata\n  var metadata = this[CREATE_METADATA]();\n  var parentMetadata = parentMetadata || getParentMetadata(this, config, metadata, parentKey);\n\n  var parsed = parsePlugin(config, key);\n\n  // plugin\n  if (parsed) {\n    metadata.pluginKey = this.normalizeSync(parsed.plugin, parentKey);\n    return combinePluginParts(config,\n        packageResolveSync.call(this, config, parsed.argument, parentMetadata.pluginArgument || parentKey, metadata, parentMetadata, !!metadata.pluginKey),\n        metadata.pluginKey);\n  }\n\n  return packageResolveSync.call(this, config, key, parentMetadata.pluginArgument || parentKey, metadata, parentMetadata, !!metadata.pluginKey);\n}\n\nexport function normalizePaths (config) {\n  for (var p in config.paths) {\n    if (!config.paths.hasOwnProperty(p))\n      continue;\n    // warn on wildcard path deprecations\n    var path = config.paths[p];\n    if (path.indexOf('*') !== -1)\n      warn.call(config, 'Paths configuration \"' + p + '\" -> \"' + path + '\" uses wildcards which are no longer supported.', true);\n    config.paths[p] = resolveUrlToParentIfNotPlain(path, baseURI) || resolveUrlToParentIfNotPlain('./' + path, config.baseURL);\n  }\n  config.pathsLocked = true;\n}\n\nexport function coreResolve (config, key, parentKey, doMap) {\n  if (!config.pathsLocked)\n    normalizePaths(config);\n\n  var relativeResolved = resolveUrlToParentIfNotPlain(key, parentKey || baseURI);\n\n  // standard URL resolution\n  if (relativeResolved)\n    return applyPaths(config.paths, relativeResolved) || relativeResolved;\n\n  // plain keys not starting with './', 'x://' and '/' go through custom resolution\n  if (doMap) {\n    var mapMatch = getMapMatch(config.map, key);\n\n    if (mapMatch) {\n      key = config.map[mapMatch] + key.substr(mapMatch.length);\n\n      relativeResolved = resolveUrlToParentIfNotPlain(key, baseURI);\n      if (relativeResolved)\n        return relativeResolved;\n    }\n  }\n\n  if (this.registry.has(key))\n    return key;\n\n  if (key.substr(0, 6) === '@node/')\n    return key;\n\n  return applyPaths(config.paths, key) || config.baseURL + key;\n}\n\nfunction pluginResolve (config, key, parentKey, metadata, parentMetadata) {\n  var parsed = parsePlugin(config, key);\n\n  if (!parsed)\n    return packageResolve.call(this, config, key, parentMetadata && parentMetadata.pluginArgument || parentKey, metadata, parentMetadata, false);\n\n  metadata.pluginKey = parsed.plugin;\n\n  return Promise.all([\n    packageResolve.call(this, config, parsed.argument, parentMetadata && parentMetadata.pluginArgument || parentKey, metadata, parentMetadata, true),\n    this.resolve(parsed.plugin, parentKey)\n  ])\n  .then(function (normalized) {\n    metadata.pluginArgument = normalized[0];\n    metadata.pluginKey = normalized[1];\n\n    // don't allow a plugin to load itself\n    if (metadata.pluginArgument === metadata.pluginKey)\n      throw new Error('Plugin ' + metadata.pluginArgument + ' cannot load itself, make sure it is excluded from any wildcard meta configuration via a custom loader: false rule.');\n\n    return combinePluginParts(config, normalized[0], normalized[1]);\n  });\n}\n\nfunction packageResolveSync (config, key, parentKey, metadata, parentMetadata, skipExtensions) {\n  // ignore . since internal maps handled by standard package resolution\n  if (parentMetadata && parentMetadata.packageConfig && key[0] !== '.') {\n    var parentMap = parentMetadata.packageConfig.map;\n    var parentMapMatch = parentMap && getMapMatch(parentMap, key);\n\n    if (parentMapMatch && typeof parentMap[parentMapMatch] === 'string') {\n      var mapped = doMapSync(this, config, parentMetadata.packageConfig, parentMetadata.packageKey, parentMapMatch, key, metadata, skipExtensions);\n      if (mapped)\n        return mapped;\n    }\n  }\n\n  var normalized = coreResolve.call(this, config, key, parentKey, true);\n\n  var pkgConfigMatch = getPackageConfigMatch(config, normalized);\n  metadata.packageKey = pkgConfigMatch && pkgConfigMatch.packageKey || getPackage(config, normalized);\n\n  if (!metadata.packageKey)\n    return normalized;\n\n  if (config.packageConfigKeys.indexOf(normalized) !== -1) {\n    metadata.packageKey = undefined;\n    return normalized;\n  }\n\n  metadata.packageConfig = config.packages[metadata.packageKey] || (config.packages[metadata.packageKey] = createPackage());\n\n  var subPath = normalized.substr(metadata.packageKey.length + 1);\n\n  return applyPackageConfigSync(this, config, metadata.packageConfig, metadata.packageKey, subPath, metadata, skipExtensions);\n}\n\nfunction packageResolve (config, key, parentKey, metadata, parentMetadata, skipExtensions) {\n  var loader = this;\n\n  return Promise.resolve()\n  .then(function () {\n    // ignore . since internal maps handled by standard package resolution\n    if (parentMetadata && parentMetadata.packageConfig && key.substr(0, 2) !== './') {\n      var parentMap = parentMetadata.packageConfig.map;\n      var parentMapMatch = parentMap && getMapMatch(parentMap, key);\n\n      if (parentMapMatch)\n        return doMap(loader, config, parentMetadata.packageConfig, parentMetadata.packageKey, parentMapMatch, key, metadata, skipExtensions);\n    }\n\n    return Promise.resolve();\n  })\n  .then(function (mapped) {\n    if (mapped)\n      return mapped;\n\n    // apply map, core, paths, contextual package map\n    var normalized = coreResolve.call(loader, config, key, parentKey, true);\n\n    var pkgConfigMatch = getPackageConfigMatch(config, normalized);\n    metadata.packageKey = pkgConfigMatch && pkgConfigMatch.packageKey || getPackage(config, normalized);\n\n    if (!metadata.packageKey)\n      return Promise.resolve(normalized);\n\n    if (config.packageConfigKeys.indexOf(normalized) !== -1) {\n      metadata.packageKey = undefined;\n      metadata.load = createMeta();\n      metadata.load.format = 'json';\n      return Promise.resolve(normalized);\n    }\n\n    metadata.packageConfig = config.packages[metadata.packageKey] || (config.packages[metadata.packageKey] = createPackage());\n\n    // load configuration when it matches packageConfigPaths, not already configured, and not the config itself\n    var loadConfig = pkgConfigMatch && !metadata.packageConfig.configured;\n\n    return (loadConfig ? loadPackageConfigPath(loader, config, pkgConfigMatch.configPath, metadata) : Promise.resolve())\n    .then(function () {\n      var subPath = normalized.substr(metadata.packageKey.length + 1);\n\n      return applyPackageConfig(loader, config, metadata.packageConfig, metadata.packageKey, subPath, metadata, skipExtensions);\n    });\n  });\n}\n\nfunction createMeta () {\n  return {\n    extension: '',\n    deps: undefined,\n    format: undefined,\n    loader: undefined,\n    scriptLoad: undefined,\n    globals: undefined,\n    nonce: undefined,\n    integrity: undefined,\n    sourceMap: undefined,\n    exports: undefined,\n    encapsulateGlobal: false,\n    crossOrigin: undefined,\n    cjsRequireDetection: true,\n    cjsDeferDepsExecute: false\n  };\n}\n\nfunction setMeta (config, key, metadata) {\n  metadata.load = metadata.load || createMeta();\n\n  // apply wildcard metas\n  var bestDepth = 0;\n  var wildcardIndex;\n  for (var module in config.meta) {\n    wildcardIndex = module.indexOf('*');\n    if (wildcardIndex === -1)\n      continue;\n    if (module.substr(0, wildcardIndex) === key.substr(0, wildcardIndex)\n        && module.substr(wildcardIndex + 1) === key.substr(key.length - module.length + wildcardIndex + 1)) {\n      var depth = module.split('/').length;\n      if (depth > bestDepth)\n        bestDepth = depth;\n      extendMeta(metadata.load, config.meta[module], bestDepth !== depth);\n    }\n  }\n\n  // apply exact meta\n  if (config.meta[key])\n    extendMeta(metadata.load, config.meta[key]);\n\n  // apply package meta\n  if (metadata.packageKey) {\n    var subPath = key.substr(metadata.packageKey.length + 1);\n\n    var meta = {};\n    if (metadata.packageConfig.meta) {\n      var bestDepth = 0;\n\n      getMetaMatches(metadata.packageConfig.meta, subPath, function (metaPattern, matchMeta, matchDepth) {\n        if (matchDepth > bestDepth)\n          bestDepth = matchDepth;\n        extendMeta(meta, matchMeta, matchDepth && bestDepth > matchDepth);\n      });\n\n      extendMeta(metadata.load, meta);\n    }\n\n    // format\n    if (metadata.packageConfig.format && !metadata.pluginKey)\n      metadata.load.format = metadata.load.format || metadata.packageConfig.format;\n  }\n}\n\nfunction parsePlugin (config, key) {\n  var argumentKey;\n  var pluginKey;\n\n  var pluginIndex = key.lastIndexOf('!');\n\n  if (pluginIndex === -1)\n    return;\n\n  if (config.pluginFirst) {\n    argumentKey = key.substr(pluginIndex + 1);\n    pluginKey = key.substr(0, pluginIndex);\n  }\n  else {\n    argumentKey = key.substr(0, pluginIndex);\n    pluginKey = key.substr(pluginIndex + 1) || argumentKey.substr(argumentKey.lastIndexOf('.') + 1);\n  }\n\n  return {\n    argument: argumentKey,\n    plugin: pluginKey\n  };\n}\n\n// put key back together after parts have been normalized\nfunction combinePluginParts (config, argumentKey, pluginKey) {\n  if (config.pluginFirst)\n    return pluginKey + '!' + argumentKey;\n  else\n    return argumentKey + '!' + pluginKey;\n}\n\n/*\n * Package Configuration Extension\n *\n * Example:\n *\n * SystemJS.packages = {\n *   jquery: {\n *     main: 'index.js', // when not set, package key is requested directly\n *     format: 'amd',\n *     defaultExtension: 'ts', // defaults to 'js', can be set to false\n *     modules: {\n *       '*.ts': {\n *         loader: 'typescript'\n *       },\n *       'vendor/sizzle.js': {\n *         format: 'global'\n *       }\n *     },\n *     map: {\n *        // map internal require('sizzle') to local require('./vendor/sizzle')\n *        sizzle: './vendor/sizzle.js',\n *        // map any internal or external require of 'jquery/vendor/another' to 'another/index.js'\n *        './vendor/another.js': './another/index.js',\n *        // test.js / test -> lib/test.js\n *        './test.js': './lib/test.js',\n *\n *        // environment-specific map configurations\n *        './index.js': {\n *          '~browser': './index-node.js',\n *          './custom-condition.js|~export': './index-custom.js'\n *        }\n *     },\n *     // allows for setting package-prefixed depCache\n *     // keys are normalized module keys relative to the package itself\n *     depCache: {\n *       // import 'package/index.js' loads in parallel package/lib/test.js,package/vendor/sizzle.js\n *       './index.js': ['./test'],\n *       './test.js': ['external-dep'],\n *       'external-dep/path.js': ['./another.js']\n *     }\n *   }\n * };\n *\n * Then:\n *   import 'jquery'                       -> jquery/index.js\n *   import 'jquery/submodule'             -> jquery/submodule.js\n *   import 'jquery/submodule.ts'          -> jquery/submodule.ts loaded as typescript\n *   import 'jquery/vendor/another'        -> another/index.js\n *\n * Detailed Behaviours\n * - main can have a leading \"./\" can be added optionally\n * - map and defaultExtension are applied to the main\n * - defaultExtension adds the extension only if the exact extension is not present\n\n * - if a meta value is available for a module, map and defaultExtension are skipped\n * - like global map, package map also applies to subpaths (sizzle/x, ./vendor/another/sub)\n * - condition module map is '@env' module in package or '@system-env' globally\n * - map targets support conditional interpolation ('./x': './x.#{|env}.js')\n * - internal package map targets cannot use boolean conditionals\n *\n * Package Configuration Loading\n *\n * Not all packages may already have their configuration present in the System config\n * For these cases, a list of packageConfigPaths can be provided, which when matched against\n * a request, will first request a \".json\" file by the package key to derive the package\n * configuration from. This allows dynamic loading of non-predetermined code, a key use\n * case in SystemJS.\n *\n * Example:\n *\n *   SystemJS.packageConfigPaths = ['packages/test/package.json', 'packages/*.json'];\n *\n *   // will first request 'packages/new-package/package.json' for the package config\n *   // before completing the package request to 'packages/new-package/path'\n *   SystemJS.import('packages/new-package/path');\n *\n *   // will first request 'packages/test/package.json' before the main\n *   SystemJS.import('packages/test');\n *\n * When a package matches packageConfigPaths, it will always send a config request for\n * the package configuration.\n * The package key itself is taken to be the match up to and including the last wildcard\n * or trailing slash.\n * The most specific package config path will be used.\n * Any existing package configurations for the package will deeply merge with the\n * package config, with the existing package configurations taking preference.\n * To opt-out of the package configuration request for a package that matches\n * packageConfigPaths, use the { configured: true } package config option.\n *\n */\nfunction getPackage (config, normalized) {\n  // use most specific package\n  var curPkg, curPkgLen = 0, pkgLen;\n  for (var p in config.packages) {\n    if (normalized.substr(0, p.length) === p && (normalized.length === p.length || normalized[p.length] === '/')) {\n      pkgLen = p.split('/').length;\n      if (pkgLen > curPkgLen) {\n        curPkg = p;\n        curPkgLen = pkgLen;\n      }\n    }\n  }\n  return curPkg;\n}\n\nfunction addDefaultExtension (config, pkg, pkgKey, subPath, skipExtensions) {\n  // don't apply extensions to folders or if defaultExtension = false\n  if (!subPath || !pkg.defaultExtension || subPath[subPath.length - 1] === '/' || skipExtensions)\n    return subPath;\n\n  var metaMatch = false;\n\n  // exact meta or meta with any content after the last wildcard skips extension\n  if (pkg.meta)\n    getMetaMatches(pkg.meta, subPath, function (metaPattern, matchMeta, matchDepth) {\n      if (matchDepth === 0 || metaPattern.lastIndexOf('*') !== metaPattern.length - 1)\n        return metaMatch = true;\n    });\n\n  // exact global meta or meta with any content after the last wildcard skips extension\n  if (!metaMatch && config.meta)\n    getMetaMatches(config.meta, pkgKey + '/' + subPath, function (metaPattern, matchMeta, matchDepth) {\n      if (matchDepth === 0 || metaPattern.lastIndexOf('*') !== metaPattern.length - 1)\n        return metaMatch = true;\n    });\n\n  if (metaMatch)\n    return subPath;\n\n  // work out what the defaultExtension is and add if not there already\n  var defaultExtension = '.' + pkg.defaultExtension;\n  if (subPath.substr(subPath.length - defaultExtension.length) !== defaultExtension)\n    return subPath + defaultExtension;\n  else\n    return subPath;\n}\n\nfunction applyPackageConfigSync (loader, config, pkg, pkgKey, subPath, metadata, skipExtensions) {\n  // main\n  if (!subPath) {\n    if (pkg.main)\n      subPath = pkg.main.substr(0, 2) === './' ? pkg.main.substr(2) : pkg.main;\n    else\n      // also no submap if key is package itself (import 'pkg' -> 'path/to/pkg.js')\n      // NB can add a default package main convention here\n      // if it becomes internal to the package then it would no longer be an exit path\n      return pkgKey;\n  }\n\n  // map config checking without then with extensions\n  if (pkg.map) {\n    var mapPath = './' + subPath;\n\n    var mapMatch = getMapMatch(pkg.map, mapPath);\n\n    // we then check map with the default extension adding\n    if (!mapMatch) {\n      mapPath = './' + addDefaultExtension(loader, pkg, pkgKey, subPath, skipExtensions);\n      if (mapPath !== './' + subPath)\n        mapMatch = getMapMatch(pkg.map, mapPath);\n    }\n    if (mapMatch) {\n      var mapped = doMapSync(loader, config, pkg, pkgKey, mapMatch, mapPath, metadata, skipExtensions);\n      if (mapped)\n        return mapped;\n    }\n  }\n\n  // normal package resolution\n  return pkgKey + '/' + addDefaultExtension(loader, pkg, pkgKey, subPath, skipExtensions);\n}\n\nfunction validMapping (mapMatch, mapped, path) {\n  // allow internal ./x -> ./x/y or ./x/ -> ./x/y recursive maps\n  // but only if the path is exactly ./x and not ./x/z\n  if (mapped.substr(0, mapMatch.length) === mapMatch && path.length > mapMatch.length)\n    return false;\n\n  return true;\n}\n\nfunction doMapSync (loader, config, pkg, pkgKey, mapMatch, path, metadata, skipExtensions) {\n  if (path[path.length - 1] === '/')\n    path = path.substr(0, path.length - 1);\n  var mapped = pkg.map[mapMatch];\n\n  if (typeof mapped === 'object')\n    throw new Error('Synchronous conditional normalization not supported sync normalizing ' + mapMatch + ' in ' + pkgKey);\n\n  if (!validMapping(mapMatch, mapped, path) || typeof mapped !== 'string')\n    return;\n\n  return packageResolveSync.call(this, config, mapped + path.substr(mapMatch.length), pkgKey + '/', metadata, metadata, skipExtensions);\n}\n\nfunction applyPackageConfig (loader, config, pkg, pkgKey, subPath, metadata, skipExtensions) {\n  // main\n  if (!subPath) {\n    if (pkg.main)\n      subPath = pkg.main.substr(0, 2) === './' ? pkg.main.substr(2) : pkg.main;\n    // also no submap if key is package itself (import 'pkg' -> 'path/to/pkg.js')\n    else\n      // NB can add a default package main convention here\n      // if it becomes internal to the package then it would no longer be an exit path\n      return Promise.resolve(pkgKey);\n  }\n\n  // map config checking without then with extensions\n  var mapPath, mapMatch;\n\n  if (pkg.map) {\n    mapPath = './' + subPath;\n    mapMatch = getMapMatch(pkg.map, mapPath);\n\n    // we then check map with the default extension adding\n    if (!mapMatch) {\n      mapPath = './' + addDefaultExtension(loader, pkg, pkgKey, subPath, skipExtensions);\n      if (mapPath !== './' + subPath)\n        mapMatch = getMapMatch(pkg.map, mapPath);\n    }\n  }\n\n  return (mapMatch ? doMap(loader, config, pkg, pkgKey, mapMatch, mapPath, metadata, skipExtensions) : Promise.resolve())\n  .then(function (mapped) {\n    if (mapped)\n      return Promise.resolve(mapped);\n\n    // normal package resolution / fallback resolution for no conditional match\n    return Promise.resolve(pkgKey + '/' + addDefaultExtension(loader, pkg, pkgKey, subPath, skipExtensions));\n  });\n}\n\nfunction doMap (loader, config, pkg, pkgKey, mapMatch, path, metadata, skipExtensions) {\n  if (path[path.length - 1] === '/')\n    path = path.substr(0, path.length - 1);\n\n  var mapped = pkg.map[mapMatch];\n\n  if (typeof mapped === 'string') {\n    if (!validMapping(mapMatch, mapped, path))\n      return Promise.resolve();\n    return packageResolve.call(loader, config, mapped + path.substr(mapMatch.length), pkgKey + '/', metadata, metadata, skipExtensions)\n    .then(function (normalized) {\n      return interpolateConditional.call(loader, normalized, pkgKey + '/', metadata);\n    });\n  }\n\n  // we use a special conditional syntax to allow the builder to handle conditional branch points further\n  /*if (loader.builder)\n    return Promise.resolve(pkgKey + '/#:' + path);*/\n\n  // we load all conditions upfront\n  var conditionPromises = [];\n  var conditions = [];\n  for (var e in mapped) {\n    var c = parseCondition(e);\n    conditions.push({\n      condition: c,\n      map: mapped[e]\n    });\n    conditionPromises.push(loader.import(c.module, pkgKey));\n  }\n\n  // map object -> conditional map\n  return Promise.all(conditionPromises)\n  .then(function (conditionValues) {\n    // first map condition to match is used\n    for (var i = 0; i < conditions.length; i++) {\n      var c = conditions[i].condition;\n      var value = readMemberExpression(c.prop, conditionValues[i].__useDefault ? conditionValues[i].default : conditionValues[i]);\n      if (!c.negate && value || c.negate && !value)\n        return conditions[i].map;\n    }\n  })\n  .then(function (mapped) {\n    if (mapped) {\n      if (!validMapping(mapMatch, mapped, path))\n        return Promise.resolve();\n      return packageResolve.call(loader, config, mapped + path.substr(mapMatch.length), pkgKey + '/', metadata, metadata, skipExtensions)\n      .then(function (normalized) {\n        return interpolateConditional.call(loader, normalized, pkgKey + '/', metadata);\n      });\n    }\n\n    // no environment match -> fallback to original subPath by returning undefined\n  });\n}\n\n// check if the given normalized key matches a packageConfigPath\n// if so, loads the config\nvar packageConfigPaths = {};\n\n// data object for quick checks against package paths\nfunction createPkgConfigPathObj (path) {\n  var lastWildcard = path.lastIndexOf('*');\n  var length = Math.max(lastWildcard + 1, path.lastIndexOf('/'));\n  return {\n    length: length,\n    regEx: new RegExp('^(' + path.substr(0, length).replace(/[.+?^${}()|[\\]\\\\]/g, '\\\\$&').replace(/\\*/g, '[^\\\\/]+') + ')(\\\\/|$)'),\n    wildcard: lastWildcard !== -1\n  };\n}\n\n// most specific match wins\nfunction getPackageConfigMatch (config, normalized) {\n  var pkgKey, exactMatch = false, configPath;\n  for (var i = 0; i < config.packageConfigPaths.length; i++) {\n    var packageConfigPath = config.packageConfigPaths[i];\n    var p = packageConfigPaths[packageConfigPath] || (packageConfigPaths[packageConfigPath] = createPkgConfigPathObj(packageConfigPath));\n    if (normalized.length < p.length)\n      continue;\n    var match = normalized.match(p.regEx);\n    if (match && (!pkgKey || (!(exactMatch && p.wildcard) && pkgKey.length < match[1].length))) {\n      pkgKey = match[1];\n      exactMatch = !p.wildcard;\n      configPath = pkgKey + packageConfigPath.substr(p.length);\n    }\n  }\n\n  if (!pkgKey)\n    return;\n\n  return {\n    packageKey: pkgKey,\n    configPath: configPath\n  };\n}\n\nfunction loadPackageConfigPath (loader, config, pkgConfigPath, metadata, normalized) {\n  var configLoader = loader.pluginLoader || loader;\n\n  // ensure we note this is a package config file path\n  // it will then be skipped from getting other normalizations itself to ensure idempotency\n  if (config.packageConfigKeys.indexOf(pkgConfigPath) === -1)\n    config.packageConfigKeys.push(pkgConfigPath);\n\n  return configLoader.import(pkgConfigPath)\n  .then(function (pkgConfig) {\n    if (pkgConfig.__useDefault)\n      pkgConfig = pkgConfig.default;\n    setPkgConfig(metadata.packageConfig, pkgConfig, metadata.packageKey, true, config);\n    metadata.packageConfig.configured = true;\n  })\n  .catch(function (err) {\n    throw addToError(err, 'Unable to fetch package configuration file ' + pkgConfigPath);\n  });\n}\n\nfunction getMetaMatches (pkgMeta, subPath, matchFn) {\n  // wildcard meta\n  var wildcardIndex;\n  for (var module in pkgMeta) {\n    // allow meta to start with ./ for flexibility\n    var dotRel = module.substr(0, 2) === './' ? './' : '';\n    if (dotRel)\n      module = module.substr(2);\n\n    wildcardIndex = module.indexOf('*');\n    if (wildcardIndex === -1)\n      continue;\n\n    if (module.substr(0, wildcardIndex) === subPath.substr(0, wildcardIndex)\n        && module.substr(wildcardIndex + 1) === subPath.substr(subPath.length - module.length + wildcardIndex + 1)) {\n      // alow match function to return true for an exit path\n      if (matchFn(module, pkgMeta[dotRel + module], module.split('/').length))\n        return;\n    }\n  }\n  // exact meta\n  var exactMeta = pkgMeta[subPath] && pkgMeta.hasOwnProperty && pkgMeta.hasOwnProperty(subPath) ? pkgMeta[subPath] : pkgMeta['./' + subPath];\n  if (exactMeta)\n    matchFn(exactMeta, exactMeta, 0);\n}\n\n\n/*\n * Conditions Extension\n *\n *   Allows a condition module to alter the resolution of an import via syntax:\n *\n *     import $ from 'jquery/#{browser}';\n *\n *   Will first load the module 'browser' via `SystemJS.import('browser')` and\n *   take the default export of that module.\n *   If the default export is not a string, an error is thrown.\n *\n *   We then substitute the string into the require to get the conditional resolution\n *   enabling environment-specific variations like:\n *\n *     import $ from 'jquery/ie'\n *     import $ from 'jquery/firefox'\n *     import $ from 'jquery/chrome'\n *     import $ from 'jquery/safari'\n *\n *   It can be useful for a condition module to define multiple conditions.\n *   This can be done via the `|` modifier to specify an export member expression:\n *\n *     import 'jquery/#{./browser.js|grade.version}'\n *\n *   Where the `grade` export `version` member in the `browser.js` module  is substituted.\n *\n *\n * Boolean Conditionals\n *\n *   For polyfill modules, that are used as imports but have no module value,\n *   a binary conditional allows a module not to be loaded at all if not needed:\n *\n *     import 'es5-shim#?./conditions.js|needs-es5shim'\n *\n *   These conditions can also be negated via:\n *\n *     import 'es5-shim#?./conditions.js|~es6'\n *\n */\n\nvar sysConditions = ['browser', 'node', 'dev', 'build', 'production', 'default'];\n\nfunction parseCondition (condition) {\n  var conditionExport, conditionModule, negation;\n\n  var negation;\n  var conditionExportIndex = condition.lastIndexOf('|');\n  if (conditionExportIndex !== -1) {\n    conditionExport = condition.substr(conditionExportIndex + 1);\n    conditionModule = condition.substr(0, conditionExportIndex);\n\n    if (conditionExport[0] === '~') {\n      negation = true;\n      conditionExport = conditionExport.substr(1);\n    }\n  }\n  else {\n    negation = condition[0] === '~';\n    conditionExport = 'default';\n    conditionModule = condition.substr(negation);\n    if (sysConditions.indexOf(conditionModule) != -1) {\n      conditionExport = conditionModule;\n      conditionModule = null;\n    }\n  }\n\n  return {\n    module: conditionModule || '@system-env',\n    prop: conditionExport,\n    negate: negation\n  };\n}\n\nfunction serializeCondition (conditionObj) {\n  return conditionObj.module + '|' + (conditionObj.negate ? '~' : '') + conditionObj.prop;\n}\n\nfunction resolveCondition (conditionObj, parentKey, bool) {\n  return this.load(conditionObj.module, parentKey)\n  .then(function (condition) {\n    var m = readMemberExpression(conditionObj.prop, condition);\n\n    if (bool && typeof m !== 'boolean')\n      throw new TypeError('Condition ' + serializeCondition(conditionObj) + ' did not resolve to a boolean.');\n\n    return conditionObj.negate ? !m : m;\n  });\n}\n\nvar interpolationRegEx = /#\\{[^\\}]+\\}/;\nfunction interpolateConditional (key, parentKey, parentMetadata) {\n  // first we normalize the conditional\n  var conditionalMatch = key.match(interpolationRegEx);\n\n  if (!conditionalMatch)\n    return Promise.resolve(key);\n\n  var conditionObj = parseCondition.call(this, conditionalMatch[0].substr(2, conditionalMatch[0].length - 3));\n\n  // in builds, return normalized conditional\n  /*if (this.builder)\n    return this.normalize(conditionObj.module, parentKey, this[CREATE_METADATA](), parentMetadata)\n    .then(function (conditionModule) {\n      conditionObj.module = conditionModule;\n      return key.replace(interpolationRegEx, '#{' + serializeCondition(conditionObj) + '}');\n    });*/\n\n  return resolveCondition.call(this, conditionObj, parentKey, false)\n  .then(function (conditionValue) {\n    if (typeof conditionValue !== 'string')\n      throw new TypeError('The condition value for ' + key + ' doesn\\'t resolve to a string.');\n\n    if (conditionValue.indexOf('/') !== -1)\n      throw new TypeError('Unabled to interpolate conditional ' + key + (parentKey ? ' in ' + parentKey : '') + '\\n\\tThe condition value ' + conditionValue + ' cannot contain a \"/\" separator.');\n\n    return key.replace(interpolationRegEx, conditionValue);\n  });\n}\n\nfunction booleanConditional (key, parentKey) {\n  // first we normalize the conditional\n  var booleanIndex = key.lastIndexOf('#?');\n\n  if (booleanIndex === -1)\n    return Promise.resolve(key);\n\n  var conditionObj = parseCondition.call(this, key.substr(booleanIndex + 2));\n\n  // in builds, return normalized conditional\n  /*if (this.builder)\n    return this.resolve(conditionObj.module, parentKey)\n    .then(function (conditionModule) {\n      conditionObj.module = conditionModule;\n      return key.substr(0, booleanIndex) + '#?' + serializeCondition(conditionObj);\n    });*/\n\n  return resolveCondition.call(this, conditionObj, parentKey, true)\n  .then(function (conditionValue) {\n    return conditionValue ? key.substr(0, booleanIndex) : '@empty';\n  });\n}\n","import SystemJSLoader, { envModule, setProduction, CONFIG, configNames } from './systemjs-loader.js';\nimport { extend, warn, resolveUrlToParentIfNotPlain, baseURI } from './common.js';\nimport { coreResolve, normalizePaths } from './resolve.js';\n\n/*\n Extend config merging one deep only\n\n  loader.config({\n    some: 'random',\n    config: 'here',\n    deep: {\n      config: { too: 'too' }\n    }\n  });\n\n  <=>\n\n  loader.some = 'random';\n  loader.config = 'here'\n  loader.deep = loader.deep || {};\n  loader.deep.config = { too: 'too' };\n\n\n  Normalizes meta and package configs allowing for:\n\n  SystemJS.config({\n    meta: {\n      './index.js': {}\n    }\n  });\n\n  To become\n\n  SystemJS.meta['https://thissite.com/index.js'] = {};\n\n  For easy normalization canonicalization with latest URL support.\n\n*/\nvar envConfigNames = ['browserConfig', 'nodeConfig', 'devConfig', 'buildConfig', 'productionConfig'];\nfunction envSet(loader, cfg, envCallback) {\n  for (var i = 0; i < envConfigNames.length; i++) {\n    var envConfig = envConfigNames[i];\n    if (cfg[envConfig] && envModule[envConfig.substr(0, envConfig.length - 6)])\n      envCallback(cfg[envConfig]);\n  }\n}\n\nfunction cloneObj (obj, maxDepth) {\n  var clone = {};\n  for (var p in obj) {\n    var prop = obj[p];\n    if (maxDepth > 1) {\n      if (typeof prop === 'object')\n        clone[p] = cloneObj(prop, maxDepth - 1);\n      else if (p !== 'packageConfig')\n        clone[p] = prop;\n    }\n    else {\n      clone[p] = prop;\n    }\n  }\n  return clone;\n}\n\nexport function getConfigItem (config, p) {\n  var cfgItem = config[p];\n\n  // getConfig must return an unmodifiable clone of the configuration\n  if (cfgItem instanceof Array)\n    return config[p].concat([]);\n  else if (typeof cfgItem === 'object')\n    return cloneObj(cfgItem, 3)\n  else\n    return config[p];\n}\n\nexport function getConfig (configName) {\n  if (configName) {\n    if (configNames.indexOf(configName) !== -1)\n      return getConfigItem(this[CONFIG], configName);\n    throw new Error('\"' + configName + '\" is not a valid configuration name to get. Must be one of ' + configNames.join(', ') + '.');\n  }\n\n  var cfg = {};\n  for (var i = 0; i < configNames.length; i++) {\n    var p = configNames[i];\n    var configItem = getConfigItem(this[CONFIG], p);\n    if (configItem !== undefined)\n      cfg[p] = configItem;\n  }\n  return cfg;\n}\n\nexport function setConfig (cfg, isEnvConfig) {\n  var loader = this;\n  var config = this[CONFIG];\n\n  if ('warnings' in cfg)\n    config.warnings = cfg.warnings;\n\n  if ('wasm' in cfg)\n    config.wasm = cfg.wasm;\n\n  if ('production' in cfg || 'build' in cfg)\n    setProduction.call(loader, !!cfg.production, !!(cfg.build || envModule && envModule.build));\n\n  if (!isEnvConfig) {\n    // if using nodeConfig / browserConfig / productionConfig, take baseURL from there\n    // these exceptions will be unnecessary when we can properly implement config queuings\n    var baseURL;\n    envSet(loader, cfg, function(cfg) {\n      baseURL = baseURL || cfg.baseURL;\n    });\n    baseURL = baseURL || cfg.baseURL;\n\n    // always configure baseURL first\n    if (baseURL) {\n      if (config.pathsLocked)\n        warn.call(config, 'baseURL should be set before other config to avoid conflicts.');\n      config.baseURL = resolveUrlToParentIfNotPlain(baseURL, baseURI) || resolveUrlToParentIfNotPlain('./' + baseURL, baseURI);\n      if (config.baseURL[config.baseURL.length - 1] !== '/')\n        config.baseURL += '/';\n    }\n\n    var pathsExtended = false;\n\n    if (cfg.paths) {\n      extend(config.paths, cfg.paths);\n      pathsExtended = true;\n    }\n\n    envSet(loader, cfg, function(cfg) {\n      if (cfg.paths) {\n        extend(config.paths, cfg.paths);\n        pathsExtended = true;\n      }\n    });\n\n    // last pathing additions\n    if (config.pathsLocked && pathsExtended) {\n      // warn.call(config, 'paths should be set before other config to avoid conflicts.')\n      normalizePaths(config);\n    }\n  }\n\n  if (cfg.defaultJSExtensions)\n    warn.call(config, 'The defaultJSExtensions configuration option has been removed, use packages configuration defaultExtension instead.', true);\n\n  if (typeof cfg.pluginFirst === 'boolean')\n    config.pluginFirst = cfg.pluginFirst;\n\n  if (cfg.map) {\n    for (var p in cfg.map) {\n      var v = cfg.map[p];\n\n      if (typeof v === 'string') {\n        config.map[p] = coreResolve.call(loader, config, v, undefined, false);\n      }\n\n      // object map\n      else {\n        var pkgName = coreResolve.call(loader, config, p, undefined, true);\n        var pkg = config.packages[pkgName];\n        if (!pkg) {\n          pkg = config.packages[pkgName] = createPackage();\n          // use '' instead of false to keep type consistent\n          pkg.defaultExtension = '';\n        }\n        setPkgConfig(pkg, { map: v }, pkgName, false, config);\n      }\n    }\n  }\n\n  if (cfg.packageConfigPaths) {\n    var packageConfigPaths = [];\n    for (var i = 0; i < cfg.packageConfigPaths.length; i++) {\n      var path = cfg.packageConfigPaths[i];\n      var packageLength = Math.max(path.lastIndexOf('*') + 1, path.lastIndexOf('/'));\n      var normalized = coreResolve.call(loader, config, path.substr(0, packageLength), undefined, false);\n      packageConfigPaths[i] = normalized + path.substr(packageLength);\n    }\n    config.packageConfigPaths = packageConfigPaths;\n  }\n\n  if (cfg.bundles) {\n    for (var p in cfg.bundles) {\n      var bundle = [];\n      for (var i = 0; i < cfg.bundles[p].length; i++)\n        bundle.push(loader.normalizeSync(cfg.bundles[p][i]));\n      config.bundles[p] = bundle;\n    }\n  }\n\n  if (cfg.packages) {\n    for (var p in cfg.packages) {\n      if (p.match(/^([^\\/]+:)?\\/\\/$/))\n        throw new TypeError('\"' + p + '\" is not a valid package name.');\n\n      var pkgName = coreResolve.call(loader, config, p, undefined, true);\n\n      // allow trailing slash in packages\n      if (pkgName[pkgName.length - 1] === '/')\n        pkgName = pkgName.substr(0, pkgName.length - 1);\n\n      setPkgConfig(config.packages[pkgName] = config.packages[pkgName] || createPackage(), cfg.packages[p], pkgName, false, config);\n    }\n  }\n\n  if (cfg.depCache) {\n    for (var p in cfg.depCache)\n      config.depCache[loader.normalizeSync(p)] = [].concat(cfg.depCache[p]);\n  }\n\n  if (cfg.meta) {\n    for (var p in cfg.meta) {\n      // base wildcard stays base\n      if (p[0] === '*') {\n        extend(config.meta[p] = config.meta[p] || {}, cfg.meta[p]);\n      }\n      else {\n        var resolved = coreResolve.call(loader, config, p, undefined, true);\n        extend(config.meta[resolved] = config.meta[resolved] || {}, cfg.meta[p]);\n      }\n    }\n  }\n\n  if ('transpiler' in cfg)\n    config.transpiler = cfg.transpiler;\n\n\n  // copy any remaining non-standard configuration properties\n  for (var c in cfg) {\n    if (configNames.indexOf(c) !== -1)\n      continue;\n    if (envConfigNames.indexOf(c) !== -1)\n      continue;\n    // warn.call(config, 'Setting custom config option `System.config({ ' + c + ': ... })` is deprecated. Avoid custom config options or set SystemJS.' + c + ' = ... directly.');\n\n    config[c] = cfg[c];\n  }\n\n  envSet(loader, cfg, function(cfg) {\n    loader.config(cfg, true);\n  });\n}\n\nexport function createPackage () {\n  return {\n    defaultExtension: undefined,\n    main: undefined,\n    format: undefined,\n    meta: undefined,\n    map: undefined,\n    packageConfig: undefined,\n    configured: false\n  };\n}\n\n// deeply-merge (to first level) config with any existing package config\nexport function setPkgConfig (pkg, cfg, pkgName, prependConfig, config) {\n  for (var prop in cfg) {\n    if (prop === 'main' || prop === 'format' || prop === 'defaultExtension' || prop === 'configured') {\n      if (!prependConfig || pkg[prop] === undefined)\n        pkg[prop] = cfg[prop];\n    }\n    else if (prop === 'map') {\n      extend(pkg.map = pkg.map || {}, cfg.map, prependConfig);\n    }\n    else if (prop === 'meta') {\n      extend(pkg.meta = pkg.meta || {}, cfg.meta, prependConfig);\n    }\n    else if (Object.hasOwnProperty.call(cfg, prop)) {\n      warn.call(config, '\"' + prop + '\" is not a valid package configuration option in package ' + pkgName);\n    }\n  }\n\n  // default defaultExtension for packages only\n  if (pkg.defaultExtension === undefined)\n    pkg.defaultExtension = 'js';\n\n  if (pkg.main === undefined && pkg.map && pkg.map['.']) {\n    pkg.main = pkg.map['.'];\n    delete pkg.map['.'];\n  }\n  // main object becomes main map\n  else if (typeof pkg.main === 'object') {\n    pkg.map = pkg.map || {};\n    pkg.map['./@main'] = pkg.main;\n    pkg.main['default'] = pkg.main['default'] || './';\n    pkg.main = '@main';\n  }\n\n  return pkg;\n}\n","\nimport { isWindows, global, readMemberExpression, cjsRequireRegEx } from './common.js';\n\nexport default function (loader) {\n  loader.set('@@cjs-helpers', loader.newModule({\n    requireResolve: requireResolve.bind(loader),\n    getPathVars: getPathVars\n  }));\n\n  loader.set('@@global-helpers', loader.newModule({\n    prepareGlobal: prepareGlobal\n  }));\n\n  /*\n    AMD-compatible require\n    To copy RequireJS, set window.require = window.requirejs = loader.amdRequire\n  */\n  function require (names, callback, errback, referer) {\n    // in amd, first arg can be a config object... we just ignore\n    if (typeof names === 'object' && !(names instanceof Array))\n      return require.apply(null, Array.prototype.splice.call(arguments, 1, arguments.length - 1));\n\n    // amd require\n    if (typeof names === 'string' && typeof callback === 'function')\n      names = [names];\n    if (names instanceof Array) {\n      var dynamicRequires = [];\n      for (var i = 0; i < names.length; i++)\n        dynamicRequires.push(loader.import(names[i], referer));\n      Promise.all(dynamicRequires).then(function (modules) {\n        for (var i = 0; i < modules.length; i++)\n          modules[i] = modules[i].__useDefault ? modules[i].default : modules[i];\n        if (callback)\n          callback.apply(null, modules);\n      }, errback);\n    }\n\n    // commonjs require\n    else if (typeof names === 'string') {\n      var normalized = loader.decanonicalize(names, referer);\n      var module = loader.get(normalized);\n      if (!module)\n        throw new Error('Module not already loaded loading \"' + names + '\" as ' + normalized + (referer ? ' from \"' + referer + '\".' : '.'));\n      return module.__useDefault ? module.default : module;\n    }\n\n    else\n      throw new TypeError('Invalid require');\n  }\n\n  function define (name, deps, factory) {\n    if (typeof name !== 'string') {\n      factory = deps;\n      deps = name;\n      name = null;\n\n      if (curMetaDeps) {\n        deps = deps.concat(curMetaDeps);\n        curMetaDeps = undefined;\n      }\n    }\n\n    if (!(deps instanceof Array)) {\n      factory = deps;\n      deps = ['require', 'exports', 'module'].splice(0, factory.length);\n    }\n\n    if (typeof factory !== 'function')\n      factory = (function (factory) {\n        return function() { return factory; }\n      })(factory);\n\n    // remove system dependencies\n    var requireIndex, exportsIndex, moduleIndex;\n\n    if ((requireIndex = deps.indexOf('require')) !== -1) {\n\n      deps.splice(requireIndex, 1);\n\n      // only trace cjs requires for non-named\n      // named defines assume the trace has already been done\n      if (!name)\n        deps = deps.concat(amdGetCJSDeps(factory.toString(), requireIndex));\n    }\n\n    if ((exportsIndex = deps.indexOf('exports')) !== -1)\n      deps.splice(exportsIndex, 1);\n\n    if ((moduleIndex = deps.indexOf('module')) !== -1)\n      deps.splice(moduleIndex, 1);\n\n    function execute (req, exports, module) {\n      var depValues = [];\n      for (var i = 0; i < deps.length; i++)\n        depValues.push(req(deps[i]));\n\n      module.uri = module.id;\n\n      module.config = function () {};\n\n      // add back in system dependencies\n      if (moduleIndex !== -1)\n        depValues.splice(moduleIndex, 0, module);\n\n      if (exportsIndex !== -1)\n        depValues.splice(exportsIndex, 0, exports);\n\n      if (requireIndex !== -1) {\n        var contextualRequire = function (names, callback, errback) {\n          if (typeof names === 'string' && typeof callback !== 'function')\n            return req(names);\n          return require.call(loader, names, callback, errback, module.id);\n        };\n        contextualRequire.toUrl = function (name) {\n          return loader.normalizeSync(name, module.id);\n        };\n        depValues.splice(requireIndex, 0, contextualRequire);\n      }\n\n      // set global require to AMD require\n      var curRequire = global.require;\n      global.require = require;\n\n      var output = factory.apply(exportsIndex === -1 ? global : exports, depValues);\n\n      global.require = curRequire;\n\n      if (typeof output !== 'undefined')\n        module.exports = output;\n    }\n\n    // anonymous define\n    if (!name) {\n      loader.registerDynamic(deps, execute);\n    }\n    else {\n      loader.registerDynamic(name, deps, execute);\n\n      // if we don't have any other defines,\n      // then let this be an anonymous define\n      // this is just to support single modules of the form:\n      // define('jquery')\n      // still loading anonymously\n      // because it is done widely enough to be useful\n      // as soon as there is more than one define, this gets removed though\n      if (lastNamedDefine) {\n        lastNamedDefine = undefined;\n        multipleNamedDefines = true;\n      }\n      else if (!multipleNamedDefines) {\n        lastNamedDefine = [deps, execute];\n      }\n    }\n  }\n  define.amd = {};\n\n  loader.amdDefine = define;\n  loader.amdRequire = require;\n}\n\n// CJS\nif (typeof window !== 'undefined' && typeof document !== 'undefined' && window.location)\n  var windowOrigin = location.protocol + '//' + location.hostname + (location.port ? ':' + location.port : '');\n\nfunction stripOrigin(path) {\n  if (path.substr(0, 8) === 'file:///')\n    return path.substr(7 + !!isWindows);\n\n  if (windowOrigin && path.substr(0, windowOrigin.length) === windowOrigin)\n    return path.substr(windowOrigin.length);\n\n  return path;\n}\n\nexport function requireResolve (request, parentId) {\n  return stripOrigin(this.normalizeSync(request, parentId));\n}\n\nexport function getPathVars (moduleId) {\n  // remove any plugin syntax\n  var pluginIndex = moduleId.lastIndexOf('!');\n  var filename;\n  if (pluginIndex !== -1)\n    filename = moduleId.substr(0, pluginIndex);\n  else\n    filename = moduleId;\n\n  var dirname = filename.split('/');\n  dirname.pop();\n  dirname = dirname.join('/');\n\n  return {\n    filename: stripOrigin(filename),\n    dirname: stripOrigin(dirname)\n  };\n}\n\nvar commentRegEx = /(^|[^\\\\])(\\/\\*([\\s\\S]*?)\\*\\/|([^:]|^)\\/\\/(.*)$)/mg;\nvar stringRegEx = /(\"[^\"\\\\\\n\\r]*(\\\\.[^\"\\\\\\n\\r]*)*\"|'[^'\\\\\\n\\r]*(\\\\.[^'\\\\\\n\\r]*)*')/g;\n\n// used to support leading #!/usr/bin/env in scripts as supported in Node\nvar hashBangRegEx = /^\\#\\!.*/;\n\n// extract CJS dependencies from source text via regex static analysis\n// read require('x') statements not in comments or strings\nexport function getCJSDeps (source) {\n  cjsRequireRegEx.lastIndex = commentRegEx.lastIndex = stringRegEx.lastIndex = 0;\n\n  var deps = [];\n\n  var match;\n\n  // track string and comment locations for unminified source\n  var stringLocations = [], commentLocations = [];\n\n  function inLocation (locations, match) {\n    for (var i = 0; i < locations.length; i++)\n      if (locations[i][0] < match.index && locations[i][1] > match.index)\n        return true;\n    return false;\n  }\n\n  if (source.length / source.split('\\n').length < 200) {\n    while (match = stringRegEx.exec(source))\n      stringLocations.push([match.index, match.index + match[0].length]);\n\n    // TODO: track template literals here before comments\n\n    while (match = commentRegEx.exec(source)) {\n      // only track comments not starting in strings\n      if (!inLocation(stringLocations, match))\n        commentLocations.push([match.index + match[1].length, match.index + match[0].length - 1]);\n    }\n  }\n\n  while (match = cjsRequireRegEx.exec(source)) {\n    // ensure we're not within a string or comment location\n    if (!inLocation(stringLocations, match) && !inLocation(commentLocations, match)) {\n      var dep = match[1].substr(1, match[1].length - 2);\n      // skip cases like require('\" + file + \"')\n      if (dep.match(/\"|'/))\n        continue;\n      deps.push(dep);\n    }\n  }\n\n  return deps;\n}\n\n// Global\n// bare minimum ignores\nvar ignoredGlobalProps = ['_g', 'sessionStorage', 'localStorage', 'clipboardData', 'frames', 'frameElement', 'external',\n  'mozAnimationStartTime', 'webkitStorageInfo', 'webkitIndexedDB', 'mozInnerScreenY', 'mozInnerScreenX'];\n\nvar globalSnapshot;\nfunction globalIterator (globalName) {\n  if (ignoredGlobalProps.indexOf(globalName) !== -1)\n    return;\n  try {\n    var value = global[globalName];\n  }\n  catch (e) {\n    ignoredGlobalProps.push(globalName);\n  }\n  this(globalName, value);\n}\n\nexport function getGlobalValue (exports) {\n  if (typeof exports === 'string')\n    return readMemberExpression(exports, global);\n\n  if (!(exports instanceof Array))\n    throw new Error('Global exports must be a string or array.');\n\n  var globalValue = {};\n  for (var i = 0; i < exports.length; i++)\n    globalValue[exports[i].split('.').pop()] = readMemberExpression(exports[i], global);\n  return globalValue;\n}\n\nexport function prepareGlobal (moduleName, exports, globals, encapsulate) {\n  // disable module detection\n  var curDefine = global.define;\n\n  global.define = undefined;\n\n  // set globals\n  var oldGlobals;\n  if (globals) {\n    oldGlobals = {};\n    for (var g in globals) {\n      oldGlobals[g] = global[g];\n      global[g] = globals[g];\n    }\n  }\n\n  // store a complete copy of the global object in order to detect changes\n  if (!exports) {\n    globalSnapshot = {};\n\n    Object.keys(global).forEach(globalIterator, function (name, value) {\n      globalSnapshot[name] = value;\n    });\n  }\n\n  // return function to retrieve global\n  return function () {\n    var globalValue = exports ? getGlobalValue(exports) : {};\n\n    var singleGlobal;\n    var multipleExports = !!exports;\n\n    if (!exports || encapsulate)\n      Object.keys(global).forEach(globalIterator, function (name, value) {\n        if (globalSnapshot[name] === value)\n          return;\n        if (value === undefined)\n          return;\n\n        // allow global encapsulation where globals are removed\n        if (encapsulate)\n          global[name] = undefined;\n\n        if (!exports) {\n          globalValue[name] = value;\n\n          if (singleGlobal !== undefined) {\n            if (!multipleExports && singleGlobal !== value)\n              multipleExports = true;\n          }\n          else {\n            singleGlobal = value;\n          }\n        }\n      });\n\n    globalValue = multipleExports ? globalValue : singleGlobal;\n\n    // revert globals\n    if (oldGlobals) {\n      for (var g in oldGlobals)\n        global[g] = oldGlobals[g];\n    }\n    global.define = curDefine;\n\n    return globalValue;\n  };\n}\n\n// AMD\nvar cjsRequirePre = \"(?:^|[^$_a-zA-Z\\\\xA0-\\\\uFFFF.])\";\nvar cjsRequirePost = \"\\\\s*\\\\(\\\\s*(\\\"([^\\\"]+)\\\"|'([^']+)')\\\\s*\\\\)\";\nvar fnBracketRegEx = /\\(([^\\)]*)\\)/;\nvar wsRegEx = /^\\s+|\\s+$/g;\n\nvar requireRegExs = {};\n\nfunction amdGetCJSDeps(source, requireIndex) {\n\n  // remove comments\n  source = source.replace(commentRegEx, '');\n\n  // determine the require alias\n  var params = source.match(fnBracketRegEx);\n  var requireAlias = (params[1].split(',')[requireIndex] || 'require').replace(wsRegEx, '');\n\n  // find or generate the regex for this requireAlias\n  var requireRegEx = requireRegExs[requireAlias] || (requireRegExs[requireAlias] = new RegExp(cjsRequirePre + requireAlias + cjsRequirePost, 'g'));\n\n  requireRegEx.lastIndex = 0;\n\n  var deps = [];\n\n  var match;\n  while (match = requireRegEx.exec(source))\n    deps.push(match[2] || match[3]);\n\n  return deps;\n}\n\n// generate anonymous define from singular named define\nvar multipleNamedDefines = false;\nvar lastNamedDefine;\nvar curMetaDeps;\nexport function clearLastDefine (metaDeps) {\n  curMetaDeps = metaDeps;\n  lastNamedDefine = undefined;\n  multipleNamedDefines = false;\n}\nexport function registerLastDefine (loader) {\n  if (lastNamedDefine)\n    loader.registerDynamic(curMetaDeps ? lastNamedDefine[0].concat(curMetaDeps) : lastNamedDefine[0], lastNamedDefine[1]);\n\n  // bundles are an empty module\n  else if (multipleNamedDefines)\n    loader.registerDynamic([], function () {});\n}\n","import SystemJSLoader, { CONFIG, emptyModule, ModuleNamespace } from './systemjs-loader.js';\nimport { scriptLoad, isBrowser, isWorker, global, evaluate, cjsRequireRegEx, addToError, loadNodeModule, supportsScriptLoad, warn } from './common.js';\nimport fetch from './fetch.js';\nimport { getGlobalValue, getCJSDeps, requireResolve, getPathVars, prepareGlobal, clearLastDefine, registerLastDefine } from './format-helpers.js';\n\nexport function instantiate (key, metadata, processAnonRegister) {\n  var loader = this;\n  var config = this[CONFIG];\n  // first do bundles and depCache\n  return (loadBundlesAndDepCache(config, this, key) || Promise.resolve())\n  .then(function () {\n    if (metadata.registered)\n      return;\n\n    // node module loading\n    if (key.substr(0, 6) === '@node/') {\n      if (!loader._nodeRequire)\n        throw new TypeError('Error loading ' + key + '. Can only load node core modules in Node.');\n      loader.registerDynamic([], function (require, exports, module) {\n        module.exports = loadNodeModule.call(loader, key.substr(6), loader.baseURL);\n      });\n      processAnonRegister();\n      return;\n    }\n\n    if (metadata.load.scriptLoad ) {\n      if (metadata.load.pluginKey || !supportsScriptLoad) {\n        metadata.load.scriptLoad = false;\n        warn.call(config, 'scriptLoad not supported for \"' + key + '\"');\n      }\n    }\n    else if (metadata.load.scriptLoad !== false && supportsScriptLoad) {\n      // auto script load AMD, global without deps\n      if (!metadata.load.deps && !metadata.load.globals &&\n          (metadata.load.format === 'system' || metadata.load.format === 'register' || metadata.load.format === 'global' && metadata.load.exports))\n        metadata.load.scriptLoad = true;\n    }\n\n    // fetch / translate / instantiate pipeline\n    if (!metadata.load.scriptLoad)\n      return initializePlugin(loader, key, metadata)\n      .then(function () {\n        // modern plugin = load hook\n        if (metadata.pluginModule && typeof metadata.pluginModule.default === 'function')\n          return runPluginLoad(loader, metadata.pluginArgument, key, metadata, metadata.pluginKey, metadata.pluginModule);\n        return runFetchPipeline(loader, key, metadata, processAnonRegister, config.wasm);\n      })\n\n    // just script loading\n    return new Promise(function (resolve, reject) {\n      if (metadata.load.format === 'amd' && global.define !== loader.amdDefine)\n        throw new Error('Loading AMD with scriptLoad requires setting the global `' + globalName + '.define = SystemJS.amdDefine`');\n\n      scriptLoad(key, metadata.load.crossOrigin, metadata.load.integrity, function () {\n        processAnonRegister();\n\n        if (!metadata.registered) {\n          metadata.load.format = 'global';\n          var globalValue = getGlobalValue(metadata.load.exports);\n          loader.registerDynamic([], function (require, exports, module) {\n            module.exports = globalValue;\n          });\n          processAnonRegister();\n        }\n\n        resolve();\n      }, reject);\n    });\n  });\n};\n\nfunction initializePlugin (loader, key, metadata) {\n  if (!metadata.pluginKey)\n    return Promise.resolve();\n\n  return loader.import(metadata.pluginKey).then(function (plugin) {\n    metadata.pluginModule = plugin;\n    metadata.pluginLoad = {\n      name: key,\n      address: metadata.pluginArgument,\n      source: undefined,\n      metadata: metadata.load\n    };\n    metadata.load.deps = metadata.load.deps || [];\n  });\n}\n\nfunction protectedCreateNamespace (bindings) {\n  if (bindings instanceof ModuleNamespace)\n    return bindings;\n  if (typeof bindings !== 'object')\n    throw new TypeError('Cannot create a module namespace from an object of type \"' + typeof bindings + '\".');\n  return new ModuleNamespace(bindings);\n}\n\nfunction runPluginLoad (loader, key, registerKey, metadata, pluginKey, pluginModule) {\n  return Promise.resolve()\n  .then(function () {\n    return pluginModule.default.call(loader, key, registerKey);\n  })\n  .then(function (pluginResult) {\n    if (pluginResult === undefined)\n      return metadata.registered ? pluginResult : emptyModule;\n    return protectedCreateNamespace(pluginResult);\n  })\n  .catch(function (err) {\n    throw addToError(err, 'Error running instantiate plugin ' + pluginKey);\n  });\n}\n\nfunction loadBundlesAndDepCache (config, loader, key) {\n  // load direct deps, in turn will pick up their trace trees\n  var deps = config.depCache[key];\n  if (deps) {\n    for (var i = 0; i < deps.length; i++)\n      loader.load(deps[i], key);\n  }\n  else {\n    var matched = false;\n    for (var b in config.bundles) {\n      for (var i = 0; i < config.bundles[b].length; i++) {\n        var curModule = config.bundles[b][i];\n\n        if (curModule == key) {\n          matched = true;\n          break;\n        }\n\n        // wildcard in bundles does not include / boundaries\n        if (curModule.indexOf('*') != -1) {\n          var parts = curModule.split('*');\n          if (parts.length != 2) {\n            config.bundles[b].splice(i--, 1);\n            continue;\n          }\n\n          if (key.substring(0, parts[0].length) == parts[0] &&\n              key.substr(key.length - parts[1].length, parts[1].length) == parts[1] &&\n              key.substr(parts[0].length, key.length - parts[1].length - parts[0].length).indexOf('/') == -1) {\n            matched = true;\n            break;\n          }\n        }\n      }\n\n      if (matched)\n        return loader.import(b);\n    }\n  }\n}\n\nfunction runFetchPipeline (loader, key, metadata, processAnonRegister, wasm) {\n  if (metadata.load.exports && !metadata.load.format)\n    metadata.load.format = 'global';\n\n  return Promise.resolve()\n\n  // locate\n  .then(function () {\n    if (!metadata.pluginModule || !metadata.pluginModule.locate)\n      return;\n\n    return metadata.pluginModule.locate.call(loader, metadata.pluginLoad)\n    .then(function (address) {\n      if (address)\n        metadata.pluginLoad.address = address;\n    });\n  })\n\n  // fetch\n  .then(function () {\n    if (!metadata.pluginModule)\n      return fetch(key, metadata.load.authorization, metadata.load.integrity, wasm);\n\n    if (!metadata.pluginModule.fetch)\n      return fetch(metadata.pluginArgument, metadata.load.authorization, metadata.load.integrity, wasm);\n\n    wasm = false;\n    return metadata.pluginModule.fetch.call(loader, metadata.pluginLoad, function (load) {\n      return fetch(load.address, metadata.load.authorization, metadata.load.integrity, false);\n    });\n  })\n\n  .then(function (fetched) {\n    // fetch is already a utf-8 string if not doing wasm detection\n    if (!wasm)\n      return translateAndInstantiate(loader, key, fetched, metadata, processAnonRegister);\n\n    var bytes = new Uint8Array(fetched);\n\n    // detect by leading bytes\n    if (bytes[0] === 0 && bytes[1] === 97 && bytes[2] === 115) {\n      return WebAssembly.compile(bytes).then(function (m) {\n        /* TODO handle imports when `WebAssembly.Module.imports` is implemented\n        if (WebAssembly.Module.imports) {\n          var deps = [];\n          var setters = [];\n          var importObj = {};\n          WebAssembly.Module.imports(m).forEach(function (i) {\n            var key = i.module;\n            setters.push(function (m) {\n              importObj[key] = m;\n            });\n            if (deps.indexOf(key) === -1)\n              deps.push(key);\n          });\n          loader.register(deps, function (_export) {\n            return {\n              setters: setters,\n              execute: function () {\n                _export(new WebAssembly.Instance(m, importObj).exports);\n              }\n            };\n          });\n        }*/\n        // for now we just load WASM without dependencies\n        var wasmModule = new WebAssembly.Instance(m, {});\n        return loader.newModule(wasmModule.exports);\n      });\n    }\n\n    // not wasm -> convert buffer into utf-8 string to execute as a module\n    // TextDecoder compatibility matches WASM currently. Need to keep checking this.\n    // The TextDecoder interface is documented at http://encoding.spec.whatwg.org/#interface-textdecoder\n    var stringSource = new TextDecoder('utf-8').decode(bytes);\n    return translateAndInstantiate(loader, key, stringSource, metadata, processAnonRegister);\n  })\n}\n\nfunction translateAndInstantiate (loader, key, source, metadata, processAnonRegister) {\n  return Promise.resolve(source)\n  // translate\n  .then(function (source) {\n    if (metadata.load.format === 'detect')\n      metadata.load.format = undefined;\n\n    readMetaSyntax(source, metadata);\n\n    if (!metadata.pluginModule || !metadata.pluginModule.translate)\n      return source;\n\n    metadata.pluginLoad.source = source;\n    return Promise.resolve(metadata.pluginModule.translate.call(loader, metadata.pluginLoad, metadata.traceOpts))\n    .then(function (translated) {\n      if (metadata.load.sourceMap) {\n        if (typeof metadata.load.sourceMap !== 'object')\n          throw new Error('metadata.load.sourceMap must be set to an object.');\n        sanitizeSourceMap(metadata.pluginLoad.address, metadata.load.sourceMap);\n      }\n\n      if (typeof translated === 'string')\n        return translated;\n      else\n        return metadata.pluginLoad.source;\n    });\n  })\n  .then(function (source) {\n    if (metadata.load.format === 'register' || !metadata.load.format && detectRegisterFormat(source)) {\n      metadata.load.format = 'register';\n      return source;\n    }\n\n    if (metadata.load.format !== 'esm' && (metadata.load.format || !source.match(esmRegEx))) {\n      return source;\n    }\n\n    metadata.load.format = 'esm';\n    return transpile(loader, source, key, metadata);\n  })\n\n  // instantiate\n  .then(function (translated) {\n    if (typeof translated !== 'string' || !metadata.pluginModule || !metadata.pluginModule.instantiate)\n      return translated;\n\n    var calledInstantiate = false;\n    metadata.pluginLoad.source = translated;\n    return Promise.resolve(metadata.pluginModule.instantiate.call(loader, metadata.pluginLoad, function (load) {\n      translated = load.source;\n      metadata.load = load.metadata;\n      if (calledInstantiate)\n        throw new Error('Instantiate must only be called once.');\n      calledInstantiate = true;\n    }))\n    .then(function (result) {\n      if (calledInstantiate)\n        return translated;\n      return protectedCreateNamespace(result);\n    });\n  })\n  .then(function (source) {\n    // plugin instantiate result case\n    if (typeof source !== 'string')\n      return source;\n\n    if (!metadata.load.format)\n      metadata.load.format = detectLegacyFormat(source);\n\n    switch (metadata.load.format) {\n      case 'esm':\n      case 'register':\n      case 'system':\n        var err = evaluate(loader, source, metadata.load.sourceMap, key, metadata.load.integrity, metadata.load.nonce, false);\n        if (err)\n          throw err;\n        processAnonRegister();\n\n        if (!metadata.registered)\n          return emptyModule;\n      break;\n\n      case 'json':\n        // warn.call(config, '\"json\" module format is deprecated.');\n        return loader.newModule({ default: JSON.parse(source), __useDefault: true });\n\n      case 'amd':\n        var curDefine = global.define;\n        global.define = loader.amdDefine;\n\n        clearLastDefine(metadata.load.deps);\n\n        var err = evaluate(loader, source, metadata.load.sourceMap, key, metadata.load.integrity, metadata.load.nonce, false);\n\n        processAnonRegister();\n\n        // if didn't register anonymously, use the last named define if only one\n        if (!metadata.registered) {\n          registerLastDefine(loader);\n          processAnonRegister();\n        }\n\n        global.define = curDefine;\n\n        if (err)\n          throw err;\n      break;\n\n      case 'cjs':\n        var metaDeps = metadata.load.deps;\n        var deps = (metadata.load.deps || []).concat(metadata.load.cjsRequireDetection ? getCJSDeps(source) : []);\n\n        for (var g in metadata.load.globals)\n          if (metadata.load.globals[g])\n            deps.push(metadata.load.globals[g]);\n\n        loader.registerDynamic(deps, function (require, exports, module) {\n          require.resolve = function (key) {\n            return requireResolve.call(loader, key, module.id);\n          };\n          // support module.paths ish\n          module.paths = [];\n          module.require = require;\n\n          // ensure meta deps execute first\n          if (!metadata.load.cjsDeferDepsExecute && metaDeps)\n            for (var i = 0; i < metaDeps.length; i++)\n              require(metaDeps[i]);\n\n          var pathVars = getPathVars(module.id);\n          var __cjsWrapper = {\n            exports: exports,\n            args: [require, exports, module, pathVars.filename, pathVars.dirname, global, global]\n          };\n\n          var cjsWrapper = \"(function (require, exports, module, __filename, __dirname, global, GLOBAL\";\n\n          // add metadata.globals to the wrapper arguments\n          if (metadata.load.globals)\n            for (var g in metadata.load.globals) {\n              __cjsWrapper.args.push(require(metadata.load.globals[g]));\n              cjsWrapper += \", \" + g;\n            }\n\n          // disable AMD detection\n          var define = global.define;\n          global.define = undefined;\n          global.__cjsWrapper = __cjsWrapper;\n\n          source = cjsWrapper + \") {\" + source.replace(hashBangRegEx, '') + \"\\n}).apply(__cjsWrapper.exports, __cjsWrapper.args);\";\n\n          var err = evaluate(loader, source, metadata.load.sourceMap, key, metadata.load.integrity, metadata.load.nonce, false);\n          if (err)\n            throw err;\n\n          global.__cjsWrapper = undefined;\n          global.define = define;\n        });\n        processAnonRegister();\n      break;\n\n      case 'global':\n        var deps = metadata.load.deps || [];\n        for (var g in metadata.load.globals) {\n          var gl = metadata.load.globals[g];\n          if (gl)\n            deps.push(gl);\n        }\n\n        loader.registerDynamic(deps, function (require, exports, module) {\n          for (var i = 0; i < deps.length; i++)\n            require(deps[i]);\n\n          var globals;\n          if (metadata.load.globals) {\n            globals = {};\n            for (var g in metadata.load.globals)\n              if (metadata.load.globals[g])\n                globals[g] = require(metadata.load.globals[g]);\n          }\n\n          var exportName = metadata.load.exports;\n\n          if (exportName)\n            source += '\\n' + globalName + '[\"' + exportName + '\"] = ' + exportName + ';';\n\n          var retrieveGlobal = prepareGlobal(module.id, exportName, globals, metadata.load.encapsulateGlobal);\n          var err = evaluate(loader, source, metadata.load.sourceMap, key, metadata.load.integrity, metadata.load.nonce, true);\n\n          if (err)\n            throw err;\n\n          module.exports = retrieveGlobal();\n        });\n        processAnonRegister();\n      break;\n\n      default:\n        throw new TypeError('Unknown module format \"' + metadata.load.format + '\" for \"' + key + '\".' + (metadata.load.format === 'es6' ? ' Use \"esm\" instead here.' : ''));\n    }\n\n    if (!metadata.registered)\n      throw new Error('Module ' + key + ' detected as ' + metadata.load.format + ' but didn\\'t execute correctly.');\n  });\n}\n\nvar globalName = typeof self != 'undefined' ? 'self' : 'global';\n\n// good enough ES6 module detection regex - format detections not designed to be accurate, but to handle the 99% use case\nexport var esmRegEx = /(^\\s*|[}\\);\\n]\\s*)(import\\s*(['\"]|(\\*\\s+as\\s+)?[^\"'\\(\\)\\n;]+\\s*from\\s*['\"]|\\{)|export\\s+\\*\\s+from\\s+[\"']|export\\s*(\\{|default|function|class|var|const|let|async\\s+function))/;\n\nvar leadingCommentAndMetaRegEx = /^(\\s*\\/\\*[^\\*]*(\\*(?!\\/)[^\\*]*)*\\*\\/|\\s*\\/\\/[^\\n]*|\\s*\"[^\"]+\"\\s*;?|\\s*'[^']+'\\s*;?)*\\s*/;\nexport function detectRegisterFormat(source) {\n  var leadingCommentAndMeta = source.match(leadingCommentAndMetaRegEx);\n  return leadingCommentAndMeta && source.substr(leadingCommentAndMeta[0].length, 15) === 'System.register';\n}\n\n// AMD Module Format Detection RegEx\n// define([.., .., ..], ...)\n// define(varName); || define(function(require, exports) {}); || define({})\nvar amdRegEx = /(?:^\\uFEFF?|[^$_a-zA-Z\\xA0-\\uFFFF.])define\\s*\\(\\s*(\"[^\"]+\"\\s*,\\s*|'[^']+'\\s*,\\s*)?\\s*(\\[(\\s*((\"[^\"]+\"|'[^']+')\\s*,|\\/\\/.*\\r?\\n|\\/\\*(.|\\s)*?\\*\\/))*(\\s*(\"[^\"]+\"|'[^']+')\\s*,?)?(\\s*(\\/\\/.*\\r?\\n|\\/\\*(.|\\s)*?\\*\\/))*\\s*\\]|function\\s*|{|[_$a-zA-Z\\xA0-\\uFFFF][_$a-zA-Z0-9\\xA0-\\uFFFF]*\\))/;\n\n/// require('...') || exports[''] = ... || exports.asd = ... || module.exports = ...\nvar cjsExportsRegEx = /(?:^\\uFEFF?|[^$_a-zA-Z\\xA0-\\uFFFF.])(exports\\s*(\\[['\"]|\\.)|module(\\.exports|\\['exports'\\]|\\[\"exports\"\\])\\s*(\\[['\"]|[=,\\.]))/;\nvar commentRegEx = /(^|[^\\\\])(\\/\\*([\\s\\S]*?)\\*\\/|([^:]|^)\\/\\/(.*)$)/mg;\n\nvar stringRegEx = /(\"[^\"\\\\\\n\\r]*(\\\\.[^\"\\\\\\n\\r]*)*\"|'[^'\\\\\\n\\r]*(\\\\.[^'\\\\\\n\\r]*)*')/g;\n\n// used to support leading #!/usr/bin/env in scripts as supported in Node\nvar hashBangRegEx = /^\\#\\!.*/;\n\nexport function detectLegacyFormat (source) {\n  if (source.match(amdRegEx))\n    return 'amd';\n\n  cjsExportsRegEx.lastIndex = 0;\n  cjsRequireRegEx.lastIndex = 0;\n  if (cjsRequireRegEx.exec(source) || cjsExportsRegEx.exec(source))\n    return 'cjs';\n\n  // global is the fallback format\n  return 'global';\n}\n\nfunction sanitizeSourceMap (address, sourceMap) {\n  var originalName = address.split('!')[0];\n\n  // force set the filename of the original file\n  if (!sourceMap.file || sourceMap.file == address)\n    sourceMap.file = originalName + '!transpiled';\n\n  // force set the sources list if only one source\n  if (!sourceMap.sources || sourceMap.sources.length <= 1 && (!sourceMap.sources[0] || sourceMap.sources[0] === address))\n    sourceMap.sources = [originalName];\n}\n\nfunction transpile (loader, source, key, metadata) {\n  if (!loader.transpiler)\n    throw new TypeError('Unable to dynamically transpile ES module\\n   A loader plugin needs to be configured via `SystemJS.config({ transpiler: \\'transpiler-module\\' })`.');\n\n  // deps support for es transpile\n  if (metadata.load.deps) {\n    var depsPrefix = '';\n    for (var i = 0; i < metadata.load.deps.length; i++)\n      depsPrefix += 'import \"' + metadata.load.deps[i] + '\"; ';\n    source = depsPrefix + source;\n  }\n\n  // do transpilation\n  return loader.import.call(loader, loader.transpiler)\n  .then(function (transpiler) {\n    if (typeof transpiler.default === 'function')\n      return runPluginLoad(loader, key, key, metadata, loader.transpiler, transpiler);\n\n    if (transpiler.__useDefault)\n      transpiler = transpiler.default;\n\n    // translate hooks means this is a transpiler plugin instead of a raw implementation\n    if (!transpiler.translate)\n      throw new Error('Unable to load transpiler, ensure the SystemJS.transpiler is configured to a transpiler plugin.');\n\n    // if transpiler is the same as the plugin loader, then don't run twice\n    if (transpiler === metadata.pluginModule)\n      return load.source;\n\n    // convert the source map into an object for transpilation chaining\n    if (typeof metadata.load.sourceMap === 'string')\n      metadata.load.sourceMap = JSON.parse(metadata.load.sourceMap);\n\n    metadata.pluginLoad = metadata.pluginLoad || {\n      name: key,\n      address: key,\n      source: source,\n      metadata: metadata.load\n    };\n    metadata.load.deps = metadata.load.deps || [];\n\n    return Promise.resolve(transpiler.translate.call(loader, metadata.pluginLoad, metadata.traceOpts))\n    .then(function (source) {\n      // sanitize sourceMap if an object not a JSON string\n      var sourceMap = metadata.load.sourceMap;\n      if (sourceMap && typeof sourceMap === 'object')\n        sanitizeSourceMap(key, sourceMap);\n\n      if (metadata.load.format === 'esm' && detectRegisterFormat(source))\n        metadata.load.format = 'register';\n\n      return source;\n    });\n  }, function (err) {\n    throw addToError(err, 'Unable to load transpiler to transpile ' + key);\n  });\n}\n\n// detect any meta header syntax\n// only set if not already set\nvar metaRegEx = /^(\\s*\\/\\*[^\\*]*(\\*(?!\\/)[^\\*]*)*\\*\\/|\\s*\\/\\/[^\\n]*|\\s*\"[^\"]+\"\\s*;?|\\s*'[^']+'\\s*;?)+/;\nvar metaPartRegEx = /\\/\\*[^\\*]*(\\*(?!\\/)[^\\*]*)*\\*\\/|\\/\\/[^\\n]*|\"[^\"]+\"\\s*;?|'[^']+'\\s*;?/g;\n\nfunction setMetaProperty(target, p, value) {\n  var pParts = p.split('.');\n  var curPart;\n  while (pParts.length > 1) {\n    curPart = pParts.shift();\n    target = target[curPart] = target[curPart] || {};\n  }\n  curPart = pParts.shift();\n  if (target[curPart] === undefined)\n    target[curPart] = value;\n}\n\nfunction readMetaSyntax (source, metadata) {\n  var meta = source.match(metaRegEx);\n  if (!meta)\n    return;\n\n  var metaParts = meta[0].match(metaPartRegEx);\n\n  for (var i = 0; i < metaParts.length; i++) {\n    var curPart = metaParts[i];\n    var len = curPart.length;\n\n    var firstChar = curPart.substr(0, 1);\n    if (curPart.substr(len - 1, 1) == ';')\n      len--;\n\n    if (firstChar != '\"' && firstChar != \"'\")\n      continue;\n\n    var metaString = curPart.substr(1, curPart.length - 3);\n    var metaName = metaString.substr(0, metaString.indexOf(' '));\n\n    if (metaName) {\n      var metaValue = metaString.substr(metaName.length + 1, metaString.length - metaName.length - 1);\n\n      if (metaName === 'deps')\n        metaName = 'deps[]';\n\n      if (metaName.substr(metaName.length - 2, 2) === '[]') {\n        metaName = metaName.substr(0, metaName.length - 2);\n        metadata.load[metaName] = metadata.load[metaName] || [];\n        metadata.load[metaName].push(metaValue);\n      }\n      // \"use strict\" is not meta\n      else if (metaName !== 'use') {\n        setMetaProperty(metadata.load, metaName, metaValue);\n      }\n    }\n    else {\n      metadata.load[metaString] = true;\n    }\n  }\n}\n","import { ModuleNamespace } from 'es-module-loader/core/loader-polyfill.js';\nimport RegisterLoader from 'es-module-loader/core/register-loader.js';\nimport { warn, nodeRequire, scriptSrc, isBrowser, global, createSymbol, baseURI } from './common.js';\n\nimport { getConfig, getConfigItem, setConfig } from './config.js';\nimport { decanonicalize, normalize, normalizeSync } from './resolve.js';\nimport { instantiate } from './instantiate.js';\nimport formatHelpers from './format-helpers.js';\n\nexport { ModuleNamespace }\n\nexport default SystemJSLoader;\n\nfunction SystemJSLoader (baseKey) {\n  RegisterLoader.call(this, baseKey);\n\n  // NB deprecate\n  this._loader = {};\n\n  // internal configuration\n  this[CONFIG] = {\n    // this means paths normalization has already happened\n    pathsLocked: false,\n\n    baseURL: baseURI,\n    paths: {},\n\n    packageConfigPaths: [],\n    packageConfigKeys: [],\n    map: {},\n    packages: {},\n    depCache: {},\n    meta: {},\n    bundles: {},\n\n    production: false,\n\n    transpiler: undefined,\n    loadedBundles: {},\n\n    // global behaviour flags\n    warnings: false,\n    pluginFirst: false,\n\n    // enable wasm loading and detection when supported\n    wasm: false\n  };\n\n  // make the location of the system.js script accessible (if any)\n  this.scriptSrc = scriptSrc;\n\n  this._nodeRequire = nodeRequire;\n\n  // support the empty module, as a concept\n  this.set('@empty', emptyModule = this.newModule({}));\n\n  setProduction.call(this, false, false);\n\n  // add module format helpers\n  formatHelpers(this);\n}\n\nexport var emptyModule;\n\nexport var envModule;\nexport function setProduction (isProduction, isBuilder) {\n  this[CONFIG].production = isProduction;\n  this.set('@system-env', envModule = this.newModule({\n    browser: isBrowser,\n    node: !!this._nodeRequire,\n    production: !isBuilder && isProduction,\n    dev: isBuilder || !isProduction,\n    build: isBuilder,\n    'default': true\n  }));\n}\n\nexport var CONFIG = createSymbol('loader-config');\nexport var CREATE_METADATA = SystemJSLoader.createMetadata = RegisterLoader.createMetadata;\nvar RESOLVE = SystemJSLoader.resolve = RegisterLoader.resolve;\nvar INSTANTIATE = SystemJSLoader.instantiate = RegisterLoader.instantiate;\n\nSystemJSLoader.prototype = Object.create(RegisterLoader.prototype);\n\nSystemJSLoader.prototype.constructor = SystemJSLoader;\n\nSystemJSLoader.prototype[CREATE_METADATA] = function () {\n  return {\n    registered: false,\n    pluginKey: undefined,\n    pluginArgument: undefined,\n    pluginModule: undefined,\n    packageKey: undefined,\n    packageConfig: undefined,\n    load: undefined\n  };\n};\n\nSystemJSLoader.prototype[RESOLVE] = normalize;\n\n// NB deprecate decanonicalize\nSystemJSLoader.prototype.decanonicalize = SystemJSLoader.prototype.normalizeSync = normalizeSync;\n\nSystemJSLoader.prototype[INSTANTIATE] = instantiate;\n\nSystemJSLoader.prototype.config = setConfig;\nSystemJSLoader.prototype.getConfig = getConfig;\n\nSystemJSLoader.prototype.global = global;\n\nexport var configNames = ['baseURL', 'map', 'paths', 'packages', 'packageConfigPaths', 'depCache', 'meta', 'bundles', 'transpiler', 'warnings', 'pluginFirst', 'production'];\n\nvar hasProxy = typeof Proxy !== 'undefined';\nfor (var i = 0; i < configNames.length; i++) (function (configName) {\n  Object.defineProperty(SystemJSLoader.prototype, configName, {\n    get: function () {\n      var cfg = getConfigItem(this[CONFIG], configName);\n\n      if (hasProxy && typeof cfg === 'object')\n        cfg = new Proxy(cfg, {\n          set: function (target, option) {\n            throw new Error('Cannot set SystemJS.' + configName + '[\"' + option + '\"] directly. Use SystemJS.config({ ' + configName + ': { \"' + option + '\": ... } }) rather.');\n          }\n        });\n\n      //if (typeof cfg === 'object')\n      //  warn.call(this[CONFIG], 'Referencing `SystemJS.' + configName + '` is deprecated. Use the config getter `SystemJS.getConfig(\\'' + configName + '\\')`');\n      return cfg;\n    },\n    set: function (name) {\n      throw new Error('Setting `SystemJS.' + configName + '` directly is no longer supported. Use `SystemJS.config({ ' + configName + ': ... })`.');\n    }\n  });\n})(configNames[i]);\n\n/*\n * Backwards-compatible registry API, to be deprecated\n */\n/* function registryWarn(loader, method) {\n  warn.call(loader, 'SystemJS.' + method + ' is deprecated for SystemJS.registry.' + method);\n} */\nSystemJSLoader.prototype.delete = function (key) {\n  // registryWarn(this, 'delete');\n  this.registry.delete(key);\n};\nSystemJSLoader.prototype.get = function (key) {\n  // registryWarn(this, 'get');\n  return this.registry.get(key);\n};\nSystemJSLoader.prototype.has = function (key) {\n  // registryWarn(this, 'has');\n  return this.registry.has(key);\n};\nSystemJSLoader.prototype.set = function (key, module) {\n  // registryWarn(this, 'set');\n  return this.registry.set(key, module);\n};\nSystemJSLoader.prototype.newModule = function (bindings) {\n  return new ModuleNamespace(bindings);\n};\n\n// ensure System.register and System.registerDynamic decanonicalize\nSystemJSLoader.prototype.register = function (key, deps, declare) {\n  if (typeof key === 'string')\n    key = decanonicalize.call(this, this[CONFIG], key);\n  return RegisterLoader.prototype.register.call(this, key, deps, declare);\n};\n\nSystemJSLoader.prototype.registerDynamic = function (key, deps, executingRequire, execute) {\n  if (typeof key === 'string')\n    key = decanonicalize.call(this, this[CONFIG], key);\n  return RegisterLoader.prototype.registerDynamic.call(this, key, deps, executingRequire, execute);\n};\n","import { global, isBrowser } from './common.js';\nimport SystemJSLoader from './systemjs-loader.js';\n\nSystemJSLoader.prototype.version = VERSION;\n\nvar System = new SystemJSLoader();\n\nglobal.System = global.SystemJS = System;\n\nif (typeof module !== 'undefined' && module.exports)\n  module.exports = System;\n"]}