!function(t){"use strict";jcf.addModule({name:"Range",selector:'input[type="range"]',options:{realElementClass:"jcf-real-element",fakeStructure:'<span class="jcf-range"><span class="jcf-range-wrapper"><span class="jcf-range-track"><span class="jcf-range-handle"></span></span></span></span>',dataListMark:'<span class="jcf-range-mark"></span>',dragValueDisplay:'<span class="jcf-drag-value"></span>',handleSelector:".jcf-range-handle",trackSelector:".jcf-range-track",verticalClass:"jcf-vertical",orientation:"horizontal",dragHandleCenter:!0,snapToMarks:!0,snapRadius:5},matchElement:function(t){return t.is(this.selector)},init:function(){this.initStructure(),this.attachEvents(),this.refresh()},initStructure:function(){this.page=t("html"),this.realElement=t(this.options.element).addClass(this.options.hiddenClass),this.fakeElement=t(this.options.fakeStructure).insertBefore(this.realElement).prepend(this.realElement),this.track=this.fakeElement.find(this.options.trackSelector),this.handle=this.fakeElement.find(this.options.handleSelector),this.isVertical="vertical"===this.options.orientation,this.directionProperty=this.isVertical?"top":"left",this.offsetProperty=this.isVertical?"bottom":"left",this.eventProperty=this.isVertical?"pageY":"pageX",this.sizeMethod=this.isVertical?"innerHeight":"innerWidth",this.fakeElement.css("touchAction",this.isVertical?"pan-x":"pan-y"),this.isVertical&&this.fakeElement.addClass(this.options.verticalClass),this.minValue=parseFloat(this.realElement.attr("min")),this.maxValue=parseFloat(this.realElement.attr("max")),this.stepValue=parseFloat(this.realElement.attr("step"))||1,this.minValue=isNaN(this.minValue)?0:this.minValue,this.maxValue=isNaN(this.maxValue)?100:this.maxValue,1!==this.stepValue&&(this.maxValue-=(this.maxValue-this.minValue)%this.stepValue),this.stepsCount=(this.maxValue-this.minValue)/this.stepValue+1,this.createDataList()},attachEvents:function(){this.realElement.on({focus:this.onFocus}),this.handle.on("jcf-pointerdown",this.onPress)},createDataList:function(){var e=this,s=[],a=this.realElement.attr("list");a&&(t("#"+a).find("option").each(function(){var a,i,n=parseFloat(this.value||this.innerHTML);isNaN(n)||(i=e.valueToOffset(n),s.push({value:n,offset:i}),a=t(e.options.dataListMark).text(n).attr({"data-mark-value":n}).css(e.offsetProperty,i+"%").appendTo(e.track))}),s.length&&(e.dataValues=s))},onPress:function(t){var e,s,a;t.preventDefault(),this.realElement.is(":disabled")||(e=this.track[this.sizeMethod](),s=this.track.offset()[this.directionProperty],a=this.options.dragHandleCenter?this.handle[this.sizeMethod]()/2:t[this.eventProperty]-this.handle.offset()[this.directionProperty],this.dragData={trackSize:e,innerOffset:a,trackOffset:s,min:s,max:s+e},this.page.on({"jcf-pointermove":this.onMove,"jcf-pointerup":this.onRelease}),"mouse"===t.pointerType&&this.realElement.focus())},onMove:function(e){var s,a,i,n,r=this;if(s=this.isVertical?this.dragData.max+(this.dragData.min-e[this.eventProperty])-this.dragData.innerOffset:e[this.eventProperty]-this.dragData.innerOffset,s<this.dragData.min?s=this.dragData.min:s>this.dragData.max&&(s=this.dragData.max),e.preventDefault(),this.options.snapToMarks&&this.dataValues){var h=s-this.dragData.trackOffset;a=(s-this.dragData.trackOffset)/this.dragData.trackSize*100,t.each(this.dataValues,function(t,e){var s=e.offset/100*r.dragData.trackSize,i=s-r.options.snapRadius,n=s+r.options.snapRadius;return h>=i&&n>=h?(a=e.offset,!1):void 0})}else a=(s-this.dragData.trackOffset)/this.dragData.trackSize*100;i=Math.round(a*this.stepsCount/100),n=i*(100/this.stepsCount),this.dragData.stepIndex!==i&&(this.dragData.stepIndex=i,this.dragData.offset=n,this.handle.css(this.offsetProperty,this.dragData.offset+"%"))},onRelease:function(){var t;"number"==typeof this.dragData.offset&&(t=this.stepIndexToValue(this.dragData.stepIndex),this.realElement.val(t).trigger("change")),this.page.off({"jcf-pointermove":this.onMove,"jcf-pointerup":this.onRelease}),delete this.dragData},onFocus:function(){this.fakeElement.addClass(this.options.focusClass),this.realElement.on({blur:this.onBlur,keydown:this.onKeyPress})},onBlur:function(){this.fakeElement.removeClass(this.options.focusClass),this.realElement.off({blur:this.onBlur,keydown:this.onKeyPress})},onKeyPress:function(t){var e=38===t.which||39===t.which,s=37===t.which||40===t.which;(s||e)&&(t.preventDefault(),this.step(e?this.stepValue:-this.stepValue))},step:function(t){var e=parseFloat(this.realElement.val()),s=e;isNaN(e)&&(s=0),s+=t,s>this.maxValue?s=this.maxValue:s<this.minValue&&(s=this.minValue),s!==e&&(this.realElement.val(s).trigger("change"),this.setSliderValue(s))},stepIndexToValue:function(t){return this.minValue+this.stepValue*t},valueToOffset:function(t){var e=this.maxValue-this.minValue,s=(t-this.minValue)/e;return 100*s},setSliderValue:function(t){this.handle.css(this.offsetProperty,this.valueToOffset(t)+"%")},refresh:function(){var t=this.realElement.is(":disabled");this.fakeElement.toggleClass(this.options.disabledClass,t);var e=parseFloat(this.realElement.val())||0;this.setSliderValue(e)},destroy:function(){this.realElement.removeClass(this.options.hiddenClass).insertBefore(this.fakeElement),this.fakeElement.remove(),this.realElement.off({keydown:this.onKeyPress,focus:this.onFocus,blur:this.onBlur})}})}(jQuery);
//# sourceMappingURL=jcf.range.min.js.map