/*!
*  angular-mapboxgl-directive 0.25.0 2017-01-14
*  An AngularJS directive for Mapbox GL
*  git: git+https://github.com/Naimikan/angular-mapboxgl-directive.git
*/
!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){!function(a,b,c){"use strict";a.module("mapboxgl-directive",[]).directive("mapboxgl",["$q","mapboxglUtils","mapboxglConstants","mapboxglEventsUtils","mapboxglMapsData",function(c,d,e,f,g){function h(a){this._mapboxGlMap=c.defer(),this._geojsonObjects=[],this._imageObjects=[],this._videoObjects=[],this._markerObjects=[],this._persistentGeojson=e.map.defaultPersistentGeojson,this._persistentImage=e.map.defaultPersistentImage,this._persistentVideo=e.map.defaultPersistentVideo,this._elementDOM=null,this.getMap=function(){return this._mapboxGlMap.promise},this.getMapboxGlScope=function(){return a},this.getDOMElement=function(){return this._elementDOM},this.setDOMElement=function(a){this._elementDOM=a},this.getGeojsonObjects=function(){return this._geojsonObjects},this.addGeojsonObject=function(a){this._geojsonObjects.push(a)},this.removeGeojsonObjects=function(){this._geojsonObjects=[]},this.getImageObjects=function(){return this._imageObjects},this.addImageObject=function(a){this._imageObjects.push(a)},this.removeImageObjects=function(){this._imageObjects=[]},this.getVideoObjects=function(){return this._videoObjects},this.addVideoObject=function(a){this._videoObjects.push(a)},this.removeVideoObjects=function(){this._videoObjects=[]},this.getMarkerObjects=function(){return this._markerObjects},this.addMarkerObject=function(a){this._markerObjects.push(a)},this.removeMarkerObjects=function(){this._markerObjects=[]},this.isGeojsonPersistent=function(){return this._persistentGeojson},this.setPersistentGeojson=function(a){this._persistentGeojson=a},this.isImagePersistent=function(){return this._persistentImage},this.setPersistentImage=function(a){this._persistentImage=a},this.isVideoPersistent=function(){return this._persistentVideo},this.setPersistentVideo=function(a){this._persistentVideo=a},this.changeLoadingMap=function(a){a?this._elementDOM.hasClass("angular-mapboxgl-map-loading")||(this.getMap().then(function(a){a.getCanvas().style.opacity=.25}),this._elementDOM.addClass("angular-mapboxgl-map-loading")):this._elementDOM.hasClass("angular-mapboxgl-map-loading")&&(this.getMap().then(function(a){a.getCanvas().style.opacity=1}),this._elementDOM.removeClass("angular-mapboxgl-map-loading"))}}function i(c,h,i,j){if(!b)throw new Error("Mapbox GL does not included");if(!b.accessToken){if(!(a.isDefined(i.accessToken)&&i.accessToken.length>0))throw new Error("Mapbox access token does not defined");b.accessToken=i.accessToken}if(!b.supported())throw new Error("Your browser does not support Mapbox GL");j.setDOMElement(h),c.mapboxglMapId=i.id?i.id:d.generateMapId(),h.attr("id",c.mapboxglMapId);var k=function(a){isNaN(i.width)?h.css("width",i.width):h.css("width",i.width+"px"),a.resize()},l=function(a){isNaN(i.height)?h.css("height",i.height):h.css("height",i.height+"px"),a.resize()},m=function(b){a.isDefined(i.language)&&b.setLayoutProperty("country-label-lg","text-field","{name_"+i.language+"}")};a.isDefined(c.persistentGeojson)&&"boolean"==typeof c.persistentGeojson&&(j.setPersistentGeojson(c.persistentGeojson),c.$watch(function(){return c.persistentGeojson},function(){if("boolean"!=typeof c.persistentGeojson)throw new Error("Invalid parameter");j.setPersistentGeojson(c.persistentGeojson)})),a.isDefined(c.persistentImage)&&"boolean"==typeof c.persistentImage&&(j.setPersistentImage(c.persistentImage),c.$watch(function(){return c.persistentImage},function(){if("boolean"!=typeof c.persistentImage)throw new Error("Invalid parameter");j.setPersistentImage(c.persistentImage)})),a.isDefined(c.persistentVideo)&&"boolean"==typeof c.persistentVideo&&(j.setPersistentVideo(c.persistentVideo),c.$watch(function(){return c.persistentVideo},function(){if("boolean"!=typeof c.persistentVideo)throw new Error("Invalid parameter");j.setPersistentVideo(c.persistentVideo)}));var n=new b.Map({container:c.mapboxglMapId,style:c.glStyle||e.map.defaultStyle,center:e.map.defaultCenter,hash:a.isDefined(i.hash)?d.stringToBoolean(i.hash):e.map.defaultHash,bearingSnap:a.isDefined(i.bearingSnap)?d.stringToNumber(i.bearingSnap):e.map.defaultBearingSnap,failIfMajorPerformanceCaveat:a.isDefined(i.failIfMajorPerformanceCaveat)?d.stringToBoolean(i.failIfMajorPerformanceCaveat):e.map.defaultFailIfMajorPerformanceCaveat,preserveDrawingBuffer:a.isDefined(i.preserveDrawingBuffer)?d.stringToBoolean(i.preserveDrawingBuffer):e.map.defaultPreserveDrawingBuffer,trackResize:a.isDefined(i.trackResize)?d.stringToBoolean(i.trackResize):e.map.defaultTrackResize,renderWorldCopies:a.isDefined(i.renderWorldCopies)?d.stringToBoolean(i.renderWorldCopies):e.map.defaultRenderWorldCopies,attributionControl:!1});g.addMap(c.mapboxglMapId,n),j._mapboxGlMap.resolve(n),f.exposeMapEvents(n),j.getMap().then(function(b){c.$watch(function(){return i.language},function(){b.loaded()?m(b):b.on("load",function(){m(b)})}),c.$watch(function(){return i.showCollisionBoxes},function(){"boolean"==typeof i.showCollisionBoxes&&(b.showCollisionBoxes=i.showCollisionBoxes)}),c.$watch(function(){return i.showTileBoundaries},function(){"boolean"==typeof i.showTileBoundaries&&(b.showTileBoundaries=i.showTileBoundaries)}),c.$watch(function(){return i.repaint},function(){"boolean"==typeof i.repaint&&(b.repaint=i.repaint)}),a.isDefined(i.width)&&(k(b),c.$watch(function(){return h[0].getAttribute("width")},function(){k(b)})),a.isDefined(i.height)?(l(b),c.$watch(function(){return h[0].getAttribute("height")},function(){l(b)})):(h.css("height",e.map.defaultHeight),b.resize())}),c.$on("mapboxglMap:styleChanged",function(){j.getMap().then(function(a){m(a)})}),c.$on("$destroy",function(){n.remove()})}var j={restrict:"EA",replace:!0,scope:{glStyle:"=",glCenter:"=",glMinZoom:"=",glMaxZoom:"=",glZoom:"=",glBearing:"=",glPitch:"=",glControls:"=",glFilter:"=",glClasses:"=",glGeojson:"=",glInteractive:"=",glHandlers:"=",glImage:"=",glVideo:"=",glPopups:"=",glMarkers:"=",glLights:"=",glSources:"=",glLayers:"=",persistentGeojson:"=",persistentImage:"=",persistentVideo:"="},template:'<div class="angular-mapboxgl-map"><div class="loader" ng-if="isLoading"></div></div>',controller:h,link:i};return h.$inject=["$scope"],j}]),a.module("mapboxgl-directive").directive("mapboxglCompare",["mapboxglMapsData",function(c){function d(d,e,f){if(!b)throw new Error("Mapbox GL does not included");if(!b.accessToken){if(!(a.isDefined(f.accessToken)&&f.accessToken.length>0))throw new Error("Mapbox access token does not defined");b.accessToken=f.accessToken}if(!b.Compare)throw new Error("mapboxgl.Compare plugin does not included");if(!b.supported())throw new Error("Your browser does not support Mapbox GL");if(a.isDefined(d.compareSettings)&&Object.prototype.toString.call(d.compareSettings)!==Object.prototype.toString.call({}))throw new Error("Invalid mapboxgl.Compare parameters");e.ready(function(){var f=e.children();if(2!==f.length)throw new Error("Only two maps can be compared");var g=a.element(f[0]);g.addClass("compare-map");var h=a.element(f[1]);h.addClass("compare-map");var i=c.getMapById(f[0].id),j=c.getMapById(f[1].id);new b.Compare(i,j,d.compareSettings);e.css("height",g.css("height")),d.$watch(function(){return g[0].getAttribute("height")},function(){e.css("height",g.css("height"))})})}var e={restrict:"EA",replace:!0,scope:{compareSettings:"="},transclude:!0,template:'<div class="angular-mapboxgl-compare" ng-transclude></div>',link:d};return e}]),a.module("mapboxgl-directive").factory("mapboxglEventsUtils",["$rootScope",function(a){function b(b){c.map(function(c){b.on(c,function(b){a.$broadcast("mapboxglMap:"+c,b)})})}var c=["resize","webglcontextlost","webglcontextrestored","remove","mouseup","mousedown","mouseout","render","tiledataloading","movestart","contextmenu","dblclick","click","touchcancel","touchmove","touchend","touchstart","sourcedataloading","styledataloading","mousemove","load","move","moveend","error","data","styledata","sourcedata","dataloading","tiledata","zoomend","zoom","zoomstart","boxzoomstart","boxzoomcancel","boxzoomend","rotatestart","rotate","rotateend","dragend","drag","dragstart","pitch"],d={exposeMapEvents:b};return d}]),a.module("mapboxgl-directive").factory("mapboxglGeojsonUtils",["mapboxglUtils","mapboxglConstants",function(b,d){function e(b,c){if(a.isUndefined(c.id))throw new Error("Source ID Required");var d={};for(var e in c)"id"!==e&&(d[e]=c[e]);b.addSource(c.id,d)}function f(b,d){if(a.isUndefined(d.id))throw new Error("Layer ID Required");var e={type:"mapboxgl:geojson",popup:!!(a.isDefined(d.popup)&&a.isDefined(d.popup.enabled)&&d.popup.enabled)&&d.popup.enabled},f={};for(var g in d)"before"!==g&&"popup"!==g&&(f[g]=d[g]);f.metadata=a.isDefined(d.metadata)?d.metadata:{},a.extend(f.metadata,e);var h=a.isDefined(d.before)&&a.isDefined(d.before)?d.before:c;j.push({layerId:d.id,popup:d.popup}),b.addLayer(f,h)}function g(){j=[]}function h(a){var b=j.filter(function(b){return b.layerId===a});return b.length>0&&b[0].popup}function i(b,c){if(a.isUndefined(b)||null===b)throw new Error("Map is undefined");if(a.isUndefined(c)||null===c)throw new Error("Object definition is undefined");if(a.isUndefined(c.sources)||a.isUndefined(c.layers))throw new Error("Object sources and layers must be defined");if(Object.prototype.toString.call(c.sources)===Object.prototype.toString.call([]))c.sources.map(function(a){e(b,a)});else{if(Object.prototype.toString.call(c.sources)!==Object.prototype.toString.call({}))throw new Error("Invalid sources parameter");e(b,c.sources)}if(Object.prototype.toString.call(c.layers)===Object.prototype.toString.call([]))c.layers.map(function(a){f(b,a)});else{if(Object.prototype.toString.call(c.layers)!==Object.prototype.toString.call({}))throw new Error("Invalid layers parameter");f(b,c.layers)}}var j=[],k={createGeojsonByObject:i,getPopupByLayerId:h,removeAllRelations:g};return k}]),a.module("mapboxgl-directive").factory("mapboxglImageUtils",["mapboxglUtils","mapboxglConstants",function(b,c){function d(b,c){if(a.isUndefined(b)||null===b)throw new Error("Map is undefined");if(a.isUndefined(c)||null===c)throw new Error("Object definition is undefined");if(a.isUndefined(c.url)||null===c.url)throw new Error("Object url is undefined");if(a.isUndefined(c.coordinates)||null===c.coordinates)throw new Error("Object coordinates are undefined");c.id="image_"+Date.now(),b.addSource(c.id,{type:"image",url:c.url,coordinates:c.coordinates}),b.addLayer({id:c.id,source:c.id,type:"raster",layout:a.isDefined(c.layer)&&a.isDefined(c.layer.layout)?c.layer.layout:{},paint:a.isDefined(c.layer)&&a.isDefined(c.layer.paint)?c.layer.paint:{}})}var e={createImageByObject:d};return e}]),a.module("mapboxgl-directive").factory("mapboxglLayerUtils",["mapboxglUtils","mapboxglConstants","mapboxglPopupUtils",function(b,d,e){function f(){return n}function g(a){o=o.filter(function(b){return b.layerId!==a})}function h(){o=[]}function i(a){var b=o.filter(function(b){return b.layerId===a});return b.length>0&&b[0].popup}function j(b,d){if(a.isUndefined(b)||null===b)throw new Error("Map is undefined");if(a.isUndefined(d)||null===d)throw new Error("Layer object is undefined");if(a.isUndefined(d.id)||null===d.id)throw new Error("Layer ID Required");if(a.isUndefined(d.type)||null===d.type)throw new Error("Layer type Required");var e={type:"mapboxgl:"+d.type,popup:!!(a.isDefined(d.popup)&&a.isDefined(d.popup.enabled)&&d.popup.enabled)&&d.popup.enabled},f={};for(var g in d)"before"!==g&&"popup"!==g&&"animation"!==g&&(f[g]=d[g]);f.metadata=a.isDefined(d.metadata)?d.metadata:{},a.extend(f.metadata,e);var h=a.isDefined(d.before)&&a.isDefined(d.before)?d.before:c;b.addLayer(f,h),n.push(d.id),o.push({layerId:d.id,popup:d.popup})}function k(b){var c=!1;return a.isDefined(b)&&null!==b&&(c=n.indexOf(b)!==-1),c}function l(b,c){if(a.isUndefined(b)||null===b)throw new Error("Map is undefined");if(!k(c))throw new Error("Invalid layer ID");b.removeLayer(c),n=n.filter(function(a){return a!==c}),e.removePopupByLayerId(c),g(c)}function m(b,c){if(a.isUndefined(b)||null===b)throw new Error("Map is undefined");if(a.isUndefined(c)||null===c)throw new Error("Layer object is undefined");if(a.isUndefined(c.id)||null===c.id)throw new Error("Layer ID Required");a.isDefined(c.before)&&null!==c.before&&b.moveLayer(c.id,c.before),a.isDefined(c.filter)&&null!==c.filter&&a.isArray(c.filter)&&b.setFilter(c.id,c.filter);var d=b.getLayer(c.id);if(a.isDefined(c.minzoom)&&null!==c.minzoom?a.isDefined(c.maxzoom)&&null!==c.maxzoom?b.setLayerZoomRange(c.id,c.minzoom,c.maxzoom):b.setLayerZoomRange(c.id,c.minzoom,d.maxzoom):a.isDefined(c.maxzoom)&&null!==c.maxzoom&&b.setLayerZoomRange(c.id,d.minzoom,c.maxzoom),a.isDefined(c.popup)&&null!==c.popup&&(e.removePopupByLayerId(c.id),g(c.id),o.push({layerId:c.id,popup:c.popup})),a.isDefined(c.paint)&&null!==c.paint)for(var f in c.paint){var h=b.getPaintProperty(c.id,f);h!==c.paint[f]&&b.setPaintProperty(c.id,f,c.paint[f])}if(a.isDefined(c.layout)&&null!==c.layout)for(var i in c.layout){var j=b.getLayoutProperty(c.id,i);j!==c.layout[i]&&b.setLayoutProperty(c.id,i,c.layout[i])}}var n=[],o=[],p={createLayerByObject:j,existLayerById:k,removeLayerById:l,updateLayerByObject:m,getCreatedLayers:f,removeAllPopupRelations:h,removePopupRelationByLayerId:g,getPopupRelationByLayerId:i};return p}]),a.module("mapboxgl-directive").factory("mapboxglMapsData",["mapboxglUtils",function(a){function b(a,b){g.push({id:a,mapInstance:b})}function c(b){var c=a.arrayObjectIndexOf(g,b,"id");if(c!==-1){var d=g[c];d.mapInstance.remove(),g.splice(c,1)}}function d(){g.map(function(a){a.mapInstance.remove()}),g=[]}function e(){return g}function f(b){var c=a.arrayObjectIndexOf(g,b,"id");return c!==-1?g[c].mapInstance:null}var g=[],h={addMap:b,removeMapById:c,removeAllMaps:d,getMaps:e,getMapById:f};return h}]),a.module("mapboxgl-directive").factory("mapboxglMarkerUtils",["mapboxglUtils","mapboxglConstants","mapboxglPopupUtils",function(c,d,e){function f(c,d){if(a.isUndefined(c)||null===c)throw new Error("Map is undefined");if(a.isUndefined(d)||null===d)throw new Error("Object definition is undefined");if(a.isUndefined(d.coordinates)||null===d.coordinates)throw new Error("Object coordinates are undefined");if(a.isUndefined(d.element)||null===d.element)throw new Error("Object element is undefined");var f=d.options||{},g=new b.Marker(d.element,f).setLngLat(d.coordinates);if(a.isDefined(d.popup)){var h=e.createPopupByObject(c,d.popup);g.setPopup(h)}return g.addTo(c),g}var g={createMarkerByObject:f};return g}]),a.module("mapboxgl-directive").factory("mapboxglPopupUtils",["mapboxglUtils","mapboxglConstants","$rootScope","$compile",function(c,d,e,f){function g(){return l}function h(b){var c=l.filter(function(a){return a.layerId===b});return a.isUndefined(b)||null===b?c.map(function(a){return a.popupInstance}):c.length>0?c[0].popupInstance:void 0}function i(a){l.map(function(a){a.popupInstance.remove()}),l=[]}function j(a,b){var c=l.filter(function(a){return a.layerId===b});c.map(function(a){a.popupInstance.remove()}),l=l.filter(function(a){return a.layerId!==b})}function k(c,d,g){if(a.isUndefined(c)||null===c)throw new Error("Map is undefined");if(a.isUndefined(d)||null===d)throw new Error("Object definition is undefined");if(a.isUndefined(d.coordinates)||null===d.coordinates)throw new Error("Object coordinates are undefined");if(a.isUndefined(d.html)||null===d.html)throw new Error("Object html is undefined");var h=d.options||{},i=new b.Popup(h).setLngLat(c.unproject(d.coordinates));if(d.html instanceof HTMLElement)i.setDOMContent(d.html);else{var j=a.isDefined(d.getScope)&&a.isFunction(d.getScope)?d.getScope():e;try{var k=f(d.html)(j)[0];i.setDOMContent(k)}catch(a){i.setHTML(d.html)}}return i.addTo(c),l.push({popupInstance:i,layerId:g}),i}var l=[],m={createPopupByObject:k,getAllPopupsCreated:g,getPopupByLayerId:h,removeAllPopupsCreated:i,removePopupByLayerId:j};return m}]),a.module("mapboxgl-directive").factory("mapboxglSourceUtils",["mapboxglUtils","mapboxglConstants",function(b,c){function d(b,c){if(a.isUndefined(b)||null===b)throw new Error("Map is undefined");if(a.isUndefined(c)||null===c)throw new Error("Source object is undefined");if(a.isUndefined(c.id)||null===c.id)throw new Error("Source ID Required");if(a.isUndefined(c.type)||null===c.type)throw new Error("Source type Required");if(a.isUndefined(c.data)||null===c.data)throw new Error("Source data Required");var d={};for(var e in c)"id"!==e&&"animation"!==e&&(d[e]=c[e]);b.addSource(c.id,d),i.push(c.id)}function e(b){var c=!1;return a.isDefined(b)&&null!==b&&(c=i.indexOf(b)!==-1),c}function f(b,c){if(a.isUndefined(b)||null===b)throw new Error("Map is undefined");if(!e(c))throw new Error("Invalid source ID");b.removeSource(c),i=i.filter(function(a){return a!==c})}function g(b,c){if(a.isUndefined(b)||null===b)throw new Error("Map is undefined");if(a.isUndefined(c)||null===c)throw new Error("Source object is undefined");if(a.isUndefined(c.id)||null===c.id)throw new Error("Source ID Required");if(a.isUndefined(c.data)||null===c.data)throw new Error("Source data Required");var d=b.getSource(c.id);d.setData(c.data)}function h(){return i}var i=[],j={createSourceByObject:d,existSourceById:e,removeSourceById:f,updateSourceByObject:g,getCreatedSources:h};return j}]),a.module("mapboxgl-directive").factory("mapboxglUtils",["$window","$q",function(b,c){function d(){return"mapbox-gl-map-"+Date.now()}function e(d){var e=c.defer();return a.isDefined(d)&&(a.isDefined(d.autodiscover)&&d.autodiscover?b.navigator.geolocation.getCurrentPosition(function(a){var b=a.coords;e.resolve([b.longitude,b.latitude])},function(a){e.reject(a)},{enableHighAccuracy:!0,timeout:5e3,maximumAge:0}):a.isNumber(d.lat)&&a.isNumber(d.lng)&&(d.lng>-180||d.lng<180)&&(d.lat>-90||d.lat<90)?e.resolve([d.lng,d.lat]):a.isArray(d)&&2===d.length&&a.isNumber(d[0])&&a.isNumber(d[1])&&(d[0]>-180||d[0]<180)&&(d[1]>-90||d[1]<90)?e.resolve(d):e.resolve(!1)),e.promise}function f(a,b,c){for(var d=0,e=a.length;d<e;d++)if(a[d][c]===b)return d;return-1}function g(b){var c=!1;return a.isDefined(b)&&null!==b&&(c="true"===b.toLowerCase()),c}function h(b){if(a.isDefined(b)&&null!==b){var c=+b;if(isNaN(c))throw new Error("mapboxglUtils.stringToNumber --> Invalid stringValue");return c}}var i={generateMapId:d,validateAndFormatCenter:e,arrayObjectIndexOf:f,stringToBoolean:g,stringToNumber:h};return i}]),a.module("mapboxgl-directive").factory("mapboxglVideoUtils",["mapboxglUtils","mapboxglConstants",function(b,c){function d(b,c){if(a.isUndefined(b)||null===b)throw new Error("Map is undefined");if(a.isUndefined(c)||null===c)throw new Error("Object definition is undefined");if(a.isUndefined(c.urls)||!a.isArray(c.urls)||null===c.urls)throw new Error("Object urls is undefined");if(a.isUndefined(c.coordinates)||null===c.coordinates)throw new Error("Object coordinates are undefined");c.id="video_"+Date.now(),b.addSource(c.id,{type:"video",urls:c.url,coordinates:c.coordinates}),b.addLayer({id:c.id,source:c.id,type:"raster",layout:a.isDefined(c.layer)&&a.isDefined(c.layer.layout)?c.layer.layout:{},paint:a.isDefined(c.layer)&&a.isDefined(c.layer.paint)?c.layer.paint:{}})}var e={createVideoByObject:d};return e}]),a.module("mapboxgl-directive").constant("mapboxglConstants",{map:{defaultHeight:"450px",defaultStyle:"mapbox://styles/mapbox/streets-v9",defaultCenter:[0,0],defaultHash:!1,defaultBearingSnap:7,defaultFailIfMajorPerformanceCaveat:!1,defaultPreserveDrawingBuffer:!1,defaultTrackResize:!0,defaultRenderWorldCopies:!0,defaultPersistentGeojson:!1,defaultPersistentImage:!1,defaultPersistentVideo:!1},source:{defaultMaxZoom:18,defaultBuffer:128,defaultTolerance:.375,defaultCluster:!1,defaultClusterRadius:50}}),a.module("mapboxgl-directive").directive("glBearing",[function(){function b(b,c,d,e){if(!e)throw new Error("Invalid angular-mapboxgl-directive controller");var f=e.getMapboxGlScope();e.getMap().then(function(b){f.$watch("glBearing",function(c){if(a.isDefined(c)){if(!a.isNumber(c.value))throw new Error("Invalid bearing");b.setBearing(c.value,c.eventData)}},!0)})}var c={restrict:"A",scope:!1,replace:!1,require:"?^mapboxgl",link:b};return c}]),a.module("mapboxgl-directive").directive("glCenter",["mapboxglUtils","mapboxglConstants",function(b,c){function d(d,e,f,g){if(!g)throw new Error("Invalid angular-mapboxgl-directive controller");var h=g.getMapboxGlScope();g.getMap().then(function(d){h.$watch("glCenter",function(e,f){b.validateAndFormatCenter(e).then(function(b){if(!b)throw new Error("Invalid center");a.isDefined(f)&&e!==f?d.flyTo({center:b}):d.setCenter(b)}).catch(function(a){throw d.setCenter(c.map.defaultCenter),new Error(a.code+" / "+a.message)})},!0)})}var e={restrict:"A",scope:!1,replace:!1,require:"?^mapboxgl",link:d};return e}]),a.module("mapboxgl-directive").directive("glClasses",[function(){function b(b,c,d,e){if(!e)throw new Error("Invalid angular-mapboxgl-directive controller");var f=e.getMapboxGlScope();e.getMap().then(function(b){f.$watch("glClasses",function(c){if(a.isDefined(c))b.setClasses(c.classes,c.options);else{var d=b.getClasses();d.map(function(a){b.removeClass(a)})}},!0)})}var c={restrict:"A",scope:!1,replace:!1,require:"?^mapboxgl",link:b};return c}]),a.module("mapboxgl-directive").directive("glControls",["$rootScope","$window",function(d,e){function f(f,g,h,i){if(!i)throw new Error("Invalid angular-mapboxgl-directive controller");var j=i.getMapboxGlScope(),k={custom:[]},l=function(b,c,d,e,f){d?k.custom.push({name:b||"customControl_"+Date.now(),control:c,isEventsListenedByMap:!!a.isDefined(f)&&f,events:a.isDefined(e)&&a.isArray(e)?e:[]}):k[b]={control:c,isEventsListenedByMap:!!a.isDefined(f)&&f,events:a.isDefined(e)&&a.isArray(e)?e:[]}},m=function(a,b,c,d){c?b.map(function(a){d.off(a)}):b.map(function(b){a.off(b)})},n=function(a){for(var b in k)if("custom"!==b){var c=k[b];m(c.control,c.events,c.isEventsListenedByMap,a),a.removeControl(c.control)}else for(var d=k[b],e=0,f=d.length;e<f;e++){var g=d[e];m(g.control,g.events,g.isEventsListenedByMap,a),a.removeControl(g.control)}k={custom:[]}},o=[{name:"navigation",constructor:b.Navigation||b.NavigationControl,pluginName:"mapboxgl."+(b.Navigation?b.Navigation.name:b.NavigationControl.name)},{name:"scale",constructor:b.Scale||b.ScaleControl,pluginName:"mapboxgl."+(b.Scale?b.Scale.name:b.ScaleControl.name)},{name:"attribution",constructor:b.Attribution||b.AttributionControl,pluginName:"mapboxgl."+(b.Attribution?b.Attribution.name:b.AttributionControl.name)},{name:"geolocate",constructor:b.Geolocate||b.GeolocateControl,pluginName:"mapboxgl."+(b.Geolocate?b.Geolocate.name:b.GeolocateControl.name),eventsExposedName:"mapboxglGeolocate",eventsAvailables:["geolocate","error"]},{name:"geocoder",constructor:b.Geocoder||e.MapboxGeocoder,pluginName:b.Geocoder?"mapboxgl.Geocoder":"MapboxGeocoder",eventsExposedName:"mapboxglGeocoder",eventsAvailables:["clear","loading","results","result","error"]},{name:"directions",constructor:b.Directions||e.MapboxDirections,pluginName:b.Directions?"mapboxgl.Directions":"MapboxDirections",eventsExposedName:"mapboxglDirections",eventsAvailables:["clear","loading","profile","origin","destination","route","error"]},{name:"draw",constructor:b.Draw||e.MapboxDraw,pluginName:b.Draw?"mapboxgl.Draw":"MapboxDraw",eventsExposedName:"mapboxglDraw",listenInMap:!0,eventsAvailables:["draw.create","draw.delete","draw.combine","draw.uncombine","draw.update","draw.selectionchange","draw.modechange","draw.render","draw.actionable"]}];i.getMap().then(function(b){j.$watch("glControls",function(e){if(a.isDefined(e)&&(n(b),o.map(function(f){if(a.isDefined(e[f.name])&&a.isDefined(e[f.name].enabled)&&e[f.name].enabled){if(!a.isDefined(f.constructor)||!a.isFunction(f.constructor))throw new Error(f.pluginName+" plugin is not included.");var g=f.constructor.bind.apply(f.constructor,e[f.name].options),h=new g(e[f.name].options);if(l(f.name,h,!1,f.eventsAvailables,f.listenInMap),a.isDefined(f.eventsAvailables)&&a.isDefined(f.eventsExposedName)){var i=f.listenInMap?b:h;f.eventsAvailables.map(function(a){i.on(a,function(b){var c=f.eventsExposedName+":"+a;d.$broadcast(c,b)})})}var j=e[f.name].options&&e[f.name].options.position?e[f.name].options.position:c;b.addControl(h,j)}}),a.isDefined(e.custom))){if(!a.isArray(e.custom))throw new Error("'custom' must be an array");e.custom.map(function(e){if(a.isDefined(e.constructor)){var f=e.constructor.bind.apply(e.constructor,e.options),g=new f(e.options),h=a.isArray(e.events)?e.events:[];l(e.name,g,!0,h,e.listenInMap);var i=e.listenInMap?b:g;h.map(function(a){i.on(a,function(b){var c="mapboxgl:"+e.name+":"+a;d.$broadcast(c,b)})});var j=e.options&&e.options.position?e.options.position:c;b.addControl(g,j)}})}})})}var g={restrict:"A",scope:!1,replace:!1,require:"?^mapboxgl",link:f};return g}]),a.module("mapboxgl-directive").directive("glFilter",[function(){function b(b,c,d,e){if(!e)throw new Error("Invalid angular-mapboxgl-directive controller");var f=e.getMapboxGlScope();e.getMap().then(function(b){f.$watch("glFilter",function(c){if(a.isDefined(c))if(Object.prototype.toString.call(c)===Object.prototype.toString.call({})){if(!(a.isDefined(c.layerId)&&a.isDefined(c.filter)&&a.isArray(c.filter)))throw new Error("Invalid filter parameter");b.setFilter(c.layerId,c.filter)}else{if(Object.prototype.toString.call(c)!==Object.prototype.toString.call([]))throw new Error("Invalid filter parameter");c.map(function(c){if(!(a.isDefined(c.layerId)&&a.isDefined(c.filter)&&a.isArray(c.filter)))throw new Error("Invalid filter parameter");b.setFilter(c.layerId,c.filter)})}},!0)})}var c={restrict:"A",scope:!1,replace:!1,require:"?^mapboxgl",link:b};return c}]),a.module("mapboxgl-directive").directive("glGeojson",["mapboxglGeojsonUtils","mapboxglPopupUtils","$timeout",function(b,c,d){function e(d,e,f,g){if(!g)throw new Error("Invalid angular-mapboxgl-directive controller");var h=g.getMapboxGlScope();console.warn("glGeojson will be deprecated in next versions");var i=function(a){a.off("click"),a.off("mousemove")},j=function(d){d.on("click",function(e){var f=d.getStyle(),g=f.layers.filter(function(b){if(a.isDefined(b.metadata)&&a.isDefined(b.metadata.type))return"mapboxgl:geojson"===b.metadata.type&&a.isDefined(b.metadata.popup)&&b.metadata.popup}).map(function(a){return a.id}),h=d.queryRenderedFeatures(e.point,{layers:g});if(h.length>0){var i=h[0],j=b.getPopupByLayerId(i.layer.id);c.createPopupByObject(d,{coordinates:e.point,options:j.options,html:j.message,getScope:j.getScope})}}),d.on("mousemove",function(b){var c=d.getStyle(),e=c.layers.filter(function(b){if(a.isDefined(b.metadata)&&a.isDefined(b.metadata.type))return"mapboxgl:geojson"===b.metadata.type}).map(function(a){return a.id}),f=d.queryRenderedFeatures(b.point,{layers:e});d.getCanvas().style.cursor=f.length?"pointer":""})},k=function(c,d,e){if(a.isDefined(e)){if(i(c),b.removeAllRelations(),Object.prototype.toString.call(e)!==Object.prototype.toString.call({}))throw new Error("Invalid geojson parameter");b.createGeojsonByObject(c,e),d.addGeojsonObject(e),j(c)}};d.$on("mapboxglMap:styleChanged",function(){if(g.isGeojsonPersistent()){var b=a.copy(g.getGeojsonObjects());g.removeGeojsonObjects(),g.getMap().then(function(a){k(a,g,b)})}else g.removeGeojsonObjects()}),g.getMap().then(function(b){h.$watch("glGeojson.sources",function(b){a.isDefined(b)&&null!==b&&console.log(b)},!0),h.$watch("glGeojson.layers",function(b){a.isDefined(b)&&null!==b&&console.log(b)},!0)})}var f={restrict:"A",scope:!1,replace:!1,require:"?^mapboxgl",link:e};return f}]),a.module("mapboxgl-directive").directive("glHandlers",[function(){function b(b,c,d,e){if(!e)throw new Error("Invalid angular-mapboxgl-directive controller");var f=e.getMapboxGlScope();e.getMap().then(function(b){f.$watch("glHandlers",function(c){if(a.isDefined(c)&&Object.prototype.toString.call(c)===Object.prototype.toString.call({}))for(var d in c){var e=c[d]?"enable":"disable";b[d][e]()}},!0)})}var c={restrict:"A",scope:!1,replace:!1,require:"?^mapboxgl",link:b};return c}]),a.module("mapboxgl-directive").directive("glImage",["mapboxglImageUtils",function(b){function c(c,d,e,f){if(!f)throw new Error("Invalid angular-mapboxgl-directive controller");var g=f.getMapboxGlScope(),h=function(c,d,e){if(a.isDefined(e))if(Object.prototype.toString.call(e)===Object.prototype.toString.call({}))b.createImageByObject(c,e),d.addImageObject(e);else{if(Object.prototype.toString.call(e)!==Object.prototype.toString.call([]))throw new Error("Invalid image parameter");e.map(function(a){b.createImageByObject(c,a),d.addImageObject(a)})}};c.$on("mapboxglMap:styleChanged",function(){if(f.isImagePersistent()){var b=a.copy(f.getImageObjects());f.removeImageObjects(),f.getMap().then(function(a){h(a,f,b)})}else f.removeImageObjects()}),f.getMap().then(function(a){g.$watchCollection("glImage",function(b){a.style.loaded()?h(a,f,b):a.once("style.load",function(){h(a,f,b)})})})}var d={restrict:"A",scope:!1,replace:!1,require:"?^mapboxgl",link:c};return d}]),a.module("mapboxgl-directive").directive("glInteractive",[function(){function b(b,c,d,e){if(!e)throw new Error("Invalid angular-mapboxgl-directive controller");var f=["touchZoomRotate","scrollZoom","boxZoom","dragRotate","dragPan","doubleClickZoom","keyboard"],g=e.getMapboxGlScope();e.getMap().then(function(b){g.$watch("glInteractive",function(c){if(a.isDefined(c)&&"boolean"==typeof c){var d=c?"enable":"disable";f.map(function(a){b[a][d]()})}})})}var c={restrict:"A",scope:!1,replace:!1,require:"?^mapboxgl",link:b};return c}]),a.module("mapboxgl-directive").directive("glLayers",["mapboxglLayerUtils","mapboxglPopupUtils","$timeout","$q",function(b,c,d,e){function f(f,g,h,i){function j(a){c.removeAllPopupsCreated(a),a.off("click"),a.off("mousemove")}function k(d){d.on("click",function(e){var f=b.getCreatedLayers(),g=d.queryRenderedFeatures(e.point,{layers:f});if(g.length>0){var h=g[0],i=b.getPopupRelationByLayerId(h.layer.id);a.isDefined(i)&&null!==i&&c.createPopupByObject(d,{coordinates:e.point,options:i.options,html:i.message,getScope:i.getScope},h.layer.id)}}),d.on("mousemove",function(a){var c=b.getCreatedLayers(),e=d.queryRenderedFeatures(a.point,{layers:c});d.getCanvas().style.cursor=e.length?"pointer":""})}function l(c,d){if(b.existLayerById(d.id)?b.updateLayerByObject(c,d):b.createLayerByObject(c,d),a.isDefined(d.animation)&&a.isDefined(d.animation.enabled)&&d.animation.enabled){var e=function(a){setTimeout(function(){requestAnimationFrame(e),d.animation.animationFunction(c,d.id,d.animation.animationData,a)},d.animation.timeoutMilliseconds||1e3)};e(0)}}function m(c,d){var f=e.defer(),g=[];Object.prototype.toString.call(d)===Object.prototype.toString.call([])?g=d.map(function(a){return a.id}):Object.prototype.toString.call(d)===Object.prototype.toString.call({})?g.push(d.id):f.reject(new Error("Invalid layers parameter")),g=g.filter(function(b){return a.isDefined(b)});var h=b.getCreatedLayers();return g.map(function(a){h=h.filter(function(b){return b!==a})}),h.map(function(a){b.removeLayerById(c,a)}),f.resolve(),f.promise}if(!i)throw new Error("Invalid angular-mapboxgl-directive controller");var n=i.getMapboxGlScope();i.getMap().then(function(a){f.selfMap=a,n.$watch("glLayers",function(b){d(function(){j(a),m(a,b).then(function(){if(Object.prototype.toString.call(b)===Object.prototype.toString.call([]))b.map(function(b){l(a,b)});else{if(Object.prototype.toString.call(b)!==Object.prototype.toString.call({}))throw new Error("Invalid layers parameter");l(a,b)}k(a)}).catch(function(a){throw a})},500,!0)},!0)})}var g={restrict:"A",scope:!1,replace:!1,require:"?^mapboxgl",link:f};return g}]),a.module("mapboxgl-directive").directive("glLights",[function(){
function b(b,c,d,e){if(!e)throw new Error("Invalid angular-mapboxgl-directive controller");var f=e.getMapboxGlScope();e.getMap().then(function(b){f.$watch("glLights",function(c){a.isDefined(c)&&b.setLight(c.options,c.lightOptions)},!0)})}var c={restrict:"A",scope:!1,replace:!1,require:"?^mapboxgl",link:b};return c}]),a.module("mapboxgl-directive").directive("glMarkers",["mapboxglMarkerUtils",function(b){function c(c,d,e,f){if(!f)throw new Error("Invalid angular-mapboxgl-directive controller");var g=f.getMapboxGlScope(),h=[],i=function(){h.map(function(a){a.remove()}),h=[]},j=function(c,d){if(a.isDefined(d))if(i(),Object.prototype.toString.call(d)===Object.prototype.toString.call({})){var e=b.createMarkerByObject(c,d);h.push(e)}else{if(Object.prototype.toString.call(d)!==Object.prototype.toString.call([]))throw new Error("Invalid marker parameter");d.map(function(a){var d=b.createMarkerByObject(c,a);h.push(d)})}};f.getMap().then(function(a){g.$watchCollection("glMarkers",function(b){j(a,b)})})}var d={restrict:"A",scope:!1,replace:!1,require:"?^mapboxgl",link:c};return d}]),a.module("mapboxgl-directive").directive("glMaxBounds",[function(){function b(b,c,d,e){if(!e)throw new Error("Invalid angular-mapboxgl-directive controller");var f=e.getMapboxGlScope();e.getMap().then(function(b){f.$watch("glMaxBounds",function(c){if(!a.isArray(c)||2!==c.length)throw new Error("Invalid max bounds");b.setMaxBounds(c)},!0)})}var c={restrict:"A",scope:!1,replace:!1,require:"?^mapboxgl",link:b};return c}]),a.module("mapboxgl-directive").directive("glMaxZoom",[function(){function b(b,c,d,e){if(!e)throw new Error("Invalid angular-mapboxgl-directive controller");var f=e.getMapboxGlScope();e.getMap().then(function(b){f.$watch("glMaxZoom",function(c){if(!a.isNumber(c)||!(c>=0||c<=20))throw new Error("Invalid max zoom");b.setMaxZoom(c)},!0)})}var c={restrict:"A",scope:!1,replace:!1,require:"?^mapboxgl",link:b};return c}]),a.module("mapboxgl-directive").directive("glMinZoom",[function(){function b(b,c,d,e){if(!e)throw new Error("Invalid angular-mapboxgl-directive controller");var f=e.getMapboxGlScope();e.getMap().then(function(b){f.$watch("glMinZoom",function(c){if(!a.isNumber(c)||!(c>=0||c<=20))throw new Error("Invalid min zoom");b.setMinZoom(c)},!0)})}var c={restrict:"A",scope:!1,replace:!1,require:"?^mapboxgl",link:b};return c}]),a.module("mapboxgl-directive").directive("glPitch",[function(){function b(b,c,d,e){if(!e)throw new Error("Invalid angular-mapboxgl-directive controller");var f=e.getMapboxGlScope();e.getMap().then(function(b){f.$watch("glPitch",function(c){if(a.isDefined(c)){if(!a.isNumber(c.value)||!(c.value>=0||c.value<=60))throw new Error("Invalid pitch");b.setPitch(c.value,c.eventData)}},!0)})}var c={restrict:"A",scope:!1,replace:!1,require:"?^mapboxgl",link:b};return c}]),a.module("mapboxgl-directive").directive("glPopups",["mapboxglPopupUtils",function(b){function c(c,d,e,f){if(!f)throw new Error("Invalid angular-mapboxgl-directive controller");var g=f.getMapboxGlScope(),h=[],i=function(){h.map(function(a){a.remove()}),h=[]},j=function(c,d){if(a.isDefined(d))if(i(),Object.prototype.toString.call(d)===Object.prototype.toString.call({})){var e=b.createPopupByObject(c,d);h.push(e)}else{if(Object.prototype.toString.call(d)!==Object.prototype.toString.call([]))throw new Error("Invalid popup parameter");d.map(function(a){var d=b.createPopupByObject(c,a);h.push(d)})}};f.getMap().then(function(a){g.$watchCollection("glPopups",function(b){j(a,b)})})}var d={restrict:"A",scope:!1,replace:!1,require:"?^mapboxgl",link:c};return d}]),a.module("mapboxgl-directive").directive("glSources",["mapboxglSourceUtils","$timeout","$q",function(b,c,d){function e(e,f,g,h){function i(c,d){b.existSourceById(d.id)?b.updateSourceByObject(c,d):b.createSourceByObject(c,d),setTimeout(function(){if(a.isDefined(d.animation)&&a.isDefined(d.animation.enabled)&&d.animation.enabled){var b=function(a){setTimeout(function(){requestAnimationFrame(b),d.animation.animationFunction(c,d.id,d.animation.animationData,a)},d.animation.timeoutMilliseconds||1e3)};b(0)}},500)}function j(c,e){var f=d.defer(),g=[];Object.prototype.toString.call(e)===Object.prototype.toString.call([])?g=e.map(function(a){return a.id}):Object.prototype.toString.call(e)===Object.prototype.toString.call({})?g.push(e.id):f.reject(new Error("Invalid sources parameter")),g=g.filter(function(b){return a.isDefined(b)});var h=b.getCreatedSources();return g.map(function(a){h=h.filter(function(b){return b!==a})}),h.map(function(a){b.removeSourceById(c,a)}),f.resolve(),f.promise}if(!h)throw new Error("Invalid angular-mapboxgl-directive controller");var k=h.getMapboxGlScope();h.getMap().then(function(a){k.$watch("glSources",function(b){c(function(){j(a,b).then(function(){if(Object.prototype.toString.call(b)===Object.prototype.toString.call([]))b.map(function(b){i(a,b)});else{if(Object.prototype.toString.call(b)!==Object.prototype.toString.call({}))throw new Error("Invalid sources parameter");i(a,b)}}).catch(function(a){throw a})},500,!0)},!0)})}var f={restrict:"A",scope:!1,replace:!1,require:"?^mapboxgl",link:e};return f}]),a.module("mapboxgl-directive").directive("glStyle",["$rootScope",function(b){function c(c,d,e,f){if(!f)throw new Error("Invalid angular-mapboxgl-directive controller");var g=f.getMapboxGlScope();f.getMap().then(function(c){g.$watch("glStyle",function(d,e){if(a.isDefined(d)&&null!==d&&d!==e){var f=!1;c.setStyle(d),c.on("data",function(a){"style"!==a.dataType||f||(b.$broadcast("mapboxglMap:styleChanged",{map:c,newStyle:d,oldStyle:e}),f=!0)})}},!0)})}var d={restrict:"A",scope:!1,replace:!1,require:"?^mapboxgl",link:c};return d}]),a.module("mapboxgl-directive").directive("glVideo",["mapboxglVideoUtils",function(b){function c(c,d,e,f){if(!f)throw new Error("Invalid angular-mapboxgl-directive controller");var g=f.getMapboxGlScope(),h=function(c,d,e){if(a.isDefined(e))if(Object.prototype.toString.call(e)===Object.prototype.toString.call({}))b.createVideoByObject(c,e),d.addVideoObject(e);else{if(Object.prototype.toString.call(e)!==Object.prototype.toString.call([]))throw new Error("Invalid video parameter");e.map(function(a){b.createVideoByObject(c,a),d.addVideoObject(a)})}};f.getMap().then(function(a){g.$watchCollection("glVideo",function(b){a.loaded()?h(a,f,b):a.on("load",function(){h(a,f,b)})})})}var d={restrict:"A",scope:!1,replace:!1,require:"?^mapboxgl",link:c};return d}]),a.module("mapboxgl-directive").directive("glZoom",[function(){function b(b,c,d,e){if(!e)throw new Error("Invalid angular-mapboxgl-directive controller");var f=e.getMapboxGlScope();e.getMap().then(function(b){f.$watch("glZoom",function(c){if(a.isDefined(c)){if(!a.isNumber(c.value)||!(c.value>=0||c.value<=20))throw new Error("Invalid zoom");b.setZoom(c.value,c.eventData)}},!0)})}var c={restrict:"A",scope:!1,replace:!1,require:"?^mapboxgl",link:b};return c}])}(angular,mapboxgl)},{}]},{},[1]);