{"version":3,"file":"ractive.min.js","sources":["ractive.js"],"sourcesContent":["/*\n\tRactive.js v0.9.0-edge\n\tMon Nov 21 2016 22:14:50 GMT+0000 (UTC) - commit 8ee32a31d9fa054c3ffbbd8c9731e250c2e04495\n\n\thttp://ractivejs.org\n\thttp://twitter.com/RactiveJS\n\n\tReleased under the MIT License.\n*/\n\n\n(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n\ttypeof define === 'function' && define.amd ? define(factory) :\n\t((function() { var current = global.Ractive; var next = factory(); next.noConflict = function() { global.Ractive = current; return next; }; return global.Ractive = next; })());\n}(this, (function () { 'use strict';\n\nvar defaults = {\n\t// render placement:\n\tel:                     void 0,\n\tappend:\t\t\t\t    false,\n\n\t// template:\n\ttemplate:               null,\n\n\t// parse:\n\tdelimiters:             [ '{{', '}}' ],\n\ttripleDelimiters:       [ '{{{', '}}}' ],\n\tstaticDelimiters:       [ '[[', ']]' ],\n\tstaticTripleDelimiters: [ '[[[', ']]]' ],\n\tcsp: \t\t\t\t\ttrue,\n\tinterpolate:            false,\n\tpreserveWhitespace:     false,\n\tsanitize:               false,\n\tstripComments:          true,\n\tcontextLines:           0,\n\n\t// data & binding:\n\tdata:                   {},\n\tcomputed:               {},\n\tsyncComputedChildren:   false,\n\tresolveInstanceMembers: true,\n\twarnAboutAmbiguity:     false,\n\tmagic:                  false,\n\tmodifyArrays:           false,\n\tadapt:                  [],\n\tisolated:               false,\n\ttwoway:                 true,\n\tlazy:                   false,\n\n\t// transitions:\n\tnoIntro:                false,\n\ttransitionsEnabled:     true,\n\tcomplete:               void 0,\n\n\t// css:\n\tcss:                    null,\n\tnoCssTransform:         false\n};\n\n// These are a subset of the easing equations found at\n// https://raw.github.com/danro/easing-js - license info\n// follows:\n\n// --------------------------------------------------\n// easing.js v0.5.4\n// Generic set of easing functions with AMD support\n// https://github.com/danro/easing-js\n// This code may be freely distributed under the MIT license\n// http://danro.mit-license.org/\n// --------------------------------------------------\n// All functions adapted from Thomas Fuchs & Jeremy Kahn\n// Easing Equations (c) 2003 Robert Penner, BSD license\n// https://raw.github.com/danro/easing-js/master/LICENSE\n// --------------------------------------------------\n\n// In that library, the functions named easeIn, easeOut, and\n// easeInOut below are named easeInCubic, easeOutCubic, and\n// (you guessed it) easeInOutCubic.\n//\n// You can add additional easing functions to this list, and they\n// will be globally available.\n\n\nvar easing = {\n\tlinear: function linear ( pos ) { return pos; },\n\teaseIn: function easeIn ( pos ) { return Math.pow( pos, 3 ); },\n\teaseOut: function easeOut ( pos ) { return ( Math.pow( ( pos - 1 ), 3 ) + 1 ); },\n\teaseInOut: function easeInOut ( pos ) {\n\t\tif ( ( pos /= 0.5 ) < 1 ) { return ( 0.5 * Math.pow( pos, 3 ) ); }\n\t\treturn ( 0.5 * ( Math.pow( ( pos - 2 ), 3 ) + 2 ) );\n\t}\n};\n\nvar legacy = null;\n\n/* global console, navigator */\n/* eslint no-console:\"off\" */\n\nvar win = typeof window !== 'undefined' ? window : null;\nvar doc = win ? document : null;\n\nvar isClient = !!doc;\nvar isJsdom = ( typeof navigator !== 'undefined' && /jsDom/.test( navigator.appName ) );\nvar hasConsole = ( typeof console !== 'undefined' && typeof console.warn === 'function' && typeof console.warn.apply === 'function' );\n\nvar magic;\ntry {\n\tObject.defineProperty({}, 'test', { value: 0 });\n\tmagic = true;\n} catch ( e ) {\n\tmagic = false;\n}\n\nvar svg = doc ?\n\tdoc.implementation.hasFeature( 'http://www.w3.org/TR/SVG11/feature#BasicStructure', '1.1' ) :\n\tfalse;\n\nvar vendors = [ 'o', 'ms', 'moz', 'webkit' ];\n\nvar html   = 'http://www.w3.org/1999/xhtml';\nvar mathml = 'http://www.w3.org/1998/Math/MathML';\nvar svg$1    = 'http://www.w3.org/2000/svg';\nvar xlink  = 'http://www.w3.org/1999/xlink';\nvar xml    = 'http://www.w3.org/XML/1998/namespace';\nvar xmlns  = 'http://www.w3.org/2000/xmlns';\n\nvar namespaces = { html: html, mathml: mathml, svg: svg$1, xlink: xlink, xml: xml, xmlns: xmlns };\n\nvar createElement;\nvar matches;\nvar div;\nvar methodNames;\nvar unprefixed;\nvar prefixed;\nvar i;\nvar j;\nvar makeFunction;\n\n// Test for SVG support\nif ( !svg ) {\n\tcreateElement = function ( type, ns, extend ) {\n\t\tif ( ns && ns !== html ) {\n\t\t\tthrow 'This browser does not support namespaces other than http://www.w3.org/1999/xhtml. The most likely cause of this error is that you\\'re trying to render SVG in an older browser. See http://docs.ractivejs.org/latest/svg-and-older-browsers for more information';\n\t\t}\n\n\t\treturn extend ?\n\t\t\tdoc.createElement( type, extend ) :\n\t\t\tdoc.createElement( type );\n\t};\n} else {\n\tcreateElement = function ( type, ns, extend ) {\n\t\tif ( !ns || ns === html ) {\n\t\t\treturn extend ?\n\t\t\t\tdoc.createElement( type, extend ) :\n\t\t\t\tdoc.createElement( type );\n\t\t}\n\n\t\treturn extend ?\n\t\t\tdoc.createElementNS( ns, type, extend ) :\n\t\t\tdoc.createElementNS( ns, type );\n\t};\n}\n\nfunction createDocumentFragment () {\n\treturn doc.createDocumentFragment();\n}\n\nfunction getElement ( input ) {\n\tvar output;\n\n\tif ( !input || typeof input === 'boolean' ) { return; }\n\n\tif ( !win || !doc || !input ) {\n\t\treturn null;\n\t}\n\n\t// We already have a DOM node - no work to do. (Duck typing alert!)\n\tif ( input.nodeType ) {\n\t\treturn input;\n\t}\n\n\t// Get node from string\n\tif ( typeof input === 'string' ) {\n\t\t// try ID first\n\t\toutput = doc.getElementById( input );\n\n\t\t// then as selector, if possible\n\t\tif ( !output && doc.querySelector ) {\n\t\t\toutput = doc.querySelector( input );\n\t\t}\n\n\t\t// did it work?\n\t\tif ( output && output.nodeType ) {\n\t\t\treturn output;\n\t\t}\n\t}\n\n\t// If we've been given a collection (jQuery, Zepto etc), extract the first item\n\tif ( input[0] && input[0].nodeType ) {\n\t\treturn input[0];\n\t}\n\n\treturn null;\n}\n\nif ( !isClient ) {\n\tmatches = null;\n} else {\n\tdiv = createElement( 'div' );\n\tmethodNames = [ 'matches', 'matchesSelector' ];\n\n\tmakeFunction = function ( methodName ) {\n\t\treturn function ( node, selector ) {\n\t\t\treturn node[ methodName ]( selector );\n\t\t};\n\t};\n\n\ti = methodNames.length;\n\n\twhile ( i-- && !matches ) {\n\t\tunprefixed = methodNames[i];\n\n\t\tif ( div[ unprefixed ] ) {\n\t\t\tmatches = makeFunction( unprefixed );\n\t\t} else {\n\t\t\tj = vendors.length;\n\t\t\twhile ( j-- ) {\n\t\t\t\tprefixed = vendors[i] + unprefixed.substr( 0, 1 ).toUpperCase() + unprefixed.substring( 1 );\n\n\t\t\t\tif ( div[ prefixed ] ) {\n\t\t\t\t\tmatches = makeFunction( prefixed );\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// IE8...\n\tif ( !matches ) {\n\t\tmatches = function ( node, selector ) {\n\t\t\tvar parentNode, i;\n\n\t\t\tparentNode = node.parentNode;\n\n\t\t\tif ( !parentNode ) {\n\t\t\t\t// empty dummy <div>\n\t\t\t\tdiv.innerHTML = '';\n\n\t\t\t\tparentNode = div;\n\t\t\t\tnode = node.cloneNode();\n\n\t\t\t\tdiv.appendChild( node );\n\t\t\t}\n\n\t\t\tvar nodes = parentNode.querySelectorAll( selector );\n\n\t\t\ti = nodes.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tif ( nodes[i] === node ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn false;\n\t\t};\n\t}\n}\n\nfunction detachNode ( node ) {\n\t// stupid ie\n\tif ( node && typeof node.parentNode !== 'unknown' && node.parentNode ) { // eslint-disable-line valid-typeof\n\t\tnode.parentNode.removeChild( node );\n\t}\n\n\treturn node;\n}\n\nfunction safeToStringValue ( value ) {\n\treturn ( value == null || !value.toString ) ? '' : '' + value;\n}\n\nfunction safeAttributeString ( string ) {\n\treturn safeToStringValue( string )\n\t\t.replace( /&/g, '&amp;' )\n\t\t.replace( /\"/g, '&quot;' )\n\t\t.replace( /'/g, '&#39;' );\n}\n\nvar camel = /(-.)/g;\nfunction camelize ( string ) {\n\treturn string.replace( camel, function (s) { return s.charAt( 1 ).toUpperCase(); } );\n}\n\nvar decamel = /[A-Z]/g;\nfunction decamelize ( string ) {\n\treturn string.replace( decamel, function (s) { return (\"-\" + (s.toLowerCase())); } );\n}\n\nvar create;\nvar defineProperty;\nvar defineProperties;\n\ntry {\n\tObject.defineProperty({}, 'test', { get: function get() {}, set: function set() {} });\n\n\tif ( doc ) {\n\t\tObject.defineProperty( createElement( 'div' ), 'test', { value: 0 });\n\t}\n\n\tdefineProperty = Object.defineProperty;\n} catch ( err ) {\n\t// Object.defineProperty doesn't exist, or we're in IE8 where you can\n\t// only use it with DOM objects (what were you smoking, MSFT?)\n\tdefineProperty = function ( obj, prop, desc ) {\n\t\tif ( desc.get ) { obj[ prop ] = desc.get(); }\n\t\telse { obj[ prop ] = desc.value; }\n\t};\n}\n\ntry {\n\ttry {\n\t\tObject.defineProperties({}, { test: { value: 0 } });\n\t} catch ( err ) {\n\t\t// TODO how do we account for this? noMagic = true;\n\t\tthrow err;\n\t}\n\n\tif ( doc ) {\n\t\tObject.defineProperties( createElement( 'div' ), { test: { value: 0 } });\n\t}\n\n\tdefineProperties = Object.defineProperties;\n} catch ( err ) {\n\tdefineProperties = function ( obj, props ) {\n\t\tvar prop;\n\n\t\tfor ( prop in props ) {\n\t\t\tif ( props.hasOwnProperty( prop ) ) {\n\t\t\t\tdefineProperty( obj, prop, props[ prop ] );\n\t\t\t}\n\t\t}\n\t};\n}\n\ntry {\n\tObject.create( null );\n\n\tcreate = Object.create;\n} catch ( err ) {\n\t// sigh\n\tcreate = (function () {\n\t\tvar F = function () {};\n\n\t\treturn function ( proto, props ) {\n\t\t\tif ( proto === null ) {\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\tF.prototype = proto;\n\t\t\tvar obj = new F();\n\n\t\t\tif ( props ) {\n\t\t\t\tObject.defineProperties( obj, props );\n\t\t\t}\n\n\t\t\treturn obj;\n\t\t};\n\t}());\n}\n\nfunction extend$1 ( target ) {\n\tvar sources = [], len = arguments.length - 1;\n\twhile ( len-- > 0 ) sources[ len ] = arguments[ len + 1 ];\n\n\tvar prop;\n\n\tsources.forEach( function (source) {\n\t\tfor ( prop in source ) {\n\t\t\tif ( hasOwn.call( source, prop ) ) {\n\t\t\t\ttarget[ prop ] = source[ prop ];\n\t\t\t}\n\t\t}\n\t});\n\n\treturn target;\n}\n\nfunction fillGaps ( target ) {\n\tvar sources = [], len = arguments.length - 1;\n\twhile ( len-- > 0 ) sources[ len ] = arguments[ len + 1 ];\n\n\tsources.forEach( function (s) {\n\t\tfor ( var key in s ) {\n\t\t\tif ( hasOwn.call( s, key ) && !( key in target ) ) {\n\t\t\t\ttarget[ key ] = s[ key ];\n\t\t\t}\n\t\t}\n\t});\n\n\treturn target;\n}\n\nvar hasOwn = Object.prototype.hasOwnProperty;\n\nfunction toPairs ( obj ) {\n\tif ( obj === void 0 ) obj = {};\n\n\tvar res = [];\n\tfor ( var k in obj ) {\n\t\tif ( hasOwn.call( obj, k ) ) { res.push( [ k, obj[k] ] ); }\n\t}\n\treturn res;\n}\n\nvar toString$1$1 = Object.prototype.toString;\nvar arrayLikePattern = /^\\[object (?:Array|FileList)\\]$/;\n\n// thanks, http://perfectionkills.com/instanceof-considered-harmful-or-how-to-write-a-robust-isarray/\nfunction isArray ( thing ) {\n\treturn toString$1$1.call( thing ) === '[object Array]';\n}\n\n\n\nfunction isEqual ( a, b ) {\n\tif ( a === null && b === null ) {\n\t\treturn true;\n\t}\n\n\tif ( typeof a === 'object' || typeof b === 'object' ) {\n\t\treturn false;\n\t}\n\n\treturn a === b;\n}\n\n// http://stackoverflow.com/questions/18082/validate-numbers-in-javascript-isnumeric\nfunction isNumeric ( thing ) {\n\treturn !isNaN( parseFloat( thing ) ) && isFinite( thing );\n}\n\nfunction isObject ( thing ) {\n\treturn ( thing && toString$1$1.call( thing ) === '[object Object]' );\n}\n\nfunction isObjectLike ( thing ) {\n\tif ( !thing ) { return false; }\n\tvar type = typeof thing;\n\tif ( type === 'object' || type === 'function' ) { return true; }\n}\n\nvar noop = function () {};\n\n/* global console */\n/* eslint no-console:\"off\" */\n\nvar alreadyWarned = {};\nvar log;\nvar printWarning;\nvar welcome;\n\nif ( hasConsole ) {\n\tvar welcomeIntro = [\n\t\t\"%cRactive.js %c0.9.0-edge-8ee32a31d9fa054c3ffbbd8c9731e250c2e04495 %cin debug mode, %cmore...\",\n\t\t'color: rgb(114, 157, 52); font-weight: normal;',\n\t\t'color: rgb(85, 85, 85); font-weight: normal;',\n\t\t'color: rgb(85, 85, 85); font-weight: normal;',\n\t\t'color: rgb(82, 140, 224); font-weight: normal; text-decoration: underline;'\n\t];\n\tvar welcomeMessage = \"You're running Ractive 0.9.0-edge-8ee32a31d9fa054c3ffbbd8c9731e250c2e04495 in debug mode - messages will be printed to the console to help you fix problems and optimise your application.\\n\\nTo disable debug mode, add this line at the start of your app:\\n  Ractive.DEBUG = false;\\n\\nTo disable debug mode when your app is minified, add this snippet:\\n  Ractive.DEBUG = /unminified/.test(function(){/*unminified*/});\\n\\nGet help and support:\\n  http://docs.ractivejs.org\\n  http://stackoverflow.com/questions/tagged/ractivejs\\n  http://groups.google.com/forum/#!forum/ractive-js\\n  http://twitter.com/ractivejs\\n\\nFound a bug? Raise an issue:\\n  https://github.com/ractivejs/ractive/issues\\n\\n\";\n\n\twelcome = function () {\n\t\tif ( Ractive.WELCOME_MESSAGE === false ) {\n\t\t\twelcome = noop;\n\t\t\treturn;\n\t\t}\n\t\tvar message = 'WELCOME_MESSAGE' in Ractive ? Ractive.WELCOME_MESSAGE : welcomeMessage;\n\t\tvar hasGroup = !!console.groupCollapsed;\n\t\tif ( hasGroup ) { console.groupCollapsed.apply( console, welcomeIntro ); }\n\t\tconsole.log( message );\n\t\tif ( hasGroup ) {\n\t\t\tconsole.groupEnd( welcomeIntro );\n\t\t}\n\n\t\twelcome = noop;\n\t};\n\n\tprintWarning = function ( message, args ) {\n\t\twelcome();\n\n\t\t// extract information about the instance this message pertains to, if applicable\n\t\tif ( typeof args[ args.length - 1 ] === 'object' ) {\n\t\t\tvar options = args.pop();\n\t\t\tvar ractive = options ? options.ractive : null;\n\n\t\t\tif ( ractive ) {\n\t\t\t\t// if this is an instance of a component that we know the name of, add\n\t\t\t\t// it to the message\n\t\t\t\tvar name;\n\t\t\t\tif ( ractive.component && ( name = ractive.component.name ) ) {\n\t\t\t\t\tmessage = \"<\" + name + \"> \" + message;\n\t\t\t\t}\n\n\t\t\t\tvar node;\n\t\t\t\tif ( node = ( options.node || ( ractive.fragment && ractive.fragment.rendered && ractive.find( '*' ) ) ) ) {\n\t\t\t\t\targs.push( node );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconsole.warn.apply( console, [ '%cRactive.js: %c' + message, 'color: rgb(114, 157, 52);', 'color: rgb(85, 85, 85);' ].concat( args ) );\n\t};\n\n\tlog = function () {\n\t\tconsole.log.apply( console, arguments );\n\t};\n} else {\n\tprintWarning = log = welcome = noop;\n}\n\nfunction format ( message, args ) {\n\treturn message.replace( /%s/g, function () { return args.shift(); } );\n}\n\nfunction fatal ( message ) {\n\tvar args = [], len = arguments.length - 1;\n\twhile ( len-- > 0 ) args[ len ] = arguments[ len + 1 ];\n\n\tmessage = format( message, args );\n\tthrow new Error( message );\n}\n\nfunction logIfDebug () {\n\tif ( Ractive.DEBUG ) {\n\t\tlog.apply( null, arguments );\n\t}\n}\n\nfunction warn ( message ) {\n\tvar args = [], len = arguments.length - 1;\n\twhile ( len-- > 0 ) args[ len ] = arguments[ len + 1 ];\n\n\tmessage = format( message, args );\n\tprintWarning( message, args );\n}\n\nfunction warnOnce ( message ) {\n\tvar args = [], len = arguments.length - 1;\n\twhile ( len-- > 0 ) args[ len ] = arguments[ len + 1 ];\n\n\tmessage = format( message, args );\n\n\tif ( alreadyWarned[ message ] ) {\n\t\treturn;\n\t}\n\n\talreadyWarned[ message ] = true;\n\tprintWarning( message, args );\n}\n\nfunction warnIfDebug () {\n\tif ( Ractive.DEBUG ) {\n\t\twarn.apply( null, arguments );\n\t}\n}\n\nfunction warnOnceIfDebug () {\n\tif ( Ractive.DEBUG ) {\n\t\twarnOnce.apply( null, arguments );\n\t}\n}\n\n// Error messages that are used (or could be) in multiple places\nvar badArguments = 'Bad arguments';\nvar noRegistryFunctionReturn = 'A function was specified for \"%s\" %s, but no %s was returned';\nvar missingPlugin = function ( name, type ) { return (\"Missing \\\"\" + name + \"\\\" \" + type + \" plugin. You may need to download a plugin via http://docs.ractivejs.org/latest/plugins#\" + type + \"s\"); };\n\nfunction findInViewHierarchy ( registryName, ractive, name ) {\n\tvar instance = findInstance( registryName, ractive, name );\n\treturn instance ? instance[ registryName ][ name ] : null;\n}\n\nfunction findInstance ( registryName, ractive, name ) {\n\twhile ( ractive ) {\n\t\tif ( name in ractive[ registryName ] ) {\n\t\t\treturn ractive;\n\t\t}\n\n\t\tif ( ractive.isolated ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tractive = ractive.parent;\n\t}\n}\n\nfunction interpolate ( from, to, ractive, type ) {\n\tif ( from === to ) { return null; }\n\n\tif ( type ) {\n\t\tvar interpol = findInViewHierarchy( 'interpolators', ractive, type );\n\t\tif ( interpol ) { return interpol( from, to ) || null; }\n\n\t\tfatal( missingPlugin( type, 'interpolator' ) );\n\t}\n\n\treturn interpolators.number( from, to ) ||\n\t       interpolators.array( from, to ) ||\n\t       interpolators.object( from, to ) ||\n\t       null;\n}\n\nfunction snap ( to ) {\n\treturn function () { return to; };\n}\n\nvar interpolators = {\n\tnumber: function number ( from, to ) {\n\t\tif ( !isNumeric( from ) || !isNumeric( to ) ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tfrom = +from;\n\t\tto = +to;\n\n\t\tvar delta = to - from;\n\n\t\tif ( !delta ) {\n\t\t\treturn function () { return from; };\n\t\t}\n\n\t\treturn function ( t ) {\n\t\t\treturn from + ( t * delta );\n\t\t};\n\t},\n\n\tarray: function array ( from, to ) {\n\t\tvar len, i;\n\n\t\tif ( !isArray( from ) || !isArray( to ) ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tvar intermediate = [];\n\t\tvar interpolators = [];\n\n\t\ti = len = Math.min( from.length, to.length );\n\t\twhile ( i-- ) {\n\t\t\tinterpolators[i] = interpolate( from[i], to[i] );\n\t\t}\n\n\t\t// surplus values - don't interpolate, but don't exclude them either\n\t\tfor ( i=len; i<from.length; i+=1 ) {\n\t\t\tintermediate[i] = from[i];\n\t\t}\n\n\t\tfor ( i=len; i<to.length; i+=1 ) {\n\t\t\tintermediate[i] = to[i];\n\t\t}\n\n\t\treturn function ( t ) {\n\t\t\tvar i = len;\n\n\t\t\twhile ( i-- ) {\n\t\t\t\tintermediate[i] = interpolators[i]( t );\n\t\t\t}\n\n\t\t\treturn intermediate;\n\t\t};\n\t},\n\n\tobject: function object ( from, to ) {\n\t\tif ( !isObject( from ) || !isObject( to ) ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tvar properties = [];\n\t\tvar intermediate = {};\n\t\tvar interpolators = {};\n\n\t\tfor ( var prop in from ) {\n\t\t\tif ( hasOwn.call( from, prop ) ) {\n\t\t\t\tif ( hasOwn.call( to, prop ) ) {\n\t\t\t\t\tproperties.push( prop );\n\t\t\t\t\tinterpolators[ prop ] = interpolate( from[ prop ], to[ prop ] ) || snap( to[ prop ] );\n\t\t\t\t}\n\n\t\t\t\telse {\n\t\t\t\t\tintermediate[ prop ] = from[ prop ];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor ( var prop$1 in to ) {\n\t\t\tif ( hasOwn.call( to, prop$1 ) && !hasOwn.call( from, prop$1 ) ) {\n\t\t\t\tintermediate[ prop$1 ] = to[ prop$1 ];\n\t\t\t}\n\t\t}\n\n\t\tvar len = properties.length;\n\n\t\treturn function ( t ) {\n\t\t\tvar i = len;\n\n\t\t\twhile ( i-- ) {\n\t\t\t\tvar prop = properties[i];\n\n\t\t\t\tintermediate[ prop ] = interpolators[ prop ]( t );\n\t\t\t}\n\n\t\t\treturn intermediate;\n\t\t};\n\t}\n};\n\nfunction enqueue ( ractive, event ) {\n\tif ( ractive.event ) {\n\t\tractive._eventQueue.push( ractive.event );\n\t}\n\n\tractive.event = event;\n}\n\nfunction dequeue ( ractive ) {\n\tif ( ractive._eventQueue.length ) {\n\t\tractive.event = ractive._eventQueue.pop();\n\t} else {\n\t\tractive.event = null;\n\t}\n}\n\nvar initStars = {};\nvar bubleStars = {};\n\n// cartesian product of name parts and stars\n// adjusted appropriately for special cases\nfunction variants ( name, initial ) {\n\tvar map = initial ? initStars : bubleStars;\n\tif ( map[ name ] ) { return map[ name ]; }\n\n\tvar parts = name.split( '.' );\n\tvar result = [];\n\tvar base = false;\n\n\t// initial events the implicit namespace of 'this'\n\tif ( initial ) {\n\t\tparts.unshift( 'this' );\n\t\tbase = true;\n\t}\n\n\t// use max - 1 bits as a bitmap to pick a part or a *\n\t// need to skip the full star case if the namespace is synthetic\n\tvar max = Math.pow( 2, parts.length ) - ( initial ? 1 : 0 );\n\tfor ( var i = 0; i < max; i++ ) {\n\t\tvar join = [];\n\t\tfor ( var j = 0; j < parts.length; j++ ) {\n\t\t\tjoin.push( 1 & ( i >> j ) ? '*' : parts[j] );\n\t\t}\n\t\tresult.unshift( join.join( '.' ) );\n\t}\n\n\tif ( base ) {\n\t\t// include non-this-namespaced versions\n\t\tif ( parts.length > 2 ) {\n\t\t\tresult.push.apply( result, variants( name, false ) );\n\t\t} else {\n\t\t\tresult.push( '*' );\n\t\t\tresult.push( name );\n\t\t}\n\t}\n\n\tmap[ name ] = result;\n\treturn result;\n}\n\nfunction fireEvent ( ractive, eventName, options ) {\n\tif ( options === void 0 ) options = {};\n\n\tif ( !eventName ) { return; }\n\n\tif ( !options.event ) {\n\t\toptions.event = {\n\t\t\tname: eventName,\n\t\t\t// until event not included as argument default\n\t\t\t_noArg: true\n\t\t};\n\t} else {\n\t\toptions.event.name = eventName;\n\t}\n\n\tvar eventNames = variants( eventName, true );\n\n\treturn fireEventAs( ractive, eventNames, options.event, options.args, true );\n}\n\nfunction fireEventAs  ( ractive, eventNames, event, args, initialFire ) {\n\tif ( initialFire === void 0 ) initialFire = false;\n\n\tvar subscribers, i;\n\tvar bubble = true;\n\n\tenqueue( ractive, event );\n\n\tfor ( i = eventNames.length; i >= 0; i-- ) {\n\t\tsubscribers = ractive._subs[ eventNames[ i ] ];\n\n\t\tif ( subscribers ) {\n\t\t\tbubble = notifySubscribers( ractive, subscribers, event, args ) && bubble;\n\t\t}\n\t}\n\n\tdequeue( ractive );\n\n\tif ( ractive.parent && bubble ) {\n\n\t\tif ( initialFire && ractive.component ) {\n\t\t\tvar fullName = ractive.component.name + '.' + eventNames[ eventNames.length - 1 ];\n\t\t\teventNames = variants( fullName, false );\n\n\t\t\tif ( event && !event.component ) {\n\t\t\t\tevent.component = ractive;\n\t\t\t}\n\t\t}\n\n\t\tfireEventAs( ractive.parent, eventNames, event, args );\n\t}\n\n\treturn bubble;\n}\n\nfunction notifySubscribers ( ractive, subscribers, event, args ) {\n\tvar originalEvent = null;\n\tvar stopEvent = false;\n\n\tif ( event && !event._noArg ) {\n\t\targs = [ event ].concat( args );\n\t}\n\n\t// subscribers can be modified inflight, e.g. \"once\" functionality\n\t// so we need to copy to make sure everyone gets called\n\tsubscribers = subscribers.slice();\n\n\tfor ( var i = 0, len = subscribers.length; i < len; i += 1 ) {\n\t\tif ( !subscribers[ i ].off && subscribers[ i ].apply( ractive, args ) === false ) {\n\t\t\tstopEvent = true;\n\t\t}\n\t}\n\n\tif ( event && !event._noArg && stopEvent && ( originalEvent = event.original ) ) {\n\t\toriginalEvent.preventDefault && originalEvent.preventDefault();\n\t\toriginalEvent.stopPropagation && originalEvent.stopPropagation();\n\t}\n\n\treturn !stopEvent;\n}\n\nvar Hook = function Hook ( event ) {\n\tthis.event = event;\n\tthis.method = 'on' + event;\n};\n\nHook.prototype.fire = function fire ( ractive, arg ) {\n\tif ( ractive[ this.method ] ) {\n\t\targ ? ractive[ this.method ]( arg ) : ractive[ this.method ]();\n\t}\n\n\tvar options = { args: [] };\n\tif ( arg ) { options.args.push( arg ); }\n\toptions.args.push( ractive );\n\tfireEvent( ractive, this.event, options );\n};\n\nfunction addToArray ( array, value ) {\n\tvar index = array.indexOf( value );\n\n\tif ( index === -1 ) {\n\t\tarray.push( value );\n\t}\n}\n\nfunction arrayContains ( array, value ) {\n\tfor ( var i = 0, c = array.length; i < c; i++ ) {\n\t\tif ( array[i] == value ) {\n\t\t\treturn true;\n\t\t}\n\t}\n\n\treturn false;\n}\n\nfunction arrayContentsMatch ( a, b ) {\n\tvar i;\n\n\tif ( !isArray( a ) || !isArray( b ) ) {\n\t\treturn false;\n\t}\n\n\tif ( a.length !== b.length ) {\n\t\treturn false;\n\t}\n\n\ti = a.length;\n\twhile ( i-- ) {\n\t\tif ( a[i] !== b[i] ) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn true;\n}\n\nfunction ensureArray ( x ) {\n\tif ( typeof x === 'string' ) {\n\t\treturn [ x ];\n\t}\n\n\tif ( x === undefined ) {\n\t\treturn [];\n\t}\n\n\treturn x;\n}\n\nfunction lastItem ( array ) {\n\treturn array[ array.length - 1 ];\n}\n\nfunction removeFromArray ( array, member ) {\n\tif ( !array ) {\n\t\treturn;\n\t}\n\n\tvar index = array.indexOf( member );\n\n\tif ( index !== -1 ) {\n\t\tarray.splice( index, 1 );\n\t}\n}\n\nfunction combine ( first ) {\n\tvar rest = [], len = arguments.length - 1;\n\twhile ( len-- > 0 ) rest[ len ] = arguments[ len + 1 ];\n\n\tvar res = first.slice();\n\trest = rest.concat.apply( [], rest );\n\n\tvar i = rest.length;\n\twhile ( i-- ) {\n\t\tif ( !~res.indexOf( rest[i] ) ) {\n\t\t\tres.push( rest[i] );\n\t\t}\n\t}\n\n\treturn res;\n}\n\nfunction toArray ( arrayLike ) {\n\tvar array = [];\n\tvar i = arrayLike.length;\n\twhile ( i-- ) {\n\t\tarray[i] = arrayLike[i];\n\t}\n\n\treturn array;\n}\n\nfunction find$1 ( array, fn ) {\n\tvar len = array.length;\n\tfor ( var i = 0; i < len; i++ ) {\n\t\tif ( fn( array[i] ) ) { return array[i]; }\n\t}\n}\n\nfunction findMap ( array, fn ) {\n\tvar len = array.length;\n\tfor ( var i = 0; i < len; i++ ) {\n\t\tvar result = fn( array[i] );\n\t\tif ( result ) { return result; }\n\t}\n}\n\nvar _Promise;\nvar PENDING = {};\nvar FULFILLED = {};\nvar REJECTED = {};\n\nif ( typeof Promise === 'function' ) {\n\t// use native Promise\n\t_Promise = Promise;\n} else {\n\t_Promise = function ( callback ) {\n\t\tvar fulfilledHandlers = [];\n\t\tvar rejectedHandlers = [];\n\t\tvar state = PENDING;\n\t\tvar result, dispatchHandlers;\n\n\t\tvar makeResolver = function ( newState ) {\n\t\t\treturn function ( value ) {\n\t\t\t\tif ( state !== PENDING ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tresult = value;\n\t\t\t\tstate = newState;\n\n\t\t\t\tdispatchHandlers = makeDispatcher( ( state === FULFILLED ? fulfilledHandlers : rejectedHandlers ), result );\n\n\t\t\t\t// dispatch onFulfilled and onRejected handlers asynchronously\n\t\t\t\twait( dispatchHandlers );\n\t\t\t};\n\t\t};\n\n\t\tvar fulfil = makeResolver( FULFILLED );\n\t\tvar reject = makeResolver( REJECTED );\n\n\t\ttry {\n\t\t\tcallback( fulfil, reject );\n\t\t} catch ( err ) {\n\t\t\treject( err );\n\t\t}\n\n\t\tvar promise = {\n\t\t\t// `then()` returns a Promise - 2.2.7\n\t\t\tthen: function then ( onFulfilled, onRejected ) {\n\t\t\t\tvar promise2 = new _Promise( function ( fulfil, reject ) {\n\n\t\t\t\t\tvar processResolutionHandler = function ( handler, handlers, forward ) {\n\n\t\t\t\t\t\t// 2.2.1.1\n\t\t\t\t\t\tif ( typeof handler === 'function' ) {\n\t\t\t\t\t\t\thandlers.push( function ( p1result ) {\n\t\t\t\t\t\t\t\tvar x;\n\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\tx = handler( p1result );\n\t\t\t\t\t\t\t\t\tresolve$1( promise2, x, fulfil, reject );\n\t\t\t\t\t\t\t\t} catch ( err ) {\n\t\t\t\t\t\t\t\t\treject( err );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Forward the result of promise1 to promise2, if resolution handlers\n\t\t\t\t\t\t\t// are not given\n\t\t\t\t\t\t\thandlers.push( forward );\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\n\t\t\t\t\t// 2.2\n\t\t\t\t\tprocessResolutionHandler( onFulfilled, fulfilledHandlers, fulfil );\n\t\t\t\t\tprocessResolutionHandler( onRejected, rejectedHandlers, reject );\n\n\t\t\t\t\tif ( state !== PENDING ) {\n\t\t\t\t\t\t// If the promise has resolved already, dispatch the appropriate handlers asynchronously\n\t\t\t\t\t\twait( dispatchHandlers );\n\t\t\t\t\t}\n\n\t\t\t\t});\n\n\t\t\t\treturn promise2;\n\t\t\t}\n\t\t};\n\n\t\tpromise[ 'catch' ] = function ( onRejected ) {\n\t\t\treturn this.then( null, onRejected );\n\t\t};\n\n\t\treturn promise;\n\t};\n\n\t_Promise.all = function ( promises ) {\n\t\treturn new _Promise( function ( fulfil, reject ) {\n\t\t\tvar result = [];\n\t\t\tvar pending, i;\n\n\t\t\tif ( !promises.length ) {\n\t\t\t\tfulfil( result );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar processPromise = function ( promise, i ) {\n\t\t\t\tif ( promise && typeof promise.then === 'function' ) {\n\t\t\t\t\tpromise.then( function (value) {\n\t\t\t\t\t\tresult[i] = value;\n\t\t\t\t\t\t--pending || fulfil( result );\n\t\t\t\t\t}, reject );\n\t\t\t\t}\n\n\t\t\t\telse {\n\t\t\t\t\tresult[i] = promise;\n\t\t\t\t\t--pending || fulfil( result );\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tpending = i = promises.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tprocessPromise( promises[i], i );\n\t\t\t}\n\t\t});\n\t};\n\n\t_Promise.resolve = function ( value ) {\n\t\treturn new _Promise( function ( fulfil ) {\n\t\t\tfulfil( value );\n\t\t});\n\t};\n\n\t_Promise.reject = function ( reason ) {\n\t\treturn new _Promise( function ( fulfil, reject ) {\n\t\t\treject( reason );\n\t\t});\n\t};\n}\n\nvar Promise$1 = _Promise;\n\n// TODO use MutationObservers or something to simulate setImmediate\nfunction wait ( callback ) {\n\tsetTimeout( callback, 0 );\n}\n\nfunction makeDispatcher ( handlers, result ) {\n\treturn function () {\n\t\tvar handler;\n\n\t\twhile ( handler = handlers.shift() ) {\n\t\t\thandler( result );\n\t\t}\n\t};\n}\n\nfunction resolve$1 ( promise, x, fulfil, reject ) {\n\t// Promise Resolution Procedure\n\tvar then;\n\n\t// 2.3.1\n\tif ( x === promise ) {\n\t\tthrow new TypeError( 'A promise\\'s fulfillment handler cannot return the same promise' );\n\t}\n\n\t// 2.3.2\n\tif ( x instanceof _Promise ) {\n\t\tx.then( fulfil, reject );\n\t}\n\n\t// 2.3.3\n\telse if ( x && ( typeof x === 'object' || typeof x === 'function' ) ) {\n\t\ttry {\n\t\t\tthen = x.then; // 2.3.3.1\n\t\t} catch ( e ) {\n\t\t\treject( e ); // 2.3.3.2\n\t\t\treturn;\n\t\t}\n\n\t\t// 2.3.3.3\n\t\tif ( typeof then === 'function' ) {\n\t\t\tvar called;\n\n\t\t\tvar resolvePromise = function ( y ) {\n\t\t\t\tif ( called ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tcalled = true;\n\t\t\t\tresolve$1( promise, y, fulfil, reject );\n\t\t\t};\n\n\t\t\tvar rejectPromise = function ( r ) {\n\t\t\t\tif ( called ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tcalled = true;\n\t\t\t\treject( r );\n\t\t\t};\n\n\t\t\ttry {\n\t\t\t\tthen.call( x, resolvePromise, rejectPromise );\n\t\t\t} catch ( e ) {\n\t\t\t\tif ( !called ) { // 2.3.3.3.4.1\n\t\t\t\t\treject( e ); // 2.3.3.3.4.2\n\t\t\t\t\tcalled = true;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\telse {\n\t\t\tfulfil( x );\n\t\t}\n\t}\n\n\telse {\n\t\tfulfil( x );\n\t}\n}\n\nvar TransitionManager = function TransitionManager ( callback, parent ) {\n\tthis.callback = callback;\n\tthis.parent = parent;\n\n\tthis.intros = [];\n\tthis.outros = [];\n\n\tthis.children = [];\n\tthis.totalChildren = this.outroChildren = 0;\n\n\tthis.detachQueue = [];\n\tthis.outrosComplete = false;\n\n\tif ( parent ) {\n\t\tparent.addChild( this );\n\t}\n};\n\nTransitionManager.prototype.add = function add ( transition ) {\n\tvar list = transition.isIntro ? this.intros : this.outros;\n\tlist.push( transition );\n};\n\nTransitionManager.prototype.addChild = function addChild ( child ) {\n\tthis.children.push( child );\n\n\tthis.totalChildren += 1;\n\tthis.outroChildren += 1;\n};\n\nTransitionManager.prototype.decrementOutros = function decrementOutros () {\n\tthis.outroChildren -= 1;\n\tcheck( this );\n};\n\nTransitionManager.prototype.decrementTotal = function decrementTotal () {\n\tthis.totalChildren -= 1;\n\tcheck( this );\n};\n\nTransitionManager.prototype.detachNodes = function detachNodes () {\n\tthis.detachQueue.forEach( detach$1 );\n\tthis.children.forEach( _detachNodes );\n};\n\nTransitionManager.prototype.ready = function ready () {\n\tdetachImmediate( this );\n};\n\nTransitionManager.prototype.remove = function remove ( transition ) {\n\tvar list = transition.isIntro ? this.intros : this.outros;\n\tremoveFromArray( list, transition );\n\tcheck( this );\n};\n\nTransitionManager.prototype.start = function start () {\n\tthis.children.forEach( function (c) { return c.start(); } );\n\tthis.intros.concat( this.outros ).forEach( function (t) { return t.start(); } );\n\tthis.ready = true;\n\tcheck( this );\n};\n\nfunction detach$1 ( element ) {\n\telement.detach();\n}\n\nfunction _detachNodes ( tm ) { // _ to avoid transpiler quirk\n\ttm.detachNodes();\n}\n\nfunction check ( tm ) {\n\tif ( !tm.ready || tm.outros.length || tm.outroChildren ) { return; }\n\n\t// If all outros are complete, and we haven't already done this,\n\t// we notify the parent if there is one, otherwise\n\t// start detaching nodes\n\tif ( !tm.outrosComplete ) {\n\t\ttm.outrosComplete = true;\n\n\t\tif ( tm.parent && !tm.parent.outrosComplete ) {\n\t\t\ttm.parent.decrementOutros( tm );\n\t\t} else {\n\t\t\ttm.detachNodes();\n\t\t}\n\t}\n\n\t// Once everything is done, we can notify parent transition\n\t// manager and call the callback\n\tif ( !tm.intros.length && !tm.totalChildren ) {\n\t\tif ( typeof tm.callback === 'function' ) {\n\t\t\ttm.callback();\n\t\t}\n\n\t\tif ( tm.parent && !tm.notifiedTotal ) {\n\t\t\ttm.notifiedTotal = true;\n\t\t\ttm.parent.decrementTotal();\n\t\t}\n\t}\n}\n\n// check through the detach queue to see if a node is up or downstream from a\n// transition and if not, go ahead and detach it\nfunction detachImmediate ( manager ) {\n\tvar queue = manager.detachQueue;\n\tvar outros = collectAllOutros( manager );\n\n\tvar i = queue.length;\n\tvar j = 0;\n\tvar node, trans;\n\tstart: while ( i-- ) {\n\t\tnode = queue[i].node;\n\t\tj = outros.length;\n\t\twhile ( j-- ) {\n\t\t\ttrans = outros[j].element.node;\n\t\t\t// check to see if the node is, contains, or is contained by the transitioning node\n\t\t\tif ( trans === node || trans.contains( node ) || node.contains( trans ) ) { continue start; }\n\t\t}\n\n\t\t// no match, we can drop it\n\t\tqueue[i].detach();\n\t\tqueue.splice( i, 1 );\n\t}\n}\n\nfunction collectAllOutros ( manager, list ) {\n\tif ( !list ) {\n\t\tlist = [];\n\t\tvar parent = manager;\n\t\twhile ( parent.parent ) { parent = parent.parent; }\n\t\treturn collectAllOutros( parent, list );\n\t} else {\n\t\tvar i = manager.children.length;\n\t\twhile ( i-- ) {\n\t\t\tlist = collectAllOutros( manager.children[i], list );\n\t\t}\n\t\tlist = list.concat( manager.outros );\n\t\treturn list;\n\t}\n}\n\nvar changeHook = new Hook( 'change' );\n\nvar batch;\n\nvar runloop = {\n\tstart: function start ( instance ) {\n\t\tvar fulfilPromise;\n\t\tvar promise = new Promise$1( function (f) { return ( fulfilPromise = f ); } );\n\n\t\tbatch = {\n\t\t\tpreviousBatch: batch,\n\t\t\ttransitionManager: new TransitionManager( fulfilPromise, batch && batch.transitionManager ),\n\t\t\tfragments: [],\n\t\t\ttasks: [],\n\t\t\timmediateObservers: [],\n\t\t\tdeferredObservers: [],\n\t\t\tractives: [],\n\t\t\tinstance: instance,\n\t\t\tpromise: promise\n\t\t};\n\n\t\treturn promise;\n\t},\n\n\tend: function end () {\n\t\tflushChanges();\n\n\t\tif ( !batch.previousBatch ) { batch.transitionManager.start(); }\n\n\t\tbatch = batch.previousBatch;\n\t},\n\n\taddFragment: function addFragment ( fragment ) {\n\t\taddToArray( batch.fragments, fragment );\n\t},\n\n\t// TODO: come up with a better way to handle fragments that trigger their own update\n\taddFragmentToRoot: function addFragmentToRoot ( fragment ) {\n\t\tif ( !batch ) { return; }\n\n\t\tvar b = batch;\n\t\twhile ( b.previousBatch ) {\n\t\t\tb = b.previousBatch;\n\t\t}\n\n\t\taddToArray( b.fragments, fragment );\n\t},\n\n\taddInstance: function addInstance ( instance ) {\n\t\tif ( batch ) { addToArray( batch.ractives, instance ); }\n\t},\n\n\taddObserver: function addObserver ( observer, defer ) {\n\t\taddToArray( defer ? batch.deferredObservers : batch.immediateObservers, observer );\n\t},\n\n\tregisterTransition: function registerTransition ( transition ) {\n\t\ttransition._manager = batch.transitionManager;\n\t\tbatch.transitionManager.add( transition );\n\t},\n\n\t// synchronise node detachments with transition ends\n\tdetachWhenReady: function detachWhenReady ( thing ) {\n\t\tbatch.transitionManager.detachQueue.push( thing );\n\t},\n\n\tscheduleTask: function scheduleTask ( task, postRender ) {\n\t\tvar _batch;\n\n\t\tif ( !batch ) {\n\t\t\ttask();\n\t\t} else {\n\t\t\t_batch = batch;\n\t\t\twhile ( postRender && _batch.previousBatch ) {\n\t\t\t\t// this can't happen until the DOM has been fully updated\n\t\t\t\t// otherwise in some situations (with components inside elements)\n\t\t\t\t// transitions and decorators will initialise prematurely\n\t\t\t\t_batch = _batch.previousBatch;\n\t\t\t}\n\n\t\t\t_batch.tasks.push( task );\n\t\t}\n\t},\n\n\tpromise: function promise () {\n\t\tif ( !batch ) { return Promise$1.resolve(); }\n\n\t\tvar target = batch;\n\t\twhile ( target.previousBatch ) {\n\t\t\ttarget = target.previousBatch;\n\t\t}\n\n\t\treturn target.promise || Promise$1.resolve();\n\t}\n};\n\nfunction dispatch$1 ( observer ) {\n\tobserver.dispatch();\n}\n\nfunction flushChanges () {\n\tvar which = batch.immediateObservers;\n\tbatch.immediateObservers = [];\n\twhich.forEach( dispatch$1 );\n\n\t// Now that changes have been fully propagated, we can update the DOM\n\t// and complete other tasks\n\tvar i = batch.fragments.length;\n\tvar fragment;\n\n\twhich = batch.fragments;\n\tbatch.fragments = [];\n\tvar ractives = batch.ractives;\n\tbatch.ractives = [];\n\n\twhile ( i-- ) {\n\t\tfragment = which[i];\n\n\t\t// TODO deprecate this. It's annoying and serves no useful function\n\t\tvar ractive = fragment.ractive;\n\t\tif ( Object.keys( ractive.viewmodel.changes ).length ) {\n\t\t\tchangeHook.fire( ractive, ractive.viewmodel.changes );\n\t\t}\n\t\tractive.viewmodel.changes = {};\n\t\tremoveFromArray( ractives, ractive );\n\n\t\tfragment.update();\n\t}\n\n\ti = ractives.length;\n\twhile ( i-- ) {\n\t\tvar ractive$1 = ractives[i];\n\t\tchangeHook.fire( ractive$1, ractive$1.viewmodel.changes );\n\t\tractive$1.viewmodel.changes = {};\n\t}\n\n\tbatch.transitionManager.ready();\n\n\twhich = batch.deferredObservers;\n\tbatch.deferredObservers = [];\n\twhich.forEach( dispatch$1 );\n\n\tvar tasks = batch.tasks;\n\tbatch.tasks = [];\n\n\tfor ( i = 0; i < tasks.length; i += 1 ) {\n\t\ttasks[i]();\n\t}\n\n\t// If updating the view caused some model blowback - e.g. a triple\n\t// containing <option> elements caused the binding on the <select>\n\t// to update - then we start over\n\tif ( batch.fragments.length || batch.immediateObservers.length || batch.deferredObservers.length || batch.ractives.length || batch.tasks.length ) { return flushChanges(); }\n}\n\nvar refPattern = /\\[\\s*(\\*|[0-9]|[1-9][0-9]+)\\s*\\]/g;\nvar splitPattern = /([^\\\\](?:\\\\\\\\)*)\\./;\nvar escapeKeyPattern = /\\\\|\\./g;\nvar unescapeKeyPattern = /((?:\\\\)+)\\1|\\\\(\\.)/g;\n\nfunction escapeKey ( key ) {\n\tif ( typeof key === 'string' ) {\n\t\treturn key.replace( escapeKeyPattern, '\\\\$&' );\n\t}\n\n\treturn key;\n}\n\nfunction normalise ( ref ) {\n\treturn ref ? ref.replace( refPattern, '.$1' ) : '';\n}\n\nfunction splitKeypath ( keypath ) {\n\tvar result = [];\n\tvar match;\n\n\tkeypath = normalise( keypath );\n\n\twhile ( match = splitPattern.exec( keypath ) ) {\n\t\tvar index = match.index + match[1].length;\n\t\tresult.push( keypath.substr( 0, index ) );\n\t\tkeypath = keypath.substr( index + 1 );\n\t}\n\n\tresult.push( keypath );\n\n\treturn result;\n}\n\nfunction unescapeKey ( key ) {\n\tif ( typeof key === 'string' ) {\n\t\treturn key.replace( unescapeKeyPattern, '$1$2' );\n\t}\n\n\treturn key;\n}\n\nfunction set$1 ( ractive, pairs ) {\n\tvar promise = runloop.start( ractive, true );\n\n\tvar i = pairs.length;\n\twhile ( i-- ) {\n\t\tvar model = pairs[i][0];\n\t\tvar value = pairs[i][1];\n\t\tvar keypath = pairs[i][2];\n\n\t\tif ( !model ) {\n\t\t\trunloop.end();\n\t\t\tthrow new Error( (\"Failed to set invalid keypath '\" + keypath + \"'\") );\n\t\t}\n\n\t\tmodel.set( value );\n\t}\n\n\trunloop.end();\n\n\treturn promise;\n}\n\nvar star = /\\*/;\nfunction gather ( ractive, keypath, base ) {\n\tif ( !base && keypath[0] === '.' ) {\n\t\twarnIfDebug( \"Attempted to set a relative keypath from a non-relative context. You can use a getNodeInfo or event object to set relative keypaths.\" );\n\t\treturn [];\n\t}\n\n\tvar model = base || ractive.viewmodel;\n\tif ( star.test( keypath ) ) {\n\t\treturn model.findMatches( splitKeypath( keypath ) );\n\t} else {\n\t\treturn [ model.joinAll( splitKeypath( keypath ) ) ];\n\t}\n}\n\nfunction build ( ractive, keypath, value ) {\n\tvar sets = [];\n\n\t// set multiple keypaths in one go\n\tif ( isObject( keypath ) ) {\n\t\tvar loop = function ( k ) {\n\t\t\tif ( keypath.hasOwnProperty( k ) ) {\n\t\t\t\tsets.push.apply( sets, gather( ractive, k ).map( function (m) { return [ m, keypath[k], k ]; } ) );\n\t\t\t}\n\t\t};\n\n\t\tfor ( var k in keypath ) loop( k );\n\n\t}\n\t// set a single keypath\n\telse {\n\t\tsets.push.apply( sets, gather( ractive, keypath ).map( function (m) { return [ m, value, keypath ]; } ) );\n\t}\n\n\treturn sets;\n}\n\nvar errorMessage = 'Cannot add to a non-numeric value';\n\nfunction add$1 ( ractive, keypath, d ) {\n\tif ( typeof keypath !== 'string' || !isNumeric( d ) ) {\n\t\tthrow new Error( 'Bad arguments' );\n\t}\n\n\tvar sets = build( ractive, keypath, d );\n\n\treturn set$1( ractive, sets.map( function (pair) {\n\t\tvar model = pair[0];\n\t\tvar add = pair[1];\n\t\tvar value = model.get();\n\t\tif ( !isNumeric( add ) || !isNumeric( value ) ) { throw new Error( errorMessage ); }\n\t\treturn [ model, value + add ];\n\t}));\n}\n\nfunction Ractive$add ( keypath, d ) {\n\treturn add$1( this, keypath, ( d === undefined ? 1 : +d ) );\n}\n\nvar noAnimation = Promise$1.resolve();\ndefineProperty( noAnimation, 'stop', { value: noop });\n\nvar linear$1 = easing.linear;\n\nfunction getOptions ( options, instance ) {\n\toptions = options || {};\n\n\tvar easing$$1;\n\tif ( options.easing ) {\n\t\teasing$$1 = typeof options.easing === 'function' ?\n\t\t\toptions.easing :\n\t\t\tinstance.easing[ options.easing ];\n\t}\n\n\treturn {\n\t\teasing: easing$$1 || linear$1,\n\t\tduration: 'duration' in options ? options.duration : 400,\n\t\tcomplete: options.complete || noop,\n\t\tstep: options.step || noop\n\t};\n}\n\nfunction animate$1 ( ractive, model, to, options ) {\n\toptions = getOptions( options, ractive );\n\tvar from = model.get();\n\n\t// don't bother animating values that stay the same\n\tif ( isEqual( from, to ) ) {\n\t\toptions.complete( options.to );\n\t\treturn noAnimation; // TODO should this have .then and .catch methods?\n\t}\n\n\tvar interpolator = interpolate( from, to, ractive, options.interpolator );\n\n\t// if we can't interpolate the value, set it immediately\n\tif ( !interpolator ) {\n\t\trunloop.start();\n\t\tmodel.set( to );\n\t\trunloop.end();\n\n\t\treturn noAnimation;\n\t}\n\n\treturn model.animate( from, to, options, interpolator );\n}\n\nfunction Ractive$animate ( keypath, to, options ) {\n\tif ( typeof keypath === 'object' ) {\n\t\tvar keys = Object.keys( keypath );\n\n\t\tthrow new Error( (\"ractive.animate(...) no longer supports objects. Instead of ractive.animate({\\n  \" + (keys.map( function (key) { return (\"'\" + key + \"': \" + (keypath[ key ])); } ).join( '\\n  ' )) + \"\\n}, {...}), do\\n\\n\" + (keys.map( function (key) { return (\"ractive.animate('\" + key + \"', \" + (keypath[ key ]) + \", {...});\"); } ).join( '\\n' )) + \"\\n\") );\n\t}\n\n\n\treturn animate$1( this, this.viewmodel.joinAll( splitKeypath( keypath ) ), to, options );\n}\n\nfunction updateLiveQueries ( element ) {\n\t// Does this need to be added to any live queries?\n\tvar node = element.node;\n\tvar instance = element.ractive;\n\tvar queries = [];\n\tvar remotes = {};\n\tvar remote = instance.component && instance.component.target === false;\n\tvar i;\n\n\tdo {\n\t\tvar liveQueries = instance._liveQueries;\n\n\t\ti = liveQueries.length;\n\t\twhile ( i-- ) {\n\t\t\tvar query = liveQueries[i];\n\n\t\t\tif ( query.test( node ) ) {\n\t\t\t\tqueries.push( query );\n\t\t\t}\n\t\t}\n\n\t\tif ( !remote && instance.component && instance.component.target === false ) { remote = true; }\n\t\tremotes[ instance._guid ] = remote;\n\t} while ( instance = instance.parent );\n\n\ti = queries.length;\n\twhile ( i-- ) {\n\t\tvar query$1 = queries[i];\n\t\tif ( query$1.remote || !remotes[ query$1.ractive._guid ] ) {\n\t\t\tquery$1.add( node );\n\t\t\t// keep register of applicable selectors, for when we teardown\n\t\t\telement.liveQueries.push( query$1 );\n\t\t}\n\t}\n}\n\n// TODO it's unfortunate that this has to run every time a\n// component is rendered... is there a better way?\nfunction updateLiveQueries$1 ( component ) {\n\t// Does this need to be added to any live queries?\n\tvar instance = component.ractive;\n\tvar queries = [];\n\tvar remotes = {};\n\tvar remote = component.target === false;\n\tvar i;\n\n\tdo {\n\t\tvar liveQueries = instance._liveComponentQueries;\n\n\t\ti = liveQueries.length;\n\t\twhile ( i-- ) {\n\t\t\tvar query = liveQueries[i];\n\n\t\t\tif ( query.test( component ) ) {\n\t\t\t\tqueries.push( query );\n\t\t\t}\n\t\t}\n\n\t\tif ( !remote && instance.component && instance.component.target === false ) { remote = true; }\n\t\tremotes[ instance._guid ] = remote;\n\t} while ( instance = instance.parent );\n\n\ti = queries.length;\n\twhile ( i-- ) {\n\t\tvar query$1 = queries[i];\n\t\tif ( query$1.remote || !remotes[ query$1.ractive._guid ] ) {\n\t\t\tquery$1.add( component.instance );\n\t\t\t// keep register of applicable selectors, for when we teardown\n\t\t\tcomponent.liveQueries.push( query$1 );\n\t\t}\n\t}\n}\n\nfunction findAnchors ( fragment, name ) {\n\tif ( name === void 0 ) name = null;\n\n\tvar res = [];\n\n\tfindAnchorsIn( fragment, name, res );\n\n\treturn res;\n}\n\nfunction findAnchorsIn ( item, name, result ) {\n\tif ( item.isAnchor ) {\n\t\tif ( !name || item.name === name ) {\n\t\t\tresult.push( item );\n\t\t}\n\t} else if ( item.items ) {\n\t\titem.items.forEach( function (i) { return findAnchorsIn( i, name, result ); } );\n\t} else if ( item.iterations ) {\n\t\titem.iterations.forEach( function (i) { return findAnchorsIn( i, name, result ); } );\n\t} else if ( item.fragment && !item.component ) {\n\t\tfindAnchorsIn( item.fragment, name, result );\n\t}\n}\n\nfunction updateAnchors ( instance, name ) {\n\tif ( name === void 0 ) name = null;\n\n\tvar anchors = findAnchors( instance.fragment, name );\n\tvar idxs = {};\n\tvar children = instance._children.byName;\n\n\tanchors.forEach( function (a) {\n\t\tvar name = a.name;\n\t\tif ( !( name in idxs ) ) { idxs[name] = 0; }\n\t\tvar idx = idxs[name];\n\t\tvar child = ( children[name] || [] )[idx];\n\n\t\tif ( child && child.lastBound !== a ) {\n\t\t\tif ( child.lastBound ) { child.lastBound.removeChild( child ); }\n\t\t\ta.addChild( child );\n\t\t}\n\n\t\tidxs[name]++;\n\t});\n}\n\nfunction unrenderChild ( meta ) {\n\tif ( meta.instance.fragment.rendered ) {\n\t\tmeta.shouldDestroy = true;\n\t\tmeta.instance.unrender();\n\t}\n\tmeta.instance.el = null;\n}\n\nvar attachHook = new Hook( 'attachchild' );\n\nfunction attachChild ( child, options ) {\n\tif ( options === void 0 ) options = {};\n\n\tvar children = this._children;\n\n\tif ( child.parent && child.parent !== this ) { throw new Error( (\"Instance \" + (child._guid) + \" is already attached to a different instance \" + (child.parent._guid) + \". Please detach it from the other instance using detachChild first.\") ); }\n\telse if ( child.parent ) { throw new Error( (\"Instance \" + (child._guid) + \" is already attached to this instance.\") ); }\n\n\tvar meta = {\n\t\tinstance: child,\n\t\tractive: this,\n\t\tname: options.name || child.constructor.name || 'Ractive',\n\t\tliveQueries: [],\n\t\ttarget: options.target || false,\n\t\tbubble: bubble$1,\n\t\tfindNextNode: findNextNode$1,\n\t\tremoveFromQuery: removeFromQuery$1\n\t};\n\tmeta.nameOption = options.name;\n\n\t// child is managing itself\n\tif ( !meta.target ) {\n\t\tmeta.parentFragment = this.fragment;\n\t\tmeta.external = true;\n\t} else {\n\t\tvar list;\n\t\tif ( !( list = children.byName[ meta.target ] ) ) {\n\t\t\tlist = [];\n\t\t\tthis.set( (\"@this.children.byName.\" + (meta.target)), list );\n\t\t}\n\t\tvar idx = options.prepend ? 0 : options.insertAt || list.length;\n\t\tlist.splice( idx, 0, meta );\n\t}\n\n\tchild.set({\n\t\t'@this.parent': this,\n\t\t'@this.root': this.root\n\t});\n\tchild.component = meta;\n\tchildren.push( meta );\n\n\tattachHook.fire( child );\n\n\tvar promise = runloop.start( child, true );\n\n\tif ( meta.target ) {\n\t\tunrenderChild( meta );\n\t\tthis.merge( (\"@this.children.byName.\" + (meta.target)) );\n\t\tupdateAnchors( this, meta.target );\n\t} else {\n\t\tif ( !child.isolated ) { child.viewmodel.attached( this.fragment ); }\n\t\tif ( child.fragment.rendered ) {\n\t\t\tchild.findAll( '*' ).forEach( function (el) { return updateLiveQueries( el._ractive.proxy ); } );\n\t\t\tchild.findAllComponents().forEach( function (cmp) { return updateLiveQueries$1( cmp.component ); } );\n\t\t\tupdateLiveQueries$1( meta );\n\t\t}\n\t}\n\n\trunloop.end();\n\n\tpromise.ractive = child;\n\treturn promise.then( function () { return child; } );\n}\n\nfunction bubble$1 () { runloop.addFragment( this.instance.fragment ); }\n\nfunction removeFromQuery$1 ( query ) {\n\tquery.remove( this.instance );\n\tremoveFromArray( this.liveQueries, query );\n}\n\nfunction findNextNode$1 () {\n\tif ( this.anchor ) { return this.anchor.findNextNode(); }\n}\n\nvar detachHook = new Hook( 'detach' );\n\nfunction Ractive$detach () {\n\tif ( this.isDetached ) {\n\t\treturn this.el;\n\t}\n\n\tif ( this.el ) {\n\t\tremoveFromArray( this.el.__ractive_instances__, this );\n\t}\n\n\tthis.el = this.fragment.detach();\n\tthis.isDetached = true;\n\n\tdetachHook.fire( this );\n\treturn this.el;\n}\n\nvar detachHook$1 = new Hook( 'detachchild' );\n\nfunction detachChild ( child ) {\n\tvar this$1 = this;\n\n\tvar children = this._children;\n\tvar meta, index;\n\n\tvar i = children.length;\n\twhile ( i-- ) {\n\t\tif ( children[i].instance === child ) {\n\t\t\tindex = i;\n\t\t\tmeta = children[i];\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif ( !meta || child.parent !== this ) { throw new Error( (\"Instance \" + (child._guid) + \" is not attached to this instance.\") ); }\n\n\tvar promise = runloop.start( child, true );\n\n\tif ( meta.anchor ) { meta.anchor.removeChild( meta ); }\n\tif ( !child.isolated ) { child.viewmodel.detached(); }\n\n\trunloop.end();\n\n\tchildren.splice( index, 1 );\n\tif ( meta.target ) {\n\t\tvar list = children.byName[ meta.target ];\n\t\tlist.splice( list.indexOf( meta ), 1 );\n\t\tthis.merge( (\"@this.children.byName.\" + (meta.target)) );\n\t\tupdateAnchors( this, meta.target );\n\t}\n\tchild.set({\n\t\t'@this.parent': undefined,\n\t\t'@this.root': child\n\t});\n\tchild.component = null;\n\n\tdetachHook$1.fire( child );\n\n\tif ( !meta.target && child.fragment.rendered ) {\n\t\t// keep live queries up to date\n\t\tchild.findAll( '*' ).forEach( function (el) {\n\t\t\tel._ractive.proxy.liveQueries.forEach( function (q) {\n\t\t\t\t// remove from non-self queries\n\t\t\t\tif ( isParent( this$1, q.ractive ) ) { el._ractive.proxy.removeFromQuery( q ); }\n\t\t\t});\n\t\t});\n\n\t\t// keep live component queries up to date\n\t\tchild.findAllComponents().forEach( function (cmp) {\n\t\t\tcmp.component.liveQueries.forEach( function (q) {\n\t\t\t\tif ( isParent( this$1, q.ractive ) ) { cmp.component.removeFromQuery( q ); }\n\t\t\t});\n\t\t});\n\n\t\tmeta.liveQueries.forEach( function (q) { return meta.removeFromQuery( q ); } );\n\t}\n\n\tpromise.ractive = child;\n\treturn promise.then( function () { return child; } );\n}\n\nfunction isParent ( target, check ) {\n\twhile ( target ) {\n\t\tif ( target === check ) { return true; }\n\t\ttarget = target.parent;\n\t}\n}\n\nfunction Ractive$find ( selector, options ) {\n\tvar this$1 = this;\n\tif ( options === void 0 ) options = {};\n\n\tif ( !this.el ) { throw new Error( (\"Cannot call ractive.find('\" + selector + \"') unless instance is rendered to the DOM\") ); }\n\n\tvar node = this.fragment.find( selector, options );\n\tif ( node ) { return node; }\n\n\tif ( options.remote ) {\n\t\tfor ( var i = 0; i < this._children.length; i++ ) {\n\t\t\tif ( !this$1._children[i].instance.fragment.rendered ) { continue; }\n\t\t\tnode = this$1._children[i].instance.find( selector, options );\n\t\t\tif ( node ) { return node; }\n\t\t}\n\t}\n}\n\nfunction sortByDocumentPosition ( node, otherNode ) {\n\tif ( node.compareDocumentPosition ) {\n\t\tvar bitmask = node.compareDocumentPosition( otherNode );\n\t\treturn ( bitmask & 2 ) ? 1 : -1;\n\t}\n\n\t// In old IE, we can piggy back on the mechanism for\n\t// comparing component positions\n\treturn sortByItemPosition( node, otherNode );\n}\n\nfunction sortByItemPosition ( a, b ) {\n\tvar baseA = a.component || a._ractive.proxy;\n\tvar baseB = b.component || b._ractive.proxy;\n\n\t// allow for attached childdren outside the template\n\tif ( baseA.target === false && baseB.target === false ) { return 0; }\n\telse if ( baseA.target === false ) { return 1; }\n\telse if ( baseB.target === false ) { return -1; }\n\n\tvar ancestryA = getAncestry( baseA );\n\tvar ancestryB = getAncestry( baseB );\n\n\tvar oldestA = lastItem( ancestryA );\n\tvar oldestB = lastItem( ancestryB );\n\tvar mutualAncestor;\n\n\t// remove items from the end of both ancestries as long as they are identical\n\t// - the final one removed is the closest mutual ancestor\n\twhile ( oldestA && ( oldestA === oldestB ) ) {\n\t\tancestryA.pop();\n\t\tancestryB.pop();\n\n\t\tmutualAncestor = oldestA;\n\n\t\toldestA = lastItem( ancestryA );\n\t\toldestB = lastItem( ancestryB );\n\t}\n\n\t// now that we have the mutual ancestor, we can find which is earliest\n\toldestA = oldestA.component || oldestA;\n\toldestB = oldestB.component || oldestB;\n\n\tvar fragmentA = oldestA.parentFragment;\n\tvar fragmentB = oldestB.parentFragment;\n\n\t// if both items share a parent fragment, our job is easy\n\tif ( fragmentA === fragmentB ) {\n\t\tvar indexA = fragmentA.items.indexOf( oldestA );\n\t\tvar indexB = fragmentB.items.indexOf( oldestB );\n\n\t\t// if it's the same index, it means one contains the other,\n\t\t// so we see which has the longest ancestry\n\t\treturn ( indexA - indexB ) || ancestryA.length - ancestryB.length;\n\t}\n\n\t// if mutual ancestor is a section, we first test to see which section\n\t// fragment comes first\n\tvar fragments = mutualAncestor.iterations;\n\tif ( fragments ) {\n\t\tvar indexA$1 = fragments.indexOf( fragmentA );\n\t\tvar indexB$1 = fragments.indexOf( fragmentB );\n\n\t\treturn ( indexA$1 - indexB$1 ) || ancestryA.length - ancestryB.length;\n\t}\n\n\tthrow new Error( 'An unexpected condition was met while comparing the position of two components. Please file an issue at https://github.com/ractivejs/ractive/issues - thanks!' );\n}\n\nfunction getParent ( item ) {\n\tvar parentFragment = item.parentFragment;\n\n\tif ( parentFragment ) { return parentFragment.owner; }\n\n\tif ( item.component && ( parentFragment = item.component.parentFragment ) ) {\n\t\treturn parentFragment.owner;\n\t}\n}\n\nfunction getAncestry ( item ) {\n\tvar ancestry = [ item ];\n\tvar ancestor = getParent( item );\n\n\twhile ( ancestor ) {\n\t\tancestry.push( ancestor );\n\t\tancestor = getParent( ancestor );\n\t}\n\n\treturn ancestry;\n}\n\n\nvar Query = function Query ( ractive, selector, live, isComponentQuery ) {\n\tvar this$1 = this;\n\n\tthis.ractive = ractive;\n\tthis.selector = selector;\n\tthis.live = live;\n\tthis.isComponentQuery = isComponentQuery;\n\n\tthis.refs = 1;\n\n\tthis.result = [];\n\tthis.result.cancel = function () { return this$1.cancel(); };\n\n\tthis.dirty = true;\n};\n\nQuery.prototype.add = function add ( item ) {\n\tif ( !~this.result.indexOf( item ) ) {\n\t\tthis.result.push( item );\n\t\tthis.makeDirty();\n\t}\n};\n\nQuery.prototype.cancel = function cancel () {\n\t\tvar this$1 = this;\n\n\tif ( --this.refs ) { return; }\n\n\tthis.cancelled = true;\n\n\tvar liveQueries = this.ractive[ this.isComponentQuery ? '_liveComponentQueries' : '_liveQueries' ];\n\n\tvar index = liveQueries.indexOf( this );\n\n\tif ( index !== -1 ) {\n\t\tliveQueries.splice( index, 1 );\n\t}\n\n\tthis.result.forEach( function (item) {\n\t\titem = this$1.isComponentQuery ? item.component : item._ractive.proxy;\n\t\titem.removeFromQuery( this$1 );\n\t});\n};\n\nQuery.prototype.init = function init () {\n\tthis.dirty = false;\n};\n\nQuery.prototype.makeDirty = function makeDirty () {\n\t\tvar this$1 = this;\n\n\tif ( !this.dirty ) {\n\t\tthis.dirty = true;\n\n\t\t// Once the DOM has been updated, ensure the query\n\t\t// is correctly ordered\n\t\trunloop.scheduleTask( function () { return this$1.update(); } );\n\t}\n};\n\nQuery.prototype.remove = function remove ( item ) {\n\tif ( !this.cancelled ) {\n\t\tvar index = this.result.indexOf( item );\n\t\tif ( index !== -1 ) { this.result.splice( index, 1 ); }\n\t}\n};\n\nQuery.prototype.update = function update () {\n\tthis.result.sort( this.isComponentQuery ? sortByItemPosition : sortByDocumentPosition );\n\tthis.dirty = false;\n};\n\nQuery.prototype.test = function test ( item ) {\n\treturn this.isComponentQuery ?\n\t\t( !this.selector || item.name === this.selector ) :\n\t\t( item ? matches( item, this.selector ) : null );\n};\n\nfunction Ractive$findAll ( selector, options ) {\n\tif ( options === void 0 ) options = {};\n\n\tif ( !this.el ) { throw new Error( (\"Cannot call ractive.findAll('\" + selector + \"', ...) unless instance is rendered to the DOM\") ); }\n\n\tvar query = options._query;\n\n\tif ( !query ) {\n\t\tvar liveQueries = this._liveQueries;\n\n\t\t// Shortcut: if we're maintaining a live query with this\n\t\t// selector, we don't need to traverse the parallel DOM\n\t\tquery = find$1( liveQueries, function (q) { return q.selector === selector && q.remote === options.remote; } );\n\t\tif ( query ) {\n\t\t\tif ( options.live ) { query.refs++; }\n\t\t\t// Either return the exact same query, or (if not live) a snapshot\n\t\t\treturn options.live ? query : query.slice();\n\t\t}\n\n\t\tquery = new Query( this, selector, !!options.live, false );\n\t\toptions._query = query;\n\t\tquery.remote = options.remote;\n\n\t\t// Add this to the list of live queries Ractive needs to maintain,\n\t\t// if applicable\n\t\tif ( query.live ) {\n\t\t\tliveQueries.push( query );\n\t\t}\n\t}\n\n\tthis.fragment.findAll( selector, query );\n\n\tif ( query.remote ) {\n\t\t// seach non-fragment children\n\t\tthis._children.forEach( function (c) {\n\t\t\tif ( !c.target && c.instance.fragment && c.instance.fragment.rendered ) {\n\t\t\t\tc.instance.findAll( selector, options );\n\t\t\t}\n\t\t});\n\t}\n\n\tquery.init();\n\treturn query.result;\n}\n\nfunction Ractive$findAllComponents ( selector, options ) {\n\tif ( !options && typeof selector === 'object' ) {\n\t\toptions = selector;\n\t\tselector = '';\n\t}\n\n\toptions = options || {};\n\n\tvar query = options._query;\n\n\tif ( !query ) {\n\t\tvar liveQueries = this._liveComponentQueries;\n\n\t\t// Shortcut: if we're maintaining a live query with this\n\t\t// selector, we don't need to traverse the parallel DOM\n\t\tquery = find$1( liveQueries, function (q) { return q.selector === selector && q.remote === options.remote; } );\n\t\tif ( query ) {\n\t\t\tif ( options.live ) { query.refs++; }\n\t\t\t// Either return the exact same query, or (if not live) a snapshot\n\t\t\treturn ( options.live ) ? query : query.slice();\n\t\t}\n\n\t\tquery = new Query( this, selector, !!options.live, true );\n\t\toptions._query = query;\n\t\tquery.remote = options.remote;\n\n\t\t// Add this to the list of live queries Ractive needs to maintain,\n\t\t// if applicable\n\t\tif ( query.live ) {\n\t\t\tliveQueries.push( query );\n\t\t}\n\t}\n\n\tthis.fragment.findAllComponents( selector, query );\n\n\tif ( query.remote ) {\n\t\t// search non-fragment children\n\t\tthis._children.forEach( function (c) {\n\t\t\tif ( !c.target && c.instance.fragment && c.instance.fragment.rendered ) {\n\t\t\t\tif ( query.test( c ) ) {\n\t\t\t\t\tquery.add( c.instance );\n\t\t\t\t\tc.liveQueries.push( query );\n\t\t\t\t}\n\n\t\t\t\tc.instance.findAllComponents( selector, options );\n\t\t\t}\n\t\t});\n\t}\n\n\tquery.init();\n\treturn query.result;\n}\n\nfunction Ractive$findComponent ( selector, options ) {\n\tvar this$1 = this;\n\tif ( options === void 0 ) options = {};\n\n\tif ( typeof selector === 'object' ) {\n\t\toptions = selector;\n\t\tselector = '';\n\t}\n\n\tvar child = this.fragment.findComponent( selector, options );\n\tif ( child ) { return child; }\n\n\tif ( options.remote ) {\n\t\tif ( !selector && this._children.length ) { return this._children[0].instance; }\n\t\tfor ( var i = 0; i < this._children.length; i++ ) {\n\t\t\t// skip children that are or should be in an anchor\n\t\t\tif ( this$1._children[i].target ) { continue; }\n\t\t\tif ( this$1._children[i].name === selector ) { return this$1._children[i].instance; }\n\t\t\tchild = this$1._children[i].instance.findComponent( selector, options );\n\t\t\tif ( child ) { return child; }\n\t\t}\n\t}\n}\n\nfunction Ractive$findContainer ( selector ) {\n\tif ( this.container ) {\n\t\tif ( this.container.component && this.container.component.name === selector ) {\n\t\t\treturn this.container;\n\t\t} else {\n\t\t\treturn this.container.findContainer( selector );\n\t\t}\n\t}\n\n\treturn null;\n}\n\nfunction Ractive$findParent ( selector ) {\n\n\tif ( this.parent ) {\n\t\tif ( this.parent.component && this.parent.component.name === selector ) {\n\t\t\treturn this.parent;\n\t\t} else {\n\t\t\treturn this.parent.findParent ( selector );\n\t\t}\n\t}\n\n\treturn null;\n}\n\nfunction Ractive$fire ( eventName ) {\n\tvar args = [], len = arguments.length - 1;\n\twhile ( len-- > 0 ) args[ len ] = arguments[ len + 1 ];\n\n\treturn fireEvent( this, eventName, { args: args });\n}\n\nvar stack = [];\nvar captureGroup;\n\nfunction startCapturing () {\n\tstack.push( captureGroup = [] );\n}\n\nfunction stopCapturing () {\n\tvar dependencies = stack.pop();\n\tcaptureGroup = stack[ stack.length - 1 ];\n\treturn dependencies;\n}\n\nfunction capture ( model ) {\n\tif ( captureGroup ) {\n\t\tcaptureGroup.push( model );\n\t}\n}\n\nvar KeyModel = function KeyModel ( key, parent ) {\n\tthis.value = key;\n\tthis.isReadonly = this.isKey = true;\n\tthis.deps = [];\n\tthis.links = [];\n\tthis.parent = parent;\n};\n\nKeyModel.prototype.get = function get ( shouldCapture ) {\n\tif ( shouldCapture ) { capture( this ); }\n\treturn unescapeKey( this.value );\n};\n\nKeyModel.prototype.getKeypath = function getKeypath () {\n\treturn unescapeKey( this.value );\n};\n\nKeyModel.prototype.rebinding = function rebinding ( next, previous ) {\n\t\tvar this$1 = this;\n\n\tvar i = this.deps.length;\n\twhile ( i-- ) { this$1.deps[i].rebinding( next, previous, false ); }\n\n\ti = this.links.length;\n\twhile ( i-- ) { this$1.links[i].rebinding( next, previous, false ); }\n};\n\nKeyModel.prototype.register = function register ( dependant ) {\n\tthis.deps.push( dependant );\n};\n\nKeyModel.prototype.registerLink = function registerLink ( link ) {\n\taddToArray( this.links, link );\n};\n\nKeyModel.prototype.unregister = function unregister ( dependant ) {\n\tremoveFromArray( this.deps, dependant );\n};\n\nKeyModel.prototype.unregisterLink = function unregisterLink ( link ) {\n\tremoveFromArray( this.links, link );\n};\n\nfunction bind$1$1               ( x ) { x.bind(); }\nfunction cancel$1             ( x ) { x.cancel(); }\nfunction destroyed$1$1          ( x ) { x.destroyed(); }\nfunction handleChange$1$1       ( x ) { x.handleChange(); }\nfunction mark$1$1               ( x ) { x.mark(); }\nfunction marked             ( x ) { x.marked(); }\nfunction markedAll          ( x ) { x.markedAll(); }\nfunction notifiedUpstream   ( x ) { x.notifiedUpstream(); }\nfunction render$1$1             ( x ) { x.render(); }\nfunction shuffled$1$1           ( x )  { x.shuffled(); }\nfunction teardown$1$1           ( x ) { x.teardown(); }\nfunction unbind$1$1             ( x ) { x.unbind(); }\nfunction unrender$1$1           ( x ) { x.unrender(); }\nfunction unrenderAndDestroy ( x ) { x.unrender( true ); }\nfunction update$1$1             ( x ) { x.update(); }\nfunction toString$2           ( x ) { return x.toString(); }\nfunction toEscapedString    ( x ) { return x.toString( true ); }\n\nvar KeypathModel = function KeypathModel ( parent, ractive ) {\n\tthis.parent = parent;\n\tthis.ractive = ractive;\n\tthis.value = ractive ? parent.getKeypath( ractive ) : parent.getKeypath();\n\tthis.deps = [];\n\tthis.children = {};\n\tthis.isReadonly = this.isKeypath = true;\n};\n\nKeypathModel.prototype.get = function get ( shouldCapture ) {\n\tif ( shouldCapture ) { capture( this ); }\n\treturn this.value;\n};\n\nKeypathModel.prototype.getChild = function getChild ( ractive ) {\n\tif ( !( ractive._guid in this.children ) ) {\n\t\tvar model = new KeypathModel( this.parent, ractive );\n\t\tthis.children[ ractive._guid ] = model;\n\t\tmodel.owner = this;\n\t}\n\treturn this.children[ ractive._guid ];\n};\n\nKeypathModel.prototype.getKeypath = function getKeypath () {\n\treturn this.value;\n};\n\nKeypathModel.prototype.handleChange = function handleChange$1 () {\n\t\tvar this$1 = this;\n\n\tvar keys = Object.keys( this.children );\n\tvar i = keys.length;\n\twhile ( i-- ) {\n\t\tthis$1.children[ keys[i] ].handleChange();\n\t}\n\n\tthis.deps.forEach( handleChange$1$1 );\n};\n\nKeypathModel.prototype.rebindChildren = function rebindChildren ( next ) {\n\t\tvar this$1 = this;\n\n\tvar keys = Object.keys( this.children );\n\tvar i = keys.length;\n\twhile ( i-- ) {\n\t\tvar child = this$1.children[keys[i]];\n\t\tchild.value = next.getKeypath( child.ractive );\n\t\tchild.handleChange();\n\t}\n};\n\nKeypathModel.prototype.rebinding = function rebinding ( next, previous ) {\n\t\tvar this$1 = this;\n\n\tvar model = next ? next.getKeypathModel( this.ractive ) : undefined;\n\n\tvar keys = Object.keys( this.children );\n\tvar i = keys.length;\n\twhile ( i-- ) {\n\t\tthis$1.children[ keys[i] ].rebinding( next, previous, false );\n\t}\n\n\ti = this.deps.length;\n\twhile ( i-- ) {\n\t\tthis$1.deps[i].rebinding( model, this$1, false );\n\t}\n};\n\nKeypathModel.prototype.register = function register ( dep ) {\n\tthis.deps.push( dep );\n};\n\nKeypathModel.prototype.removeChild = function removeChild ( model ) {\n\tif ( model.ractive ) { delete this.children[ model.ractive._guid ]; }\n};\n\nKeypathModel.prototype.teardown = function teardown () {\n\t\tvar this$1 = this;\n\n\tif ( this.owner ) { this.owner.removeChild( this ); }\n\n\tvar keys = Object.keys( this.children );\n\tvar i = keys.length;\n\twhile ( i-- ) {\n\t\tthis$1.children[ keys[i] ].teardown();\n\t}\n};\n\nKeypathModel.prototype.unregister = function unregister ( dep ) {\n\tremoveFromArray( this.deps, dep );\n\tif ( !this.deps.length ) { this.teardown(); }\n};\n\nfunction bind$2 ( fn, context ) {\n\tif ( !/this/.test( fn.toString() ) ) { return fn; }\n\n\tvar bound = fn.bind( context );\n\tfor ( var prop in fn ) { bound[ prop ] = fn[ prop ]; }\n\n\treturn bound;\n}\n\nvar hasProp = Object.prototype.hasOwnProperty;\n\nvar shuffleTasks = { early: [], mark: [] };\nvar registerQueue = { early: [], mark: [] };\n\nvar ModelBase = function ModelBase ( parent ) {\n\tthis.deps = [];\n\n\tthis.children = [];\n\tthis.childByKey = {};\n\tthis.links = [];\n\n\tthis.keyModels = {};\n\n\tthis.unresolved = [];\n\tthis.unresolvedByKey = {};\n\n\tthis.bindings = [];\n\tthis.patternObservers = [];\n\n\tif ( parent ) {\n\t\tthis.parent = parent;\n\t\tthis.root = parent.root;\n\t}\n};\n\nModelBase.prototype.addUnresolved = function addUnresolved ( key, resolver ) {\n\tif ( !this.unresolvedByKey[ key ] ) {\n\t\tthis.unresolved.push( key );\n\t\tthis.unresolvedByKey[ key ] = [];\n\t}\n\n\tthis.unresolvedByKey[ key ].push( resolver );\n};\n\nModelBase.prototype.addShuffleTask = function addShuffleTask ( task, stage ) {\n\tif ( stage === void 0 ) stage = 'early';\n shuffleTasks[stage].push( task ); };\nModelBase.prototype.addShuffleRegister = function addShuffleRegister ( item, stage ) {\n\tif ( stage === void 0 ) stage = 'early';\n registerQueue[stage].push({ model: this, item: item }); };\n\nModelBase.prototype.clearUnresolveds = function clearUnresolveds ( specificKey ) {\n\t\tvar this$1 = this;\n\n\tvar i = this.unresolved.length;\n\n\twhile ( i-- ) {\n\t\tvar key = this$1.unresolved[i];\n\n\t\tif ( specificKey && key !== specificKey ) { continue; }\n\n\t\tvar resolvers = this$1.unresolvedByKey[ key ];\n\t\tvar hasKey = this$1.has( key );\n\n\t\tvar j = resolvers.length;\n\t\twhile ( j-- ) {\n\t\t\tif ( hasKey ) { resolvers[j].attemptResolution(); }\n\t\t\tif ( resolvers[j].resolved ) { resolvers.splice( j, 1 ); }\n\t\t}\n\n\t\tif ( !resolvers.length ) {\n\t\t\tthis$1.unresolved.splice( i, 1 );\n\t\t\tthis$1.unresolvedByKey[ key ] = null;\n\t\t}\n\t}\n};\n\nModelBase.prototype.findMatches = function findMatches ( keys ) {\n\tvar len = keys.length;\n\n\tvar existingMatches = [ this ];\n\tvar matches;\n\tvar i;\n\n\tvar loop = function (  ) {\n\t\tvar key = keys[i];\n\n\t\tif ( key === '*' ) {\n\t\t\tmatches = [];\n\t\t\texistingMatches.forEach( function (model) {\n\t\t\t\tmatches.push.apply( matches, model.getValueChildren( model.get() ) );\n\t\t\t});\n\t\t} else {\n\t\t\tmatches = existingMatches.map( function (model) { return model.joinKey( key ); } );\n\t\t}\n\n\t\texistingMatches = matches;\n\t};\n\n\t\tfor ( i = 0; i < len; i += 1 ) loop(  );\n\n\treturn matches;\n};\n\nModelBase.prototype.getKeyModel = function getKeyModel ( key, skip ) {\n\tif ( key !== undefined && !skip ) { return this.parent.getKeyModel( key, true ); }\n\n\tif ( !( key in this.keyModels ) ) { this.keyModels[ key ] = new KeyModel( escapeKey( key ), this ); }\n\n\treturn this.keyModels[ key ];\n};\n\nModelBase.prototype.getKeypath = function getKeypath ( ractive ) {\n\tif ( ractive !== this.ractive && this._link ) { return this._link.target.getKeypath( ractive ); }\n\n\tif ( !this.keypath ) {\n\t\tthis.keypath = this.parent.isRoot ? this.key : ((this.parent.getKeypath( ractive )) + \".\" + (escapeKey( this.key )));\n\t}\n\n\treturn this.keypath;\n};\n\nModelBase.prototype.getValueChildren = function getValueChildren ( value ) {\n\t\tvar this$1 = this;\n\n\tvar children;\n\tif ( isArray( value ) ) {\n\t\tchildren = [];\n\t\tif ( 'length' in this && this.length !== value.length ) {\n\t\t\tchildren.push( this.joinKey( 'length' ) );\n\t\t}\n\t\tvalue.forEach( function ( m, i ) {\n\t\t\tchildren.push( this$1.joinKey( i ) );\n\t\t});\n\t}\n\n\telse if ( isObject( value ) || typeof value === 'function' ) {\n\t\tchildren = Object.keys( value ).map( function (key) { return this$1.joinKey( key ); } );\n\t}\n\n\telse if ( value != null ) {\n\t\treturn [];\n\t}\n\n\treturn children;\n};\n\nModelBase.prototype.getVirtual = function getVirtual ( shouldCapture ) {\n\t\tvar this$1 = this;\n\n\tvar value = this.get( shouldCapture, { virtual: false } );\n\tif ( isObject( value ) ) {\n\t\tvar result = isArray( value ) ? [] : {};\n\n\t\tvar keys = Object.keys( value );\n\t\tvar i = keys.length;\n\t\twhile ( i-- ) {\n\t\t\tvar child = this$1.childByKey[ keys[i] ];\n\t\t\tif ( !child ) { result[ keys[i] ] = value[ keys[i] ]; }\n\t\t\telse if ( child._link ) { result[ keys[i] ] = child._link.getVirtual(); }\n\t\t\telse { result[ keys[i] ] = child.getVirtual(); }\n\t\t}\n\n\t\ti = this.children.length;\n\t\twhile ( i-- ) {\n\t\t\tvar child$1 = this$1.children[i];\n\t\t\tif ( !( child$1.key in result ) && child$1._link ) {\n\t\t\t\tresult[ child$1.key ] = child$1._link.getVirtual();\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t} else { return value; }\n};\n\nModelBase.prototype.has = function has ( key ) {\n\tif ( this._link ) { return this._link.has( key ); }\n\n\tvar value = this.get();\n\tif ( !value ) { return false; }\n\n\tkey = unescapeKey( key );\n\tif ( hasProp.call( value, key ) ) { return true; }\n\n\t// We climb up the constructor chain to find if one of them contains the key\n\tvar constructor = value.constructor;\n\twhile ( constructor !== Function && constructor !== Array && constructor !== Object ) {\n\t\tif ( hasProp.call( constructor.prototype, key ) ) { return true; }\n\t\tconstructor = constructor.constructor;\n\t}\n\n\treturn false;\n};\n\nModelBase.prototype.joinAll = function joinAll ( keys, opts ) {\n\tvar model = this;\n\tfor ( var i = 0; i < keys.length; i += 1 ) {\n\t\tif ( opts && opts.lastLink === false && i + 1 === keys.length && model.childByKey[keys[i]] && model.childByKey[keys[i]]._link ) { return model.childByKey[keys[i]]; }\n\t\tmodel = model.joinKey( keys[i], opts );\n\t}\n\n\treturn model;\n};\n\nModelBase.prototype.notifyUpstream = function notifyUpstream () {\n\tvar parent = this.parent;\n\tvar path = [ this.key ];\n\twhile ( parent ) {\n\t\tif ( parent.patternObservers.length ) { parent.patternObservers.forEach( function (o) { return o.notify( path.slice() ); } ); }\n\t\tpath.unshift( parent.key );\n\t\tparent.links.forEach( notifiedUpstream );\n\t\tparent.deps.forEach( handleChange$1$1 );\n\t\tparent = parent.parent;\n\t}\n};\n\nModelBase.prototype.rebinding = function rebinding ( next, previous, safe ) {\n\t\tvar this$1 = this;\n\n\t// tell the deps to move to the new target\n\tvar i = this.deps.length;\n\twhile ( i-- ) {\n\t\tif ( this$1.deps[i].rebinding ) { this$1.deps[i].rebinding( next, previous, safe ); }\n\t}\n\n\ti = this.links.length;\n\twhile ( i-- ) {\n\t\tvar link = this$1.links[i];\n\t\t// only relink the root of the link tree\n\t\tif ( link.owner._link ) { link.relinking( next, true, safe ); }\n\t}\n\n\ti = this.children.length;\n\twhile ( i-- ) {\n\t\tvar child = this$1.children[i];\n\t\tchild.rebinding( next ? next.joinKey( child.key ) : undefined, child, safe );\n\t}\n\n\ti = this.unresolved.length;\n\twhile ( i-- ) {\n\t\tvar unresolved = this$1.unresolvedByKey[ this$1.unresolved[i] ];\n\t\tvar c = unresolved.length;\n\t\twhile ( c-- ) {\n\t\t\tunresolved[c].rebinding( next, previous );\n\t\t}\n\t}\n\n\tif ( this.keypathModel ) { this.keypathModel.rebinding( next, previous, false ); }\n\n\ti = this.bindings.length;\n\twhile ( i-- ) {\n\t\tthis$1.bindings[i].rebinding( next, previous, safe );\n\t}\n};\n\nModelBase.prototype.register = function register ( dep ) {\n\tthis.deps.push( dep );\n};\n\nModelBase.prototype.registerChange = function registerChange ( key, value ) {\n\tif ( !this.isRoot ) {\n\t\tthis.root.registerChange( key, value );\n\t} else {\n\t\tthis.changes[ key ] = value;\n\t\trunloop.addInstance( this.root.ractive );\n\t}\n};\n\nModelBase.prototype.registerLink = function registerLink ( link ) {\n\taddToArray( this.links, link );\n};\n\nModelBase.prototype.registerPatternObserver = function registerPatternObserver ( observer ) {\n\tthis.patternObservers.push( observer );\n\tthis.register( observer );\n};\n\nModelBase.prototype.registerTwowayBinding = function registerTwowayBinding ( binding ) {\n\tthis.bindings.push( binding );\n};\n\nModelBase.prototype.removeUnresolved = function removeUnresolved ( key, resolver ) {\n\tvar resolvers = this.unresolvedByKey[ key ];\n\n\tif ( resolvers ) {\n\t\tremoveFromArray( resolvers, resolver );\n\t}\n};\n\nModelBase.prototype.shuffled = function shuffled () {\n\t\tvar this$1 = this;\n\n\tvar i = this.children.length;\n\twhile ( i-- ) {\n\t\tthis$1.children[i].shuffled();\n\t}\n\tif ( this.wrapper ) {\n\t\tthis.wrapper.teardown();\n\t\tthis.wrapper = null;\n\t\tthis.rewrap = true;\n\t}\n};\n\nModelBase.prototype.unregister = function unregister ( dependant ) {\n\tremoveFromArray( this.deps, dependant );\n};\n\nModelBase.prototype.unregisterLink = function unregisterLink ( link ) {\n\tremoveFromArray( this.links, link );\n};\n\nModelBase.prototype.unregisterPatternObserver = function unregisterPatternObserver ( observer ) {\n\tremoveFromArray( this.patternObservers, observer );\n\tthis.unregister( observer );\n};\n\nModelBase.prototype.unregisterTwowayBinding = function unregisterTwowayBinding ( binding ) {\n\tremoveFromArray( this.bindings, binding );\n};\n\nModelBase.prototype.updateFromBindings = function updateFromBindings$1 ( cascade ) {\n\t\tvar this$1 = this;\n\n\tvar i = this.bindings.length;\n\twhile ( i-- ) {\n\t\tvar value = this$1.bindings[i].getValue();\n\t\tif ( value !== this$1.value ) { this$1.set( value ); }\n\t}\n\n\t// check for one-way bindings if there are no two-ways\n\tif ( !this.bindings.length ) {\n\t\tvar oneway = findBoundValue( this.deps );\n\t\tif ( oneway && oneway.value !== this.value ) { this.set( oneway.value ); }\n\t}\n\n\tif ( cascade ) {\n\t\tthis.children.forEach( updateFromBindings );\n\t\tthis.links.forEach( updateFromBindings );\n\t\tif ( this._link ) { this._link.updateFromBindings( cascade ); }\n\t}\n};\n\n// TODO: this may be better handled by overreiding `get` on models with a parent that isRoot\nfunction maybeBind ( model, value, shouldBind ) {\n\tif ( shouldBind && typeof value === 'function' && model.parent && model.parent.isRoot ) {\n\t\tif ( !model.boundValue ) {\n\t\t\tmodel.boundValue = bind$2( value._r_unbound || value, model.parent.ractive );\n\t\t}\n\n\t\treturn model.boundValue;\n\t}\n\n\treturn value;\n}\n\nfunction updateFromBindings ( model ) {\n\tmodel.updateFromBindings( true );\n}\n\nfunction findBoundValue( list ) {\n\tvar i = list.length;\n\twhile ( i-- ) {\n\t\tif ( list[i].bound ) {\n\t\t\tvar owner = list[i].owner;\n\t\t\tif ( owner ) {\n\t\t\t\tvar value = owner.name === 'checked' ?\n\t\t\t\t\towner.node.checked :\n\t\t\t\t\towner.node.value;\n\t\t\t\treturn { value: value };\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction fireShuffleTasks ( stage ) {\n\tif ( !stage ) {\n\t\tfireShuffleTasks( 'early' );\n\t\tfireShuffleTasks( 'mark' );\n\t} else {\n\t\tvar tasks = shuffleTasks[stage];\n\t\tshuffleTasks[stage] = [];\n\t\tvar i = tasks.length;\n\t\twhile ( i-- ) { tasks[i](); }\n\n\t\tvar register = registerQueue[stage];\n\t\tregisterQueue[stage] = [];\n\t\ti = register.length;\n\t\twhile ( i-- ) { register[i].model.register( register[i].item ); }\n\t}\n}\n\nfunction shuffle$1$1 ( model, newIndices, link ) {\n\tmodel.shuffling = true;\n\n\tvar i = newIndices.length;\n\twhile ( i-- ) {\n\t\tvar idx = newIndices[ i ];\n\t\t// nothing is actually changing, so move in the index and roll on\n\t\tif ( i === idx ) {\n\t\t\tcontinue;\n\t\t}\n\n\t\t// rebind the children on i to idx\n\t\tif ( i in model.childByKey ) { model.childByKey[ i ].rebinding( !~idx ? undefined : model.joinKey( idx ), model.childByKey[ i ], true ); }\n\n\t\tif ( !~idx && model.keyModels[ i ] ) {\n\t\t\tmodel.keyModels[i].rebinding( undefined, model.keyModels[i], false );\n\t\t} else if ( ~idx && model.keyModels[ i ] ) {\n\t\t\tif ( !model.keyModels[ idx ] ) { model.childByKey[ idx ].getKeyModel( idx ); }\n\t\t\tmodel.keyModels[i].rebinding( model.keyModels[ idx ], model.keyModels[i], false );\n\t\t}\n\t}\n\n\tvar upstream = model.source().length !== model.source().value.length;\n\n\tmodel.links.forEach( function (l) { return l.shuffle( newIndices ); } );\n\tif ( !link ) { fireShuffleTasks( 'early' ); }\n\n\ti = model.deps.length;\n\twhile ( i-- ) {\n\t\tif ( model.deps[i].shuffle ) { model.deps[i].shuffle( newIndices ); }\n\t}\n\n\tmodel[ link ? 'marked' : 'mark' ]();\n\tif ( !link ) { fireShuffleTasks( 'mark' ); }\n\n\tif ( upstream ) { model.notifyUpstream(); }\n\n\tmodel.shuffling = false;\n}\n\nKeyModel.prototype.addShuffleTask = ModelBase.prototype.addShuffleTask;\nKeyModel.prototype.addShuffleRegister = ModelBase.prototype.addShuffleRegister;\nKeypathModel.prototype.addShuffleTask = ModelBase.prototype.addShuffleTask;\nKeypathModel.prototype.addShuffleRegister = ModelBase.prototype.addShuffleRegister;\n\n// this is the dry method of checking to see if a rebind applies to\n// a particular keypath because in some cases, a dep may be bound\n// directly to a particular keypath e.g. foo.bars.0.baz and need\n// to avoid getting kicked to foo.bars.1.baz if foo.bars is unshifted\nfunction rebindMatch ( template, next, previous ) {\n\tvar keypath = template.r || template;\n\n\t// no valid keypath, go with next\n\tif ( !keypath || typeof keypath !== 'string' ) { return next; }\n\n\t// completely contextual ref, go with next\n\tif ( keypath === '.' || keypath[0] === '@' || (next || previous).isKey || (next || previous).isKeypath ) { return next; }\n\n\tvar parts = keypath.split( '/' );\n\tvar keys = splitKeypath( parts[ parts.length - 1 ] );\n\n\t// check the keypath against the model keypath to see if it matches\n\tvar model = next || previous;\n\tvar i = keys.length;\n\tvar match = true;\n\tvar shuffling = false;\n\n\twhile ( model && i-- ) {\n\t\tif ( model.shuffling ) { shuffling = true; }\n\t\t// non-strict comparison to account for indices in keypaths\n\t\tif ( keys[i] != model.key ) { match = false; }\n\t\tmodel = model.parent;\n\t}\n\n\t// next is undefined, but keypath is shuffling and previous matches\n\tif ( !next && match && shuffling ) { return previous; }\n\t// next is defined, but doesn't match the keypath\n\telse if ( next && !match && shuffling ) { return previous; }\n\telse { return next; }\n}\n\n// temporary placeholder target for detached implicit links\nvar Missing = {\n\tkey: '@missing',\n\tanimate: noop,\n\tapplyValue: noop,\n\tget: noop,\n\tgetKeypath: function getKeypath () { return this.key; },\n\tjoinAll: function joinAll () { return this; },\n\tjoinKey: function joinKey () { return this; },\n\tmark: noop,\n\tregisterLink: noop,\n\tshufle: noop,\n\tset: noop,\n\tunregisterLink: noop\n};\nMissing.parent = Missing;\n\nvar LinkModel = (function (ModelBase$$1) {\n\tfunction LinkModel ( parent, owner, target, key ) {\n\t\tModelBase$$1.call( this, parent );\n\n\t\tthis.owner = owner;\n\t\tthis.target = target;\n\t\tthis.key = key === undefined ? owner.key : key;\n\t\tif ( owner.isLink ) { this.sourcePath = (owner.sourcePath) + \".\" + (this.key); }\n\n\t\ttarget.registerLink( this );\n\n\t\tif ( parent ) { this.isReadonly = parent.isReadonly; }\n\n\t\tthis.isLink = true;\n\t}\n\n\tif ( ModelBase$$1 ) LinkModel.__proto__ = ModelBase$$1;\n\tLinkModel.prototype = Object.create( ModelBase$$1 && ModelBase$$1.prototype );\n\tLinkModel.prototype.constructor = LinkModel;\n\n\tLinkModel.prototype.animate = function animate ( from, to, options, interpolator ) {\n\t\tthis.target.animate( from, to, options, interpolator );\n\t};\n\n\tLinkModel.prototype.applyValue = function applyValue ( value ) {\n\t\tif ( this.boundValue ) { this.boundValue = null; }\n\t\tthis.target.applyValue( value );\n\t};\n\n\tLinkModel.prototype.attach = function attach ( fragment ) {\n\t\tvar model = resolveReference( fragment, this.key );\n\t\tif ( model ) {\n\t\t\tthis.relinking( model, true, false );\n\t\t} else { // if there is no link available, move everything here to real models\n\t\t\tthis.owner.unlink();\n\t\t}\n\t};\n\n\tLinkModel.prototype.detach = function detach () {\n\t\tthis.relinking( Missing, true, false );\n\t};\n\n\tLinkModel.prototype.get = function get ( shouldCapture, opts ) {\n\t\tif ( opts === void 0 ) opts = {};\n\n\t\tif ( shouldCapture ) {\n\t\t\tcapture( this );\n\n\t\t\t// may need to tell the target to unwrap\n\t\t\topts.unwrap = true;\n\t\t}\n\n\t\tvar bind$$1 = 'shouldBind' in opts ? opts.shouldBind : true;\n\t\topts.shouldBind = false;\n\n\t\treturn maybeBind( this, this.target.get( false, opts ), bind$$1 );\n\t};\n\n\tLinkModel.prototype.getKeypath = function getKeypath ( ractive ) {\n\t\tif ( ractive && ractive !== this.root.ractive ) { return this.target.getKeypath( ractive ); }\n\n\t\treturn ModelBase$$1.prototype.getKeypath.call( this, ractive );\n\t};\n\n\tLinkModel.prototype.getKeypathModel = function getKeypathModel ( ractive ) {\n\t\tif ( !this.keypathModel ) { this.keypathModel = new KeypathModel( this ); }\n\t\tif ( ractive && ractive !== this.root.ractive ) { return this.keypathModel.getChild( ractive ); }\n\t\treturn this.keypathModel;\n\t};\n\n\tLinkModel.prototype.handleChange = function handleChange$1 () {\n\t\tthis.deps.forEach( handleChange$1$1 );\n\t\tthis.links.forEach( handleChange$1$1 );\n\t\tthis.notifyUpstream();\n\t};\n\n\tLinkModel.prototype.isDetached = function isDetached () { return this.virtual && this.target === Missing; };\n\n\tLinkModel.prototype.joinKey = function joinKey ( key ) {\n\t\t// TODO: handle nested links\n\t\tif ( key === undefined || key === '' ) { return this; }\n\n\t\tif ( !this.childByKey.hasOwnProperty( key ) ) {\n\t\t\tvar child = new LinkModel( this, this, this.target.joinKey( key ), key );\n\t\t\tthis.children.push( child );\n\t\t\tthis.childByKey[ key ] = child;\n\t\t}\n\n\t\treturn this.childByKey[ key ];\n\t};\n\n\tLinkModel.prototype.mark = function mark () {\n\t\tthis.target.mark();\n\t};\n\n\tLinkModel.prototype.marked = function marked$1 () {\n\t\tif ( this.boundValue ) { this.boundValue = null; }\n\n\t\tthis.links.forEach( marked );\n\n\t\tthis.deps.forEach( handleChange$1$1 );\n\t\tthis.clearUnresolveds();\n\t};\n\n\tLinkModel.prototype.markedAll = function markedAll$1 () {\n\t\tthis.children.forEach( markedAll );\n\t\tthis.marked();\n\t};\n\n\tLinkModel.prototype.notifiedUpstream = function notifiedUpstream$1 () {\n\t\tthis.links.forEach( notifiedUpstream );\n\t\tthis.deps.forEach( handleChange$1$1 );\n\t};\n\n\tLinkModel.prototype.relinked = function relinked () {\n\t\tthis.target.registerLink( this );\n\t\tthis.children.forEach( function (c) { return c.relinked(); } );\n\t};\n\n\tLinkModel.prototype.relinking = function relinking ( target, root, safe ) {\n\t\tvar this$1 = this;\n\n\t\tif ( root && this.sourcePath ) { target = rebindMatch( this.sourcePath, target, this.target ); }\n\t\tif ( !target || this.target === target ) { return; }\n\n\t\tthis.target.unregisterLink( this );\n\t\tif ( this.keypathModel ) { this.keypathModel.rebindChildren( target ); }\n\n\t\tthis.target = target;\n\t\tthis.children.forEach( function (c) {\n\t\t\tc.relinking( target.joinKey( c.key ), false, safe );\n\t\t});\n\n\t\tif ( root ) { this.addShuffleTask( function () {\n\t\t\tthis$1.relinked();\n\t\t\tif ( !safe ) { this$1.notifyUpstream(); }\n\t\t}); }\n\t};\n\n\tLinkModel.prototype.set = function set ( value ) {\n\t\tif ( this.boundValue ) { this.boundValue = null; }\n\t\tthis.target.set( value );\n\t};\n\n\tLinkModel.prototype.shuffle = function shuffle$1 ( newIndices ) {\n\t\t// watch for extra shuffles caused by a shuffle in a downstream link\n\t\tif ( this.shuffling ) { return; }\n\n\t\t// let the real model handle firing off shuffles\n\t\tif ( !this.target.shuffling ) {\n\t\t\tthis.target.shuffle( newIndices );\n\t\t} else {\n\t\t\tshuffle$1$1( this, newIndices, true );\n\t\t}\n\n\t};\n\n\tLinkModel.prototype.source = function source () {\n\t\tif ( this.target.source ) { return this.target.source(); }\n\t\telse { return this.target; }\n\t};\n\n\tLinkModel.prototype.teardown = function teardown$1 () {\n\t\tif ( this._link ) { this._link.teardown(); }\n\t\tthis.children.forEach( teardown$1$1 );\n\t};\n\n\treturn LinkModel;\n}(ModelBase));\n\nModelBase.prototype.link = function link ( model, keypath, options ) {\n\tvar lnk = this._link || new LinkModel( this.parent, this, model, this.key );\n\tlnk.implicit = options && options.implicit;\n\tlnk.sourcePath = keypath;\n\tif ( this._link ) { this._link.relinking( model, true, false ); }\n\tthis.rebinding( lnk, this, false );\n\tfireShuffleTasks();\n\n\tvar unresolved = !this._link;\n\tthis._link = lnk;\n\tif ( unresolved && this.parent ) { this.parent.clearUnresolveds(); }\n\tlnk.marked();\n\treturn lnk;\n};\n\nModelBase.prototype.unlink = function unlink () {\n\tif ( this._link ) {\n\t\tvar ln = this._link;\n\t\tthis._link = undefined;\n\t\tln.rebinding( this, this._link );\n\t\tfireShuffleTasks();\n\t\tln.teardown();\n\t}\n};\n\nvar requestAnimationFrame;\n\n// If window doesn't exist, we don't need requestAnimationFrame\nif ( !win ) {\n\trequestAnimationFrame = null;\n} else {\n\t// https://gist.github.com/paulirish/1579671\n\t(function ( vendors$$1, lastTime, win$$1 ) {\n\n\t\tvar x, setTimeout;\n\n\t\tif ( win$$1.requestAnimationFrame ) {\n\t\t\treturn;\n\t\t}\n\n\t\tfor ( x = 0; x < vendors$$1.length && !win$$1.requestAnimationFrame; ++x ) {\n\t\t\twin$$1.requestAnimationFrame = win$$1[ vendors$$1[x] + 'RequestAnimationFrame' ];\n\t\t}\n\n\t\tif ( !win$$1.requestAnimationFrame ) {\n\t\t\tsetTimeout = win$$1.setTimeout;\n\n\t\t\twin$$1.requestAnimationFrame = function ( callback ) {\n\t\t\t\tvar currTime = Date.now();\n\t\t\t\tvar timeToCall = Math.max( 0, 16 - ( currTime - lastTime ) );\n\t\t\t\tvar id = setTimeout( function () { callback(currTime + timeToCall); }, timeToCall );\n\n\t\t\t\tlastTime = currTime + timeToCall;\n\t\t\t\treturn id;\n\t\t\t};\n\t\t}\n\n\t}( vendors, 0, win ));\n\n\trequestAnimationFrame = win.requestAnimationFrame;\n}\n\nvar rAF = requestAnimationFrame;\n\nvar getTime = ( win && win.performance && typeof win.performance.now === 'function' ) ?\n\tfunction () { return win.performance.now(); } :\n\tfunction () { return Date.now(); };\n\n// TODO what happens if a transition is aborted?\n\nvar tickers = [];\nvar running = false;\n\nfunction tick () {\n\trunloop.start();\n\n\tvar now = getTime();\n\n\tvar i;\n\tvar ticker;\n\n\tfor ( i = 0; i < tickers.length; i += 1 ) {\n\t\tticker = tickers[i];\n\n\t\tif ( !ticker.tick( now ) ) {\n\t\t\t// ticker is complete, remove it from the stack, and decrement i so we don't miss one\n\t\t\ttickers.splice( i--, 1 );\n\t\t}\n\t}\n\n\trunloop.end();\n\n\tif ( tickers.length ) {\n\t\trAF( tick );\n\t} else {\n\t\trunning = false;\n\t}\n}\n\nvar Ticker = function Ticker ( options ) {\n\tthis.duration = options.duration;\n\tthis.step = options.step;\n\tthis.complete = options.complete;\n\tthis.easing = options.easing;\n\n\tthis.start = getTime();\n\tthis.end = this.start + this.duration;\n\n\tthis.running = true;\n\n\ttickers.push( this );\n\tif ( !running ) { rAF( tick ); }\n};\n\nTicker.prototype.tick = function tick$1 ( now ) {\n\tif ( !this.running ) { return false; }\n\n\tif ( now > this.end ) {\n\t\tif ( this.step ) { this.step( 1 ); }\n\t\tif ( this.complete ) { this.complete( 1 ); }\n\n\t\treturn false;\n\t}\n\n\tvar elapsed = now - this.start;\n\tvar eased = this.easing( elapsed / this.duration );\n\n\tif ( this.step ) { this.step( eased ); }\n\n\treturn true;\n};\n\nTicker.prototype.stop = function stop () {\n\tif ( this.abort ) { this.abort(); }\n\tthis.running = false;\n};\n\nvar prefixers = {};\n\n// TODO this is legacy. sooner we can replace the old adaptor API the better\nfunction prefixKeypath ( obj, prefix ) {\n\tvar prefixed = {};\n\n\tif ( !prefix ) {\n\t\treturn obj;\n\t}\n\n\tprefix += '.';\n\n\tfor ( var key in obj ) {\n\t\tif ( obj.hasOwnProperty( key ) ) {\n\t\t\tprefixed[ prefix + key ] = obj[ key ];\n\t\t}\n\t}\n\n\treturn prefixed;\n}\n\nfunction getPrefixer ( rootKeypath ) {\n\tvar rootDot;\n\n\tif ( !prefixers[ rootKeypath ] ) {\n\t\trootDot = rootKeypath ? rootKeypath + '.' : '';\n\n\t\tprefixers[ rootKeypath ] = function ( relativeKeypath, value ) {\n\t\t\tvar obj;\n\n\t\t\tif ( typeof relativeKeypath === 'string' ) {\n\t\t\t\tobj = {};\n\t\t\t\tobj[ rootDot + relativeKeypath ] = value;\n\t\t\t\treturn obj;\n\t\t\t}\n\n\t\t\tif ( typeof relativeKeypath === 'object' ) {\n\t\t\t\t// 'relativeKeypath' is in fact a hash, not a keypath\n\t\t\t\treturn rootDot ? prefixKeypath( relativeKeypath, rootKeypath ) : relativeKeypath;\n\t\t\t}\n\t\t};\n\t}\n\n\treturn prefixers[ rootKeypath ];\n}\n\nvar Model = (function (ModelBase$$1) {\n\tfunction Model ( parent, key ) {\n\t\tModelBase$$1.call( this, parent );\n\n\t\tthis.ticker = null;\n\n\t\tif ( parent ) {\n\t\t\tthis.key = unescapeKey( key );\n\t\t\tthis.isReadonly = parent.isReadonly;\n\n\t\t\tif ( parent.value ) {\n\t\t\t\tthis.value = parent.value[ this.key ];\n\t\t\t\tif ( isArray( this.value ) ) { this.length = this.value.length; }\n\t\t\t\tthis.adapt();\n\t\t\t}\n\t\t}\n\t}\n\n\tif ( ModelBase$$1 ) Model.__proto__ = ModelBase$$1;\n\tModel.prototype = Object.create( ModelBase$$1 && ModelBase$$1.prototype );\n\tModel.prototype.constructor = Model;\n\n\tModel.prototype.adapt = function adapt () {\n\t\tvar this$1 = this;\n\n\t\tvar adaptors = this.root.adaptors;\n\t\tvar len = adaptors.length;\n\n\t\tthis.rewrap = false;\n\n\t\t// Exit early if no adaptors\n\t\tif ( len === 0 ) { return; }\n\n\t\tvar value = this.wrapper ? ( 'newWrapperValue' in this ? this.newWrapperValue : this.wrapperValue ) : this.value;\n\n\t\t// TODO remove this legacy nonsense\n\t\tvar ractive = this.root.ractive;\n\t\tvar keypath = this.getKeypath();\n\n\t\t// tear previous adaptor down if present\n\t\tif ( this.wrapper ) {\n\t\t\tvar shouldTeardown = this.wrapperValue === value ? false : !this.wrapper.reset || this.wrapper.reset( value ) === false;\n\n\t\t\tif ( shouldTeardown ) {\n\t\t\t\tthis.wrapper.teardown();\n\t\t\t\tthis.wrapper = null;\n\n\t\t\t\t// don't branch for undefined values\n\t\t\t\tif ( this.value !== undefined ) {\n\t\t\t\t\tvar parentValue = this.parent.value || this.parent.createBranch( this.key );\n\t\t\t\t\tif ( parentValue[ this.key ] !== value ) { parentValue[ this.key ] = value; }\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tdelete this.newWrapperValue;\n\t\t\t\tthis.wrapperValue = value;\n\t\t\t\tthis.value = this.wrapper.get();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tvar i;\n\n\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\tvar adaptor = adaptors[i];\n\t\t\tif ( adaptor.filter( value, keypath, ractive ) ) {\n\t\t\t\tthis$1.wrapper = adaptor.wrap( ractive, value, keypath, getPrefixer( keypath ) );\n\t\t\t\tthis$1.wrapperValue = value;\n\t\t\t\tthis$1.wrapper.__model = this$1; // massive temporary hack to enable array adaptor\n\n\t\t\t\tthis$1.value = this$1.wrapper.get();\n\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t};\n\n\tModel.prototype.animate = function animate ( from, to, options, interpolator ) {\n\t\tvar this$1 = this;\n\n\t\tif ( this.ticker ) { this.ticker.stop(); }\n\n\t\tvar fulfilPromise;\n\t\tvar promise = new Promise$1( function (fulfil) { return fulfilPromise = fulfil; } );\n\n\t\tthis.ticker = new Ticker({\n\t\t\tduration: options.duration,\n\t\t\teasing: options.easing,\n\t\t\tstep: function (t) {\n\t\t\t\tvar value = interpolator( t );\n\t\t\t\tthis$1.applyValue( value );\n\t\t\t\tif ( options.step ) { options.step( t, value ); }\n\t\t\t},\n\t\t\tcomplete: function () {\n\t\t\t\tthis$1.applyValue( to );\n\t\t\t\tif ( options.complete ) { options.complete( to ); }\n\n\t\t\t\tthis$1.ticker = null;\n\t\t\t\tfulfilPromise();\n\t\t\t}\n\t\t});\n\n\t\tpromise.stop = this.ticker.stop;\n\t\treturn promise;\n\t};\n\n\tModel.prototype.applyValue = function applyValue ( value ) {\n\t\tif ( isEqual( value, this.value ) ) { return; }\n\t\tif ( this.boundValue ) { this.boundValue = null; }\n\n\t\t// TODO deprecate this nonsense\n\t\tthis.registerChange( this.getKeypath(), value );\n\n\t\tif ( this.parent.wrapper && this.parent.wrapper.set ) {\n\t\t\tthis.parent.wrapper.set( this.key, value );\n\t\t\tthis.parent.value = this.parent.wrapper.get();\n\n\t\t\tthis.value = this.parent.value[ this.key ];\n\t\t\tif ( this.wrapper ) { this.newWrapperValue = this.value; }\n\t\t\tthis.adapt();\n\t\t} else if ( this.wrapper ) {\n\t\t\tthis.newWrapperValue = value;\n\t\t\tthis.adapt();\n\t\t} else {\n\t\t\tvar parentValue = this.parent.value || this.parent.createBranch( this.key );\n\t\t\tif ( isObjectLike( parentValue ) ) {\n\t\t\t\tparentValue[ this.key ] = value;\n\t\t\t} else {\n\t\t\t\twarnIfDebug( (\"Attempted to set a property of a non-object '\" + (this.getKeypath()) + \"'\") );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.value = value;\n\t\t\tthis.adapt();\n\t\t}\n\n\t\tthis.parent.clearUnresolveds();\n\t\tthis.clearUnresolveds();\n\n\t\t// keep track of array length\n\t\tif ( isArray( value ) ) { this.length = value.length; }\n\n\t\t// notify dependants\n\t\tthis.links.forEach( handleChange$1$1 );\n\t\tthis.children.forEach( mark$1$1 );\n\t\tthis.deps.forEach( handleChange$1$1 );\n\n\t\tthis.notifyUpstream();\n\n\t\tif ( this.key === 'length' && isArray( this.parent.value ) ) { this.parent.length = this.parent.value.length; }\n\t};\n\n\tModel.prototype.createBranch = function createBranch ( key ) {\n\t\tvar branch = isNumeric( key ) ? [] : {};\n\t\tthis.set( branch );\n\n\t\treturn branch;\n\t};\n\n\tModel.prototype.get = function get ( shouldCapture, opts ) {\n\t\tif ( this._link ) { return this._link.get( shouldCapture, opts ); }\n\t\tif ( shouldCapture ) { capture( this ); }\n\t\t// if capturing, this value needs to be unwrapped because it's for external use\n\t\tif ( opts && opts.virtual ) { return this.getVirtual( false ); }\n\t\treturn maybeBind( this, ( shouldCapture || ( opts && opts.unwrap ) ) && this.wrapper ? this.wrapperValue : this.value, !opts || opts.shouldBind !== false );\n\t};\n\n\tModel.prototype.getKeypathModel = function getKeypathModel () {\n\t\tif ( !this.keypathModel ) { this.keypathModel = new KeypathModel( this ); }\n\t\treturn this.keypathModel;\n\t};\n\n\tModel.prototype.joinKey = function joinKey ( key, opts ) {\n\t\tif ( this._link ) {\n\t\t\tif ( opts && opts.lastLink !== false && ( key === undefined || key === '' ) ) { return this; }\n\t\t\treturn this._link.joinKey( key );\n\t\t}\n\n\t\tif ( key === undefined || key === '' ) { return this; }\n\n\n\t\tif ( !this.childByKey.hasOwnProperty( key ) ) {\n\t\t\tvar child = new Model( this, key );\n\t\t\tthis.children.push( child );\n\t\t\tthis.childByKey[ key ] = child;\n\t\t}\n\n\t\tif ( this.childByKey[ key ]._link && ( !opts || opts.lastLink !== false ) ) { return this.childByKey[ key ]._link; }\n\t\treturn this.childByKey[ key ];\n\t};\n\n\tModel.prototype.mark = function mark$1 () {\n\t\tif ( this._link ) { return this._link.mark(); }\n\n\t\tvar value = this.retrieve();\n\n\t\tif ( !isEqual( value, this.value ) ) {\n\t\t\tvar old = this.value;\n\t\t\tthis.value = value;\n\t\t\tif ( this.boundValue ) { this.boundValue = null; }\n\n\t\t\t// make sure the wrapper stays in sync\n\t\t\tif ( old !== value || this.rewrap ) {\n\t\t\t\tif ( this.wrapper ) { this.newWrapperValue = value; }\n\t\t\t\tthis.adapt();\n\t\t\t}\n\n\t\t\t// keep track of array lengths\n\t\t\tif ( isArray( value ) ) { this.length = value.length; }\n\n\t\t\tthis.children.forEach( mark$1$1 );\n\t\t\tthis.links.forEach( marked );\n\n\t\t\tthis.deps.forEach( handleChange$1$1 );\n\t\t\tthis.clearUnresolveds();\n\t\t}\n\t};\n\n\tModel.prototype.merge = function merge ( array, comparator ) {\n\t\tvar oldArray = this.value;\n\t\tvar newArray = array;\n\t\tif ( oldArray === newArray ) { oldArray = recreateArray( this ); }\n\t\tif ( comparator ) {\n\t\t\toldArray = oldArray.map( comparator );\n\t\t\tnewArray = newArray.map( comparator );\n\t\t}\n\n\t\tvar oldLength = oldArray.length;\n\n\t\tvar usedIndices = {};\n\t\tvar firstUnusedIndex = 0;\n\n\t\tvar newIndices = oldArray.map( function (item) {\n\t\t\tvar index;\n\t\t\tvar start = firstUnusedIndex;\n\n\t\t\tdo {\n\t\t\t\tindex = newArray.indexOf( item, start );\n\n\t\t\t\tif ( index === -1 ) {\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\n\t\t\t\tstart = index + 1;\n\t\t\t} while ( ( usedIndices[ index ] === true ) && start < oldLength );\n\n\t\t\t// keep track of the first unused index, so we don't search\n\t\t\t// the whole of newArray for each item in oldArray unnecessarily\n\t\t\tif ( index === firstUnusedIndex ) {\n\t\t\t\tfirstUnusedIndex += 1;\n\t\t\t}\n\t\t\t// allow next instance of next \"equal\" to be found item\n\t\t\tusedIndices[ index ] = true;\n\t\t\treturn index;\n\t\t});\n\n\t\tthis.parent.value[ this.key ] = array;\n\t\tthis.shuffle( newIndices );\n\t};\n\n\tModel.prototype.retrieve = function retrieve () {\n\t\treturn this.parent.value ? this.parent.value[ this.key ] : undefined;\n\t};\n\n\tModel.prototype.set = function set ( value ) {\n\t\tif ( this.ticker ) { this.ticker.stop(); }\n\t\tthis.applyValue( value );\n\t};\n\n\tModel.prototype.shuffle = function shuffle$1 ( newIndices ) {\n\t\tshuffle$1$1( this, newIndices, false );\n\t};\n\n\tModel.prototype.source = function source () { return this; };\n\n\tModel.prototype.teardown = function teardown$1 () {\n\t\tif ( this._link ) { this._link.teardown(); }\n\t\tthis.children.forEach( teardown$1$1 );\n\t\tif ( this.wrapper ) { this.wrapper.teardown(); }\n\t\tif ( this.keypathModel ) { this.keypathModel.teardown(); }\n\t};\n\n\treturn Model;\n}(ModelBase));\n\nfunction recreateArray( model ) {\n\tvar array = [];\n\n\tfor ( var i = 0; i < model.length; i++ ) {\n\t\tarray[ i ] = (model.childByKey[i] || {}).value;\n\t}\n\n\treturn array;\n}\n\n/* global global */\nvar data = {};\n\nvar SharedModel = (function (Model$$1) {\n\tfunction SharedModel ( value, name ) {\n\t\tModel$$1.call( this, null, (\"@\" + name) );\n\t\tthis.value = value;\n\t\tthis.isRoot = true;\n\t\tthis.root = this;\n\t\tthis.adaptors = [];\n\t}\n\n\tif ( Model$$1 ) SharedModel.__proto__ = Model$$1;\n\tSharedModel.prototype = Object.create( Model$$1 && Model$$1.prototype );\n\tSharedModel.prototype.constructor = SharedModel;\n\n\tSharedModel.prototype.getKeypath = function getKeypath () {\n\t\treturn this.key;\n\t};\n\n\t// shared model doesn't contribute changes events because it has no instance\n\tSharedModel.prototype.registerChange = function registerChange () {};\n\n\treturn SharedModel;\n}(Model));\n\nvar SharedModel$1 = new SharedModel( data, 'shared' );\n\nvar GlobalModel = new SharedModel( typeof global !== 'undefined' ? global : window, 'global' );\n\nvar keypathExpr = /^@[^\\(]+\\(([^\\)]+)\\)/;\n\nfunction resolveReference ( fragment, ref ) {\n\tvar initialFragment = fragment;\n\t// current context ref\n\tif ( ref === '.' ) { return fragment.findContext(); }\n\n\t// ancestor references\n\tif ( ref[0] === '~' ) { return fragment.ractive.viewmodel.joinAll( splitKeypath( ref.slice( 2 ) ) ); }\n\n\t// scoped references\n\tif ( ref[0] === '.' || ref[0] === '^' ) {\n\t\tvar frag = fragment;\n\t\tvar parts = ref.split( '/' );\n\t\tvar explicitContext = parts[0] === '^^';\n\t\tvar context$1 = explicitContext ? null : fragment.findContext();\n\n\t\t// account for the first context hop\n\t\tif ( explicitContext ) { parts.unshift( '^^' ); }\n\n\t\t// walk up the context chain\n\t\twhile ( parts[0] === '^^' ) {\n\t\t\tparts.shift();\n\t\t\tcontext$1 = null;\n\t\t\twhile ( frag && !context$1 ) {\n\t\t\t\tcontext$1 = frag.context;\n\t\t\t\tfrag = frag.parent.component ? frag.parent.component.parentFragment : frag.parent;\n\t\t\t}\n\t\t}\n\n\t\tif ( !context$1 && explicitContext ) {\n\t\t\tthrow new Error( (\"Invalid context parent reference ('\" + ref + \"'). There is not context at that level.\") );\n\t\t}\n\n\t\t// walk up the context path\n\t\twhile ( parts[0] === '.' || parts[0] === '..' ) {\n\t\t\tvar part = parts.shift();\n\n\t\t\tif ( part === '..' ) {\n\t\t\t\tcontext$1 = context$1.parent;\n\t\t\t}\n\t\t}\n\n\t\tref = parts.join( '/' );\n\n\t\t// special case - `{{.foo}}` means the same as `{{./foo}}`\n\t\tif ( ref[0] === '.' ) { ref = ref.slice( 1 ); }\n\t\treturn context$1.joinAll( splitKeypath( ref ) );\n\t}\n\n\tvar keys = splitKeypath( ref );\n\tif ( !keys.length ) { return; }\n\tvar base = keys.shift();\n\n\t// special refs\n\tif ( base[0] === '@' ) {\n\t\t// shorthand from outside the template\n\t\t// @this referring to local ractive instance\n\t\tif ( base === '@this' || base === '@' ) {\n\t\t\treturn fragment.ractive.viewmodel.getRactiveModel().joinAll( keys );\n\t\t}\n\n\t\t// @index or @key referring to the nearest repeating index or key\n\t\telse if ( base === '@index' || base === '@key' ) {\n\t\t\tif ( keys.length ) { badReference( base ); }\n\t\t\tvar repeater = fragment.findRepeatingFragment();\n\t\t\t// make sure the found fragment is actually an iteration\n\t\t\tif ( !repeater.isIteration ) { return; }\n\t\t\treturn repeater.context.getKeyModel( repeater[ ref[1] === 'i' ? 'index' : 'key' ] );\n\t\t}\n\n\t\t// @global referring to window or global\n\t\telse if ( base === '@global' ) {\n\t\t\treturn GlobalModel.joinAll( keys );\n\t\t}\n\n\t\t// @global referring to window or global\n\t\telse if ( base === '@shared' ) {\n\t\t\treturn SharedModel$1.joinAll( keys );\n\t\t}\n\n\t\t// @keypath or @rootpath, the current keypath string, which may also be used to resolve relative keypaths\n\t\telse if ( base.indexOf( '@keypath' ) === 0 || base.indexOf( '@rootpath' ) === 0 ) {\n\t\t\tvar root = ref[1] === 'r' ? fragment.ractive.root : null;\n\t\t\tvar context$2 = fragment.findContext();\n\n\t\t\t// skip over component roots, which provide no context\n\t\t\twhile ( root && context$2.isRoot && context$2.ractive.component ) {\n\t\t\t\tcontext$2 = context$2.ractive.component.parentFragment.findContext();\n\t\t\t}\n\n\t\t\tvar match = keypathExpr.exec( ref );\n\t\t\tif ( match && match[1] ) {\n\t\t\t\tvar model = resolveReference( fragment, match[1] );\n\t\t\t\tif ( model ) { return model.getKeypathModel( root ); }\n\t\t\t}\n\n\t\t\treturn context$2.getKeypathModel( root );\n\t\t}\n\n\t\t// nope\n\t\telse {\n\t\t\tthrow new Error( (\"Invalid special reference '\" + base + \"'\") );\n\t\t}\n\t}\n\n\tvar context = fragment.findContext();\n\n\t// check immediate context for a match\n\tif ( context.has( base ) ) {\n\t\treturn context.joinKey( base ).joinAll( keys );\n\t}\n\n\t// walk up the fragment hierarchy looking for a matching ref, alias, or key in a context\n\tvar hasContextChain;\n\tvar crossedComponentBoundary;\n\tvar shouldWarn = fragment.ractive.warnAboutAmbiguity;\n\n\twhile ( fragment ) {\n\t\t// repeated fragments\n\t\tif ( fragment.isIteration ) {\n\t\t\tif ( base === fragment.parent.keyRef ) {\n\t\t\t\tif ( keys.length ) { badReference( base ); }\n\t\t\t\treturn fragment.context.getKeyModel( fragment.key );\n\t\t\t}\n\n\t\t\tif ( base === fragment.parent.indexRef ) {\n\t\t\t\tif ( keys.length ) { badReference( base ); }\n\t\t\t\treturn fragment.context.getKeyModel( fragment.index );\n\t\t\t}\n\t\t}\n\n\t\t// alias node or iteration\n\t\tif ( fragment.aliases  && fragment.aliases.hasOwnProperty( base ) ) {\n\t\t\tvar model$1 = fragment.aliases[ base ];\n\n\t\t\tif ( keys.length === 0 ) { return model$1; }\n\t\t\telse if ( typeof model$1.joinAll === 'function' ) {\n\t\t\t\treturn model$1.joinAll( keys );\n\t\t\t}\n\t\t}\n\n\t\t// check fragment context to see if it has the key we need\n\t\tif ( fragment.context ) {\n\t\t\tif ( !fragment.isRoot || fragment.ractive.component ) { hasContextChain = true; }\n\n\t\t\tif ( fragment.context.has( base ) ) {\n\t\t\t\t// this is an implicit mapping\n\t\t\t\tif ( crossedComponentBoundary ) {\n\t\t\t\t\tif ( shouldWarn ) { warnIfDebug( (\"'\" + ref + \"' resolved but is ambiguous and will create a mapping to a parent component.\") ); }\n\t\t\t\t\treturn context.root.createLink( base, fragment.context.joinKey( base ), base, { implicit: true } ).joinAll( keys );\n\t\t\t\t}\n\n\t\t\t\tif ( shouldWarn ) { warnIfDebug( (\"'\" + ref + \"' resolved but is ambiguous.\") ); }\n\t\t\t\treturn fragment.context.joinKey( base ).joinAll( keys );\n\t\t\t}\n\t\t}\n\n\t\tif ( ( fragment.componentParent || ( !fragment.parent && fragment.ractive.component ) ) && !fragment.ractive.isolated ) {\n\t\t\t// ascend through component boundary\n\t\t\tfragment = fragment.componentParent || fragment.ractive.component.parentFragment;\n\t\t\tcrossedComponentBoundary = true;\n\t\t} else {\n\t\t\tfragment = fragment.parent;\n\t\t}\n\t}\n\n\t// if enabled, check the instance for a match\n\tif ( initialFragment.ractive.resolveInstanceMembers ) {\n\t\tvar model$2 = initialFragment.ractive.viewmodel.getRactiveModel();\n\t\tif ( model$2.has( base ) ) {\n\t\t\treturn model$2.joinKey( base ).joinAll( keys );\n\t\t}\n\t}\n\n\tif ( shouldWarn ) {\n\t\twarnIfDebug( (\"'\" + ref + \"' is ambiguous and did not resolve.\") );\n\t}\n\n\t// didn't find anything, so go ahead and create the key on the local model\n\tif ( !hasContextChain ) {\n\t\treturn context.root.joinKey( base ).joinAll( keys );\n\t}\n}\n\nfunction badReference ( key ) {\n\tthrow new Error( (\"An index or key reference (\" + key + \") cannot have child properties\") );\n}\n\nfunction Ractive$get ( keypath, opts ) {\n\tif ( typeof keypath !== 'string' ) { return this.viewmodel.get( true, keypath ); }\n\n\tvar keys = splitKeypath( keypath );\n\tvar key = keys[0];\n\n\tvar model;\n\n\tif ( !this.viewmodel.has( key ) ) {\n\t\t// if this is an inline component, we may need to create\n\t\t// an implicit mapping\n\t\tif ( this.component && !this.isolated ) {\n\t\t\tmodel = resolveReference( this.component.parentFragment, key );\n\n\t\t\tif ( model ) {\n\t\t\t\tthis.viewmodel.map( key, model, { implicit: true } );\n\t\t\t}\n\t\t}\n\t}\n\n\tmodel = this.viewmodel.joinAll( keys );\n\treturn model.get( true, opts );\n}\n\n// This function takes an array, the name of a mutator method, and the\n// arguments to call that mutator method with, and returns an array that\n// maps the old indices to their new indices.\n\n// So if you had something like this...\n//\n//     array = [ 'a', 'b', 'c', 'd' ];\n//     array.push( 'e' );\n//\n// ...you'd get `[ 0, 1, 2, 3 ]` - in other words, none of the old indices\n// have changed. If you then did this...\n//\n//     array.unshift( 'z' );\n//\n// ...the indices would be `[ 1, 2, 3, 4, 5 ]` - every item has been moved\n// one higher to make room for the 'z'. If you removed an item, the new index\n// would be -1...\n//\n//     array.splice( 2, 2 );\n//\n// ...this would result in [ 0, 1, -1, -1, 2, 3 ].\n//\n// This information is used to enable fast, non-destructive shuffling of list\n// sections when you do e.g. `ractive.splice( 'items', 2, 2 );\n\nfunction getNewIndices ( length, methodName, args ) {\n\tvar newIndices = [];\n\n\tvar spliceArguments = getSpliceEquivalent( length, methodName, args );\n\n\tif ( !spliceArguments ) {\n\t\treturn null; // TODO support reverse and sort?\n\t}\n\n\tvar balance = ( spliceArguments.length - 2 ) - spliceArguments[1];\n\n\tvar removeStart = Math.min( length, spliceArguments[0] );\n\tvar removeEnd = removeStart + spliceArguments[1];\n\tnewIndices.startIndex = removeStart;\n\n\tvar i;\n\tfor ( i = 0; i < removeStart; i += 1 ) {\n\t\tnewIndices.push( i );\n\t}\n\n\tfor ( ; i < removeEnd; i += 1 ) {\n\t\tnewIndices.push( -1 );\n\t}\n\n\tfor ( ; i < length; i += 1 ) {\n\t\tnewIndices.push( i + balance );\n\t}\n\n\t// there is a net shift for the rest of the array starting with index + balance\n\tif ( balance !== 0 ) {\n\t\tnewIndices.touchedFrom = spliceArguments[0];\n\t} else {\n\t\tnewIndices.touchedFrom = length;\n\t}\n\n\treturn newIndices;\n}\n\n\n// The pop, push, shift an unshift methods can all be represented\n// as an equivalent splice\nfunction getSpliceEquivalent ( length, methodName, args ) {\n\tswitch ( methodName ) {\n\t\tcase 'splice':\n\t\t\tif ( args[0] !== undefined && args[0] < 0 ) {\n\t\t\t\targs[0] = length + Math.max( args[0], -length );\n\t\t\t}\n\n\t\t\tif ( args[0] === undefined ) { args[0] = 0; }\n\n\t\t\twhile ( args.length < 2 ) {\n\t\t\t\targs.push( length - args[0] );\n\t\t\t}\n\n\t\t\tif ( typeof args[1] !== 'number' ) {\n\t\t\t\targs[1] = length - args[0];\n\t\t\t}\n\n\t\t\t// ensure we only remove elements that exist\n\t\t\targs[1] = Math.min( args[1], length - args[0] );\n\n\t\t\treturn args;\n\n\t\tcase 'sort':\n\t\tcase 'reverse':\n\t\t\treturn null;\n\n\t\tcase 'pop':\n\t\t\tif ( length ) {\n\t\t\t\treturn [ length - 1, 1 ];\n\t\t\t}\n\t\t\treturn [ 0, 0 ];\n\n\t\tcase 'push':\n\t\t\treturn [ length, 0 ].concat( args );\n\n\t\tcase 'shift':\n\t\t\treturn [ 0, length ? 1 : 0 ];\n\n\t\tcase 'unshift':\n\t\t\treturn [ 0, 0 ].concat( args );\n\t}\n}\n\nvar arrayProto = Array.prototype;\n\nvar makeArrayMethod = function ( methodName ) {\n\tfunction path ( keypath ) {\n\t\tvar args = [], len = arguments.length - 1;\n\t\twhile ( len-- > 0 ) args[ len ] = arguments[ len + 1 ];\n\n\t\treturn model( this.viewmodel.joinAll( splitKeypath( keypath ) ), args );\n\t}\n\n\tfunction model ( mdl, args ) {\n\t\tvar array = mdl.get();\n\n\t\tif ( !isArray( array ) ) {\n\t\t\tif ( array === undefined ) {\n\t\t\t\tarray = [];\n\t\t\t\tvar result$1 = arrayProto[ methodName ].apply( array, args );\n\t\t\t\tvar promise$1 = runloop.start( this, true ).then( function () { return result$1; } );\n\t\t\t\tmdl.set( array );\n\t\t\t\trunloop.end();\n\t\t\t\treturn promise$1;\n\t\t\t} else {\n\t\t\t\tthrow new Error( (\"shuffle array method \" + methodName + \" called on non-array at \" + (mdl.getKeypath())) );\n\t\t\t}\n\t\t}\n\n\t\tvar newIndices = getNewIndices( array.length, methodName, args );\n\t\tvar result = arrayProto[ methodName ].apply( array, args );\n\n\t\tvar promise = runloop.start( this, true ).then( function () { return result; } );\n\t\tpromise.result = result;\n\n\t\tif ( newIndices ) {\n\t\t\tmdl.shuffle( newIndices );\n\t\t} else {\n\t\t\tmdl.set( result );\n\t\t}\n\n\t\trunloop.end();\n\n\t\treturn promise;\n\t}\n\n\treturn { path: path, model: model };\n};\n\nvar comparators = {};\n\nfunction getComparator ( option ) {\n\tif ( !option ) { return null; } // use existing arrays\n\tif ( option === true ) { return JSON.stringify; }\n\tif ( typeof option === 'function' ) { return option; }\n\n\tif ( typeof option === 'string' ) {\n\t\treturn comparators[ option ] || ( comparators[ option ] = function (thing) { return thing[ option ]; } );\n\t}\n\n\tthrow new Error( 'If supplied, options.compare must be a string, function, or `true`' ); // TODO link to docs\n}\n\nfunction merge$2 ( ractive, model, array, options ) {\n\tvar promise = runloop.start( ractive, true );\n\tvar value = model.get();\n\tif ( array === undefined ) { array = value; }\n\n\tif ( !isArray( value ) || !isArray( array ) ) {\n\t\tthrow new Error( 'You cannot merge an array with a non-array' );\n\t}\n\n\tvar comparator = getComparator( options && options.compare );\n\tmodel.merge( array, comparator );\n\n\trunloop.end();\n\treturn promise;\n}\n\nfunction thisRactive$merge ( keypath, array, options ) {\n\treturn merge$2( this, this.viewmodel.joinAll( splitKeypath( keypath ) ), array, options );\n}\n\nvar updateHook = new Hook( 'update' );\n\nfunction update$3 ( ractive, model ) {\n\t// if the parent is wrapped, the adaptor will need to be updated before\n\t// updating on this keypath\n\tif ( model.parent && model.parent.wrapper ) {\n\t\tmodel.parent.adapt();\n\t}\n\n\tvar promise = runloop.start( ractive, true );\n\n\tmodel.mark();\n\tmodel.registerChange( model.getKeypath(), model.get() );\n\n\tif ( !model.isRoot ) {\n\t\t// there may be unresolved refs that are now resolvable up the context tree\n\t\tvar parent = model.parent;\n\t\tvar key = model.key;\n\t\twhile ( parent && !parent.isRoot ) {\n\t\t\tif ( parent.clearUnresolveds ) { parent.clearUnresolveds( key ); }\n\t\t\tkey = parent.key;\n\t\t\tparent = parent.parent;\n\t\t}\n\t}\n\n\t// notify upstream of changes\n\tmodel.notifyUpstream();\n\n\trunloop.end();\n\n\tupdateHook.fire( ractive, model );\n\n\treturn promise;\n}\n\nfunction Ractive$update ( keypath ) {\n\tif ( keypath ) { keypath = splitKeypath( keypath ); }\n\n\treturn update$3( this, keypath ? this.viewmodel.joinAll( keypath ) : this.viewmodel );\n}\n\nvar modelPush = makeArrayMethod( 'push' ).model;\nvar modelPop = makeArrayMethod( 'pop' ).model;\nvar modelShift = makeArrayMethod( 'shift' ).model;\nvar modelUnshift = makeArrayMethod( 'unshift' ).model;\nvar modelSort = makeArrayMethod( 'sort' ).model;\nvar modelSplice = makeArrayMethod( 'splice' ).model;\nvar modelReverse = makeArrayMethod( 'reverse' ).model;\n\n// TODO: at some point perhaps this could support relative * keypaths?\nfunction build$1 ( el, keypath, value ) {\n\tvar sets = [];\n\n\t// set multiple keypaths in one go\n\tif ( isObject( keypath ) ) {\n\t\tfor ( var k in keypath ) {\n\t\t\tif ( keypath.hasOwnProperty( k ) ) {\n\t\t\t\tsets.push( [ findModel( el, k ).model, keypath[k] ] );\n\t\t\t}\n\t\t}\n\n\t}\n\t// set a single keypath\n\telse {\n\t\tsets.push( [ findModel( el, keypath ).model, value ] );\n\t}\n\n\treturn sets;\n}\n\n// get relative keypaths and values\nfunction get$1$1 ( keypath ) {\n\tif ( !keypath ) { return this._element.parentFragment.findContext().get( true ); }\n\n\tvar model = resolveReference( this._element.parentFragment, keypath );\n\n\treturn model ? model.get( true ) : undefined;\n}\n\nfunction resolve$2 ( path, ractive ) {\n\tvar ref = findModel( this, path );\n\tvar model = ref.model;\n\tvar instance = ref.instance;\n\treturn model ? model.getKeypath( ractive || instance ) : path;\n}\n\nfunction findModel ( el, path ) {\n\tvar frag = el._element.parentFragment;\n\n\tif ( typeof path !== 'string' ) {\n\t\treturn { model: frag.findContext(), instance: path };\n\t}\n\n\treturn { model: resolveReference( frag, path ), instance: frag.ractive };\n}\n\n// the usual mutation suspects\nfunction add$2 ( keypath, value ) {\n\tif ( value === undefined ) { value = 1; }\n\tif ( !isNumeric( value ) ) { throw new Error( 'Bad arguments' ); }\n\treturn set$1( this.ractive, build$1( this, keypath, value ).map( function (pair) {\n\t\tvar model = pair[0];\n\t\tvar val = pair[1];\n\t\tvar value = model.get();\n\t\tif ( !isNumeric( val ) || !isNumeric( value ) ) { throw new Error( 'Cannot add non-numeric value' ); }\n\t\treturn [ model, value + val ];\n\t}) );\n}\n\nfunction animate$2 ( keypath, value, options ) {\n\tvar model = findModel( this, keypath ).model;\n\treturn animate$1( this.ractive, model, value, options );\n}\n\nfunction link$1 ( source, dest ) {\n\tvar there = findModel( this, source ).model;\n\tvar here = findModel( this, dest ).model;\n\tvar promise = runloop.start( this.ractive, true );\n\there.link( there, source );\n\trunloop.end();\n\treturn promise;\n}\n\nfunction merge$1 ( keypath, array, options ) {\n\treturn merge$2( this.ractive, findModel( this, keypath ).model, array, options );\n}\n\nfunction observe ( keypath, callback, options ) {\n\tif ( options === void 0 ) options = {};\n\n\tif ( isObject( keypath ) ) { options = callback || {}; }\n\toptions.fragment = this._element.parentFragment;\n\treturn this.ractive.observe( keypath, callback, options );\n}\n\nfunction observeOnce ( keypath, callback, options ) {\n\tif ( options === void 0 ) options = {};\n\n\tif ( isObject( keypath ) ) { options = callback || {}; }\n\toptions.fragment = this._element.parentFragment;\n\treturn this.ractive.observeOnce( keypath, callback, options );\n}\n\nfunction pop ( keypath ) {\n\treturn modelPop( findModel( this, keypath ).model, [] );\n}\n\nfunction push ( keypath ) {\n\tvar values = [], len = arguments.length - 1;\n\twhile ( len-- > 0 ) values[ len ] = arguments[ len + 1 ];\n\n\treturn modelPush( findModel( this, keypath ).model, values );\n}\n\nfunction raise ( name, event ) {\n\tvar args = [], len = arguments.length - 2;\n\twhile ( len-- > 0 ) args[ len ] = arguments[ len + 2 ];\n\n\tvar element = this._element;\n\n\twhile ( element ) {\n\t\tvar events = element.events;\n\t\tfor ( var i = 0; i < events.length; i++ ) {\n\t\t\tvar event$1 = events[i];\n\t\t\tif ( ~event$1.template.n.indexOf( name ) ) {\n\t\t\t\tevent$1.fire( event$1, args );\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\telement = element.parent;\n\t}\n}\n\nfunction reverse ( keypath ) {\n\treturn modelReverse( findModel( this, keypath ).model, [] );\n}\n\nfunction set$2 ( keypath, value ) {\n\treturn set$1( this.ractive, build$1( this, keypath, value ) );\n}\n\nfunction shift ( keypath ) {\n\treturn modelShift( findModel( this, keypath ).model, [] );\n}\n\nfunction splice ( keypath, index, drop ) {\n\tvar add = [], len = arguments.length - 3;\n\twhile ( len-- > 0 ) add[ len ] = arguments[ len + 3 ];\n\n\tadd.unshift( index, drop );\n\treturn modelSplice( findModel( this, keypath ).model, add );\n}\n\nfunction sort ( keypath ) {\n\treturn modelSort( findModel( this, keypath ).model, [] );\n}\n\nfunction subtract ( keypath, value ) {\n\tif ( value === undefined ) { value = 1; }\n\tif ( !isNumeric( value ) ) { throw new Error( 'Bad arguments' ); }\n\treturn set$1( this.ractive, build$1( this, keypath, value ).map( function (pair) {\n\t\tvar model = pair[0];\n\t\tvar val = pair[1];\n\t\tvar value = model.get();\n\t\tif ( !isNumeric( val ) || !isNumeric( value ) ) { throw new Error( 'Cannot add non-numeric value' ); }\n\t\treturn [ model, value - val ];\n\t}) );\n}\n\nfunction toggle ( keypath ) {\n\tvar ref = findModel( this, keypath );\n\tvar model = ref.model;\n\treturn set$1( this.ractive, [ [ model, !model.get() ] ] );\n}\n\nfunction unlink$1 ( dest ) {\n\tvar here = findModel( this, dest ).model;\n\tvar promise = runloop.start( this.ractive, true );\n\tif ( here.owner && here.owner._link ) { here.owner.unlink(); }\n\trunloop.end();\n\treturn promise;\n}\n\nfunction unshift ( keypath ) {\n\tvar add = [], len = arguments.length - 1;\n\twhile ( len-- > 0 ) add[ len ] = arguments[ len + 1 ];\n\n\treturn modelUnshift( findModel( this, keypath ).model, add );\n}\n\nfunction update$2 ( keypath ) {\n\treturn update$3( this.ractive, findModel( this, keypath ).model );\n}\n\nfunction updateModel$1 ( keypath, cascade ) {\n\tvar ref = findModel( this, keypath );\n\tvar model = ref.model;\n\tvar promise = runloop.start( this.ractive, true );\n\tmodel.updateFromBindings( cascade );\n\trunloop.end();\n\treturn promise;\n}\n\n// two-way binding related helpers\nfunction isBound () {\n\tvar ref = getBindingModel( this );\n\tvar model = ref.model;\n\treturn !!model;\n}\n\nfunction getBindingPath ( ractive ) {\n\tvar ref = getBindingModel( this );\n\tvar model = ref.model;\n\tvar instance = ref.instance;\n\tif ( model ) { return model.getKeypath( ractive || instance ); }\n}\n\nfunction getBinding () {\n\tvar ref = getBindingModel( this );\n\tvar model = ref.model;\n\tif ( model ) { return model.get( true ); }\n}\n\nfunction getBindingModel ( ctx ) {\n\tvar el = ctx._element;\n\treturn { model: el.binding && el.binding.model, instance: el.parentFragment.ractive };\n}\n\nfunction setBinding ( value ) {\n\tvar ref = getBindingModel( this );\n\tvar model = ref.model;\n\treturn set$1( this.ractive, [ [ model, value ] ] );\n}\n\nfunction addHelpers ( obj, element ) {\n\tdefineProperties( obj, {\n\t\t_element: { value: element },\n\t\tractive: { value: element.parentFragment.ractive },\n\t\tresolve: { value: resolve$2 },\n\t\tget: { value: get$1$1 },\n\n\t\tadd: { value: add$2 },\n\t\tanimate: { value: animate$2 },\n\t\tlink: { value: link$1 },\n\t\tmerge: { value: merge$1 },\n\t\tobserve: { value: observe },\n\t\tobserveOnce: { value: observeOnce },\n\t\tpop: { value: pop },\n\t\tpush: { value: push },\n\t\traise: { value: raise },\n\t\treverse: { value: reverse },\n\t\tset: { value: set$2 },\n\t\tshift: { value: shift },\n\t\tsort: { value: sort },\n\t\tsplice: { value: splice },\n\t\tsubtract: { value: subtract },\n\t\ttoggle: { value: toggle },\n\t\tunlink: { value: unlink$1 },\n\t\tunshift: { value: unshift },\n\t\tupdate: { value: update$2 },\n\t\tupdateModel: { value: updateModel$1 },\n\n\t\tisBound: { value: isBound },\n\t\tgetBindingPath: { value: getBindingPath },\n\t\tgetBinding: { value: getBinding },\n\t\tsetBinding: { value: setBinding },\n\n\t\tdecorators: {\n\t\t\tget: function get$1 () {\n\t\t\t\tvar items = {};\n\t\t\t\telement.decorators.forEach( function (d) { return items[ d.name ] = d.intermediary; } );\n\t\t\t\treturn items;\n\t\t\t}\n\t\t}\n\t});\n\n\treturn obj;\n}\n\nvar query = doc && doc.querySelector;\n\nvar staticInfo = function( node ) {\n\tif ( typeof node === 'string' && query ) {\n\t\tnode = query.call( document, node );\n\t}\n\n\tif ( !node || !node._ractive ) { return {}; }\n\n\tvar storage = node._ractive;\n\n\treturn addHelpers( {}, storage.proxy );\n};\n\nfunction getNodeInfo( node, options ) {\n\tif ( typeof node === 'string' ) {\n\t\tnode = this.find( node, options );\n\t}\n\n\treturn staticInfo( node );\n}\n\nvar insertHook = new Hook( 'insert' );\n\nfunction Ractive$insert ( target, anchor ) {\n\tif ( !this.fragment.rendered ) {\n\t\t// TODO create, and link to, documentation explaining this\n\t\tthrow new Error( 'The API has changed - you must call `ractive.render(target[, anchor])` to render your Ractive instance. Once rendered you can use `ractive.insert()`.' );\n\t}\n\n\ttarget = getElement( target );\n\tanchor = getElement( anchor ) || null;\n\n\tif ( !target ) {\n\t\tthrow new Error( 'You must specify a valid target to insert into' );\n\t}\n\n\ttarget.insertBefore( this.detach(), anchor );\n\tthis.el = target;\n\n\t( target.__ractive_instances__ || ( target.__ractive_instances__ = [] ) ).push( this );\n\tthis.isDetached = false;\n\n\tfireInsertHook( this );\n}\n\nfunction fireInsertHook( ractive ) {\n\tinsertHook.fire( ractive );\n\n\tractive.findAllComponents('*').forEach( function (child) {\n\t\tfireInsertHook( child.instance );\n\t});\n}\n\nfunction link$2( there, here, options ) {\n\tif ( here === there || (there + '.').indexOf( here + '.' ) === 0 || (here + '.').indexOf( there + '.' ) === 0 ) {\n\t\tthrow new Error( 'A keypath cannot be linked to itself.' );\n\t}\n\n\tvar promise = runloop.start();\n\tvar model;\n\tvar target = ( options && options.ractive ) || this;\n\n\t// may need to allow a mapping to resolve implicitly\n\tvar sourcePath = splitKeypath( there );\n\tif ( !target.viewmodel.has( sourcePath[0] ) && target.component ) {\n\t\tmodel = resolveReference( target.component.parentFragment, sourcePath[0] );\n\t\tmodel = model.joinAll( sourcePath.slice( 1 ) );\n\t}\n\n\tthis.viewmodel.joinAll( splitKeypath( here ) ).link( model || target.viewmodel.joinAll( sourcePath ), there );\n\n\trunloop.end();\n\n\treturn promise;\n}\n\nfunction observe$1 ( keypath, callback, options ) {\n\tvar this$1 = this;\n\n\tvar observers = [];\n\tvar map;\n\n\tif ( isObject( keypath ) ) {\n\t\tmap = keypath;\n\t\toptions = callback || {};\n\t} else {\n\t\tif ( typeof keypath === 'function' ) {\n\t\t\tmap = { '': keypath };\n\t\t\toptions = callback;\n\t\t} else {\n\t\t\tmap = {};\n\t\t\tmap[ keypath ] = callback;\n\t\t}\n\t}\n\n\tvar silent = false;\n\tObject.keys( map ).forEach( function (keypath) {\n\t\tvar callback = map[ keypath ];\n\t\tvar caller = function () {\n\t\t\tvar args = [], len = arguments.length;\n\t\t\twhile ( len-- ) args[ len ] = arguments[ len ];\n\n\t\t\tif ( silent ) { return; }\n\t\t\treturn callback.apply( this, args );\n\t\t};\n\n\t\tvar keypaths = keypath.split( ' ' );\n\t\tif ( keypaths.length > 1 ) { keypaths = keypaths.filter( function (k) { return k; } ); }\n\n\t\tkeypaths.forEach( function (keypath) {\n\t\t\tobservers.push( createObserver( this$1, keypath, caller, options || {} ) );\n\t\t});\n\t});\n\n\t// add observers to the Ractive instance, so they can be\n\t// cancelled on ractive.teardown()\n\tthis._observers.push.apply( this._observers, observers );\n\n\treturn {\n\t\tcancel: function () { return observers.forEach( function (o) { return o.cancel(); } ); },\n\t\tisSilenced: function () { return silent; },\n\t\tsilence: function () { return silent = true; },\n\t\tresume: function () { return silent = false; }\n\t};\n}\n\nfunction createObserver ( ractive, keypath, callback, options ) {\n\tvar keys = splitKeypath( keypath );\n\tvar wildcardIndex = keys.indexOf( '*' );\n\toptions.keypath = keypath;\n\toptions.fragment = options.fragment || ractive.fragment;\n\n\tvar model;\n\tif ( !options.fragment ) {\n\t\tmodel = ractive.viewmodel.joinKey( keys[0] );\n\t} else {\n\t\t// .*.whatever relative wildcard is a special case because splitkeypath doesn't handle the leading .\n\t\tif ( keys[0] === '.*' ) {\n\t\t\tmodel = options.fragment.findContext();\n\t\t\twildcardIndex = 0;\n\t\t\tkeys[0] = '*';\n\t\t} else {\n\t\t\tmodel = wildcardIndex === 0 ? options.fragment.findContext() : resolveReference( options.fragment, keys[0] );\n\t\t}\n\t}\n\n\t// the model may not exist key\n\tif ( !model ) { model = ractive.viewmodel.joinKey( keys[0] ); }\n\n\tif ( !~wildcardIndex ) {\n\t\tmodel = model.joinAll( keys.slice( 1 ) );\n\t\treturn new Observer( ractive, model, callback, options );\n\t} else {\n\t\tmodel = model.joinAll( keys.slice( 1, wildcardIndex ) );\n\t\treturn new PatternObserver( ractive, model, keys.slice( wildcardIndex ), callback, options );\n\t}\n}\n\nvar Observer = function Observer ( ractive, model, callback, options ) {\n\tthis.context = options.context || ractive;\n\tthis.callback = callback;\n\tthis.ractive = ractive;\n\n\tif ( model ) { this.resolved( model ); }\n\n\tif ( options.init !== false ) {\n\t\tthis.dirty = true;\n\t\tthis.dispatch();\n\t} else {\n\t\tthis.oldValue = this.newValue;\n\t}\n\n\tthis.defer = options.defer;\n\tthis.once = options.once;\n\tthis.strict = options.strict;\n\n\tthis.dirty = false;\n};\n\nObserver.prototype.cancel = function cancel () {\n\tthis.cancelled = true;\n\tif ( this.model ) {\n\t\tthis.model.unregister( this );\n\t} else {\n\t\tthis.resolver.unbind();\n\t}\n\tremoveFromArray( this.ractive._observers, this );\n};\n\nObserver.prototype.dispatch = function dispatch () {\n\tif ( !this.cancelled ) {\n\t\tthis.callback.call( this.context, this.newValue, this.oldValue, this.keypath );\n\t\tthis.oldValue = this.model ? this.model.get() : this.newValue;\n\t\tthis.dirty = false;\n\t}\n};\n\nObserver.prototype.handleChange = function handleChange () {\n\t\tvar this$1 = this;\n\n\tif ( !this.dirty ) {\n\t\tvar newValue = this.model.get();\n\t\tif ( isEqual( newValue, this.oldValue ) ) { return; }\n\n\t\tthis.newValue = newValue;\n\n\t\tif ( this.strict && this.newValue === this.oldValue ) { return; }\n\n\t\trunloop.addObserver( this, this.defer );\n\t\tthis.dirty = true;\n\n\t\tif ( this.once ) { runloop.scheduleTask( function () { return this$1.cancel(); } ); }\n\t}\n};\n\nObserver.prototype.rebinding = function rebinding ( next, previous ) {\n\t\tvar this$1 = this;\n\n\tnext = rebindMatch( this.keypath, next, previous );\n\t// TODO: set up a resolver if next is undefined?\n\tif ( next === this.model ) { return false; }\n\n\tif ( this.model ) { this.model.unregister( this ); }\n\tif ( next ) { next.addShuffleTask( function () { return this$1.resolved( next ); } ); }\n};\n\nObserver.prototype.resolved = function resolved ( model ) {\n\tthis.model = model;\n\tthis.keypath = model.getKeypath( this.ractive );\n\n\tthis.oldValue = undefined;\n\tthis.newValue = model.get();\n\n\tmodel.register( this );\n};\n\nvar PatternObserver = function PatternObserver ( ractive, baseModel, keys, callback, options ) {\n\tvar this$1 = this;\n\n\tthis.context = options.context || ractive;\n\tthis.ractive = ractive;\n\tthis.baseModel = baseModel;\n\tthis.keys = keys;\n\tthis.callback = callback;\n\n\tvar pattern = keys.join( '\\\\.' ).replace( /\\*/g, '(.+)' );\n\tvar baseKeypath = baseModel.getKeypath( ractive );\n\tthis.pattern = new RegExp( (\"^\" + (baseKeypath ? baseKeypath + '\\\\.' : '') + pattern + \"$\") );\n\n\tthis.oldValues = {};\n\tthis.newValues = {};\n\n\tthis.defer = options.defer;\n\tthis.once = options.once;\n\tthis.strict = options.strict;\n\n\tthis.dirty = false;\n\tthis.changed = [];\n\tthis.partial = false;\n\n\tvar models = baseModel.findMatches( this.keys );\n\n\tmodels.forEach( function (model) {\n\t\tthis$1.newValues[ model.getKeypath( this$1.ractive ) ] = model.get();\n\t});\n\n\tif ( options.init !== false ) {\n\t\tthis.dispatch();\n\t} else {\n\t\tthis.oldValues = this.newValues;\n\t}\n\n\tbaseModel.registerPatternObserver( this );\n};\n\nPatternObserver.prototype.cancel = function cancel () {\n\tthis.baseModel.unregisterPatternObserver( this );\n\tremoveFromArray( this.ractive._observers, this );\n};\n\nPatternObserver.prototype.dispatch = function dispatch () {\n\t\tvar this$1 = this;\n\n\tObject.keys( this.newValues ).forEach( function (keypath) {\n\t\tif ( this$1.newKeys && !this$1.newKeys[ keypath ] ) { return; }\n\n\t\tvar newValue = this$1.newValues[ keypath ];\n\t\tvar oldValue = this$1.oldValues[ keypath ];\n\n\t\tif ( this$1.strict && newValue === oldValue ) { return; }\n\t\tif ( isEqual( newValue, oldValue ) ) { return; }\n\n\t\tvar args = [ newValue, oldValue, keypath ];\n\t\tif ( keypath ) {\n\t\t\tvar wildcards = this$1.pattern.exec( keypath );\n\t\t\tif ( wildcards ) {\n\t\t\t\targs = args.concat( wildcards.slice( 1 ) );\n\t\t\t}\n\t\t}\n\n\t\tthis$1.callback.apply( this$1.context, args );\n\t});\n\n\tif ( this.partial ) {\n\t\tfor ( var k in this.newValues ) {\n\t\t\tthis$1.oldValues[k] = this$1.newValues[k];\n\t\t}\n\t} else {\n\t\tthis.oldValues = this.newValues;\n\t}\n\n\tthis.newKeys = null;\n\tthis.dirty = false;\n};\n\nPatternObserver.prototype.notify = function notify ( key ) {\n\tthis.changed.push( key );\n};\n\nPatternObserver.prototype.shuffle = function shuffle ( newIndices ) {\n\t\tvar this$1 = this;\n\n\tif ( !isArray( this.baseModel.value ) ) { return; }\n\n\tvar base = this.baseModel.getKeypath( this.ractive );\n\tvar max = this.baseModel.value.length;\n\tvar suffix = this.keys.length > 1 ? '.' + this.keys.slice( 1 ).join( '.' ) : '';\n\n\tthis.newKeys = {};\n\tfor ( var i = 0; i < newIndices.length; i++ ) {\n\t\tif ( newIndices[ i ] === -1 || newIndices[ i ] === i ) { continue; }\n\t\tthis$1.newKeys[ (base + \".\" + i + suffix) ] = true;\n\t}\n\n\tfor ( var i$1 = newIndices.touchedFrom; i$1 < max; i$1++ ) {\n\t\tthis$1.newKeys[ (base + \".\" + i$1 + suffix) ] = true;\n\t}\n};\n\nPatternObserver.prototype.handleChange = function handleChange () {\n\t\tvar this$1 = this;\n\n\tif ( !this.dirty || this.changed.length ) {\n\t\tif ( !this.dirty ) { this.newValues = {}; }\n\n\t\t// handle case where previously extant keypath no longer exists -\n\t\t// observer should still fire, with undefined as new value\n\t\t// TODO huh. according to the test suite that's not the case...\n\t\t// NOTE: I don't think this will work with partial updates\n\t\t// Object.keys( this.oldValues ).forEach( keypath => {\n\t\t// this.newValues[ keypath ] = undefined;\n\t\t// });\n\n\t\tif ( !this.changed.length ) {\n\t\t\tthis.baseModel.findMatches( this.keys ).forEach( function (model) {\n\t\t\t\tvar keypath = model.getKeypath( this$1.ractive );\n\t\t\t\tthis$1.newValues[ keypath ] = model.get();\n\t\t\t});\n\t\t\tthis.partial = false;\n\t\t} else {\n\t\t\tvar count = 0;\n\t\t\tvar ok = this.baseModel.isRoot ?\n\t\t\t\tthis.changed.map( function (keys) { return keys.map( escapeKey ).join( '.' ); } ) :\n\t\t\t\tthis.changed.map( function (keys) { return this$1.baseModel.getKeypath( this$1.ractive ) + '.' + keys.map( escapeKey ).join( '.' ); } );\n\n\t\t\tthis.baseModel.findMatches( this.keys ).forEach( function (model) {\n\t\t\t\tvar keypath = model.getKeypath( this$1.ractive );\n\t\t\t\t// is this model on a changed keypath?\n\t\t\t\tif ( ok.filter( function (k) { return keypath.indexOf( k ) === 0 || k.indexOf( keypath ) === 0; } ).length ) {\n\t\t\t\t\tcount++;\n\t\t\t\t\tthis$1.newValues[ keypath ] = model.get();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// no valid change triggered, so bail to avoid breakage\n\t\t\tif ( !count ) { return; }\n\n\t\t\tthis.partial = true;\n\t\t}\n\n\t\trunloop.addObserver( this, this.defer );\n\t\tthis.dirty = true;\n\t\tthis.changed.length = 0;\n\n\t\tif ( this.once ) { this.cancel(); }\n\t}\n};\n\nfunction observeList ( keypath, callback, options ) {\n\tif ( typeof keypath !== 'string' ) {\n\t\tthrow new Error( 'ractive.observeList() must be passed a string as its first argument' );\n\t}\n\n\tvar model = this.viewmodel.joinAll( splitKeypath( keypath ) );\n\tvar observer = new ListObserver( this, model, callback, options || {} );\n\n\t// add observer to the Ractive instance, so it can be\n\t// cancelled on ractive.teardown()\n\tthis._observers.push( observer );\n\n\treturn {\n\t\tcancel: function cancel () {\n\t\t\tobserver.cancel();\n\t\t}\n\t};\n}\n\nfunction negativeOne () {\n\treturn -1;\n}\n\nvar ListObserver = function ListObserver ( context, model, callback, options ) {\n\tthis.context = context;\n\tthis.model = model;\n\tthis.keypath = model.getKeypath();\n\tthis.callback = callback;\n\n\tthis.pending = null;\n\n\tmodel.register( this );\n\n\tif ( options.init !== false ) {\n\t\tthis.sliced = [];\n\t\tthis.shuffle([]);\n\t\tthis.handleChange();\n\t} else {\n\t\tthis.sliced = this.slice();\n\t}\n};\n\nListObserver.prototype.handleChange = function handleChange () {\n\tif ( this.pending ) {\n\t\t// post-shuffle\n\t\tthis.callback( this.pending );\n\t\tthis.pending = null;\n\t}\n\n\telse {\n\t\t// entire array changed\n\t\tthis.shuffle( this.sliced.map( negativeOne ) );\n\t\tthis.handleChange();\n\t}\n};\n\nListObserver.prototype.shuffle = function shuffle ( newIndices ) {\n\t\tvar this$1 = this;\n\n\tvar newValue = this.slice();\n\n\tvar inserted = [];\n\tvar deleted = [];\n\tvar start;\n\n\tvar hadIndex = {};\n\n\tnewIndices.forEach( function ( newIndex, oldIndex ) {\n\t\thadIndex[ newIndex ] = true;\n\n\t\tif ( newIndex !== oldIndex && start === undefined ) {\n\t\t\tstart = oldIndex;\n\t\t}\n\n\t\tif ( newIndex === -1 ) {\n\t\t\tdeleted.push( this$1.sliced[ oldIndex ] );\n\t\t}\n\t});\n\n\tif ( start === undefined ) { start = newIndices.length; }\n\n\tvar len = newValue.length;\n\tfor ( var i = 0; i < len; i += 1 ) {\n\t\tif ( !hadIndex[i] ) { inserted.push( newValue[i] ); }\n\t}\n\n\tthis.pending = { inserted: inserted, deleted: deleted, start: start };\n\tthis.sliced = newValue;\n};\n\nListObserver.prototype.slice = function slice () {\n\tvar value = this.model.get();\n\treturn isArray( value ) ? value.slice() : [];\n};\n\nvar onceOptions = { init: false, once: true };\n\nfunction observeOnce$1 ( keypath, callback, options ) {\n\tif ( isObject( keypath ) || typeof keypath === 'function' ) {\n\t\toptions = extend$1( callback || {}, onceOptions );\n\t\treturn this.observe( keypath, options );\n\t}\n\n\toptions = extend$1( options || {}, onceOptions );\n\treturn this.observe( keypath, callback, options );\n}\n\nvar trim = function (str) { return str.trim(); };\n\nvar notEmptyString = function (str) { return str !== ''; };\n\nfunction Ractive$off ( eventName, callback ) {\n\tvar this$1 = this;\n\n\t// if no event is specified, remove _all_ event listeners\n\tif ( !eventName ) {\n\t\tthis._subs = {};\n\t} else {\n\t\t// Handle multiple space-separated event names\n\t\tvar eventNames = eventName.split( ' ' ).map( trim ).filter( notEmptyString );\n\n\t\teventNames.forEach( function (event) {\n\t\t\tvar subs = this$1._subs[ event ];\n\t\t\t// if given a specific callback to remove, remove only it\n\t\t\tif ( subs && callback ) {\n\t\t\t\t// flag this callback as off so that any in-flight firings don't call\n\t\t\t\t// a cancelled handler - this is _slightly_ hacky\n\t\t\t\t( callback._proxy || callback ).off = true;\n\t\t\t\tremoveFromArray( subs, callback._proxy || callback );\n\t\t\t}\n\n\t\t\t// otherwise, remove all listeners for this event\n\t\t\telse if ( subs ) {\n\t\t\t\tsubs.length = 0;\n\t\t\t}\n\t\t});\n\t}\n\n\treturn this;\n}\n\nfunction Ractive$on ( eventName, callback ) {\n\tvar this$1 = this;\n\n\t// eventName may already be a map\n\tvar map = typeof eventName === 'object' ? eventName : {};\n\t// or it may be a string along with a callback\n\tif ( typeof eventName === 'string' ) { map[ eventName ] = callback; }\n\n\tvar silent = false;\n\tvar events = [];\n\n\tvar loop = function ( k ) {\n\t\tvar callback$1 = map[k];\n\t\tvar caller = function () {\n\t\t\tvar args = [], len = arguments.length;\n\t\t\twhile ( len-- ) args[ len ] = arguments[ len ];\n\n\t\t\tif ( !silent ) { return callback$1.apply( this, args ); }\n\t\t};\n\t\tcallback$1._proxy = caller;\n\n\t\tif ( map.hasOwnProperty( k ) ) {\n\t\t\tvar names = k.split( ' ' ).map( trim ).filter( notEmptyString );\n\t\t\tnames.forEach( function (n) {\n\t\t\t\t( this$1._subs[ n ] || ( this$1._subs[ n ] = [] ) ).push( caller );\n\t\t\t\tevents.push( [ n, caller ] );\n\t\t\t});\n\t\t}\n\t};\n\n\tfor ( var k in map ) loop( k );\n\n\treturn {\n\t\tcancel: function () { return events.forEach( function (e) { return this$1.off( e[0], e[1] ); } ); },\n\t\tisSilenced: function () { return silent; },\n\t\tsilence: function () { return silent = true; },\n\t\tresume: function () { return silent = false; }\n\t};\n}\n\nfunction Ractive$once ( eventName, handler ) {\n\tvar listener = this.on( eventName, function () {\n\t\thandler.apply( this, arguments );\n\t\tlistener.cancel();\n\t});\n\n\t// so we can still do listener.cancel() manually\n\treturn listener;\n}\n\nvar pop$1 = makeArrayMethod( 'pop' ).path;\n\nvar push$1 = makeArrayMethod( 'push' ).path;\n\nvar PREFIX = '/* Ractive.js component styles */';\n\n// Holds current definitions of styles.\nvar styleDefinitions = [];\n\n// Flag to tell if we need to update the CSS\nvar isDirty = false;\n\n// These only make sense on the browser. See additional setup below.\nvar styleElement = null;\nvar useCssText = null;\n\nfunction addCSS( styleDefinition ) {\n\tstyleDefinitions.push( styleDefinition );\n\tisDirty = true;\n}\n\nfunction applyCSS() {\n\n\t// Apply only seems to make sense when we're in the DOM. Server-side renders\n\t// can call toCSS to get the updated CSS.\n\tif ( !doc || !isDirty ) { return; }\n\n\tif ( useCssText ) {\n\t\tstyleElement.styleSheet.cssText = getCSS( null );\n\t} else {\n\t\tstyleElement.innerHTML = getCSS( null );\n\t}\n\n\tisDirty = false;\n}\n\nfunction getCSS( cssIds ) {\n\n\tvar filteredStyleDefinitions = cssIds ? styleDefinitions.filter( function (style) { return ~cssIds.indexOf( style.id ); } ) : styleDefinitions;\n\n\treturn filteredStyleDefinitions.reduce( function ( styles, style ) { return (styles + \"\\n\\n/* {\" + (style.id) + \"} */\\n\" + (style.styles)); }, PREFIX );\n\n}\n\n// If we're on the browser, additional setup needed.\nif ( doc && ( !styleElement || !styleElement.parentNode ) ) {\n\n\tstyleElement = doc.createElement( 'style' );\n\tstyleElement.type = 'text/css';\n\n\tdoc.getElementsByTagName( 'head' )[ 0 ].appendChild( styleElement );\n\n\tuseCssText = !!styleElement.styleSheet;\n}\n\nvar adaptConfigurator = {\n\textend: function ( Parent, proto, options ) {\n\t\tproto.adapt = combine( proto.adapt, ensureArray( options.adapt ) );\n\t},\n\n\tinit: function init () {}\n};\n\nvar selectorsPattern = /(?:^|\\})?\\s*([^\\{\\}]+)\\s*\\{/g;\nvar commentsPattern = /\\/\\*[\\s\\S]*?\\*\\//g;\nvar selectorUnitPattern = /((?:(?:\\[[^\\]+]\\])|(?:[^\\s\\+\\>~:]))+)((?:::?[^\\s\\+\\>\\~\\(:]+(?:\\([^\\)]+\\))?)*\\s*[\\s\\+\\>\\~]?)\\s*/g;\nvar excludePattern = /^(?:@|\\d+%)/;\nvar dataRvcGuidPattern = /\\[data-ractive-css~=\"\\{[a-z0-9-]+\\}\"]/g;\n\nfunction trim$1 ( str ) {\n\treturn str.trim();\n}\n\nfunction extractString ( unit ) {\n\treturn unit.str;\n}\n\nfunction transformSelector ( selector, parent ) {\n\tvar selectorUnits = [];\n\tvar match;\n\n\twhile ( match = selectorUnitPattern.exec( selector ) ) {\n\t\tselectorUnits.push({\n\t\t\tstr: match[0],\n\t\t\tbase: match[1],\n\t\t\tmodifiers: match[2]\n\t\t});\n\t}\n\n\t// For each simple selector within the selector, we need to create a version\n\t// that a) combines with the id, and b) is inside the id\n\tvar base = selectorUnits.map( extractString );\n\n\tvar transformed = [];\n\tvar i = selectorUnits.length;\n\n\twhile ( i-- ) {\n\t\tvar appended = base.slice();\n\n\t\t// Pseudo-selectors should go after the attribute selector\n\t\tvar unit = selectorUnits[i];\n\t\tappended[i] = unit.base + parent + unit.modifiers || '';\n\n\t\tvar prepended = base.slice();\n\t\tprepended[i] = parent + ' ' + prepended[i];\n\n\t\ttransformed.push( appended.join( ' ' ), prepended.join( ' ' ) );\n\t}\n\n\treturn transformed.join( ', ' );\n}\n\nfunction transformCss ( css, id ) {\n\tvar dataAttr = \"[data-ractive-css~=\\\"{\" + id + \"}\\\"]\";\n\n\tvar transformed;\n\n\tif ( dataRvcGuidPattern.test( css ) ) {\n\t\ttransformed = css.replace( dataRvcGuidPattern, dataAttr );\n\t} else {\n\t\ttransformed = css\n\t\t.replace( commentsPattern, '' )\n\t\t.replace( selectorsPattern, function ( match, $1 ) {\n\t\t\t// don't transform at-rules and keyframe declarations\n\t\t\tif ( excludePattern.test( $1 ) ) { return match; }\n\n\t\t\tvar selectors = $1.split( ',' ).map( trim$1 );\n\t\t\tvar transformed = selectors\n\t\t\t\t.map( function (selector) { return transformSelector( selector, dataAttr ); } )\n\t\t\t\t.join( ', ' ) + ' ';\n\n\t\t\treturn match.replace( $1, transformed );\n\t\t});\n\t}\n\n\treturn transformed;\n}\n\nfunction s4() {\n\treturn Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1);\n}\n\nfunction uuid() {\n\treturn s4() + s4() + '-' + s4() + '-' + s4() + '-' + s4() + '-' + s4() + s4() + s4();\n}\n\nvar cssConfigurator = {\n\tname: 'css',\n\n\t// Called when creating a new component definition\n\textend: function ( Parent, proto, options ) {\n\t\tif ( !options.css ) { return; }\n\n\t\tvar id = uuid();\n\t\tvar styles = options.noCssTransform ? options.css : transformCss( options.css, id );\n\n\t\tproto.cssId = id;\n\n\t\taddCSS( { id: id, styles: styles } );\n\n\t},\n\n\t// Called when creating a new component instance\n\tinit: function ( Parent, target, options ) {\n\t\tif ( !options.css ) { return; }\n\n\t\twarnIfDebug( \"\\nThe css option is currently not supported on a per-instance basis and will be discarded. Instead, we recommend instantiating from a component definition with a css option.\\n\\nconst Component = Ractive.extend({\\n\\t...\\n\\tcss: '/* your css */',\\n\\t...\\n});\\n\\nconst componentInstance = new Component({ ... })\\n\\t\\t\" );\n\t}\n\n};\n\nfunction validate ( data ) {\n\t// Warn if userOptions.data is a non-POJO\n\tif ( data && data.constructor !== Object ) {\n\t\tif ( typeof data === 'function' ) {\n\t\t\t// TODO do we need to support this in the new Ractive() case?\n\t\t} else if ( typeof data !== 'object' ) {\n\t\t\tfatal( (\"data option must be an object or a function, `\" + data + \"` is not valid\") );\n\t\t} else {\n\t\t\twarnIfDebug( 'If supplied, options.data should be a plain JavaScript object - using a non-POJO as the root object may work, but is discouraged' );\n\t\t}\n\t}\n}\n\nvar dataConfigurator = {\n\tname: 'data',\n\n\textend: function ( Parent, proto, options ) {\n\t\tvar key;\n\t\tvar value;\n\n\t\t// check for non-primitives, which could cause mutation-related bugs\n\t\tif ( options.data && isObject( options.data ) ) {\n\t\t\tfor ( key in options.data ) {\n\t\t\t\tvalue = options.data[ key ];\n\n\t\t\t\tif ( value && typeof value === 'object' ) {\n\t\t\t\t\tif ( isObject( value ) || isArray( value ) ) {\n\t\t\t\t\t\twarnIfDebug( \"Passing a `data` option with object and array properties to Ractive.extend() is discouraged, as mutating them is likely to cause bugs. Consider using a data function instead:\\n\\n  // this...\\n  data: function () {\\n    return {\\n      myObject: {}\\n    };\\n  })\\n\\n  // instead of this:\\n  data: {\\n    myObject: {}\\n  }\" );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tproto.data = combine$1( proto.data, options.data );\n\t},\n\n\tinit: function ( Parent, ractive, options ) {\n\t\tvar result = combine$1( Parent.prototype.data, options.data );\n\n\t\tif ( typeof result === 'function' ) { result = result.call( ractive ); }\n\n\t\t// bind functions to the ractive instance at the top level,\n\t\t// unless it's a non-POJO (in which case alarm bells should ring)\n\t\tif ( result && result.constructor === Object ) {\n\t\t\tfor ( var prop in result ) {\n\t\t\t\tif ( typeof result[ prop ] === 'function' ) {\n\t\t\t\t\tvar value = result[ prop ];\n\t\t\t\t\tresult[ prop ] = bind$2( value, ractive );\n\t\t\t\t\tresult[ prop ]._r_unbound = value;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn result || {};\n\t},\n\n\treset: function reset ( ractive ) {\n\t\tvar result = this.init( ractive.constructor, ractive, ractive.viewmodel );\n\t\tractive.viewmodel.root.set( result );\n\t\treturn true;\n\t}\n};\n\nfunction combine$1 ( parentValue, childValue ) {\n\tvalidate( childValue );\n\n\tvar parentIsFn = typeof parentValue === 'function';\n\tvar childIsFn = typeof childValue === 'function';\n\n\t// Very important, otherwise child instance can become\n\t// the default data object on Ractive or a component.\n\t// then ractive.set() ends up setting on the prototype!\n\tif ( !childValue && !parentIsFn ) {\n\t\tchildValue = {};\n\t}\n\n\t// Fast path, where we just need to copy properties from\n\t// parent to child\n\tif ( !parentIsFn && !childIsFn ) {\n\t\treturn fromProperties( childValue, parentValue );\n\t}\n\n\treturn function () {\n\t\tvar child = childIsFn ? callDataFunction( childValue, this ) : childValue;\n\t\tvar parent = parentIsFn ? callDataFunction( parentValue, this ) : parentValue;\n\n\t\treturn fromProperties( child, parent );\n\t};\n}\n\nfunction callDataFunction ( fn, context ) {\n\tvar data = fn.call( context );\n\n\tif ( !data ) { return; }\n\n\tif ( typeof data !== 'object' ) {\n\t\tfatal( 'Data function must return an object' );\n\t}\n\n\tif ( data.constructor !== Object ) {\n\t\twarnOnceIfDebug( 'Data function returned something other than a plain JavaScript object. This might work, but is strongly discouraged' );\n\t}\n\n\treturn data;\n}\n\nfunction fromProperties ( primary, secondary ) {\n\tif ( primary && secondary ) {\n\t\tfor ( var key in secondary ) {\n\t\t\tif ( !( key in primary ) ) {\n\t\t\t\tprimary[ key ] = secondary[ key ];\n\t\t\t}\n\t\t}\n\n\t\treturn primary;\n\t}\n\n\treturn primary || secondary;\n}\n\nvar TEMPLATE_VERSION = 4;\n\nvar pattern = /\\$\\{([^\\}]+)\\}/g;\n\nfunction fromExpression ( body, length ) {\n\tif ( length === void 0 ) length = 0;\n\n\tvar args = new Array( length );\n\n\twhile ( length-- ) {\n\t\targs[length] = \"_\" + length;\n\t}\n\n\t// Functions created directly with new Function() look like this:\n\t//     function anonymous (_0 /**/) { return _0*2 }\n\t//\n\t// With this workaround, we get a little more compact:\n\t//     function (_0){return _0*2}\n\treturn new Function( [], (\"return function (\" + (args.join(',')) + \"){return(\" + body + \");};\") )();\n}\n\nfunction fromComputationString ( str, bindTo ) {\n\tvar hasThis;\n\n\tvar functionBody = 'return (' + str.replace( pattern, function ( match, keypath ) {\n\t\thasThis = true;\n\t\treturn (\"__ractive.get(\\\"\" + keypath + \"\\\")\");\n\t}) + ');';\n\n\tif ( hasThis ) { functionBody = \"var __ractive = this; \" + functionBody; }\n\tvar fn = new Function( functionBody );\n\treturn hasThis ? fn.bind( bindTo ) : fn;\n}\n\nvar functions = create( null );\n\nfunction getFunction ( str, i ) {\n\tif ( functions[ str ] ) { return functions[ str ]; }\n\treturn functions[ str ] = createFunction( str, i );\n}\n\nfunction addFunctions( template ) {\n\tif ( !template ) { return; }\n\n\tvar exp = template.e;\n\n\tif ( !exp ) { return; }\n\n\tObject.keys( exp ).forEach( function ( str ) {\n\t\tif ( functions[ str ] ) { return; }\n\t\tfunctions[ str ] = exp[ str ];\n\t});\n}\n\nvar leadingWhitespace = /^\\s+/;\n\nvar ParseError = function ( message ) {\n\tthis.name = 'ParseError';\n\tthis.message = message;\n\ttry {\n\t\tthrow new Error(message);\n\t} catch (e) {\n\t\tthis.stack = e.stack;\n\t}\n};\n\nParseError.prototype = Error.prototype;\n\nvar Parser = function ( str, options ) {\n\tvar item;\n\tvar lineStart = 0;\n\n\tthis.str = str;\n\tthis.options = options || {};\n\tthis.pos = 0;\n\n\tthis.lines = this.str.split( '\\n' );\n\tthis.lineEnds = this.lines.map( function (line) {\n\t\tvar lineEnd = lineStart + line.length + 1; // +1 for the newline\n\n\t\tlineStart = lineEnd;\n\t\treturn lineEnd;\n\t}, 0 );\n\n\t// Custom init logic\n\tif ( this.init ) { this.init( str, options ); }\n\n\tvar items = [];\n\n\twhile ( ( this.pos < this.str.length ) && ( item = this.read() ) ) {\n\t\titems.push( item );\n\t}\n\n\tthis.leftover = this.remaining();\n\tthis.result = this.postProcess ? this.postProcess( items, options ) : items;\n};\n\nParser.prototype = {\n\tread: function read ( converters ) {\n\t\tvar this$1 = this;\n\n\t\tvar i, item;\n\n\t\tif ( !converters ) { converters = this.converters; }\n\n\t\tvar pos = this.pos;\n\n\t\tvar len = converters.length;\n\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\tthis$1.pos = pos; // reset for each attempt\n\n\t\t\tif ( item = converters[i]( this$1 ) ) {\n\t\t\t\treturn item;\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t},\n\n\tgetContextMessage: function getContextMessage ( pos, message ) {\n\t\tvar ref = this.getLinePos( pos );\n\t\tvar lineNum = ref[0];\n\t\tvar columnNum = ref[1];\n\t\tif ( this.options.contextLines === -1 ) {\n\t\t\treturn [ lineNum, columnNum, (message + \" at line \" + lineNum + \" character \" + columnNum) ];\n\t\t}\n\n\t\tvar line = this.lines[ lineNum - 1 ];\n\n\t\tvar contextUp = '';\n\t\tvar contextDown = '';\n\t\tif ( this.options.contextLines ) {\n\t\t\tvar start = lineNum - 1 - this.options.contextLines < 0 ? 0 : lineNum - 1 - this.options.contextLines;\n\t\t\tcontextUp = this.lines.slice( start, lineNum - 1 - start ).join( '\\n' ).replace( /\\t/g, '  ' );\n\t\t\tcontextDown = this.lines.slice( lineNum, lineNum + this.options.contextLines ).join( '\\n' ).replace( /\\t/g, '  ' );\n\t\t\tif ( contextUp ) {\n\t\t\t\tcontextUp += '\\n';\n\t\t\t}\n\t\t\tif ( contextDown ) {\n\t\t\t\tcontextDown = '\\n' + contextDown;\n\t\t\t}\n\t\t}\n\n\t\tvar numTabs = 0;\n\t\tvar annotation = contextUp + line.replace( /\\t/g, function ( match, char ) {\n\t\t\tif ( char < columnNum ) {\n\t\t\t\tnumTabs += 1;\n\t\t\t}\n\n\t\t\treturn '  ';\n\t\t}) + '\\n' + new Array( columnNum + numTabs ).join( ' ' ) + '^----' + contextDown;\n\n\t\treturn [ lineNum, columnNum, (message + \" at line \" + lineNum + \" character \" + columnNum + \":\\n\" + annotation) ];\n\t},\n\n\tgetLinePos: function getLinePos ( char ) {\n\t\tvar this$1 = this;\n\n\t\tvar lineNum = 0;\n\t\tvar lineStart = 0;\n\n\t\twhile ( char >= this.lineEnds[ lineNum ] ) {\n\t\t\tlineStart = this$1.lineEnds[ lineNum ];\n\t\t\tlineNum += 1;\n\t\t}\n\n\t\tvar columnNum = char - lineStart;\n\t\treturn [ lineNum + 1, columnNum + 1, char ]; // line/col should be one-based, not zero-based!\n\t},\n\n\terror: function error ( message ) {\n\t\tvar ref = this.getContextMessage( this.pos, message );\n\t\tvar lineNum = ref[0];\n\t\tvar columnNum = ref[1];\n\t\tvar msg = ref[2];\n\n\t\tvar error = new ParseError( msg );\n\n\t\terror.line = lineNum;\n\t\terror.character = columnNum;\n\t\terror.shortMessage = message;\n\n\t\tthrow error;\n\t},\n\n\tmatchString: function matchString ( string ) {\n\t\tif ( this.str.substr( this.pos, string.length ) === string ) {\n\t\t\tthis.pos += string.length;\n\t\t\treturn string;\n\t\t}\n\t},\n\n\tmatchPattern: function matchPattern ( pattern ) {\n\t\tvar match;\n\n\t\tif ( match = pattern.exec( this.remaining() ) ) {\n\t\t\tthis.pos += match[0].length;\n\t\t\treturn match[1] || match[0];\n\t\t}\n\t},\n\n\tallowWhitespace: function allowWhitespace () {\n\t\tthis.matchPattern( leadingWhitespace );\n\t},\n\n\tremaining: function remaining () {\n\t\treturn this.str.substring( this.pos );\n\t},\n\n\tnextChar: function nextChar () {\n\t\treturn this.str.charAt( this.pos );\n\t}\n};\n\nParser.extend = function ( proto ) {\n\tvar Parent = this;\n\tvar Child = function ( str, options ) {\n\t\tParser.call( this, str, options );\n\t};\n\n\tChild.prototype = create( Parent.prototype );\n\n\tfor ( var key in proto ) {\n\t\tif ( hasOwn.call( proto, key ) ) {\n\t\t\tChild.prototype[ key ] = proto[ key ];\n\t\t}\n\t}\n\n\tChild.extend = Parser.extend;\n\treturn Child;\n};\n\nvar TEXT              = 1;\nvar INTERPOLATOR      = 2;\nvar TRIPLE            = 3;\nvar SECTION           = 4;\nvar INVERTED          = 5;\nvar CLOSING           = 6;\nvar ELEMENT           = 7;\nvar PARTIAL           = 8;\nvar COMMENT           = 9;\nvar DELIMCHANGE       = 10;\nvar ANCHOR            = 11;\nvar ATTRIBUTE         = 13;\nvar CLOSING_TAG       = 14;\nvar COMPONENT         = 15;\nvar YIELDER           = 16;\nvar INLINE_PARTIAL    = 17;\nvar DOCTYPE           = 18;\nvar ALIAS             = 19;\n\nvar NUMBER_LITERAL    = 20;\nvar STRING_LITERAL    = 21;\nvar ARRAY_LITERAL     = 22;\nvar OBJECT_LITERAL    = 23;\nvar BOOLEAN_LITERAL   = 24;\nvar REGEXP_LITERAL    = 25;\n\nvar GLOBAL            = 26;\nvar KEY_VALUE_PAIR    = 27;\n\n\nvar REFERENCE         = 30;\nvar REFINEMENT        = 31;\nvar MEMBER            = 32;\nvar PREFIX_OPERATOR   = 33;\nvar BRACKETED         = 34;\nvar CONDITIONAL       = 35;\nvar INFIX_OPERATOR    = 36;\n\nvar INVOCATION        = 40;\n\nvar SECTION_IF        = 50;\nvar SECTION_UNLESS    = 51;\nvar SECTION_EACH      = 52;\nvar SECTION_WITH      = 53;\nvar SECTION_IF_WITH   = 54;\n\nvar ELSE              = 60;\nvar ELSEIF            = 61;\n\nvar EVENT             = 70;\nvar DECORATOR         = 71;\nvar TRANSITION        = 72;\nvar BINDING_FLAG      = 73;\n\nvar delimiterChangePattern = /^[^\\s=]+/;\nvar whitespacePattern = /^\\s+/;\n\nfunction readDelimiterChange ( parser ) {\n\tif ( !parser.matchString( '=' ) ) {\n\t\treturn null;\n\t}\n\n\tvar start = parser.pos;\n\n\t// allow whitespace before new opening delimiter\n\tparser.allowWhitespace();\n\n\tvar opening = parser.matchPattern( delimiterChangePattern );\n\tif ( !opening ) {\n\t\tparser.pos = start;\n\t\treturn null;\n\t}\n\n\t// allow whitespace (in fact, it's necessary...)\n\tif ( !parser.matchPattern( whitespacePattern ) ) {\n\t\treturn null;\n\t}\n\n\tvar closing = parser.matchPattern( delimiterChangePattern );\n\tif ( !closing ) {\n\t\tparser.pos = start;\n\t\treturn null;\n\t}\n\n\t// allow whitespace before closing '='\n\tparser.allowWhitespace();\n\n\tif ( !parser.matchString( '=' ) ) {\n\t\tparser.pos = start;\n\t\treturn null;\n\t}\n\n\treturn [ opening, closing ];\n}\n\nvar regexpPattern = /^(\\/(?:[^\\n\\r\\u2028\\u2029/\\\\[]|\\\\.|\\[(?:[^\\n\\r\\u2028\\u2029\\]\\\\]|\\\\.)*])+\\/(?:([gimuy])(?![a-z]*\\2))*(?![a-zA-Z_$0-9]))/;\n\nfunction readNumberLiteral ( parser ) {\n\tvar result;\n\n\tif ( result = parser.matchPattern( regexpPattern ) ) {\n\t\treturn {\n\t\t\tt: REGEXP_LITERAL,\n\t\t\tv: result\n\t\t};\n\t}\n\n\treturn null;\n}\n\nvar pattern$1 = /[-/\\\\^$*+?.()|[\\]{}]/g;\n\nfunction escapeRegExp ( str ) {\n\treturn str.replace( pattern$1, '\\\\$&' );\n}\n\nvar regExpCache = {};\n\nvar getLowestIndex = function ( haystack, needles ) {\n\treturn haystack.search( regExpCache[needles.join()] || ( regExpCache[needles.join()] = new RegExp( needles.map( escapeRegExp ).join( '|' ) ) ) );\n};\n\n// https://github.com/kangax/html-minifier/issues/63#issuecomment-37763316\nvar booleanAttributes = /^(allowFullscreen|async|autofocus|autoplay|checked|compact|controls|declare|default|defaultChecked|defaultMuted|defaultSelected|defer|disabled|enabled|formNoValidate|hidden|indeterminate|inert|isMap|itemScope|loop|multiple|muted|noHref|noResize|noShade|noValidate|noWrap|open|pauseOnExit|readOnly|required|reversed|scoped|seamless|selected|sortable|translate|trueSpeed|typeMustMatch|visible)$/i;\nvar voidElementNames = /^(?:area|base|br|col|command|doctype|embed|hr|img|input|keygen|link|meta|param|source|track|wbr)$/i;\n\nvar htmlEntities = { quot: 34, amp: 38, apos: 39, lt: 60, gt: 62, nbsp: 160, iexcl: 161, cent: 162, pound: 163, curren: 164, yen: 165, brvbar: 166, sect: 167, uml: 168, copy: 169, ordf: 170, laquo: 171, not: 172, shy: 173, reg: 174, macr: 175, deg: 176, plusmn: 177, sup2: 178, sup3: 179, acute: 180, micro: 181, para: 182, middot: 183, cedil: 184, sup1: 185, ordm: 186, raquo: 187, frac14: 188, frac12: 189, frac34: 190, iquest: 191, Agrave: 192, Aacute: 193, Acirc: 194, Atilde: 195, Auml: 196, Aring: 197, AElig: 198, Ccedil: 199, Egrave: 200, Eacute: 201, Ecirc: 202, Euml: 203, Igrave: 204, Iacute: 205, Icirc: 206, Iuml: 207, ETH: 208, Ntilde: 209, Ograve: 210, Oacute: 211, Ocirc: 212, Otilde: 213, Ouml: 214, times: 215, Oslash: 216, Ugrave: 217, Uacute: 218, Ucirc: 219, Uuml: 220, Yacute: 221, THORN: 222, szlig: 223, agrave: 224, aacute: 225, acirc: 226, atilde: 227, auml: 228, aring: 229, aelig: 230, ccedil: 231, egrave: 232, eacute: 233, ecirc: 234, euml: 235, igrave: 236, iacute: 237, icirc: 238, iuml: 239, eth: 240, ntilde: 241, ograve: 242, oacute: 243, ocirc: 244, otilde: 245, ouml: 246, divide: 247, oslash: 248, ugrave: 249, uacute: 250, ucirc: 251, uuml: 252, yacute: 253, thorn: 254, yuml: 255, OElig: 338, oelig: 339, Scaron: 352, scaron: 353, Yuml: 376, fnof: 402, circ: 710, tilde: 732, Alpha: 913, Beta: 914, Gamma: 915, Delta: 916, Epsilon: 917, Zeta: 918, Eta: 919, Theta: 920, Iota: 921, Kappa: 922, Lambda: 923, Mu: 924, Nu: 925, Xi: 926, Omicron: 927, Pi: 928, Rho: 929, Sigma: 931, Tau: 932, Upsilon: 933, Phi: 934, Chi: 935, Psi: 936, Omega: 937, alpha: 945, beta: 946, gamma: 947, delta: 948, epsilon: 949, zeta: 950, eta: 951, theta: 952, iota: 953, kappa: 954, lambda: 955, mu: 956, nu: 957, xi: 958, omicron: 959, pi: 960, rho: 961, sigmaf: 962, sigma: 963, tau: 964, upsilon: 965, phi: 966, chi: 967, psi: 968, omega: 969, thetasym: 977, upsih: 978, piv: 982, ensp: 8194, emsp: 8195, thinsp: 8201, zwnj: 8204, zwj: 8205, lrm: 8206, rlm: 8207, ndash: 8211, mdash: 8212, lsquo: 8216, rsquo: 8217, sbquo: 8218, ldquo: 8220, rdquo: 8221, bdquo: 8222, dagger: 8224, Dagger: 8225, bull: 8226, hellip: 8230, permil: 8240, prime: 8242, Prime: 8243, lsaquo: 8249, rsaquo: 8250, oline: 8254, frasl: 8260, euro: 8364, image: 8465, weierp: 8472, real: 8476, trade: 8482, alefsym: 8501, larr: 8592, uarr: 8593, rarr: 8594, darr: 8595, harr: 8596, crarr: 8629, lArr: 8656, uArr: 8657, rArr: 8658, dArr: 8659, hArr: 8660, forall: 8704, part: 8706, exist: 8707, empty: 8709, nabla: 8711, isin: 8712, notin: 8713, ni: 8715, prod: 8719, sum: 8721, minus: 8722, lowast: 8727, radic: 8730, prop: 8733, infin: 8734, ang: 8736, and: 8743, or: 8744, cap: 8745, cup: 8746, int: 8747, there4: 8756, sim: 8764, cong: 8773, asymp: 8776, ne: 8800, equiv: 8801, le: 8804, ge: 8805, sub: 8834, sup: 8835, nsub: 8836, sube: 8838, supe: 8839, oplus: 8853, otimes: 8855, perp: 8869, sdot: 8901, lceil: 8968, rceil: 8969, lfloor: 8970, rfloor: 8971, lang: 9001, rang: 9002, loz: 9674, spades: 9824, clubs: 9827, hearts: 9829, diams: 9830\t};\nvar controlCharacters = [ 8364, 129, 8218, 402, 8222, 8230, 8224, 8225, 710, 8240, 352, 8249, 338, 141, 381, 143, 144, 8216, 8217, 8220, 8221, 8226, 8211, 8212, 732, 8482, 353, 8250, 339, 157, 382, 376 ];\nvar entityPattern = new RegExp( '&(#?(?:x[\\\\w\\\\d]+|\\\\d+|' + Object.keys( htmlEntities ).join( '|' ) + '));?', 'g' );\nvar codePointSupport = typeof String.fromCodePoint === 'function';\nvar codeToChar = codePointSupport ? String.fromCodePoint : String.fromCharCode;\n\nfunction decodeCharacterReferences ( html ) {\n\treturn html.replace( entityPattern, function ( match, entity ) {\n\t\tvar code;\n\n\t\t// Handle named entities\n\t\tif ( entity[0] !== '#' ) {\n\t\t\tcode = htmlEntities[ entity ];\n\t\t} else if ( entity[1] === 'x' ) {\n\t\t\tcode = parseInt( entity.substring( 2 ), 16 );\n\t\t} else {\n\t\t\tcode = parseInt( entity.substring( 1 ), 10 );\n\t\t}\n\n\t\tif ( !code ) {\n\t\t\treturn match;\n\t\t}\n\n\t\treturn codeToChar( validateCode( code ) );\n\t});\n}\n\nvar lessThan = /</g;\nvar greaterThan = />/g;\nvar amp = /&/g;\nvar invalid = 65533;\n\nfunction escapeHtml ( str ) {\n\treturn str\n\t\t.replace( amp, '&amp;' )\n\t\t.replace( lessThan, '&lt;' )\n\t\t.replace( greaterThan, '&gt;' );\n}\n\n// some code points are verboten. If we were inserting HTML, the browser would replace the illegal\n// code points with alternatives in some cases - since we're bypassing that mechanism, we need\n// to replace them ourselves\n//\n// Source: http://en.wikipedia.org/wiki/Character_encodings_in_HTML#Illegal_characters\nfunction validateCode ( code ) {\n\tif ( !code ) {\n\t\treturn invalid;\n\t}\n\n\t// line feed becomes generic whitespace\n\tif ( code === 10 ) {\n\t\treturn 32;\n\t}\n\n\t// ASCII range. (Why someone would use HTML entities for ASCII characters I don't know, but...)\n\tif ( code < 128 ) {\n\t\treturn code;\n\t}\n\n\t// code points 128-159 are dealt with leniently by browsers, but they're incorrect. We need\n\t// to correct the mistake or we'll end up with missing € signs and so on\n\tif ( code <= 159 ) {\n\t\treturn controlCharacters[ code - 128 ];\n\t}\n\n\t// basic multilingual plane\n\tif ( code < 55296 ) {\n\t\treturn code;\n\t}\n\n\t// UTF-16 surrogate halves\n\tif ( code <= 57343 ) {\n\t\treturn invalid;\n\t}\n\n\t// rest of the basic multilingual plane\n\tif ( code <= 65535 ) {\n\t\treturn code;\n\t} else if ( !codePointSupport ) {\n\t\treturn invalid;\n\t}\n\n\t// supplementary multilingual plane 0x10000 - 0x1ffff\n\tif ( code >= 65536 && code <= 131071 ) {\n\t\treturn code;\n\t}\n\n\t// supplementary ideographic plane 0x20000 - 0x2ffff\n\tif ( code >= 131072 && code <= 196607 ) {\n\t\treturn code;\n\t}\n\n\treturn invalid;\n}\n\nvar expectedExpression = 'Expected a JavaScript expression';\nvar expectedParen = 'Expected closing paren';\n\n// bulletproof number regex from https://gist.github.com/Rich-Harris/7544330\nvar numberPattern = /^(?:[+-]?)0*(?:(?:(?:[1-9]\\d*)?\\.\\d+)|(?:(?:0|[1-9]\\d*)\\.)|(?:0|[1-9]\\d*))(?:[eE][+-]?\\d+)?/;\n\nfunction readNumberLiteral$1 ( parser ) {\n\tvar result;\n\n\tif ( result = parser.matchPattern( numberPattern ) ) {\n\t\treturn {\n\t\t\tt: NUMBER_LITERAL,\n\t\t\tv: result\n\t\t};\n\t}\n\n\treturn null;\n}\n\nfunction readBooleanLiteral ( parser ) {\n\tvar remaining = parser.remaining();\n\n\tif ( remaining.substr( 0, 4 ) === 'true' ) {\n\t\tparser.pos += 4;\n\t\treturn {\n\t\t\tt: BOOLEAN_LITERAL,\n\t\t\tv: 'true'\n\t\t};\n\t}\n\n\tif ( remaining.substr( 0, 5 ) === 'false' ) {\n\t\tparser.pos += 5;\n\t\treturn {\n\t\t\tt: BOOLEAN_LITERAL,\n\t\t\tv: 'false'\n\t\t};\n\t}\n\n\treturn null;\n}\n\n// Match one or more characters until: \", ', \\, or EOL/EOF.\n// EOL/EOF is written as (?!.) (meaning there's no non-newline char next).\nvar stringMiddlePattern = /^(?=.)[^\"'\\\\]+?(?:(?!.)|(?=[\"'\\\\]))/;\n\n// Match one escape sequence, including the backslash.\nvar escapeSequencePattern = /^\\\\(?:['\"\\\\bfnrt]|0(?![0-9])|x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|(?=.)[^ux0-9])/;\n\n// Match one ES5 line continuation (backslash + line terminator).\nvar lineContinuationPattern = /^\\\\(?:\\r\\n|[\\u000A\\u000D\\u2028\\u2029])/;\n\n// Helper for defining getDoubleQuotedString and getSingleQuotedString.\nvar makeQuotedStringMatcher = function ( okQuote ) {\n\treturn function ( parser ) {\n\t\tvar literal = '\"';\n\t\tvar done = false;\n\t\tvar next;\n\n\t\twhile ( !done ) {\n\t\t\tnext = ( parser.matchPattern( stringMiddlePattern ) || parser.matchPattern( escapeSequencePattern ) ||\n\t\t\t\tparser.matchString( okQuote ) );\n\t\t\tif ( next ) {\n\t\t\t\tif ( next === \"\\\"\" ) {\n\t\t\t\t\tliteral += \"\\\\\\\"\";\n\t\t\t\t} else if ( next === \"\\\\'\" ) {\n\t\t\t\t\tliteral += \"'\";\n\t\t\t\t} else {\n\t\t\t\t\tliteral += next;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tnext = parser.matchPattern( lineContinuationPattern );\n\t\t\t\tif ( next ) {\n\t\t\t\t\t// convert \\(newline-like) into a \\u escape, which is allowed in JSON\n\t\t\t\t\tliteral += '\\\\u' + ( '000' + next.charCodeAt(1).toString(16) ).slice( -4 );\n\t\t\t\t} else {\n\t\t\t\t\tdone = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tliteral += '\"';\n\n\t\t// use JSON.parse to interpret escapes\n\t\treturn JSON.parse( literal );\n\t};\n};\n\nvar getSingleQuotedString = makeQuotedStringMatcher( \"\\\"\" );\nvar getDoubleQuotedString = makeQuotedStringMatcher( \"'\" );\n\nvar readStringLiteral = function ( parser ) {\n\tvar start = parser.pos;\n\n\tif ( parser.matchString( '\"' ) ) {\n\t\tvar string = getDoubleQuotedString( parser );\n\n\t\tif ( !parser.matchString( '\"' ) ) {\n\t\t\tparser.pos = start;\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\tt: STRING_LITERAL,\n\t\t\tv: string\n\t\t};\n\t}\n\n\tif ( parser.matchString( \"'\" ) ) {\n\t\tvar string$1 = getSingleQuotedString( parser );\n\n\t\tif ( !parser.matchString( \"'\" ) ) {\n\t\t\tparser.pos = start;\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\tt: STRING_LITERAL,\n\t\t\tv: string$1\n\t\t};\n\t}\n\n\treturn null;\n};\n\nvar name = /^[a-zA-Z_$][a-zA-Z_$0-9]*/;\nvar spreadPattern = /^\\s*\\.{3}/;\nvar legalReference = /^(?:[a-zA-Z$_0-9]|\\\\\\.)+(?:(?:\\.(?:[a-zA-Z$_0-9]|\\\\\\.)+)|(?:\\[[0-9]+\\]))*/;\nvar relaxedName = /^[a-zA-Z_$][-\\/a-zA-Z_$0-9]*(?:\\.(?:[a-zA-Z_$][-\\/a-zA-Z_$0-9]*))*/;\n\nvar identifier = /^[a-zA-Z_$][a-zA-Z_$0-9]*$/;\n\n// http://mathiasbynens.be/notes/javascript-properties\n// can be any name, string literal, or number literal\nfunction readKey ( parser ) {\n\tvar token;\n\n\tif ( token = readStringLiteral( parser ) ) {\n\t\treturn identifier.test( token.v ) ? token.v : '\"' + token.v.replace( /\"/g, '\\\\\"' ) + '\"';\n\t}\n\n\tif ( token = readNumberLiteral$1( parser ) ) {\n\t\treturn token.v;\n\t}\n\n\tif ( token = parser.matchPattern( name ) ) {\n\t\treturn token;\n\t}\n\n\treturn null;\n}\n\nfunction readKeyValuePair ( parser ) {\n\tvar spread;\n\tvar start = parser.pos;\n\n\t// allow whitespace between '{' and key\n\tparser.allowWhitespace();\n\n\tvar refKey = parser.nextChar() !== '\\'' && parser.nextChar() !== '\"';\n\tif ( refKey ) { spread = parser.matchPattern( spreadPattern ); }\n\n\tvar key = spread ? readExpression( parser ) : readKey( parser );\n\tif ( key === null ) {\n\t\tparser.pos = start;\n\t\treturn null;\n\t}\n\n\t// allow whitespace between key and ':'\n\tparser.allowWhitespace();\n\n\t// es2015 shorthand property\n\tif ( refKey && ( parser.nextChar() === ',' || parser.nextChar() === '}' ) ) {\n\t\tif ( !spread && !name.test( key ) ) {\n\t\t\tparser.error( (\"Expected a valid reference, but found '\" + key + \"' instead.\") );\n\t\t}\n\n\t\tvar pair = {\n\t\t\tt: KEY_VALUE_PAIR,\n\t\t\tk: key,\n\t\t\tv: {\n\t\t\t\tt: REFERENCE,\n\t\t\t\tn: key\n\t\t\t}\n\t\t};\n\n\t\tif ( spread ) {\n\t\t\tpair.p = true;\n\t\t}\n\n\t\treturn pair;\n\t}\n\n\n\t// next character must be ':'\n\tif ( !parser.matchString( ':' ) ) {\n\t\tparser.pos = start;\n\t\treturn null;\n\t}\n\n\t// allow whitespace between ':' and value\n\tparser.allowWhitespace();\n\n\t// next expression must be a, well... expression\n\tvar value = readExpression( parser );\n\tif ( value === null ) {\n\t\tparser.pos = start;\n\t\treturn null;\n\t}\n\n\treturn {\n\t\tt: KEY_VALUE_PAIR,\n\t\tk: key,\n\t\tv: value\n\t};\n}\n\nfunction readKeyValuePairs ( parser ) {\n\tvar start = parser.pos;\n\n\tvar pair = readKeyValuePair( parser );\n\tif ( pair === null ) {\n\t\treturn null;\n\t}\n\n\tvar pairs = [ pair ];\n\n\tif ( parser.matchString( ',' ) ) {\n\t\tvar keyValuePairs = readKeyValuePairs( parser );\n\n\t\tif ( !keyValuePairs ) {\n\t\t\tparser.pos = start;\n\t\t\treturn null;\n\t\t}\n\n\t\treturn pairs.concat( keyValuePairs );\n\t}\n\n\treturn pairs;\n}\n\nvar readObjectLiteral = function ( parser ) {\n\tvar start = parser.pos;\n\n\t// allow whitespace\n\tparser.allowWhitespace();\n\n\tif ( !parser.matchString( '{' ) ) {\n\t\tparser.pos = start;\n\t\treturn null;\n\t}\n\n\tvar keyValuePairs = readKeyValuePairs( parser );\n\n\t// allow whitespace between final value and '}'\n\tparser.allowWhitespace();\n\n\tif ( !parser.matchString( '}' ) ) {\n\t\tparser.pos = start;\n\t\treturn null;\n\t}\n\n\treturn {\n\t\tt: OBJECT_LITERAL,\n\t\tm: keyValuePairs\n\t};\n};\n\nvar readArrayLiteral = function ( parser ) {\n\tvar start = parser.pos;\n\n\t// allow whitespace before '['\n\tparser.allowWhitespace();\n\n\tif ( !parser.matchString( '[' ) ) {\n\t\tparser.pos = start;\n\t\treturn null;\n\t}\n\n\tvar expressionList = readExpressionList( parser, true );\n\n\tif ( !parser.matchString( ']' ) ) {\n\t\tparser.pos = start;\n\t\treturn null;\n\t}\n\n\treturn {\n\t\tt: ARRAY_LITERAL,\n\t\tm: expressionList\n\t};\n};\n\nfunction readLiteral ( parser ) {\n\treturn readNumberLiteral$1( parser )  ||\n\t       readBooleanLiteral( parser ) ||\n\t       readStringLiteral( parser )  ||\n\t       readObjectLiteral( parser )  ||\n\t       readArrayLiteral( parser )   ||\n\t       readNumberLiteral( parser );\n}\n\n// if a reference is a browser global, we don't deference it later, so it needs special treatment\nvar globals = /^(?:Array|console|Date|RegExp|decodeURIComponent|decodeURI|encodeURIComponent|encodeURI|isFinite|isNaN|parseFloat|parseInt|JSON|Math|NaN|undefined|null|Object|Number|String|Boolean)\\b/;\n\n// keywords are not valid references, with the exception of `this`\nvar keywords = /^(?:break|case|catch|continue|debugger|default|delete|do|else|finally|for|function|if|in|instanceof|new|return|switch|throw|try|typeof|var|void|while|with)$/;\n\nvar prefixPattern = /^(?:\\@\\.|\\@|~\\/|(?:\\^\\^\\/(?:\\^\\^\\/)*(?:\\.\\.\\/)*)|(?:\\.\\.\\/)+|\\.\\/(?:\\.\\.\\/)*|\\.)/;\nvar specials = /^(key|index|keypath|rootpath|this|global)/;\nvar specialCall = /^\\s*\\(/;\n\nfunction readReference ( parser ) {\n\tvar prefix, name$$1, global, reference, lastDotIndex;\n\n\tvar startPos = parser.pos;\n\n\tprefix = parser.matchPattern( prefixPattern ) || '';\n\tname$$1 = ( !prefix && parser.relaxedNames && parser.matchPattern( relaxedName ) ) ||\n\t\t\tparser.matchPattern( legalReference );\n\tvar actual = prefix.length + ( ( name$$1 && name$$1.length ) || 0 );\n\n\tif ( prefix === '@.' ) {\n\t\tprefix = '@';\n\t\tif ( name$$1 ) { name$$1 = 'this.' + name$$1; }\n\t\telse { name$$1 = 'this'; }\n\t}\n\n\tif ( !name$$1 && prefix ) {\n\t\tname$$1 = prefix;\n\t\tprefix = '';\n\t}\n\n\tif ( !name$$1 ) {\n\t\treturn null;\n\t}\n\n\tif ( prefix === '@' ) {\n\t\tif ( name$$1 === 'keypath' || name$$1 === 'rootpath' ) {\n\t\t\tif ( parser.matchPattern( specialCall ) ) {\n\t\t\t\tvar ref = readReference( parser );\n\t\t\t\tif ( !ref ) { parser.error( \"Expected a valid reference for a keypath expression\" ); }\n\n\t\t\t\tparser.allowWhitespace();\n\n\t\t\t\tif ( !parser.matchString( ')' ) ) { parser.error( \"Unclosed keypath expression\" ); }\n\t\t\t\tname$$1 += \"(\" + (ref.n) + \")\";\n\t\t\t}\n\t\t} else if ( !specials.test( name$$1 ) ) {\n\t\t\tparser.error( (\"Unrecognized special reference @\" + name$$1) );\n\t\t}\n\t}\n\n\t// bug out if it's a keyword (exception for ancestor/restricted refs - see https://github.com/ractivejs/ractive/issues/1497)\n\tif ( !prefix && !parser.relaxedNames && keywords.test( name$$1 ) ) {\n\t\tparser.pos = startPos;\n\t\treturn null;\n\t}\n\n\t// if this is a browser global, stop here\n\tif ( !prefix && globals.test( name$$1 ) ) {\n\t\tglobal = globals.exec( name$$1 )[0];\n\t\tparser.pos = startPos + global.length;\n\n\t\treturn {\n\t\t\tt: GLOBAL,\n\t\t\tv: global\n\t\t};\n\t}\n\n\treference = ( prefix || '' ) + normalise( name$$1 );\n\n\tif ( parser.matchString( '(' ) ) {\n\t\t// if this is a method invocation (as opposed to a function) we need\n\t\t// to strip the method name from the reference combo, else the context\n\t\t// will be wrong\n\t\t// but only if the reference was actually a member and not a refinement\n\t\tlastDotIndex = reference.lastIndexOf( '.' );\n\t\tif ( lastDotIndex !== -1 && name$$1[ name$$1.length - 1 ] !== ']' ) {\n\t\t\tvar refLength = reference.length;\n\t\t\treference = reference.substr( 0, lastDotIndex );\n\t\t\tparser.pos = startPos + ( actual - ( refLength - lastDotIndex ) );\n\t\t} else {\n\t\t\tparser.pos -= 1;\n\t\t}\n\t}\n\n\treturn {\n\t\tt: REFERENCE,\n\t\tn: reference.replace( /^this\\./, './' ).replace( /^this$/, '.' )\n\t};\n}\n\nfunction readBracketedExpression ( parser ) {\n\tif ( !parser.matchString( '(' ) ) { return null; }\n\n\tparser.allowWhitespace();\n\n\tvar expr = readExpression( parser );\n\n\tif ( !expr ) { parser.error( expectedExpression ); }\n\n\tparser.allowWhitespace();\n\n\tif ( !parser.matchString( ')' ) ) { parser.error( expectedParen ); }\n\n\treturn {\n\t\tt: BRACKETED,\n\t\tx: expr\n\t};\n}\n\nvar readPrimary = function ( parser ) {\n\treturn readLiteral( parser )\n\t\t|| readReference( parser )\n\t\t|| readBracketedExpression( parser );\n};\n\nfunction readRefinement ( parser ) {\n\t// some things call for strict refinement (partial names), meaning no space between reference and refinement\n\tif ( !parser.strictRefinement ) {\n\t\tparser.allowWhitespace();\n\t}\n\n\t// \".\" name\n\tif ( parser.matchString( '.' ) ) {\n\t\tparser.allowWhitespace();\n\n\t\tvar name$$1 = parser.matchPattern( name );\n\t\tif ( name$$1 ) {\n\t\t\treturn {\n\t\t\t\tt: REFINEMENT,\n\t\t\t\tn: name$$1\n\t\t\t};\n\t\t}\n\n\t\tparser.error( 'Expected a property name' );\n\t}\n\n\t// \"[\" expression \"]\"\n\tif ( parser.matchString( '[' ) ) {\n\t\tparser.allowWhitespace();\n\n\t\tvar expr = readExpression( parser );\n\t\tif ( !expr ) { parser.error( expectedExpression ); }\n\n\t\tparser.allowWhitespace();\n\n\t\tif ( !parser.matchString( ']' ) ) { parser.error( \"Expected ']'\" ); }\n\n\t\treturn {\n\t\t\tt: REFINEMENT,\n\t\t\tx: expr\n\t\t};\n\t}\n\n\treturn null;\n}\n\nvar readMemberOrInvocation = function ( parser ) {\n\tvar expression = readPrimary( parser );\n\n\tif ( !expression ) { return null; }\n\n\twhile ( expression ) {\n\t\tvar refinement = readRefinement( parser );\n\t\tif ( refinement ) {\n\t\t\texpression = {\n\t\t\t\tt: MEMBER,\n\t\t\t\tx: expression,\n\t\t\t\tr: refinement\n\t\t\t};\n\t\t}\n\n\t\telse if ( parser.matchString( '(' ) ) {\n\t\t\tparser.allowWhitespace();\n\t\t\tvar expressionList = readExpressionList( parser, true );\n\n\t\t\tparser.allowWhitespace();\n\n\t\t\tif ( !parser.matchString( ')' ) ) {\n\t\t\t\tparser.error( expectedParen );\n\t\t\t}\n\n\t\t\texpression = {\n\t\t\t\tt: INVOCATION,\n\t\t\t\tx: expression\n\t\t\t};\n\n\t\t\tif ( expressionList ) { expression.o = expressionList; }\n\t\t}\n\n\t\telse {\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn expression;\n};\n\nvar readTypeOf;\n\nvar makePrefixSequenceMatcher = function ( symbol, fallthrough ) {\n\treturn function ( parser ) {\n\t\tvar expression;\n\n\t\tif ( expression = fallthrough( parser ) ) {\n\t\t\treturn expression;\n\t\t}\n\n\t\tif ( !parser.matchString( symbol ) ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tparser.allowWhitespace();\n\n\t\texpression = readExpression( parser );\n\t\tif ( !expression ) {\n\t\t\tparser.error( expectedExpression );\n\t\t}\n\n\t\treturn {\n\t\t\ts: symbol,\n\t\t\to: expression,\n\t\t\tt: PREFIX_OPERATOR\n\t\t};\n\t};\n};\n\n// create all prefix sequence matchers, return readTypeOf\n(function() {\n\tvar i, len, matcher, fallthrough;\n\n\tvar prefixOperators = '! ~ + - typeof'.split( ' ' );\n\n\tfallthrough = readMemberOrInvocation;\n\tfor ( i = 0, len = prefixOperators.length; i < len; i += 1 ) {\n\t\tmatcher = makePrefixSequenceMatcher( prefixOperators[i], fallthrough );\n\t\tfallthrough = matcher;\n\t}\n\n\t// typeof operator is higher precedence than multiplication, so provides the\n\t// fallthrough for the multiplication sequence matcher we're about to create\n\t// (we're skipping void and delete)\n\treadTypeOf = fallthrough;\n}());\n\nvar readTypeof = readTypeOf;\n\nvar readLogicalOr;\n\nvar makeInfixSequenceMatcher = function ( symbol, fallthrough ) {\n\treturn function ( parser ) {\n\t\tvar start, left, right;\n\n\t\tleft = fallthrough( parser );\n\t\tif ( !left ) {\n\t\t\treturn null;\n\t\t}\n\n\t\t// Loop to handle left-recursion in a case like `a * b * c` and produce\n\t\t// left association, i.e. `(a * b) * c`.  The matcher can't call itself\n\t\t// to parse `left` because that would be infinite regress.\n\t\twhile ( true ) {\n\t\t\tstart = parser.pos;\n\n\t\t\tparser.allowWhitespace();\n\n\t\t\tif ( !parser.matchString( symbol ) ) {\n\t\t\t\tparser.pos = start;\n\t\t\t\treturn left;\n\t\t\t}\n\n\t\t\t// special case - in operator must not be followed by [a-zA-Z_$0-9]\n\t\t\tif ( symbol === 'in' && /[a-zA-Z_$0-9]/.test( parser.remaining().charAt( 0 ) ) ) {\n\t\t\t\tparser.pos = start;\n\t\t\t\treturn left;\n\t\t\t}\n\n\t\t\tparser.allowWhitespace();\n\n\t\t\t// right operand must also consist of only higher-precedence operators\n\t\t\tright = fallthrough( parser );\n\t\t\tif ( !right ) {\n\t\t\t\tparser.pos = start;\n\t\t\t\treturn left;\n\t\t\t}\n\n\t\t\tleft = {\n\t\t\t\tt: INFIX_OPERATOR,\n\t\t\t\ts: symbol,\n\t\t\t\to: [ left, right ]\n\t\t\t};\n\n\t\t\t// Loop back around.  If we don't see another occurrence of the symbol,\n\t\t\t// we'll return left.\n\t\t}\n\t};\n};\n\n// create all infix sequence matchers, and return readLogicalOr\n(function() {\n\tvar i, len, matcher, fallthrough;\n\n\t// All the infix operators on order of precedence (source: https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Operator_Precedence)\n\t// Each sequence matcher will initially fall through to its higher precedence\n\t// neighbour, and only attempt to match if one of the higher precedence operators\n\t// (or, ultimately, a literal, reference, or bracketed expression) already matched\n\tvar infixOperators = '* / % + - << >> >>> < <= > >= in instanceof == != === !== & ^ | && ||'.split( ' ' );\n\n\t// A typeof operator is higher precedence than multiplication\n\tfallthrough = readTypeof;\n\tfor ( i = 0, len = infixOperators.length; i < len; i += 1 ) {\n\t\tmatcher = makeInfixSequenceMatcher( infixOperators[i], fallthrough );\n\t\tfallthrough = matcher;\n\t}\n\n\t// Logical OR is the fallthrough for the conditional matcher\n\treadLogicalOr = fallthrough;\n}());\n\nvar readLogicalOr$1 = readLogicalOr;\n\n// The conditional operator is the lowest precedence operator, so we start here\nfunction getConditional ( parser ) {\n\tvar expression = readLogicalOr$1( parser );\n\tif ( !expression ) {\n\t\treturn null;\n\t}\n\n\tvar start = parser.pos;\n\n\tparser.allowWhitespace();\n\n\tif ( !parser.matchString( '?' ) ) {\n\t\tparser.pos = start;\n\t\treturn expression;\n\t}\n\n\tparser.allowWhitespace();\n\n\tvar ifTrue = readExpression( parser );\n\tif ( !ifTrue ) {\n\t\tparser.error( expectedExpression );\n\t}\n\n\tparser.allowWhitespace();\n\n\tif ( !parser.matchString( ':' ) ) {\n\t\tparser.error( 'Expected \":\"' );\n\t}\n\n\tparser.allowWhitespace();\n\n\tvar ifFalse = readExpression( parser );\n\tif ( !ifFalse ) {\n\t\tparser.error( expectedExpression );\n\t}\n\n\treturn {\n\t\tt: CONDITIONAL,\n\t\to: [ expression, ifTrue, ifFalse ]\n\t};\n}\n\nfunction readExpression ( parser ) {\n\t// The conditional operator is the lowest precedence operator (except yield,\n\t// assignment operators, and commas, none of which are supported), so we\n\t// start there. If it doesn't match, it 'falls through' to progressively\n\t// higher precedence operators, until it eventually matches (or fails to\n\t// match) a 'primary' - a literal or a reference. This way, the abstract syntax\n\t// tree has everything in its proper place, i.e. 2 + 3 * 4 === 14, not 20.\n\treturn getConditional( parser );\n}\n\nfunction readExpressionList ( parser, spread ) {\n\tvar isSpread;\n\tvar expressions = [];\n\n\tvar pos = parser.pos;\n\n\tdo {\n\t\tparser.allowWhitespace();\n\n\t\tif ( spread ) {\n\t\t\tisSpread = parser.matchPattern( spreadPattern );\n\t\t}\n\n\t\tvar expr = readExpression( parser );\n\n\t\tif ( expr === null && expressions.length ) {\n\t\t\tparser.error( expectedExpression );\n\t\t} else if ( expr === null ) {\n\t\t\tparser.pos = pos;\n\t\t\treturn null;\n\t\t}\n\n\t\tif ( isSpread ) {\n\t\t\texpr.p = true;\n\t\t}\n\n\t\texpressions.push( expr );\n\n\t\tparser.allowWhitespace();\n\t} while ( parser.matchString( ',' ) );\n\n\treturn expressions;\n}\n\nfunction flattenExpression ( expression ) {\n\tvar refs;\n\tvar count = 0;\n\n\textractRefs( expression, refs = [] );\n\tvar stringified = stringify( expression );\n\n\treturn {\n\t\tr: refs,\n\t\ts: getVars(stringified)\n\t};\n\n\tfunction getVars(expr) {\n\t\tvar vars = [];\n\t\tfor ( var i = count - 1; i >= 0; i-- ) {\n\t\t\tvars.push( (\"x$\" + i) );\n\t\t}\n\t\treturn vars.length ? (\"(function(){var \" + (vars.join(',')) + \";return(\" + expr + \");})()\") : expr;\n\t}\n\n\tfunction stringify ( node ) {\n\t\tif ( typeof node === 'string' ) {\n\t\t\treturn node;\n\t\t}\n\n\t\tswitch ( node.t ) {\n\t\t\tcase BOOLEAN_LITERAL:\n\t\t\tcase GLOBAL:\n\t\t\tcase NUMBER_LITERAL:\n\t\t\tcase REGEXP_LITERAL:\n\t\t\t\treturn node.v;\n\n\t\t\tcase STRING_LITERAL:\n\t\t\t\treturn JSON.stringify( String( node.v ) );\n\n\t\t\tcase ARRAY_LITERAL:\n\t\t\t\tif ( node.m && hasSpread( node.m )) {\n\t\t\t\t\treturn (\"[].concat(\" + (makeSpread( node.m, '[', ']', stringify )) + \")\");\n\t\t\t\t} else {\n\t\t\t\t\treturn '[' + ( node.m ? node.m.map( stringify ).join( ',' ) : '' ) + ']';\n\t\t\t\t}\n\n\t\t\tcase OBJECT_LITERAL:\n\t\t\t\tif ( node.m && hasSpread( node.m ) ) {\n\t\t\t\t\treturn (\"Object.assign({},\" + (makeSpread( node.m, '{', '}', stringifyPair)) + \")\");\n\t\t\t\t} else {\n\t\t\t\t\treturn '{' + ( node.m ? node.m.map( function (n) { return ((n.k) + \":\" + (stringify( n.v ))); } ).join( ',' ) : '' ) + '}';\n\t\t\t\t}\n\n\t\t\tcase PREFIX_OPERATOR:\n\t\t\t\treturn ( node.s === 'typeof' ? 'typeof ' : node.s ) + stringify( node.o );\n\n\t\t\tcase INFIX_OPERATOR:\n\t\t\t\treturn stringify( node.o[0] ) + ( node.s.substr( 0, 2 ) === 'in' ? ' ' + node.s + ' ' : node.s ) + stringify( node.o[1] );\n\n\t\t\tcase INVOCATION:\n\t\t\t\tif ( node.o && hasSpread( node.o ) ) {\n\t\t\t\t\tvar id = count++;\n\t\t\t\t\treturn (\"(x$\" + id + \"=\" + (stringify(node.x)) + \").apply(x$\" + id + \",\" + (stringify({ t: ARRAY_LITERAL, m: node.o })) + \")\");\n\t\t\t\t} else {\n\t\t\t\t\treturn stringify( node.x ) + '(' + ( node.o ? node.o.map( stringify ).join( ',' ) : '' ) + ')';\n\t\t\t\t}\n\n\t\t\tcase BRACKETED:\n\t\t\t\treturn '(' + stringify( node.x ) + ')';\n\n\t\t\tcase MEMBER:\n\t\t\t\treturn stringify( node.x ) + stringify( node.r );\n\n\t\t\tcase REFINEMENT:\n\t\t\t\treturn ( node.n ? '.' + node.n : '[' + stringify( node.x ) + ']' );\n\n\t\t\tcase CONDITIONAL:\n\t\t\t\treturn stringify( node.o[0] ) + '?' + stringify( node.o[1] ) + ':' + stringify( node.o[2] );\n\n\t\t\tcase REFERENCE:\n\t\t\t\treturn '_' + refs.indexOf( node.n );\n\n\t\t\tdefault:\n\t\t\t\tthrow new Error( 'Expected legal JavaScript' );\n\t\t}\n\t}\n\n\tfunction stringifyPair ( node ) { return node.p ? stringify( node.k ) : ((node.k) + \":\" + (stringify( node.v ))); }\n\n\tfunction makeSpread ( list, open, close, fn ) {\n\t\tvar out = list.reduce( function ( a, c ) {\n\t\t\tif ( c.p ) {\n\t\t\t\ta.str += \"\" + (a.open ? close + ',' : a.str.length ? ',' : '') + (fn( c ));\n\t\t\t} else {\n\t\t\t\ta.str += \"\" + (!a.str.length ? open : !a.open ? ',' + open : ',') + (fn( c ));\n\t\t\t}\n\t\t\ta.open = !c.p;\n\t\t\treturn a;\n\t\t}, { open: false, str: '' } );\n\t\tif ( out.open ) { out.str += close; }\n\t\treturn out.str;\n\t}\n}\n\nfunction hasSpread ( list ) {\n\tfor ( var i = 0; i < list.length; i++ ) {\n\t\tif ( list[i].p ) { return true; }\n\t}\n\n\treturn false;\n}\n\n// TODO maybe refactor this?\nfunction extractRefs ( node, refs ) {\n\tif ( node.t === REFERENCE && typeof node.n === 'string' ) {\n\t\tif ( !~refs.indexOf( node.n ) ) {\n\t\t\trefs.unshift( node.n );\n\t\t}\n\t}\n\n\tvar list = node.o || node.m;\n\tif ( list ) {\n\t\tif ( isObject( list ) ) {\n\t\t\textractRefs( list, refs );\n\t\t} else {\n\t\t\tvar i = list.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\textractRefs( list[i], refs );\n\t\t\t}\n\t\t}\n\t}\n\n\tif ( node.k && node.t === KEY_VALUE_PAIR && typeof node.k !== 'string' ) {\n\t\textractRefs( node.k, refs );\n\t}\n\n\tif ( node.x ) {\n\t\textractRefs( node.x, refs );\n\t}\n\n\tif ( node.r ) {\n\t\textractRefs( node.r, refs );\n\t}\n\n\tif ( node.v ) {\n\t\textractRefs( node.v, refs );\n\t}\n}\n\nvar attributeNamePattern = /^[^\\s\"'>\\/=]+/;\nvar onPattern = /^on/;\nvar eventPattern = /^on-([a-zA-Z\\*\\.$_]((?:[a-zA-Z\\*\\.$_0-9\\-]|\\\\-)+))$/;\nvar reservedEventNames = /^(?:change|reset|teardown|update|construct|config|init|render|complete|unrender|detach|insert|destruct|attachchild|detachchild)$/;\nvar decoratorPattern = /^as-([a-z-A-Z][-a-zA-Z_0-9]*)$/;\nvar transitionPattern = /^([a-zA-Z](?:(?!-in-out)[-a-zA-Z_0-9])*)-(in|out|in-out)$/;\nvar directives = {\n\tlazy: { t: BINDING_FLAG, v: 'l' },\n\ttwoway: { t: BINDING_FLAG, v: 't' }\n};\nvar unquotedAttributeValueTextPattern = /^[^\\s\"'=<>\\/`]+/;\nvar proxyEvent = /^[^\\s\"'=<>@\\[\\]()]*/;\nvar whitespace = /^\\s+/;\n\nvar slashes = /\\\\/g;\nfunction splitEvent ( str ) {\n\tvar result = [];\n\tvar s = 0;\n\n\tfor ( var i = 0; i < str.length; i++ ) {\n\t\tif ( str[i] === '-' && str[ i - 1 ] !== '\\\\' ) {\n\t\t\tresult.push( str.substring( s, i ).replace( slashes, '' ) );\n\t\t\ts = i + 1;\n\t\t}\n\t}\n\n\tresult.push( str.substring( s ).replace( slashes, '' ) );\n\n\treturn result;\n}\n\nfunction readAttribute ( parser ) {\n\tvar name, i, nearest, idx;\n\n\tparser.allowWhitespace();\n\n\tname = parser.matchPattern( attributeNamePattern );\n\tif ( !name ) {\n\t\treturn null;\n\t}\n\n\t// check for accidental delimiter consumption e.g. <tag bool{{>attrs}} />\n\tnearest = name.length;\n\tfor ( i = 0; i < parser.tags.length; i++ ) {\n\t\tif ( ~( idx = name.indexOf( parser.tags[ i ].open ) ) ) {\n\t\t\tif ( idx < nearest ) { nearest = idx; }\n\t\t}\n\t}\n\tif ( nearest < name.length ) {\n\t\tparser.pos -= name.length - nearest;\n\t\tname = name.substr( 0, nearest );\n\t\treturn { n: name };\n\t}\n\n\treturn { n: name };\n}\n\nfunction readAttributeValue ( parser ) {\n\tvar start = parser.pos;\n\n\t// next character must be `=`, `/`, `>` or whitespace\n\tif ( !/[=\\/>\\s]/.test( parser.nextChar() ) ) {\n\t\tparser.error( 'Expected `=`, `/`, `>` or whitespace' );\n\t}\n\n\tparser.allowWhitespace();\n\n\tif ( !parser.matchString( '=' ) ) {\n\t\tparser.pos = start;\n\t\treturn null;\n\t}\n\n\tparser.allowWhitespace();\n\n\tvar valueStart = parser.pos;\n\tvar startDepth = parser.sectionDepth;\n\n\tvar value = readQuotedAttributeValue( parser, \"'\" ) ||\n\t\t\treadQuotedAttributeValue( parser, \"\\\"\" ) ||\n\t\t\treadUnquotedAttributeValue( parser );\n\n\tif ( value === null ) {\n\t\tparser.error( 'Expected valid attribute value' );\n\t}\n\n\tif ( parser.sectionDepth !== startDepth ) {\n\t\tparser.pos = valueStart;\n\t\tparser.error( 'An attribute value must contain as many opening section tags as closing section tags' );\n\t}\n\n\tif ( !value.length ) {\n\t\treturn '';\n\t}\n\n\tif ( value.length === 1 && typeof value[0] === 'string' ) {\n\t\treturn decodeCharacterReferences( value[0] );\n\t}\n\n\treturn value;\n}\n\nfunction readUnquotedAttributeValueToken ( parser ) {\n\tvar text, index;\n\n\tvar start = parser.pos;\n\n\ttext = parser.matchPattern( unquotedAttributeValueTextPattern );\n\n\tif ( !text ) {\n\t\treturn null;\n\t}\n\n\tvar haystack = text;\n\tvar needles = parser.tags.map( function (t) { return t.open; } ); // TODO refactor... we do this in readText.js as well\n\n\tif ( ( index = getLowestIndex( haystack, needles ) ) !== -1 ) {\n\t\ttext = text.substr( 0, index );\n\t\tparser.pos = start + text.length;\n\t}\n\n\treturn text;\n}\n\nfunction readUnquotedAttributeValue ( parser ) {\n\tparser.inAttribute = true;\n\n\tvar tokens = [];\n\n\tvar token = readMustache( parser ) || readUnquotedAttributeValueToken( parser );\n\twhile ( token ) {\n\t\ttokens.push( token );\n\t\ttoken = readMustache( parser ) || readUnquotedAttributeValueToken( parser );\n\t}\n\n\tif ( !tokens.length ) {\n\t\treturn null;\n\t}\n\n\tparser.inAttribute = false;\n\treturn tokens;\n}\n\nfunction readQuotedAttributeValue ( parser, quoteMark ) {\n\tvar start = parser.pos;\n\n\tif ( !parser.matchString( quoteMark ) ) {\n\t\treturn null;\n\t}\n\n\tparser.inAttribute = quoteMark;\n\n\tvar tokens = [];\n\n\tvar token = readMustache( parser ) || readQuotedStringToken( parser, quoteMark );\n\twhile ( token !== null ) {\n\t\ttokens.push( token );\n\t\ttoken = readMustache( parser ) || readQuotedStringToken( parser, quoteMark );\n\t}\n\n\tif ( !parser.matchString( quoteMark ) ) {\n\t\tparser.pos = start;\n\t\treturn null;\n\t}\n\n\tparser.inAttribute = false;\n\n\treturn tokens;\n}\n\nfunction readQuotedStringToken ( parser, quoteMark ) {\n\tvar haystack = parser.remaining();\n\n\tvar needles = parser.tags.map( function (t) { return t.open; } ); // TODO refactor... we do this in readText.js as well\n\tneedles.push( quoteMark );\n\n\tvar index = getLowestIndex( haystack, needles );\n\n\tif ( index === -1 ) {\n\t\tparser.error( 'Quoted attribute value must have a closing quote' );\n\t}\n\n\tif ( !index ) {\n\t\treturn null;\n\t}\n\n\tparser.pos += index;\n\treturn haystack.substr( 0, index );\n}\n\nfunction readAttributeOrDirective ( parser ) {\n\tvar match, directive;\n\n\tvar attribute = readAttribute( parser, false );\n\n\tif ( !attribute ) { return null; }\n\n\t\t// lazy, twoway\n\tif ( directive = directives[ attribute.n ] ) {\n\t\tattribute.t = directive.t;\n\t\tif ( directive.v ) { attribute.v = directive.v; }\n\t\tdelete attribute.n; // no name necessary\n\t\tparser.allowWhitespace();\n\t\tif ( parser.nextChar() === '=' ) { attribute.f = readAttributeValue( parser ); }\n\t}\n\n\t\t// decorators\n\telse if ( match = decoratorPattern.exec( attribute.n ) ) {\n\t\tattribute.n = match[1];\n\t\tattribute.t = DECORATOR;\n\t\treadArguments( parser, attribute );\n\t}\n\n\t\t// transitions\n\telse if ( match = transitionPattern.exec( attribute.n ) ) {\n\t\tattribute.n = match[1];\n\t\tattribute.t = TRANSITION;\n\t\treadArguments( parser, attribute );\n\t\tattribute.v = match[2] === 'in-out' ? 't0' : match[2] === 'in' ? 't1' : 't2';\n\t}\n\n\t\t// on-click etc\n\telse if ( match = eventPattern.exec( attribute.n ) ) {\n\n\t\tattribute.n = splitEvent( match[1] );\n\t\tattribute.t = EVENT;\n\n\t\t\t// check for a proxy event\n\t\tif ( !readProxyEvent( parser, attribute ) ) {\n\t\t\t\t// otherwise, it's an expression\n\t\t\treadArguments( parser, attribute, true );\n\t\t} else if ( reservedEventNames.test( attribute.f ) ) {\n\t\t\tparser.pos -= attribute.f.length;\n\t\t\tparser.error( 'Cannot use reserved event names (change, reset, teardown, update, construct, config, init, render, unrender, complete, detach, insert, destruct, attachchild, detachchild)' );\n\t\t}\n\t}\n\n\telse {\n\t\tparser.allowWhitespace();\n\t\tvar value = parser.nextChar() === '=' ? readAttributeValue( parser ) : null;\n\t\tattribute.f = value != null ? value : attribute.f;\n\n\t\tif ( parser.sanitizeEventAttributes && onPattern.test( attribute.n ) ) {\n\t\t\treturn { exclude: true };\n\t\t} else {\n\t\t\tattribute.f = attribute.f || ( attribute.f === '' ? '' : 0 );\n\t\t\tattribute.t = ATTRIBUTE;\n\t\t}\n\t}\n\n\treturn attribute;\n}\n\nfunction readProxyEvent ( parser, attribute ) {\n\tvar start = parser.pos;\n\tif ( !parser.matchString( '=' ) ) { parser.error( \"Missing required directive arguments\" ); }\n\n\tvar quote = parser.matchString( \"'\" ) || parser.matchString( \"\\\"\" );\n\tparser.allowWhitespace();\n\tvar proxy = parser.matchPattern( proxyEvent );\n\n\tif ( proxy !== undefined ) {\n\t\tif ( quote ) {\n\t\t\tparser.allowWhitespace();\n\t\t\tif ( !parser.matchString( quote ) ) { parser.pos = start; }\n\t\t\telse { return ( attribute.f = proxy ) || true; }\n\t\t} else if ( !parser.matchPattern( whitespace ) ) {\n\t\t\tparser.pos = start;\n\t\t} else {\n\t\t\treturn ( attribute.f = proxy ) || true;\n\t\t}\n\t} else {\n\t\tparser.pos = start;\n\t}\n}\n\nfunction readArguments ( parser, attribute, required ) {\n\tif ( required === void 0 ) required = false;\n\n\tparser.allowWhitespace();\n\tif ( !parser.matchString( '=' ) ) {\n\t\tif ( required ) { parser.error( \"Missing required directive arguments\" ); }\n\t\treturn;\n\t}\n\tparser.allowWhitespace();\n\n\tvar quote = parser.matchString( '\"' ) || parser.matchString( \"'\" );\n\tvar spread = parser.spreadArgs;\n\tparser.spreadArgs = true;\n\tvar exprs = readExpressionList( parser );\n\tparser.spreadArgs = spread;\n\n\tif ( quote ) {\n\t\tparser.allowWhitespace();\n\t\tif ( parser.matchString( quote ) !== quote ) { parser.error( (\"Expected matching quote '\" + quote + \"'\") ); }\n\t}\n\n\tattribute.f = flattenExpression({ m: exprs, t: 22 });\n}\n\nvar delimiterChangeToken = { t: DELIMCHANGE, exclude: true };\n\nfunction readMustache ( parser ) {\n\tvar mustache, i;\n\n\t// If we're inside a <script> or <style> tag, and we're not\n\t// interpolating, bug out\n\tif ( parser.interpolate[ parser.inside ] === false ) {\n\t\treturn null;\n\t}\n\n\tfor ( i = 0; i < parser.tags.length; i += 1 ) {\n\t\tif ( mustache = readMustacheOfType( parser, parser.tags[i] ) ) {\n\t\t\treturn mustache;\n\t\t}\n\t}\n\n\tif ( parser.inTag && !parser.inAttribute ) {\n\t\tmustache = readAttributeOrDirective( parser );\n\t\tif ( mustache ) {\n\t\t\tparser.allowWhitespace();\n\t\t\treturn mustache;\n\t\t}\n\t}\n}\n\nfunction readMustacheOfType ( parser, tag ) {\n\tvar mustache, reader, i;\n\n\tvar start = parser.pos;\n\n\tif ( parser.matchString( '\\\\' + tag.open ) ) {\n\t\tif ( start === 0 || parser.str[ start - 1 ] !== '\\\\' ) {\n\t\t\treturn tag.open;\n\t\t}\n\t} else if ( !parser.matchString( tag.open ) ) {\n\t\treturn null;\n\t}\n\n\t// delimiter change?\n\tif ( mustache = readDelimiterChange( parser ) ) {\n\t\t// find closing delimiter or abort...\n\t\tif ( !parser.matchString( tag.close ) ) {\n\t\t\treturn null;\n\t\t}\n\n\t\t// ...then make the switch\n\t\ttag.open = mustache[0];\n\t\ttag.close = mustache[1];\n\t\tparser.sortMustacheTags();\n\n\t\treturn delimiterChangeToken;\n\t}\n\n\tparser.allowWhitespace();\n\n\t// illegal section closer\n\tif ( parser.matchString( '/' ) ) {\n\t\tparser.pos -= 1;\n\t\tvar rewind = parser.pos;\n\t\tif ( !readNumberLiteral( parser ) ) {\n\t\t\tparser.pos = rewind - ( tag.close.length );\n\t\t\tif ( parser.inAttribute ) {\n\t\t\t\tparser.pos = start;\n\t\t\t\treturn null;\n\t\t\t} else {\n\t\t\t\tparser.error( 'Attempted to close a section that wasn\\'t open' );\n\t\t\t}\n\t\t} else {\n\t\t\tparser.pos = rewind;\n\t\t}\n\t}\n\n\tfor ( i = 0; i < tag.readers.length; i += 1 ) {\n\t\treader = tag.readers[i];\n\n\t\tif ( mustache = reader( parser, tag ) ) {\n\t\t\tif ( tag.isStatic ) {\n\t\t\t\tmustache.s = true; // TODO make this `1` instead - more compact\n\t\t\t}\n\n\t\t\tif ( parser.includeLinePositions ) {\n\t\t\t\tmustache.p = parser.getLinePos( start );\n\t\t\t}\n\n\t\t\treturn mustache;\n\t\t}\n\t}\n\n\tparser.pos = start;\n\treturn null;\n}\n\nfunction refineExpression ( expression, mustache ) {\n\tvar referenceExpression;\n\n\tif ( expression ) {\n\t\twhile ( expression.t === BRACKETED && expression.x ) {\n\t\t\texpression = expression.x;\n\t\t}\n\n\t\tif ( expression.t === REFERENCE ) {\n\t\t\tmustache.r = expression.n;\n\t\t} else {\n\t\t\tif ( referenceExpression = getReferenceExpression( expression ) ) {\n\t\t\t\tmustache.rx = referenceExpression;\n\t\t\t} else {\n\t\t\t\tmustache.x = flattenExpression( expression );\n\t\t\t}\n\t\t}\n\n\t\treturn mustache;\n\t}\n}\n\n// TODO refactor this! it's bewildering\nfunction getReferenceExpression ( expression ) {\n\tvar members = [];\n\tvar refinement;\n\n\twhile ( expression.t === MEMBER && expression.r.t === REFINEMENT ) {\n\t\trefinement = expression.r;\n\n\t\tif ( refinement.x ) {\n\t\t\tif ( refinement.x.t === REFERENCE ) {\n\t\t\t\tmembers.unshift( refinement.x );\n\t\t\t} else {\n\t\t\t\tmembers.unshift( flattenExpression( refinement.x ) );\n\t\t\t}\n\t\t} else {\n\t\t\tmembers.unshift( refinement.n );\n\t\t}\n\n\t\texpression = expression.x;\n\t}\n\n\tif ( expression.t !== REFERENCE ) {\n\t\treturn null;\n\t}\n\n\treturn {\n\t\tr: expression.n,\n\t\tm: members\n\t};\n}\n\nfunction readTriple ( parser, tag ) {\n\tvar expression = readExpression( parser );\n\n\tif ( !expression ) {\n\t\treturn null;\n\t}\n\n\tif ( !parser.matchString( tag.close ) ) {\n\t\tparser.error( (\"Expected closing delimiter '\" + (tag.close) + \"'\") );\n\t}\n\n\tvar triple = { t: TRIPLE };\n\trefineExpression( expression, triple ); // TODO handle this differently - it's mysterious\n\n\treturn triple;\n}\n\nfunction readUnescaped ( parser, tag ) {\n\tif ( !parser.matchString( '&' ) ) {\n\t\treturn null;\n\t}\n\n\tparser.allowWhitespace();\n\n\tvar expression = readExpression( parser );\n\n\tif ( !expression ) {\n\t\treturn null;\n\t}\n\n\tif ( !parser.matchString( tag.close ) ) {\n\t\tparser.error( (\"Expected closing delimiter '\" + (tag.close) + \"'\") );\n\t}\n\n\tvar triple = { t: TRIPLE };\n\trefineExpression( expression, triple ); // TODO handle this differently - it's mysterious\n\n\treturn triple;\n}\n\nvar legalAlias = /^(?:[a-zA-Z$_0-9]|\\\\\\.)+(?:(?:(?:[a-zA-Z$_0-9]|\\\\\\.)+)|(?:\\[[0-9]+\\]))*/;\nvar asRE = /^as/i;\n\nfunction readAliases( parser ) {\n\tvar aliases = [];\n\tvar alias;\n\tvar start = parser.pos;\n\n\tparser.allowWhitespace();\n\n\talias = readAlias( parser );\n\n\tif ( alias ) {\n\t\talias.x = refineExpression( alias.x, {} );\n\t\taliases.push( alias );\n\n\t\tparser.allowWhitespace();\n\n\t\twhile ( parser.matchString(',') ) {\n\t\t\talias = readAlias( parser );\n\n\t\t\tif ( !alias ) {\n\t\t\t\tparser.error( 'Expected another alias.' );\n\t\t\t}\n\n\t\t\talias.x = refineExpression( alias.x, {} );\n\t\t\taliases.push( alias );\n\n\t\t\tparser.allowWhitespace();\n\t\t}\n\n\t\treturn aliases;\n\t}\n\n\tparser.pos = start;\n\treturn null;\n}\n\nfunction readAlias( parser ) {\n\tvar start = parser.pos;\n\n\tparser.allowWhitespace();\n\n\tvar expr = readExpression( parser, [] );\n\n\tif ( !expr ) {\n\t\tparser.pos = start;\n\t\treturn null;\n\t}\n\n\tparser.allowWhitespace();\n\n\tif ( !parser.matchPattern( asRE ) ) {\n\t\tparser.pos = start;\n\t\treturn null;\n\t}\n\n\tparser.allowWhitespace();\n\n\tvar alias = parser.matchPattern( legalAlias );\n\n\tif ( !alias ) {\n\t\tparser.error( 'Expected a legal alias name.' );\n\t}\n\n\treturn { n: alias, x: expr };\n}\n\nfunction readPartial ( parser, tag ) {\n\tvar type = parser.matchString( '>' ) || parser.matchString( 'yield' );\n\tvar partial = { t: type === '>' ? PARTIAL : YIELDER };\n\tvar aliases;\n\n\tif ( !type ) { return null; }\n\n\tparser.allowWhitespace();\n\n\tif ( type === '>' || !( aliases = parser.matchString( 'with' ) ) ) {\n\t\t// Partial names can include hyphens, so we can't use readExpression\n\t\t// blindly. Instead, we use the `relaxedNames` flag to indicate that\n\t\t// `foo-bar` should be read as a single name, rather than 'subtract\n\t\t// bar from foo'\n\t\tparser.relaxedNames = parser.strictRefinement = true;\n\t\tvar expression = readExpression( parser );\n\t\tparser.relaxedNames = parser.strictRefinement = false;\n\n\t\tif ( !expression && type === '>' ) { return null; }\n\n\t\tif ( expression ) {\n\t\t\trefineExpression( expression, partial ); // TODO...\n\t\t\tparser.allowWhitespace();\n\t\t\tif ( type !== '>' ) { aliases = parser.matchString( 'with' ); }\n\t\t}\n\t}\n\n\tparser.allowWhitespace();\n\n\t// check for alias context e.g. `{{>foo bar as bat, bip as bop}}`\n\tif ( aliases || type === '>' ) {\n\t\taliases = readAliases( parser );\n\t\tif ( aliases && aliases.length ) {\n\t\t\tpartial.z = aliases;\n\t\t}\n\n\t\t// otherwise check for literal context e.g. `{{>foo bar}}` then\n\t\t// turn it into `{{#with bar}}{{>foo}}{{/with}}`\n\t\telse if ( type === '>' ) {\n\t\t\tvar context = readExpression( parser );\n\t\t\tif ( context) {\n\t\t\t\tpartial.c = {};\n\t\t\t\trefineExpression( context, partial.c );\n\t\t\t}\n\t\t}\n\n\t\telse {\n\t\t\t// {{yield with}} requires some aliases\n\t\t\tparser.error( \"Expected one or more aliases\" );\n\t\t}\n\t}\n\n\tparser.allowWhitespace();\n\n\tif ( !parser.matchString( tag.close ) ) {\n\t\tparser.error( (\"Expected closing delimiter '\" + (tag.close) + \"'\") );\n\t}\n\n\treturn partial;\n}\n\nfunction readComment ( parser, tag ) {\n\tif ( !parser.matchString( '!' ) ) {\n\t\treturn null;\n\t}\n\n\tvar index = parser.remaining().indexOf( tag.close );\n\n\tif ( index !== -1 ) {\n\t\tparser.pos += index + tag.close.length;\n\t\treturn { t: COMMENT };\n\t}\n}\n\nfunction readExpressionOrReference ( parser, expectedFollowers ) {\n\tvar start = parser.pos;\n\tvar expression = readExpression( parser );\n\n\tif ( !expression ) {\n\t\t// valid reference but invalid expression e.g. `{{new}}`?\n\t\tvar ref = parser.matchPattern( /^(\\w+)/ );\n\t\tif ( ref ) {\n\t\t\treturn {\n\t\t\t\tt: REFERENCE,\n\t\t\t\tn: ref\n\t\t\t};\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tfor ( var i = 0; i < expectedFollowers.length; i += 1 ) {\n\t\tif ( parser.remaining().substr( 0, expectedFollowers[i].length ) === expectedFollowers[i] ) {\n\t\t\treturn expression;\n\t\t}\n\t}\n\n\tparser.pos = start;\n\treturn readReference( parser );\n}\n\nfunction readInterpolator ( parser, tag ) {\n\tvar expression, err;\n\n\tvar start = parser.pos;\n\n\t// TODO would be good for perf if we could do away with the try-catch\n\ttry {\n\t\texpression = readExpressionOrReference( parser, [ tag.close ] );\n\t} catch ( e ) {\n\t\terr = e;\n\t}\n\n\tif ( !expression ) {\n\t\tif ( parser.str.charAt( start ) === '!' ) {\n\t\t\t// special case - comment\n\t\t\tparser.pos = start;\n\t\t\treturn null;\n\t\t}\n\n\t\tif ( err ) {\n\t\t\tthrow err;\n\t\t}\n\t}\n\n\tif ( !parser.matchString( tag.close ) ) {\n\t\tparser.error( (\"Expected closing delimiter '\" + (tag.close) + \"' after reference\") );\n\n\t\tif ( !expression ) {\n\t\t\t// special case - comment\n\t\t\tif ( parser.nextChar() === '!' ) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tparser.error( \"Expected expression or legal reference\" );\n\t\t}\n\t}\n\n\tvar interpolator = { t: INTERPOLATOR };\n\trefineExpression( expression, interpolator ); // TODO handle this differently - it's mysterious\n\n\treturn interpolator;\n}\n\nfunction readClosing ( parser, tag ) {\n\tvar start = parser.pos;\n\n\tif ( !parser.matchString( tag.open ) ) {\n\t\treturn null;\n\t}\n\n\tparser.allowWhitespace();\n\n\tif ( !parser.matchString( '/' ) ) {\n\t\tparser.pos = start;\n\t\treturn null;\n\t}\n\n\tparser.allowWhitespace();\n\n\tvar remaining = parser.remaining();\n\tvar index = remaining.indexOf( tag.close );\n\n\tif ( index !== -1 ) {\n\t\tvar closing = {\n\t\t\tt: CLOSING,\n\t\t\tr: remaining.substr( 0, index ).split( ' ' )[0]\n\t\t};\n\n\t\tparser.pos += index;\n\n\t\tif ( !parser.matchString( tag.close ) ) {\n\t\t\tparser.error( (\"Expected closing delimiter '\" + (tag.close) + \"'\") );\n\t\t}\n\n\t\treturn closing;\n\t}\n\n\tparser.pos = start;\n\treturn null;\n}\n\nvar elsePattern = /^\\s*else\\s*/;\n\nfunction readElse ( parser, tag ) {\n\tvar start = parser.pos;\n\n\tif ( !parser.matchString( tag.open ) ) {\n\t\treturn null;\n\t}\n\n\tif ( !parser.matchPattern( elsePattern ) ) {\n\t\tparser.pos = start;\n\t\treturn null;\n\t}\n\n\tif ( !parser.matchString( tag.close ) ) {\n\t\tparser.error( (\"Expected closing delimiter '\" + (tag.close) + \"'\") );\n\t}\n\n\treturn {\n\t\tt: ELSE\n\t};\n}\n\nvar elsePattern$1 = /^\\s*elseif\\s+/;\n\nfunction readElseIf ( parser, tag ) {\n\tvar start = parser.pos;\n\n\tif ( !parser.matchString( tag.open ) ) {\n\t\treturn null;\n\t}\n\n\tif ( !parser.matchPattern( elsePattern$1 ) ) {\n\t\tparser.pos = start;\n\t\treturn null;\n\t}\n\n\tvar expression = readExpression( parser );\n\n\tif ( !parser.matchString( tag.close ) ) {\n\t\tparser.error( (\"Expected closing delimiter '\" + (tag.close) + \"'\") );\n\t}\n\n\treturn {\n\t\tt: ELSEIF,\n\t\tx: expression\n\t};\n}\n\nvar handlebarsBlockCodes = {\n\teach:    SECTION_EACH,\n\tif:      SECTION_IF,\n\twith:    SECTION_IF_WITH,\n\tunless:  SECTION_UNLESS\n};\n\nvar indexRefPattern = /^\\s*:\\s*([a-zA-Z_$][a-zA-Z_$0-9]*)/;\nvar keyIndexRefPattern = /^\\s*,\\s*([a-zA-Z_$][a-zA-Z_$0-9]*)/;\nvar handlebarsBlockPattern = new RegExp( '^(' + Object.keys( handlebarsBlockCodes ).join( '|' ) + ')\\\\b' );\n\nfunction readSection ( parser, tag ) {\n\tvar expression, section, child, children, hasElse, block, unlessBlock, closed, i, expectedClose;\n\tvar aliasOnly = false;\n\n\tvar start = parser.pos;\n\n\tif ( parser.matchString( '^' ) ) {\n\t\t// watch out for parent context refs - {{^^/^^/foo}}\n\t\tif ( parser.matchString( '^/' ) ){\n\t\t\tparser.pos = start;\n\t\t\treturn null;\n\t\t}\n\t\tsection = { t: SECTION, f: [], n: SECTION_UNLESS };\n\t} else if ( parser.matchString( '#' ) ) {\n\t\tsection = { t: SECTION, f: [] };\n\n\t\tif ( parser.matchString( 'partial' ) ) {\n\t\t\tparser.pos = start - parser.standardDelimiters[0].length;\n\t\t\tparser.error( 'Partial definitions can only be at the top level of the template, or immediately inside components' );\n\t\t}\n\n\t\tif ( block = parser.matchPattern( handlebarsBlockPattern ) ) {\n\t\t\texpectedClose = block;\n\t\t\tsection.n = handlebarsBlockCodes[ block ];\n\t\t}\n\t} else {\n\t\treturn null;\n\t}\n\n\tparser.allowWhitespace();\n\n\tif ( block === 'with' ) {\n\t\tvar aliases = readAliases( parser );\n\t\tif ( aliases ) {\n\t\t\taliasOnly = true;\n\t\t\tsection.z = aliases;\n\t\t\tsection.t = ALIAS;\n\t\t}\n\t} else if ( block === 'each' ) {\n\t\tvar alias = readAlias( parser );\n\t\tif ( alias ) {\n\t\t\tsection.z = [ { n: alias.n, x: { r: '.' } } ];\n\t\t\texpression = alias.x;\n\t\t}\n\t}\n\n\tif ( !aliasOnly ) {\n\t\tif ( !expression ) { expression = readExpression( parser ); }\n\n\t\tif ( !expression ) {\n\t\t\tparser.error( 'Expected expression' );\n\t\t}\n\n\t\t// optional index and key references\n\t\tif ( i = parser.matchPattern( indexRefPattern ) ) {\n\t\t\tvar extra;\n\n\t\t\tif ( extra = parser.matchPattern( keyIndexRefPattern ) ) {\n\t\t\t\tsection.i = i + ',' + extra;\n\t\t\t} else {\n\t\t\t\tsection.i = i;\n\t\t\t}\n\t\t}\n\t}\n\n\tparser.allowWhitespace();\n\n\tif ( !parser.matchString( tag.close ) ) {\n\t\tparser.error( (\"Expected closing delimiter '\" + (tag.close) + \"'\") );\n\t}\n\n\tparser.sectionDepth += 1;\n\tchildren = section.f;\n\n\tvar pos;\n\tdo {\n\t\tpos = parser.pos;\n\t\tif ( child = readClosing( parser, tag ) ) {\n\t\t\tif ( expectedClose && child.r !== expectedClose ) {\n\t\t\t\tparser.pos = pos;\n\t\t\t\tparser.error( (\"Expected \" + (tag.open) + \"/\" + expectedClose + (tag.close)) );\n\t\t\t}\n\n\t\t\tparser.sectionDepth -= 1;\n\t\t\tclosed = true;\n\t\t}\n\n\t\telse if ( !aliasOnly && ( child = readElseIf( parser, tag ) ) ) {\n\t\t\tif ( section.n === SECTION_UNLESS ) {\n\t\t\t\tparser.error( '{{else}} not allowed in {{#unless}}' );\n\t\t\t}\n\n\t\t\tif ( hasElse ) {\n\t\t\t\tparser.error( 'illegal {{elseif...}} after {{else}}' );\n\t\t\t}\n\n\t\t\tif ( !unlessBlock ) {\n\t\t\t\tunlessBlock = [];\n\t\t\t}\n\n\t\t\tvar mustache = {\n\t\t\t\tt: SECTION,\n\t\t\t\tn: SECTION_IF,\n\t\t\t\tf: children = []\n\t\t\t};\n\t\t\trefineExpression( child.x, mustache );\n\n\t\t\tunlessBlock.push( mustache );\n\t\t}\n\n\t\telse if ( !aliasOnly && ( child = readElse( parser, tag ) ) ) {\n\t\t\tif ( section.n === SECTION_UNLESS ) {\n\t\t\t\tparser.error( '{{else}} not allowed in {{#unless}}' );\n\t\t\t}\n\n\t\t\tif ( hasElse ) {\n\t\t\t\tparser.error( 'there can only be one {{else}} block, at the end of a section' );\n\t\t\t}\n\n\t\t\thasElse = true;\n\n\t\t\t// use an unless block if there's no elseif\n\t\t\tif ( !unlessBlock ) {\n\t\t\t\tunlessBlock = [];\n\t\t\t}\n\n\t\t\tunlessBlock.push({\n\t\t\t\tt: SECTION,\n\t\t\t\tn: SECTION_UNLESS,\n\t\t\t\tf: children = []\n\t\t\t});\n\t\t}\n\n\t\telse {\n\t\t\tchild = parser.read( READERS );\n\n\t\t\tif ( !child ) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tchildren.push( child );\n\t\t}\n\t} while ( !closed );\n\n\tif ( unlessBlock ) {\n\t\tsection.l = unlessBlock;\n\t}\n\n\tif ( !aliasOnly ) {\n\t\trefineExpression( expression, section );\n\t}\n\n\t// TODO if a section is empty it should be discarded. Don't do\n\t// that here though - we need to clean everything up first, as\n\t// it may contain removeable whitespace. As a temporary measure,\n\t// to pass the existing tests, remove empty `f` arrays\n\tif ( !section.f.length ) {\n\t\tdelete section.f;\n\t}\n\n\treturn section;\n}\n\nvar OPEN_COMMENT = '<!--';\nvar CLOSE_COMMENT = '-->';\n\nfunction readHtmlComment ( parser ) {\n\tvar start = parser.pos;\n\n\tif ( parser.textOnlyMode || !parser.matchString( OPEN_COMMENT ) ) {\n\t\treturn null;\n\t}\n\n\tvar remaining = parser.remaining();\n\tvar endIndex = remaining.indexOf( CLOSE_COMMENT );\n\n\tif ( endIndex === -1 ) {\n\t\tparser.error( 'Illegal HTML - expected closing comment sequence (\\'-->\\')' );\n\t}\n\n\tvar content = remaining.substr( 0, endIndex );\n\tparser.pos += endIndex + 3;\n\n\tvar comment = {\n\t\tt: COMMENT,\n\t\tc: content\n\t};\n\n\tif ( parser.includeLinePositions ) {\n\t\tcomment.p = parser.getLinePos( start );\n\t}\n\n\treturn comment;\n}\n\nvar leadingLinebreak = /^[ \\t\\f\\r\\n]*\\r?\\n/;\nvar trailingLinebreak = /\\r?\\n[ \\t\\f\\r\\n]*$/;\n\nvar stripStandalones = function ( items ) {\n\tvar i, current, backOne, backTwo, lastSectionItem;\n\n\tfor ( i=1; i<items.length; i+=1 ) {\n\t\tcurrent = items[i];\n\t\tbackOne = items[i-1];\n\t\tbackTwo = items[i-2];\n\n\t\t// if we're at the end of a [text][comment][text] sequence...\n\t\tif ( isString( current ) && isComment( backOne ) && isString( backTwo ) ) {\n\n\t\t\t// ... and the comment is a standalone (i.e. line breaks either side)...\n\t\t\tif ( trailingLinebreak.test( backTwo ) && leadingLinebreak.test( current ) ) {\n\n\t\t\t\t// ... then we want to remove the whitespace after the first line break\n\t\t\t\titems[i-2] = backTwo.replace( trailingLinebreak, '\\n' );\n\n\t\t\t\t// and the leading line break of the second text token\n\t\t\t\titems[i] = current.replace( leadingLinebreak, '' );\n\t\t\t}\n\t\t}\n\n\t\t// if the current item is a section, and it is preceded by a linebreak, and\n\t\t// its first item is a linebreak...\n\t\tif ( isSection( current ) && isString( backOne ) ) {\n\t\t\tif ( trailingLinebreak.test( backOne ) && isString( current.f[0] ) && leadingLinebreak.test( current.f[0] ) ) {\n\t\t\t\titems[i-1] = backOne.replace( trailingLinebreak, '\\n' );\n\t\t\t\tcurrent.f[0] = current.f[0].replace( leadingLinebreak, '' );\n\t\t\t}\n\t\t}\n\n\t\t// if the last item was a section, and it is followed by a linebreak, and\n\t\t// its last item is a linebreak...\n\t\tif ( isString( current ) && isSection( backOne ) ) {\n\t\t\tlastSectionItem = lastItem( backOne.f );\n\n\t\t\tif ( isString( lastSectionItem ) && trailingLinebreak.test( lastSectionItem ) && leadingLinebreak.test( current ) ) {\n\t\t\t\tbackOne.f[ backOne.f.length - 1 ] = lastSectionItem.replace( trailingLinebreak, '\\n' );\n\t\t\t\titems[i] = current.replace( leadingLinebreak, '' );\n\t\t\t}\n\t\t}\n\t}\n\n\treturn items;\n};\n\nfunction isString ( item ) {\n\treturn typeof item === 'string';\n}\n\nfunction isComment ( item ) {\n\treturn item.t === COMMENT || item.t === DELIMCHANGE;\n}\n\nfunction isSection ( item ) {\n\treturn ( item.t === SECTION || item.t === INVERTED ) && item.f;\n}\n\nvar trimWhitespace = function ( items, leadingPattern, trailingPattern ) {\n\tvar item;\n\n\tif ( leadingPattern ) {\n\t\titem = items[0];\n\t\tif ( typeof item === 'string' ) {\n\t\t\titem = item.replace( leadingPattern, '' );\n\n\t\t\tif ( !item ) {\n\t\t\t\titems.shift();\n\t\t\t} else {\n\t\t\t\titems[0] = item;\n\t\t\t}\n\t\t}\n\t}\n\n\tif ( trailingPattern ) {\n\t\titem = lastItem( items );\n\t\tif ( typeof item === 'string' ) {\n\t\t\titem = item.replace( trailingPattern, '' );\n\n\t\t\tif ( !item ) {\n\t\t\t\titems.pop();\n\t\t\t} else {\n\t\t\t\titems[ items.length - 1 ] = item;\n\t\t\t}\n\t\t}\n\t}\n};\n\nvar contiguousWhitespace = /[ \\t\\f\\r\\n]+/g;\nvar preserveWhitespaceElements = /^(?:pre|script|style|textarea)$/i;\nvar leadingWhitespace$1 = /^[ \\t\\f\\r\\n]+/;\nvar trailingWhitespace = /[ \\t\\f\\r\\n]+$/;\nvar leadingNewLine = /^(?:\\r\\n|\\r|\\n)/;\nvar trailingNewLine = /(?:\\r\\n|\\r|\\n)$/;\n\nfunction cleanup ( items, stripComments, preserveWhitespace, removeLeadingWhitespace, removeTrailingWhitespace ) {\n\tif ( typeof items === 'string' ) { return; }\n\n\tvar i,\n\t\titem,\n\t\tpreviousItem,\n\t\tnextItem,\n\t\tpreserveWhitespaceInsideFragment,\n\t\tremoveLeadingWhitespaceInsideFragment,\n\t\tremoveTrailingWhitespaceInsideFragment,\n\t\tkey;\n\n\t// First pass - remove standalones and comments etc\n\tstripStandalones( items );\n\n\ti = items.length;\n\twhile ( i-- ) {\n\t\titem = items[i];\n\n\t\t// Remove delimiter changes, unsafe elements etc\n\t\tif ( item.exclude ) {\n\t\t\titems.splice( i, 1 );\n\t\t}\n\n\t\t// Remove comments, unless we want to keep them\n\t\telse if ( stripComments && item.t === COMMENT ) {\n\t\t\titems.splice( i, 1 );\n\t\t}\n\t}\n\n\t// If necessary, remove leading and trailing whitespace\n\ttrimWhitespace( items, removeLeadingWhitespace ? leadingWhitespace$1 : null, removeTrailingWhitespace ? trailingWhitespace : null );\n\n\ti = items.length;\n\twhile ( i-- ) {\n\t\titem = items[i];\n\n\t\t// Recurse\n\t\tif ( item.f ) {\n\t\t\tvar isPreserveWhitespaceElement = item.t === ELEMENT && preserveWhitespaceElements.test( item.e );\n\t\t\tpreserveWhitespaceInsideFragment = preserveWhitespace || isPreserveWhitespaceElement;\n\n\t\t\tif ( !preserveWhitespace && isPreserveWhitespaceElement ) {\n\t\t\t\ttrimWhitespace( item.f, leadingNewLine, trailingNewLine );\n\t\t\t}\n\n\t\t\tif ( !preserveWhitespaceInsideFragment ) {\n\t\t\t\tpreviousItem = items[ i - 1 ];\n\t\t\t\tnextItem = items[ i + 1 ];\n\n\t\t\t\t// if the previous item was a text item with trailing whitespace,\n\t\t\t\t// remove leading whitespace inside the fragment\n\t\t\t\tif ( !previousItem || ( typeof previousItem === 'string' && trailingWhitespace.test( previousItem ) ) ) {\n\t\t\t\t\tremoveLeadingWhitespaceInsideFragment = true;\n\t\t\t\t}\n\n\t\t\t\t// and vice versa\n\t\t\t\tif ( !nextItem || ( typeof nextItem === 'string' && leadingWhitespace$1.test( nextItem ) ) ) {\n\t\t\t\t\tremoveTrailingWhitespaceInsideFragment = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcleanup( item.f, stripComments, preserveWhitespaceInsideFragment, removeLeadingWhitespaceInsideFragment, removeTrailingWhitespaceInsideFragment );\n\n\t\t\t// clean up name templates (events, decorators, etc)\n\t\t\tif ( isArray( item.f.n ) ) {\n\t\t\t\tcleanup( item.f.n, stripComments, preserveWhitespace, removeLeadingWhitespaceInsideFragment, removeTrailingWhitespace );\n\t\t\t}\n\n\t\t\t// clean up arg templates (events, decorators, etc)\n\t\t\tif ( isArray( item.f.d ) ) {\n\t\t\t\tcleanup( item.f.d, stripComments, preserveWhitespace, removeLeadingWhitespaceInsideFragment, removeTrailingWhitespace );\n\t\t\t}\n\t\t}\n\n\t\t// Split if-else blocks into two (an if, and an unless)\n\t\tif ( item.l ) {\n\t\t\tcleanup( item.l, stripComments, preserveWhitespace, removeLeadingWhitespaceInsideFragment, removeTrailingWhitespaceInsideFragment );\n\n\t\t\titem.l.forEach( function (s) { return s.l = 1; } );\n\t\t\titem.l.unshift( i + 1, 0 );\n\t\t\titems.splice.apply( items, item.l );\n\t\t\tdelete item.l; // TODO would be nice if there was a way around this\n\t\t}\n\n\t\t// Clean up element attributes\n\t\tif ( item.a ) {\n\t\t\tfor ( key in item.a ) {\n\t\t\t\tif ( item.a.hasOwnProperty( key ) && typeof item.a[ key ] !== 'string' ) {\n\t\t\t\t\tcleanup( item.a[ key ], stripComments, preserveWhitespace, removeLeadingWhitespaceInsideFragment, removeTrailingWhitespaceInsideFragment );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// Clean up conditional attributes\n\t\tif ( item.m ) {\n\t\t\tcleanup( item.m, stripComments, preserveWhitespace, removeLeadingWhitespaceInsideFragment, removeTrailingWhitespaceInsideFragment );\n\t\t\tif ( item.m.length < 1 ) { delete item.m; }\n\t\t}\n\t}\n\n\t// final pass - fuse text nodes together\n\ti = items.length;\n\twhile ( i-- ) {\n\t\tif ( typeof items[i] === 'string' ) {\n\t\t\tif ( typeof items[i+1] === 'string' ) {\n\t\t\t\titems[i] = items[i] + items[i+1];\n\t\t\t\titems.splice( i + 1, 1 );\n\t\t\t}\n\n\t\t\tif ( !preserveWhitespace ) {\n\t\t\t\titems[i] = items[i].replace( contiguousWhitespace, ' ' );\n\t\t\t}\n\n\t\t\tif ( items[i] === '' ) {\n\t\t\t\titems.splice( i, 1 );\n\t\t\t}\n\t\t}\n\t}\n}\n\nvar closingTagPattern = /^([a-zA-Z]{1,}:?[a-zA-Z0-9\\-]*)\\s*\\>/;\n\nfunction readClosingTag ( parser ) {\n\tvar tag;\n\n\tvar start = parser.pos;\n\n\t// are we looking at a closing tag?\n\tif ( !parser.matchString( '</' ) ) {\n\t\treturn null;\n\t}\n\n\tif ( tag = parser.matchPattern( closingTagPattern ) ) {\n\t\tif ( parser.inside && tag !== parser.inside ) {\n\t\t\tparser.pos = start;\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\tt: CLOSING_TAG,\n\t\t\te: tag\n\t\t};\n\t}\n\n\t// We have an illegal closing tag, report it\n\tparser.pos -= 2;\n\tparser.error( 'Illegal closing tag' );\n}\n\nvar tagNamePattern = /^[a-zA-Z]{1,}:?[a-zA-Z0-9\\-]*/;\nvar validTagNameFollower = /^[\\s\\n\\/>]/;\nvar exclude = { exclude: true };\n\n// based on http://developers.whatwg.org/syntax.html#syntax-tag-omission\nvar disallowedContents = {\n\tli: [ 'li' ],\n\tdt: [ 'dt', 'dd' ],\n\tdd: [ 'dt', 'dd' ],\n\tp: 'address article aside blockquote div dl fieldset footer form h1 h2 h3 h4 h5 h6 header hgroup hr main menu nav ol p pre section table ul'.split( ' ' ),\n\trt: [ 'rt', 'rp' ],\n\trp: [ 'rt', 'rp' ],\n\toptgroup: [ 'optgroup' ],\n\toption: [ 'option', 'optgroup' ],\n\tthead: [ 'tbody', 'tfoot' ],\n\ttbody: [ 'tbody', 'tfoot' ],\n\ttfoot: [ 'tbody' ],\n\ttr: [ 'tr', 'tbody' ],\n\ttd: [ 'td', 'th', 'tr' ],\n\tth: [ 'td', 'th', 'tr' ]\n};\n\nfunction readElement$1 ( parser ) {\n\tvar attribute, selfClosing, children, partials, hasPartials, child, closed, pos, remaining, closingTag, anchor;\n\n\tvar start = parser.pos;\n\n\tif ( parser.inside || parser.inAttribute || parser.textOnlyMode ) {\n\t\treturn null;\n\t}\n\n\tif ( !parser.matchString( '<' ) ) {\n\t\treturn null;\n\t}\n\n\t// if this is a closing tag, abort straight away\n\tif ( parser.nextChar() === '/' ) {\n\t\treturn null;\n\t}\n\n\tvar element = {};\n\tif ( parser.includeLinePositions ) {\n\t\telement.p = parser.getLinePos( start );\n\t}\n\n\t// check for doctype decl\n\tif ( parser.matchString( '!' ) ) {\n\t\telement.t = DOCTYPE;\n\t\tif ( !parser.matchPattern( /^doctype/i ) ) {\n\t\t\tparser.error( 'Expected DOCTYPE declaration' );\n\t\t}\n\n\t\telement.a = parser.matchPattern( /^(.+?)>/ );\n\t\treturn element;\n\t}\n\t// check for anchor\n\telse if ( anchor = parser.matchString( '#' ) ) {\n\t\tparser.allowWhitespace();\n\t\telement.t = ANCHOR;\n\t\telement.n = parser.matchPattern( relaxedName );\n\t}\n\t// otherwise, it's an element/component\n\telse {\n\t\telement.t = ELEMENT;\n\n\t\t// element name\n\t\telement.e = parser.matchPattern( tagNamePattern );\n\t\tif ( !element.e ) {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\t// next character must be whitespace, closing solidus or '>'\n\tif ( !validTagNameFollower.test( parser.nextChar() ) ) {\n\t\tparser.error( 'Illegal tag name' );\n\t}\n\n\tparser.allowWhitespace();\n\n\tparser.inTag = true;\n\n\t// directives and attributes\n\twhile ( attribute = readMustache( parser ) ) {\n\t\tif ( attribute !== false ) {\n\t\t\tif ( !element.m ) { element.m = []; }\n\t\t\telement.m.push( attribute );\n\t\t}\n\n\t\tparser.allowWhitespace();\n\t}\n\n\tparser.inTag = false;\n\n\t// allow whitespace before closing solidus\n\tparser.allowWhitespace();\n\n\t// self-closing solidus?\n\tif ( parser.matchString( '/' ) ) {\n\t\tselfClosing = true;\n\t}\n\n\t// closing angle bracket\n\tif ( !parser.matchString( '>' ) ) {\n\t\treturn null;\n\t}\n\n\tvar lowerCaseName = ( element.e || element.n ).toLowerCase();\n\tvar preserveWhitespace = parser.preserveWhitespace;\n\n\tif ( !selfClosing && ( anchor || !voidElementNames.test( element.e ) ) ) {\n\t\tif ( !anchor ) {\n\t\t\tparser.elementStack.push( lowerCaseName );\n\n\t\t\t// Special case - if we open a script element, further tags should\n\t\t\t// be ignored unless they're a closing script element\n\t\t\tif ( lowerCaseName === 'script' || lowerCaseName === 'style' || lowerCaseName === 'textarea' ) {\n\t\t\t\tparser.inside = lowerCaseName;\n\t\t\t}\n\t\t}\n\n\t\tchildren = [];\n\t\tpartials = create( null );\n\n\t\tdo {\n\t\t\tpos = parser.pos;\n\t\t\tremaining = parser.remaining();\n\n\t\t\tif ( !remaining ) {\n\t\t\t\tparser.error( (\"Missing end \" + (parser.elementStack.length > 1 ? 'tags' : 'tag') + \" (\" + (parser.elementStack.reverse().map( function (x) { return (\"</\" + x + \">\"); } ).join( '' )) + \")\") );\n\t\t\t}\n\n\t\t\t// if for example we're in an <li> element, and we see another\n\t\t\t// <li> tag, close the first so they become siblings\n\t\t\tif ( !anchor && !canContain( lowerCaseName, remaining ) ) {\n\t\t\t\tclosed = true;\n\t\t\t}\n\n\t\t\t// closing tag\n\t\t\telse if ( !anchor && ( closingTag = readClosingTag( parser ) ) ) {\n\t\t\t\tclosed = true;\n\n\t\t\t\tvar closingTagName = closingTag.e.toLowerCase();\n\n\t\t\t\t// if this *isn't* the closing tag for the current element...\n\t\t\t\tif ( closingTagName !== lowerCaseName ) {\n\t\t\t\t\t// rewind parser\n\t\t\t\t\tparser.pos = pos;\n\n\t\t\t\t\t// if it doesn't close a parent tag, error\n\t\t\t\t\tif ( !~parser.elementStack.indexOf( closingTagName ) ) {\n\t\t\t\t\t\tvar errorMessage = 'Unexpected closing tag';\n\n\t\t\t\t\t\t// add additional help for void elements, since component names\n\t\t\t\t\t\t// might clash with them\n\t\t\t\t\t\tif ( voidElementNames.test( closingTagName ) ) {\n\t\t\t\t\t\t\terrorMessage += \" (<\" + closingTagName + \"> is a void element - it cannot contain children)\";\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tparser.error( errorMessage );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\telse if ( anchor && readAnchorClose( parser, element.n ) ) {\n\t\t\t\tclosed = true;\n\t\t\t}\n\n\t\t\t// implicit close by closing section tag. TODO clean this up\n\t\t\telse if ( child = readClosing( parser, { open: parser.standardDelimiters[0], close: parser.standardDelimiters[1] } ) ) {\n\t\t\t\tclosed = true;\n\t\t\t\tparser.pos = pos;\n\t\t\t}\n\n\t\t\telse {\n\t\t\t\tif ( child = parser.read( PARTIAL_READERS ) ) {\n\t\t\t\t\tif ( partials[ child.n ] ) {\n\t\t\t\t\t\tparser.pos = pos;\n\t\t\t\t\t\tparser.error( 'Duplicate partial definition' );\n\t\t\t\t\t}\n\n\t\t\t\t\tcleanup( child.f, parser.stripComments, preserveWhitespace, !preserveWhitespace, !preserveWhitespace );\n\n\t\t\t\t\tpartials[ child.n ] = child.f;\n\t\t\t\t\thasPartials = true;\n\t\t\t\t}\n\n\t\t\t\telse {\n\t\t\t\t\tif ( child = parser.read( READERS ) ) {\n\t\t\t\t\t\tchildren.push( child );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tclosed = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} while ( !closed );\n\n\t\tif ( children.length ) {\n\t\t\telement.f = children;\n\t\t}\n\n\t\tif ( hasPartials ) {\n\t\t\telement.p = partials;\n\t\t}\n\n\t\tparser.elementStack.pop();\n\t}\n\n\tparser.inside = null;\n\n\tif ( parser.sanitizeElements && parser.sanitizeElements.indexOf( lowerCaseName ) !== -1 ) {\n\t\treturn exclude;\n\t}\n\n\treturn element;\n}\n\nfunction canContain ( name$$1, remaining ) {\n\tvar match = /^<([a-zA-Z][a-zA-Z0-9]*)/.exec( remaining );\n\tvar disallowed = disallowedContents[ name$$1 ];\n\n\tif ( !match || !disallowed ) {\n\t\treturn true;\n\t}\n\n\treturn !~disallowed.indexOf( match[1].toLowerCase() );\n}\n\nfunction readAnchorClose ( parser, name$$1 ) {\n\tvar pos = parser.pos;\n\tif ( !parser.matchString( '</' ) ) {\n\t\treturn null;\n\t}\n\n\tparser.matchString( '#' );\n\tparser.allowWhitespace();\n\n\tif ( !parser.matchString( name$$1 ) ) {\n\t\tparser.pos = pos;\n\t\treturn null;\n\t}\n\n\tparser.allowWhitespace();\n\n\tif ( !parser.matchString( '>' ) ) {\n\t\tparser.pos = pos;\n\t\treturn null;\n\t}\n\n\treturn true;\n}\n\nfunction readText ( parser ) {\n\tvar index, disallowed, barrier;\n\n\tvar remaining = parser.remaining();\n\n\tif ( parser.textOnlyMode ) {\n\t\tdisallowed = parser.tags.map( function (t) { return t.open; } );\n\t\tdisallowed = disallowed.concat( parser.tags.map( function (t) { return '\\\\' + t.open; } ) );\n\n\t\tindex = getLowestIndex( remaining, disallowed );\n\t} else {\n\t\tbarrier = parser.inside ? '</' + parser.inside : '<';\n\n\t\tif ( parser.inside && !parser.interpolate[ parser.inside ] ) {\n\t\t\tindex = remaining.indexOf( barrier );\n\t\t} else {\n\t\t\tdisallowed = parser.tags.map( function (t) { return t.open; } );\n\t\t\tdisallowed = disallowed.concat( parser.tags.map( function (t) { return '\\\\' + t.open; } ) );\n\n\t\t\t// http://developers.whatwg.org/syntax.html#syntax-attributes\n\t\t\tif ( parser.inAttribute === true ) {\n\t\t\t\t// we're inside an unquoted attribute value\n\t\t\t\tdisallowed.push( \"\\\"\", \"'\", \"=\", \"<\", \">\", '`' );\n\t\t\t} else if ( parser.inAttribute ) {\n\t\t\t\t// quoted attribute value\n\t\t\t\tdisallowed.push( parser.inAttribute );\n\t\t\t} else {\n\t\t\t\tdisallowed.push( barrier );\n\t\t\t}\n\n\t\t\tindex = getLowestIndex( remaining, disallowed );\n\t\t}\n\t}\n\n\tif ( !index ) {\n\t\treturn null;\n\t}\n\n\tif ( index === -1 ) {\n\t\tindex = remaining.length;\n\t}\n\n\tparser.pos += index;\n\n\tif ( ( parser.inside && parser.inside !== 'textarea' ) || parser.textOnlyMode ) {\n\t\treturn remaining.substr( 0, index );\n\t} else {\n\t\treturn decodeCharacterReferences( remaining.substr( 0, index ) );\n\t}\n}\n\nvar partialDefinitionSectionPattern = /^\\s*#\\s*partial\\s+/;\n\nfunction readPartialDefinitionSection ( parser ) {\n\tvar child, closed;\n\n\tvar start = parser.pos;\n\n\tvar delimiters = parser.standardDelimiters;\n\n\tif ( !parser.matchString( delimiters[0] ) ) {\n\t\treturn null;\n\t}\n\n\tif ( !parser.matchPattern( partialDefinitionSectionPattern ) ) {\n\t\tparser.pos = start;\n\t\treturn null;\n\t}\n\n\tvar name = parser.matchPattern( /^[a-zA-Z_$][a-zA-Z_$0-9\\-\\/]*/ );\n\n\tif ( !name ) {\n\t\tparser.error( 'expected legal partial name' );\n\t}\n\n\tparser.allowWhitespace();\n\tif ( !parser.matchString( delimiters[1] ) ) {\n\t\tparser.error( (\"Expected closing delimiter '\" + (delimiters[1]) + \"'\") );\n\t}\n\n\tvar content = [];\n\n\tvar open = delimiters[0];\n\tvar close = delimiters[1];\n\n\tdo {\n\t\tif ( child = readClosing( parser, { open: open, close: close }) ) {\n\t\t\tif ( child.r !== 'partial' ) {\n\t\t\t\tparser.error( (\"Expected \" + open + \"/partial\" + close) );\n\t\t\t}\n\n\t\t\tclosed = true;\n\t\t}\n\n\t\telse {\n\t\t\tchild = parser.read( READERS );\n\n\t\t\tif ( !child ) {\n\t\t\t\tparser.error( (\"Expected \" + open + \"/partial\" + close) );\n\t\t\t}\n\n\t\t\tcontent.push( child );\n\t\t}\n\t} while ( !closed );\n\n\treturn {\n\t\tt: INLINE_PARTIAL,\n\t\tn: name,\n\t\tf: content\n\t};\n}\n\nfunction readTemplate ( parser ) {\n\tvar fragment = [];\n\tvar partials = create( null );\n\tvar hasPartials = false;\n\n\tvar preserveWhitespace = parser.preserveWhitespace;\n\n\twhile ( parser.pos < parser.str.length ) {\n\t\tvar pos = parser.pos;\n\t\tvar item = (void 0), partial = (void 0);\n\n\t\tif ( partial = parser.read( PARTIAL_READERS ) ) {\n\t\t\tif ( partials[ partial.n ] ) {\n\t\t\t\tparser.pos = pos;\n\t\t\t\tparser.error( 'Duplicated partial definition' );\n\t\t\t}\n\n\t\t\tcleanup( partial.f, parser.stripComments, preserveWhitespace, !preserveWhitespace, !preserveWhitespace );\n\n\t\t\tpartials[ partial.n ] = partial.f;\n\t\t\thasPartials = true;\n\t\t} else if ( item = parser.read( READERS ) ) {\n\t\t\tfragment.push( item );\n\t\t} else  {\n\t\t\tparser.error( 'Unexpected template content' );\n\t\t}\n\t}\n\n\tvar result = {\n\t\tv: TEMPLATE_VERSION,\n\t\tt: fragment\n\t};\n\n\tif ( hasPartials ) {\n\t\tresult.p = partials;\n\t}\n\n\treturn result;\n}\n\nfunction insertExpressions ( obj, expr ) {\n\n\tObject.keys( obj ).forEach( function (key) {\n\t\tif  ( isExpression( key, obj ) ) { return addTo( obj, expr ); }\n\n\t\tvar ref = obj[ key ];\n\t\tif ( hasChildren( ref ) ) { insertExpressions( ref, expr ); }\n\t});\n}\n\nfunction isExpression( key, obj ) {\n\treturn key === 's' && isArray( obj.r );\n}\n\nfunction addTo( obj, expr ) {\n\tvar s = obj.s;\n\tvar r = obj.r;\n\tif ( !expr[ s ] ) { expr[ s ] = fromExpression( s, r.length ); }\n}\n\nfunction hasChildren( ref ) {\n\treturn isArray( ref ) || isObject( ref );\n}\n\n// See https://github.com/ractivejs/template-spec for information\n// about the Ractive template specification\n\nvar STANDARD_READERS = [ readPartial, readUnescaped, readSection, readInterpolator, readComment ];\nvar TRIPLE_READERS = [ readTriple ];\nvar STATIC_READERS = [ readUnescaped, readSection, readInterpolator ]; // TODO does it make sense to have a static section?\n\nvar READERS = [ readMustache, readHtmlComment, readElement$1, readText ];\nvar PARTIAL_READERS = [ readPartialDefinitionSection ];\n\nvar StandardParser = Parser.extend({\n\tinit: function init ( str, options ) {\n\t\tvar tripleDelimiters = options.tripleDelimiters || [ '{{{', '}}}' ];\n\t\tvar staticDelimiters = options.staticDelimiters || [ '[[', ']]' ];\n\t\tvar staticTripleDelimiters = options.staticTripleDelimiters || [ '[[[', ']]]' ];\n\n\t\tthis.standardDelimiters = options.delimiters || [ '{{', '}}' ];\n\n\t\tthis.tags = [\n\t\t\t{ isStatic: false, isTriple: false, open: this.standardDelimiters[0], close: this.standardDelimiters[1], readers: STANDARD_READERS },\n\t\t\t{ isStatic: false, isTriple: true,  open: tripleDelimiters[0],        close: tripleDelimiters[1],        readers: TRIPLE_READERS },\n\t\t\t{ isStatic: true,  isTriple: false, open: staticDelimiters[0],        close: staticDelimiters[1],        readers: STATIC_READERS },\n\t\t\t{ isStatic: true,  isTriple: true,  open: staticTripleDelimiters[0],  close: staticTripleDelimiters[1],  readers: TRIPLE_READERS }\n\t\t];\n\n\t\tthis.contextLines = options.contextLines || 0;\n\n\t\tthis.sortMustacheTags();\n\n\t\tthis.sectionDepth = 0;\n\t\tthis.elementStack = [];\n\n\t\tthis.interpolate = {\n\t\t\tscript: !options.interpolate || options.interpolate.script !== false,\n\t\t\tstyle: !options.interpolate || options.interpolate.style !== false,\n\t\t\ttextarea: true\n\t\t};\n\n\t\tif ( options.sanitize === true ) {\n\t\t\toptions.sanitize = {\n\t\t\t\t// blacklist from https://code.google.com/p/google-caja/source/browse/trunk/src/com/google/caja/lang/html/html4-elements-whitelist.json\n\t\t\t\telements: 'applet base basefont body frame frameset head html isindex link meta noframes noscript object param script style title'.split( ' ' ),\n\t\t\t\teventAttributes: true\n\t\t\t};\n\t\t}\n\n\t\tthis.stripComments = options.stripComments !== false;\n\t\tthis.preserveWhitespace = options.preserveWhitespace;\n\t\tthis.sanitizeElements = options.sanitize && options.sanitize.elements;\n\t\tthis.sanitizeEventAttributes = options.sanitize && options.sanitize.eventAttributes;\n\t\tthis.includeLinePositions = options.includeLinePositions;\n\t\tthis.textOnlyMode = options.textOnlyMode;\n\t\tthis.csp = options.csp;\n\t},\n\n\tpostProcess: function postProcess ( result ) {\n\t\t// special case - empty string\n\t\tif ( !result.length ) {\n\t\t\treturn { t: [], v: TEMPLATE_VERSION };\n\t\t}\n\n\t\tif ( this.sectionDepth > 0 ) {\n\t\t\tthis.error( 'A section was left open' );\n\t\t}\n\n\t\tcleanup( result[0].t, this.stripComments, this.preserveWhitespace, !this.preserveWhitespace, !this.preserveWhitespace );\n\n\t\tif ( this.csp !== false ) {\n\t\t\tvar expr = {};\n\t\t\tinsertExpressions( result[0].t, expr );\n\t\t\tif ( Object.keys( expr ).length ) { result[0].e = expr; }\n\t\t}\n\n\t\treturn result[0];\n\t},\n\n\tconverters: [\n\t\treadTemplate\n\t],\n\n\tsortMustacheTags: function sortMustacheTags () {\n\t\t// Sort in order of descending opening delimiter length (longer first),\n\t\t// to protect against opening delimiters being substrings of each other\n\t\tthis.tags.sort( function ( a, b ) {\n\t\t\treturn b.open.length - a.open.length;\n\t\t});\n\t}\n});\n\nfunction parse$1$1 ( template, options ) {\n\treturn new StandardParser( template, options || {} ).result;\n}\n\nparse$1$1.computedStrings = function( computed ) {\n\tif ( !computed ) { return []; }\n\n\tObject.keys( computed ).forEach( function (key) {\n\t\tvar value = computed[ key ];\n\t\tif ( typeof value === 'string' ) {\n\t\t\tcomputed[ key ] = fromComputationString( value );\n\t\t}\n\t});\n};\n\nvar parseOptions = [\n\t'delimiters',\n\t'tripleDelimiters',\n\t'staticDelimiters',\n\t'staticTripleDelimiters',\n\t'csp',\n\t'interpolate',\n\t'preserveWhitespace',\n\t'sanitize',\n\t'stripComments',\n\t'contextLines'\n];\n\nvar TEMPLATE_INSTRUCTIONS = \"Either preparse or use a ractive runtime source that includes the parser. \";\n\nvar COMPUTATION_INSTRUCTIONS = \"Either use:\\n\\n\\tRactive.parse.computedStrings( component.computed )\\n\\nat build time to pre-convert the strings to functions, or use functions instead of strings in computed properties.\";\n\n\nfunction throwNoParse ( method, error, instructions ) {\n\tif ( !method ) {\n\t\tfatal( (\"Missing Ractive.parse - cannot parse \" + error + \". \" + instructions) );\n\t}\n}\n\nfunction createFunction ( body, length ) {\n\tthrowNoParse( fromExpression, 'new expression function', TEMPLATE_INSTRUCTIONS );\n\treturn fromExpression( body, length );\n}\n\nfunction createFunctionFromString ( str, bindTo ) {\n\tthrowNoParse( fromComputationString, 'compution string \"${str}\"', COMPUTATION_INSTRUCTIONS );\n\treturn fromComputationString( str, bindTo );\n}\n\nvar parser = {\n\n\tfromId: function fromId ( id, options ) {\n\t\tif ( !doc ) {\n\t\t\tif ( options && options.noThrow ) { return; }\n\t\t\tthrow new Error( (\"Cannot retrieve template #\" + id + \" as Ractive is not running in a browser.\") );\n\t\t}\n\n\t\tif ( id ) { id = id.replace( /^#/, '' ); }\n\n\t\tvar template;\n\n\t\tif ( !( template = doc.getElementById( id ) )) {\n\t\t\tif ( options && options.noThrow ) { return; }\n\t\t\tthrow new Error( (\"Could not find template element with id #\" + id) );\n\t\t}\n\n\t\tif ( template.tagName.toUpperCase() !== 'SCRIPT' ) {\n\t\t\tif ( options && options.noThrow ) { return; }\n\t\t\tthrow new Error( (\"Template element with id #\" + id + \", must be a <script> element\") );\n\t\t}\n\n\t\treturn ( 'textContent' in template ? template.textContent : template.innerHTML );\n\n\t},\n\n\tisParsed: function isParsed ( template) {\n\t\treturn !( typeof template === 'string' );\n\t},\n\n\tgetParseOptions: function getParseOptions ( ractive ) {\n\t\t// Could be Ractive or a Component\n\t\tif ( ractive.defaults ) { ractive = ractive.defaults; }\n\n\t\treturn parseOptions.reduce( function ( val, key ) {\n\t\t\tval[ key ] = ractive[ key ];\n\t\t\treturn val;\n\t\t}, {});\n\t},\n\n\tparse: function parse$1 ( template, options ) {\n\t\tthrowNoParse( parse$1$1, 'template', TEMPLATE_INSTRUCTIONS );\n\t\tvar parsed = parse$1$1( template, options );\n\t\taddFunctions( parsed );\n\t\treturn parsed;\n\t},\n\n\tparseFor: function parseFor( template, ractive ) {\n\t\treturn this.parse( template, this.getParseOptions( ractive ) );\n\t}\n};\n\nvar templateConfigurator = {\n\tname: 'template',\n\n\textend: function extend ( Parent, proto, options ) {\n\t\t// only assign if exists\n\t\tif ( 'template' in options ) {\n\t\t\tvar template = options.template;\n\n\t\t\tif ( typeof template === 'function' ) {\n\t\t\t\tproto.template = template;\n\t\t\t} else {\n\t\t\t\tproto.template = parseTemplate( template, proto );\n\t\t\t}\n\t\t}\n\t},\n\n\tinit: function init ( Parent, ractive, options ) {\n\t\t// TODO because of prototypal inheritance, we might just be able to use\n\t\t// ractive.template, and not bother passing through the Parent object.\n\t\t// At present that breaks the test mocks' expectations\n\t\tvar template = 'template' in options ? options.template : Parent.prototype.template;\n\t\ttemplate = template || { v: TEMPLATE_VERSION, t: [] };\n\n\t\tif ( typeof template === 'function' ) {\n\t\t\tvar fn = template;\n\t\t\ttemplate = getDynamicTemplate( ractive, fn );\n\n\t\t\tractive._config.template = {\n\t\t\t\tfn: fn,\n\t\t\t\tresult: template\n\t\t\t};\n\t\t}\n\n\t\ttemplate = parseTemplate( template, ractive );\n\n\t\t// TODO the naming of this is confusing - ractive.template refers to [...],\n\t\t// but Component.prototype.template refers to {v:1,t:[],p:[]}...\n\t\t// it's unnecessary, because the developer never needs to access\n\t\t// ractive.template\n\t\tractive.template = template.t;\n\n\t\tif ( template.p ) {\n\t\t\textendPartials( ractive.partials, template.p );\n\t\t}\n\t},\n\n\treset: function reset ( ractive ) {\n\t\tvar result = resetValue( ractive );\n\n\t\tif ( result ) {\n\t\t\tvar parsed = parseTemplate( result, ractive );\n\n\t\t\tractive.template = parsed.t;\n\t\t\textendPartials( ractive.partials, parsed.p, true );\n\n\t\t\treturn true;\n\t\t}\n\t}\n};\n\nfunction resetValue ( ractive ) {\n\tvar initial = ractive._config.template;\n\n\t// If this isn't a dynamic template, there's nothing to do\n\tif ( !initial || !initial.fn ) {\n\t\treturn;\n\t}\n\n\tvar result = getDynamicTemplate( ractive, initial.fn );\n\n\t// TODO deep equality check to prevent unnecessary re-rendering\n\t// in the case of already-parsed templates\n\tif ( result !== initial.result ) {\n\t\tinitial.result = result;\n\t\treturn result;\n\t}\n}\n\nfunction getDynamicTemplate ( ractive, fn ) {\n\treturn fn.call( ractive, {\n\t\tfromId: parser.fromId,\n\t\tisParsed: parser.isParsed,\n\t\tparse: function parse ( template, options ) {\n\t\t\tif ( options === void 0 ) options = parser.getParseOptions( ractive );\n\n\t\t\treturn parser.parse( template, options );\n\t\t}\n\t});\n}\n\nfunction parseTemplate ( template, ractive ) {\n\tif ( typeof template === 'string' ) {\n\t\t// parse will validate and add expression functions\n\t\ttemplate = parseAsString( template, ractive );\n\t}\n\telse {\n\t\t// need to validate and add exp for already parsed template\n\t\tvalidate$1( template );\n\t\taddFunctions( template );\n\t}\n\n\treturn template;\n}\n\nfunction parseAsString ( template, ractive ) {\n\t// ID of an element containing the template?\n\tif ( template[0] === '#' ) {\n\t\ttemplate = parser.fromId( template );\n\t}\n\n\treturn parser.parseFor( template, ractive );\n}\n\nfunction validate$1( template ) {\n\n\t// Check that the template even exists\n\tif ( template == undefined ) {\n\t\tthrow new Error( (\"The template cannot be \" + template + \".\") );\n\t}\n\n\t// Check the parsed template has a version at all\n\telse if ( typeof template.v !== 'number' ) {\n\t\tthrow new Error( 'The template parser was passed a non-string template, but the template doesn\\'t have a version.  Make sure you\\'re passing in the template you think you are.' );\n\t}\n\n\t// Check we're using the correct version\n\telse if ( template.v !== TEMPLATE_VERSION ) {\n\t\tthrow new Error( (\"Mismatched template version (expected \" + TEMPLATE_VERSION + \", got \" + (template.v) + \") Please ensure you are using the latest version of Ractive.js in your build process as well as in your app\") );\n\t}\n}\n\nfunction extendPartials ( existingPartials, newPartials, overwrite ) {\n\tif ( !newPartials ) { return; }\n\n\t// TODO there's an ambiguity here - we need to overwrite in the `reset()`\n\t// case, but not initially...\n\n\tfor ( var key in newPartials ) {\n\t\tif ( overwrite || !existingPartials.hasOwnProperty( key ) ) {\n\t\t\texistingPartials[ key ] = newPartials[ key ];\n\t\t}\n\t}\n}\n\nvar registryNames = [\n\t'adaptors',\n\t'components',\n\t'computed',\n\t'decorators',\n\t'easing',\n\t'events',\n\t'interpolators',\n\t'partials',\n\t'transitions'\n];\n\nvar Registry = function Registry ( name, useDefaults ) {\n\tthis.name = name;\n\tthis.useDefaults = useDefaults;\n};\n\nRegistry.prototype.extend = function extend ( Parent, proto, options ) {\n\tthis.configure(\n\t\tthis.useDefaults ? Parent.defaults : Parent,\n\t\tthis.useDefaults ? proto : proto.constructor,\n\t\toptions );\n};\n\nRegistry.prototype.init = function init () {\n\t// noop\n};\n\nRegistry.prototype.configure = function configure ( Parent, target, options ) {\n\tvar name = this.name;\n\tvar option = options[ name ];\n\n\tvar registry = create( Parent[name] );\n\n\tfor ( var key in option ) {\n\t\tregistry[ key ] = option[ key ];\n\t}\n\n\ttarget[ name ] = registry;\n};\n\nRegistry.prototype.reset = function reset ( ractive ) {\n\tvar registry = ractive[ this.name ];\n\tvar changed = false;\n\n\tObject.keys( registry ).forEach( function (key) {\n\t\tvar item = registry[ key ];\n\t\t\t\n\t\tif ( item._fn ) {\n\t\t\tif ( item._fn.isOwner ) {\n\t\t\t\tregistry[key] = item._fn;\n\t\t\t} else {\n\t\t\t\tdelete registry[key];\n\t\t\t}\n\t\t\tchanged = true;\n\t\t}\n\t});\n\n\treturn changed;\n};\n\nvar registries = registryNames.map( function (name) { return new Registry( name, name === 'computed' ); } );\n\nfunction wrap$1 ( parent, name, method ) {\n\tif ( !/_super/.test( method ) ) { return method; }\n\n\tfunction wrapper () {\n\t\tvar superMethod = getSuperMethod( wrapper._parent, name );\n\t\tvar hasSuper = '_super' in this;\n\t\tvar oldSuper = this._super;\n\n\t\tthis._super = superMethod;\n\n\t\tvar result = method.apply( this, arguments );\n\n\t\tif ( hasSuper ) {\n\t\t\tthis._super = oldSuper;\n\t\t} else {\n\t\t\tdelete this._super;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\twrapper._parent = parent;\n\twrapper._method = method;\n\n\treturn wrapper;\n}\n\nfunction getSuperMethod ( parent, name ) {\n\tif ( name in parent ) {\n\t\tvar value = parent[ name ];\n\n\t\treturn typeof value === 'function' ?\n\t\t\tvalue :\n\t\t\tfunction () { return value; };\n\t}\n\n\treturn noop;\n}\n\nfunction getMessage( deprecated, correct, isError ) {\n\treturn \"options.\" + deprecated + \" has been deprecated in favour of options.\" + correct + \".\"\n\t\t+ ( isError ? (\" You cannot specify both options, please use options.\" + correct + \".\") : '' );\n}\n\nfunction deprecateOption ( options, deprecatedOption, correct ) {\n\tif ( deprecatedOption in options ) {\n\t\tif( !( correct in options ) ) {\n\t\t\twarnIfDebug( getMessage( deprecatedOption, correct ) );\n\t\t\toptions[ correct ] = options[ deprecatedOption ];\n\t\t} else {\n\t\t\tthrow new Error( getMessage( deprecatedOption, correct, true ) );\n\t\t}\n\t}\n}\n\nfunction deprecate ( options ) {\n\tdeprecateOption( options, 'beforeInit', 'onconstruct' );\n\tdeprecateOption( options, 'init', 'onrender' );\n\tdeprecateOption( options, 'complete', 'oncomplete' );\n\tdeprecateOption( options, 'eventDefinitions', 'events' );\n\n\t// Using extend with Component instead of options,\n\t// like Human.extend( Spider ) means adaptors as a registry\n\t// gets copied to options. So we have to check if actually an array\n\tif ( isArray( options.adaptors ) ) {\n\t\tdeprecateOption( options, 'adaptors', 'adapt' );\n\t}\n}\n\nvar custom = {\n\tadapt: adaptConfigurator,\n\tcss: cssConfigurator,\n\tdata: dataConfigurator,\n\ttemplate: templateConfigurator\n};\n\nvar defaultKeys = Object.keys( defaults );\n\nvar isStandardKey = makeObj( defaultKeys.filter( function (key) { return !custom[ key ]; } ) );\n\n// blacklisted keys that we don't double extend\nvar isBlacklisted = makeObj( defaultKeys.concat( registries.map( function (r) { return r.name; } ), [ 'on', 'observe' ] ) );\n\nvar order = [].concat(\n\tdefaultKeys.filter( function (key) { return !registries[ key ] && !custom[ key ]; } ),\n\tregistries,\n\t//custom.data,\n\tcustom.template,\n\tcustom.css\n);\n\nvar config = {\n\textend: function ( Parent, proto, options ) { return configure$1( 'extend', Parent, proto, options ); },\n\n\tinit: function ( Parent, ractive, options ) { return configure$1( 'init', Parent, ractive, options ); },\n\n\treset: function (ractive) {\n\t\treturn order.filter( function (c) {\n\t\t\treturn c.reset && c.reset( ractive );\n\t\t}).map( function (c) { return c.name; } );\n\t},\n\n\t// this defines the order. TODO this isn't used anywhere in the codebase,\n\t// only in the test suite - should get rid of it\n\torder: order\n};\n\nfunction configure$1 ( method, Parent, target, options ) {\n\tdeprecate( options );\n\n\tfor ( var key in options ) {\n\t\tif ( isStandardKey.hasOwnProperty( key ) ) {\n\t\t\tvar value = options[ key ];\n\n\t\t\t// warn the developer if they passed a function and ignore its value\n\n\t\t\t// NOTE: we allow some functions on \"el\" because we duck type element lists\n\t\t\t// and some libraries or ef'ed-up virtual browsers (phantomJS) return a\n\t\t\t// function object as the result of querySelector methods\n\t\t\tif ( key !== 'el' && typeof value === 'function' ) {\n\t\t\t\twarnIfDebug( (key + \" is a Ractive option that does not expect a function and will be ignored\"),\n\t\t\t\t\tmethod === 'init' ? target : null );\n\t\t\t}\n\t\t\telse {\n\t\t\t\ttarget[ key ] = value;\n\t\t\t}\n\t\t}\n\t}\n\n\t// disallow combination of `append` and `enhance`\n\tif ( options.append && options.enhance ) {\n\t\tthrow new Error( 'Cannot use append and enhance at the same time' );\n\t}\n\n\tregistries.forEach( function (registry) {\n\t\tregistry[ method ]( Parent, target, options );\n\t});\n\n\tadaptConfigurator[ method ]( Parent, target, options );\n\ttemplateConfigurator[ method ]( Parent, target, options );\n\tcssConfigurator[ method ]( Parent, target, options );\n\n\textendOtherMethods( Parent.prototype, target, options );\n}\n\nfunction extendOtherMethods ( parent, target, options ) {\n\tfor ( var key in options ) {\n\t\tif ( !isBlacklisted[ key ] && options.hasOwnProperty( key ) ) {\n\t\t\tvar member = options[ key ];\n\n\t\t\t// if this is a method that overwrites a method, wrap it:\n\t\t\tif ( typeof member === 'function' ) {\n\t\t\t\tmember = wrap$1( parent, key, member );\n\t\t\t}\n\n\t\t\ttarget[ key ] = member;\n\t\t}\n\t}\n}\n\nfunction makeObj ( array ) {\n\tvar obj = {};\n\tarray.forEach( function (x) { return obj[x] = true; } );\n\treturn obj;\n}\n\nvar Item = function Item ( options ) {\n\tthis.parentFragment = options.parentFragment;\n\tthis.ractive = options.parentFragment.ractive;\n\n\tthis.template = options.template;\n\tthis.index = options.index;\n\tthis.type = options.template.t;\n\n\tthis.dirty = false;\n};\n\nItem.prototype.bubble = function bubble () {\n\tif ( !this.dirty ) {\n\t\tthis.dirty = true;\n\t\tthis.parentFragment.bubble();\n\t}\n};\n\nItem.prototype.destroyed = function destroyed () {\n\tif ( this.fragment ) { this.fragment.destroyed(); }\n};\n\nItem.prototype.find = function find () {\n\treturn null;\n};\n\nItem.prototype.findAll = function findAll () {\n\t// noop\n};\n\nItem.prototype.findComponent = function findComponent () {\n\treturn null;\n};\n\nItem.prototype.findAllComponents = function findAllComponents () {\n\t// noop;\n};\n\nItem.prototype.findNextNode = function findNextNode () {\n\treturn this.parentFragment.findNextNode( this );\n};\n\nItem.prototype.shuffled = function shuffled () {\n\tif ( this.fragment ) { this.fragment.shuffled(); }\n};\n\nItem.prototype.valueOf = function valueOf () {\n\treturn this.toString();\n};\n\nvar ContainerItem = (function (Item) {\n\tfunction ContainerItem ( options ) {\n\t\tItem.call( this, options );\n\t}\n\n\tif ( Item ) ContainerItem.__proto__ = Item;\n\tContainerItem.prototype = Object.create( Item && Item.prototype );\n\tContainerItem.prototype.constructor = ContainerItem;\n\n\tContainerItem.prototype.detach = function detach () {\n\t\treturn this.fragment ? this.fragment.detach() : createDocumentFragment();\n\t};\n\n\tContainerItem.prototype.find = function find ( selector ) {\n\t\tif ( this.fragment ) {\n\t\t\treturn this.fragment.find( selector );\n\t\t}\n\t};\n\n\tContainerItem.prototype.findAll = function findAll ( selector, query ) {\n\t\tif ( this.fragment ) {\n\t\t\tthis.fragment.findAll( selector, query );\n\t\t}\n\t};\n\n\tContainerItem.prototype.findComponent = function findComponent ( name ) {\n\t\tif ( this.fragment ) {\n\t\t\treturn this.fragment.findComponent( name );\n\t\t}\n\t};\n\n\tContainerItem.prototype.findAllComponents = function findAllComponents ( name, query ) {\n\t\tif ( this.fragment ) {\n\t\t\tthis.fragment.findAllComponents( name, query );\n\t\t}\n\t};\n\n\tContainerItem.prototype.firstNode = function firstNode ( skipParent ) {\n\t\treturn this.fragment && this.fragment.firstNode( skipParent );\n\t};\n\n\tContainerItem.prototype.toString = function toString ( escape ) {\n\t\treturn this.fragment ? this.fragment.toString( escape ) : '';\n\t};\n\n\treturn ContainerItem;\n}(Item));\n\nvar ComputationChild = (function (Model$$1) {\n\tfunction ComputationChild ( parent, key ) {\n\t\tModel$$1.call( this, parent, key );\n\n\t\tthis.isReadonly = !this.root.ractive.syncComputedChildren;\n\t\tthis.dirty = true;\n\t}\n\n\tif ( Model$$1 ) ComputationChild.__proto__ = Model$$1;\n\tComputationChild.prototype = Object.create( Model$$1 && Model$$1.prototype );\n\tComputationChild.prototype.constructor = ComputationChild;\n\n\tComputationChild.prototype.applyValue = function applyValue ( value ) {\n\t\tModel$$1.prototype.applyValue.call( this, value );\n\n\t\tif ( !this.isReadonly ) {\n\t\t\tvar source = this.parent;\n\t\t\t// computed models don't have a shuffle method\n\t\t\twhile ( source && source.shuffle ) {\n\t\t\t\tsource = source.parent;\n\t\t\t}\n\n\t\t\tif ( source ) {\n\t\t\t\tsource.dependencies.forEach( mark$1$1 );\n\t\t\t}\n\t\t}\n\t};\n\n\tComputationChild.prototype.get = function get ( shouldCapture ) {\n\t\tif ( shouldCapture ) { capture( this ); }\n\n\t\tif ( this.dirty ) {\n\t\t\tthis.dirty = false;\n\t\t\tvar parentValue = this.parent.get();\n\t\t\tthis.value = parentValue ? parentValue[ this.key ] : undefined;\n\t\t}\n\n\t\treturn this.value;\n\t};\n\n\tComputationChild.prototype.handleChange = function handleChange$1 () {\n\t\tthis.dirty = true;\n\n\t\tif ( this.boundValue ) { this.boundValue = null; }\n\n\t\tthis.links.forEach( marked );\n\t\tthis.deps.forEach( handleChange$1$1 );\n\t\tthis.children.forEach( handleChange$1$1 );\n\t\tthis.clearUnresolveds(); // TODO is this necessary?\n\t};\n\n\tComputationChild.prototype.joinKey = function joinKey ( key ) {\n\t\tif ( key === undefined || key === '' ) { return this; }\n\n\t\tif ( !this.childByKey.hasOwnProperty( key ) ) {\n\t\t\tvar child = new ComputationChild( this, key );\n\t\t\tthis.children.push( child );\n\t\t\tthis.childByKey[ key ] = child;\n\t\t}\n\n\t\treturn this.childByKey[ key ];\n\t};\n\n\treturn ComputationChild;\n}(Model));\n\n/* global console */\n/* eslint no-console:\"off\" */\n\n// TODO this is probably a bit anal, maybe we should leave it out\nfunction prettify ( fnBody ) {\n\tvar lines = fnBody\n\t\t.replace( /^\\t+/gm, function (tabs) { return tabs.split( '\\t' ).join( '  ' ); } )\n\t\t.split( '\\n' );\n\n\tvar minIndent = lines.length < 2 ? 0 :\n\t\tlines.slice( 1 ).reduce( function ( prev, line ) {\n\t\t\treturn Math.min( prev, /^\\s*/.exec( line )[0].length );\n\t\t}, Infinity );\n\n\treturn lines.map( function ( line, i ) {\n\t\treturn '    ' + ( i ? line.substring( minIndent ) : line );\n\t}).join( '\\n' );\n}\n\n// Ditto. This function truncates the stack to only include app code\nfunction truncateStack ( stack ) {\n\tif ( !stack ) { return ''; }\n\n\tvar lines = stack.split( '\\n' );\n\tvar name = Computation.name + '.getValue';\n\n\tvar truncated = [];\n\n\tvar len = lines.length;\n\tfor ( var i = 1; i < len; i += 1 ) {\n\t\tvar line = lines[i];\n\n\t\tif ( ~line.indexOf( name ) ) {\n\t\t\treturn truncated.join( '\\n' );\n\t\t} else {\n\t\t\ttruncated.push( line );\n\t\t}\n\t}\n}\n\nvar Computation = (function (Model$$1) {\n\tfunction Computation ( viewmodel, signature, key ) {\n\t\tModel$$1.call( this, null, null );\n\n\t\tthis.root = this.parent = viewmodel;\n\t\tthis.signature = signature;\n\n\t\tthis.key = key; // not actually used, but helps with debugging\n\t\tthis.isExpression = key && key[0] === '@';\n\n\t\tthis.isReadonly = !this.signature.setter;\n\n\t\tthis.context = viewmodel.computationContext;\n\n\t\tthis.dependencies = [];\n\n\t\tthis.children = [];\n\t\tthis.childByKey = {};\n\n\t\tthis.deps = [];\n\n\t\tthis.dirty = true;\n\n\t\t// TODO: is there a less hackish way to do this?\n\t\tthis.shuffle = undefined;\n\t}\n\n\tif ( Model$$1 ) Computation.__proto__ = Model$$1;\n\tComputation.prototype = Object.create( Model$$1 && Model$$1.prototype );\n\tComputation.prototype.constructor = Computation;\n\n\tComputation.prototype.get = function get ( shouldCapture ) {\n\t\tif ( shouldCapture ) { capture( this ); }\n\n\t\tif ( this.dirty ) {\n\t\t\tthis.dirty = false;\n\t\t\tthis.value = this.getValue();\n\t\t\tif ( this.wrapper ) { this.newWrapperValue = this.value; }\n\t\t\tthis.adapt();\n\t\t}\n\n\t\t// if capturing, this value needs to be unwrapped because it's for external use\n\t\treturn maybeBind( this, shouldCapture && this.wrapper ? this.wrapperValue : this.value );\n\t};\n\n\tComputation.prototype.getValue = function getValue () {\n\t\tstartCapturing();\n\t\tvar result;\n\n\t\ttry {\n\t\t\tresult = this.signature.getter.call( this.context );\n\t\t} catch ( err ) {\n\t\t\twarnIfDebug( (\"Failed to compute \" + (this.getKeypath()) + \": \" + (err.message || err)) );\n\n\t\t\t// TODO this is all well and good in Chrome, but...\n\t\t\t// ...also, should encapsulate this stuff better, and only\n\t\t\t// show it if Ractive.DEBUG\n\t\t\tif ( hasConsole ) {\n\t\t\t\tif ( console.groupCollapsed ) { console.groupCollapsed( '%cshow details', 'color: rgb(82, 140, 224); font-weight: normal; text-decoration: underline;' ); }\n\t\t\t\tvar functionBody = prettify( this.signature.getterString );\n\t\t\t\tvar stack = this.signature.getterUseStack ? '\\n\\n' + truncateStack( err.stack ) : '';\n\t\t\t\tconsole.error( ((err.name) + \": \" + (err.message) + \"\\n\\n\" + functionBody + stack) );\n\t\t\t\tif ( console.groupCollapsed ) { console.groupEnd(); }\n\t\t\t}\n\t\t}\n\n\t\tvar dependencies = stopCapturing();\n\t\tthis.setDependencies( dependencies );\n\n\t\t// if not the first computation and the value is not the same,\n\t\t// register the change for change events\n\t\tif ( 'value' in this && result !== this.value ) {\n\t\t\tthis.registerChange( this.getKeypath(), result );\n\t\t}\n\n\t\treturn result;\n\t};\n\n\tComputation.prototype.mark = function mark () {\n\t\tthis.handleChange();\n\t};\n\n\tComputation.prototype.rebinding = function rebinding ( next, previous ) {\n\t\t// computations will grab all of their deps again automagically\n\t\tif ( next !== previous ) { this.handleChange(); }\n\t};\n\n\tComputation.prototype.set = function set ( value ) {\n\t\tif ( this.isReadonly ) {\n\t\t\tthrow new Error( (\"Cannot set read-only computed value '\" + (this.key) + \"'\") );\n\t\t}\n\n\t\tthis.signature.setter( value );\n\t\tthis.mark();\n\t};\n\n\tComputation.prototype.setDependencies = function setDependencies ( dependencies ) {\n\t\tvar this$1 = this;\n\n\t\t// unregister any soft dependencies we no longer have\n\t\tvar i = this.dependencies.length;\n\t\twhile ( i-- ) {\n\t\t\tvar model = this$1.dependencies[i];\n\t\t\tif ( !~dependencies.indexOf( model ) ) { model.unregister( this$1 ); }\n\t\t}\n\n\t\t// and add any new ones\n\t\ti = dependencies.length;\n\t\twhile ( i-- ) {\n\t\t\tvar model$1 = dependencies[i];\n\t\t\tif ( !~this$1.dependencies.indexOf( model$1 ) ) { model$1.register( this$1 ); }\n\t\t}\n\n\t\tthis.dependencies = dependencies;\n\t};\n\n\tComputation.prototype.teardown = function teardown () {\n\t\tvar this$1 = this;\n\n\t\tvar i = this.dependencies.length;\n\t\twhile ( i-- ) {\n\t\t\tif ( this$1.dependencies[i] ) { this$1.dependencies[i].unregister( this$1 ); }\n\t\t}\n\t\tif ( this.root.computations[this.key] === this ) { delete this.root.computations[this.key]; }\n\t\tModel$$1.prototype.teardown.call(this);\n\t};\n\n\treturn Computation;\n}(Model));\n\nvar prototype$1 = Computation.prototype;\nvar child = ComputationChild.prototype;\nprototype$1.handleChange = child.handleChange;\nprototype$1.joinKey = child.joinKey;\n\nfunction createResolver ( proxy, ref, index ) {\n\tvar resolver = proxy.fragment.resolve( ref, function (model) {\n\t\tremoveFromArray( proxy.resolvers, resolver );\n\t\tproxy.models[ index ] = model;\n\t\tproxy.bubble();\n\t});\n\n\tproxy.resolvers.push( resolver );\n}\n\nvar ExpressionProxy = (function (Model$$1) {\n\tfunction ExpressionProxy ( fragment, template ) {\n\t\tvar this$1 = this;\n\n\t\tModel$$1.call( this, fragment.ractive.viewmodel, null );\n\n\t\tthis.fragment = fragment;\n\t\tthis.template = template;\n\n\t\tthis.isReadonly = true;\n\t\tthis.dirty = true;\n\n\t\tthis.fn = getFunction( template.s, template.r.length );\n\n\t\tthis.resolvers = [];\n\t\tthis.models = this.template.r.map( function ( ref, index ) {\n\t\t\tvar model = resolveReference( this$1.fragment, ref );\n\n\t\t\tif ( !model ) {\n\t\t\t\tcreateResolver( this$1, ref, index );\n\t\t\t}\n\n\t\t\treturn model;\n\t\t});\n\t\tthis.dependencies = [];\n\n\t\tthis.shuffle = undefined;\n\n\t\tthis.bubble();\n\t}\n\n\tif ( Model$$1 ) ExpressionProxy.__proto__ = Model$$1;\n\tExpressionProxy.prototype = Object.create( Model$$1 && Model$$1.prototype );\n\tExpressionProxy.prototype.constructor = ExpressionProxy;\n\n\tExpressionProxy.prototype.bubble = function bubble ( actuallyChanged ) {\n\t\tif ( actuallyChanged === void 0 ) actuallyChanged = true;\n\n\t\t// refresh the keypath\n\t\tthis.keypath = undefined;\n\n\t\tif ( actuallyChanged ) {\n\t\t\tthis.handleChange();\n\t\t}\n\t};\n\n\tExpressionProxy.prototype.getKeypath = function getKeypath () {\n\t\tvar this$1 = this;\n\n\t\tif ( !this.template ) { return '@undefined'; }\n\t\tif ( !this.keypath ) {\n\t\t\tthis.keypath = '@' + this.template.s.replace( /_(\\d+)/g, function ( match, i ) {\n\t\t\t\tif ( i >= this$1.models.length ) { return match; }\n\n\t\t\t\tvar model = this$1.models[i];\n\t\t\t\treturn model ? model.getKeypath() : '@undefined';\n\t\t\t});\n\t\t}\n\n\t\treturn this.keypath;\n\t};\n\n\tExpressionProxy.prototype.getValue = function getValue () {\n\t\tvar this$1 = this;\n\n\t\tstartCapturing();\n\t\tvar result;\n\n\t\ttry {\n\t\t\tvar params = this.models.map( function (m) { return m ? m.get( true ) : undefined; } );\n\t\t\tresult = this.fn.apply( this.fragment.ractive, params );\n\t\t} catch ( err ) {\n\t\t\twarnIfDebug( (\"Failed to compute \" + (this.getKeypath()) + \": \" + (err.message || err)) );\n\t\t}\n\n\t\tvar dependencies = stopCapturing();\n\t\t// remove missing deps\n\t\tthis.dependencies.filter( function (d) { return !~dependencies.indexOf( d ); } ).forEach( function (d) {\n\t\t\td.unregister( this$1 );\n\t\t\tremoveFromArray( this$1.dependencies, d );\n\t\t});\n\t\t// register new deps\n\t\tdependencies.filter( function (d) { return !~this$1.dependencies.indexOf( d ); } ).forEach( function (d) {\n\t\t\td.register( this$1 );\n\t\t\tthis$1.dependencies.push( d );\n\t\t});\n\n\t\treturn result;\n\t};\n\n\tExpressionProxy.prototype.rebinding = function rebinding ( next, previous, safe ) {\n\t\tvar idx = this.models.indexOf( previous );\n\n\t\tif ( ~idx ) {\n\t\t\tnext = rebindMatch( this.template.r[idx], next, previous );\n\t\t\tif ( next !== previous ) {\n\t\t\t\tprevious.unregister( this );\n\t\t\t\tthis.models.splice( idx, 1, next );\n\t\t\t\t// TODO: set up a resolver if there is no next?\n\t\t\t\tif ( next ) { next.addShuffleRegister( this, 'mark' ); }\n\t\t\t}\n\t\t}\n\t\tthis.bubble( !safe );\n\t};\n\n\tExpressionProxy.prototype.retrieve = function retrieve () {\n\t\treturn this.get();\n\t};\n\n\tExpressionProxy.prototype.teardown = function teardown () {\n\t\tvar this$1 = this;\n\n\t\tthis.unbind();\n\t\tthis.fragment = undefined;\n\t\tif ( this.dependencies ) { this.dependencies.forEach( function (d) { return d.unregister( this$1 ); } ); }\n\t\tModel$$1.prototype.teardown.call(this);\n\t};\n\n\tExpressionProxy.prototype.unregister = function unregister ( dep ) {\n\t\tModel$$1.prototype.unregister.call( this, dep );\n\t\tif ( !this.deps.length ) { this.teardown(); }\n\t};\n\n\tExpressionProxy.prototype.unbind = function unbind$1 () {\n\t\tthis.resolvers.forEach( unbind$1$1 );\n\t};\n\n\treturn ExpressionProxy;\n}(Model));\n\nvar prototype = ExpressionProxy.prototype;\nvar computation = Computation.prototype;\nprototype.get = computation.get;\nprototype.handleChange = computation.handleChange;\nprototype.joinKey = computation.joinKey;\nprototype.mark = computation.mark;\n\nvar ReferenceExpressionChild = (function (Model$$1) {\n\tfunction ReferenceExpressionChild ( parent, key ) {\n\t\tModel$$1.call ( this, parent, key );\n\t}\n\n\tif ( Model$$1 ) ReferenceExpressionChild.__proto__ = Model$$1;\n\tReferenceExpressionChild.prototype = Object.create( Model$$1 && Model$$1.prototype );\n\tReferenceExpressionChild.prototype.constructor = ReferenceExpressionChild;\n\n\tReferenceExpressionChild.prototype.applyValue = function applyValue ( value ) {\n\t\tif ( isEqual( value, this.value ) ) { return; }\n\n\t\tvar parent = this.parent;\n\t\tvar keys = [ this.key ];\n\t\twhile ( parent ) {\n\t\t\tif ( parent.base ) {\n\t\t\t\tvar target = parent.model.joinAll( keys );\n\t\t\t\ttarget.applyValue( value );\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tkeys.unshift( parent.key );\n\n\t\t\tparent = parent.parent;\n\t\t}\n\t};\n\n\tReferenceExpressionChild.prototype.joinKey = function joinKey ( key ) {\n\t\tif ( key === undefined || key === '' ) { return this; }\n\n\t\tif ( !this.childByKey.hasOwnProperty( key ) ) {\n\t\t\tvar child = new ReferenceExpressionChild( this, key );\n\t\t\tthis.children.push( child );\n\t\t\tthis.childByKey[ key ] = child;\n\t\t}\n\n\t\treturn this.childByKey[ key ];\n\t};\n\n\tReferenceExpressionChild.prototype.retrieve = function retrieve () {\n\t\tvar parent = this.parent.get();\n\t\treturn parent && this.key in parent ? parent[ this.key ] : undefined;\n\t};\n\n\treturn ReferenceExpressionChild;\n}(Model));\n\nvar ReferenceExpressionProxy = (function (Model$$1) {\n\tfunction ReferenceExpressionProxy ( fragment, template ) {\n\t\tvar this$1 = this;\n\n\t\tModel$$1.call( this, null, null );\n\t\tthis.dirty = true;\n\t\tthis.root = fragment.ractive.viewmodel;\n\t\tthis.template = template;\n\n\t\tthis.resolvers = [];\n\n\t\tthis.base = resolve$3( fragment, template );\n\t\tvar baseResolver;\n\n\t\tif ( !this.base ) {\n\t\t\tbaseResolver = fragment.resolve( template.r, function (model) {\n\t\t\t\tthis$1.base = model;\n\t\t\t\tthis$1.bubble();\n\n\t\t\t\tremoveFromArray( this$1.resolvers, baseResolver );\n\t\t\t});\n\n\t\t\tthis.resolvers.push( baseResolver );\n\t\t}\n\n\t\tvar intermediary = this.intermediary = {\n\t\t\thandleChange: function () { return this$1.handleChange(); },\n\t\t\trebinding: function ( next, previous ) {\n\t\t\t\tif ( previous === this$1.base ) {\n\t\t\t\t\tnext = rebindMatch( template, next, previous );\n\t\t\t\t\tif ( next !== this$1.base ) {\n\t\t\t\t\t\tthis$1.base.unregister( intermediary );\n\t\t\t\t\t\tthis$1.base = next;\n\t\t\t\t\t\t// TODO: if there is no next, set up a resolver?\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tvar idx = this$1.members.indexOf( previous );\n\t\t\t\t\tif ( ~idx ) {\n\t\t\t\t\t\t// only direct references will rebind... expressions handle themselves\n\t\t\t\t\t\tnext = rebindMatch( template.m[idx].n, next, previous );\n\t\t\t\t\t\tif ( next !== this$1.members[idx] ) {\n\t\t\t\t\t\t\tthis$1.members.splice( idx, 1, next );\n\t\t\t\t\t\t\t// TODO: if there is no next, set up a resolver?\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( next !== previous ) { previous.unregister( intermediary ); }\n\t\t\t\tif ( next ) { next.addShuffleTask( function () { return next.register( intermediary ); } ); }\n\n\t\t\t\tthis$1.bubble();\n\t\t\t}\n\t\t};\n\n\t\tthis.members = template.m.map( function ( template, i ) {\n\t\t\tif ( typeof template === 'string' ) {\n\t\t\t\treturn { get: function () { return template; } };\n\t\t\t}\n\n\t\t\tvar model;\n\t\t\tvar resolver;\n\n\t\t\tif ( template.t === REFERENCE ) {\n\t\t\t\tmodel = resolveReference( fragment, template.n );\n\n\t\t\t\tif ( model ) {\n\t\t\t\t\tmodel.register( intermediary );\n\t\t\t\t} else {\n\t\t\t\t\tresolver = fragment.resolve( template.n, function (model) {\n\t\t\t\t\t\tthis$1.members[i] = model;\n\n\t\t\t\t\t\tmodel.register( intermediary );\n\t\t\t\t\t\tthis$1.handleChange();\n\n\t\t\t\t\t\tremoveFromArray( this$1.resolvers, resolver );\n\t\t\t\t\t});\n\n\t\t\t\t\tthis$1.resolvers.push( resolver );\n\t\t\t\t}\n\n\t\t\t\treturn model;\n\t\t\t}\n\n\t\t\tmodel = new ExpressionProxy( fragment, template );\n\t\t\tmodel.register( intermediary );\n\t\t\treturn model;\n\t\t});\n\n\t\tthis.isUnresolved = true;\n\t\tthis.bubble();\n\t}\n\n\tif ( Model$$1 ) ReferenceExpressionProxy.__proto__ = Model$$1;\n\tReferenceExpressionProxy.prototype = Object.create( Model$$1 && Model$$1.prototype );\n\tReferenceExpressionProxy.prototype.constructor = ReferenceExpressionProxy;\n\n\tReferenceExpressionProxy.prototype.bubble = function bubble () {\n\t\tif ( !this.base ) { return; }\n\t\tif ( !this.dirty ) { this.handleChange(); }\n\t};\n\n\tReferenceExpressionProxy.prototype.forceResolution = function forceResolution () {\n\t\tthis.resolvers.forEach( function (resolver) { return resolver.forceResolution(); } );\n\t\tthis.dirty = true;\n\t\tthis.bubble();\n\t};\n\n\tReferenceExpressionProxy.prototype.get = function get ( shouldCapture ) {\n\t\tvar this$1 = this;\n\n\t\tif ( this.dirty ) {\n\t\t\tthis.bubble();\n\n\t\t\tvar i = this.members.length;\n\t\t\tvar resolved = true;\n\t\t\twhile ( resolved && i-- ) {\n\t\t\t\tif ( !this$1.members[i] ) { resolved = false; }\n\t\t\t}\n\n\t\t\tif ( this.base && resolved ) {\n\t\t\t\tvar keys = this.members.map( function (m) { return escapeKey( String( m.get() ) ); } );\n\t\t\t\tvar model = this.base.joinAll( keys );\n\n\t\t\t\tif ( model !== this.model ) {\n\t\t\t\t\tif ( this.model ) {\n\t\t\t\t\t\tthis.model.unregister( this );\n\t\t\t\t\t\tthis.model.unregisterTwowayBinding( this );\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.model = model;\n\t\t\t\t\tthis.parent = model.parent;\n\t\t\t\t\tthis.model.register( this );\n\t\t\t\t\tthis.model.registerTwowayBinding( this );\n\n\t\t\t\t\tif ( this.keypathModel ) { this.keypathModel.handleChange(); }\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.value = this.model ? this.model.get( shouldCapture ) : undefined;\n\t\t\tthis.dirty = false;\n\t\t\tthis.mark();\n\t\t\treturn this.value;\n\t\t} else {\n\t\t\treturn this.model ? this.model.get( shouldCapture ) : undefined;\n\t\t}\n\t};\n\n\t// indirect two-way bindings\n\tReferenceExpressionProxy.prototype.getValue = function getValue () {\n\t\tvar this$1 = this;\n\n\t\tthis.value = this.model ? this.model.get() : undefined;\n\n\t\tvar i = this.bindings.length;\n\t\twhile ( i-- ) {\n\t\t\tvar value = this$1.bindings[i].getValue();\n\t\t\tif ( value !== this$1.value ) { return value; }\n\t\t}\n\n\t\t// check one-way bindings\n\t\tvar oneway = findBoundValue( this.deps );\n\t\tif ( oneway ) { return oneway.value; }\n\n\t\treturn this.value;\n\t};\n\n\tReferenceExpressionProxy.prototype.getKeypath = function getKeypath () {\n\t\treturn this.model ? this.model.getKeypath() : '@undefined';\n\t};\n\n\tReferenceExpressionProxy.prototype.handleChange = function handleChange$1 () {\n\t\tthis.dirty = true;\n\t\tthis.mark();\n\t};\n\n\tReferenceExpressionProxy.prototype.joinKey = function joinKey ( key ) {\n\t\tif ( key === undefined || key === '' ) { return this; }\n\n\t\tif ( !this.childByKey.hasOwnProperty( key ) ) {\n\t\t\tvar child = new ReferenceExpressionChild( this, key );\n\t\t\tthis.children.push( child );\n\t\t\tthis.childByKey[ key ] = child;\n\t\t}\n\n\t\treturn this.childByKey[ key ];\n\t};\n\n\tReferenceExpressionProxy.prototype.mark = function mark$1 () {\n\t\tif ( this.dirty ) {\n\t\t\tthis.deps.forEach( handleChange$1$1 );\n\t\t}\n\n\t\tthis.links.forEach( marked );\n\t\tthis.children.forEach( mark$1$1 );\n\t\tthis.clearUnresolveds();\n\t};\n\n\tReferenceExpressionProxy.prototype.retrieve = function retrieve () {\n\t\treturn this.value;\n\t};\n\n\tReferenceExpressionProxy.prototype.rebinding = function rebinding () { }; // NOOP\n\n\tReferenceExpressionProxy.prototype.set = function set ( value ) {\n\t\tif ( !this.model ) { throw new Error( 'Unresolved reference expression. This should not happen!' ); }\n\t\tthis.model.set( value );\n\t};\n\n\tReferenceExpressionProxy.prototype.unbind = function unbind$1 () {\n\t\tthis.resolvers.forEach( unbind$1$1 );\n\t\tif ( this.model ) {\n\t\t\tthis.model.unregister( this );\n\t\t\tthis.model.unregisterTwowayBinding( this );\n\t\t}\n\t};\n\n\treturn ReferenceExpressionProxy;\n}(Model));\n\nfunction resolve$3 ( fragment, template ) {\n\tif ( template.r ) {\n\t\treturn resolveReference( fragment, template.r );\n\t}\n\n\telse if ( template.x ) {\n\t\treturn new ExpressionProxy( fragment, template.x );\n\t}\n\n\telse if ( template.rx ) {\n\t\treturn new ReferenceExpressionProxy( fragment, template.rx );\n\t}\n}\n\nfunction resolveAliases( aliases, fragment ) {\n\tvar resolved = {};\n\n\tfor ( var i = 0; i < aliases.length; i++ ) {\n\t\tresolved[ aliases[i].n ] = resolve$3( fragment, aliases[i].x );\n\t}\n\n\treturn resolved;\n}\n\nvar Alias = (function (ContainerItem$$1) {\n\tfunction Alias ( options ) {\n\t\tContainerItem$$1.call( this, options );\n\n\t\tthis.fragment = null;\n\t}\n\n\tif ( ContainerItem$$1 ) Alias.__proto__ = ContainerItem$$1;\n\tAlias.prototype = Object.create( ContainerItem$$1 && ContainerItem$$1.prototype );\n\tAlias.prototype.constructor = Alias;\n\n\tAlias.prototype.bind = function bind () {\n\t\tthis.fragment = new Fragment({\n\t\t\towner: this,\n\t\t\ttemplate: this.template.f\n\t\t});\n\n\t\tthis.fragment.aliases = resolveAliases( this.template.z, this.parentFragment );\n\t\tthis.fragment.bind();\n\t};\n\n\tAlias.prototype.rebinding = function rebinding () {\n\t\tvar this$1 = this;\n\n\t\tif ( this.locked ) { return; }\n\t\tthis.locked = true;\n\t\trunloop.scheduleTask( function () {\n\t\t\tthis$1.locked = false;\n\t\t\tthis$1.fragment.aliases = resolveAliases( this$1.template.z, this$1.parentFragment );\n\t\t});\n\t};\n\n\tAlias.prototype.render = function render ( target ) {\n\t\tthis.rendered = true;\n\t\tif ( this.fragment ) { this.fragment.render( target ); }\n\t};\n\n\tAlias.prototype.unbind = function unbind () {\n\t\tthis.fragment.aliases = {};\n\t\tif ( this.fragment ) { this.fragment.unbind(); }\n\t};\n\n\tAlias.prototype.unrender = function unrender ( shouldDestroy ) {\n\t\tif ( this.rendered && this.fragment ) { this.fragment.unrender( shouldDestroy ); }\n\t\tthis.rendered = false;\n\t};\n\n\tAlias.prototype.update = function update () {\n\t\tif ( this.dirty ) {\n\t\t\tthis.dirty = false;\n\t\t\tthis.fragment.update();\n\t\t}\n\t};\n\n\treturn Alias;\n}(ContainerItem));\n\nfunction findElement( start, orComponent, name ) {\n\tif ( orComponent === void 0 ) orComponent = true;\n\n\twhile ( start && ( start.type !== ELEMENT || ( name && start.name !== name ) ) && ( !orComponent || ( start.type !== COMPONENT && start.type !== ANCHOR ) ) ) {\n\t\t// start is a fragment - look at the owner\n\t\tif ( start.owner ) { start = start.owner; }\n\t\t// start is a component or yielder - look at the container\n\t\telse if ( start.component ) { start = start.containerFragment || start.component.parentFragment; }\n\t\t// start is an item - look at the parent\n\t\telse if ( start.parent ) { start = start.parent; }\n\t\t// start is an item without a parent - look at the parent fragment\n\t\telse if ( start.parentFragment ) { start = start.parentFragment; }\n\n\t\telse { start = undefined; }\n\t}\n\n\treturn start;\n}\n\nvar camelCase = function ( hyphenatedStr ) {\n\treturn hyphenatedStr.replace( /-([a-zA-Z])/g, function ( match, $1 ) {\n\t\treturn $1.toUpperCase();\n\t});\n};\n\nvar space = /\\s+/;\nvar specials$1 = { float: 'cssFloat' };\nvar remove$1 = /\\/\\*(?:[\\s\\S]*?)\\*\\//g;\nvar escape = /url\\(\\s*(['\"])(?:\\\\[\\s\\S]|(?!\\1).)*\\1\\s*\\)|url\\((?:\\\\[\\s\\S]|[^)])*\\)|(['\"])(?:\\\\[\\s\\S]|(?!\\1).)*\\2/gi;\nvar value = /\\0(\\d+)/g;\n\nfunction readStyle ( css ) {\n\tvar values = [];\n\n\tif ( typeof css !== 'string' ) { return {}; }\n\n\treturn css.replace( escape, function (match) { return (\"\\u0000\" + (values.push( match ) - 1)); })\n        .replace( remove$1, '' )\n        .split( ';' )\n        .filter( function (rule) { return !!rule.trim(); } )\n        .map( function (rule) { return rule.replace( value, function ( match, n ) { return values[ n ]; } ); } )\n        .reduce(function ( rules, rule ) {\n\tvar i = rule.indexOf(':');\n\tvar name = camelCase( rule.substr( 0, i ).trim() );\n\trules[ specials$1[ name ] || name ] = rule.substr( i + 1 ).trim();\n\treturn rules;\n}, {});\n}\n\nfunction readClass ( str ) {\n\tvar list = str.split( space );\n\n  // remove any empty entries\n\tvar i = list.length;\n\twhile ( i-- ) {\n\t\tif ( !list[i] ) { list.splice( i, 1 ); }\n\t}\n\n\treturn list;\n}\n\nvar textTypes = [ undefined, 'text', 'search', 'url', 'email', 'hidden', 'password', 'search', 'reset', 'submit' ];\n\nfunction getUpdateDelegate ( attribute ) {\n\tvar element = attribute.element;\n\tvar name = attribute.name;\n\n\tif ( name === 'id' ) { return updateId; }\n\n\tif ( name === 'value' ) {\n\t\tif ( attribute.interpolator ) { attribute.interpolator.bound = true; }\n\n\t\t// special case - selects\n\t\tif ( element.name === 'select' && name === 'value' ) {\n\t\t\treturn element.getAttribute( 'multiple' ) ? updateMultipleSelectValue : updateSelectValue;\n\t\t}\n\n\t\tif ( element.name === 'textarea' ) { return updateStringValue; }\n\n\t\t// special case - contenteditable\n\t\tif ( element.getAttribute( 'contenteditable' ) != null ) { return updateContentEditableValue; }\n\n\t\t// special case - <input>\n\t\tif ( element.name === 'input' ) {\n\t\t\tvar type = element.getAttribute( 'type' );\n\n\t\t\t// type='file' value='{{fileList}}'>\n\t\t\tif ( type === 'file' ) { return noop; } // read-only\n\n\t\t\t// type='radio' name='{{twoway}}'\n\t\t\tif ( type === 'radio' && element.binding && element.binding.attribute.name === 'name' ) { return updateRadioValue; }\n\n\t\t\tif ( ~textTypes.indexOf( type ) ) { return updateStringValue; }\n\t\t}\n\n\t\treturn updateValue;\n\t}\n\n\tvar node = element.node;\n\n\t// special case - <input type='radio' name='{{twoway}}' value='foo'>\n\tif ( attribute.isTwoway && name === 'name' ) {\n\t\tif ( node.type === 'radio' ) { return updateRadioName; }\n\t\tif ( node.type === 'checkbox' ) { return updateCheckboxName; }\n\t}\n\n\tif ( name === 'style' ) { return updateStyleAttribute; }\n\n\tif ( name.indexOf( 'style-' ) === 0 ) { return updateInlineStyle; }\n\n\t// special case - class names. IE fucks things up, again\n\tif ( name === 'class' && ( !node.namespaceURI || node.namespaceURI === html ) ) { return updateClassName; }\n\n\tif ( name.indexOf( 'class-' ) === 0 ) { return updateInlineClass; }\n\n\tif ( attribute.isBoolean ) {\n\t\tvar type$1 = element.getAttribute( 'type' );\n\t\tif ( attribute.interpolator && name === 'checked' && ( type$1 === 'checkbox' || type$1 === 'radio' ) ) { attribute.interpolator.bound = true; }\n\t\treturn updateBoolean;\n\t}\n\n\tif ( attribute.namespace && attribute.namespace !== attribute.node.namespaceURI ) { return updateNamespacedAttribute; }\n\n\treturn updateAttribute;\n}\n\nfunction updateId ( reset ) {\n\tvar ref = this;\n\tvar node = ref.node;\n\tvar value = this.getValue();\n\n\t// remove the mapping to this node if it hasn't already been replaced\n\tif ( this.ractive.nodes[ node.id ] === node ) { delete this.ractive.nodes[ node.id ]; }\n\tif ( reset ) { return node.removeAttribute( 'id' ); }\n\n\tthis.ractive.nodes[ value ] = node;\n\n\tnode.id = value;\n}\n\nfunction updateMultipleSelectValue ( reset ) {\n\tvar value = this.getValue();\n\n\tif ( !isArray( value ) ) { value = [ value ]; }\n\n\tvar options = this.node.options;\n\tvar i = options.length;\n\n\tif ( reset ) {\n\t\twhile ( i-- ) { options[i].selected = false; }\n\t} else {\n\t\twhile ( i-- ) {\n\t\t\tvar option = options[i];\n\t\t\tvar optionValue = option._ractive ?\n\t\t\t\toption._ractive.value :\n\t\t\t\toption.value; // options inserted via a triple don't have _ractive\n\n\t\t\toption.selected = arrayContains( value, optionValue );\n\t\t}\n\t}\n}\n\nfunction updateSelectValue ( reset ) {\n\tvar value = this.getValue();\n\n\tif ( !this.locked ) { // TODO is locked still a thing?\n\t\tthis.node._ractive.value = value;\n\n\t\tvar options = this.node.options;\n\t\tvar i = options.length;\n\t\tvar wasSelected = false;\n\n\t\tif ( reset ) {\n\t\t\twhile ( i-- ) { options[i].selected = false; }\n\t\t} else {\n\t\t\twhile ( i-- ) {\n\t\t\t\tvar option = options[i];\n\t\t\t\tvar optionValue = option._ractive ?\n\t\t\t\t\toption._ractive.value :\n\t\t\t\t\toption.value; // options inserted via a triple don't have _ractive\n\t\t\t\tif ( option.disabled && option.selected ) { wasSelected = true; }\n\n\t\t\t\tif ( optionValue == value ) { // double equals as we may be comparing numbers with strings\n\t\t\t\t\toption.selected = true;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif ( !wasSelected ) { this.node.selectedIndex = -1; }\n\t}\n}\n\n\nfunction updateContentEditableValue ( reset ) {\n\tvar value = this.getValue();\n\n\tif ( !this.locked ) {\n\t\tif ( reset ) { this.node.innerHTML = ''; }\n\t\telse { this.node.innerHTML = value === undefined ? '' : value; }\n\t}\n}\n\nfunction updateRadioValue ( reset ) {\n\tvar node = this.node;\n\tvar wasChecked = node.checked;\n\n\tvar value = this.getValue();\n\n\tif ( reset ) { return node.checked = false; }\n\n\t//node.value = this.element.getAttribute( 'value' );\n\tnode.value = this.node._ractive.value = value;\n\tnode.checked = value === this.element.getAttribute( 'name' );\n\n\t// This is a special case - if the input was checked, and the value\n\t// changed so that it's no longer checked, the twoway binding is\n\t// most likely out of date. To fix it we have to jump through some\n\t// hoops... this is a little kludgy but it works\n\tif ( wasChecked && !node.checked && this.element.binding && this.element.binding.rendered ) {\n\t\tthis.element.binding.group.model.set( this.element.binding.group.getValue() );\n\t}\n}\n\nfunction updateValue ( reset ) {\n\tif ( !this.locked ) {\n\t\tif ( reset ) {\n\t\t\tthis.node.removeAttribute( 'value' );\n\t\t\tthis.node.value = this.node._ractive.value = null;\n\t\t} else {\n\t\t\tvar value = this.getValue();\n\n\t\t\tthis.node.value = this.node._ractive.value = value;\n\t\t\tthis.node.setAttribute( 'value', value );\n\t\t}\n\t}\n}\n\nfunction updateStringValue ( reset ) {\n\tif ( !this.locked ) {\n\t\tif ( reset ) {\n\t\t\tthis.node._ractive.value = '';\n\t\t\tthis.node.removeAttribute( 'value' );\n\t\t} else {\n\t\t\tvar value = this.getValue();\n\n\t\t\tthis.node._ractive.value = value;\n\n\t\t\tthis.node.value = safeToStringValue( value );\n\t\t\tthis.node.setAttribute( 'value', safeToStringValue( value ) );\n\t\t}\n\t}\n}\n\nfunction updateRadioName ( reset ) {\n\tif ( reset ) { this.node.checked = false; }\n\telse { this.node.checked = ( this.getValue() == this.node._ractive.value ); }\n}\n\nfunction updateCheckboxName ( reset ) {\n\tvar ref = this;\n\tvar element = ref.element;\n\tvar node = ref.node;\n\tvar binding = element.binding;\n\n\tvar value = this.getValue();\n\tvar valueAttribute = element.getAttribute( 'value' );\n\n\tif ( reset ) {\n\t\t// TODO: WAT?\n\t}\n\n\tif ( !isArray( value ) ) {\n\t\tbinding.isChecked = node.checked = ( value == valueAttribute );\n\t} else {\n\t\tvar i = value.length;\n\t\twhile ( i-- ) {\n\t\t\tif ( valueAttribute == value[i] ) {\n\t\t\t\tbinding.isChecked = node.checked = true;\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tbinding.isChecked = node.checked = false;\n\t}\n}\n\nfunction updateStyleAttribute ( reset ) {\n\tvar props = reset ? {} : readStyle( this.getValue() || '' );\n\tvar style = this.node.style;\n\tvar keys = Object.keys( props );\n\tvar prev = this.previous || [];\n\n\tvar i = 0;\n\twhile ( i < keys.length ) {\n\t\tif ( keys[i] in style ) { style[ keys[i] ] = props[ keys[i] ]; }\n\t\ti++;\n\t}\n\n\t// remove now-missing attrs\n\ti = prev.length;\n\twhile ( i-- ) {\n\t\tif ( !~keys.indexOf( prev[i] ) && prev[i] in style ) { style[ prev[i] ] = ''; }\n\t}\n\n\tthis.previous = keys;\n}\n\nfunction updateInlineStyle ( reset ) {\n\tif ( !this.styleName ) {\n\t\tthis.styleName = camelize( this.name.substr( 6 ) );\n\t}\n\n\tthis.node.style[ this.styleName ] = reset ? '' : this.getValue();\n}\n\nfunction updateClassName ( reset ) {\n\tvar value = reset ? [] : readClass( safeToStringValue( this.getValue() ) );\n\tvar attr = readClass( this.node.className );\n\tvar prev = this.previous || attr.slice( 0 );\n\n\tvar i = 0;\n\twhile ( i < value.length ) {\n\t\tif ( !~attr.indexOf( value[i] ) ) { attr.push( value[i] ); }\n\t\ti++;\n\t}\n\n\t// remove now-missing classes\n\ti = prev.length;\n\twhile ( i-- ) {\n\t\tif ( !~value.indexOf( prev[i] ) ) {\n\t\t\tvar idx = attr.indexOf( prev[i] );\n\t\t\tif ( ~idx ) { attr.splice( idx, 1 ); }\n\t\t}\n\t}\n\n\tvar className = attr.join( ' ' );\n\n\tif ( className !== this.node.className ) {\n\t\tthis.node.className = className;\n\t}\n\n\tthis.previous = value;\n}\n\nfunction updateInlineClass ( reset ) {\n\tvar name = this.name.substr( 6 );\n\tvar attr = readClass( this.node.className );\n\tvar value = reset ? false : this.getValue();\n\n\tif ( !this.inlineClass ) { this.inlineClass = name; }\n\n\tif ( value && !~attr.indexOf( name ) ) { attr.push( name ); }\n\telse if ( !value && ~attr.indexOf( name ) ) { attr.splice( attr.indexOf( name ), 1 ); }\n\n\tthis.node.className = attr.join( ' ' );\n}\n\nfunction updateBoolean ( reset ) {\n\t// with two-way binding, only update if the change wasn't initiated by the user\n\t// otherwise the cursor will often be sent to the wrong place\n\tif ( !this.locked ) {\n\t\tif ( reset ) {\n\t\t\tif ( this.useProperty ) { this.node[ this.propertyName ] = false; }\n\t\t\tthis.node.removeAttribute( this.propertyName );\n\t\t} else {\n\t\t\tif ( this.useProperty ) {\n\t\t\t\tthis.node[ this.propertyName ] = this.getValue();\n\t\t\t} else {\n\t\t\t\tif ( this.getValue() ) {\n\t\t\t\t\tthis.node.setAttribute( this.propertyName, '' );\n\t\t\t\t} else {\n\t\t\t\t\tthis.node.removeAttribute( this.propertyName );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction updateAttribute ( reset ) {\n\tif ( reset ) { this.node.removeAttribute( this.name ); }\n\telse { this.node.setAttribute( this.name, safeToStringValue( this.getString() ) ); }\n}\n\nfunction updateNamespacedAttribute ( reset ) {\n\tif ( reset ) { this.node.removeAttributeNS( this.namespace, this.name.slice( this.name.indexOf( ':' ) + 1 ) ); }\n\telse { this.node.setAttributeNS( this.namespace, this.name.slice( this.name.indexOf( ':' ) + 1 ), safeToStringValue( this.getString() ) ); }\n}\n\nvar propertyNames = {\n\t'accept-charset': 'acceptCharset',\n\taccesskey: 'accessKey',\n\tbgcolor: 'bgColor',\n\tclass: 'className',\n\tcodebase: 'codeBase',\n\tcolspan: 'colSpan',\n\tcontenteditable: 'contentEditable',\n\tdatetime: 'dateTime',\n\tdirname: 'dirName',\n\tfor: 'htmlFor',\n\t'http-equiv': 'httpEquiv',\n\tismap: 'isMap',\n\tmaxlength: 'maxLength',\n\tnovalidate: 'noValidate',\n\tpubdate: 'pubDate',\n\treadonly: 'readOnly',\n\trowspan: 'rowSpan',\n\ttabindex: 'tabIndex',\n\tusemap: 'useMap'\n};\n\nfunction lookupNamespace ( node, prefix ) {\n\tvar qualified = \"xmlns:\" + prefix;\n\n\twhile ( node ) {\n\t\tif ( node.hasAttribute && node.hasAttribute( qualified ) ) { return node.getAttribute( qualified ); }\n\t\tnode = node.parentNode;\n\t}\n\n\treturn namespaces[ prefix ];\n}\n\nvar Attribute = (function (Item$$1) {\n\tfunction Attribute ( options ) {\n\t\tItem$$1.call( this, options );\n\n\t\tthis.name = options.template.n;\n\t\tthis.namespace = null;\n\n\t\tthis.owner = options.owner || options.parentFragment.owner || options.element || findElement( options.parentFragment );\n\t\tthis.element = options.element || (this.owner.attributeByName ? this.owner : findElement( options.parentFragment ) );\n\t\tthis.parentFragment = options.parentFragment; // shared\n\t\tthis.ractive = this.parentFragment.ractive;\n\n\t\tthis.rendered = false;\n\t\tthis.updateDelegate = null;\n\t\tthis.fragment = null;\n\n\t\tthis.element.attributeByName[ this.name ] = this;\n\n\t\tif ( !isArray( options.template.f ) ) {\n\t\t\tthis.value = options.template.f;\n\t\t\tif ( this.value === 0 ) {\n\t\t\t\tthis.value = '';\n\t\t\t}\n\t\t} else {\n\t\t\tthis.fragment = new Fragment({\n\t\t\t\towner: this,\n\t\t\t\ttemplate: options.template.f\n\t\t\t});\n\t\t}\n\n\t\tthis.interpolator = this.fragment &&\n\t\t\tthis.fragment.items.length === 1 &&\n\t\t\tthis.fragment.items[0].type === INTERPOLATOR &&\n\t\t\tthis.fragment.items[0];\n\n\t\tif ( this.interpolator ) { this.interpolator.owner = this; }\n\t}\n\n\tif ( Item$$1 ) Attribute.__proto__ = Item$$1;\n\tAttribute.prototype = Object.create( Item$$1 && Item$$1.prototype );\n\tAttribute.prototype.constructor = Attribute;\n\n\tAttribute.prototype.bind = function bind () {\n\t\tif ( this.fragment ) {\n\t\t\tthis.fragment.bind();\n\t\t}\n\t};\n\n\tAttribute.prototype.bubble = function bubble () {\n\t\tif ( !this.dirty ) {\n\t\t\tthis.parentFragment.bubble();\n\t\t\tthis.element.bubble();\n\t\t\tthis.dirty = true;\n\t\t}\n\t};\n\n\tAttribute.prototype.destroyed = function destroyed () {\n\t\tthis.updateDelegate( true );\n\t};\n\n\tAttribute.prototype.getString = function getString () {\n\t\treturn this.fragment ?\n\t\t\tthis.fragment.toString() :\n\t\t\tthis.value != null ? '' + this.value : '';\n\t};\n\n\t// TODO could getValue ever be called for a static attribute,\n\t// or can we assume that this.fragment exists?\n\tAttribute.prototype.getValue = function getValue () {\n\t\treturn this.fragment ? this.fragment.valueOf() : booleanAttributes.test( this.name ) ? true : this.value;\n\t};\n\n\tAttribute.prototype.render = function render () {\n\t\tvar node = this.element.node;\n\t\tthis.node = node;\n\n\t\t// should we use direct property access, or setAttribute?\n\t\tif ( !node.namespaceURI || node.namespaceURI === namespaces.html ) {\n\t\t\tthis.propertyName = propertyNames[ this.name ] || this.name;\n\n\t\t\tif ( node[ this.propertyName ] !== undefined ) {\n\t\t\t\tthis.useProperty = true;\n\t\t\t}\n\n\t\t\t// is attribute a boolean attribute or 'value'? If so we're better off doing e.g.\n\t\t\t// node.selected = true rather than node.setAttribute( 'selected', '' )\n\t\t\tif ( booleanAttributes.test( this.name ) || this.isTwoway ) {\n\t\t\t\tthis.isBoolean = true;\n\t\t\t}\n\n\t\t\tif ( this.propertyName === 'value' ) {\n\t\t\t\tnode._ractive.value = this.value;\n\t\t\t}\n\t\t}\n\n\t\tif ( node.namespaceURI ) {\n\t\t\tvar index = this.name.indexOf( ':' );\n\t\t\tif ( index !== -1 ) {\n\t\t\t\tthis.namespace = lookupNamespace( node, this.name.slice( 0, index ) );\n\t\t\t} else {\n\t\t\t\tthis.namespace = node.namespaceURI;\n\t\t\t}\n\t\t}\n\n\t\tthis.rendered = true;\n\t\tthis.updateDelegate = getUpdateDelegate( this );\n\t\tthis.updateDelegate();\n\t};\n\n\tAttribute.prototype.toString = function toString () {\n\t\tvar value = this.getValue();\n\n\t\t// Special case - select and textarea values (should not be stringified)\n\t\tif ( this.name === 'value' && ( this.element.getAttribute( 'contenteditable' ) !== undefined || ( this.element.name === 'select' || this.element.name === 'textarea' ) ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Special case – bound radio `name` attributes\n\t\tif ( this.name === 'name' && this.element.name === 'input' && this.interpolator && this.element.getAttribute( 'type' ) === 'radio' ) {\n\t\t\treturn (\"name=\\\"{{\" + (this.interpolator.model.getKeypath()) + \"}}\\\"\");\n\t\t}\n\n\t\t// Special case - style and class attributes and directives\n\t\tif ( this.owner === this.element && ( this.name === 'style' || this.name === 'class' || this.styleName || this.inlineClass ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( !this.rendered && this.owner === this.element && ( !this.name.indexOf( 'style-' ) || !this.name.indexOf( 'class-' ) ) ) {\n\t\t\tif ( !this.name.indexOf( 'style-' ) ) {\n\t\t\t\tthis.styleName = camelize( this.name.substr( 6 ) );\n\t\t\t} else {\n\t\t\t\tthis.inlineClass = this.name.substr( 6 );\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tif ( booleanAttributes.test( this.name ) ) { return value ? this.name : ''; }\n\t\tif ( value == null ) { return ''; }\n\n\t\tvar str = safeAttributeString( this.getString() );\n\t\treturn str ?\n\t\t\t((this.name) + \"=\\\"\" + str + \"\\\"\") :\n\t\t\tthis.name;\n\t};\n\n\tAttribute.prototype.unbind = function unbind () {\n\t\tif ( this.fragment ) { this.fragment.unbind(); }\n\t};\n\n\tAttribute.prototype.unrender = function unrender () {\n\t\tthis.updateDelegate( true );\n\n\t\tthis.rendered = false;\n\t};\n\n\tAttribute.prototype.update = function update () {\n\t\tif ( this.dirty ) {\n\t\t\tthis.dirty = false;\n\t\t\tif ( this.fragment ) { this.fragment.update(); }\n\t\t\tif ( this.rendered ) { this.updateDelegate(); }\n\t\t\tif ( this.isTwoway && !this.locked ) {\n\t\t\t\tthis.interpolator.twowayBinding.lastVal( true, this.interpolator.model.get() );\n\t\t\t}\n\t\t}\n\t};\n\n\treturn Attribute;\n}(Item));\n\nvar BindingFlag = (function (Item$$1) {\n\tfunction BindingFlag ( options ) {\n\t\tItem$$1.call( this, options );\n\n\t\tthis.owner = options.owner || options.parentFragment.owner || findElement( options.parentFragment );\n\t\tthis.element = this.owner.attributeByName ? this.owner : findElement( options.parentFragment );\n\t\tthis.flag = options.template.v === 'l' ? 'lazy' : 'twoway';\n\n\t\tif ( this.element.type === ELEMENT ) {\n\t\t\tif ( isArray( options.template.f ) ) {\n\t\t\t\tthis.fragment = new Fragment({\n\t\t\t\t\towner: this,\n\t\t\t\t\ttemplate: options.template.f\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.interpolator = this.fragment &&\n\t\t\t\t\t\t\t\tthis.fragment.items.length === 1 &&\n\t\t\t\t\t\t\t\tthis.fragment.items[0].type === INTERPOLATOR &&\n\t\t\t\t\t\t\t\tthis.fragment.items[0];\n\t\t}\n\t}\n\n\tif ( Item$$1 ) BindingFlag.__proto__ = Item$$1;\n\tBindingFlag.prototype = Object.create( Item$$1 && Item$$1.prototype );\n\tBindingFlag.prototype.constructor = BindingFlag;\n\n\tBindingFlag.prototype.bind = function bind () {\n\t\tif ( this.fragment ) { this.fragment.bind(); }\n\t\tset$3( this, this.getValue(), true );\n\t};\n\n\tBindingFlag.prototype.bubble = function bubble () {\n\t\tif ( !this.dirty ) {\n\t\t\tthis.element.bubble();\n\t\t\tthis.dirty = true;\n\t\t}\n\t};\n\n\tBindingFlag.prototype.getValue = function getValue () {\n\t\tif ( this.fragment ) { return this.fragment.valueOf(); }\n\t\telse if ( 'value' in this ) { return this.value; }\n\t\telse if ( 'f' in this.template ) { return this.template.f; }\n\t\telse { return true; }\n\t};\n\n\tBindingFlag.prototype.render = function render () {\n\t\tset$3( this, this.getValue(), true );\n\t};\n\n\tBindingFlag.prototype.toString = function toString () { return ''; };\n\n\tBindingFlag.prototype.unbind = function unbind () {\n\t\tif ( this.fragment ) { this.fragment.unbind(); }\n\n\t\tdelete this.element[ this.flag ];\n\t};\n\n\tBindingFlag.prototype.unrender = function unrender () {\n\t\tif ( this.element.rendered ) { this.element.recreateTwowayBinding(); }\n\t};\n\n\tBindingFlag.prototype.update = function update () {\n\t\tif ( this.dirty ) {\n\t\t\tif ( this.fragment ) { this.fragment.update(); }\n\t\t\tset$3( this, this.getValue(), true );\n\t\t}\n\t};\n\n\treturn BindingFlag;\n}(Item));\n\nfunction set$3 ( flag, value, update ) {\n\tif ( value === 0 ) {\n\t\tflag.value = true;\n\t} else if ( value === 'true' ) {\n\t\tflag.value = true;\n\t} else if ( value === 'false' || value === '0' ) {\n\t\tflag.value = false;\n\t} else {\n\t\tflag.value = value;\n\t}\n\n\tvar current = flag.element[ flag.flag ];\n\tflag.element[ flag.flag ] = flag.value;\n\tif ( update && !flag.element.attributes.binding && current !== flag.value ) {\n\t\tflag.element.recreateTwowayBinding();\n\t}\n\n\treturn flag.value;\n}\n\nvar div$1 = doc ? createElement( 'div' ) : null;\n\nvar attributes = false;\nfunction inAttributes() { return attributes; }\nfunction doInAttributes( fn ) {\n\tattributes = true;\n\tfn();\n\tattributes = false;\n}\n\nvar ConditionalAttribute = (function (Item$$1) {\n\tfunction ConditionalAttribute ( options ) {\n\t\tItem$$1.call( this, options );\n\n\t\tthis.attributes = [];\n\n\t\tthis.owner = options.owner;\n\n\t\tthis.fragment = new Fragment({\n\t\t\tractive: this.ractive,\n\t\t\towner: this,\n\t\t\ttemplate: this.template\n\t\t});\n\t\t// this fragment can't participate in node-y things\n\t\tthis.fragment.findNextNode = noop;\n\n\t\tthis.dirty = false;\n\t}\n\n\tif ( Item$$1 ) ConditionalAttribute.__proto__ = Item$$1;\n\tConditionalAttribute.prototype = Object.create( Item$$1 && Item$$1.prototype );\n\tConditionalAttribute.prototype.constructor = ConditionalAttribute;\n\n\tConditionalAttribute.prototype.bind = function bind () {\n\t\tthis.fragment.bind();\n\t};\n\n\tConditionalAttribute.prototype.bubble = function bubble () {\n\t\tif ( !this.dirty ) {\n\t\t\tthis.dirty = true;\n\t\t\tthis.owner.bubble();\n\t\t}\n\t};\n\n\tConditionalAttribute.prototype.render = function render () {\n\t\tthis.node = this.owner.node;\n\t\tif ( this.node ) {\n\t\t\tthis.isSvg = this.node.namespaceURI === svg$1;\n\t\t}\n\n\t\tattributes = true;\n\t\tif ( !this.rendered ) { this.fragment.render(); }\n\t\tattributes = false;\n\n\t\tthis.rendered = true;\n\t\tthis.dirty = true; // TODO this seems hacky, but necessary for tests to pass in browser AND node.js\n\t\tthis.update();\n\t};\n\n\tConditionalAttribute.prototype.toString = function toString () {\n\t\treturn this.fragment.toString();\n\t};\n\n\tConditionalAttribute.prototype.unbind = function unbind () {\n\t\tthis.fragment.unbind();\n\t};\n\n\tConditionalAttribute.prototype.unrender = function unrender () {\n\t\tthis.rendered = false;\n\t\tthis.fragment.unrender();\n\t};\n\n\tConditionalAttribute.prototype.update = function update () {\n\t\tvar this$1 = this;\n\n\t\tvar str;\n\t\tvar attrs;\n\n\t\tif ( this.dirty ) {\n\t\t\tthis.dirty = false;\n\n\t\t\tattributes = true;\n\t\t\tthis.fragment.update();\n\t\t\tattributes = false;\n\n\t\t\tif ( this.rendered && this.node ) {\n\t\t\t\tstr = this.fragment.toString();\n\t\t\t\tattrs = parseAttributes( str, this.isSvg );\n\n\t\t\t\t// any attributes that previously existed but no longer do\n\t\t\t\t// must be removed\n\t\t\t\tthis.attributes.filter( function (a) { return notIn( attrs, a ); } ).forEach( function (a) {\n\t\t\t\t\tthis$1.node.removeAttribute( a.name );\n\t\t\t\t});\n\n\t\t\t\tattrs.forEach( function (a) {\n\t\t\t\t\tthis$1.node.setAttribute( a.name, a.value );\n\t\t\t\t});\n\n\t\t\t\tthis.attributes = attrs;\n\t\t\t}\n\t\t}\n\t};\n\n\treturn ConditionalAttribute;\n}(Item));\n\nfunction parseAttributes ( str, isSvg ) {\n\tvar tagName = isSvg ? 'svg' : 'div';\n\treturn str\n\t\t? (div$1.innerHTML = \"<\" + tagName + \" \" + str + \"></\" + tagName + \">\") &&\n\t\t\ttoArray(div$1.childNodes[0].attributes)\n\t\t: [];\n}\n\nfunction notIn ( haystack, needle ) {\n\tvar i = haystack.length;\n\n\twhile ( i-- ) {\n\t\tif ( haystack[i].name === needle.name ) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn true;\n}\n\nvar processWrapper = function ( wrapper, array, methodName, newIndices ) {\n\tvar __model = wrapper.__model;\n\n\tif ( newIndices ) {\n\t\t__model.shuffle( newIndices );\n\t} else {\n\t\t// If this is a sort or reverse, we just do root.set()...\n\t\t// TODO use merge logic?\n\t\t//root.viewmodel.mark( keypath );\n\t}\n};\n\nvar mutatorMethods = [ 'pop', 'push', 'reverse', 'shift', 'sort', 'splice', 'unshift' ];\nvar patchedArrayProto = [];\n\nmutatorMethods.forEach( function (methodName) {\n\tvar method = function () {\n\t\tvar this$1 = this;\n\t\tvar args = [], len = arguments.length;\n\t\twhile ( len-- ) args[ len ] = arguments[ len ];\n\n\t\tvar newIndices = getNewIndices( this.length, methodName, args );\n\n\t\t// lock any magic array wrappers, so that things don't get fudged\n\t\tthis._ractive.wrappers.forEach( function (r) { if ( r.magic ) { r.magic.locked = true; } } );\n\n\t\t// apply the underlying method\n\t\tvar result = Array.prototype[ methodName ].apply( this, arguments );\n\n\t\t// trigger changes\n\t\trunloop.start();\n\n\t\tthis._ractive.setting = true;\n\t\tvar i = this._ractive.wrappers.length;\n\t\twhile ( i-- ) {\n\t\t\tprocessWrapper( this$1._ractive.wrappers[i], this$1, methodName, newIndices );\n\t\t}\n\n\t\trunloop.end();\n\n\t\tthis._ractive.setting = false;\n\n\t\t// unlock the magic arrays... magic... bah\n\t\tthis._ractive.wrappers.forEach( function (r) { if ( r.magic ) { r.magic.locked = false; } } );\n\n\t\treturn result;\n\t};\n\n\tdefineProperty( patchedArrayProto, methodName, {\n\t\tvalue: method,\n\t\tconfigurable: true\n\t});\n});\n\nvar patchArrayMethods;\nvar unpatchArrayMethods;\n\n// can we use prototype chain injection?\n// http://perfectionkills.com/how-ecmascript-5-still-does-not-allow-to-subclass-an-array/#wrappers_prototype_chain_injection\nif ( ({}).__proto__ ) {\n\t// yes, we can\n\tpatchArrayMethods = function (array) { return array.__proto__ = patchedArrayProto; };\n\tunpatchArrayMethods = function (array) { return array.__proto__ = Array.prototype; };\n}\n\nelse {\n\t// no, we can't\n\tpatchArrayMethods = function (array) {\n\t\tvar i = mutatorMethods.length;\n\t\twhile ( i-- ) {\n\t\t\tvar methodName = mutatorMethods[i];\n\t\t\tdefineProperty( array, methodName, {\n\t\t\t\tvalue: patchedArrayProto[ methodName ],\n\t\t\t\tconfigurable: true\n\t\t\t});\n\t\t}\n\t};\n\n\tunpatchArrayMethods = function (array) {\n\t\tvar i = mutatorMethods.length;\n\t\twhile ( i-- ) {\n\t\t\tdelete array[ mutatorMethods[i] ];\n\t\t}\n\t};\n}\n\npatchArrayMethods.unpatch = unpatchArrayMethods; // TODO export separately?\nvar patch = patchArrayMethods;\n\nvar errorMessage$1 = 'Something went wrong in a rather interesting way';\n\nvar arrayAdaptor = {\n\tfilter: function filter ( object ) {\n\t\t// wrap the array if a) b) it's an array, and b) either it hasn't been wrapped already,\n\t\t// or the array didn't trigger the get() itself\n\t\treturn isArray( object ) && ( !object._ractive || !object._ractive.setting );\n\t},\n\twrap: function wrap ( ractive, array, keypath ) {\n\t\treturn new ArrayWrapper( ractive, array, keypath );\n\t}\n};\n\nvar ArrayWrapper = function ArrayWrapper ( ractive, array ) {\n\tthis.root = ractive;\n\tthis.value = array;\n\tthis.__model = null; // filled in later\n\n\t// if this array hasn't already been ractified, ractify it\n\tif ( !array._ractive ) {\n\t\t// define a non-enumerable _ractive property to store the wrappers\n\t\tdefineProperty( array, '_ractive', {\n\t\t\tvalue: {\n\t\t\t\twrappers: [],\n\t\t\t\tinstances: [],\n\t\t\t\tsetting: false\n\t\t\t},\n\t\t\tconfigurable: true\n\t\t});\n\n\t\tpatch( array );\n\t}\n\n\t// store the ractive instance, so we can handle transitions later\n\tif ( !array._ractive.instances[ ractive._guid ] ) {\n\t\tarray._ractive.instances[ ractive._guid ] = 0;\n\t\tarray._ractive.instances.push( ractive );\n\t}\n\n\tarray._ractive.instances[ ractive._guid ] += 1;\n\tarray._ractive.wrappers.push( this );\n};\n\nArrayWrapper.prototype.get = function get () {\n\treturn this.value;\n};\n\nArrayWrapper.prototype.reset = function reset ( value ) {\n\treturn this.value === value;\n};\n\nArrayWrapper.prototype.teardown = function teardown () {\n\tvar array = this.value;\n\tvar storage = array._ractive;\n\tvar wrappers = storage.wrappers;\n\tvar instances = storage.instances;\n\n\t// if teardown() was invoked because we're clearing the cache as a result of\n\t// a change that the array itself triggered, we can save ourselves the teardown\n\t// and immediate setup\n\tif ( storage.setting ) {\n\t\treturn false; // so that we don't remove it from cached wrappers\n\t}\n\n\tvar index = wrappers.indexOf( this );\n\tif ( index === -1 ) {\n\t\tthrow new Error( errorMessage$1 );\n\t}\n\n\twrappers.splice( index, 1 );\n\n\t// if nothing else depends on this array, we can revert it to its\n\t// natural state\n\tif ( !wrappers.length ) {\n\t\tdelete array._ractive;\n\t\tpatch.unpatch( this.value );\n\t}\n\n\telse {\n\t\t// remove ractive instance if possible\n\t\tinstances[ this.root._guid ] -= 1;\n\t\tif ( !instances[ this.root._guid ] ) {\n\t\t\tindex = instances.indexOf( this.root );\n\n\t\t\tif ( index === -1 ) {\n\t\t\t\tthrow new Error( errorMessage$1 );\n\t\t\t}\n\n\t\t\tinstances.splice( index, 1 );\n\t\t}\n\t}\n};\n\nvar magicAdaptor;\n\ntry {\n\tObject.defineProperty({}, 'test', { get: function get() {}, set: function set() {} });\n\n\tmagicAdaptor = {\n\t\tfilter: function filter ( value ) {\n\t\t\treturn value && typeof value === 'object';\n\t\t},\n\t\twrap: function wrap ( ractive, value, keypath ) {\n\t\t\treturn new MagicWrapper( ractive, value, keypath );\n\t\t}\n\t};\n} catch ( err ) {\n\tmagicAdaptor = false;\n}\n\nvar magicAdaptor$1 = magicAdaptor;\n\nfunction createOrWrapDescriptor ( originalDescriptor, ractive, keypath, wrapper ) {\n\tif ( originalDescriptor.set && originalDescriptor.set.__magic ) {\n\t\toriginalDescriptor.set.__magic.dependants.push({ ractive: ractive, keypath: keypath });\n\t\treturn originalDescriptor;\n\t}\n\n\tvar setting;\n\n\tvar dependants = [{ ractive: ractive, keypath: keypath }];\n\n\tvar descriptor = {\n\t\tget: function get () {\n\t\t\treturn 'value' in originalDescriptor ? originalDescriptor.value : originalDescriptor.get.call( this );\n\t\t},\n\t\tset: function set (value) {\n\t\t\tif ( setting ) { return; }\n\n\t\t\tif ( 'value' in originalDescriptor ) {\n\t\t\t\toriginalDescriptor.value = value;\n\t\t\t} else {\n\t\t\t\toriginalDescriptor.set.call( this, value );\n\t\t\t}\n\n\t\t\tif ( wrapper.locked ) { return; }\n\t\t\tsetting = true;\n\t\t\tdependants.forEach( function (ref) {\n\t\t\t\tvar ractive = ref.ractive;\n\t\t\t\tvar keypath = ref.keypath;\n\n\t\t\t\tractive.set( keypath, value );\n\t\t\t});\n\t\t\tsetting = false;\n\t\t},\n\t\tenumerable: true\n\t};\n\n\tdescriptor.set.__magic = { dependants: dependants, originalDescriptor: originalDescriptor };\n\n\treturn descriptor;\n}\n\nfunction revert ( descriptor, ractive, keypath ) {\n\tif ( !descriptor.set || !descriptor.set.__magic ) { return true; }\n\n\tvar dependants = descriptor.set.__magic;\n\tvar i = dependants.length;\n\twhile ( i-- ) {\n\t\tvar dependant = dependants[i];\n\t\tif ( dependant.ractive === ractive && dependant.keypath === keypath ) {\n\t\t\tdependants.splice( i, 1 );\n\t\t\treturn false;\n\t\t}\n\t}\n}\n\nvar MagicWrapper = function MagicWrapper ( ractive, value, keypath ) {\n\tvar this$1 = this;\n\n\tthis.ractive = ractive;\n\tthis.value = value;\n\tthis.keypath = keypath;\n\n\tthis.originalDescriptors = {};\n\n\t// wrap all properties with getters\n\tObject.keys( value ).forEach( function (key) {\n\t\tvar originalDescriptor = Object.getOwnPropertyDescriptor( this$1.value, key );\n\t\tthis$1.originalDescriptors[ key ] = originalDescriptor;\n\n\t\tvar childKeypath = keypath ? (keypath + \".\" + (escapeKey( key ))) : escapeKey( key );\n\n\t\tvar descriptor = createOrWrapDescriptor( originalDescriptor, ractive, childKeypath, this$1 );\n\n\n\n\t\tObject.defineProperty( this$1.value, key, descriptor );\n\t});\n};\n\nMagicWrapper.prototype.get = function get () {\n\treturn this.value;\n};\n\nMagicWrapper.prototype.reset = function reset ( value ) {\n\treturn this.value === value;\n};\n\nMagicWrapper.prototype.set = function set ( key, value ) {\n\tthis.value[ key ] = value;\n};\n\nMagicWrapper.prototype.teardown = function teardown () {\n\t\tvar this$1 = this;\n\n\tObject.keys( this.value ).forEach( function (key) {\n\t\tvar descriptor = Object.getOwnPropertyDescriptor( this$1.value, key );\n\t\tif ( !descriptor.set || !descriptor.set.__magic ) { return; }\n\n\t\trevert( descriptor );\n\n\t\tif ( descriptor.set.__magic.dependants.length === 1 ) {\n\t\t\tObject.defineProperty( this$1.value, key, descriptor.set.__magic.originalDescriptor );\n\t\t}\n\t});\n};\n\nvar MagicArrayWrapper = function MagicArrayWrapper ( ractive, array, keypath ) {\n\tthis.value = array;\n\n\tthis.magic = true;\n\n\tthis.magicWrapper = magicAdaptor$1.wrap( ractive, array, keypath );\n\tthis.arrayWrapper = arrayAdaptor.wrap( ractive, array, keypath );\n\tthis.arrayWrapper.magic = this.magicWrapper;\n\n\t// ugh, this really is a terrible hack\n\tObject.defineProperty( this, '__model', {\n\t\tget: function get () {\n\t\t\treturn this.arrayWrapper.__model;\n\t\t},\n\t\tset: function set ( model ) {\n\t\t\tthis.arrayWrapper.__model = model;\n\t\t}\n\t});\n};\n\nMagicArrayWrapper.prototype.get = function get () {\n\treturn this.value;\n};\n\nMagicArrayWrapper.prototype.teardown = function teardown () {\n\tthis.arrayWrapper.teardown();\n\tthis.magicWrapper.teardown();\n};\n\nMagicArrayWrapper.prototype.reset = function reset ( value ) {\n\treturn this.arrayWrapper.reset( value ) && this.magicWrapper.reset( value );\n};\n\nvar magicArrayAdaptor = {\n\tfilter: function filter ( object, keypath, ractive ) {\n\t\treturn magicAdaptor$1.filter( object, keypath, ractive ) && arrayAdaptor.filter( object );\n\t},\n\n\twrap: function wrap ( ractive, array, keypath ) {\n\t\treturn new MagicArrayWrapper( ractive, array, keypath );\n\t}\n};\n\nvar RactiveModel = (function (Model$$1) {\n\tfunction RactiveModel ( ractive ) {\n\t\tModel$$1.call( this, null, '' );\n\t\tthis.value = ractive;\n\t\tthis.isRoot = true;\n\t\tthis.root = this;\n\t\tthis.adaptors = [];\n\t\tthis.ractive = ractive;\n\t\tthis.changes = {};\n\t}\n\n\tif ( Model$$1 ) RactiveModel.__proto__ = Model$$1;\n\tRactiveModel.prototype = Object.create( Model$$1 && Model$$1.prototype );\n\tRactiveModel.prototype.constructor = RactiveModel;\n\n\tRactiveModel.prototype.joinKey = function joinKey ( key ) {\n\t\tvar model = Model$$1.prototype.joinKey.call( this, key );\n\n\t\tif ( ( key === 'root' || key === 'parent' ) && !model.isLink ) { return initLink( model, key ); }\n\t\telse if ( key === 'data' ) { return this.ractive.viewmodel; }\n\n\t\treturn model;\n\t};\n\n\tRactiveModel.prototype.getKeypath = function getKeypath () {\n\t\treturn '@this';\n\t};\n\n\tRactiveModel.prototype.retrieve = function retrieve () {\n\t\treturn this.ractive;\n\t};\n\n\treturn RactiveModel;\n}(Model));\n\nfunction initLink ( model, key ) {\n\tmodel.applyValue = function ( value ) {\n\t\tthis.parent.value[ key ] = value;\n\t\tif ( value && value.viewmodel ) {\n\t\t\tthis.link( value.viewmodel.getRactiveModel(), key );\n\t\t\tthis._link.markedAll();\n\t\t} else {\n\t\t\tthis.link( Object.create( Missing ), key );\n\t\t\tthis._link.markedAll();\n\t\t}\n\t};\n\n\tmodel.applyValue( model.parent.ractive[ key ], key );\n\tmodel._link.set = function (v) { return model.applyValue( v ); };\n\tmodel._link.applyValue = function (v) { return model.applyValue( v ); };\n\treturn model._link;\n}\n\nvar hasProp$1 = Object.prototype.hasOwnProperty;\n\nvar RootModel = (function (Model$$1) {\n\tfunction RootModel ( options ) {\n\t\tModel$$1.call( this, null, null );\n\n\t\t// TODO deprecate this\n\t\tthis.changes = {};\n\n\t\tthis.isRoot = true;\n\t\tthis.root = this;\n\t\tthis.ractive = options.ractive; // TODO sever this link\n\n\t\tthis.value = options.data;\n\t\tthis.adaptors = options.adapt;\n\t\tthis.adapt();\n\n\t\tthis.computationContext = options.ractive;\n\t\tthis.computations = {};\n\t}\n\n\tif ( Model$$1 ) RootModel.__proto__ = Model$$1;\n\tRootModel.prototype = Object.create( Model$$1 && Model$$1.prototype );\n\tRootModel.prototype.constructor = RootModel;\n\n\tRootModel.prototype.applyChanges = function applyChanges () {\n\t\tthis._changeHash = {};\n\t\tthis.flush();\n\n\t\treturn this._changeHash;\n\t};\n\n\tRootModel.prototype.attached = function attached ( fragment ) {\n\t\tattachImplicits( this, fragment );\n\t};\n\n\tRootModel.prototype.compute = function compute ( key, signature ) {\n\t\tvar computation = new Computation( this, signature, key );\n\t\tthis.computations[ key ] = computation;\n\n\t\treturn computation;\n\t};\n\n\tRootModel.prototype.createLink = function createLink ( keypath, target, targetPath, options ) {\n\t\tvar this$1 = this;\n\n\t\tvar keys = splitKeypath( keypath );\n\n\t\tvar model = this;\n\t\twhile ( keys.length ) {\n\t\t\tvar key = keys.shift();\n\t\t\tmodel = this$1.childByKey[ key ] || this$1.joinKey( key );\n\t\t}\n\n\t\treturn model.link( target, targetPath, options );\n\t};\n\n\tRootModel.prototype.detached = function detached () {\n\t\tdetachImplicits( this );\n\t};\n\n\tRootModel.prototype.get = function get ( shouldCapture, options ) {\n\t\tvar this$1 = this;\n\n\t\tif ( shouldCapture ) { capture( this ); }\n\n\t\tif ( !options || options.virtual !== false ) {\n\t\t\tvar result = this.getVirtual();\n\t\t\tvar keys = Object.keys( this.computations );\n\t\t\tvar i = keys.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tresult[ keys[i] ] = this$1.computations[ keys[i] ].get();\n\t\t\t}\n\n\t\t\treturn result;\n\t\t} else {\n\t\t\treturn this.value;\n\t\t}\n\t};\n\n\tRootModel.prototype.getKeypath = function getKeypath () {\n\t\treturn '';\n\t};\n\n\tRootModel.prototype.getRactiveModel = function getRactiveModel () {\n\t\treturn this.ractiveModel || ( this.ractiveModel = new RactiveModel( this.ractive ) );\n\t};\n\n\tRootModel.prototype.getValueChildren = function getValueChildren () {\n\t\tvar this$1 = this;\n\n\t\tvar children = Model$$1.prototype.getValueChildren.call( this, this.value );\n\n\t\tthis.children.forEach( function (child) {\n\t\t\tif ( child._link ) {\n\t\t\t\tvar idx = children.indexOf( child );\n\t\t\t\tif ( ~idx ) { children.splice( idx, 1, child._link ); }\n\t\t\t\telse { children.push( child._link ); }\n\t\t\t}\n\t\t});\n\n\t\tfor ( var k in this.computations ) {\n\t\t\tchildren.push( this$1.computations[k] );\n\t\t}\n\n\t\treturn children;\n\t};\n\n\tRootModel.prototype.handleChange = function handleChange$1 () {\n\t\tthis.deps.forEach( handleChange$1$1 );\n\t};\n\n\tRootModel.prototype.has = function has ( key ) {\n\t\tvar value = this.value;\n\n\t\tkey = unescapeKey( key );\n\t\tif ( key === '@this' || key === '@global' || key === '@shared' ) { return true; }\n\t\tif ( key[0] === '~' && key[1] === '/' ) { key = key.slice( 2 ); }\n\t\tif ( hasProp$1.call( value, key ) ) { return true; }\n\n\t\t// mappings/links and computations\n\t\tif ( key in this.computations || this.childByKey[key] && this.childByKey[key]._link ) { return true; }\n\n\t\t// We climb up the constructor chain to find if one of them contains the key\n\t\tvar constructor = value.constructor;\n\t\twhile ( constructor !== Function && constructor !== Array && constructor !== Object ) {\n\t\t\tif ( hasProp$1.call( constructor.prototype, key ) ) { return true; }\n\t\t\tconstructor = constructor.constructor;\n\t\t}\n\n\t\treturn false;\n\t};\n\n\tRootModel.prototype.joinKey = function joinKey ( key, opts ) {\n\t\tif ( key[0] === '@' ) {\n\t\t\tif ( key === '@this' || key === '@' ) { return this.getRactiveModel(); }\n\t\t\tif ( key === '@global' ) { return GlobalModel; }\n\t\t\tif ( key === '@shared' ) { return SharedModel$1; }\n\t\t\treturn;\n\t\t}\n\n\t\tif ( key[0] === '~' && key[1] === '/' ) { key = key.slice( 2 ); }\n\n\t\treturn this.computations.hasOwnProperty( key ) ? this.computations[ key ] :\n\t\t       Model$$1.prototype.joinKey.call( this, key, opts );\n\t};\n\n\t// TODO: this should go away\n\tRootModel.prototype.map = function map ( localKey, origin, options ) {\n\t\tvar local = this.joinKey( localKey );\n\t\tlocal.link( origin, localKey, options );\n\t};\n\n\tRootModel.prototype.rebinding = function rebinding () {\n\t};\n\n\tRootModel.prototype.set = function set ( value ) {\n\t\t// TODO wrapping root node is a baaaad idea. We should prevent this\n\t\tvar wrapper = this.wrapper;\n\t\tif ( wrapper ) {\n\t\t\tvar shouldTeardown = !wrapper.reset || wrapper.reset( value ) === false;\n\n\t\t\tif ( shouldTeardown ) {\n\t\t\t\twrapper.teardown();\n\t\t\t\tthis.wrapper = null;\n\t\t\t\tthis.value = value;\n\t\t\t\tthis.adapt();\n\t\t\t}\n\t\t} else {\n\t\t\tthis.value = value;\n\t\t\tthis.adapt();\n\t\t}\n\n\t\tthis.deps.forEach( handleChange$1$1 );\n\t\tthis.children.forEach( mark$1$1 );\n\t\tthis.clearUnresolveds(); // TODO do we need to do this with primitive values? if not, what about e.g. unresolved `length` property of null -> string?\n\t};\n\n\tRootModel.prototype.retrieve = function retrieve () {\n\t\treturn this.wrapper ? this.wrapper.get() : this.value;\n\t};\n\n\tRootModel.prototype.update = function update () {\n\t\t// noop\n\t};\n\n\treturn RootModel;\n}(Model));\n\nfunction attachImplicits ( model, fragment ) {\n\tif ( model._link && model._link.implicit && model._link.isDetached() ) {\n\t\tmodel.attach( fragment );\n\t}\n\n\t// look for unresolveds\n\tvar i = model.unresolved.length;\n\twhile ( i-- ) {\n\t\tvar mdl = resolveReference( fragment, model.unresolved[i] );\n\t\tif ( mdl ) {\n\t\t\tmodel.joinKey( mdl.key ).link( mdl, mdl.key, { implicit: true } );\n\t\t}\n\t}\n\n\t// look for virtual children to relink and cascade\n\tfor ( var k in model.childByKey ) {\n\t\tif ( k in model.value ) {\n\t\t\tattachImplicits( model.childByKey[k], fragment );\n\t\t} else if ( !model.childByKey[k]._link || model.childByKey[k]._link.isDetached() ) {\n\t\t\tvar mdl$1 = resolveReference( fragment, k );\n\t\t\tif ( mdl$1 ) {\n\t\t\t\tmodel.childByKey[k].link( mdl$1, k, { implicit: true } );\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction detachImplicits ( model ) {\n\tif ( model._link && model._link.implicit ) {\n\t\tmodel.unlink();\n\t}\n\n\tfor ( var k in model.childByKey ) {\n\t\tdetachImplicits( model.childByKey[k] );\n\t}\n}\n\nfunction getComputationSignature ( ractive, key, signature ) {\n\tvar getter;\n\tvar setter;\n\n\t// useful for debugging\n\tvar getterString;\n\tvar getterUseStack;\n\tvar setterString;\n\n\tif ( typeof signature === 'function' ) {\n\t\tgetter = bind$2( signature, ractive );\n\t\tgetterString = signature.toString();\n\t\tgetterUseStack = true;\n\t}\n\n\tif ( typeof signature === 'string' ) {\n\t\tgetter = createFunctionFromString( signature, ractive );\n\t\tgetterString = signature;\n\t}\n\n\tif ( typeof signature === 'object' ) {\n\t\tif ( typeof signature.get === 'string' ) {\n\t\t\tgetter = createFunctionFromString( signature.get, ractive );\n\t\t\tgetterString = signature.get;\n\t\t} else if ( typeof signature.get === 'function' ) {\n\t\t\tgetter = bind$2( signature.get, ractive );\n\t\t\tgetterString = signature.get.toString();\n\t\t\tgetterUseStack = true;\n\t\t} else {\n\t\t\tfatal( '`%s` computation must have a `get()` method', key );\n\t\t}\n\n\t\tif ( typeof signature.set === 'function' ) {\n\t\t\tsetter = bind$2( signature.set, ractive );\n\t\t\tsetterString = signature.set.toString();\n\t\t}\n\t}\n\n\treturn {\n\t\tgetter: getter,\n\t\tsetter: setter,\n\t\tgetterString: getterString,\n\t\tsetterString: setterString,\n\t\tgetterUseStack: getterUseStack\n\t};\n}\n\nvar constructHook = new Hook( 'construct' );\n\nvar registryNames$1 = [\n\t'adaptors',\n\t'components',\n\t'decorators',\n\t'easing',\n\t'events',\n\t'interpolators',\n\t'partials',\n\t'transitions'\n];\n\nvar uid = 0;\n\nfunction construct ( ractive, options ) {\n\tif ( Ractive.DEBUG ) { welcome(); }\n\n\tinitialiseProperties( ractive );\n\n\t// TODO don't allow `onconstruct` with `new Ractive()`, there's no need for it\n\tconstructHook.fire( ractive, options );\n\n\t// Add registries\n\tregistryNames$1.forEach( function (name) {\n\t\tractive[ name ] = extend$1( create( ractive.constructor[ name ] || null ), options[ name ] );\n\t});\n\n\t// Create a viewmodel\n\tvar viewmodel = new RootModel({\n\t\tadapt: getAdaptors( ractive, ractive.adapt, options ),\n\t\tdata: dataConfigurator.init( ractive.constructor, ractive, options ),\n\t\tractive: ractive\n\t});\n\n\tractive.viewmodel = viewmodel;\n\n\t// Add computed properties\n\tvar computed = extend$1( create( ractive.constructor.prototype.computed ), options.computed );\n\n\tfor ( var key in computed ) {\n\t\tvar signature = getComputationSignature( ractive, key, computed[ key ] );\n\t\tviewmodel.compute( key, signature );\n\t}\n}\n\nfunction getAdaptors ( ractive, protoAdapt, options ) {\n\tprotoAdapt = protoAdapt.map( lookup );\n\tvar adapt = ensureArray( options.adapt ).map( lookup );\n\n\tvar builtins = [];\n\tvar srcs = [ protoAdapt, adapt ];\n\tif ( ractive.parent && !ractive.isolated ) {\n\t\tsrcs.push( ractive.parent.viewmodel.adaptors );\n\t}\n\tsrcs.push( builtins );\n\n\tvar magic$$1 = 'magic' in options ? options.magic : ractive.magic;\n\tvar modifyArrays = 'modifyArrays' in options ? options.modifyArrays : ractive.modifyArrays;\n\n\tif ( magic$$1 ) {\n\t\tif ( !magic ) {\n\t\t\tthrow new Error( 'Getters and setters (magic mode) are not supported in this browser' );\n\t\t}\n\n\t\tif ( modifyArrays ) {\n\t\t\tbuiltins.push( magicArrayAdaptor );\n\t\t}\n\n\t\tbuiltins.push( magicAdaptor$1 );\n\t}\n\n\tif ( modifyArrays ) {\n\t\tbuiltins.push( arrayAdaptor );\n\t}\n\n\treturn combine.apply( null, srcs );\n\n\n\tfunction lookup ( adaptor ) {\n\t\tif ( typeof adaptor === 'string' ) {\n\t\t\tadaptor = findInViewHierarchy( 'adaptors', ractive, adaptor );\n\n\t\t\tif ( !adaptor ) {\n\t\t\t\tfatal( missingPlugin( adaptor, 'adaptor' ) );\n\t\t\t}\n\t\t}\n\n\t\treturn adaptor;\n\t}\n}\n\nfunction initialiseProperties ( ractive ) {\n\t// Generate a unique identifier, for places where you'd use a weak map if it\n\t// existed\n\tractive._guid = 'r-' + uid++;\n\n\t// events\n\tractive._subs = create( null );\n\n\t// storage for item configuration from instantiation to reset,\n\t// like dynamic functions or original values\n\tractive._config = {};\n\n\t// nodes registry\n\tractive.nodes = {};\n\n\t// events\n\tractive.event = null;\n\tractive._eventQueue = [];\n\n\t// live queries\n\tractive._liveQueries = [];\n\tractive._liveComponentQueries = [];\n\n\t// observers\n\tractive._observers = [];\n\n\t// external children\n\tractive._children = [];\n\tractive._children.byName = {};\n\tractive.children = ractive._children;\n\n\tif ( !ractive.component ) {\n\t\tractive.root = ractive;\n\t\tractive.parent = ractive.container = null; // TODO container still applicable?\n\t}\n}\n\nvar teardownHook = new Hook( 'teardown' );\nvar destructHook = new Hook( 'destruct' );\n\n// Teardown. This goes through the root fragment and all its children, removing observers\n// and generally cleaning up after itself\n\nfunction Ractive$teardown () {\n\tvar this$1 = this;\n\n\tif ( this.torndown ) {\n\t\twarnIfDebug( 'ractive.teardown() was called on a Ractive instance that was already torn down' );\n\t\treturn Promise$1.resolve();\n\t}\n\n\tthis.shouldDestroy = true;\n\treturn teardown$2( this, function () { return this$1.fragment.rendered ? this$1.unrender() : Promise$1.resolve(); } );\n}\n\nfunction teardown$2 ( instance, getPromise ) {\n\tinstance.torndown = true;\n\tinstance.viewmodel.teardown();\n\tinstance.fragment.unbind();\n\tinstance._observers.slice().forEach( cancel$1 );\n\n\tif ( instance.fragment.rendered && instance.el.__ractive_instances__ ) {\n\t\tremoveFromArray( instance.el.__ractive_instances__, instance );\n\t}\n\n\tvar promise = getPromise();\n\n\tteardownHook.fire( instance );\n\tpromise.then( function () { return destructHook.fire( instance ); } );\n\n\treturn promise;\n}\n\nfunction makeDirty$1 ( query ) {\n\tquery.makeDirty();\n}\n\nvar Component = (function (Item$$1) {\n\tfunction Component ( options, ComponentConstructor ) {\n\t\tvar this$1 = this;\n\n\t\tItem$$1.call( this, options );\n\t\tthis.isAnchor = this.template.t === ANCHOR;\n\t\tthis.type = this.isAnchor ? ANCHOR : COMPONENT; // override ELEMENT from super\n\n\t\tvar partials = options.template.p || {};\n\t\tif ( !( 'content' in partials ) ) { partials.content = options.template.f || []; }\n\t\tthis._partials = partials; // TEMP\n\n\t\tif ( this.isAnchor ) {\n\t\t\tthis.name = options.template.n;\n\n\t\t\tthis.addChild = addChild$1;\n\t\t\tthis.removeChild = removeChild$1;\n\t\t} else {\n\t\t\tvar instance = create( ComponentConstructor.prototype );\n\n\t\t\tthis.instance = instance;\n\t\t\tthis.name = options.template.e;\n\n\t\t\tif ( instance.el ) {\n\t\t\t\twarnIfDebug( (\"The <\" + (this.name) + \"> component has a default 'el' property; it has been disregarded\") );\n\t\t\t}\n\n\t\t\tthis.liveQueries = [];\n\n\t\t\t// find container\n\t\t\tvar fragment = options.parentFragment;\n\t\t\tvar container;\n\t\t\twhile ( fragment ) {\n\t\t\t\tif ( fragment.owner.type === YIELDER ) {\n\t\t\t\t\tcontainer = fragment.owner.container;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tfragment = fragment.parent;\n\t\t\t}\n\n\t\t\t// add component-instance-specific properties\n\t\t\tinstance.parent = this.parentFragment.ractive;\n\t\t\tinstance.container = container || null;\n\t\t\tinstance.root = instance.parent.root;\n\t\t\tinstance.component = this;\n\n\t\t\tconstruct( this.instance, { partials: partials });\n\n\t\t\t// for hackability, this could be an open option\n\t\t\t// for any ractive instance, but for now, just\n\t\t\t// for components and just for ractive...\n\t\t\tinstance._inlinePartials = partials;\n\t\t}\n\n\t\tthis.attributeByName = {};\n\n\t\tthis.events = [];\n\t\tthis.attributes = [];\n\t\tvar leftovers = [];\n\t\t( this.template.m || [] ).forEach( function (template) {\n\t\t\tswitch ( template.t ) {\n\t\t\t\tcase ATTRIBUTE:\n\t\t\t\tcase EVENT:\n\t\t\t\t\tthis$1.attributes.push( createItem({\n\t\t\t\t\t\towner: this$1,\n\t\t\t\t\t\tparentFragment: this$1.parentFragment,\n\t\t\t\t\t\ttemplate: template\n\t\t\t\t\t}) );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase TRANSITION:\n\t\t\t\tcase BINDING_FLAG:\n\t\t\t\tcase DECORATOR:\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tleftovers.push( template );\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\n\t\tif ( leftovers.length ) {\n\t\t\tthis.attributes.push( new ConditionalAttribute({\n\t\t\t\towner: this,\n\t\t\t\tparentFragment: this.parentFragment,\n\t\t\t\ttemplate: leftovers\n\t\t\t}) );\n\t\t}\n\n\t\tthis.eventHandlers = [];\n\t}\n\n\tif ( Item$$1 ) Component.__proto__ = Item$$1;\n\tComponent.prototype = Object.create( Item$$1 && Item$$1.prototype );\n\tComponent.prototype.constructor = Component;\n\n\tComponent.prototype.bind = function bind$1 () {\n\t\tif ( !this.isAnchor ) {\n\t\t\tthis.attributes.forEach( bind$1$1 );\n\n\t\t\tinitialise( this.instance, {\n\t\t\t\tpartials: this._partials\n\t\t\t}, {\n\t\t\t\tcssIds: this.parentFragment.cssIds\n\t\t\t});\n\n\t\t\tthis.eventHandlers.forEach( bind$1$1 );\n\n\t\t\tthis.bound = true;\n\t\t}\n\t};\n\n\tComponent.prototype.bubble = function bubble () {\n\t\tif ( !this.dirty ) {\n\t\t\tthis.dirty = true;\n\t\t\tthis.parentFragment.bubble();\n\t\t}\n\t};\n\n\tComponent.prototype.destroyed = function destroyed () {\n\t\tif ( !this.isAnchor && this.instance.fragment ) { this.instance.fragment.destroyed(); }\n\t};\n\n\tComponent.prototype.detach = function detach () {\n\t\tif ( this.isAnchor ) {\n\t\t\tif ( this.instance ) { return this.instance.fragment.detach(); }\n\t\t\treturn createDocumentFragment();\n\t\t}\n\n\t\treturn this.instance.fragment.detach();\n\t};\n\n\tComponent.prototype.find = function find ( selector, options ) {\n\t\tif ( this.instance ) { return this.instance.fragment.find( selector, options ); }\n\t};\n\n\tComponent.prototype.findAll = function findAll ( selector, query ) {\n\t\tif ( this.instance ) { this.instance.fragment.findAll( selector, query ); }\n\t};\n\n\tComponent.prototype.findComponent = function findComponent ( name, options ) {\n\t\tif ( !name || this.name === name ) { return this.instance; }\n\n\t\tif ( this.instance.fragment ) {\n\t\t\treturn this.instance.fragment.findComponent( name, options );\n\t\t}\n\t};\n\n\tComponent.prototype.findAllComponents = function findAllComponents ( name, query ) {\n\t\tif ( this.instance && query.test( this ) ) {\n\t\t\tquery.add( this.instance );\n\n\t\t\tif ( query.live ) {\n\t\t\t\tthis.liveQueries.push( query );\n\t\t\t}\n\t\t}\n\n\t\tif ( this.instance ) { this.instance.findAllComponents( name, { _query: query } ); }\n\t};\n\n\tComponent.prototype.firstNode = function firstNode ( skipParent ) {\n\t\tif ( this.instance ) { return this.instance.fragment.firstNode( skipParent ); }\n\t};\n\n\tComponent.prototype.removeFromQuery = function removeFromQuery ( query ) {\n\t\tif ( this.instance ) { query.remove( this.instance ); }\n\t\tremoveFromArray( this.liveQueries, query );\n\t};\n\n\tComponent.prototype.render = function render$1 ( target, occupants ) {\n\t\tif ( this.isAnchor ) {\n\t\t\tthis.target = target;\n\t\t\tif ( !checking.length ) {\n\t\t\t\tchecking.push( this.ractive );\n\t\t\t\trunloop.scheduleTask( checkAnchors, true );\n\t\t\t}\n\t\t} else {\n\t\t\trender$2( this.instance, target, null, occupants );\n\n\t\t\tthis.attributes.forEach( render$1$1 );\n\t\t\tthis.eventHandlers.forEach( render$1$1 );\n\t\t\tupdateLiveQueries$1( this );\n\t\t}\n\t\tthis.rendered = true;\n\t};\n\n\tComponent.prototype.shuffled = function shuffled () {\n\t\tif ( this.instance ) { this.liveQueries.forEach( makeDirty$1 ); }\n\t\tItem$$1.prototype.shuffled.call(this);\n\t};\n\n\tComponent.prototype.toString = function toString () {\n\t\tif ( this.instance ) { return this.instance.toHTML(); }\n\t};\n\n\tComponent.prototype.unbind = function unbind$1 () {\n\t\tif ( !this.isAnchor ) {\n\t\t\tthis.bound = false;\n\n\t\t\tthis.attributes.forEach( unbind$1$1 );\n\n\t\t\tteardown$2( this.instance, function () { return runloop.promise(); } );\n\t\t}\n\t};\n\n\tComponent.prototype.unrender = function unrender$1 ( shouldDestroy ) {\n\t\tvar this$1 = this;\n\n\t\tthis.shouldDestroy = shouldDestroy;\n\n\t\tif ( this.isAnchor ) {\n\t\t\tif ( this.item ) { unrenderItem( this, this.item ); }\n\t\t\tthis.target = null;\n\t\t\tif ( !checking.length ) {\n\t\t\t\tchecking.push( this.ractive );\n\t\t\t\trunloop.scheduleTask( checkAnchors, true );\n\t\t\t}\n\t\t} else {\n\t\t\tthis.instance.unrender();\n\t\t\tthis.instance.el = this.instance.target = null;\n\t\t\tthis.attributes.forEach( unrender$1$1 );\n\t\t\tthis.eventHandlers.forEach( unrender$1$1 );\n\n\t\t\tthis.liveQueries.forEach( function (query) { return query.remove( this$1.instance ); } );\n\t\t\tthis.liveQueries = [];\n\t\t}\n\n\t\tthis.rendered = false;\n\t};\n\n\tComponent.prototype.update = function update$1 () {\n\t\tthis.dirty = false;\n\t\tif ( this.instance ) {\n\t\t\tthis.instance.fragment.update();\n\t\t\tthis.attributes.forEach( update$1$1 );\n\t\t\tthis.eventHandlers.forEach( update$1$1 );\n\t\t}\n\t};\n\n\treturn Component;\n}(Item));\n\nfunction addChild$1 ( meta ) {\n\tif ( this.item ) { this.removeChild( this.item ); }\n\n\tvar child = meta.instance;\n\tmeta.anchor = this;\n\n\tmeta.parentFragment = this.parentFragment;\n\tmeta.name = meta.nameOption || this.name;\n\tthis.name = meta.name;\n\n\n\tif ( !child.isolated ) { child.viewmodel.attached( this.parentFragment ); }\n\n\t// render as necessary\n\tif ( this.rendered ) {\n\t\trenderItem( this, meta );\n\t}\n}\n\nfunction removeChild$1 ( meta ) {\n\t// unrender as necessary\n\tif ( this.item === meta ) {\n\t\tunrenderItem( this, meta );\n\t\tthis.name = this.template.n;\n\t}\n}\n\nfunction renderItem ( anchor, meta ) {\n\tif ( !anchor.rendered ) { return; }\n\n\tmeta.shouldDestroy = false;\n\tmeta.parentFragment = anchor.parentFragment;\n\n\tanchor.item = meta;\n\tanchor.instance = meta.instance;\n\tanchor.liveQueries = meta.liveQueries;\n\tvar nextNode = anchor.parentFragment.findNextNode( anchor );\n\n\tif ( meta.instance.fragment.rendered ) {\n\t\tmeta.instance.unrender();\n\t}\n\n\tmeta.partials = meta.instance.partials;\n\tmeta.instance.partials = extend$1( {}, meta.partials, anchor._partials );\n\n\tmeta.instance.fragment.unbind();\n\tmeta.instance.fragment.bind( meta.instance.viewmodel );\n\n\tanchor.attributes.forEach( bind$1$1 );\n\tanchor.eventHandlers.forEach( bind$1$1 );\n\tanchor.attributes.forEach( render$1$1 );\n\tanchor.eventHandlers.forEach( render$1$1 );\n\n\tvar target = anchor.parentFragment.findParentNode();\n\trender$2( meta.instance, target, target.contains( nextNode ) ? nextNode : null );\n\n\tif ( meta.lastBound !== anchor ) {\n\t\tmeta.lastBound = anchor;\n\t}\n\n\tupdateLiveQueries$1( meta );\n}\n\nfunction unrenderItem ( anchor, meta ) {\n\tif ( !anchor.rendered ) { return; }\n\n\tmeta.shouldDestroy = true;\n\tmeta.instance.unrender();\n\n\tanchor.eventHandlers.forEach( unrender$1$1 );\n\tanchor.attributes.forEach( unrender$1$1 );\n\tanchor.eventHandlers.forEach( unbind$1$1 );\n\tanchor.attributes.forEach( unbind$1$1 );\n\n\tmeta.instance.el = meta.instance.anchor = null;\n\tmeta.parentFragment = null;\n\tmeta.anchor = null;\n\tanchor.item = null;\n\tanchor.instance = null;\n\n\tmeta.liveQueries.forEach( function (q) { return q.remove( meta.instance ); } );\n\tmeta.liveQueries = [];\n\tanchor.liveQueries = null;\n}\n\nvar checking = [];\nfunction checkAnchors () {\n\tvar list = checking;\n\tchecking = [];\n\n\tlist.forEach( updateAnchors );\n}\n\nfunction setupArgsFn ( item, template, fragment, opts ) {\n\tif ( opts === void 0 ) opts = {};\n\n\tif ( template && template.f && template.f.s ) {\n\t\titem.resolvers = [];\n\t\titem.models = template.f.r.map( function ( ref, i ) {\n\t\t\tvar resolver, model;\n\n\t\t\tif ( opts.specialRef && ( model = opts.specialRef( ref, i ) ) ) { return model; }\n\n\t\t\tmodel = resolveReference( fragment, ref );\n\t\t\tif ( !model ) {\n\t\t\t\tresolver = fragment.resolve( ref, function (model) {\n\t\t\t\t\titem.models[i] = model;\n\t\t\t\t\tremoveFromArray( item.resolvers, resolver );\n\t\t\t\t\tmodel.register( item );\n\t\t\t\t});\n\n\t\t\t\titem.resolvers.push( resolver );\n\t\t\t} else { model.register( item ); }\n\n\t\t\treturn model;\n\t\t});\n\t\titem.fn = getFunction( template.f.s, template.f.r.length );\n\t}\n}\n\nfunction teardownArgsFn ( item, template ) {\n\tif ( template && template.f && template.f.s ) {\n\t\tif ( item.resolvers ) { item.resolvers.forEach( unbind$1$1 ); }\n\t\titem.resolvers = [];\n\n\t\tif ( item.models ) { item.models.forEach( function (m) {\n\t\t\tif ( m && m.unregister ) { m.unregister( item ); }\n\t\t}); }\n\t\titem.models = null;\n\t}\n}\n\nvar missingDecorator = {\n\tupdate: noop,\n\tteardown: noop\n};\n\nvar Decorator = function Decorator ( options ) {\n\tthis.owner = options.owner || options.parentFragment.owner || findElement( options.parentFragment );\n\tthis.element = this.owner.attributeByName ? this.owner : findElement( options.parentFragment );\n\tthis.parentFragment = this.owner.parentFragment;\n\tthis.ractive = this.owner.ractive;\n\tvar template = this.template = options.template;\n\n\tthis.name = template.n;\n\tthis.args = [];\n\n\tthis.node = null;\n\tthis.intermediary = null;\n\n\tthis.element.decorators.push( this );\n};\n\nDecorator.prototype.bind = function bind () {\n\tsetupArgsFn( this, this.template, this.parentFragment );\n};\n\nDecorator.prototype.bubble = function bubble () {\n\tif ( !this.dirty ) {\n\t\tthis.dirty = true;\n\t\tthis.owner.bubble();\n\t}\n};\n\nDecorator.prototype.destroyed = function destroyed () {\n\tif ( this.intermediary ) { this.intermediary.teardown(); }\n\tthis.shouldDestroy = true;\n};\n\nDecorator.prototype.handleChange = function handleChange () { this.bubble(); };\n\nDecorator.prototype.rebinding = function rebinding ( next, previous, safe ) {\n\tvar idx = this.models.indexOf( previous );\n\tif ( !~idx ) { return; }\n\n\tnext = rebindMatch( this.template.f.r[ idx ], next, previous );\n\tif ( next === previous ) { return; }\n\n\tprevious.unregister( this );\n\tthis.models.splice( idx, 1, next );\n\tif ( next ) { next.addShuffleRegister( this, 'mark' ); }\n\n\tif ( !safe ) { this.bubble(); }\n};\n\nDecorator.prototype.render = function render () {\n\t\tvar this$1 = this;\n\n\trunloop.scheduleTask( function () {\n\t\tvar fn = findInViewHierarchy( 'decorators', this$1.ractive, this$1.name );\n\n\t\tif ( !fn ) {\n\t\t\twarnOnce( missingPlugin( this$1.name, 'decorator' ) );\n\t\t\tthis$1.intermediary = missingDecorator;\n\t\t\treturn;\n\t\t}\n\n\t\tthis$1.node = this$1.element.node;\n\n\t\tvar args;\n\t\tif ( this$1.fn ) {\n\t\t\targs = this$1.models.map( function (model) {\n\t\t\t\tif ( !model ) { return undefined; }\n\n\t\t\t\treturn model.get();\n\t\t\t});\n\t\t\targs = this$1.fn.apply( this$1.ractive, args );\n\t\t}\n\n\t\tthis$1.intermediary = fn.apply( this$1.ractive, [ this$1.node ].concat( args ) );\n\n\t\tif ( !this$1.intermediary || !this$1.intermediary.teardown ) {\n\t\t\tthrow new Error( (\"The '\" + (this$1.name) + \"' decorator must return an object with a teardown method\") );\n\t\t}\n\n\t\t// watch out for decorators that cause their host element to be unrendered\n\t\tif ( this$1.shouldDestroy ) { this$1.destroyed(); }\n\t}, true );\n\tthis.rendered = true;\n};\n\nDecorator.prototype.toString = function toString () { return ''; };\n\nDecorator.prototype.unbind = function unbind () {\n\tteardownArgsFn( this, this.template );\n};\n\nDecorator.prototype.unrender = function unrender ( shouldDestroy ) {\n\tif ( ( !shouldDestroy || this.element.rendered ) && this.intermediary ) { this.intermediary.teardown(); }\n\tthis.rendered = false;\n};\n\nDecorator.prototype.update = function update () {\n\tif ( !this.dirty ) { return; }\n\n\tthis.dirty = false;\n\n\tif ( this.intermediary ) {\n\t\tif ( !this.intermediary.update ) {\n\t\t\tthis.unrender();\n\t\t\tthis.render();\n\t\t}\n\t\telse {\n\t\t\tif ( this.fn ) {\n\t\t\t\tvar args = this.models.map( function (model) {\n\t\t\t\t\tif ( !model ) { return undefined; }\n\n\t\t\t\t\treturn model.get();\n\t\t\t\t});\n\t\t\t\tthis.intermediary.update.apply( this.ractive, this.fn.apply( this.ractive, args ) );\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.intermediary.update.apply( this.ractive, this.args );\n\t\t\t}\n\t\t}\n\t}\n};\n\nvar Doctype = (function (Item$$1) {\n\tfunction Doctype () {\n\t\tItem$$1.apply(this, arguments);\n\t}\n\n\tif ( Item$$1 ) Doctype.__proto__ = Item$$1;\n\tDoctype.prototype = Object.create( Item$$1 && Item$$1.prototype );\n\tDoctype.prototype.constructor = Doctype;\n\n\tDoctype.prototype.bind = function bind () {\n\t\t// noop\n\t};\n\n\tDoctype.prototype.render = function render () {\n\t\t// noop\n\t};\n\n\tDoctype.prototype.teardown = function teardown () {\n\t\t// noop\n\t};\n\n\tDoctype.prototype.toString = function toString () {\n\t\treturn '<!DOCTYPE' + this.template.a + '>';\n\t};\n\n\tDoctype.prototype.unbind = function unbind () {\n\t\t// noop\n\t};\n\n\tDoctype.prototype.unrender = function unrender () {\n\t\t// noop\n\t};\n\n\tDoctype.prototype.update = function update () {\n\t\t// noop\n\t};\n\n\treturn Doctype;\n}(Item));\n\nfunction warnAboutAmbiguity ( description, ractive ) {\n\twarnOnceIfDebug( (\"The \" + description + \" being used for two-way binding is ambiguous, and may cause unexpected results. Consider initialising your data to eliminate the ambiguity\"), { ractive: ractive });\n}\n\nvar Binding = function Binding ( element, name ) {\n\tif ( name === void 0 ) name = 'value';\n\n\tthis.element = element;\n\tthis.ractive = element.ractive;\n\tthis.attribute = element.attributeByName[ name ];\n\n\tvar interpolator = this.attribute.interpolator;\n\tinterpolator.twowayBinding = this;\n\n\tvar model = interpolator.model;\n\n\t// not bound?\n\tif ( !model ) {\n\t\t// try to force resolution\n\t\tinterpolator.resolver.forceResolution();\n\t\tmodel = interpolator.model;\n\n\t\twarnAboutAmbiguity( (\"'\" + (interpolator.template.r) + \"' reference\"), this.ractive );\n\t\t}\n\n\t\telse if ( model.isUnresolved ) {\n\t\t\t// reference expressions (e.g. foo[bar])\n\t\t\tmodel.forceResolution();\n\t\t\twarnAboutAmbiguity( 'expression', this.ractive );\n\t}\n\n\t// TODO include index/key/keypath refs as read-only\n\telse if ( model.isReadonly ) {\n\t\tvar keypath = model.getKeypath().replace( /^@/, '' );\n\t\twarnOnceIfDebug( (\"Cannot use two-way binding on <\" + (element.name) + \"> element: \" + keypath + \" is read-only. To suppress this warning use <\" + (element.name) + \" twoway='false'...>\"), { ractive: this.ractive });\n\t\treturn false;\n\t}\n\n\tthis.attribute.isTwoway = true;\n\tthis.model = model;\n\n\t// initialise value, if it's undefined\n\tvar value = model.get();\n\tthis.wasUndefined = value === undefined;\n\n\tif ( value === undefined && this.getInitialValue ) {\n\t\tvalue = this.getInitialValue();\n\t\tmodel.set( value );\n\t}\n\tthis.lastVal( true, value );\n\n\tvar parentForm = findElement( this.element, false, 'form' );\n\tif ( parentForm ) {\n\t\tthis.resetValue = value;\n\t\tparentForm.formBindings.push( this );\n\t}\n};\n\nBinding.prototype.bind = function bind () {\n\tthis.model.registerTwowayBinding( this );\n};\n\nBinding.prototype.handleChange = function handleChange () {\n\t\tvar this$1 = this;\n\n\tvar value = this.getValue();\n\tif ( this.lastVal() === value ) { return; }\n\n\trunloop.start( this.root );\n\tthis.attribute.locked = true;\n\tthis.model.set( value );\n\tthis.lastVal( true, value );\n\n\t// if the value changes before observers fire, unlock to be updatable cause something weird and potentially freezy is up\n\tif ( this.model.get() !== value ) { this.attribute.locked = false; }\n\telse { runloop.scheduleTask( function () { return this$1.attribute.locked = false; } ); }\n\n\trunloop.end();\n};\n\nBinding.prototype.lastVal = function lastVal ( setting, value ) {\n\tif ( setting ) { this.lastValue = value; }\n\telse { return this.lastValue; }\n};\n\nBinding.prototype.rebinding = function rebinding ( next, previous ) {\n\t\tvar this$1 = this;\n\n\tif ( this.model && this.model === previous ) { previous.unregisterTwowayBinding( this ); }\n\tif ( next ) {\n\t\tthis.model = next;\n\t\trunloop.scheduleTask( function () { return next.registerTwowayBinding( this$1 ); } );\n\t}\n};\n\nBinding.prototype.render = function render () {\n\tthis.node = this.element.node;\n\tthis.node._ractive.binding = this;\n\tthis.rendered = true; // TODO is this used anywhere?\n};\n\n\tBinding.prototype.setFromNode = function setFromNode ( node ) {\n\t\tthis.model.set( node.value );\n};\n\nBinding.prototype.unbind = function unbind () {\n\tthis.model.unregisterTwowayBinding( this );\n};\n\nBinding.prototype.unrender = function unrender () {\n\t\t// noop?\n\t};\n\n// This is the handler for DOM events that would lead to a change in the model\n// (i.e. change, sometimes, input, and occasionally click and keyup)\nfunction handleDomEvent () {\n\tthis._ractive.binding.handleChange();\n}\n\nvar CheckboxBinding = (function (Binding$$1) {\n\tfunction CheckboxBinding ( element ) {\n\t\tBinding$$1.call( this, element, 'checked' );\n\t}\n\n\tif ( Binding$$1 ) CheckboxBinding.__proto__ = Binding$$1;\n\tCheckboxBinding.prototype = Object.create( Binding$$1 && Binding$$1.prototype );\n\tCheckboxBinding.prototype.constructor = CheckboxBinding;\n\n\tCheckboxBinding.prototype.render = function render () {\n\t\tBinding$$1.prototype.render.call(this);\n\n\t\tthis.node.addEventListener( 'change', handleDomEvent, false );\n\n\t\tif ( this.node.attachEvent ) {\n\t\t\tthis.node.addEventListener( 'click', handleDomEvent, false );\n\t\t}\n\t};\n\n\tCheckboxBinding.prototype.unrender = function unrender () {\n\t\tthis.node.removeEventListener( 'change', handleDomEvent, false );\n\t\tthis.node.removeEventListener( 'click', handleDomEvent, false );\n\t};\n\n\tCheckboxBinding.prototype.getInitialValue = function getInitialValue () {\n\t\treturn !!this.element.getAttribute( 'checked' );\n\t};\n\n\tCheckboxBinding.prototype.getValue = function getValue () {\n\t\treturn this.node.checked;\n\t};\n\n\tCheckboxBinding.prototype.setFromNode = function setFromNode ( node ) {\n\t\tthis.model.set( node.checked );\n\t};\n\n\treturn CheckboxBinding;\n}(Binding));\n\nfunction getBindingGroup ( group, model, getValue ) {\n\tvar hash = group + \"-bindingGroup\";\n\treturn model[hash] || ( model[ hash ] = new BindingGroup( hash, model, getValue ) );\n}\n\nvar BindingGroup = function BindingGroup ( hash, model, getValue ) {\n\tvar this$1 = this;\n\n\tthis.model = model;\n\tthis.hash = hash;\n\tthis.getValue = function () {\n\t\tthis$1.value = getValue.call(this$1);\n\t\treturn this$1.value;\n\t};\n\n\tthis.bindings = [];\n};\n\nBindingGroup.prototype.add = function add ( binding ) {\n\tthis.bindings.push( binding );\n};\n\nBindingGroup.prototype.bind = function bind () {\n\tthis.value = this.model.get();\n\tthis.model.registerTwowayBinding( this );\n\tthis.bound = true;\n};\n\nBindingGroup.prototype.remove = function remove ( binding ) {\n\tremoveFromArray( this.bindings, binding );\n\tif ( !this.bindings.length ) {\n\t\tthis.unbind();\n\t}\n};\n\nBindingGroup.prototype.unbind = function unbind () {\n\tthis.model.unregisterTwowayBinding( this );\n\tthis.bound = false;\n\tdelete this.model[this.hash];\n};\n\nvar push$2 = [].push;\n\nfunction getValue$1$1() {\n\tvar all = this.bindings.filter(function (b) { return b.node && b.node.checked; }).map(function (b) { return b.element.getAttribute( 'value' ); });\n\tvar res = [];\n\tall.forEach(function (v) { if ( !arrayContains( res, v ) ) { res.push( v ); } });\n\treturn res;\n}\n\nvar CheckboxNameBinding = (function (Binding$$1) {\n\tfunction CheckboxNameBinding ( element ) {\n\t\tBinding$$1.call( this, element, 'name' );\n\n\t\tthis.checkboxName = true; // so that ractive.updateModel() knows what to do with this\n\n\t\t// Each input has a reference to an array containing it and its\n\t\t// group, as two-way binding depends on being able to ascertain\n\t\t// the status of all inputs within the group\n\t\tthis.group = getBindingGroup( 'checkboxes', this.model, getValue$1$1 );\n\t\tthis.group.add( this );\n\n\t\tif ( this.noInitialValue ) {\n\t\t\tthis.group.noInitialValue = true;\n\t\t}\n\n\t\t// If no initial value was set, and this input is checked, we\n\t\t// update the model\n\t\tif ( this.group.noInitialValue && this.element.getAttribute( 'checked' ) ) {\n\t\t\tvar existingValue = this.model.get();\n\t\t\tvar bindingValue = this.element.getAttribute( 'value' );\n\n\t\t\tif ( !arrayContains( existingValue, bindingValue ) ) {\n\t\t\t\tpush$2.call( existingValue, bindingValue ); // to avoid triggering runloop with array adaptor\n\t\t\t}\n\t\t}\n\t}\n\n\tif ( Binding$$1 ) CheckboxNameBinding.__proto__ = Binding$$1;\n\tCheckboxNameBinding.prototype = Object.create( Binding$$1 && Binding$$1.prototype );\n\tCheckboxNameBinding.prototype.constructor = CheckboxNameBinding;\n\n\tCheckboxNameBinding.prototype.bind = function bind () {\n\t\tif ( !this.group.bound ) {\n\t\t\tthis.group.bind();\n\t\t}\n\t};\n\n\tCheckboxNameBinding.prototype.changed = function changed () {\n\t\tvar wasChecked = !!this.isChecked;\n\t\tthis.isChecked = this.node.checked;\n\t\treturn this.isChecked === wasChecked;\n\t};\n\n\tCheckboxNameBinding.prototype.getInitialValue = function getInitialValue () {\n\t\t// This only gets called once per group (of inputs that\n\t\t// share a name), because it only gets called if there\n\t\t// isn't an initial value. By the same token, we can make\n\t\t// a note of that fact that there was no initial value,\n\t\t// and populate it using any `checked` attributes that\n\t\t// exist (which users should avoid, but which we should\n\t\t// support anyway to avoid breaking expectations)\n\t\tthis.noInitialValue = true; // TODO are noInitialValue and wasUndefined the same thing?\n\t\treturn [];\n\t};\n\n\tCheckboxNameBinding.prototype.getValue = function getValue$1 () {\n\t\treturn this.group.value;\n\t};\n\n\tCheckboxNameBinding.prototype.handleChange = function handleChange () {\n\t\tthis.isChecked = this.element.node.checked;\n\t\tthis.group.value = this.model.get();\n\t\tvar value = this.element.getAttribute( 'value' );\n\t\tif ( this.isChecked && !arrayContains( this.group.value, value ) ) {\n\t\t\tthis.group.value.push( value );\n\t\t} else if ( !this.isChecked && arrayContains( this.group.value, value ) ) {\n\t\t\tremoveFromArray( this.group.value, value );\n\t\t}\n\t\t// make sure super knows there's a change\n\t\tthis.lastValue = null;\n\t\tBinding$$1.prototype.handleChange.call(this);\n\t};\n\n\tCheckboxNameBinding.prototype.render = function render () {\n\t\tBinding$$1.prototype.render.call(this);\n\n\t\tvar node = this.node;\n\n\t\tvar existingValue = this.model.get();\n\t\tvar bindingValue = this.element.getAttribute( 'value' );\n\n\t\tif ( isArray( existingValue ) ) {\n\t\t\tthis.isChecked = arrayContains( existingValue, bindingValue );\n\t\t} else {\n\t\t\tthis.isChecked = existingValue == bindingValue;\n\t\t}\n\n\t\tnode.name = '{{' + this.model.getKeypath() + '}}';\n\t\tnode.checked = this.isChecked;\n\n\t\tnode.addEventListener( 'change', handleDomEvent, false );\n\n\t\t// in case of IE emergency, bind to click event as well\n\t\tif ( node.attachEvent ) {\n\t\t\tnode.addEventListener( 'click', handleDomEvent, false );\n\t\t}\n\t};\n\n\tCheckboxNameBinding.prototype.setFromNode = function setFromNode ( node ) {\n\t\tthis.group.bindings.forEach( function (binding) { return binding.wasUndefined = true; } );\n\n\t\tif ( node.checked ) {\n\t\t\tvar valueSoFar = this.group.getValue();\n\t\t\tvalueSoFar.push( this.element.getAttribute( 'value' ) );\n\n\t\t\tthis.group.model.set( valueSoFar );\n\t\t}\n\t};\n\n\tCheckboxNameBinding.prototype.unbind = function unbind () {\n\t\tthis.group.remove( this );\n\t};\n\n\tCheckboxNameBinding.prototype.unrender = function unrender () {\n\t\tvar node = this.element.node;\n\n\t\tnode.removeEventListener( 'change', handleDomEvent, false );\n\t\tnode.removeEventListener( 'click', handleDomEvent, false );\n\t};\n\n\treturn CheckboxNameBinding;\n}(Binding));\n\nvar ContentEditableBinding = (function (Binding$$1) {\n\tfunction ContentEditableBinding () {\n\t\tBinding$$1.apply(this, arguments);\n\t}\n\n\tif ( Binding$$1 ) ContentEditableBinding.__proto__ = Binding$$1;\n\tContentEditableBinding.prototype = Object.create( Binding$$1 && Binding$$1.prototype );\n\tContentEditableBinding.prototype.constructor = ContentEditableBinding;\n\n\tContentEditableBinding.prototype.getInitialValue = function getInitialValue () {\n\t\treturn this.element.fragment ? this.element.fragment.toString() : '';\n\t};\n\n\tContentEditableBinding.prototype.getValue = function getValue () {\n\t\treturn this.element.node.innerHTML;\n\t};\n\n\tContentEditableBinding.prototype.render = function render () {\n\t\tBinding$$1.prototype.render.call(this);\n\n\t\tvar node = this.node;\n\n\t\tnode.addEventListener( 'change', handleDomEvent, false );\n\t\tnode.addEventListener( 'blur', handleDomEvent, false );\n\n\t\tif ( !this.ractive.lazy ) {\n\t\t\tnode.addEventListener( 'input', handleDomEvent, false );\n\n\t\t\tif ( node.attachEvent ) {\n\t\t\t\tnode.addEventListener( 'keyup', handleDomEvent, false );\n\t\t\t}\n\t\t}\n\t};\n\n\tContentEditableBinding.prototype.setFromNode = function setFromNode ( node ) {\n\t\tthis.model.set( node.innerHTML );\n\t};\n\n\tContentEditableBinding.prototype.unrender = function unrender () {\n\t\tvar node = this.node;\n\n\t\tnode.removeEventListener( 'blur', handleDomEvent, false );\n\t\tnode.removeEventListener( 'change', handleDomEvent, false );\n\t\tnode.removeEventListener( 'input', handleDomEvent, false );\n\t\tnode.removeEventListener( 'keyup', handleDomEvent, false );\n\t};\n\n\treturn ContentEditableBinding;\n}(Binding));\n\nfunction handleBlur () {\n\thandleDomEvent.call( this );\n\n\tvar value = this._ractive.binding.model.get();\n\tthis.value = value == undefined ? '' : value;\n}\n\nfunction handleDelay ( delay ) {\n\tvar timeout;\n\n\treturn function () {\n\t\tvar this$1 = this;\n\n\t\tif ( timeout ) { clearTimeout( timeout ); }\n\n\t\ttimeout = setTimeout( function () {\n\t\t\tvar binding = this$1._ractive.binding;\n\t\t\tif ( binding.rendered ) { handleDomEvent.call( this$1 ); }\n\t\t\ttimeout = null;\n\t\t}, delay );\n\t};\n}\n\nvar GenericBinding = (function (Binding$$1) {\n\tfunction GenericBinding () {\n\t\tBinding$$1.apply(this, arguments);\n\t}\n\n\tif ( Binding$$1 ) GenericBinding.__proto__ = Binding$$1;\n\tGenericBinding.prototype = Object.create( Binding$$1 && Binding$$1.prototype );\n\tGenericBinding.prototype.constructor = GenericBinding;\n\n\tGenericBinding.prototype.getInitialValue = function getInitialValue () {\n\t\treturn '';\n\t};\n\n\tGenericBinding.prototype.getValue = function getValue () {\n\t\treturn this.node.value;\n\t};\n\n\tGenericBinding.prototype.render = function render () {\n\t\tBinding$$1.prototype.render.call(this);\n\n\t\t// any lazy setting for this element overrides the root\n\t\t// if the value is a number, it's a timeout\n\t\tvar lazy = this.ractive.lazy;\n\t\tvar timeout = false;\n\n\t\tif ( 'lazy' in this.element ) {\n\t\t\tlazy = this.element.lazy;\n\t\t}\n\n\t\tif ( isNumeric( lazy ) ) {\n\t\t\ttimeout = +lazy;\n\t\t\tlazy = false;\n\t\t}\n\n\t\tthis.handler = timeout ? handleDelay( timeout ) : handleDomEvent;\n\n\t\tvar node = this.node;\n\n\t\tnode.addEventListener( 'change', handleDomEvent, false );\n\n\t\tif ( !lazy ) {\n\t\t\tnode.addEventListener( 'input', this.handler, false );\n\n\t\t\tif ( node.attachEvent ) {\n\t\t\t\tnode.addEventListener( 'keyup', this.handler, false );\n\t\t\t}\n\t\t}\n\n\t\tnode.addEventListener( 'blur', handleBlur, false );\n\t};\n\n\tGenericBinding.prototype.unrender = function unrender () {\n\t\tvar node = this.element.node;\n\t\tthis.rendered = false;\n\n\t\tnode.removeEventListener( 'change', handleDomEvent, false );\n\t\tnode.removeEventListener( 'input', this.handler, false );\n\t\tnode.removeEventListener( 'keyup', this.handler, false );\n\t\tnode.removeEventListener( 'blur', handleBlur, false );\n\t};\n\n\treturn GenericBinding;\n}(Binding));\n\nvar FileBinding = (function (GenericBinding$$1) {\n\tfunction FileBinding () {\n\t\tGenericBinding$$1.apply(this, arguments);\n\t}\n\n\tif ( GenericBinding$$1 ) FileBinding.__proto__ = GenericBinding$$1;\n\tFileBinding.prototype = Object.create( GenericBinding$$1 && GenericBinding$$1.prototype );\n\tFileBinding.prototype.constructor = FileBinding;\n\n\tFileBinding.prototype.getInitialValue = function getInitialValue () {\n\t\treturn undefined;\n\t};\n\n\tFileBinding.prototype.getValue = function getValue () {\n\t\treturn this.node.files;\n\t};\n\n\tFileBinding.prototype.render = function render () {\n\t\tthis.element.lazy = false;\n\t\tGenericBinding$$1.prototype.render.call(this);\n\t};\n\n\tFileBinding.prototype.setFromNode = function setFromNode ( node ) {\n\t\tthis.model.set( node.files );\n\t};\n\n\treturn FileBinding;\n}(GenericBinding));\n\nfunction getSelectedOptions ( select ) {\n\treturn select.selectedOptions\n\t\t? toArray( select.selectedOptions )\n\t\t: select.options\n\t\t\t? toArray( select.options ).filter( function (option) { return option.selected; } )\n\t\t\t: [];\n}\n\nvar MultipleSelectBinding = (function (Binding$$1) {\n\tfunction MultipleSelectBinding () {\n\t\tBinding$$1.apply(this, arguments);\n\t}\n\n\tif ( Binding$$1 ) MultipleSelectBinding.__proto__ = Binding$$1;\n\tMultipleSelectBinding.prototype = Object.create( Binding$$1 && Binding$$1.prototype );\n\tMultipleSelectBinding.prototype.constructor = MultipleSelectBinding;\n\n\tMultipleSelectBinding.prototype.forceUpdate = function forceUpdate () {\n\t\tvar this$1 = this;\n\n\t\tvar value = this.getValue();\n\n\t\tif ( value !== undefined ) {\n\t\t\tthis.attribute.locked = true;\n\t\t\trunloop.scheduleTask( function () { return this$1.attribute.locked = false; } );\n\t\t\tthis.model.set( value );\n\t\t}\n\t};\n\n\tMultipleSelectBinding.prototype.getInitialValue = function getInitialValue () {\n\t\treturn this.element.options\n\t\t\t.filter( function (option) { return option.getAttribute( 'selected' ); } )\n\t\t\t.map( function (option) { return option.getAttribute( 'value' ); } );\n\t};\n\n\tMultipleSelectBinding.prototype.getValue = function getValue () {\n\t\tvar options = this.element.node.options;\n\t\tvar len = options.length;\n\n\t\tvar selectedValues = [];\n\n\t\tfor ( var i = 0; i < len; i += 1 ) {\n\t\t\tvar option = options[i];\n\n\t\t\tif ( option.selected ) {\n\t\t\t\tvar optionValue = option._ractive ? option._ractive.value : option.value;\n\t\t\t\tselectedValues.push( optionValue );\n\t\t\t}\n\t\t}\n\n\t\treturn selectedValues;\n\t};\n\n\tMultipleSelectBinding.prototype.handleChange = function handleChange () {\n\t\tvar attribute = this.attribute;\n\t\tvar previousValue = attribute.getValue();\n\n\t\tvar value = this.getValue();\n\n\t\tif ( previousValue === undefined || !arrayContentsMatch( value, previousValue ) ) {\n\t\t\tBinding$$1.prototype.handleChange.call(this);\n\t\t}\n\n\t\treturn this;\n\t};\n\n\tMultipleSelectBinding.prototype.render = function render () {\n\t\tBinding$$1.prototype.render.call(this);\n\n\t\tthis.node.addEventListener( 'change', handleDomEvent, false );\n\n\t\tif ( this.model.get() === undefined ) {\n\t\t\t// get value from DOM, if possible\n\t\t\tthis.handleChange();\n\t\t}\n\t};\n\n\tMultipleSelectBinding.prototype.setFromNode = function setFromNode ( node ) {\n\t\tvar selectedOptions = getSelectedOptions( node );\n\t\tvar i = selectedOptions.length;\n\t\tvar result = new Array( i );\n\n\t\twhile ( i-- ) {\n\t\t\tvar option = selectedOptions[i];\n\t\t\tresult[i] = option._ractive ? option._ractive.value : option.value;\n\t\t}\n\n\t\tthis.model.set( result );\n\t};\n\n\tMultipleSelectBinding.prototype.setValue = function setValue () {\n\t\tthrow new Error( 'TODO not implemented yet' );\n\t};\n\n\tMultipleSelectBinding.prototype.unrender = function unrender () {\n\t\tthis.node.removeEventListener( 'change', handleDomEvent, false );\n\t};\n\n\tMultipleSelectBinding.prototype.updateModel = function updateModel () {\n\t\tif ( this.attribute.value === undefined || !this.attribute.value.length ) {\n\t\t\tthis.keypath.set( this.initialValue );\n\t\t}\n\t};\n\n\treturn MultipleSelectBinding;\n}(Binding));\n\nvar NumericBinding = (function (GenericBinding$$1) {\n\tfunction NumericBinding () {\n\t\tGenericBinding$$1.apply(this, arguments);\n\t}\n\n\tif ( GenericBinding$$1 ) NumericBinding.__proto__ = GenericBinding$$1;\n\tNumericBinding.prototype = Object.create( GenericBinding$$1 && GenericBinding$$1.prototype );\n\tNumericBinding.prototype.constructor = NumericBinding;\n\n\tNumericBinding.prototype.getInitialValue = function getInitialValue () {\n\t\treturn undefined;\n\t};\n\n\tNumericBinding.prototype.getValue = function getValue () {\n\t\tvar value = parseFloat( this.node.value );\n\t\treturn isNaN( value ) ? undefined : value;\n\t};\n\n\tNumericBinding.prototype.setFromNode = function setFromNode ( node ) {\n\t\tvar value = parseFloat( node.value );\n\t\tif ( !isNaN( value ) ) { this.model.set( value ); }\n\t};\n\n\treturn NumericBinding;\n}(GenericBinding));\n\nvar siblings = {};\n\nfunction getSiblings ( hash ) {\n\treturn siblings[ hash ] || ( siblings[ hash ] = [] );\n}\n\nvar RadioBinding = (function (Binding$$1) {\n\tfunction RadioBinding ( element ) {\n\t\tBinding$$1.call( this, element, 'checked' );\n\n\t\tthis.siblings = getSiblings( this.ractive._guid + this.element.getAttribute( 'name' ) );\n\t\tthis.siblings.push( this );\n\t}\n\n\tif ( Binding$$1 ) RadioBinding.__proto__ = Binding$$1;\n\tRadioBinding.prototype = Object.create( Binding$$1 && Binding$$1.prototype );\n\tRadioBinding.prototype.constructor = RadioBinding;\n\n\tRadioBinding.prototype.getValue = function getValue () {\n\t\treturn this.node.checked;\n\t};\n\n\tRadioBinding.prototype.handleChange = function handleChange () {\n\t\trunloop.start( this.root );\n\n\t\tthis.siblings.forEach( function (binding) {\n\t\t\tbinding.model.set( binding.getValue() );\n\t\t});\n\n\t\trunloop.end();\n\t};\n\n\tRadioBinding.prototype.render = function render () {\n\t\tBinding$$1.prototype.render.call(this);\n\n\t\tthis.node.addEventListener( 'change', handleDomEvent, false );\n\n\t\tif ( this.node.attachEvent ) {\n\t\t\tthis.node.addEventListener( 'click', handleDomEvent, false );\n\t\t}\n\t};\n\n\tRadioBinding.prototype.setFromNode = function setFromNode ( node ) {\n\t\tthis.model.set( node.checked );\n\t};\n\n\tRadioBinding.prototype.unbind = function unbind () {\n\t\tremoveFromArray( this.siblings, this );\n\t};\n\n\tRadioBinding.prototype.unrender = function unrender () {\n\t\tthis.node.removeEventListener( 'change', handleDomEvent, false );\n\t\tthis.node.removeEventListener( 'click', handleDomEvent, false );\n\t};\n\n\treturn RadioBinding;\n}(Binding));\n\nfunction getValue$2() {\n\tvar checked = this.bindings.filter( function (b) { return b.node.checked; } );\n\tif ( checked.length > 0 ) {\n\t\treturn checked[0].element.getAttribute( 'value' );\n\t}\n}\n\nvar RadioNameBinding = (function (Binding$$1) {\n\tfunction RadioNameBinding ( element ) {\n\t\tBinding$$1.call( this, element, 'name' );\n\n\t\tthis.group = getBindingGroup( 'radioname', this.model, getValue$2 );\n\t\tthis.group.add( this );\n\n\t\tif ( element.checked ) {\n\t\t\tthis.group.value = this.getValue();\n\t\t}\n\t}\n\n\tif ( Binding$$1 ) RadioNameBinding.__proto__ = Binding$$1;\n\tRadioNameBinding.prototype = Object.create( Binding$$1 && Binding$$1.prototype );\n\tRadioNameBinding.prototype.constructor = RadioNameBinding;\n\n\tRadioNameBinding.prototype.bind = function bind () {\n\t\tvar this$1 = this;\n\n\t\tif ( !this.group.bound ) {\n\t\t\tthis.group.bind();\n\t\t}\n\n\t\t// update name keypath when necessary\n\t\tthis.nameAttributeBinding = {\n\t\t\thandleChange: function () { return this$1.node.name = \"{{\" + (this$1.model.getKeypath()) + \"}}\"; }\n\t\t};\n\n\t\tthis.model.getKeypathModel().register( this.nameAttributeBinding );\n\t};\n\n\tRadioNameBinding.prototype.getInitialValue = function getInitialValue () {\n\t\tif ( this.element.getAttribute( 'checked' ) ) {\n\t\t\treturn this.element.getAttribute( 'value' );\n\t\t}\n\t};\n\n\tRadioNameBinding.prototype.getValue = function getValue$1 () {\n\t\treturn this.element.getAttribute( 'value' );\n\t};\n\n\tRadioNameBinding.prototype.handleChange = function handleChange () {\n\t\t// If this <input> is the one that's checked, then the value of its\n\t\t// `name` model gets set to its value\n\t\tif ( this.node.checked ) {\n\t\t\tthis.group.value = this.getValue();\n\t\t\tBinding$$1.prototype.handleChange.call(this);\n\t\t}\n\t};\n\n\tRadioNameBinding.prototype.lastVal = function lastVal ( setting, value ) {\n\t\tif ( !this.group ) { return; }\n\t\tif ( setting ) { this.group.lastValue = value; }\n\t\telse { return this.group.lastValue; }\n\t};\n\n\tRadioNameBinding.prototype.render = function render () {\n\t\tBinding$$1.prototype.render.call(this);\n\n\t\tvar node = this.node;\n\n\t\tnode.name = \"{{\" + (this.model.getKeypath()) + \"}}\";\n\t\tnode.checked = this.model.get() == this.element.getAttribute( 'value' );\n\n\t\tnode.addEventListener( 'change', handleDomEvent, false );\n\n\t\tif ( node.attachEvent ) {\n\t\t\tnode.addEventListener( 'click', handleDomEvent, false );\n\t\t}\n\t};\n\n\tRadioNameBinding.prototype.setFromNode = function setFromNode ( node ) {\n\t\tif ( node.checked ) {\n\t\t\tthis.group.model.set( this.element.getAttribute( 'value' ) );\n\t\t}\n\t};\n\n\tRadioNameBinding.prototype.unbind = function unbind () {\n\t\tthis.group.remove( this );\n\n\t\tthis.model.getKeypathModel().unregister( this.nameAttributeBinding );\n\t};\n\n\tRadioNameBinding.prototype.unrender = function unrender () {\n\t\tvar node = this.node;\n\n\t\tnode.removeEventListener( 'change', handleDomEvent, false );\n\t\tnode.removeEventListener( 'click', handleDomEvent, false );\n\t};\n\n\treturn RadioNameBinding;\n}(Binding));\n\nvar SingleSelectBinding = (function (Binding$$1) {\n\tfunction SingleSelectBinding () {\n\t\tBinding$$1.apply(this, arguments);\n\t}\n\n\tif ( Binding$$1 ) SingleSelectBinding.__proto__ = Binding$$1;\n\tSingleSelectBinding.prototype = Object.create( Binding$$1 && Binding$$1.prototype );\n\tSingleSelectBinding.prototype.constructor = SingleSelectBinding;\n\n\tSingleSelectBinding.prototype.forceUpdate = function forceUpdate () {\n\t\tvar this$1 = this;\n\n\t\tvar value = this.getValue();\n\n\t\tif ( value !== undefined ) {\n\t\t\tthis.attribute.locked = true;\n\t\t\trunloop.scheduleTask( function () { return this$1.attribute.locked = false; } );\n\t\t\tthis.model.set( value );\n\t\t}\n\t};\n\n\tSingleSelectBinding.prototype.getInitialValue = function getInitialValue () {\n\t\tif ( this.element.getAttribute( 'value' ) !== undefined ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar options = this.element.options;\n\t\tvar len = options.length;\n\n\t\tif ( !len ) { return; }\n\n\t\tvar value;\n\t\tvar optionWasSelected;\n\t\tvar i = len;\n\n\t\t// take the final selected option...\n\t\twhile ( i-- ) {\n\t\t\tvar option = options[i];\n\n\t\t\tif ( option.getAttribute( 'selected' ) ) {\n\t\t\t\tif ( !option.getAttribute( 'disabled' ) ) {\n\t\t\t\t\tvalue = option.getAttribute( 'value' );\n\t\t\t\t}\n\n\t\t\t\toptionWasSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\t// or the first non-disabled option, if none are selected\n\t\tif ( !optionWasSelected ) {\n\t\t\twhile ( ++i < len ) {\n\t\t\t\tif ( !options[i].getAttribute( 'disabled' ) ) {\n\t\t\t\t\tvalue = options[i].getAttribute( 'value' );\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// This is an optimisation (aka hack) that allows us to forgo some\n\t\t// other more expensive work\n\t\t// TODO does it still work? seems at odds with new architecture\n\t\tif ( value !== undefined ) {\n\t\t\tthis.element.attributeByName.value.value = value;\n\t\t}\n\n\t\treturn value;\n\t};\n\n\tSingleSelectBinding.prototype.getValue = function getValue () {\n\t\tvar options = this.node.options;\n\t\tvar len = options.length;\n\n\t\tvar i;\n\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\tvar option = options[i];\n\n\t\t\tif ( options[i].selected && !options[i].disabled ) {\n\t\t\t\treturn option._ractive ? option._ractive.value : option.value;\n\t\t\t}\n\t\t}\n\t};\n\n\tSingleSelectBinding.prototype.render = function render () {\n\t\tBinding$$1.prototype.render.call(this);\n\t\tthis.node.addEventListener( 'change', handleDomEvent, false );\n\t};\n\n\tSingleSelectBinding.prototype.setFromNode = function setFromNode ( node ) {\n\t\tvar option = getSelectedOptions( node )[0];\n\t\tthis.model.set( option._ractive ? option._ractive.value : option.value );\n\t};\n\n\t// TODO this method is an anomaly... is it necessary?\n\tSingleSelectBinding.prototype.setValue = function setValue ( value ) {\n\t\tthis.model.set( value );\n\t};\n\n\tSingleSelectBinding.prototype.unrender = function unrender () {\n\t\tthis.node.removeEventListener( 'change', handleDomEvent, false );\n\t};\n\n\treturn SingleSelectBinding;\n}(Binding));\n\nfunction isBindable ( attribute ) {\n\treturn attribute &&\n\t\t   attribute.template.f &&\n\t       attribute.template.f.length === 1 &&\n\t       attribute.template.f[0].t === INTERPOLATOR &&\n\t       !attribute.template.f[0].s;\n}\n\nfunction selectBinding ( element ) {\n\tvar attributes = element.attributeByName;\n\n\t// contenteditable - bind if the contenteditable attribute is true\n\t// or is bindable and may thus become true...\n\tif ( element.getAttribute( 'contenteditable' ) || isBindable( attributes.contenteditable ) ) {\n\t\t// ...and this element also has a value attribute to bind\n\t\treturn isBindable( attributes.value ) ? ContentEditableBinding : null;\n\t}\n\n\t// <input>\n\tif ( element.name === 'input' ) {\n\t\tvar type = element.getAttribute( 'type' );\n\n\t\tif ( type === 'radio' || type === 'checkbox' ) {\n\t\t\tvar bindName = isBindable( attributes.name );\n\t\t\tvar bindChecked = isBindable( attributes.checked );\n\n\t\t\t// for radios we can either bind the name attribute, or the checked attribute - not both\n\t\t\tif ( bindName && bindChecked ) {\n\t\t\t\tif ( type === 'radio' ) {\n\t\t\t\t\twarnIfDebug( 'A radio input can have two-way binding on its name attribute, or its checked attribute - not both', { ractive: element.root });\n\t\t\t\t} else {\n\t\t\t\t\t// A checkbox with bindings for both name and checked - see https://github.com/ractivejs/ractive/issues/1749\n\t\t\t\t\treturn CheckboxBinding;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( bindName ) {\n\t\t\t\treturn type === 'radio' ? RadioNameBinding : CheckboxNameBinding;\n\t\t\t}\n\n\t\t\tif ( bindChecked ) {\n\t\t\t\treturn type === 'radio' ? RadioBinding : CheckboxBinding;\n\t\t\t}\n\t\t}\n\n\t\tif ( type === 'file' && isBindable( attributes.value ) ) {\n\t\t\treturn FileBinding;\n\t\t}\n\n\t\tif ( isBindable( attributes.value ) ) {\n\t\t\treturn ( type === 'number' || type === 'range' ) ? NumericBinding : GenericBinding;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t// <select>\n\tif ( element.name === 'select' && isBindable( attributes.value ) ) {\n\t\treturn element.getAttribute( 'multiple' ) ? MultipleSelectBinding : SingleSelectBinding;\n\t}\n\n\t// <textarea>\n\tif ( element.name === 'textarea' && isBindable( attributes.value ) ) {\n\t\treturn GenericBinding;\n\t}\n}\n\nfunction makeDirty$2 ( query ) {\n\tquery.makeDirty();\n}\n\nvar endsWithSemi = /;\\s*$/;\n\nvar Element = (function (ContainerItem$$1) {\n\tfunction Element ( options ) {\n\t\tvar this$1 = this;\n\n\t\tContainerItem$$1.call( this, options );\n\n\t\tthis.liveQueries = []; // TODO rare case. can we handle differently?\n\n\t\tthis.name = options.template.e.toLowerCase();\n\t\tthis.isVoid = voidElementNames.test( this.name );\n\n\t\t// find parent element\n\t\tthis.parent = findElement( this.parentFragment, false );\n\n\t\tif ( this.parent && this.parent.name === 'option' ) {\n\t\t\tthrow new Error( (\"An <option> element cannot contain other elements (encountered <\" + (this.name) + \">)\") );\n\t\t}\n\n\t\tthis.decorators = [];\n\t\tthis.events = [];\n\n\t\t// create attributes\n\t\tthis.attributeByName = {};\n\n\t\tthis.attributes = [];\n\t\tvar leftovers = [];\n\t\t( this.template.m || [] ).forEach( function (template) {\n\t\t\tswitch ( template.t ) {\n\t\t\t\tcase ATTRIBUTE:\n\t\t\t\tcase BINDING_FLAG:\n\t\t\t\tcase DECORATOR:\n\t\t\t\tcase EVENT:\n\t\t\t\tcase TRANSITION:\n\t\t\t\t\tthis$1.attributes.push( createItem({\n\t\t\t\t\t\towner: this$1,\n\t\t\t\t\t\tparentFragment: this$1.parentFragment,\n\t\t\t\t\t\ttemplate: template\n\t\t\t\t\t}) );\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tleftovers.push( template );\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\n\t\tif ( leftovers.length ) {\n\t\t\tthis.attributes.push( new ConditionalAttribute({\n\t\t\t\towner: this,\n\t\t\t\tparentFragment: this.parentFragment,\n\t\t\t\ttemplate: leftovers\n\t\t\t}) );\n\t\t}\n\n\t\tthis.attributes.sort( sortAttributes );\n\n\t\t// create children\n\t\tif ( options.template.f && !options.deferContent ) {\n\t\t\tthis.fragment = new Fragment({\n\t\t\t\ttemplate: options.template.f,\n\t\t\t\towner: this,\n\t\t\t\tcssIds: null\n\t\t\t});\n\t\t}\n\n\t\tthis.binding = null; // filled in later\n\t}\n\n\tif ( ContainerItem$$1 ) Element.__proto__ = ContainerItem$$1;\n\tElement.prototype = Object.create( ContainerItem$$1 && ContainerItem$$1.prototype );\n\tElement.prototype.constructor = Element;\n\n\tElement.prototype.bind = function bind$1 () {\n\t\tthis.attributes.binding = true;\n\t\tthis.attributes.forEach( bind$1$1 );\n\t\tthis.attributes.binding = false;\n\n\t\tif ( this.fragment ) { this.fragment.bind(); }\n\n\t\t// create two-way binding if necessary\n\t\tif ( !this.binding ) { this.recreateTwowayBinding(); }\n\t};\n\n\tElement.prototype.createTwowayBinding = function createTwowayBinding () {\n\t\tif ( 'twoway' in this ? this.twoway : this.ractive.twoway ) {\n\t\t\tvar Binding = selectBinding( this );\n\t\t\tif ( Binding ) {\n\t\t\t\tvar binding = new Binding( this );\n\t\t\t\tif ( binding && binding.model ) { return binding; }\n\t\t\t}\n\t\t}\n\t};\n\n\tElement.prototype.destroyed = function destroyed$1 () {\n\t\tthis.attributes.forEach( destroyed$1$1 );\n\t\tif ( this.fragment ) { this.fragment.destroyed(); }\n\t};\n\n\tElement.prototype.detach = function detach () {\n\t\t// if this element is no longer rendered, the transitions are complete and the attributes can be torn down\n\t\tif ( !this.rendered ) { this.destroyed(); }\n\n\t\treturn detachNode( this.node );\n\t};\n\n\tElement.prototype.find = function find ( selector, options ) {\n\t\tif ( this.node && matches( this.node, selector ) ) { return this.node; }\n\t\tif ( this.fragment ) {\n\t\t\treturn this.fragment.find( selector, options );\n\t\t}\n\t};\n\n\tElement.prototype.findAll = function findAll ( selector, query ) {\n\t\t// Add this node to the query, if applicable, and register the\n\t\t// query on this element\n\t\tvar matches$$1 = query.test( this.node );\n\t\tif ( matches$$1 ) {\n\t\t\tquery.add( this.node );\n\t\t\tif ( query.live ) { this.liveQueries.push( query ); }\n\t\t}\n\n\t\tif ( this.fragment ) {\n\t\t\tthis.fragment.findAll( selector, query );\n\t\t}\n\t};\n\n\tElement.prototype.findNextNode = function findNextNode () {\n\t\treturn null;\n\t};\n\n\tElement.prototype.firstNode = function firstNode () {\n\t\treturn this.node;\n\t};\n\n\tElement.prototype.getAttribute = function getAttribute ( name ) {\n\t\tvar attribute = this.attributeByName[ name ];\n\t\treturn attribute ? attribute.getValue() : undefined;\n\t};\n\n\tElement.prototype.recreateTwowayBinding = function recreateTwowayBinding () {\n\t\tif ( this.binding ) {\n\t\t\tthis.binding.unbind();\n\t\t\tthis.binding.unrender();\n\t\t}\n\n\t\tif ( this.binding = this.createTwowayBinding() ) {\n\t\t\tthis.binding.bind();\n\t\t\tif ( this.rendered ) { this.binding.render(); }\n\t\t}\n\t};\n\n\tElement.prototype.removeFromQuery = function removeFromQuery ( query ) {\n\t\tquery.remove( this.node );\n\t\tremoveFromArray( this.liveQueries, query );\n\t};\n\n\tElement.prototype.render = function render$1 ( target, occupants ) {\n\t\tvar this$1 = this;\n\n\t\t// TODO determine correct namespace\n\t\tthis.namespace = getNamespace( this );\n\n\t\tvar node;\n\t\tvar existing = false;\n\n\t\tif ( occupants ) {\n\t\t\tvar n;\n\t\t\twhile ( ( n = occupants.shift() ) ) {\n\t\t\t\tif ( n.nodeName.toUpperCase() === this$1.template.e.toUpperCase() && n.namespaceURI === this$1.namespace ) {\n\t\t\t\t\tthis$1.node = node = n;\n\t\t\t\t\texisting = true;\n\t\t\t\t\tbreak;\n\t\t\t\t} else {\n\t\t\t\t\tdetachNode( n );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif ( !node ) {\n\t\t\tnode = createElement( this.template.e, this.namespace, this.getAttribute( 'is' ) );\n\t\t\tthis.node = node;\n\t\t}\n\n\t\t// tie the node to this vdom element\n\t\tdefineProperty( node, '_ractive', {\n\t\t\tvalue: {\n\t\t\t\tproxy: this\n\t\t\t}\n\t\t});\n\n\t\t// Is this a top-level node of a component? If so, we may need to add\n\t\t// a data-ractive-css attribute, for CSS encapsulation\n\t\tif ( this.parentFragment.cssIds ) {\n\t\t\tnode.setAttribute( 'data-ractive-css', this.parentFragment.cssIds.map( function (x) { return (\"{\" + x + \"}\"); } ).join( ' ' ) );\n\t\t}\n\n\t\tif ( existing && this.foundNode ) { this.foundNode( node ); }\n\n\t\tif ( this.fragment ) {\n\t\t\tvar children = existing ? toArray( node.childNodes ) : undefined;\n\n\t\t\tthis.fragment.render( node, children );\n\n\t\t\t// clean up leftover children\n\t\t\tif ( children ) {\n\t\t\t\tchildren.forEach( detachNode );\n\t\t\t}\n\t\t}\n\n\t\tif ( existing ) {\n\t\t\t// store initial values for two-way binding\n\t\t\tif ( this.binding && this.binding.wasUndefined ) { this.binding.setFromNode( node ); }\n\t\t\t// remove unused attributes\n\t\t\tvar i = node.attributes.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tvar name = node.attributes[i].name;\n\t\t\t\tif ( !( name in this$1.attributeByName ) ) { node.removeAttribute( name ); }\n\t\t\t}\n\t\t}\n\n\t\tthis.attributes.forEach( render$1$1 );\n\n\t\tif ( this.binding ) { this.binding.render(); }\n\n\t\tupdateLiveQueries( this );\n\n\t\tif ( this._introTransition && this.ractive.transitionsEnabled ) {\n\t\t\tthis._introTransition.isIntro = true;\n\t\t\trunloop.registerTransition( this._introTransition );\n\t\t}\n\n\t\tif ( !existing ) {\n\t\t\ttarget.appendChild( node );\n\t\t}\n\n\t\tthis.rendered = true;\n\t};\n\n\tElement.prototype.shuffled = function shuffled () {\n\t\tthis.liveQueries.forEach( makeDirty$2 );\n\t\tContainerItem$$1.prototype.shuffled.call(this);\n\t};\n\n\tElement.prototype.toString = function toString () {\n\t\tvar tagName = this.template.e;\n\n\t\tvar attrs = this.attributes.map( stringifyAttribute ).join( '' );\n\n\t\t// Special case - selected options\n\t\tif ( this.name === 'option' && this.isSelected() ) {\n\t\t\tattrs += ' selected';\n\t\t}\n\n\t\t// Special case - two-way radio name bindings\n\t\tif ( this.name === 'input' && inputIsCheckedRadio( this ) ) {\n\t\t\tattrs += ' checked';\n\t\t}\n\n\t\t// Special case style and class attributes and directives\n\t\tvar style, cls;\n\t\tthis.attributes.forEach( function (attr) {\n\t\t\tif ( attr.name === 'class' ) {\n\t\t\t\tcls = ( cls || '' ) + ( cls ? ' ' : '' ) + safeAttributeString( attr.getString() );\n\t\t\t} else if ( attr.name === 'style' ) {\n\t\t\t\tstyle = ( style || '' ) + ( style ? ' ' : '' ) + safeAttributeString( attr.getString() );\n\t\t\t\tif ( style && !endsWithSemi.test( style ) ) { style += ';'; }\n\t\t\t} else if ( attr.styleName ) {\n\t\t\t\tstyle = ( style || '' ) + ( style ? ' ' : '' ) +  (decamelize( attr.styleName )) + \": \" + (safeAttributeString( attr.getString() )) + \";\";\n\t\t\t} else if ( attr.inlineClass && attr.getValue() ) {\n\t\t\t\tcls = ( cls || '' ) + ( cls ? ' ' : '' ) + attr.inlineClass;\n\t\t\t}\n\t\t});\n\t\t// put classes first, then inline style\n\t\tif ( style !== undefined ) { attrs = ' style' + ( style ? (\"=\\\"\" + style + \"\\\"\") : '' ) + attrs; }\n\t\tif ( cls !== undefined ) { attrs = ' class' + (cls ? (\"=\\\"\" + cls + \"\\\"\") : '') + attrs; }\n\n\t\tvar str = \"<\" + tagName + attrs + \">\";\n\n\t\tif ( this.isVoid ) { return str; }\n\n\t\t// Special case - textarea\n\t\tif ( this.name === 'textarea' && this.getAttribute( 'value' ) !== undefined ) {\n\t\t\tstr += escapeHtml( this.getAttribute( 'value' ) );\n\t\t}\n\n\t\t// Special case - contenteditable\n\t\telse if ( this.getAttribute( 'contenteditable' ) !== undefined ) {\n\t\t\tstr += ( this.getAttribute( 'value' ) || '' );\n\t\t}\n\n\t\tif ( this.fragment ) {\n\t\t\tstr += this.fragment.toString( !/^(?:script|style)$/i.test( this.template.e ) ); // escape text unless script/style\n\t\t}\n\n\t\tstr += \"</\" + tagName + \">\";\n\t\treturn str;\n\t};\n\n\tElement.prototype.unbind = function unbind$1 () {\n\t\tthis.attributes.forEach( unbind$1$1 );\n\n\t\tif ( this.binding ) { this.binding.unbind(); }\n\t\tif ( this.fragment ) { this.fragment.unbind(); }\n\t};\n\n\tElement.prototype.unrender = function unrender ( shouldDestroy ) {\n\t\tvar this$1 = this;\n\n\t\tif ( !this.rendered ) { return; }\n\t\tthis.rendered = false;\n\n\t\t// unrendering before intro completed? complete it now\n\t\t// TODO should be an API for aborting transitions\n\t\tvar transition = this._introTransition;\n\t\tif ( transition && transition.complete ) { transition.complete(); }\n\n\t\t// Detach as soon as we can\n\t\tif ( this.name === 'option' ) {\n\t\t\t// <option> elements detach immediately, so that\n\t\t\t// their parent <select> element syncs correctly, and\n\t\t\t// since option elements can't have transitions anyway\n\t\t\tthis.detach();\n\t\t} else if ( shouldDestroy ) {\n\t\t\trunloop.detachWhenReady( this );\n\t\t}\n\n\t\tif ( this.fragment ) { this.fragment.unrender(); }\n\n\t\tif ( this.binding ) { this.binding.unrender(); }\n\n\t\t// outro transition\n\t\tif ( this._outroTransition && this.ractive.transitionsEnabled ) {\n\t\t\tthis._outroTransition.isIntro = false;\n\t\t\trunloop.registerTransition( this._outroTransition );\n\t\t}\n\n\t\tthis.liveQueries.forEach( function (query) { return query.remove( this$1.node ); } );\n\t\tthis.liveQueries = [];\n\t\t// TODO forms are a special case\n\t};\n\n\tElement.prototype.update = function update$1 () {\n\t\tif ( this.dirty ) {\n\t\t\tthis.dirty = false;\n\n\t\t\tthis.attributes.forEach( update$1$1 );\n\n\t\t\tif ( this.fragment ) { this.fragment.update(); }\n\t\t}\n\t};\n\n\treturn Element;\n}(ContainerItem));\n\nvar toFront = [ 'min', 'max', 'class', 'type' ];\nfunction sortAttributes ( left, right ) {\n\tleft = left.name;\n\tright = right.name;\n\tvar l = left === 'value' ? 1 : ~toFront.indexOf( left );\n\tvar r = right === 'value' ? 1 : ~toFront.indexOf( right );\n\treturn l < r ? -1 : l > r ? 1 : 0;\n}\n\nfunction inputIsCheckedRadio ( element ) {\n\tvar nameAttr = element.attributeByName.name;\n\treturn element.getAttribute( 'type' ) === 'radio' &&\n\t\t( nameAttr || {} ).interpolator &&\n\t\telement.getAttribute( 'value' ) === nameAttr.interpolator.model.get();\n}\n\nfunction stringifyAttribute ( attribute ) {\n\tvar str = attribute.toString();\n\treturn str ? ' ' + str : '';\n}\n\nfunction getNamespace ( element ) {\n\t// Use specified namespace...\n\tvar xmlns$$1 = element.getAttribute( 'xmlns' );\n\tif ( xmlns$$1 ) { return xmlns$$1; }\n\n\t// ...or SVG namespace, if this is an <svg> element\n\tif ( element.name === 'svg' ) { return svg$1; }\n\n\tvar parent = element.parent;\n\n\tif ( parent ) {\n\t\t// ...or HTML, if the parent is a <foreignObject>\n\t\tif ( parent.name === 'foreignobject' ) { return html; }\n\n\t\t// ...or inherit from the parent node\n\t\treturn parent.node.namespaceURI;\n\t}\n\n\treturn element.ractive.el.namespaceURI;\n}\n\nvar Form = (function (Element$$1) {\n\tfunction Form ( options ) {\n\t\tElement$$1.call( this, options );\n\t\tthis.formBindings = [];\n\t}\n\n\tif ( Element$$1 ) Form.__proto__ = Element$$1;\n\tForm.prototype = Object.create( Element$$1 && Element$$1.prototype );\n\tForm.prototype.constructor = Form;\n\n\tForm.prototype.render = function render ( target, occupants ) {\n\t\tElement$$1.prototype.render.call( this, target, occupants );\n\t\tthis.node.addEventListener( 'reset', handleReset, false );\n\t};\n\n\tForm.prototype.unrender = function unrender ( shouldDestroy ) {\n\t\tthis.node.removeEventListener( 'reset', handleReset, false );\n\t\tElement$$1.prototype.unrender.call( this, shouldDestroy );\n\t};\n\n\treturn Form;\n}(Element));\n\nfunction handleReset () {\n\tvar element = this._ractive.proxy;\n\n\trunloop.start();\n\telement.formBindings.forEach( updateModel$2 );\n\trunloop.end();\n}\n\nfunction updateModel$2 ( binding ) {\n\tbinding.model.set( binding.resetValue );\n}\n\nvar DOMEvent = function DOMEvent ( name, owner ) {\n\tif ( name.indexOf( '*' ) !== -1 ) {\n\t\tfatal( (\"Only component proxy-events may contain \\\"*\\\" wildcards, <\" + (owner.name) + \" on-\" + name + \"=\\\"...\\\"/> is not valid\") );\n\t}\n\n\tthis.name = name;\n\tthis.owner = owner;\n\tthis.node = null;\n\tthis.handler = null;\n};\n\nDOMEvent.prototype.listen = function listen ( directive ) {\n\t\tvar node = this.node = this.owner.node;\n\tvar name = this.name;\n\n\t// this is probably a custom event fired from a decorator or manually\n\t\tif ( !( (\"on\" + name) in node ) ) { return; }\n\n\tnode.addEventListener( name, this.handler = function( event ) {\n\t\tdirective.fire({\n\t\t\tnode: node,\n\t\t\toriginal: event\n\t\t});\n\t}, false );\n};\n\nDOMEvent.prototype.unlisten = function unlisten () {\n\tif ( this.handler ) { this.node.removeEventListener( this.name, this.handler, false ); }\n};\n\nvar CustomEvent = function CustomEvent ( eventPlugin, owner ) {\n\tthis.eventPlugin = eventPlugin;\n\tthis.owner = owner;\n\tthis.handler = null;\n};\n\nCustomEvent.prototype.listen = function listen ( directive ) {\n\tvar node = this.owner.node;\n\n\tthis.handler = this.eventPlugin( node, function ( event ) {\n\t\t\tif ( event === void 0 ) event = {};\n\n\t\tevent.node = event.node || node;\n\t\tdirective.fire( event );\n\t\t});\n\t};\n\n\tCustomEvent.prototype.unlisten = function unlisten () {\n\t\tthis.handler.teardown();\n};\n\nvar RactiveEvent = function RactiveEvent ( component, name ) {\n\tthis.component = component;\n\tthis.name = name;\n\tthis.handler = null;\n};\n\nRactiveEvent.prototype.listen = function listen ( directive ) {\n\tvar ractive = this.component.instance;\n\n\tthis.handler = ractive.on( this.name, function () {\n\t\tvar event;\n\n\t\t// semi-weak test, but what else? tag the event obj ._isEvent ?\n\t\tif ( arguments.length && arguments[0] && arguments[0].node ) {\n\t\t\tevent = Array.prototype.shift.call( arguments );\n\t\t\tevent.component = ractive;\n\t\t}\n\n\t\tvar args = Array.prototype.slice.call( arguments );\n\t\tdirective.fire( event, args );\n\n\t\t// cancel bubbling\n\t\treturn false;\n\t});\n};\n\nRactiveEvent.prototype.unlisten = function unlisten () {\n\tthis.handler.cancel();\n};\n\nvar specialPattern = /^(event|arguments)(\\..+)?$/;\nvar dollarArgsPattern = /^\\$(\\d+)(\\..+)?$/;\n\nvar EventDirective = function EventDirective ( options ) {\n\tvar this$1 = this;\n\n\tthis.owner = options.owner || options.parentFragment.owner || findElement( options.parentFragment );\n\tthis.element = this.owner.attributeByName ? this.owner : findElement( options.parentFragment, true );\n\tthis.template = options.template;\n\tthis.parentFragment = options.parentFragment;\n\tthis.ractive = options.parentFragment.ractive;\n\n\tthis.events = [];\n\n\tif ( this.element.type === COMPONENT || this.element.type === ANCHOR ) {\n\t\tthis.template.n.forEach( function (n) {\n\t\t\tthis$1.events.push( new RactiveEvent( this$1.element, n ) );\n\t\t});\n\t} else {\n\t\tthis.template.n.forEach( function (n) {\n\t\t\tvar fn = findInViewHierarchy( 'events', this$1.ractive, n );\n\t\t\t// we need to pass in \"this\" in order to get\n\t\t\t// access to node when it is created.\n\t\t\tthis$1.events.push( fn ? new CustomEvent( fn, this$1.element ) : new DOMEvent( n, this$1.element ) );\n\t\t});\n\t}\n\n\t// method calls\n\tthis.resolvers = null;\n\tthis.models = null;\n};\n\nEventDirective.prototype.bind = function bind () {\n\taddToArray( this.element.events, this );\n\n\tsetupArgsFn( this, this.template, this.parentFragment, {\n\t\tspecialRef: function specialRef ( ref ) {\n\t\t\tvar specialMatch = specialPattern.exec( ref );\n\t\t\tif ( specialMatch ) {\n\t\t\t\t// on-click=\"foo(event.node)\"\n\t\t\t\treturn {\n\t\t\t\t\tspecial: specialMatch[1],\n\t\t\t\t\tkeys: specialMatch[2] ? splitKeypath( specialMatch[2].substr(1) ) : []\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tvar dollarMatch = dollarArgsPattern.exec( ref );\n\t\t\tif ( dollarMatch ) {\n\t\t\t\t// on-click=\"foo($1)\"\n\t\t\t\treturn {\n\t\t\t\t\tspecial: 'arguments',\n\t\t\t\t\tkeys: [ dollarMatch[1] - 1 ].concat( dollarMatch[2] ? splitKeypath( dollarMatch[2].substr( 1 ) ) : [] )\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t});\n\tif ( !this.fn ) { this.action = this.template.f; }\n};\n\nEventDirective.prototype.bubble = function bubble () {\n\tif ( !this.dirty ) {\n\t\tthis.dirty = true;\n\t\tthis.owner.bubble();\n\t}\n};\n\nEventDirective.prototype.destroyed = function destroyed () {\n\tthis.events.forEach( function (e) { return e.unlisten(); } );\n};\n\nEventDirective.prototype.fire = function fire ( event, passedArgs ) {\n\t\tif ( passedArgs === void 0 ) passedArgs = [];\n\n\n\t// augment event object\n\tif ( event && !event.hasOwnProperty( '_element' ) ) {\n\t\t   addHelpers( event, this.owner );\n\t}\n\n\tif ( this.fn ) {\n\t\tvar values = [];\n\n\t\tif ( event ) { passedArgs.unshift( event ); }\n\n\t\tif ( this.models ) {\n\t\t\tthis.models.forEach( function (model) {\n\t\t\t\tif ( !model ) { return values.push( undefined ); }\n\n\t\t\t\tif ( model.special ) {\n\t\t\t\t\tvar obj = model.special === 'event' ? event : passedArgs;\n\t\t\t\t\tvar keys = model.keys.slice();\n\n\t\t\t\t\twhile ( keys.length ) { obj = obj[ keys.shift() ]; }\n\t\t\t\t\treturn values.push( obj );\n\t\t\t\t}\n\n\t\t\t\tif ( model.wrapper ) {\n\t\t\t\t\treturn values.push( model.wrapperValue );\n\t\t\t\t}\n\n\t\t\t\tvalues.push( model.get() );\n\t\t\t});\n\t\t}\n\n\t\t// make event available as `this.event`\n\t\tvar ractive = this.ractive;\n\t\tvar oldEvent = ractive.event;\n\n\t\tractive.event = event;\n\t\tvar result = this.fn.apply( ractive, values ).pop();\n\n\t\t// Auto prevent and stop if return is explicitly false\n\t\tif ( result === false ) {\n\t\t\tvar original = event ? event.original : undefined;\n\t\t\tif ( original ) {\n\t\t\t\toriginal.preventDefault && original.preventDefault();\n\t\t\t\toriginal.stopPropagation && original.stopPropagation();\n\t\t\t} else {\n\t\t\t\twarnOnceIfDebug( (\"handler '\" + (this.template.n.join( ' ' )) + \"' returned false, but there is no event available to cancel\") );\n\t\t\t}\n\t\t}\n\n\t\tractive.event = oldEvent;\n\t}\n\n\telse {\n\t\tvar args = [];\n\t\tif ( passedArgs.length ) { args = args.concat( passedArgs ); }\n\t\tif ( event ) { event.name = this.action; }\n\n\t\tfireEvent( this.ractive, this.action, {\n\t\t\tevent: event,\n\t\t\targs: args\n\t\t});\n\t}\n};\n\nEventDirective.prototype.handleChange = function handleChange () {};\n\nEventDirective.prototype.rebinding = function rebinding ( next, previous ) {\n\t\tvar this$1 = this;\n\n\tif ( !this.models ) { return; }\n\tvar idx = this.models.indexOf( previous );\n\n\tif ( ~idx ) {\n\t\tthis.models.splice( idx, 1, next );\n\t\tprevious.unregister( this );\n\t\tif ( next ) { next.addShuffleTask( function () { return next.register( this$1 ); } ); }\n\t}\n};\n\nEventDirective.prototype.render = function render () {\n\t\tvar this$1 = this;\n\n\t// render events after everything else, so they fire after bindings\n\trunloop.scheduleTask( function () { return this$1.events.forEach( function (e) { return e.listen( this$1 ); }, true ); } );\n};\n\nEventDirective.prototype.toString = function toString () { return ''; };\n\nEventDirective.prototype.unbind = function unbind () {\n\tremoveFromArray( this.element.events, this );\n\n\tteardownArgsFn( this, this.template );\n};\n\nEventDirective.prototype.unrender = function unrender () {\n\tthis.events.forEach( function (e) { return e.unlisten(); } );\n};\n\nEventDirective.prototype.update = function update () {\n\t// noop\n};\n\nvar Mustache = (function (Item$$1) {\n\tfunction Mustache ( options ) {\n\t\tItem$$1.call( this, options );\n\n\t\tthis.parentFragment = options.parentFragment;\n\t\tthis.template = options.template;\n\t\tthis.index = options.index;\n\t\tif ( options.owner ) { this.parent = options.owner; }\n\n\t\tthis.isStatic = !!options.template.s;\n\n\t\tthis.model = null;\n\t\tthis.dirty = false;\n\t}\n\n\tif ( Item$$1 ) Mustache.__proto__ = Item$$1;\n\tMustache.prototype = Object.create( Item$$1 && Item$$1.prototype );\n\tMustache.prototype.constructor = Mustache;\n\n\tMustache.prototype.bind = function bind () {\n\t\tvar this$1 = this;\n\n\t\t// yield mustaches should resolve in container context\n\t\tvar start = this.containerFragment || this.parentFragment;\n\t\t// try to find a model for this view\n\t\tvar model = resolve$3( start, this.template );\n\t\tvar value = model ? model.get() : undefined;\n\n\t\tif ( this.isStatic ) {\n\t\t\tthis.model = { get: function () { return value; } };\n\t\t\treturn;\n\t\t}\n\n\t\tif ( model ) {\n\t\t\tmodel.register( this );\n\t\t\tthis.model = model;\n\t\t} else {\n\t\t\tthis.resolver = start.resolve( this.template.r, function (model) {\n\t\t\t\tthis$1.model = model;\n\t\t\t\tmodel.register( this$1 );\n\n\t\t\t\tthis$1.handleChange();\n\t\t\t\tthis$1.resolver = null;\n\t\t\t});\n\t\t}\n\t};\n\n\tMustache.prototype.handleChange = function handleChange () {\n\t\tthis.bubble();\n\t};\n\n\tMustache.prototype.rebinding = function rebinding ( next, previous, safe ) {\n\t\tnext = rebindMatch( this.template, next, previous );\n\t\tif ( this.static ) { return false; }\n\t\tif ( next === this.model ) { return false; }\n\n\t\tif ( this.model ) {\n\t\t\tthis.model.unregister( this );\n\t\t}\n\t\tif ( next ) { next.addShuffleRegister( this, 'mark' ); }\n\t\tthis.model = next;\n\t\tif ( !safe ) { this.handleChange(); }\n\t\treturn true;\n\t};\n\n\tMustache.prototype.unbind = function unbind () {\n\t\tif ( !this.isStatic ) {\n\t\t\tthis.model && this.model.unregister( this );\n\t\t\tthis.model = undefined;\n\t\t\tthis.resolver && this.resolver.unbind();\n\t\t}\n\t};\n\n\treturn Mustache;\n}(Item));\n\nvar MustacheContainer = (function (ContainerItem$$1) {\n\tfunction MustacheContainer ( options ) {\n\t\tContainerItem$$1.call( this, options );\n\t}\n\n\tif ( ContainerItem$$1 ) MustacheContainer.__proto__ = ContainerItem$$1;\n\tMustacheContainer.prototype = Object.create( ContainerItem$$1 && ContainerItem$$1.prototype );\n\tMustacheContainer.prototype.constructor = MustacheContainer;\n\n\treturn MustacheContainer;\n}(ContainerItem));\nvar proto$1 = MustacheContainer.prototype;\nvar mustache = Mustache.prototype;\nproto$1.bind = mustache.bind;\nproto$1.handleChange = mustache.handleChange;\nproto$1.rebinding = mustache.rebinding;\nproto$1.unbind = mustache.unbind;\n\nvar Interpolator = (function (Mustache$$1) {\n\tfunction Interpolator () {\n\t\tMustache$$1.apply(this, arguments);\n\t}\n\n\tif ( Mustache$$1 ) Interpolator.__proto__ = Mustache$$1;\n\tInterpolator.prototype = Object.create( Mustache$$1 && Mustache$$1.prototype );\n\tInterpolator.prototype.constructor = Interpolator;\n\n\tInterpolator.prototype.bubble = function bubble () {\n\t\tif ( this.owner ) { this.owner.bubble(); }\n\t\tMustache$$1.prototype.bubble.call(this);\n\t};\n\n\tInterpolator.prototype.detach = function detach () {\n\t\treturn detachNode( this.node );\n\t};\n\n\tInterpolator.prototype.firstNode = function firstNode () {\n\t\treturn this.node;\n\t};\n\n\tInterpolator.prototype.getString = function getString () {\n\t\treturn this.model ? safeToStringValue( this.model.get() ) : '';\n\t};\n\n\tInterpolator.prototype.render = function render ( target, occupants ) {\n\t\tif ( inAttributes() ) { return; }\n\t\tvar value = this.getString();\n\n\t\tthis.rendered = true;\n\n\t\tif ( occupants ) {\n\t\t\tvar n = occupants[0];\n\t\t\tif ( n && n.nodeType === 3 ) {\n\t\t\t\toccupants.shift();\n\t\t\t\tif ( n.nodeValue !== value ) {\n\t\t\t\t\tn.nodeValue = value;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tn = this.node = doc.createTextNode( value );\n\t\t\t\tif ( occupants[0] ) {\n\t\t\t\t\ttarget.insertBefore( n, occupants[0] );\n\t\t\t\t} else {\n\t\t\t\t\ttarget.appendChild( n );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.node = n;\n\t\t} else {\n\t\t\tthis.node = doc.createTextNode( value );\n\t\t\ttarget.appendChild( this.node );\n\t\t}\n\t};\n\n\tInterpolator.prototype.toString = function toString ( escape ) {\n\t\tvar string = this.getString();\n\t\treturn escape ? escapeHtml( string ) : string;\n\t};\n\n\tInterpolator.prototype.unrender = function unrender ( shouldDestroy ) {\n\t\tif ( shouldDestroy ) { this.detach(); }\n\t\tthis.rendered = false;\n\t};\n\n\tInterpolator.prototype.update = function update () {\n\t\tif ( this.dirty ) {\n\t\t\tthis.dirty = false;\n\t\t\tif ( this.rendered ) {\n\t\t\t\tthis.node.data = this.getString();\n\t\t\t}\n\t\t}\n\t};\n\n\tInterpolator.prototype.valueOf = function valueOf () {\n\t\treturn this.model ? this.model.get() : undefined;\n\t};\n\n\treturn Interpolator;\n}(Mustache));\n\nvar Input = (function (Element$$1) {\n\tfunction Input () {\n\t\tElement$$1.apply(this, arguments);\n\t}\n\n\tif ( Element$$1 ) Input.__proto__ = Element$$1;\n\tInput.prototype = Object.create( Element$$1 && Element$$1.prototype );\n\tInput.prototype.constructor = Input;\n\n\tInput.prototype.render = function render ( target, occupants ) {\n\t\tElement$$1.prototype.render.call( this, target, occupants );\n\t\tthis.node.defaultValue = this.node.value;\n\t};\n\n\treturn Input;\n}(Element));\n\n// simple JSON parser, without the restrictions of JSON parse\n// (i.e. having to double-quote keys).\n//\n// If passed a hash of values as the second argument, ${placeholders}\n// will be replaced with those values\n\nvar specials$2 = {\n\ttrue: true,\n\tfalse: false,\n\tnull: null,\n\tundefined: undefined\n};\n\nvar specialsPattern = new RegExp( '^(?:' + Object.keys( specials$2 ).join( '|' ) + ')' );\nvar numberPattern$1 = /^(?:[+-]?)(?:(?:(?:0|[1-9]\\d*)?\\.\\d+)|(?:(?:0|[1-9]\\d*)\\.)|(?:0|[1-9]\\d*))(?:[eE][+-]?\\d+)?/;\nvar placeholderPattern = /\\$\\{([^\\}]+)\\}/g;\nvar placeholderAtStartPattern = /^\\$\\{([^\\}]+)\\}/;\nvar onlyWhitespace = /^\\s*$/;\n\nvar JsonParser = Parser.extend({\n\tinit: function init ( str, options ) {\n\t\tthis.values = options.values;\n\t\tthis.allowWhitespace();\n\t},\n\n\tpostProcess: function postProcess ( result ) {\n\t\tif ( result.length !== 1 || !onlyWhitespace.test( this.leftover ) ) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn { value: result[0].v };\n\t},\n\n\tconverters: [\n\t\tfunction getPlaceholder ( parser ) {\n\t\t\tif ( !parser.values ) { return null; }\n\n\t\t\tvar placeholder = parser.matchPattern( placeholderAtStartPattern );\n\n\t\t\tif ( placeholder && ( parser.values.hasOwnProperty( placeholder ) ) ) {\n\t\t\t\treturn { v: parser.values[ placeholder ] };\n\t\t\t}\n\t\t},\n\n\t\tfunction getSpecial ( parser ) {\n\t\t\tvar special = parser.matchPattern( specialsPattern );\n\t\t\tif ( special ) { return { v: specials$2[ special ] }; }\n\t\t},\n\n\t\tfunction getNumber ( parser ) {\n\t\t\tvar number = parser.matchPattern( numberPattern$1 );\n\t\t\tif ( number ) { return { v: +number }; }\n\t\t},\n\n\t\tfunction getString ( parser ) {\n\t\t\tvar stringLiteral = readStringLiteral( parser );\n\t\t\tvar values = parser.values;\n\n\t\t\tif ( stringLiteral && values ) {\n\t\t\t\treturn {\n\t\t\t\t\tv: stringLiteral.v.replace( placeholderPattern, function ( match, $1 ) { return ( $1 in values ? values[ $1 ] : $1 ); } )\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn stringLiteral;\n\t\t},\n\n\t\tfunction getObject ( parser ) {\n\t\t\tif ( !parser.matchString( '{' ) ) { return null; }\n\n\t\t\tvar result = {};\n\n\t\t\tparser.allowWhitespace();\n\n\t\t\tif ( parser.matchString( '}' ) ) {\n\t\t\t\treturn { v: result };\n\t\t\t}\n\n\t\t\tvar pair;\n\t\t\twhile ( pair = getKeyValuePair( parser ) ) {\n\t\t\t\tresult[ pair.key ] = pair.value;\n\n\t\t\t\tparser.allowWhitespace();\n\n\t\t\t\tif ( parser.matchString( '}' ) ) {\n\t\t\t\t\treturn { v: result };\n\t\t\t\t}\n\n\t\t\t\tif ( !parser.matchString( ',' ) ) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\n\t\tfunction getArray ( parser ) {\n\t\t\tif ( !parser.matchString( '[' ) ) { return null; }\n\n\t\t\tvar result = [];\n\n\t\t\tparser.allowWhitespace();\n\n\t\t\tif ( parser.matchString( ']' ) ) {\n\t\t\t\treturn { v: result };\n\t\t\t}\n\n\t\t\tvar valueToken;\n\t\t\twhile ( valueToken = parser.read() ) {\n\t\t\t\tresult.push( valueToken.v );\n\n\t\t\t\tparser.allowWhitespace();\n\n\t\t\t\tif ( parser.matchString( ']' ) ) {\n\t\t\t\t\treturn { v: result };\n\t\t\t\t}\n\n\t\t\t\tif ( !parser.matchString( ',' ) ) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tparser.allowWhitespace();\n\t\t\t}\n\n\t\t\treturn null;\n\t\t}\n\t]\n});\n\nfunction getKeyValuePair ( parser ) {\n\tparser.allowWhitespace();\n\n\tvar key = readKey( parser );\n\n\tif ( !key ) { return null; }\n\n\tvar pair = { key: key };\n\n\tparser.allowWhitespace();\n\tif ( !parser.matchString( ':' ) ) {\n\t\treturn null;\n\t}\n\tparser.allowWhitespace();\n\n\tvar valueToken = parser.read();\n\n\tif ( !valueToken ) { return null; }\n\n\tpair.value = valueToken.v;\n\treturn pair;\n}\n\nvar parseJSON = function ( str, values ) {\n\tvar parser = new JsonParser( str, { values: values });\n\treturn parser.result;\n};\n\nvar Mapping = (function (Item$$1) {\n\tfunction Mapping ( options ) {\n\t\tItem$$1.call( this, options );\n\n\t\tthis.name = options.template.n;\n\n\t\tthis.owner = options.owner || options.parentFragment.owner || options.element || findElement( options.parentFragment );\n\t\tthis.element = options.element || (this.owner.attributeByName ? this.owner : findElement( options.parentFragment ) );\n\t\tthis.parentFragment = this.element.parentFragment; // shared\n\t\tthis.ractive = this.parentFragment.ractive;\n\n\t\tthis.fragment = null;\n\n\t\tthis.element.attributeByName[ this.name ] = this;\n\n\t\tthis.value = options.template.f;\n\t}\n\n\tif ( Item$$1 ) Mapping.__proto__ = Item$$1;\n\tMapping.prototype = Object.create( Item$$1 && Item$$1.prototype );\n\tMapping.prototype.constructor = Mapping;\n\n\tMapping.prototype.bind = function bind () {\n\t\tif ( this.fragment ) {\n\t\t\tthis.fragment.bind();\n\t\t}\n\n\t\tvar template = this.template.f;\n\t\tvar viewmodel = this.element.instance.viewmodel;\n\n\t\tif ( template === 0 ) {\n\t\t\t// empty attributes are `true`\n\t\t\tviewmodel.joinKey( this.name ).set( true );\n\t\t}\n\n\t\telse if ( typeof template === 'string' ) {\n\t\t\tvar parsed = parseJSON( template );\n\t\t\tviewmodel.joinKey( this.name ).set( parsed ? parsed.value : template );\n\t\t}\n\n\t\telse if ( isArray( template ) ) {\n\t\t\tcreateMapping( this, true );\n\t\t}\n\t};\n\n\tMapping.prototype.render = function render () {};\n\n\tMapping.prototype.unbind = function unbind () {\n\t\tif ( this.fragment ) { this.fragment.unbind(); }\n\t\tif ( this.boundFragment ) { this.boundFragment.unbind(); }\n\n\t\tif ( this.element.bound ) {\n\t\t\tif ( this.link.target === this.model ) { this.link.owner.unlink(); }\n\t\t}\n\t};\n\n\tMapping.prototype.unrender = function unrender () {};\n\n\tMapping.prototype.update = function update () {\n\t\tif ( this.dirty ) {\n\t\t\tthis.dirty = false;\n\t\t\tif ( this.fragment ) { this.fragment.update(); }\n\t\t\tif ( this.boundFragment ) { this.boundFragment.update(); }\n\t\t\tif ( this.rendered ) { this.updateDelegate(); }\n\t\t}\n\t};\n\n\treturn Mapping;\n}(Item));\n\nfunction createMapping ( item ) {\n\tvar template = item.template.f;\n\tvar viewmodel = item.element.instance.viewmodel;\n\tvar childData = viewmodel.value;\n\n\tif ( template.length === 1 && template[0].t === INTERPOLATOR ) {\n\t\titem.model = resolve$3( item.parentFragment, template[0] );\n\n\t\tif ( !item.model ) {\n\t\t\twarnOnceIfDebug( (\"The \" + (item.name) + \"='{{\" + (template[0].r) + \"}}' mapping is ambiguous, and may cause unexpected results. Consider initialising your data to eliminate the ambiguity\"), { ractive: item.element.instance }); // TODO add docs page explaining item\n\t\t\titem.parentFragment.ractive.get( item.name ); // side-effect: create mappings as necessary\n\t\t\titem.model = item.parentFragment.findContext().joinKey( item.name );\n\t\t}\n\n\t\titem.link = viewmodel.createLink( item.name, item.model, template[0].r );\n\n\t\tif ( item.model.get() === undefined && item.name in childData ) {\n\t\t\titem.model.set( childData[ item.name ] );\n\t\t}\n\t}\n\n\telse {\n\t\titem.boundFragment = new Fragment({\n\t\t\towner: item,\n\t\t\ttemplate: template\n\t\t}).bind();\n\n\t\titem.model = viewmodel.joinKey( item.name );\n\t\titem.model.set( item.boundFragment.valueOf() );\n\n\t\t// item is a *bit* of a hack\n\t\titem.boundFragment.bubble = function () {\n\t\t\tFragment.prototype.bubble.call( item.boundFragment );\n\t\t\t// defer this to avoid mucking around model deps if there happens to be an expression involved\n\t\t\trunloop.scheduleTask(function () {\n\t\t\t\titem.boundFragment.update();\n\t\t\t\titem.model.set( item.boundFragment.valueOf() );\n\t\t\t});\n\t\t};\n\t}\n}\n\nvar Option = (function (Element$$1) {\n\tfunction Option ( options ) {\n\t\tvar template = options.template;\n\t\tif ( !template.a ) { template.a = {}; }\n\n\t\t// If the value attribute is missing, use the element's content,\n\t\t// as long as it isn't disabled\n\t\tif ( template.a.value === undefined && !( 'disabled' in template.a ) ) {\n\t\t\ttemplate.a.value = template.f || '';\n\t\t}\n\n\t\tElement$$1.call( this, options );\n\n\t\tthis.select = findElement( this.parent || this.parentFragment, false, 'select' );\n\t}\n\n\tif ( Element$$1 ) Option.__proto__ = Element$$1;\n\tOption.prototype = Object.create( Element$$1 && Element$$1.prototype );\n\tOption.prototype.constructor = Option;\n\n\tOption.prototype.bind = function bind () {\n\t\tif ( !this.select ) {\n\t\t\tElement$$1.prototype.bind.call(this);\n\t\t\treturn;\n\t\t}\n\n\t\t// If the select has a value, it overrides the `selected` attribute on\n\t\t// this option - so we delete the attribute\n\t\tvar selectedAttribute = this.attributeByName.selected;\n\t\tif ( selectedAttribute && this.select.getAttribute( 'value' ) !== undefined ) {\n\t\t\tvar index = this.attributes.indexOf( selectedAttribute );\n\t\t\tthis.attributes.splice( index, 1 );\n\t\t\tdelete this.attributeByName.selected;\n\t\t}\n\n\t\tElement$$1.prototype.bind.call(this);\n\t\tthis.select.options.push( this );\n\t};\n\n\tOption.prototype.bubble = function bubble () {\n\t\t// if we're using content as value, may need to update here\n\t\tvar value = this.getAttribute( 'value' );\n\t\tif ( this.node && this.node.value !== value ) {\n\t\t\tthis.node._ractive.value = value;\n\t\t}\n\t\tElement$$1.prototype.bubble.call(this);\n\t};\n\n\tOption.prototype.getAttribute = function getAttribute ( name ) {\n\t\tvar attribute = this.attributeByName[ name ];\n\t\treturn attribute ? attribute.getValue() : name === 'value' && this.fragment ? this.fragment.valueOf() : undefined;\n\t};\n\n\tOption.prototype.isSelected = function isSelected () {\n\t\tvar optionValue = this.getAttribute( 'value' );\n\n\t\tif ( optionValue === undefined || !this.select ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tvar selectValue = this.select.getAttribute( 'value' );\n\n\t\tif ( selectValue == optionValue ) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif ( this.select.getAttribute( 'multiple' ) && isArray( selectValue ) ) {\n\t\t\tvar i = selectValue.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tif ( selectValue[i] == optionValue ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\tOption.prototype.render = function render ( target, occupants ) {\n\t\tElement$$1.prototype.render.call( this, target, occupants );\n\n\t\tif ( !this.attributeByName.value ) {\n\t\t\tthis.node._ractive.value = this.getAttribute( 'value' );\n\t\t}\n\t};\n\n\tOption.prototype.unbind = function unbind () {\n\t\tElement$$1.prototype.unbind.call(this);\n\n\t\tif ( this.select ) {\n\t\t\tremoveFromArray( this.select.options, this );\n\t\t}\n\t};\n\n\treturn Option;\n}(Element));\n\nfunction getPartialTemplate ( ractive, name, parentFragment ) {\n\t// If the partial in instance or view heirarchy instances, great\n\tvar partial = getPartialFromRegistry( ractive, name, parentFragment || {} );\n\tif ( partial ) { return partial; }\n\n\t// Does it exist on the page as a script tag?\n\tpartial = parser.fromId( name, { noThrow: true } );\n\tif ( partial ) {\n\t\t// parse and register to this ractive instance\n\t\tvar parsed = parser.parseFor( partial, ractive );\n\n\t\t// register extra partials on the ractive instance if they don't already exist\n\t\tif ( parsed.p ) { fillGaps( ractive.partials, parsed.p ); }\n\n\t\t// register (and return main partial if there are others in the template)\n\t\treturn ractive.partials[ name ] = parsed.t;\n\t}\n}\n\nfunction getPartialFromRegistry ( ractive, name, parentFragment ) {\n\t// if there was an instance up-hierarchy, cool\n\tvar partial = findParentPartial( name, parentFragment.owner );\n\tif ( partial ) { return partial; }\n\n\t// find first instance in the ractive or view hierarchy that has this partial\n\tvar instance = findInstance( 'partials', ractive, name );\n\n\tif ( !instance ) { return; }\n\n\tpartial = instance.partials[ name ];\n\n\t// partial is a function?\n\tvar fn;\n\tif ( typeof partial === 'function' ) {\n\t\tfn = partial.bind( instance );\n\t\tfn.isOwner = instance.partials.hasOwnProperty(name);\n\t\tpartial = fn.call( ractive, parser );\n\t}\n\n\tif ( !partial && partial !== '' ) {\n\t\twarnIfDebug( noRegistryFunctionReturn, name, 'partial', 'partial', { ractive: ractive });\n\t\treturn;\n\t}\n\n\t// If this was added manually to the registry,\n\t// but hasn't been parsed, parse it now\n\tif ( !parser.isParsed( partial ) ) {\n\t\t// use the parseOptions of the ractive instance on which it was found\n\t\tvar parsed = parser.parseFor( partial, instance );\n\n\t\t// Partials cannot contain nested partials!\n\t\t// TODO add a test for this\n\t\tif ( parsed.p ) {\n\t\t\twarnIfDebug( 'Partials ({{>%s}}) cannot contain nested inline partials', name, { ractive: ractive });\n\t\t}\n\n\t\t// if fn, use instance to store result, otherwise needs to go\n\t\t// in the correct point in prototype chain on instance or constructor\n\t\tvar target = fn ? instance : findOwner( instance, name );\n\n\t\t// may be a template with partials, which need to be registered and main template extracted\n\t\ttarget.partials[ name ] = partial = parsed.t;\n\t}\n\n\t// store for reset\n\tif ( fn ) { partial._fn = fn; }\n\n\treturn partial.v ? partial.t : partial;\n}\n\nfunction findOwner ( ractive, key ) {\n\treturn ractive.partials.hasOwnProperty( key )\n\t\t? ractive\n\t\t: findConstructor( ractive.constructor, key);\n}\n\nfunction findConstructor ( constructor, key ) {\n\tif ( !constructor ) { return; }\n\treturn constructor.partials.hasOwnProperty( key )\n\t\t? constructor\n\t\t: findConstructor( constructor._Parent, key );\n}\n\nfunction findParentPartial( name, parent ) {\n\tif ( parent ) {\n\t\tif ( parent.template && parent.template.p && parent.template.p[name] ) {\n\t\t\treturn parent.template.p[name];\n\t\t} else if ( parent.parentFragment && parent.parentFragment.owner ) {\n\t\t\treturn findParentPartial( name, parent.parentFragment.owner );\n\t\t}\n\t}\n}\n\nvar Partial = (function (MustacheContainer$$1) {\n\tfunction Partial ( options ) {\n\t\tMustacheContainer$$1.call( this, options );\n\n\t\tthis.yielder = options.template.t === YIELDER;\n\n\t\tif ( this.yielder ) {\n\t\t\tthis.container = options.parentFragment.ractive;\n\t\t\tthis.component = this.container.component;\n\n\t\t\tthis.containerFragment = options.parentFragment;\n\t\t\tthis.parentFragment = this.component.parentFragment;\n\n\t\t\t// {{yield}} is equivalent to {{yield content}}\n\t\t\tif ( !options.template.r && !options.template.rx && !options.template.x ) { options.template.r = 'content'; }\n\t\t}\n\t}\n\n\tif ( MustacheContainer$$1 ) Partial.__proto__ = MustacheContainer$$1;\n\tPartial.prototype = Object.create( MustacheContainer$$1 && MustacheContainer$$1.prototype );\n\tPartial.prototype.constructor = Partial;\n\n\tPartial.prototype.bind = function bind () {\n\t\tvar this$1 = this;\n\n\t\t// keep track of the reference name for future resets\n\t\tthis.refName = this.template.r;\n\n\t\t// name matches take priority over expressions\n\t\tvar template = this.refName ? getPartialTemplate( this.ractive, this.refName, this.parentFragment ) || null : null;\n\t\tvar templateObj;\n\n\t\tif ( template ) {\n\t\t\tthis.named = true;\n\t\t\tthis.setTemplate( this.template.r, template );\n\t\t}\n\n\t\tif ( !template ) {\n\t\t\tMustacheContainer$$1.prototype.bind.call(this);\n\t\t\tif ( this.model && ( templateObj = this.model.get() ) && typeof templateObj === 'object' && ( typeof templateObj.template === 'string' || isArray( templateObj.t ) ) ) {\n\t\t\t\tif ( templateObj.template ) {\n\t\t\t\t\tthis.source = templateObj.template;\n\t\t\t\t\ttemplateObj = parsePartial( this.template.r, templateObj.template, this.ractive );\n\t\t\t\t} else {\n\t\t\t\t\tthis.source = templateObj.t;\n\t\t\t\t}\n\t\t\t\tthis.setTemplate( this.template.r, templateObj.t );\n\t\t\t} else if ( ( !this.model || typeof this.model.get() !== 'string' ) && this.refName ) {\n\t\t\t\tthis.setTemplate( this.refName, template );\n\t\t\t} else {\n\t\t\t\tthis.setTemplate( this.model.get() );\n\t\t\t}\n\t\t}\n\n\t\tvar options = {\n\t\t\towner: this,\n\t\t\ttemplate: this.partialTemplate\n\t\t};\n\n\t\tif ( this.template.c ) {\n\t\t\toptions.template = [{ t: SECTION, n: SECTION_WITH, f: options.template }];\n\t\t\tfor ( var k in this.template.c ) {\n\t\t\t\toptions.template[0][k] = this$1.template.c[k];\n\t\t\t}\n\t\t}\n\n\t\tif ( this.yielder ) {\n\t\t\toptions.ractive = this.container.parent;\n\t\t}\n\n\t\tthis.fragment = new Fragment(options);\n\t\tif ( this.template.z ) {\n\t\t\tthis.fragment.aliases = resolveAliases( this.template.z, this.yielder ? this.containerFragment : this.parentFragment );\n\t\t}\n\t\tthis.fragment.bind();\n\t};\n\n\tPartial.prototype.bubble = function bubble () {\n\t\tif ( this.yielder && !this.dirty ) {\n\t\t\tthis.containerFragment.bubble();\n\t\t\tthis.dirty = true;\n\t\t} else {\n\t\t\tMustacheContainer$$1.prototype.bubble.call(this);\n\t\t}\n\t};\n\n\tPartial.prototype.findNextNode = function findNextNode () {\n\t\treturn this.yielder ? this.containerFragment.findNextNode( this ) : MustacheContainer$$1.prototype.findNextNode.call(this);\n\t};\n\n\tPartial.prototype.forceResetTemplate = function forceResetTemplate () {\n\t\tvar this$1 = this;\n\n\t\tthis.partialTemplate = undefined;\n\n\t\t// on reset, check for the reference name first\n\t\tif ( this.refName ) {\n\t\t\tthis.partialTemplate = getPartialTemplate( this.ractive, this.refName, this.parentFragment );\n\t\t}\n\n\t\t// then look for the resolved name\n\t\tif ( !this.partialTemplate ) {\n\t\t\tthis.partialTemplate = getPartialTemplate( this.ractive, this.name, this.parentFragment );\n\t\t}\n\n\t\tif ( !this.partialTemplate ) {\n\t\t\twarnOnceIfDebug( (\"Could not find template for partial '\" + (this.name) + \"'\") );\n\t\t\tthis.partialTemplate = [];\n\t\t}\n\n\t\tif ( this.inAttribute ) {\n\t\t\tdoInAttributes( function () { return this$1.fragment.resetTemplate( this$1.partialTemplate ); } );\n\t\t} else {\n\t\t\tthis.fragment.resetTemplate( this.partialTemplate );\n\t\t}\n\n\t\tthis.bubble();\n\t};\n\n\tPartial.prototype.rebinding = function rebinding () {\n\t\tvar this$1 = this;\n\n\t\tif ( this.locked || !this.template.z ) { return; }\n\t\tthis.locked = true;\n\t\trunloop.scheduleTask( function () {\n\t\t\tthis$1.locked = false;\n\t\t\tthis$1.fragment.aliases = resolveAliases( this$1.template.z, this$1.containerFragment );\n\t\t});\n\t};\n\n\tPartial.prototype.render = function render ( target, occupants ) {\n\t\treturn this.fragment.render( target, occupants );\n\t};\n\n\tPartial.prototype.setTemplate = function setTemplate ( name, template ) {\n\t\tthis.name = name;\n\n\t\tif ( !template && template !== null ) { template = getPartialTemplate( this.ractive, name, this.parentFragment ); }\n\n\t\tif ( !template ) {\n\t\t\twarnOnceIfDebug( (\"Could not find template for partial '\" + name + \"'\") );\n\t\t}\n\n\t\tthis.partialTemplate = template || [];\n\t};\n\n\tPartial.prototype.unbind = function unbind () {\n\t\tMustacheContainer$$1.prototype.unbind.call(this);\n\t\tthis.fragment.aliases = {};\n\t\tthis.fragment.unbind();\n\t};\n\n\tPartial.prototype.unrender = function unrender ( shouldDestroy ) {\n\t\tthis.fragment.unrender( shouldDestroy );\n\t};\n\n\tPartial.prototype.update = function update () {\n\t\tvar template;\n\n\t\tif ( this.dirty ) {\n\t\t\tthis.dirty = false;\n\n\t\t\tif ( !this.named ) {\n\t\t\t\tif ( this.model ) {\n\t\t\t\t\ttemplate = this.model.get();\n\t\t\t\t}\n\n\t\t\t\tif ( template && typeof template === 'string' && template !== this.name ) {\n\t\t\t\t\tthis.setTemplate( template );\n\t\t\t\t\tthis.fragment.resetTemplate( this.partialTemplate );\n\t\t\t\t} else if ( template && typeof template === 'object' && ( typeof template.template === 'string' || isArray( template.t ) ) ) {\n\t\t\t\t\tif ( template.t !== this.source && template.template !== this.source ) {\n\t\t\t\t\t\tif ( template.template ) {\n\t\t\t\t\t\t\tthis.source = template.template;\n\t\t\t\t\t\t\ttemplate = parsePartial( this.name, template.template, this.ractive );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.source = template.t;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.setTemplate( this.name, template.t );\n\t\t\t\t\t\tthis.fragment.resetTemplate( this.partialTemplate );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.fragment.update();\n\t\t}\n\t};\n\n\treturn Partial;\n}(MustacheContainer));\n\nfunction parsePartial( name, partial, ractive ) {\n\tvar parsed;\n\n\ttry {\n\t\tparsed = parser.parse( partial, parser.getParseOptions( ractive ) );\n\t} catch (e) {\n\t\twarnIfDebug( (\"Could not parse partial from expression '\" + name + \"'\\n\" + (e.message)) );\n\t}\n\n\treturn parsed || { t: [] };\n}\n\nvar RepeatedFragment = function RepeatedFragment ( options ) {\n\tthis.parent = options.owner.parentFragment;\n\n\t// bit of a hack, so reference resolution works without another\n\t// layer of indirection\n\tthis.parentFragment = this;\n\tthis.owner = options.owner;\n\tthis.ractive = this.parent.ractive;\n\n\t// encapsulated styles should be inherited until they get applied by an element\n\tthis.cssIds = 'cssIds' in options ? options.cssIds : ( this.parent ? this.parent.cssIds : null );\n\n\tthis.context = null;\n\tthis.rendered = false;\n\tthis.iterations = [];\n\n\tthis.template = options.template;\n\n\tthis.indexRef = options.indexRef;\n\tthis.keyRef = options.keyRef;\n\n\tthis.pendingNewIndices = null;\n\tthis.previousIterations = null;\n\n\t// track array versus object so updates of type rest\n\tthis.isArray = false;\n};\n\nRepeatedFragment.prototype.bind = function bind ( context ) {\n\t\tvar this$1 = this;\n\n\tthis.context = context;\n\tvar value = context.get();\n\n\t// {{#each array}}...\n\tif ( this.isArray = isArray( value ) ) {\n\t\t// we can't use map, because of sparse arrays\n\t\tthis.iterations = [];\n\t\tvar max = value.length;\n\t\tfor ( var i = 0; i < max; i += 1 ) {\n\t\t\tthis$1.iterations[i] = this$1.createIteration( i, i );\n\t\t}\n\t}\n\n\t// {{#each object}}...\n\telse if ( isObject( value ) ) {\n\t\tthis.isArray = false;\n\n\t\t// TODO this is a dreadful hack. There must be a neater way\n\t\tif ( this.indexRef ) {\n\t\t\tvar refs = this.indexRef.split( ',' );\n\t\t\tthis.keyRef = refs[0];\n\t\t\tthis.indexRef = refs[1];\n\t\t}\n\n\t\tthis.iterations = Object.keys( value ).map( function ( key, index ) {\n\t\t\treturn this$1.createIteration( key, index );\n\t\t});\n\t}\n\n\treturn this;\n};\n\nRepeatedFragment.prototype.bubble = function bubble () {\n\tthis.owner.bubble();\n};\n\nRepeatedFragment.prototype.createIteration = function createIteration ( key, index ) {\n\tvar fragment = new Fragment({\n\t\towner: this,\n\t\ttemplate: this.template\n\t});\n\n\t// TODO this is a bit hacky\n\tfragment.key = key;\n\tfragment.index = index;\n\tfragment.isIteration = true;\n\n\tvar model = this.context.joinKey( key );\n\n\t// set up an iteration alias if there is one\n\tif ( this.owner.template.z ) {\n\t\tfragment.aliases = {};\n\t\tfragment.aliases[ this.owner.template.z[0].n ] = model;\n\t}\n\n\treturn fragment.bind( model );\n};\n\nRepeatedFragment.prototype.destroyed = function destroyed$1 () {\n\tthis.iterations.forEach( destroyed$1$1 );\n};\n\nRepeatedFragment.prototype.detach = function detach () {\n\tvar docFrag = createDocumentFragment();\n\tthis.iterations.forEach( function (fragment) { return docFrag.appendChild( fragment.detach() ); } );\n\treturn docFrag;\n};\n\nRepeatedFragment.prototype.find = function find ( selector, options ) {\n\treturn findMap( this.iterations, function (i) { return i.find( selector, options ); } );\n};\n\nRepeatedFragment.prototype.findAll = function findAll ( selector, query ) {\n\treturn this.iterations.forEach( function (i) { return i.findAll( selector, query ); } );\n};\n\nRepeatedFragment.prototype.findComponent = function findComponent ( name, options ) {\n\treturn findMap( this.iterations, function (i) { return i.findComponent( name, options ); } );\n};\n\nRepeatedFragment.prototype.findAllComponents = function findAllComponents ( name, query ) {\n\treturn this.iterations.forEach( function (i) { return i.findAllComponents( name, query ); } );\n};\n\nRepeatedFragment.prototype.findNextNode = function findNextNode ( iteration ) {\n\t\tvar this$1 = this;\n\n\tif ( iteration.index < this.iterations.length - 1 ) {\n\t\tfor ( var i = iteration.index + 1; i < this.iterations.length; i++ ) {\n\t\t\tvar node = this$1.iterations[ i ].firstNode( true );\n\t\t\tif ( node ) { return node; }\n\t\t}\n\t}\n\n\treturn this.owner.findNextNode();\n};\n\nRepeatedFragment.prototype.firstNode = function firstNode ( skipParent ) {\n\treturn this.iterations[0] ? this.iterations[0].firstNode( skipParent ) : null;\n};\n\nRepeatedFragment.prototype.rebinding = function rebinding ( next ) {\n\t\tvar this$1 = this;\n\n\tthis.context = next;\n\tthis.iterations.forEach( function (fragment) {\n\t\tvar model = next ? next.joinKey( fragment.key ) : undefined;\n\t\tfragment.context = model;\n\t\tif ( this$1.owner.template.z ) {\n\t\t\tfragment.aliases = {};\n\t\t\tfragment.aliases[ this$1.owner.template.z[0].n ] = model;\n\t\t}\n\t});\n};\n\nRepeatedFragment.prototype.render = function render ( target, occupants ) {\n\t// TODO use docFrag.cloneNode...\n\n\tif ( this.iterations ) {\n\t\tthis.iterations.forEach( function (fragment) { return fragment.render( target, occupants ); } );\n\t}\n\n\tthis.rendered = true;\n};\n\nRepeatedFragment.prototype.shuffle = function shuffle ( newIndices ) {\n\t\tvar this$1 = this;\n\n\tif ( !this.pendingNewIndices ) { this.previousIterations = this.iterations.slice(); }\n\n\tif ( !this.pendingNewIndices ) { this.pendingNewIndices = []; }\n\n\tthis.pendingNewIndices.push( newIndices );\n\n\tvar iterations = [];\n\n\tnewIndices.forEach( function ( newIndex, oldIndex ) {\n\t\tif ( newIndex === -1 ) { return; }\n\n\t\tvar fragment = this$1.iterations[ oldIndex ];\n\t\titerations[ newIndex ] = fragment;\n\n\t\tif ( newIndex !== oldIndex && fragment ) { fragment.dirty = true; }\n\t});\n\n\tthis.iterations = iterations;\n\n\tthis.bubble();\n};\n\nRepeatedFragment.prototype.shuffled = function shuffled$1 () {\n\tthis.iterations.forEach( shuffled$1$1 );\n};\n\nRepeatedFragment.prototype.toString = function toString$1 ( escape ) {\n\treturn this.iterations ?\n\t\tthis.iterations.map( escape ? toEscapedString : toString$2 ).join( '' ) :\n\t\t'';\n};\n\nRepeatedFragment.prototype.unbind = function unbind$1 () {\n\tthis.iterations.forEach( unbind$1$1 );\n\treturn this;\n};\n\nRepeatedFragment.prototype.unrender = function unrender$1 ( shouldDestroy ) {\n\tthis.iterations.forEach( shouldDestroy ? unrenderAndDestroy : unrender$1$1 );\n\tif ( this.pendingNewIndices && this.previousIterations ) {\n\t\tthis.previousIterations.forEach( function (fragment) {\n\t\t\tif ( fragment.rendered ) { shouldDestroy ? unrenderAndDestroy( fragment ) : unrender$1$1( fragment ); }\n\t\t});\n\t}\n\tthis.rendered = false;\n};\n\n// TODO smart update\nRepeatedFragment.prototype.update = function update$1 () {\n\t\tvar this$1 = this;\n\n\t// skip dirty check, since this is basically just a facade\n\n\tif ( this.pendingNewIndices ) {\n\t\tthis.updatePostShuffle();\n\t\treturn;\n\t}\n\n\tif ( this.updating ) { return; }\n\tthis.updating = true;\n\n\tvar value = this.context.get();\n\tvar wasArray = this.isArray;\n\n\tvar toRemove;\n\tvar oldKeys;\n\tvar reset = true;\n\tvar i;\n\n\tif ( this.isArray = isArray( value ) ) {\n\t\tif ( wasArray ) {\n\t\t\treset = false;\n\t\t\tif ( this.iterations.length > value.length ) {\n\t\t\t\ttoRemove = this.iterations.splice( value.length );\n\t\t\t}\n\t\t}\n\t} else if ( isObject( value ) && !wasArray ) {\n\t\treset = false;\n\t\ttoRemove = [];\n\t\toldKeys = {};\n\t\ti = this.iterations.length;\n\n\t\twhile ( i-- ) {\n\t\t\tvar fragment$1 = this$1.iterations[i];\n\t\t\tif ( fragment$1.key in value ) {\n\t\t\t\toldKeys[ fragment$1.key ] = true;\n\t\t\t} else {\n\t\t\t\tthis$1.iterations.splice( i, 1 );\n\t\t\t\ttoRemove.push( fragment$1 );\n\t\t\t}\n\t\t}\n\t}\n\n\tif ( reset ) {\n\t\ttoRemove = this.iterations;\n\t\tthis.iterations = [];\n\t}\n\n\tif ( toRemove ) {\n\t\ttoRemove.forEach( function (fragment) {\n\t\t\tfragment.unbind();\n\t\t\tfragment.unrender( true );\n\t\t});\n\t}\n\n\t// update the remaining ones\n\tthis.iterations.forEach( update$1$1 );\n\n\t// add new iterations\n\tvar newLength = isArray( value ) ?\n\t\tvalue.length :\n\t\tisObject( value ) ?\n\t\t\tObject.keys( value ).length :\n\t\t\t0;\n\n\tvar docFrag;\n\tvar fragment;\n\n\tif ( newLength > this.iterations.length ) {\n\t\tdocFrag = this.rendered ? createDocumentFragment() : null;\n\t\ti = this.iterations.length;\n\n\t\tif ( isArray( value ) ) {\n\t\t\twhile ( i < value.length ) {\n\t\t\t\tfragment = this$1.createIteration( i, i );\n\n\t\t\t\tthis$1.iterations.push( fragment );\n\t\t\t\tif ( this$1.rendered ) { fragment.render( docFrag ); }\n\n\t\t\t\ti += 1;\n\t\t\t}\n\t\t}\n\n\t\telse if ( isObject( value ) ) {\n\t\t\t// TODO this is a dreadful hack. There must be a neater way\n\t\t\tif ( this.indexRef && !this.keyRef ) {\n\t\t\t\tvar refs = this.indexRef.split( ',' );\n\t\t\t\tthis.keyRef = refs[0];\n\t\t\t\tthis.indexRef = refs[1];\n\t\t\t}\n\n\t\t\tObject.keys( value ).forEach( function (key) {\n\t\t\t\tif ( !oldKeys || !( key in oldKeys ) ) {\n\t\t\t\t\tfragment = this$1.createIteration( key, i );\n\n\t\t\t\t\tthis$1.iterations.push( fragment );\n\t\t\t\t\tif ( this$1.rendered ) { fragment.render( docFrag ); }\n\n\t\t\t\t\ti += 1;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif ( this.rendered ) {\n\t\t\tvar parentNode = this.parent.findParentNode();\n\t\t\tvar anchor = this.parent.findNextNode( this.owner );\n\n\t\t\tparentNode.insertBefore( docFrag, anchor );\n\t\t}\n\t}\n\n\tthis.updating = false;\n};\n\nRepeatedFragment.prototype.updatePostShuffle = function updatePostShuffle () {\n\t\tvar this$1 = this;\n\n\tvar newIndices = this.pendingNewIndices[ 0 ];\n\n\t// map first shuffle through\n\tthis.pendingNewIndices.slice( 1 ).forEach( function (indices) {\n\t\tnewIndices.forEach( function ( newIndex, oldIndex ) {\n\t\t\tnewIndices[ oldIndex ] = indices[ newIndex ];\n\t\t});\n\t});\n\n\t// This algorithm (for detaching incorrectly-ordered fragments from the DOM and\n\t// storing them in a document fragment for later reinsertion) seems a bit hokey,\n\t// but it seems to work for now\n\tvar len = this.context.get().length;\n\tvar oldLen = this.previousIterations.length;\n\tvar removed = {};\n\tvar i;\n\n\tnewIndices.forEach( function ( newIndex, oldIndex ) {\n\t\tvar fragment = this$1.previousIterations[ oldIndex ];\n\t\tthis$1.previousIterations[ oldIndex ] = null;\n\n\t\tif ( newIndex === -1 ) {\n\t\t\tremoved[ oldIndex ] = fragment;\n\t\t} else if ( fragment.index !== newIndex ) {\n\t\t\tvar model = this$1.context.joinKey( newIndex );\n\t\t\tfragment.index = newIndex;\n\t\t\tfragment.context = model;\n\t\t\tif ( this$1.owner.template.z ) {\n\t\t\t\tfragment.aliases = {};\n\t\t\t\tfragment.aliases[ this$1.owner.template.z[0].n ] = model;\n\t\t\t}\n\t\t}\n\t});\n\n\t// if the array was spliced outside of ractive, sometimes there are leftover fragments not in the newIndices\n\tthis.previousIterations.forEach( function ( frag, i ) {\n\t\tif ( frag ) { removed[ i ] = frag; }\n\t});\n\n\t// create new/move existing iterations\n\tvar docFrag = this.rendered ? createDocumentFragment() : null;\n\tvar parentNode = this.rendered ? this.parent.findParentNode() : null;\n\n\tvar contiguous = 'startIndex' in newIndices;\n\ti = contiguous ? newIndices.startIndex : 0;\n\n\tfor ( i; i < len; i++ ) {\n\t\tvar frag = this$1.iterations[i];\n\n\t\tif ( frag && contiguous ) {\n\t\t\t// attach any built-up iterations\n\t\t\tif ( this$1.rendered ) {\n\t\t\t\tif ( removed[i] ) { docFrag.appendChild( removed[i].detach() ); }\n\t\t\t\tif ( docFrag.childNodes.length  ) { parentNode.insertBefore( docFrag, frag.firstNode() ); }\n\t\t\t}\n\t\t\tcontinue;\n\t\t}\n\n\t\tif ( !frag ) { this$1.iterations[i] = this$1.createIteration( i, i ); }\n\n\t\tif ( this$1.rendered ) {\n\t\t\tif ( removed[i] ) { docFrag.appendChild( removed[i].detach() ); }\n\n\t\t\tif ( frag ) { docFrag.appendChild( frag.detach() ); }\n\t\t\telse {\n\t\t\t\tthis$1.iterations[i].render( docFrag );\n\t\t\t}\n\t\t}\n\t}\n\n\t// append any leftovers\n\tif ( this.rendered ) {\n\t\tfor ( i = len; i < oldLen; i++ ) {\n\t\t\tif ( removed[i] ) { docFrag.appendChild( removed[i].detach() ); }\n\t\t}\n\n\t\tif ( docFrag.childNodes.length ) {\n\t\t\tparentNode.insertBefore( docFrag, this.owner.findNextNode() );\n\t\t}\n\t}\n\n\t// trigger removal on old nodes\n\tObject.keys( removed ).forEach( function (k) { return removed[k].unbind().unrender( true ); } );\n\n\tthis.iterations.forEach( update$1$1 );\n\n\tthis.pendingNewIndices = null;\n\n\tthis.shuffled();\n};\n\nfunction isEmpty ( value ) {\n\treturn !value ||\n\t       ( isArray( value ) && value.length === 0 ) ||\n\t\t   ( isObject( value ) && Object.keys( value ).length === 0 );\n}\n\nfunction getType ( value, hasIndexRef ) {\n\tif ( hasIndexRef || isArray( value ) ) { return SECTION_EACH; }\n\tif ( isObject( value ) || typeof value === 'function' ) { return SECTION_IF_WITH; }\n\tif ( value === undefined ) { return null; }\n\treturn SECTION_IF;\n}\n\nvar Section = (function (MustacheContainer$$1) {\n\tfunction Section ( options ) {\n\t\tMustacheContainer$$1.call( this, options );\n\n\t\tthis.sectionType = options.template.n || null;\n\t\tthis.templateSectionType = this.sectionType;\n\t\tthis.subordinate = options.template.l === 1;\n\t\tthis.fragment = null;\n\t}\n\n\tif ( MustacheContainer$$1 ) Section.__proto__ = MustacheContainer$$1;\n\tSection.prototype = Object.create( MustacheContainer$$1 && MustacheContainer$$1.prototype );\n\tSection.prototype.constructor = Section;\n\n\tSection.prototype.bind = function bind () {\n\t\tMustacheContainer$$1.prototype.bind.call(this);\n\n\t\tif ( this.subordinate ) {\n\t\t\tthis.sibling = this.parentFragment.items[ this.parentFragment.items.indexOf( this ) - 1 ];\n\t\t\tthis.sibling.nextSibling = this;\n\t\t}\n\n\t\t// if we managed to bind, we need to create children\n\t\tif ( this.model ) {\n\t\t\tthis.dirty = true;\n\t\t\tthis.update();\n\t\t} else if ( this.sectionType && this.sectionType === SECTION_UNLESS && ( !this.sibling || !this.sibling.isTruthy() ) ) {\n\t\t\tthis.fragment = new Fragment({\n\t\t\t\towner: this,\n\t\t\t\ttemplate: this.template.f\n\t\t\t}).bind();\n\t\t}\n\t};\n\n\tSection.prototype.isTruthy = function isTruthy () {\n\t\tif ( this.subordinate && this.sibling.isTruthy() ) { return true; }\n\t\tvar value = !this.model ? undefined : this.model.isRoot ? this.model.value : this.model.get();\n\t\treturn !!value && ( this.templateSectionType === SECTION_IF_WITH || !isEmpty( value ) );\n\t};\n\n\tSection.prototype.rebinding = function rebinding ( next, previous, safe ) {\n\t\tif ( MustacheContainer$$1.prototype.rebinding.call( this, next, previous, safe ) ) {\n\t\t\tif ( this.fragment && this.sectionType !== SECTION_IF && this.sectionType !== SECTION_UNLESS ) {\n\t\t\t\tthis.fragment.rebinding( next, previous );\n\t\t\t}\n\t\t}\n\t};\n\n\tSection.prototype.render = function render ( target, occupants ) {\n\t\tthis.rendered = true;\n\t\tif ( this.fragment ) { this.fragment.render( target, occupants ); }\n\t};\n\n\tSection.prototype.shuffle = function shuffle ( newIndices ) {\n\t\tif ( this.fragment && this.sectionType === SECTION_EACH ) {\n\t\t\tthis.fragment.shuffle( newIndices );\n\t\t}\n\t};\n\n\tSection.prototype.unbind = function unbind () {\n\t\tMustacheContainer$$1.prototype.unbind.call(this);\n\t\tif ( this.fragment ) { this.fragment.unbind(); }\n\t};\n\n\tSection.prototype.unrender = function unrender ( shouldDestroy ) {\n\t\tif ( this.rendered && this.fragment ) { this.fragment.unrender( shouldDestroy ); }\n\t\tthis.rendered = false;\n\t};\n\n\tSection.prototype.update = function update () {\n\t\tif ( !this.dirty ) { return; }\n\n\t\tif ( this.fragment && this.sectionType !== SECTION_IF && this.sectionType !== SECTION_UNLESS ) {\n\t\t\tthis.fragment.context = this.model;\n\t\t}\n\n\t\tif ( !this.model && this.sectionType !== SECTION_UNLESS ) { return; }\n\n\t\tthis.dirty = false;\n\n\t\tvar value = !this.model ? undefined : this.model.isRoot ? this.model.value : this.model.get();\n\t\tvar siblingFalsey = !this.subordinate || !this.sibling.isTruthy();\n\t\tvar lastType = this.sectionType;\n\n\t\t// watch for switching section types\n\t\tif ( this.sectionType === null || this.templateSectionType === null ) { this.sectionType = getType( value, this.template.i ); }\n\t\tif ( lastType && lastType !== this.sectionType && this.fragment ) {\n\t\t\tif ( this.rendered ) {\n\t\t\t\tthis.fragment.unbind().unrender( true );\n\t\t\t}\n\n\t\t\tthis.fragment = null;\n\t\t}\n\n\t\tvar newFragment;\n\n\t\tvar fragmentShouldExist = this.sectionType === SECTION_EACH || // each always gets a fragment, which may have no iterations\n\t\t                            this.sectionType === SECTION_WITH || // with (partial context) always gets a fragment\n\t\t                            ( siblingFalsey && ( this.sectionType === SECTION_UNLESS ? !this.isTruthy() : this.isTruthy() ) ); // if, unless, and if-with depend on siblings and the condition\n\n\t\tif ( fragmentShouldExist ) {\n\t\t\tif ( this.fragment ) {\n\t\t\t\tthis.fragment.update();\n\t\t\t} else {\n\t\t\t\tif ( this.sectionType === SECTION_EACH ) {\n\t\t\t\t\tnewFragment = new RepeatedFragment({\n\t\t\t\t\t\towner: this,\n\t\t\t\t\t\ttemplate: this.template.f,\n\t\t\t\t\t\tindexRef: this.template.i\n\t\t\t\t\t}).bind( this.model );\n\t\t\t\t} else {\n\t\t\t\t\t// only with and if-with provide context - if and unless do not\n\t\t\t\t\tvar context = this.sectionType !== SECTION_IF && this.sectionType !== SECTION_UNLESS ? this.model : null;\n\t\t\t\t\tnewFragment = new Fragment({\n\t\t\t\t\t\towner: this,\n\t\t\t\t\t\ttemplate: this.template.f\n\t\t\t\t\t}).bind( context );\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tif ( this.fragment && this.rendered ) {\n\t\t\t\tthis.fragment.unbind().unrender( true );\n\t\t\t}\n\n\t\t\tthis.fragment = null;\n\t\t}\n\n\t\tif ( newFragment ) {\n\t\t\tif ( this.rendered ) {\n\t\t\t\tvar parentNode = this.parentFragment.findParentNode();\n\t\t\t\tvar anchor = this.parentFragment.findNextNode( this );\n\n\t\t\t\tif ( anchor ) {\n\t\t\t\t\tvar docFrag = createDocumentFragment();\n\t\t\t\t\tnewFragment.render( docFrag );\n\n\t\t\t\t\t// we use anchor.parentNode, not parentNode, because the sibling\n\t\t\t\t\t// may be temporarily detached as a result of a shuffle\n\t\t\t\t\tanchor.parentNode.insertBefore( docFrag, anchor );\n\t\t\t\t} else {\n\t\t\t\t\tnewFragment.render( parentNode );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.fragment = newFragment;\n\t\t}\n\n\t\tif ( this.nextSibling ) {\n\t\t\tthis.nextSibling.dirty = true;\n\t\t\tthis.nextSibling.update();\n\t\t}\n\t};\n\n\treturn Section;\n}(MustacheContainer));\n\nfunction valueContains ( selectValue, optionValue ) {\n\tvar i = selectValue.length;\n\twhile ( i-- ) {\n\t\tif ( selectValue[i] == optionValue ) { return true; }\n\t}\n}\n\nvar Select = (function (Element$$1) {\n\tfunction Select ( options ) {\n\t\tElement$$1.call( this, options );\n\t\tthis.options = [];\n\t}\n\n\tif ( Element$$1 ) Select.__proto__ = Element$$1;\n\tSelect.prototype = Object.create( Element$$1 && Element$$1.prototype );\n\tSelect.prototype.constructor = Select;\n\n\tSelect.prototype.foundNode = function foundNode ( node ) {\n\t\tif ( this.binding ) {\n\t\t\tvar selectedOptions = getSelectedOptions( node );\n\n\t\t\tif ( selectedOptions.length > 0 ) {\n\t\t\t\tthis.selectedOptions = selectedOptions;\n\t\t\t}\n\t\t}\n\t};\n\n\tSelect.prototype.render = function render ( target, occupants ) {\n\t\tElement$$1.prototype.render.call( this, target, occupants );\n\t\tthis.sync();\n\n\t\tvar node = this.node;\n\n\t\tvar i = node.options.length;\n\t\twhile ( i-- ) {\n\t\t\tnode.options[i].defaultSelected = node.options[i].selected;\n\t\t}\n\n\t\tthis.rendered = true;\n\t};\n\n\tSelect.prototype.sync = function sync () {\n\t\tvar this$1 = this;\n\n\t\tvar selectNode = this.node;\n\n\t\tif ( !selectNode ) { return; }\n\n\t\tvar options = toArray( selectNode.options );\n\n\t\tif ( this.selectedOptions ) {\n\t\t\toptions.forEach( function (o) {\n\t\t\t\tif ( this$1.selectedOptions.indexOf( o ) >= 0 ) { o.selected = true; }\n\t\t\t\telse { o.selected = false; }\n\t\t\t});\n\t\t\tthis.binding.setFromNode( selectNode );\n\t\t\tdelete this.selectedOptions;\n\t\t\treturn;\n\t\t}\n\n\t\tvar selectValue = this.getAttribute( 'value' );\n\t\tvar isMultiple = this.getAttribute( 'multiple' );\n\n\t\t// If the <select> has a specified value, that should override\n\t\t// these options\n\t\tif ( selectValue !== undefined ) {\n\t\t\tvar optionWasSelected;\n\n\t\t\toptions.forEach( function (o) {\n\t\t\t\tvar optionValue = o._ractive ? o._ractive.value : o.value;\n\t\t\t\tvar shouldSelect = isMultiple ? valueContains( selectValue, optionValue ) : selectValue == optionValue;\n\n\t\t\t\tif ( shouldSelect ) {\n\t\t\t\t\toptionWasSelected = true;\n\t\t\t\t}\n\n\t\t\t\to.selected = shouldSelect;\n\t\t\t});\n\n\t\t\tif ( !optionWasSelected && !isMultiple ) {\n\t\t\t\tif ( this.binding ) {\n\t\t\t\t\tthis.binding.forceUpdate();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Otherwise the value should be initialised according to which\n\t\t// <option> element is selected, if twoway binding is in effect\n\t\telse if ( this.binding ) {\n\t\t\tthis.binding.forceUpdate();\n\t\t}\n\t};\n\n\tSelect.prototype.update = function update () {\n\t\tElement$$1.prototype.update.call(this);\n\t\tthis.sync();\n\t};\n\n\treturn Select;\n}(Element));\n\nvar Textarea = (function (Input$$1) {\n\tfunction Textarea( options ) {\n\t\tvar template = options.template;\n\n\t\toptions.deferContent = true;\n\n\t\tInput$$1.call( this, options );\n\n\t\t// check for single interpolator binding\n\t\tif ( !this.attributeByName.value ) {\n\t\t\tif ( template.f && isBindable( { template: template } ) ) {\n\t\t\t\tthis.attributes.push( createItem( {\n\t\t\t\t\towner: this,\n\t\t\t\t\ttemplate: { t: ATTRIBUTE, f: template.f, n: 'value' },\n\t\t\t\t\tparentFragment: this.parentFragment\n\t\t\t\t} ) );\n\t\t\t} else {\n\t\t\t\tthis.fragment = new Fragment({ owner: this, cssIds: null, template: template.f });\n\t\t\t}\n\t\t}\n\t}\n\n\tif ( Input$$1 ) Textarea.__proto__ = Input$$1;\n\tTextarea.prototype = Object.create( Input$$1 && Input$$1.prototype );\n\tTextarea.prototype.constructor = Textarea;\n\n\tTextarea.prototype.bubble = function bubble () {\n\t\tvar this$1 = this;\n\n\t\tif ( !this.dirty ) {\n\t\t\tthis.dirty = true;\n\n\t\t\tif ( this.rendered && !this.binding && this.fragment ) {\n\t\t\t\trunloop.scheduleTask( function () {\n\t\t\t\t\tthis$1.dirty = false;\n\t\t\t\t\tthis$1.node.value = this$1.fragment.toString();\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.parentFragment.bubble(); // default behaviour\n\t\t}\n\t};\n\n\treturn Textarea;\n}(Input));\n\nvar Text = (function (Item$$1) {\n\tfunction Text ( options ) {\n\t\tItem$$1.call( this, options );\n\t\tthis.type = TEXT;\n\t}\n\n\tif ( Item$$1 ) Text.__proto__ = Item$$1;\n\tText.prototype = Object.create( Item$$1 && Item$$1.prototype );\n\tText.prototype.constructor = Text;\n\n\tText.prototype.bind = function bind () {\n\t\t// noop\n\t};\n\n\tText.prototype.detach = function detach () {\n\t\treturn detachNode( this.node );\n\t};\n\n\tText.prototype.firstNode = function firstNode () {\n\t\treturn this.node;\n\t};\n\n\tText.prototype.render = function render ( target, occupants ) {\n\t\tif ( inAttributes() ) { return; }\n\t\tthis.rendered = true;\n\n\t\tif ( occupants ) {\n\t\t\tvar n = occupants[0];\n\t\t\tif ( n && n.nodeType === 3 ) {\n\t\t\t\toccupants.shift();\n\t\t\t\tif ( n.nodeValue !== this.template ) {\n\t\t\t\t\tn.nodeValue = this.template;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tn = this.node = doc.createTextNode( this.template );\n\t\t\t\tif ( occupants[0] ) {\n\t\t\t\t\ttarget.insertBefore( n, occupants[0] );\n\t\t\t\t} else {\n\t\t\t\t\ttarget.appendChild( n );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.node = n;\n\t\t} else {\n\t\t\tthis.node = doc.createTextNode( this.template );\n\t\t\ttarget.appendChild( this.node );\n\t\t}\n\t};\n\n\tText.prototype.toString = function toString ( escape ) {\n\t\treturn escape ? escapeHtml( this.template ) : this.template;\n\t};\n\n\tText.prototype.unbind = function unbind () {\n\t\t// noop\n\t};\n\n\tText.prototype.unrender = function unrender ( shouldDestroy ) {\n\t\tif ( this.rendered && shouldDestroy ) { this.detach(); }\n\t\tthis.rendered = false;\n\t};\n\n\tText.prototype.update = function update () {\n\t\t// noop\n\t};\n\n\tText.prototype.valueOf = function valueOf () {\n\t\treturn this.template;\n\t};\n\n\treturn Text;\n}(Item));\n\nvar prefix;\n\nif ( !isClient ) {\n\tprefix = null;\n} else {\n\tvar prefixCache = {};\n\tvar testStyle = createElement( 'div' ).style;\n\n\tprefix = function ( prop ) {\n\t\tprop = camelCase( prop );\n\n\t\tif ( !prefixCache[ prop ] ) {\n\t\t\tif ( testStyle[ prop ] !== undefined ) {\n\t\t\t\tprefixCache[ prop ] = prop;\n\t\t\t}\n\n\t\t\telse {\n\t\t\t\t// test vendors...\n\t\t\t\tvar capped = prop.charAt( 0 ).toUpperCase() + prop.substring( 1 );\n\n\t\t\t\tvar i = vendors.length;\n\t\t\t\twhile ( i-- ) {\n\t\t\t\t\tvar vendor = vendors[i];\n\t\t\t\t\tif ( testStyle[ vendor + capped ] !== undefined ) {\n\t\t\t\t\t\tprefixCache[ prop ] = vendor + capped;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn prefixCache[ prop ];\n\t};\n}\n\nvar prefix$1 = prefix;\n\nvar visible;\nvar hidden = 'hidden';\n\nif ( doc ) {\n\tvar prefix$2;\n\n\tif ( hidden in doc ) {\n\t\tprefix$2 = '';\n\t} else {\n\t\tvar i$1 = vendors.length;\n\t\twhile ( i$1-- ) {\n\t\t\tvar vendor = vendors[i$1];\n\t\t\thidden = vendor + 'Hidden';\n\n\t\t\tif ( hidden in doc ) {\n\t\t\t\tprefix$2 = vendor;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tif ( prefix$2 !== undefined ) {\n\t\tdoc.addEventListener( prefix$2 + 'visibilitychange', onChange );\n\t\tonChange();\n\t} else {\n\t\t// gah, we're in an old browser\n\t\tif ( 'onfocusout' in doc ) {\n\t\t\tdoc.addEventListener( 'focusout', onHide );\n\t\t\tdoc.addEventListener( 'focusin', onShow );\n\t\t}\n\n\t\telse {\n\t\t\twin.addEventListener( 'pagehide', onHide );\n\t\t\twin.addEventListener( 'blur', onHide );\n\n\t\t\twin.addEventListener( 'pageshow', onShow );\n\t\t\twin.addEventListener( 'focus', onShow );\n\t\t}\n\n\t\tvisible = true; // until proven otherwise. Not ideal but hey\n\t}\n}\n\nfunction onChange () {\n\tvisible = !doc[ hidden ];\n}\n\nfunction onHide () {\n\tvisible = false;\n}\n\nfunction onShow () {\n\tvisible = true;\n}\n\nvar unprefixPattern = new RegExp( '^-(?:' + vendors.join( '|' ) + ')-' );\n\nvar unprefix = function ( prop ) {\n\treturn prop.replace( unprefixPattern, '' );\n};\n\nvar vendorPattern = new RegExp( '^(?:' + vendors.join( '|' ) + ')([A-Z])' );\n\nvar hyphenate = function ( str ) {\n\tif ( !str ) { return ''; } // edge case\n\n\tif ( vendorPattern.test( str ) ) { str = '-' + str; }\n\n\treturn str.replace( /[A-Z]/g, function (match) { return '-' + match.toLowerCase(); } );\n};\n\nvar createTransitions;\n\nif ( !isClient ) {\n\tcreateTransitions = null;\n} else {\n\tvar testStyle$1 = createElement( 'div' ).style;\n\tvar linear$2 = function (x) { return x; };\n\n\tvar canUseCssTransitions = {};\n\tvar cannotUseCssTransitions = {};\n\n\t// determine some facts about our environment\n\tvar TRANSITION$1;\n\tvar TRANSITIONEND;\n\tvar CSS_TRANSITIONS_ENABLED;\n\tvar TRANSITION_DURATION;\n\tvar TRANSITION_PROPERTY;\n\tvar TRANSITION_TIMING_FUNCTION;\n\n\tif ( testStyle$1.transition !== undefined ) {\n\t\tTRANSITION$1 = 'transition';\n\t\tTRANSITIONEND = 'transitionend';\n\t\tCSS_TRANSITIONS_ENABLED = true;\n\t} else if ( testStyle$1.webkitTransition !== undefined ) {\n\t\tTRANSITION$1 = 'webkitTransition';\n\t\tTRANSITIONEND = 'webkitTransitionEnd';\n\t\tCSS_TRANSITIONS_ENABLED = true;\n\t} else {\n\t\tCSS_TRANSITIONS_ENABLED = false;\n\t}\n\n\tif ( TRANSITION$1 ) {\n\t\tTRANSITION_DURATION = TRANSITION$1 + 'Duration';\n\t\tTRANSITION_PROPERTY = TRANSITION$1 + 'Property';\n\t\tTRANSITION_TIMING_FUNCTION = TRANSITION$1 + 'TimingFunction';\n\t}\n\n\tcreateTransitions = function ( t, to, options, changedProperties, resolve ) {\n\n\t\t// Wait a beat (otherwise the target styles will be applied immediately)\n\t\t// TODO use a fastdom-style mechanism?\n\t\tsetTimeout( function () {\n\t\t\tvar jsTransitionsComplete;\n\t\t\tvar cssTransitionsComplete;\n\t\t\tvar cssTimeout; // eslint-disable-line prefer-const\n\n\t\t\tfunction transitionDone () { clearTimeout( cssTimeout ); }\n\n\t\t\tfunction checkComplete () {\n\t\t\t\tif ( jsTransitionsComplete && cssTransitionsComplete ) {\n\t\t\t\t\tt.unregisterCompleteHandler( transitionDone );\n\t\t\t\t\t// will changes to events and fire have an unexpected consequence here?\n\t\t\t\t\tt.ractive.fire( t.name + ':end', t.node, t.isIntro );\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// this is used to keep track of which elements can use CSS to animate\n\t\t\t// which properties\n\t\t\tvar hashPrefix = ( t.node.namespaceURI || '' ) + t.node.tagName;\n\n\t\t\t// need to reset transition properties\n\t\t\tvar style = t.node.style;\n\t\t\tvar previous = {\n\t\t\t\tproperty: style[ TRANSITION_PROPERTY ],\n\t\t\t\ttiming: style[ TRANSITION_TIMING_FUNCTION ],\n\t\t\t\tduration: style[ TRANSITION_DURATION ]\n\t\t\t};\n\n\t\t\tstyle[ TRANSITION_PROPERTY ] = changedProperties.map( prefix$1 ).map( hyphenate ).join( ',' );\n\t\t\tstyle[ TRANSITION_TIMING_FUNCTION ] = hyphenate( options.easing || 'linear' );\n\t\t\tstyle[ TRANSITION_DURATION ] = ( options.duration / 1000 ) + 's';\n\n\t\t\tfunction transitionEndHandler ( event ) {\n\t\t\t\tvar index = changedProperties.indexOf( camelCase( unprefix( event.propertyName ) ) );\n\n\t\t\t\tif ( index !== -1 ) {\n\t\t\t\t\tchangedProperties.splice( index, 1 );\n\t\t\t\t}\n\n\t\t\t\tif ( changedProperties.length ) {\n\t\t\t\t\t// still transitioning...\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tclearTimeout( cssTimeout );\n\t\t\t\tcssTransitionsDone();\n\t\t\t}\n\n\t\t\tfunction cssTransitionsDone () {\n\t\t\t\tstyle[ TRANSITION_PROPERTY ] = previous.property;\n\t\t\t\tstyle[ TRANSITION_TIMING_FUNCTION ] = previous.duration;\n\t\t\t\tstyle[ TRANSITION_DURATION ] = previous.timing;\n\n\t\t\t\tt.node.removeEventListener( TRANSITIONEND, transitionEndHandler, false );\n\n\t\t\t\tcssTransitionsComplete = true;\n\t\t\t\tcheckComplete();\n\t\t\t}\n\n\t\t\tt.node.addEventListener( TRANSITIONEND, transitionEndHandler, false );\n\n\t\t\t// safety net in case transitionend never fires\n\t\t\tcssTimeout = setTimeout( function () {\n\t\t\t\tchangedProperties = [];\n\t\t\t\tcssTransitionsDone();\n\t\t\t}, options.duration + ( options.delay || 0 ) + 50 );\n\t\t\tt.registerCompleteHandler( transitionDone );\n\n\t\t\tsetTimeout( function () {\n\t\t\t\tvar i = changedProperties.length;\n\t\t\t\tvar hash;\n\t\t\t\tvar originalValue;\n\t\t\t\tvar index;\n\t\t\t\tvar propertiesToTransitionInJs = [];\n\t\t\t\tvar prop;\n\t\t\t\tvar suffix;\n\t\t\t\tvar interpolator;\n\n\t\t\t\twhile ( i-- ) {\n\t\t\t\t\tprop = changedProperties[i];\n\t\t\t\t\thash = hashPrefix + prop;\n\n\t\t\t\t\tif ( CSS_TRANSITIONS_ENABLED && !cannotUseCssTransitions[ hash ] ) {\n\t\t\t\t\t\tstyle[ prefix$1( prop ) ] = to[ prop ];\n\n\t\t\t\t\t\t// If we're not sure if CSS transitions are supported for\n\t\t\t\t\t\t// this tag/property combo, find out now\n\t\t\t\t\t\tif ( !canUseCssTransitions[ hash ] ) {\n\t\t\t\t\t\t\toriginalValue = t.getStyle( prop );\n\n\t\t\t\t\t\t\t// if this property is transitionable in this browser,\n\t\t\t\t\t\t\t// the current style will be different from the target style\n\t\t\t\t\t\t\tcanUseCssTransitions[ hash ] = ( t.getStyle( prop ) != to[ prop ] );\n\t\t\t\t\t\t\tcannotUseCssTransitions[ hash ] = !canUseCssTransitions[ hash ];\n\n\t\t\t\t\t\t\t// Reset, if we're going to use timers after all\n\t\t\t\t\t\t\tif ( cannotUseCssTransitions[ hash ] ) {\n\t\t\t\t\t\t\t\tstyle[ prefix$1( prop ) ] = originalValue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( !CSS_TRANSITIONS_ENABLED || cannotUseCssTransitions[ hash ] ) {\n\t\t\t\t\t\t// we need to fall back to timer-based stuff\n\t\t\t\t\t\tif ( originalValue === undefined ) {\n\t\t\t\t\t\t\toriginalValue = t.getStyle( prop );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// need to remove this from changedProperties, otherwise transitionEndHandler\n\t\t\t\t\t\t// will get confused\n\t\t\t\t\t\tindex = changedProperties.indexOf( prop );\n\t\t\t\t\t\tif ( index === -1 ) {\n\t\t\t\t\t\t\twarnIfDebug( 'Something very strange happened with transitions. Please raise an issue at https://github.com/ractivejs/ractive/issues - thanks!', { node: t.node });\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tchangedProperties.splice( index, 1 );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// TODO Determine whether this property is animatable at all\n\n\t\t\t\t\t\tsuffix = /[^\\d]*$/.exec( to[ prop ] )[0];\n\t\t\t\t\t\tinterpolator = interpolate( parseFloat( originalValue ), parseFloat( to[ prop ] ) ) || ( function () { return to[ prop ]; } );\n\n\t\t\t\t\t\t// ...then kick off a timer-based transition\n\t\t\t\t\t\tpropertiesToTransitionInJs.push({\n\t\t\t\t\t\t\tname: prefix$1( prop ),\n\t\t\t\t\t\t\tinterpolator: interpolator,\n\t\t\t\t\t\t\tsuffix: suffix\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// javascript transitions\n\t\t\t\tif ( propertiesToTransitionInJs.length ) {\n\t\t\t\t\tvar easing;\n\n\t\t\t\t\tif ( typeof options.easing === 'string' ) {\n\t\t\t\t\t\teasing = t.ractive.easing[ options.easing ];\n\n\t\t\t\t\t\tif ( !easing ) {\n\t\t\t\t\t\t\twarnOnceIfDebug( missingPlugin( options.easing, 'easing' ) );\n\t\t\t\t\t\t\teasing = linear$2;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if ( typeof options.easing === 'function' ) {\n\t\t\t\t\t\teasing = options.easing;\n\t\t\t\t\t} else {\n\t\t\t\t\t\teasing = linear$2;\n\t\t\t\t\t}\n\n\t\t\t\t\tnew Ticker({\n\t\t\t\t\t\tduration: options.duration,\n\t\t\t\t\t\teasing: easing,\n\t\t\t\t\t\tstep: function step ( pos ) {\n\t\t\t\t\t\t\tvar i = propertiesToTransitionInJs.length;\n\t\t\t\t\t\t\twhile ( i-- ) {\n\t\t\t\t\t\t\t\tvar prop = propertiesToTransitionInJs[i];\n\t\t\t\t\t\t\t\tt.node.style[ prop.name ] = prop.interpolator( pos ) + prop.suffix;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcomplete: function complete () {\n\t\t\t\t\t\t\tjsTransitionsComplete = true;\n\t\t\t\t\t\t\tcheckComplete();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tjsTransitionsComplete = true;\n\t\t\t\t}\n\n\t\t\t\tif ( !changedProperties.length ) {\n\t\t\t\t\t// We need to cancel the transitionEndHandler, and deal with\n\t\t\t\t\t// the fact that it will never fire\n\t\t\t\t\tt.node.removeEventListener( TRANSITIONEND, transitionEndHandler, false );\n\t\t\t\t\tcssTransitionsComplete = true;\n\t\t\t\t\tcheckComplete();\n\t\t\t\t}\n\t\t\t}, 0 );\n\t\t}, options.delay || 0 );\n\t};\n}\n\nvar createTransitions$1 = createTransitions;\n\nfunction resetStyle ( node, style ) {\n\tif ( style ) {\n\t\tnode.setAttribute( 'style', style );\n\t} else {\n\t\t// Next line is necessary, to remove empty style attribute!\n\t\t// See http://stackoverflow.com/a/7167553\n\t\tnode.getAttribute( 'style' );\n\t\tnode.removeAttribute( 'style' );\n\t}\n}\n\nvar getComputedStyle = win && ( win.getComputedStyle || legacy.getComputedStyle );\nvar resolved$1 = Promise$1.resolve();\n\nvar names = {\n\tt0: 'intro-outro',\n\tt1: 'intro',\n\tt2: 'outro'\n};\n\nvar Transition = function Transition ( options ) {\n\tthis.owner = options.owner || options.parentFragment.owner || findElement( options.parentFragment );\n\tthis.element = this.owner.attributeByName ? this.owner : findElement( options.parentFragment );\n\tthis.ractive = this.owner.ractive;\n\tthis.template = options.template;\n\tthis.parentFragment = options.parentFragment;\n\tthis.options = options;\n\tthis.onComplete = [];\n};\n\nTransition.prototype.animateStyle = function animateStyle ( style, value, options ) {\n\t\tvar this$1 = this;\n\n\tif ( arguments.length === 4 ) {\n\t\tthrow new Error( 't.animateStyle() returns a promise - use .then() instead of passing a callback' );\n\t}\n\n\t// Special case - page isn't visible. Don't animate anything, because\n\t// that way you'll never get CSS transitionend events\n\tif ( !visible ) {\n\t\tthis.setStyle( style, value );\n\t\treturn resolved$1;\n\t}\n\n\tvar to;\n\n\tif ( typeof style === 'string' ) {\n\t\tto = {};\n\t\tto[ style ] = value;\n\t} else {\n\t\tto = style;\n\n\t\t// shuffle arguments\n\t\toptions = value;\n\t}\n\n\t// As of 0.3.9, transition authors should supply an `option` object with\n\t// `duration` and `easing` properties (and optional `delay`), plus a\n\t// callback function that gets called after the animation completes\n\n\t// TODO remove this check in a future version\n\tif ( !options ) {\n\t\twarnOnceIfDebug( 'The \"%s\" transition does not supply an options object to `t.animateStyle()`. This will break in a future version of Ractive. For more info see https://github.com/RactiveJS/Ractive/issues/340', this.name );\n\t\toptions = this;\n\t}\n\n\treturn new Promise$1( function (fulfil) {\n\t\t// Edge case - if duration is zero, set style synchronously and complete\n\t\tif ( !options.duration ) {\n\t\t\tthis$1.setStyle( to );\n\t\t\tfulfil();\n\t\t\treturn;\n\t\t}\n\n\t\t// Get a list of the properties we're animating\n\t\tvar propertyNames = Object.keys( to );\n\t\tvar changedProperties = [];\n\n\t\t// Store the current styles\n\t\tvar computedStyle = getComputedStyle( this$1.owner.node );\n\n\t\tvar i = propertyNames.length;\n\t\twhile ( i-- ) {\n\t\t\tvar prop = propertyNames[i];\n\t\t\tvar current = computedStyle[ prefix$1( prop ) ];\n\n\t\t\tif ( current === '0px' ) { current = 0; }\n\n\t\t\t// we need to know if we're actually changing anything\n\t\t\tif ( current != to[ prop ] ) { // use != instead of !==, so we can compare strings with numbers\n\t\t\t\tchangedProperties.push( prop );\n\n\t\t\t\t// make the computed style explicit, so we can animate where\n\t\t\t\t// e.g. height='auto'\n\t\t\t\tthis$1.owner.node.style[ prefix$1( prop ) ] = current;\n\t\t\t}\n\t\t}\n\n\t\t// If we're not actually changing anything, the transitionend event\n\t\t// will never fire! So we complete early\n\t\tif ( !changedProperties.length ) {\n\t\t\tfulfil();\n\t\t\treturn;\n\t\t}\n\n\t\tcreateTransitions$1( this$1, to, options, changedProperties, fulfil );\n\t});\n};\n\nTransition.prototype.bind = function bind () {\n\tvar options = this.options;\n\tif ( options.template ) {\n\t\tif ( options.template.v === 't0' || options.template.v == 't1' ) { this.element._introTransition = this; }\n\t\tif ( options.template.v === 't0' || options.template.v == 't2' ) { this.element._outroTransition = this; }\n\t\tthis.eventName = names[ options.template.v ];\n\t}\n\n\tvar ractive = this.owner.ractive;\n\n\tthis.name = options.name || options.template.n;\n\n\tif ( options.params ) {\n\t\tthis.params = options.params;\n\t}\n\n\tif ( typeof this.name === 'function' ) {\n\t\tthis._fn = this.name;\n\t\tthis.name = this._fn.name;\n\t} else {\n\t\tthis._fn = findInViewHierarchy( 'transitions', ractive, this.name );\n\t}\n\n\tif ( !this._fn ) {\n\t\twarnOnceIfDebug( missingPlugin( this.name, 'transition' ), { ractive: ractive });\n\t}\n\n\tsetupArgsFn( this, options.template, this.parentFragment );\n};\n\nTransition.prototype.destroyed = function destroyed () {};\n\nTransition.prototype.getStyle = function getStyle ( props ) {\n\tvar computedStyle = getComputedStyle( this.owner.node );\n\n\tif ( typeof props === 'string' ) {\n\t\tvar value = computedStyle[ prefix$1( props ) ];\n\t\treturn value === '0px' ? 0 : value;\n\t}\n\n\tif ( !isArray( props ) ) {\n\t\tthrow new Error( 'Transition$getStyle must be passed a string, or an array of strings representing CSS properties' );\n\t}\n\n\tvar styles = {};\n\n\tvar i = props.length;\n\twhile ( i-- ) {\n\t\tvar prop = props[i];\n\t\tvar value$1 = computedStyle[ prefix$1( prop ) ];\n\n\t\tif ( value$1 === '0px' ) { value$1 = 0; }\n\t\tstyles[ prop ] = value$1;\n\t}\n\n\treturn styles;\n};\n\nTransition.prototype.processParams = function processParams ( params, defaults ) {\n\tif ( typeof params === 'number' ) {\n\t\tparams = { duration: params };\n\t}\n\n\telse if ( typeof params === 'string' ) {\n\t\tif ( params === 'slow' ) {\n\t\t\tparams = { duration: 600 };\n\t\t} else if ( params === 'fast' ) {\n\t\t\tparams = { duration: 200 };\n\t\t} else {\n\t\t\tparams = { duration: 400 };\n\t\t}\n\t} else if ( !params ) {\n\t\tparams = {};\n\t}\n\n\treturn extend$1( {}, defaults, params );\n};\n\nTransition.prototype.rebinding = function rebinding ( next, previous ) {\n\tvar idx = this.models.indexOf( previous );\n\tif ( !~idx ) { return; }\n\n\tnext = rebindMatch( this.template.f.r[ idx ], next, previous );\n\tif ( next === previous ) { return; }\n\n\tprevious.unregister( this );\n\tthis.models.splice( idx, 1, next );\n\tif ( next ) { next.addShuffleRegister( this, 'mark' ); }\n};\n\nTransition.prototype.registerCompleteHandler = function registerCompleteHandler ( fn ) {\n\taddToArray( this.onComplete, fn );\n};\n\nTransition.prototype.render = function render () {};\n\nTransition.prototype.setStyle = function setStyle ( style, value ) {\n\t\tvar this$1 = this;\n\n\tif ( typeof style === 'string' ) {\n\t\tthis.owner.node.style[ prefix$1( style ) ] = value;\n\t}\n\n\telse {\n\t\tvar prop;\n\t\tfor ( prop in style ) {\n\t\t\tif ( style.hasOwnProperty( prop ) ) {\n\t\t\t\tthis$1.owner.node.style[ prefix$1( prop ) ] = style[ prop ];\n\t\t\t}\n\t\t}\n\t}\n\n\treturn this;\n};\n\nTransition.prototype.start = function start () {\n\t\tvar this$1 = this;\n\n\tvar node = this.node = this.element.node;\n\tvar originalStyle = node.getAttribute( 'style' );\n\n\tvar completed;\n\tvar args = this.params;\n\n\t// create t.complete() - we don't want this on the prototype,\n\t// because we don't want `this` silliness when passing it as\n\t// an argument\n\tthis.complete = function (noReset) {\n\t\tif ( completed ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis$1.onComplete.forEach( function (fn) { return fn(); } );\n\t\tif ( !noReset && this$1.isIntro ) {\n\t\t\tresetStyle( node, originalStyle);\n\t\t}\n\n\t\tthis$1._manager.remove( this$1 );\n\n\t\tif ( this$1.shouldUnbind ) { teardownArgsFn( this$1, this$1.options.template ); }\n\n\t\tcompleted = true;\n\t};\n\n\t// If the transition function doesn't exist, abort\n\tif ( !this._fn ) {\n\t\tthis.complete();\n\t\treturn;\n\t}\n\n\t// get expression args if supplied\n\tif ( this.fn ) {\n\t\tvar values = this.models.map( function (model) {\n\t\t\tif ( !model ) { return undefined; }\n\n\t\t\treturn model.get();\n\t\t});\n\t\targs = this.fn.apply( this.ractive, values );\n\t}\n\n\tvar promise = this._fn.apply( this.ractive, [ this ].concat( args ) );\n\tif ( promise ) { promise.then( this.complete ); }\n};\n\nTransition.prototype.toString = function toString () { return ''; };\n\nTransition.prototype.unbind = function unbind () {\n\tthis.shouldUnbind = true;\n};\n\nTransition.prototype.unregisterCompleteHandler = function unregisterCompleteHandler ( fn ) {\n\tremoveFromArray( this.onComplete, fn );\n};\n\nTransition.prototype.unrender = function unrender () {};\n\nTransition.prototype.update = function update () {};\n\nvar elementCache = {};\n\nvar ieBug;\nvar ieBlacklist;\n\ntry {\n\tcreateElement( 'table' ).innerHTML = 'foo';\n} catch ( err ) {\n\tieBug = true;\n\n\tieBlacklist = {\n\t\tTABLE:  [ '<table class=\"x\">', '</table>' ],\n\t\tTHEAD:  [ '<table><thead class=\"x\">', '</thead></table>' ],\n\t\tTBODY:  [ '<table><tbody class=\"x\">', '</tbody></table>' ],\n\t\tTR:     [ '<table><tr class=\"x\">', '</tr></table>' ],\n\t\tSELECT: [ '<select class=\"x\">', '</select>' ]\n\t};\n}\n\nvar insertHtml = function ( html$$1, node, docFrag ) {\n\tvar nodes = [];\n\n\t// render 0 and false\n\tif ( html$$1 == null || html$$1 === '' ) { return nodes; }\n\n\tvar container;\n\tvar wrapper;\n\tvar selectedOption;\n\n\tif ( ieBug && ( wrapper = ieBlacklist[ node.tagName ] ) ) {\n\t\tcontainer = element( 'DIV' );\n\t\tcontainer.innerHTML = wrapper[0] + html$$1 + wrapper[1];\n\t\tcontainer = container.querySelector( '.x' );\n\n\t\tif ( container.tagName === 'SELECT' ) {\n\t\t\tselectedOption = container.options[ container.selectedIndex ];\n\t\t}\n\t}\n\n\telse if ( node.namespaceURI === svg$1 ) {\n\t\tcontainer = element( 'DIV' );\n\t\tcontainer.innerHTML = '<svg class=\"x\">' + html$$1 + '</svg>';\n\t\tcontainer = container.querySelector( '.x' );\n\t}\n\n\telse if ( node.tagName === 'TEXTAREA' ) {\n\t\tcontainer = createElement( 'div' );\n\n\t\tif ( typeof container.textContent !== 'undefined' ) {\n\t\t\tcontainer.textContent = html$$1;\n\t\t} else {\n\t\t\tcontainer.innerHTML = html$$1;\n\t\t}\n\t}\n\n\telse {\n\t\tcontainer = element( node.tagName );\n\t\tcontainer.innerHTML = html$$1;\n\n\t\tif ( container.tagName === 'SELECT' ) {\n\t\t\tselectedOption = container.options[ container.selectedIndex ];\n\t\t}\n\t}\n\n\tvar child;\n\twhile ( child = container.firstChild ) {\n\t\tnodes.push( child );\n\t\tdocFrag.appendChild( child );\n\t}\n\n\t// This is really annoying. Extracting <option> nodes from the\n\t// temporary container <select> causes the remaining ones to\n\t// become selected. So now we have to deselect them. IE8, you\n\t// amaze me. You really do\n\t// ...and now Chrome too\n\tvar i;\n\tif ( node.tagName === 'SELECT' ) {\n\t\ti = nodes.length;\n\t\twhile ( i-- ) {\n\t\t\tif ( nodes[i] !== selectedOption ) {\n\t\t\t\tnodes[i].selected = false;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn nodes;\n};\n\nfunction element ( tagName ) {\n\treturn elementCache[ tagName ] || ( elementCache[ tagName ] = createElement( tagName ) );\n}\n\nvar Triple = (function (Mustache$$1) {\n\tfunction Triple ( options ) {\n\t\tMustache$$1.call( this, options );\n\t}\n\n\tif ( Mustache$$1 ) Triple.__proto__ = Mustache$$1;\n\tTriple.prototype = Object.create( Mustache$$1 && Mustache$$1.prototype );\n\tTriple.prototype.constructor = Triple;\n\n\tTriple.prototype.detach = function detach () {\n\t\tvar docFrag = createDocumentFragment();\n\t\tthis.nodes.forEach( function (node) { return docFrag.appendChild( node ); } );\n\t\treturn docFrag;\n\t};\n\n\tTriple.prototype.find = function find ( selector ) {\n\t\tvar this$1 = this;\n\n\t\tvar len = this.nodes.length;\n\t\tvar i;\n\n\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\tvar node = this$1.nodes[i];\n\n\t\t\tif ( node.nodeType !== 1 ) { continue; }\n\n\t\t\tif ( matches( node, selector ) ) { return node; }\n\n\t\t\tvar queryResult = node.querySelector( selector );\n\t\t\tif ( queryResult ) { return queryResult; }\n\t\t}\n\n\t\treturn null;\n\t};\n\n\tTriple.prototype.findAll = function findAll ( selector, query ) {\n\t\tvar this$1 = this;\n\n\t\tvar len = this.nodes.length;\n\t\tvar i;\n\n\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\tvar node = this$1.nodes[i];\n\n\t\t\tif ( node.nodeType !== 1 ) { continue; }\n\n\t\t\tif ( query.test( node ) ) { query.add( node ); }\n\n\t\t\tvar queryAllResult = node.querySelectorAll( selector );\n\t\t\tif ( queryAllResult ) {\n\t\t\t\tvar numNodes = queryAllResult.length;\n\t\t\t\tvar j = (void 0);\n\n\t\t\t\tfor ( j = 0; j < numNodes; j += 1 ) {\n\t\t\t\t\tquery.add( queryAllResult[j] );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\tTriple.prototype.findComponent = function findComponent () {\n\t\treturn null;\n\t};\n\n\tTriple.prototype.firstNode = function firstNode () {\n\t\treturn this.nodes[0];\n\t};\n\n\tTriple.prototype.render = function render ( target ) {\n\t\tvar html = this.model ? this.model.get() : '';\n\t\tthis.nodes = insertHtml( html, this.parentFragment.findParentNode(), target );\n\t\tthis.rendered = true;\n\t};\n\n\tTriple.prototype.toString = function toString () {\n\t\treturn this.model && this.model.get() != null ? decodeCharacterReferences( '' + this.model.get() ) : '';\n\t};\n\n\tTriple.prototype.unrender = function unrender () {\n\t\tif ( this.nodes ) { this.nodes.forEach( function (node) { return detachNode( node ); } ); }\n\t\tthis.rendered = false;\n\t};\n\n\tTriple.prototype.update = function update () {\n\t\tif ( this.rendered && this.dirty ) {\n\t\t\tthis.dirty = false;\n\n\t\t\tthis.unrender();\n\t\t\tvar docFrag = createDocumentFragment();\n\t\t\tthis.render( docFrag );\n\n\t\t\tvar parentNode = this.parentFragment.findParentNode();\n\t\t\tvar anchor = this.parentFragment.findNextNode( this );\n\n\t\t\tparentNode.insertBefore( docFrag, anchor );\n\t\t} else {\n\t\t\t// make sure to reset the dirty flag even if not rendered\n\t\t\tthis.dirty = false;\n\t\t}\n\t};\n\n\treturn Triple;\n}(Mustache));\n\n// finds the component constructor in the registry or view hierarchy registries\nfunction getComponentConstructor ( ractive, name ) {\n\tvar instance = findInstance( 'components', ractive, name );\n\tvar Component;\n\n\tif ( instance ) {\n\t\tComponent = instance.components[ name ];\n\n\t\t// best test we have for not Ractive.extend\n\t\tif ( !Component._Parent ) {\n\t\t\t// function option, execute and store for reset\n\t\t\tvar fn = Component.bind( instance );\n\t\t\tfn.isOwner = instance.components.hasOwnProperty( name );\n\t\t\tComponent = fn();\n\n\t\t\tif ( !Component ) {\n\t\t\t\twarnIfDebug( noRegistryFunctionReturn, name, 'component', 'component', { ractive: ractive });\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( typeof Component === 'string' ) {\n\t\t\t\t// allow string lookup\n\t\t\t\tComponent = getComponentConstructor( ractive, Component );\n\t\t\t}\n\n\t\t\tComponent._fn = fn;\n\t\t\tinstance.components[ name ] = Component;\n\t\t}\n\t}\n\n\treturn Component;\n}\n\n//import Yielder from './Yielder';\nvar constructors = {};\nconstructors[ ALIAS ] = Alias;\nconstructors[ ANCHOR ] = Component;\nconstructors[ DOCTYPE ] = Doctype;\nconstructors[ INTERPOLATOR ] = Interpolator;\nconstructors[ PARTIAL ] = Partial;\nconstructors[ SECTION ] = Section;\nconstructors[ TRIPLE ] = Triple;\nconstructors[ YIELDER ] = Partial;\n\nconstructors[ ATTRIBUTE ] = Attribute;\nconstructors[ BINDING_FLAG ] = BindingFlag;\nconstructors[ DECORATOR ] = Decorator;\nconstructors[ EVENT ] = EventDirective;\nconstructors[ TRANSITION ] = Transition;\n\nvar specialElements = {\n\tdoctype: Doctype,\n\tform: Form,\n\tinput: Input,\n\toption: Option,\n\tselect: Select,\n\ttextarea: Textarea\n};\n\nfunction createItem ( options ) {\n\tif ( typeof options.template === 'string' ) {\n\t\treturn new Text( options );\n\t}\n\n\tif ( options.template.t === ELEMENT ) {\n\t\t// could be component or element\n\t\tvar ComponentConstructor = getComponentConstructor( options.parentFragment.ractive, options.template.e );\n\t\tif ( ComponentConstructor ) {\n\t\t\treturn new Component( options, ComponentConstructor );\n\t\t}\n\n\t\tvar tagName = options.template.e.toLowerCase();\n\n\t\tvar ElementConstructor = specialElements[ tagName ] || Element;\n\t\treturn new ElementConstructor( options );\n\t}\n\n\tvar Item;\n\n\t// component mappings are a special case of attribute\n\tif ( options.template.t === ATTRIBUTE ) {\n\t\tvar el = options.owner;\n\t\tif ( !el || ( el.type !== ANCHOR && el.type !== COMPONENT && el.type !== ELEMENT ) ) {\n\t\t\tel = findElement( options.parentFragment );\n\t\t}\n\t\toptions.element = el;\n\n\t\tItem = el.type === COMPONENT || el.type === ANCHOR ? Mapping : Attribute;\n\t} else {\n\t\tItem = constructors[ options.template.t ];\n\t}\n\n\tif ( !Item ) { throw new Error( (\"Unrecognised item type \" + (options.template.t)) ); }\n\n\treturn new Item( options );\n}\n\nvar ReferenceResolver = function ReferenceResolver ( fragment, reference, callback ) {\n\tvar this$1 = this;\n\n\tthis.fragment = fragment;\n\tthis.reference = normalise( reference );\n\tthis.callback = callback;\n\n\tthis.keys = splitKeypath( reference );\n\tthis.resolved = false;\n\n\tthis.contexts = [];\n\n\t// TODO the consumer should take care of addUnresolved\n\t// we attach to all the contexts between here and the root\n\t// - whenever their values change, they can quickly\n\t// check to see if we can resolve\n\twhile ( fragment ) {\n\t\tif ( fragment.context ) {\n\t\t\tfragment.context.addUnresolved( this$1.keys[0], this$1 );\n\t\t\tthis$1.contexts.push( fragment.context );\n\t\t}\n\n\t\tfragment = fragment.componentParent || fragment.parent;\n\t}\n};\n\nReferenceResolver.prototype.attemptResolution = function attemptResolution () {\n\tif ( this.resolved ) { return; }\n\n\tvar model = resolveReference( this.fragment, this.reference );\n\n\tif ( model ) {\n\t\tthis.resolved = true;\n\t\tthis.callback( model );\n\t}\n};\n\nReferenceResolver.prototype.forceResolution = function forceResolution () {\n\tif ( this.resolved ) { return; }\n\n\tvar model = this.fragment.findContext().joinAll( this.keys );\n\tthis.callback( model );\n\tthis.resolved = true;\n};\n\nReferenceResolver.prototype.rebinding = function rebinding ( next, previous ) {\n\t\tvar this$1 = this;\n\n\tif ( previous ) { previous.removeUnresolved( this.keys[0], this ); }\n\tif ( next ) { runloop.scheduleTask( function () { return next.addUnresolved( this$1.keys[0], this$1 ); } ); }\n};\n\nReferenceResolver.prototype.unbind = function unbind () {\n\t\tvar this$1 = this;\n\n\tif ( this.fragment ) { removeFromArray( this.fragment.unresolved, this ); }\n\n\tif ( this.resolved ) { return; }\n\n\tthis.contexts.forEach( function (c) { return c.removeUnresolved( this$1.keys[0], this$1 ); } );\n};\n\n// TODO all this code needs to die\nfunction processItems ( items, values, guid, counter ) {\n\tif ( counter === void 0 ) counter = 0;\n\n\treturn items.map( function (item) {\n\t\tif ( item.type === TEXT ) {\n\t\t\treturn item.template;\n\t\t}\n\n\t\tif ( item.fragment ) {\n\t\t\tif ( item.fragment.iterations ) {\n\t\t\t\treturn item.fragment.iterations.map( function (fragment) {\n\t\t\t\t\treturn processItems( fragment.items, values, guid, counter );\n\t\t\t\t}).join( '' );\n\t\t\t} else {\n\t\t\t\treturn processItems( item.fragment.items, values, guid, counter );\n\t\t\t}\n\t\t}\n\n\t\tvar placeholderId = guid + \"-\" + (counter++);\n\t\tvar model = item.model || item.newModel;\n\n\t\tvalues[ placeholderId ] = model ?\n\t\t\tmodel.wrapper ?\n\t\t\t\tmodel.wrapperValue :\n\t\t\t\tmodel.get() :\n\t\t\tundefined;\n\n\t\treturn '${' + placeholderId + '}';\n\t}).join( '' );\n}\n\nfunction unrenderAndDestroy$1 ( item ) {\n\titem.unrender( true );\n}\n\nvar Fragment = function Fragment ( options ) {\n\tthis.owner = options.owner; // The item that owns this fragment - an element, section, partial, or attribute\n\n\tthis.isRoot = !options.owner.parentFragment;\n\tthis.parent = this.isRoot ? null : this.owner.parentFragment;\n\tthis.ractive = options.ractive || ( this.isRoot ? options.owner : this.parent.ractive );\n\n\tthis.componentParent = ( this.isRoot && this.ractive.component ) ? this.ractive.component.parentFragment : null;\n\n\tthis.context = null;\n\tthis.rendered = false;\n\n\t// encapsulated styles should be inherited until they get applied by an element\n\tthis.cssIds = 'cssIds' in options ? options.cssIds : ( this.parent ? this.parent.cssIds : null );\n\n\tthis.resolvers = [];\n\n\tthis.dirty = false;\n\tthis.dirtyValue = true; // used for attribute values\n\n\tthis.template = options.template || [];\n\tthis.createItems();\n};\n\nFragment.prototype.bind = function bind$1 ( context ) {\n\tthis.context = context;\n\tthis.items.forEach( bind$1$1 );\n\tthis.bound = true;\n\n\t// in rare cases, a forced resolution (or similar) will cause the\n\t// fragment to be dirty before it's even finished binding. In those\n\t// cases we update immediately\n\tif ( this.dirty ) { this.update(); }\n\n\treturn this;\n};\n\nFragment.prototype.bubble = function bubble () {\n\tthis.dirtyValue = true;\n\n\tif ( !this.dirty ) {\n\t\tthis.dirty = true;\n\n\t\tif ( this.isRoot ) { // TODO encapsulate 'is component root, but not overall root' check?\n\t\t\tif ( this.ractive.component ) {\n\t\t\t\tthis.ractive.component.bubble();\n\t\t\t} else if ( this.bound ) {\n\t\t\t\trunloop.addFragment( this );\n\t\t\t}\n\t\t} else {\n\t\t\tthis.owner.bubble();\n\t\t}\n\t}\n};\n\nFragment.prototype.createItems = function createItems () {\n\t\tvar this$1 = this;\n\n\t// this is a hot code path\n\tvar max = this.template.length;\n\tthis.items = [];\n\tfor ( var i = 0; i < max; i++ ) {\n\t\tthis$1.items[i] = createItem({ parentFragment: this$1, template: this$1.template[i], index: i });\n\t}\n};\n\nFragment.prototype.destroyed = function destroyed$1 () {\n\tthis.items.forEach( destroyed$1$1 );\n};\n\nFragment.prototype.detach = function detach () {\n\tvar docFrag = createDocumentFragment();\n\tthis.items.forEach( function (item) { return docFrag.appendChild( item.detach() ); } );\n\treturn docFrag;\n};\n\nFragment.prototype.find = function find ( selector, options ) {\n\treturn findMap( this.items, function (i) { return i.find( selector, options ); } );\n};\n\nFragment.prototype.findAll = function findAll ( selector, query ) {\n\tif ( this.items ) {\n\t\tthis.items.forEach( function (i) { return i.findAll && i.findAll( selector, query ); } );\n\t}\n};\n\nFragment.prototype.findComponent = function findComponent ( name, options ) {\n\treturn findMap( this.items, function (i) { return i.findComponent( name, options ); } );\n};\n\nFragment.prototype.findAllComponents = function findAllComponents ( name, query ) {\n\tif ( this.items ) {\n\t\tthis.items.forEach( function (i) { return i.findAllComponents && i.findAllComponents( name, query ); } );\n\t}\n};\n\nFragment.prototype.findContext = function findContext () {\n\tvar fragment = this;\n\twhile ( fragment && !fragment.context ) { fragment = fragment.parent; }\n\tif ( !fragment ) { return this.ractive.viewmodel; }\n\telse { return fragment.context; }\n};\n\nFragment.prototype.findNextNode = function findNextNode ( item ) {\n\t\tvar this$1 = this;\n\n\t// search for the next node going forward\n\tif ( item ) {\n\t\tfor ( var i = item.index + 1; i < this.items.length; i++ ) {\n\t\t\tif ( !this$1.items[ i ] ) { continue; }\n\n\t\t\tvar node = this$1.items[ i ].firstNode( true );\n\t\t\tif ( node ) { return node; }\n\t\t}\n\t}\n\n\t// if this is the root fragment, and there are no more items,\n\t// it means we're at the end...\n\tif ( this.isRoot ) {\n\t\tif ( this.ractive.component ) {\n\t\t\treturn this.ractive.component.parentFragment.findNextNode( this.ractive.component );\n\t\t}\n\n\t\t// TODO possible edge case with other content\n\t\t// appended to this.ractive.el?\n\t\treturn null;\n\t}\n\n\tif ( this.parent ) { return this.owner.findNextNode( this ); } // the argument is in case the parent is a RepeatedFragment\n};\n\nFragment.prototype.findParentNode = function findParentNode () {\n\tvar fragment = this;\n\n\tdo {\n\t\tif ( fragment.owner.type === ELEMENT ) {\n\t\t\treturn fragment.owner.node;\n\t\t}\n\n\t\tif ( fragment.isRoot && !fragment.ractive.component ) { // TODO encapsulate check\n\t\t\treturn fragment.ractive.el;\n\t\t}\n\n\t\tif ( fragment.owner.type === YIELDER ) {\n\t\t\tfragment = fragment.owner.containerFragment;\n\t\t} else {\n\t\t\tfragment = fragment.componentParent || fragment.parent; // TODO ugh\n\t\t}\n\t} while ( fragment );\n\n\tthrow new Error( 'Could not find parent node' ); // TODO link to issue tracker\n};\n\nFragment.prototype.findRepeatingFragment = function findRepeatingFragment () {\n\tvar fragment = this;\n\t// TODO better check than fragment.parent.iterations\n\twhile ( ( fragment.parent || fragment.componentParent ) && !fragment.isIteration ) {\n\t\tfragment = fragment.parent || fragment.componentParent;\n\t}\n\n\treturn fragment;\n};\n\nFragment.prototype.firstNode = function firstNode ( skipParent ) {\n\tvar node = findMap( this.items, function (i) { return i.firstNode( true ); } );\n\tif ( node ) { return node; }\n\tif ( skipParent ) { return null; }\n\n\treturn this.parent.findNextNode( this.owner );\n};\n\nFragment.prototype.rebinding = function rebinding ( next ) {\n\tthis.context = next;\n};\n\nFragment.prototype.render = function render ( target, occupants ) {\n\tif ( this.rendered ) { throw new Error( 'Fragment is already rendered!' ); }\n\tthis.rendered = true;\n\n\tthis.items.forEach( function (item) { return item.render( target, occupants ); } );\n};\n\nFragment.prototype.resetTemplate = function resetTemplate ( template ) {\n\tvar wasBound = this.bound;\n\tvar wasRendered = this.rendered;\n\n\t// TODO ensure transitions are disabled globally during reset\n\n\tif ( wasBound ) {\n\t\tif ( wasRendered ) { this.unrender( true ); }\n\t\tthis.unbind();\n\t}\n\n\tthis.template = template;\n\tthis.createItems();\n\n\tif ( wasBound ) {\n\t\tthis.bind( this.context );\n\n\t\tif ( wasRendered ) {\n\t\t\tvar parentNode = this.findParentNode();\n\t\t\tvar anchor = this.findNextNode();\n\n\t\t\tif ( anchor ) {\n\t\t\t\tvar docFrag = createDocumentFragment();\n\t\t\t\tthis.render( docFrag );\n\t\t\t\tparentNode.insertBefore( docFrag, anchor );\n\t\t\t} else {\n\t\t\t\tthis.render( parentNode );\n\t\t\t}\n\t\t}\n\t}\n};\n\nFragment.prototype.resolve = function resolve ( template, callback ) {\n\tif ( !this.context && this.parent.resolve ) {\n\t\treturn this.parent.resolve( template, callback );\n\t}\n\n\tvar resolver = new ReferenceResolver( this, template, callback );\n\tthis.resolvers.push( resolver );\n\n\treturn resolver; // so we can e.g. force resolution\n};\n\nFragment.prototype.shuffled = function shuffled$1 () {\n\tthis.items.forEach( shuffled$1$1 );\n};\n\nFragment.prototype.toHtml = function toHtml () {\n\treturn this.toString();\n};\n\nFragment.prototype.toString = function toString$1 ( escape ) {\n\treturn this.items.map( escape ? toEscapedString : toString$2 ).join( '' );\n};\n\nFragment.prototype.unbind = function unbind$1 () {\n\tthis.items.forEach( unbind$1$1 );\n\tthis.bound = false;\n\n\treturn this;\n};\n\nFragment.prototype.unrender = function unrender$1 ( shouldDestroy ) {\n\tthis.items.forEach( shouldDestroy ? unrenderAndDestroy$1 : unrender$1$1 );\n\tthis.rendered = false;\n};\n\nFragment.prototype.update = function update$1 () {\n\tif ( this.dirty ) {\n\t\tif ( !this.updating ) {\n\t\t\tthis.dirty = false;\n\t\t\tthis.updating = true;\n\t\t\tthis.items.forEach( update$1$1 );\n\t\t\tthis.updating = false;\n\t\t} else if ( this.isRoot ) {\n\t\t\trunloop.addFragmentToRoot( this );\n\t\t}\n\t}\n};\n\nFragment.prototype.valueOf = function valueOf () {\n\tif ( this.items.length === 1 ) {\n\t\treturn this.items[0].valueOf();\n\t}\n\n\tif ( this.dirtyValue ) {\n\t\tvar values = {};\n\t\tvar source = processItems( this.items, values, this.ractive._guid );\n\t\tvar parsed = parseJSON( source, values );\n\n\t\tthis.value = parsed ?\n\t\t\tparsed.value :\n\t\t\tthis.toString();\n\n\t\tthis.dirtyValue = false;\n\t}\n\n\treturn this.value;\n};\n\nfunction getChildQueue ( queue, ractive ) {\n\treturn queue[ ractive._guid ] || ( queue[ ractive._guid ] = [] );\n}\n\nfunction fire$1 ( hookQueue, ractive ) {\n\tvar childQueue = getChildQueue( hookQueue.queue, ractive );\n\n\thookQueue.hook.fire( ractive );\n\n\t// queue is \"live\" because components can end up being\n\t// added while hooks fire on parents that modify data values.\n\twhile ( childQueue.length ) {\n\t\tfire$1( hookQueue, childQueue.shift() );\n\t}\n\n\tdelete hookQueue.queue[ ractive._guid ];\n}\n\nvar HookQueue = function HookQueue ( event ) {\n\tthis.hook = new Hook( event );\n\tthis.inProcess = {};\n\tthis.queue = {};\n};\n\nHookQueue.prototype.begin = function begin ( ractive ) {\n\tthis.inProcess[ ractive._guid ] = true;\n};\n\nHookQueue.prototype.end = function end ( ractive ) {\n\tvar parent = ractive.parent;\n\n\t// If this is *isn't* a child of a component that's in process,\n\t// it should call methods or fire at this point\n\tif ( !parent || !this.inProcess[ parent._guid ] ) {\n\t\tfire$1( this, ractive );\n\t}\n\t// elsewise, handoff to parent to fire when ready\n\telse {\n\t\tgetChildQueue( this.queue, parent ).push( ractive );\n\t}\n\n\tdelete this.inProcess[ ractive._guid ];\n};\n\nvar configHook = new Hook( 'config' );\nvar initHook = new HookQueue( 'init' );\n\nfunction initialise ( ractive, userOptions, options ) {\n\tObject.keys( ractive.viewmodel.computations ).forEach( function (key) {\n\t\tvar computation = ractive.viewmodel.computations[ key ];\n\n\t\tif ( ractive.viewmodel.value.hasOwnProperty( key ) ) {\n\t\t\tcomputation.set( ractive.viewmodel.value[ key ] );\n\t\t}\n\t});\n\n\t// set up event subscribers\n\tsubscribe( ractive, userOptions, 'on' );\n\n\t// init config from Parent and options\n\tconfig.init( ractive.constructor, ractive, userOptions );\n\n\tconfigHook.fire( ractive );\n\n\t// general config done, set up observers\n\tsubscribe( ractive, userOptions, 'observe' );\n\n\tinitHook.begin( ractive );\n\n\tvar fragment = ractive.fragment = createFragment( ractive, options );\n\tif ( fragment ) { fragment.bind( ractive.viewmodel ); }\n\n\tinitHook.end( ractive );\n\n\tif ( fragment ) {\n\t\t// render automatically ( if `el` is specified )\n\t\tvar el = getElement( ractive.el || ractive.target );\n\t\tif ( el ) {\n\t\t\tvar promise = ractive.render( el, ractive.append );\n\n\t\t\tif ( Ractive.DEBUG_PROMISES ) {\n\t\t\t\tpromise.catch( function (err) {\n\t\t\t\t\twarnOnceIfDebug( 'Promise debugging is enabled, to help solve errors that happen asynchronously. Some browsers will log unhandled promise rejections, in which case you can safely disable promise debugging:\\n  Ractive.DEBUG_PROMISES = false;' );\n\t\t\t\t\twarnIfDebug( 'An error happened during rendering', { ractive: ractive });\n\t\t\t\t\tlogIfDebug( err );\n\n\t\t\t\t\tthrow err;\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction createFragment ( ractive, options ) {\n\tif ( options === void 0 ) options = {};\n\n\tif ( ractive.template ) {\n\t\tvar cssIds;\n\n\t\tif ( options.cssIds || ractive.cssId ) {\n\t\t\tcssIds = options.cssIds ? options.cssIds.slice() : [];\n\n\t\t\tif ( ractive.cssId ) {\n\t\t\t\tcssIds.push( ractive.cssId );\n\t\t\t}\n\t\t}\n\n\t\treturn new Fragment({\n\t\t\towner: ractive,\n\t\t\ttemplate: ractive.template,\n\t\t\tcssIds: cssIds\n\t\t});\n\t}\n}\n\nfunction subscribe ( instance, options, type ) {\n\tvar subs = ( instance.constructor[ (\"_\" + type) ] || [] ).concat( toPairs( options[ type ] || [] ) );\n\tvar single = type === 'on' ? 'once' : (type + \"Once\");\n\n\tsubs.forEach( function (ref) {\n\t\tvar target = ref[0];\n\t\tvar config$$1 = ref[1];\n\n\t\tif ( typeof config$$1 === 'function' ) {\n\t\t\tinstance[type]( target, config$$1 );\n\t\t} else if ( typeof config$$1 === 'object' && typeof config$$1.handler === 'function' ) {\n\t\t\tinstance[ config$$1.once ? single : type ]( target, config$$1.handler, config$$1 );\n\t\t}\n\t});\n}\n\nvar renderHook = new Hook( 'render' );\nvar completeHook = new Hook( 'complete' );\n\nfunction render$2 ( ractive, target, anchor, occupants ) {\n\t// if `noIntro` is `true`, temporarily disable transitions\n\tvar transitionsEnabled = ractive.transitionsEnabled;\n\tif ( ractive.noIntro ) { ractive.transitionsEnabled = false; }\n\n\tvar promise = runloop.start( ractive, true );\n\trunloop.scheduleTask( function () { return renderHook.fire( ractive ); }, true );\n\n\tif ( ractive.fragment.rendered ) {\n\t\tthrow new Error( 'You cannot call ractive.render() on an already rendered instance! Call ractive.unrender() first' );\n\t}\n\n\tif ( ractive.destroyed ) {\n\t\tractive.destroyed = false;\n\t\tractive.fragment = createFragment( ractive ).bind( ractive.viewmodel );\n\t}\n\n\tanchor = getElement( anchor ) || ractive.anchor;\n\n\tractive.el = ractive.target = target;\n\tractive.anchor = anchor;\n\n\t// ensure encapsulated CSS is up-to-date\n\tif ( ractive.cssId ) { applyCSS(); }\n\n\tif ( target ) {\n\t\t( target.__ractive_instances__ || ( target.__ractive_instances__ = [] ) ).push( ractive );\n\n\t\tif ( anchor ) {\n\t\t\tvar docFrag = doc.createDocumentFragment();\n\t\t\tractive.fragment.render( docFrag );\n\t\t\ttarget.insertBefore( docFrag, anchor );\n\t\t} else {\n\t\t\tractive.fragment.render( target, occupants );\n\t\t}\n\t}\n\n\trunloop.end();\n\tractive.transitionsEnabled = transitionsEnabled;\n\n\treturn promise.then( function () { return completeHook.fire( ractive ); } );\n}\n\nfunction Ractive$render ( target, anchor ) {\n\tif ( this.torndown ) {\n\t\twarnIfDebug( 'ractive.render() was called on a Ractive instance that was already torn down' );\n\t\treturn Promise.resolve();\n\t}\n\n\ttarget = getElement( target ) || this.el;\n\n\tif ( !this.append && target ) {\n\t\t// Teardown any existing instances *before* trying to set up the new one -\n\t\t// avoids certain weird bugs\n\t\tvar others = target.__ractive_instances__;\n\t\tif ( others ) { others.forEach( teardown$1$1 ); }\n\n\t\t// make sure we are the only occupants\n\t\tif ( !this.enhance ) {\n\t\t\ttarget.innerHTML = ''; // TODO is this quicker than removeChild? Initial research inconclusive\n\t\t}\n\t}\n\n\tvar occupants = this.enhance ? toArray( target.childNodes ) : null;\n\tvar promise = render$2( this, target, anchor, occupants );\n\n\tif ( occupants ) {\n\t\twhile ( occupants.length ) { target.removeChild( occupants.pop() ); }\n\t}\n\n\treturn promise;\n}\n\nvar shouldRerender = [ 'template', 'partials', 'components', 'decorators', 'events' ];\n\nvar completeHook$1 = new Hook( 'complete' );\nvar resetHook = new Hook( 'reset' );\nvar renderHook$1 = new Hook( 'render' );\nvar unrenderHook = new Hook( 'unrender' );\n\nfunction Ractive$reset ( data ) {\n\tdata = data || {};\n\n\tif ( typeof data !== 'object' ) {\n\t\tthrow new Error( 'The reset method takes either no arguments, or an object containing new data' );\n\t}\n\n\t// TEMP need to tidy this up\n\tdata = dataConfigurator.init( this.constructor, this, { data: data });\n\n\tvar promise = runloop.start( this, true );\n\n\t// If the root object is wrapped, try and use the wrapper's reset value\n\tvar wrapper = this.viewmodel.wrapper;\n\tif ( wrapper && wrapper.reset ) {\n\t\tif ( wrapper.reset( data ) === false ) {\n\t\t\t// reset was rejected, we need to replace the object\n\t\t\tthis.viewmodel.set( data );\n\t\t}\n\t} else {\n\t\tthis.viewmodel.set( data );\n\t}\n\n\t// reset config items and track if need to rerender\n\tvar changes = config.reset( this );\n\tvar rerender;\n\n\tvar i = changes.length;\n\twhile ( i-- ) {\n\t\tif ( shouldRerender.indexOf( changes[i] ) > -1 ) {\n\t\t\trerender = true;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif ( rerender ) {\n\t\tunrenderHook.fire( this );\n\t\tthis.fragment.resetTemplate( this.template );\n\t\trenderHook$1.fire( this );\n\t\tcompleteHook$1.fire( this );\n\t}\n\n\trunloop.end();\n\n\tresetHook.fire( this, data );\n\n\treturn promise;\n}\n\nfunction collect( source, name, attr, dest ) {\n\tsource.forEach( function (item) {\n\t\t// queue to rerender if the item is a partial and the current name matches\n\t\tif ( item.type === PARTIAL && ( item.refName ===  name || item.name === name ) ) {\n\t\t\titem.inAttribute = attr;\n\t\t\tdest.push( item );\n\t\t\treturn; // go no further\n\t\t}\n\n\t\t// if it has a fragment, process its items\n\t\tif ( item.fragment ) {\n\t\t\tcollect( item.fragment.iterations || item.fragment.items, name, attr, dest );\n\t\t}\n\n\t\t// or if it is itself a fragment, process its items\n\t\telse if ( isArray( item.items ) ) {\n\t\t\tcollect( item.items, name, attr, dest );\n\t\t}\n\n\t\t// or if it is a component, step in and process its items\n\t\telse if ( item.type === COMPONENT && item.instance ) {\n\t\t\t// ...unless the partial is shadowed\n\t\t\tif ( item.instance.partials[ name ] ) { return; }\n\t\t\tcollect( item.instance.fragment.items, name, attr, dest );\n\t\t}\n\n\t\t// if the item is an element, process its attributes too\n\t\tif ( item.type === ELEMENT ) {\n\t\t\tif ( isArray( item.attributes ) ) {\n\t\t\t\tcollect( item.attributes, name, true, dest );\n\t\t\t}\n\t\t}\n\t});\n}\n\nfunction forceResetTemplate$1 ( partial ) {\n\tpartial.forceResetTemplate();\n}\n\nvar resetPartial = function ( name, partial ) {\n\tvar collection = [];\n\tcollect( this.fragment.items, name, false, collection );\n\n\tvar promise = runloop.start( this, true );\n\n\tthis.partials[ name ] = partial;\n\tcollection.forEach( forceResetTemplate$1 );\n\n\trunloop.end();\n\n\treturn promise;\n};\n\n// TODO should resetTemplate be asynchronous? i.e. should it be a case\n// of outro, update template, intro? I reckon probably not, since that\n// could be achieved with unrender-resetTemplate-render. Also, it should\n// conceptually be similar to resetPartial, which couldn't be async\n\nfunction Ractive$resetTemplate ( template ) {\n\ttemplateConfigurator.init( null, this, { template: template });\n\n\tvar transitionsEnabled = this.transitionsEnabled;\n\tthis.transitionsEnabled = false;\n\n\t// Is this is a component, we need to set the `shouldDestroy`\n\t// flag, otherwise it will assume by default that a parent node\n\t// will be detached, and therefore it doesn't need to bother\n\t// detaching its own nodes\n\tvar component = this.component;\n\tif ( component ) { component.shouldDestroy = true; }\n\tthis.unrender();\n\tif ( component ) { component.shouldDestroy = false; }\n\n\tvar promise = runloop.start();\n\n\t// remove existing fragment and create new one\n\tthis.fragment.unbind().unrender( true );\n\n\tthis.fragment = new Fragment({\n\t\ttemplate: this.template,\n\t\troot: this,\n\t\towner: this\n\t});\n\n\tvar docFrag = createDocumentFragment();\n\tthis.fragment.bind( this.viewmodel ).render( docFrag );\n\n\t// if this is a component, its el may not be valid, so find a\n\t// target based on the component container\n\tif ( component && !component.external ) {\n\t\tthis.fragment.findParentNode().insertBefore( docFrag, component.findNextNode() );\n\t} else {\n\t\tthis.el.insertBefore( docFrag, this.anchor );\n\t}\n\n\trunloop.end();\n\n\tthis.transitionsEnabled = transitionsEnabled;\n\n\treturn promise;\n}\n\nvar reverse$1 = makeArrayMethod( 'reverse' ).path;\n\nfunction Ractive$set ( keypath, value ) {\n\tvar ractive = this;\n\n\treturn set$1( ractive, build( ractive, keypath, value ) );\n}\n\nvar shift$1 = makeArrayMethod( 'shift' ).path;\n\nvar sort$1 = makeArrayMethod( 'sort' ).path;\n\nvar splice$1 = makeArrayMethod( 'splice' ).path;\n\nfunction Ractive$subtract ( keypath, d ) {\n\treturn add$1( this, keypath, ( d === undefined ? -1 : -d ) );\n}\n\nfunction Ractive$toggle ( keypath ) {\n\tif ( typeof keypath !== 'string' ) {\n\t\tthrow new TypeError( badArguments );\n\t}\n\n\treturn set$1( this, gather( this, keypath ).map( function (m) { return [ m, !m.get() ]; } ) );\n}\n\nfunction Ractive$toCSS() {\n\tvar cssIds = [ this.cssId ].concat( this.findAllComponents().map( function (c) { return c.cssId; } ) );\n\tvar uniqueCssIds = Object.keys(cssIds.reduce( function ( ids, id ) { return (ids[id] = true, ids); }, {}));\n\treturn getCSS( uniqueCssIds );\n}\n\nfunction Ractive$toHTML () {\n\treturn this.fragment.toString( true );\n}\n\nfunction toText () {\n\treturn this.fragment.toString( false );\n}\n\nfunction Ractive$transition ( name, node, params ) {\n\n\tif ( node instanceof HTMLElement ) {\n\t\t// good to go\n\t}\n\telse if ( isObject( node ) ) {\n\t\t// omitted, use event node\n\t\tparams = node;\n\t}\n\n\t// if we allow query selector, then it won't work\n\t// simple params like \"fast\"\n\n\t// else if ( typeof node === 'string' ) {\n\t// \t// query selector\n\t// \tnode = this.find( node )\n\t// }\n\n\tnode = node || this.event.node;\n\n\tif ( !node || !node._ractive ) {\n\t\tfatal( (\"No node was supplied for transition \" + name) );\n\t}\n\n\tparams = params || {};\n\tvar owner = node._ractive.proxy;\n\tvar transition = new Transition({ owner: owner, parentFragment: owner.parentFragment, name: name, params: params });\n\ttransition.bind();\n\n\tvar promise = runloop.start( this, true );\n\trunloop.registerTransition( transition );\n\trunloop.end();\n\n\tpromise.then( function () { return transition.unbind(); } );\n\treturn promise;\n}\n\nfunction unlink$2( here ) {\n\tvar promise = runloop.start();\n\tthis.viewmodel.joinAll( splitKeypath( here ), { lastLink: false } ).unlink();\n\trunloop.end();\n\treturn promise;\n}\n\nvar unrenderHook$1 = new Hook( 'unrender' );\n\nfunction Ractive$unrender () {\n\tif ( !this.fragment.rendered ) {\n\t\twarnIfDebug( 'ractive.unrender() was called on a Ractive instance that was not rendered' );\n\t\treturn Promise$1.resolve();\n\t}\n\n\tvar promise = runloop.start( this, true );\n\n\t// If this is a component, and the component isn't marked for destruction,\n\t// don't detach nodes from the DOM unnecessarily\n\tvar shouldDestroy = !this.component || ( this.component.anchor || {} ).shouldDestroy || this.component.shouldDestroy || this.shouldDestroy;\n\tthis.fragment.unrender( shouldDestroy );\n\tif ( shouldDestroy ) { this.destroyed = true; }\n\n\tremoveFromArray( this.el.__ractive_instances__, this );\n\n\tunrenderHook$1.fire( this );\n\n\trunloop.end();\n\treturn promise;\n}\n\nvar unshift$1 = makeArrayMethod( 'unshift' ).path;\n\nfunction Ractive$updateModel ( keypath, cascade ) {\n\tvar promise = runloop.start( this, true );\n\n\tif ( !keypath ) {\n\t\tthis.viewmodel.updateFromBindings( true );\n\t} else {\n\t\tthis.viewmodel.joinAll( splitKeypath( keypath ) ).updateFromBindings( cascade !== false );\n\t}\n\n\trunloop.end();\n\n\treturn promise;\n}\n\nvar proto = {\n\tadd: Ractive$add,\n\tanimate: Ractive$animate,\n\tattachChild: attachChild,\n\tdetach: Ractive$detach,\n\tdetachChild: detachChild,\n\tfind: Ractive$find,\n\tfindAll: Ractive$findAll,\n\tfindAllComponents: Ractive$findAllComponents,\n\tfindComponent: Ractive$findComponent,\n\tfindContainer: Ractive$findContainer,\n\tfindParent: Ractive$findParent,\n\tfire: Ractive$fire,\n\tget: Ractive$get,\n\tgetNodeInfo: getNodeInfo,\n\tinsert: Ractive$insert,\n\tlink: link$2,\n\tmerge: thisRactive$merge,\n\tobserve: observe$1,\n\tobserveList: observeList,\n\tobserveOnce: observeOnce$1,\n\t// TODO reinstate these\n\t// observeListOnce,\n\toff: Ractive$off,\n\ton: Ractive$on,\n\tonce: Ractive$once,\n\tpop: pop$1,\n\tpush: push$1,\n\trender: Ractive$render,\n\treset: Ractive$reset,\n\tresetPartial: resetPartial,\n\tresetTemplate: Ractive$resetTemplate,\n\treverse: reverse$1,\n\tset: Ractive$set,\n\tshift: shift$1,\n\tsort: sort$1,\n\tsplice: splice$1,\n\tsubtract: Ractive$subtract,\n\tteardown: Ractive$teardown,\n\ttoggle: Ractive$toggle,\n\ttoCSS: Ractive$toCSS,\n\ttoCss: Ractive$toCSS,\n\ttoHTML: Ractive$toHTML,\n\ttoHtml: Ractive$toHTML,\n\ttoText: toText,\n\ttransition: Ractive$transition,\n\tunlink: unlink$2,\n\tunrender: Ractive$unrender,\n\tunshift: unshift$1,\n\tupdate: Ractive$update,\n\tupdateModel: Ractive$updateModel\n};\n\nvar wrap$2 = function ( method, superMethod, force ) {\n\n\tif ( force || needsSuper( method, superMethod ) )  {\n\n\t\treturn function () {\n\n\t\t\tvar hasSuper = ( '_super' in this );\n\t\t\tvar _super = this._super;\n\n\t\t\tthis._super = superMethod;\n\n\t\t\tvar result = method.apply( this, arguments );\n\n\t\t\tif ( hasSuper ) {\n\t\t\t\tthis._super = _super;\n\t\t\t}\n\n\t\t\treturn result;\n\t\t};\n\t}\n\n\telse {\n\t\treturn method;\n\t}\n};\n\nfunction needsSuper ( method, superMethod ) {\n\treturn typeof superMethod === 'function' && /_super/.test( method );\n}\n\nfunction unwrap ( Child ) {\n\tvar options = {};\n\n\twhile ( Child ) {\n\t\taddRegistries( Child, options );\n\t\taddOtherOptions( Child, options );\n\n\t\tif ( Child._Parent !== Ractive ) {\n\t\t\tChild = Child._Parent;\n\t\t} else {\n\t\t\tChild = false;\n\t\t}\n\t}\n\n\treturn options;\n}\n\nfunction addRegistries ( Child, options ) {\n\tregistries.forEach( function (r) {\n\t\taddRegistry(\n\t\t\tr.useDefaults ? Child.prototype : Child,\n\t\t\toptions, r.name );\n\t});\n}\n\nfunction addRegistry ( target, options, name ) {\n\tvar registry;\n\tvar keys = Object.keys( target[ name ] );\n\n\tif ( !keys.length ) { return; }\n\n\tif ( !( registry = options[ name ] ) ) {\n\t\tregistry = options[ name ] = {};\n\t}\n\n\tkeys\n\t\t.filter( function (key) { return !( key in registry ); } )\n\t\t.forEach( function (key) { return registry[ key ] = target[ name ][ key ]; } );\n}\n\nfunction addOtherOptions ( Child, options ) {\n\tObject.keys( Child.prototype ).forEach( function (key) {\n\t\tif ( key === 'computed' ) { return; }\n\n\t\tvar value = Child.prototype[ key ];\n\n\t\tif ( !( key in options ) ) {\n\t\t\toptions[ key ] = value._method ? value._method : value;\n\t\t}\n\n\t\t// is it a wrapped function?\n\t\telse if ( typeof options[ key ] === 'function'\n\t\t\t\t&& typeof value === 'function'\n\t\t\t\t&& options[ key ]._method ) {\n\n\t\t\tvar needsSuper = value._method;\n\n\t\t\tif ( needsSuper ) { value = value._method; }\n\n\t\t\t// rewrap bound directly to parent fn\n\t\t\tvar result = wrap$2( options[ key ]._method, value );\n\n\t\t\tif ( needsSuper ) { result._method = result; }\n\n\t\t\toptions[ key ] = result;\n\t\t}\n\t});\n}\n\nfunction extend$3 () {\n\tvar options = [], len = arguments.length;\n\twhile ( len-- ) options[ len ] = arguments[ len ];\n\n\tif( !options.length ) {\n\t\treturn extendOne( this );\n\t} else {\n\t\treturn options.reduce( extendOne, this );\n\t}\n}\n\nfunction extendOne ( Parent, options ) {\n\tif ( options === void 0 ) options = {};\n\n\t// if we're extending with another Ractive instance...\n\t//\n\t//   var Human = Ractive.extend(...), Spider = Ractive.extend(...);\n\t//   var Spiderman = Human.extend( Spider );\n\t//\n\t// ...inherit prototype methods and default options as well\n\tif ( options.prototype instanceof Ractive ) {\n\t\toptions = unwrap( options );\n\t}\n\n\tvar Child = function ( options ) {\n\t\tif ( !( this instanceof Child ) ) { return new Child( options ); }\n\n\t\tconstruct( this, options || {} );\n\t\tinitialise( this, options || {}, {} );\n\t};\n\n\tvar proto = create( Parent.prototype );\n\tproto.constructor = Child;\n\n\t// Static properties\n\tdefineProperties( Child, {\n\t\t// alias prototype as defaults\n\t\tdefaults: { value: proto },\n\n\t\t// extendable\n\t\textend: { value: extend$3, writable: true, configurable: true },\n\n\t\t// Parent - for IE8, can't use Object.getPrototypeOf\n\t\t_Parent: { value: Parent }\n\t});\n\n\t// extend configuration\n\tconfig.extend( Parent, proto, options );\n\n\t// store event and observer registries on the constructor when extending\n\tChild._on = ( Parent._on || [] ).concat( toPairs( options.on ) );\n\tChild._observe = ( Parent._observe || [] ).concat( toPairs( options.observe ) );\n\n\tdataConfigurator.extend( Parent, proto, options );\n\n\tif ( options.computed ) {\n\t\tproto.computed = extend$1( create( Parent.prototype.computed ), options.computed );\n\t}\n\n\tChild.prototype = proto;\n\n\treturn Child;\n}\n\nfunction joinKeys () {\n\tvar keys = [], len = arguments.length;\n\twhile ( len-- ) keys[ len ] = arguments[ len ];\n\n\treturn keys.map( escapeKey ).join( '.' );\n}\n\nfunction splitKeypath$1 ( keypath ) {\n\treturn splitKeypath( keypath ).map( unescapeKey );\n}\n\n// Ractive.js makes liberal use of things like Array.prototype.indexOf. In\n// older browsers, these are made available via a shim - here, we do a quick\n// pre-flight check to make sure that either a) we're not in a shit browser,\n// or b) we're using a Ractive-legacy.js build\nvar FUNCTION = 'function';\n\nif (\n\ttypeof Date.now !== FUNCTION                 ||\n\ttypeof String.prototype.trim !== FUNCTION    ||\n\ttypeof Object.keys !== FUNCTION              ||\n\ttypeof Array.prototype.indexOf !== FUNCTION  ||\n\ttypeof Array.prototype.forEach !== FUNCTION  ||\n\ttypeof Array.prototype.map !== FUNCTION      ||\n\ttypeof Array.prototype.filter !== FUNCTION   ||\n\t( win && typeof win.addEventListener !== FUNCTION )\n) {\n\tthrow new Error( 'It looks like you\\'re attempting to use Ractive.js in an older browser. You\\'ll need to use one of the \\'legacy builds\\' in order to continue - see http://docs.ractivejs.org/latest/legacy-builds for more information.' );\n}\n\nfunction Ractive ( options ) {\n\tif ( !( this instanceof Ractive ) ) { return new Ractive( options ); }\n\n\tconstruct( this, options || {} );\n\tinitialise( this, options || {}, {} );\n}\n\n// check to see if we're being asked to force Ractive as a global for some weird environments\nif ( win && !win.Ractive ) {\n\tvar opts = '';\n\tvar script = document.currentScript || document.querySelector( 'script[data-ractive-options]' );\n\n\tif ( script ) {\n\t\topts = script.getAttribute( 'data-ractive-options' ) || '';\n\t}\n\n\tif ( ~opts.indexOf( 'ForceGlobal' ) ) {\n\t\twin.Ractive = Ractive;\n\t}\n}\n\nextend$1( Ractive.prototype, proto, defaults );\nRactive.prototype.constructor = Ractive;\n\n// alias prototype as `defaults`\nRactive.defaults = Ractive.prototype;\n\n// static properties\ndefineProperties( Ractive, {\n\n\t// debug flag\n\tDEBUG:          { writable: true, value: true },\n\tDEBUG_PROMISES: { writable: true, value: true },\n\n\t// static methods:\n\textend:         { value: extend$3 },\n\tescapeKey:      { value: escapeKey },\n\tgetNodeInfo:    { value: staticInfo },\n\tjoinKeys:       { value: joinKeys },\n\tparse:          { value: parse$1$1 },\n\tsplitKeypath:   { value: splitKeypath$1 },\n\tunescapeKey:    { value: unescapeKey },\n\tgetCSS:         { value: getCSS },\n\n\t// namespaced constructors\n\tPromise:        { value: Promise$1 },\n\n\t// support\n\tenhance:        { writable: true, value: false },\n\tsvg:            { value: svg },\n\tmagic:          { value: magic },\n\n\t// version\n\tVERSION:        { value: '0.9.0-edge-8ee32a31d9fa054c3ffbbd8c9731e250c2e04495' },\n\n\t// plugins\n\tadaptors:       { writable: true, value: {} },\n\tcomponents:     { writable: true, value: {} },\n\tdecorators:     { writable: true, value: {} },\n\teasing:         { writable: true, value: easing },\n\tevents:         { writable: true, value: {} },\n\tinterpolators:  { writable: true, value: interpolators },\n\tpartials:       { writable: true, value: {} },\n\ttransitions:    { writable: true, value: {} }\n});\n\nreturn Ractive;\n\n})));\n"],"names":["fragment$1","key","value","oldKeys","this$1","iterations","splice","i","toRemove","push","reset","this","forEach","fragment","unbind","unrender","update$1$1","docFrag","newLength","isArray","length","isObject","Object","keys","rendered","createDocumentFragment","createIteration","render","indexRef","keyRef","refs","split","parentNode","parent","findParentNode","anchor","findNextNode","owner","insertBefore","updating","RepeatedFragment","prototype","updatePostShuffle","newIndices","pendingNewIndices","slice","indices","newIndex","oldIndex","len","context","get","oldLen","previousIterations","removed","index","model","joinKey","template","z","aliases","n","frag","contiguous","startIndex","appendChild","detach","childNodes","firstNode","k","shuffled","prefix","Section","MustacheContainer$$1","options","call","sectionType","templateSectionType","subordinate","l","__proto__","create","constructor","bind","sibling","parentFragment","items","indexOf","nextSibling","dirty","update","SECTION_UNLESS","isTruthy","Fragment","f","isRoot","undefined","SECTION_IF_WITH","isEmpty","rebinding","next","previous","safe","SECTION_IF","target","occupants","shuffle","SECTION_EACH","shouldDestroy","siblingFalsey","lastType","getType","newFragment","fragmentShouldExist","SECTION_WITH","MustacheContainer","Select","Element$$1","foundNode","node","binding","selectedOptions","getSelectedOptions","sync","defaultSelected","selected","selectNode","toArray","o","setFromNode","selectValue","getAttribute","isMultiple","optionWasSelected","optionValue","_ractive","shouldSelect","valueContains","forceUpdate","Element","Textarea","Input$$1","deferContent","attributeByName","isBindable","attributes","createItem","t","ATTRIBUTE","cssIds","bubble","runloop","scheduleTask","toString","Input","Text","Item$$1","type","TEXT","detachNode","inAttributes","nodeType","shift","nodeValue","doc","createTextNode","escape","escapeHtml","valueOf","Item","isClient","prefixCache","testStyle","createElement","style","prop","camelCase","capped","charAt","toUpperCase","substring","vendors","vendor","visible","prefix$1","hidden","prefix$2","i$1","addEventListener","onChange","onHide","onShow","win","createTransitions","unprefixPattern","RegExp","join","unprefix","replace","vendorPattern","hyphenate","str","test","match","toLowerCase","TRANSITION$1","TRANSITIONEND","CSS_TRANSITIONS_ENABLED","TRANSITION_DURATION","TRANSITION_PROPERTY","TRANSITION_TIMING_FUNCTION","testStyle$1","linear$2","x","canUseCssTransitions","cannotUseCssTransitions","transition","webkitTransition","to","changedProperties","resolve","setTimeout","transitionDone","clearTimeout","cssTimeout","checkComplete","jsTransitionsComplete","cssTransitionsComplete","unregisterCompleteHandler","ractive","fire","name","isIntro","transitionEndHandler","event","propertyName","cssTransitionsDone","property","duration","timing","removeEventListener","hashPrefix","namespaceURI","tagName","map","easing","delay","registerCompleteHandler","hash","originalValue","suffix","interpolator","propertiesToTransitionInJs","getStyle","warnIfDebug","exec","interpolate","parseFloat","warnOnceIfDebug","missingPlugin","Ticker","step","pos","complete","createTransitions$1","getComputedStyle","legacy","resolved$1","Promise$1","names","t0","t1","t2","Transition","findElement","element","onComplete","animateStyle","arguments","Error","setStyle","fulfil","propertyNames","computedStyle","current","v","_introTransition","_outroTransition","eventName","params","_fn","findInViewHierarchy","setupArgsFn","destroyed","props","styles","value$1","processParams","defaults","extend$1","idx","models","rebindMatch","r","unregister","addShuffleRegister","fn","addToArray","hasOwnProperty","start","completed","originalStyle","args","noReset","resetStyle","_manager","remove","shouldUnbind","teardownArgsFn","values","apply","promise","concat","then","removeFromArray","ieBug","ieBlacklist","elementCache","innerHTML","err","TABLE","THEAD","TBODY","TR","SELECT","insertHtml","html$$1","nodes","container","wrapper","selectedOption","querySelector","selectedIndex","svg$1","textContent","child","firstChild","Triple","Mustache$$1","find","selector","matches","queryResult","findAll","query","add","queryAllResult","querySelectorAll","numNodes","j","findComponent","html","decodeCharacterReferences","Mustache","constructors","ALIAS","Alias","ANCHOR","Component","DOCTYPE","Doctype","INTERPOLATOR","Interpolator","PARTIAL","Partial","SECTION","TRIPLE","YIELDER","Attribute","BINDING_FLAG","BindingFlag","DECORATOR","Decorator","EVENT","EventDirective","TRANSITION","specialElements","doctype","form","Form","input","option","Option","select","textarea","ReferenceResolver","reference","callback","normalise","splitKeypath","resolved","contexts","addUnresolved","componentParent","attemptResolution","resolveReference","forceResolution","findContext","joinAll","removeUnresolved","unresolved","c","component","resolvers","dirtyValue","createItems","bind$1$1","bound","addFragment","max","destroyed$1$1","item","findMap","findAllComponents","viewmodel","ELEMENT","el","containerFragment","findRepeatingFragment","isIteration","skipParent","resetTemplate","wasBound","wasRendered","resolver","shuffled$1$1","toHtml","toEscapedString","toString$2","unbind$1$1","unrenderAndDestroy$1","unrender$1$1","addFragmentToRoot","source","processItems","_guid","parsed","parseJSON","HookQueue","hook","Hook","inProcess","queue","begin","end","getChildQueue","fire$1","configHook","initHook","renderHook","completeHook","shouldRerender","completeHook$1","resetHook","renderHook$1","unrenderHook","resetPartial","partial","collection","collect","partials","forceResetTemplate$1","reverse$1","makeArrayMethod","path","shift$1","sort$1","splice$1","unrenderHook$1","unshift$1","proto","Ractive$add","animate","Ractive$animate","attachChild","Ractive$detach","detachChild","Ractive$find","Ractive$findAll","Ractive$findAllComponents","Ractive$findComponent","findContainer","Ractive$findContainer","findParent","Ractive$findParent","Ractive$fire","Ractive$get","getNodeInfo","insert","Ractive$insert","link","link$2","merge","thisRactive$merge","observe","observe$1","observeList","observeOnce","observeOnce$1","off","Ractive$off","on","Ractive$on","once","Ractive$once","pop","pop$1","push$1","Ractive$render","Ractive$reset","Ractive$resetTemplate","reverse","set","Ractive$set","sort","subtract","Ractive$subtract","teardown","Ractive$teardown","toggle","Ractive$toggle","toCSS","Ractive$toCSS","toCss","toHTML","Ractive$toHTML","toText","Ractive$transition","unlink","unlink$2","Ractive$unrender","unshift","Ractive$update","updateModel","Ractive$updateModel","wrap$2","method","superMethod","force","needsSuper","hasSuper","_super","result","FUNCTION","Date","now","String","trim","Array","filter","Ractive","opts","script","document","currentScript","defineProperties","DEBUG","writable","DEBUG_PROMISES","extend","extend$3","escapeKey","staticInfo","joinKeys","parse","parse$1$1","splitKeypath$1","unescapeKey","getCSS","Promise","enhance","svg","magic","VERSION","adaptors","components","decorators","events","interpolators","transitions","group","noInitialValue","existingValue","bindingValue","arrayContains","push$2","Binding$$1","CheckboxNameBinding","changed","wasChecked","isChecked","checked","getInitialValue","getValue","handleChange","lastValue","getKeypath","handleDomEvent","attachEvent","bindings","wasUndefined","valueSoFar","Binding","ContentEditableBinding","lazy","GenericBinding","timeout","isNumeric","handler","handleDelay","handleBlur","FileBinding","GenericBinding$$1","files","MultipleSelectBinding","attribute","locked","selectedValues","previousValue","arrayContentsMatch","setValue","keypath","initialValue","NumericBinding","isNaN","siblings","RadioBinding","getSiblings","root","RadioNameBinding","getBindingGroup","getValue$2","nameAttributeBinding","getKeypathModel","register","lastVal","setting","SingleSelectBinding","disabled","endsWithSemi","ContainerItem$$1","liveQueries","e","isVoid","voidElementNames","leftovers","m","ConditionalAttribute","sortAttributes","recreateTwowayBinding","createTwowayBinding","twoway","selectBinding","matches$$1","live","removeFromQuery","namespace","getNamespace","existing","nodeName","defineProperty","proxy","setAttribute","children","removeAttribute","render$1$1","updateLiveQueries","transitionsEnabled","registerTransition","makeDirty$2","attrs","stringifyAttribute","isSelected","inputIsCheckedRadio","cls","attr","safeAttributeString","getString","styleName","decamelize","inlineClass","detachWhenReady","ContainerItem","toFront","formBindings","handleReset","DOMEvent","fatal","listen","directive","original","unlisten","CustomEvent","eventPlugin","RactiveEvent","instance","cancel","specialPattern","dollarArgsPattern","COMPONENT","specialRef","ref","specialMatch","special","substr","dollarMatch","action","passedArgs","addHelpers","obj","wrapperValue","oldEvent","preventDefault","stopPropagation","fireEvent","addShuffleTask","isStatic","s","resolve$3","static","proto$1","mustache","safeToStringValue","string","data","defaultValue","specials$2","true","false","null","specialsPattern","numberPattern$1","placeholderPattern","placeholderAtStartPattern","onlyWhitespace","JsonParser","Parser","init","allowWhitespace","postProcess","leftover","converters","parser","placeholder","matchPattern","number","stringLiteral","readStringLiteral","$1","matchString","pair","getKeyValuePair","valueToken","read","Mapping","createMapping","boundFragment","updateDelegate","a","selectedAttribute","yielder","rx","refName","templateObj","getPartialTemplate","named","setTemplate","parsePartial","partialTemplate","resolveAliases","forceResetTemplate","inAttribute","doInAttributes","iteration","unrenderAndDestroy","wasArray","ComputationChild","Model$$1","isReadonly","syncComputedChildren","applyValue","dependencies","mark$1$1","shouldCapture","capture","parentValue","boundValue","links","marked","deps","handleChange$1$1","clearUnresolveds","childByKey","Model","Computation","signature","isExpression","setter","computationContext","newWrapperValue","adapt","maybeBind","startCapturing","getter","message","hasConsole","console","groupCollapsed","functionBody","prettify","getterString","stack","getterUseStack","truncateStack","error","groupEnd","stopCapturing","setDependencies","registerChange","mark","model$1","computations","prototype$1","ExpressionProxy","getFunction","createResolver","actuallyChanged","d","retrieve","dep","computation","ReferenceExpressionChild","isEqual","base","ReferenceExpressionProxy","baseResolver","intermediary","members","REFERENCE","isUnresolved","unregisterTwowayBinding","registerTwowayBinding","keypathModel","oneway","findBoundValue","hyphenatedStr","space","specials$1","float","remove$1","textTypes","accept-charset","accesskey","bgcolor","class","codebase","colspan","contenteditable","datetime","dirname","for","http-equiv","ismap","maxlength","novalidate","pubdate","readonly","rowspan","tabindex","usemap","booleanAttributes","namespaces","useProperty","isTwoway","isBoolean","lookupNamespace","getUpdateDelegate","camelize","twowayBinding","flag","set$3","div$1","noop","isSvg","parseAttributes","notIn","processWrapper","array","methodName","__model","mutatorMethods","patchedArrayProto","getNewIndices","wrappers","configurable","patchArrayMethods","unpatchArrayMethods","unpatch","patch","errorMessage$1","arrayAdaptor","object","wrap","ArrayWrapper","instances","storage","magicAdaptor","MagicWrapper","magicAdaptor$1","originalDescriptors","originalDescriptor","getOwnPropertyDescriptor","childKeypath","descriptor","createOrWrapDescriptor","__magic","revert","dependants","MagicArrayWrapper","magicWrapper","arrayWrapper","magicArrayAdaptor","RactiveModel","changes","isLink","initLink","hasProp$1","RootModel","applyChanges","_changeHash","flush","attached","attachImplicits","compute","createLink","targetPath","detached","detachImplicits","virtual","getVirtual","getRactiveModel","ractiveModel","getValueChildren","_link","has","Function","GlobalModel","SharedModel$1","localKey","origin","local","shouldTeardown","constructHook","registryNames$1","uid","teardownHook","destructHook","ComponentConstructor","isAnchor","p","content","_partials","addChild","addChild$1","removeChild","removeChild$1","construct","_inlinePartials","eventHandlers","initialise","_query","checking","checkAnchors","render$2","updateLiveQueries$1","makeDirty$1","teardown$2","unrenderItem","missingDecorator","warnOnce","warnAboutAmbiguity","parentForm","resetValue","CheckboxBinding","BindingGroup","checkboxName","getValue$1$1","LinkModel","attach","relinking","Missing","unwrap","bind$$1","shouldBind","ModelBase$$1","KeypathModel","getChild","notifyUpstream","isDetached","markedAll","notifiedUpstream","relinked","registerLink","sourcePath","unregisterLink","rebindChildren","shuffling","shuffle$1$1","teardown$1$1","ModelBase","lnk","implicit","fireShuffleTasks","ln","requestAnimationFrame","vendors$$1","lastTime","win$$1","currTime","timeToCall","Math","id","rAF","getTime","performance","tickers","running","tick","elapsed","eased","stop","abort","prefixers","ticker","rewrap","createBranch","adaptor","getPrefixer","from","fulfilPromise","isObjectLike","branch","lastLink","old","comparator","oldArray","newArray","recreateArray","oldLength","usedIndices","firstUnusedIndex","SharedModel","global","window","keypathExpr","arrayProto","mdl","result$1","promise$1","comparators","updateHook","modelPush","modelPop","modelShift","modelUnshift","modelSort","modelSplice","modelReverse","insertHook","Observer","dispatch","oldValue","newValue","defer","strict","cancelled","_observers","addObserver","PatternObserver","baseModel","pattern","baseKeypath","oldValues","newValues","findMatches","registerPatternObserver","unregisterPatternObserver","newKeys","wildcards","notify","touchedFrom","count","ok","ListObserver","pending","sliced","negativeOne","inserted","deleted","hadIndex","onceOptions","notEmptyString","PREFIX","styleDefinitions","isDirty","styleElement","useCssText","getElementsByTagName","styleSheet","adaptConfigurator","Parent","combine","ensureArray","selectorsPattern","commentsPattern","selectorUnitPattern","excludePattern","dataRvcGuidPattern","cssConfigurator","css","uuid","noCssTransform","transformCss","cssId","addCSS","dataConfigurator","combine$1","bind$2","_r_unbound","TEMPLATE_VERSION","functions","leadingWhitespace","ParseError","lineStart","lines","lineEnds","line","lineEnd","remaining","getContextMessage","getLinePos","lineNum","columnNum","contextLines","contextUp","contextDown","numTabs","annotation","char","msg","character","shortMessage","nextChar","Child","hasOwn","readTypeOf","INVERTED","CLOSING","COMMENT","DELIMCHANGE","CLOSING_TAG","INLINE_PARTIAL","NUMBER_LITERAL","STRING_LITERAL","ARRAY_LITERAL","OBJECT_LITERAL","BOOLEAN_LITERAL","REGEXP_LITERAL","GLOBAL","KEY_VALUE_PAIR","REFINEMENT","MEMBER","PREFIX_OPERATOR","BRACKETED","CONDITIONAL","INFIX_OPERATOR","INVOCATION","ELSE","ELSEIF","delimiterChangePattern","whitespacePattern","regexpPattern","pattern$1","regExpCache","getLowestIndex","haystack","needles","search","escapeRegExp","htmlEntities","quot","amp","apos","lt","gt","nbsp","iexcl","cent","pound","curren","yen","brvbar","sect","uml","copy","ordf","laquo","not","shy","reg","macr","deg","plusmn","sup2","sup3","acute","micro","para","middot","cedil","sup1","ordm","raquo","frac14","frac12","frac34","iquest","Agrave","Aacute","Acirc","Atilde","Auml","Aring","AElig","Ccedil","Egrave","Eacute","Ecirc","Euml","Igrave","Iacute","Icirc","Iuml","ETH","Ntilde","Ograve","Oacute","Ocirc","Otilde","Ouml","times","Oslash","Ugrave","Uacute","Ucirc","Uuml","Yacute","THORN","szlig","agrave","aacute","acirc","atilde","auml","aring","aelig","ccedil","egrave","eacute","ecirc","euml","igrave","iacute","icirc","iuml","eth","ntilde","ograve","oacute","ocirc","otilde","ouml","divide","oslash","ugrave","uacute","ucirc","uuml","yacute","thorn","yuml","OElig","oelig","Scaron","scaron","Yuml","fnof","circ","tilde","Alpha","Beta","Gamma","Delta","Epsilon","Zeta","Eta","Theta","Iota","Kappa","Lambda","Mu","Nu","Xi","Omicron","Pi","Rho","Sigma","Tau","Upsilon","Phi","Chi","Psi","Omega","alpha","beta","gamma","delta","epsilon","zeta","eta","theta","iota","kappa","lambda","mu","nu","xi","omicron","pi","rho","sigmaf","sigma","tau","upsilon","phi","chi","psi","omega","thetasym","upsih","piv","ensp","emsp","thinsp","zwnj","zwj","lrm","rlm","ndash","mdash","lsquo","rsquo","sbquo","ldquo","rdquo","bdquo","dagger","Dagger","bull","hellip","permil","prime","Prime","lsaquo","rsaquo","oline","frasl","euro","image","weierp","real","trade","alefsym","larr","uarr","rarr","darr","harr","crarr","lArr","uArr","rArr","dArr","hArr","forall","part","exist","empty","nabla","isin","notin","ni","prod","sum","minus","lowast","radic","infin","ang","and","or","cap","cup","int","there4","sim","cong","asymp","ne","equiv","le","ge","sub","sup","nsub","sube","supe","oplus","otimes","perp","sdot","lceil","rceil","lfloor","rfloor","lang","rang","loz","spades","clubs","hearts","diams","controlCharacters","entityPattern","codePointSupport","fromCodePoint","codeToChar","fromCharCode","lessThan","greaterThan","invalid","expectedExpression","expectedParen","numberPattern","stringMiddlePattern","escapeSequencePattern","lineContinuationPattern","makeQuotedStringMatcher","okQuote","literal","done","charCodeAt","JSON","getSingleQuotedString","getDoubleQuotedString","string$1","spreadPattern","legalReference","relaxedName","identifier","readObjectLiteral","keyValuePairs","readKeyValuePairs","readArrayLiteral","expressionList","readExpressionList","globals","keywords","prefixPattern","specials","specialCall","readPrimary","readLiteral","readReference","readBracketedExpression","readMemberOrInvocation","expression","refinement","readRefinement","makePrefixSequenceMatcher","symbol","fallthrough","readExpression","matcher","prefixOperators","readLogicalOr","readTypeof","makeInfixSequenceMatcher","left","right","infixOperators","readLogicalOr$1","attributeNamePattern","onPattern","eventPattern","reservedEventNames","decoratorPattern","transitionPattern","directives","unquotedAttributeValueTextPattern","proxyEvent","whitespace","slashes","delimiterChangeToken","exclude","legalAlias","asRE","elsePattern","elsePattern$1","handlebarsBlockCodes","each","if","with","unless","indexRefPattern","keyIndexRefPattern","handlebarsBlockPattern","OPEN_COMMENT","CLOSE_COMMENT","leadingLinebreak","trailingLinebreak","stripStandalones","backOne","backTwo","lastSectionItem","isString","isComment","isSection","lastItem","trimWhitespace","leadingPattern","trailingPattern","contiguousWhitespace","preserveWhitespaceElements","leadingWhitespace$1","trailingWhitespace","leadingNewLine","trailingNewLine","closingTagPattern","tagNamePattern","validTagNameFollower","disallowedContents","li","dt","dd","rt","rp","optgroup","thead","tbody","tfoot","tr","td","th","partialDefinitionSectionPattern","STANDARD_READERS","readPartial","readUnescaped","readSection","readInterpolator","readComment","TRIPLE_READERS","readTriple","STATIC_READERS","READERS","readMustache","readHtmlComment","readElement$1","readText","PARTIAL_READERS","readPartialDefinitionSection","StandardParser","tripleDelimiters","staticDelimiters","staticTripleDelimiters","standardDelimiters","delimiters","tags","isTriple","open","close","readers","sortMustacheTags","sectionDepth","elementStack","sanitize","elements","eventAttributes","stripComments","preserveWhitespace","sanitizeElements","sanitizeEventAttributes","includeLinePositions","textOnlyMode","csp","cleanup","expr","insertExpressions","readTemplate","b","computedStrings","computed","fromComputationString","parseOptions","TEMPLATE_INSTRUCTIONS","COMPUTATION_INSTRUCTIONS","fromId","noThrow","getElementById","isParsed","getParseOptions","reduce","val","throwNoParse","addFunctions","parseFor","templateConfigurator","parseTemplate","getDynamicTemplate","_config","extendPartials","registryNames","Registry","useDefaults","configure","registry","isOwner","registries","custom","defaultKeys","isStandardKey","makeObj","isBlacklisted","order","config","configure$1","meta","contains","nextNode","lastBound","q","list","updateAnchors","description","all","res","bindName","bindChecked","makeDirty","nameAttr","xmlns$$1","updateModel$2","readKey","childData","getPartialFromRegistry","fillGaps","findParentPartial","findInstance","noRegistryFunctionReturn","findOwner","findConstructor","_Parent","hasIndexRef","getComponentConstructor","ElementConstructor","guid","counter","placeholderId","newModel","hookQueue","childQueue","userOptions","subscribe","createFragment","getElement","append","catch","logIfDebug","subs","toPairs","single","config$$1","noIntro","applyCSS","__ractive_instances__","torndown","others","rerender","dest","external","set$1","build","add$1","TypeError","badArguments","gather","uniqueCssIds","ids","HTMLElement","here","cascade","updateFromBindings","addRegistries","addOtherOptions","addRegistry","_method","extendOne","_on","_observe","resolveInstanceMembers","modifyArrays","isolated","linear","easeIn","pow","easeOut","easeInOut","navigator","appName","warn","div","methodNames","unprefixed","prefixed","makeFunction","implementation","hasFeature","mathml","xlink","xml","xmlns","ns","createElementNS","cloneNode","camel","decamel","desc","F","log","printWarning","welcome","toString$1$1","alreadyWarned","welcomeIntro","welcomeMessage","WELCOME_MESSAGE","hasGroup","intermediate","min","properties","snap","prop$1","initStars","bubleStars","arg","_Promise","PENDING","FULFILLED","REJECTED","dispatchHandlers","fulfilledHandlers","rejectedHandlers","state","makeResolver","newState","makeDispatcher","wait","reject","onFulfilled","onRejected","promise2","processResolutionHandler","handlers","forward","p1result","resolve$1","promises","processPromise","reason","TransitionManager","intros","outros","totalChildren","outroChildren","detachQueue","outrosComplete","decrementOutros","check","decrementTotal","detachNodes","detach$1","_detachNodes","ready","detachImmediate","batch","changeHook","previousBatch","transitionManager","fragments","tasks","immediateObservers","deferredObservers","ractives","flushChanges","addInstance","observer","thing","task","postRender","_batch","refPattern","splitPattern","escapeKeyPattern","unescapeKeyPattern","star","errorMessage","noAnimation","linear$1","attachHook","detachHook","detachHook$1","Query","isComponentQuery","sortByItemPosition","sortByDocumentPosition","captureGroup","KeyModel","isKey","dependant","isKeypath","hasProp","shuffleTasks","early","registerQueue","keyModels","unresolvedByKey","patternObservers","stage","specificKey","hasKey","existingMatches","loop","getKeyModel","skip","child$1","shufle","opening","closing","readNumberLiteral","entity","code","parseInt","validateCode","readNumberLiteral$1","readBooleanLiteral","token","readKeyValuePair","spread","refKey","pairs","name$$1","lastDotIndex","startPos","relaxedNames","actual","lastIndexOf","refLength","strictRefinement","getConditional","ifTrue","ifFalse","isSpread","expressions","flattenExpression","getVars","vars","stringify","hasSpread","makeSpread","stringifyPair","out","extractRefs","stringified","splitEvent","readAttribute","nearest","readAttributeValue","valueStart","startDepth","readQuotedAttributeValue","readUnquotedAttributeValue","readUnquotedAttributeValueToken","text","tokens","quoteMark","readQuotedStringToken","readAttributeOrDirective","readArguments","readProxyEvent","quote","required","spreadArgs","exprs","inside","readMustacheOfType","inTag","tag","reader","readDelimiterChange","rewind","refineExpression","referenceExpression","getReferenceExpression","triple","readAliases","alias","readAlias","readExpressionOrReference","expectedFollowers","readClosing","readElse","readElseIf","section","hasElse","block","unlessBlock","closed","expectedClose","aliasOnly","extra","endIndex","comment","removeLeadingWhitespace","removeTrailingWhitespace","previousItem","nextItem","preserveWhitespaceInsideFragment","removeLeadingWhitespaceInsideFragment","removeTrailingWhitespaceInsideFragment","isPreserveWhitespaceElement","readClosingTag","selfClosing","hasPartials","closingTag","lowerCaseName","canContain","closingTagName","readAnchorClose","disallowed","barrier","addTo","hasChildren","fromExpression","instructions","createFunction","body","createFunctionFromString","bindTo","initial","parseAsString","validate$1","existingPartials","newPartials","overwrite","wrap$1","getSuperMethod","_parent","oldSuper","getMessage","deprecated","correct","isError","deprecateOption","deprecatedOption","deprecate","extendOtherMethods","member","fnBody","tabs","minIndent","prev","Infinity","truncated","orComponent","readStyle","rule","rules","readClass","updateId","updateMultipleSelectValue","updateSelectValue","updateStringValue","updateContentEditableValue","updateRadioValue","updateValue","updateRadioName","updateCheckboxName","updateStyleAttribute","updateInlineStyle","updateClassName","updateInlineClass","type$1","updateBoolean","updateNamespacedAttribute","updateAttribute","wasSelected","valueAttribute","className","removeAttributeNS","setAttributeNS","qualified","hasAttribute","needle","enumerable","mdl$1","getComputationSignature","setterString","initialiseProperties","getAdaptors","protoAdapt","lookup","builtins","srcs","magic$$1","_subs","_eventQueue","_liveQueries","_liveComponentQueries","_children","byName","getPromise","cancel$1","nameOption","renderItem","factory","exports","module","define","amd","noConflict","output","sources","isFinite","format","registryName","interpol","enqueue","dequeue","variants","parts","_noArg","eventNames","fireEventAs","initialFire","subscribers","notifySubscribers","fullName","originalEvent","stopEvent","first","rest","arrayLike","find$1","called","resolvePromise","y","rejectPromise","tm","notifiedTotal","manager","trans","collectAllOutros","dispatch$1","which","ractive$1","sets","getOptions","easing$$1","animate$1","queries","remotes","remote","query$1","findAnchors","findAnchorsIn","anchors","idxs","unrenderChild","bubble$1","findNextNode$1","removeFromQuery$1","prepend","insertAt","@this.parent","@this.root","cmp","isParent","otherNode","compareDocumentPosition","bitmask","baseA","baseB","mutualAncestor","ancestryA","getAncestry","ancestryB","oldestA","oldestB","fragmentA","fragmentB","indexA","indexB","indexA$1","indexB$1","getParent","ancestry","ancestor","upstream","prefixKeypath","rootKeypath","rootDot","relativeKeypath","initialFragment","explicitContext","context$1","badReference","repeater","context$2","hasContextChain","crossedComponentBoundary","shouldWarn","model$2","spliceArguments","getSpliceEquivalent","balance","removeStart","removeEnd","getComparator","merge$2","compare","update$3","build$1","findModel","get$1$1","_element","resolve$2","add$2","animate$2","link$1","there","merge$1","raise","event$1","set$2","drop","unlink$1","update$2","updateModel$1","isBound","getBindingModel","getBindingPath","getBinding","ctx","setBinding","fireInsertHook","observers","silent","caller","keypaths","createObserver","isSilenced","silence","resume","wildcardIndex","_proxy","callback$1","listener","styleDefinition","cssText","filteredStyleDefinitions","trim$1","extractString","unit","transformSelector","selectorUnits","modifiers","transformed","appended","prepended","dataAttr","selectors","s4","floor","random","validate","childValue","parentIsFn","childIsFn","callDataFunction","fromProperties","primary","secondary","hasThis","exp"],"mappings":"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,IAAKC,OAAQ,IAAKC,IAAK,IAAKC,OAAQ,IAAKC,KAAM,IAAKC,IAAK,IAAKC,KAAM,IAAKC,KAAM,IAAKC,MAAO,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,KAAM,IAAKC,IAAK,IAAKC,OAAQ,IAAKC,KAAM,IAAKC,KAAM,IAAKC,MAAO,IAAKC,MAAO,IAAKC,KAAM,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,KAAM,IAAKC,KAAM,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,KAAM,IAAKC,MAAO,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,KAAM,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,KAAM,IAAKC,IAAK,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,KAAM,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,KAAM,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,KAAM,IAAKC,MAAO,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,KAAM,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,KAAM,IAAKC,IAAK,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,KAAM,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,KAAM,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,KAAM,IAAKC,MAAO,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,KAAM,IAAKC,KAAM,IAAKC,KAAM,IAAKC,MAAO,IAAKC,MAAO,IAAKC,KAAM,IAAKC,MAAO,IAAKC,MAAO,IAAKC,QAAS,IAAKC,KAAM,IAAKC,IAAK,IAAKC,MAAO,IAAKC,KAAM,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"}