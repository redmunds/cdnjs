{"version":3,"file":"ractive.min.js","sources":["ractive.js"],"sourcesContent":["/*\n\tRactive.js v0.8.0\n\tSun Oct 09 2016 20:58:50 GMT-0400 (EDT) - commit 7c01d1418d335a9a33c57929b24b8bac7c9c421a\n\n\thttp://ractivejs.org\n\thttp://twitter.com/RactiveJS\n\n\tReleased under the MIT License.\n*/\n\n\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  ((function() { var current = global.Ractive; var next = factory(); next.noConflict = function() { global.Ractive = current; return next; }; return global.Ractive = next; })());\n}(this, (function () { 'use strict';\n\nvar defaults = {\n\t// render placement:\n\tel:                     void 0,\n\tappend:\t\t\t\t    false,\n\n\t// template:\n\ttemplate:               null,\n\n\t// parse:\n\tdelimiters:             [ '{{', '}}' ],\n\ttripleDelimiters:       [ '{{{', '}}}' ],\n\tstaticDelimiters:       [ '[[', ']]' ],\n\tstaticTripleDelimiters: [ '[[[', ']]]' ],\n\tcsp: \t\t\t\t\ttrue,\n\tinterpolate:            false,\n\tpreserveWhitespace:     false,\n\tsanitize:               false,\n\tstripComments:          true,\n\n\t// data & binding:\n\tdata:                   {},\n\tcomputed:               {},\n\tmagic:                  false,\n\tmodifyArrays:           false,\n\tadapt:                  [],\n\tisolated:               false,\n\ttwoway:                 true,\n\tlazy:                   false,\n\n\t// transitions:\n\tnoIntro:                false,\n\ttransitionsEnabled:     true,\n\tcomplete:               void 0,\n\n\t// css:\n\tcss:                    null,\n\tnoCssTransform:         false\n};\n\n// These are a subset of the easing equations found at\n// https://raw.github.com/danro/easing-js - license info\n// follows:\n\n// --------------------------------------------------\n// easing.js v0.5.4\n// Generic set of easing functions with AMD support\n// https://github.com/danro/easing-js\n// This code may be freely distributed under the MIT license\n// http://danro.mit-license.org/\n// --------------------------------------------------\n// All functions adapted from Thomas Fuchs & Jeremy Kahn\n// Easing Equations (c) 2003 Robert Penner, BSD license\n// https://raw.github.com/danro/easing-js/master/LICENSE\n// --------------------------------------------------\n\n// In that library, the functions named easeIn, easeOut, and\n// easeInOut below are named easeInCubic, easeOutCubic, and\n// (you guessed it) easeInOutCubic.\n//\n// You can add additional easing functions to this list, and they\n// will be globally available.\n\n\nvar easing = {\n\tlinear: function ( pos ) { return pos; },\n\teaseIn: function ( pos ) { return Math.pow( pos, 3 ); },\n\teaseOut: function ( pos ) { return ( Math.pow( ( pos - 1 ), 3 ) + 1 ); },\n\teaseInOut: function ( pos ) {\n\t\tif ( ( pos /= 0.5 ) < 1 ) { return ( 0.5 * Math.pow( pos, 3 ) ); }\n\t\treturn ( 0.5 * ( Math.pow( ( pos - 2 ), 3 ) + 2 ) );\n\t}\n};\n\nvar legacy = null;\n\n/*global console, navigator */\n\nvar win = typeof window !== 'undefined' ? window : null;\nvar doc = win ? document : null;\n\nvar isClient = !!doc;\nvar isJsdom = ( typeof navigator !== 'undefined' && /jsDom/.test( navigator.appName ) );\nvar hasConsole = ( typeof console !== 'undefined' && typeof console.warn === 'function' && typeof console.warn.apply === 'function' );\n\nvar magic;\ntry {\n\tObject.defineProperty({}, 'test', { value: 0 });\n\tmagic = true;\n} catch ( e ) {\n\tmagic = false;\n}\n\nvar svg = doc ?\n\tdoc.implementation.hasFeature( 'http://www.w3.org/TR/SVG11/feature#BasicStructure', '1.1' ) :\n\tfalse;\n\nvar vendors = [ 'o', 'ms', 'moz', 'webkit' ];\n\nvar html   = 'http://www.w3.org/1999/xhtml';\nvar mathml = 'http://www.w3.org/1998/Math/MathML';\nvar svg$1    = 'http://www.w3.org/2000/svg';\nvar xlink  = 'http://www.w3.org/1999/xlink';\nvar xml    = 'http://www.w3.org/XML/1998/namespace';\nvar xmlns  = 'http://www.w3.org/2000/xmlns';\n\nvar namespaces = { html: html, mathml: mathml, svg: svg$1, xlink: xlink, xml: xml, xmlns: xmlns };\n\nvar createElement;\nvar matches;\nvar div;\nvar methodNames;\nvar unprefixed;\nvar prefixed;\nvar i;\nvar j;\nvar makeFunction;\n\n// Test for SVG support\nif ( !svg ) {\n\tcreateElement = function ( type, ns, extend ) {\n\t\tif ( ns && ns !== html ) {\n\t\t\tthrow 'This browser does not support namespaces other than http://www.w3.org/1999/xhtml. The most likely cause of this error is that you\\'re trying to render SVG in an older browser. See http://docs.ractivejs.org/latest/svg-and-older-browsers for more information';\n\t\t}\n\n\t\treturn extend ?\n\t\t\tdoc.createElement( type, extend ) :\n\t\t\tdoc.createElement( type );\n\t};\n} else {\n\tcreateElement = function ( type, ns, extend ) {\n\t\tif ( !ns || ns === html ) {\n\t\t\treturn extend ?\n\t\t\t\tdoc.createElement( type, extend ) :\n\t\t\t\tdoc.createElement( type );\n\t\t}\n\n\t\treturn extend ?\n\t\t\tdoc.createElementNS( ns, type, extend ) :\n\t\t\tdoc.createElementNS( ns, type );\n\t};\n}\n\nfunction createDocumentFragment () {\n\treturn doc.createDocumentFragment();\n}\n\nfunction getElement ( input ) {\n\tvar output;\n\n\tif ( !input || typeof input === 'boolean' ) { return; }\n\n\tif ( !win || !doc || !input ) {\n\t\treturn null;\n\t}\n\n\t// We already have a DOM node - no work to do. (Duck typing alert!)\n\tif ( input.nodeType ) {\n\t\treturn input;\n\t}\n\n\t// Get node from string\n\tif ( typeof input === 'string' ) {\n\t\t// try ID first\n\t\toutput = doc.getElementById( input );\n\n\t\t// then as selector, if possible\n\t\tif ( !output && doc.querySelector ) {\n\t\t\toutput = doc.querySelector( input );\n\t\t}\n\n\t\t// did it work?\n\t\tif ( output && output.nodeType ) {\n\t\t\treturn output;\n\t\t}\n\t}\n\n\t// If we've been given a collection (jQuery, Zepto etc), extract the first item\n\tif ( input[0] && input[0].nodeType ) {\n\t\treturn input[0];\n\t}\n\n\treturn null;\n}\n\nif ( !isClient ) {\n\tmatches = null;\n} else {\n\tdiv = createElement( 'div' );\n\tmethodNames = [ 'matches', 'matchesSelector' ];\n\n\tmakeFunction = function ( methodName ) {\n\t\treturn function ( node, selector ) {\n\t\t\treturn node[ methodName ]( selector );\n\t\t};\n\t};\n\n\ti = methodNames.length;\n\n\twhile ( i-- && !matches ) {\n\t\tunprefixed = methodNames[i];\n\n\t\tif ( div[ unprefixed ] ) {\n\t\t\tmatches = makeFunction( unprefixed );\n\t\t} else {\n\t\t\tj = vendors.length;\n\t\t\twhile ( j-- ) {\n\t\t\t\tprefixed = vendors[i] + unprefixed.substr( 0, 1 ).toUpperCase() + unprefixed.substring( 1 );\n\n\t\t\t\tif ( div[ prefixed ] ) {\n\t\t\t\t\tmatches = makeFunction( prefixed );\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// IE8...\n\tif ( !matches ) {\n\t\tmatches = function ( node, selector ) {\n\t\t\tvar nodes, parentNode, i;\n\n\t\t\tparentNode = node.parentNode;\n\n\t\t\tif ( !parentNode ) {\n\t\t\t\t// empty dummy <div>\n\t\t\t\tdiv.innerHTML = '';\n\n\t\t\t\tparentNode = div;\n\t\t\t\tnode = node.cloneNode();\n\n\t\t\t\tdiv.appendChild( node );\n\t\t\t}\n\n\t\t\tnodes = parentNode.querySelectorAll( selector );\n\n\t\t\ti = nodes.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tif ( nodes[i] === node ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn false;\n\t\t};\n\t}\n}\n\nfunction detachNode ( node ) {\n\tif ( node && typeof node.parentNode !== 'unknown' && node.parentNode ) {\n\t\tnode.parentNode.removeChild( node );\n\t}\n\n\treturn node;\n}\n\nfunction safeToStringValue ( value ) {\n\treturn ( value == null || !value.toString ) ? '' : '' + value;\n}\n\nfunction safeAttributeString ( string ) {\n\treturn safeToStringValue( string )\n\t\t.replace( /&/g, '&amp;' )\n\t\t.replace( /\"/g, '&quot;' )\n\t\t.replace( /'/g, '&#39;' );\n}\n\nvar camel = /(-.)/g;\nfunction camelize ( string ) {\n\treturn string.replace( camel, function ( s ) { return s.charAt( 1 ).toUpperCase(); } );\n}\n\nvar decamel = /[A-Z]/g;\nfunction decamelize ( string ) {\n\treturn string.replace( decamel, function ( s ) { return (\"-\" + (s.toLowerCase())); } );\n}\n\nvar create;\nvar defineProperty;\nvar defineProperties;\n\ntry {\n\tObject.defineProperty({}, 'test', { get: function() {}, set: function() {} });\n\n\tif ( doc ) {\n\t\tObject.defineProperty( createElement( 'div' ), 'test', { value: 0 });\n\t}\n\n\tdefineProperty = Object.defineProperty;\n} catch ( err ) {\n\t// Object.defineProperty doesn't exist, or we're in IE8 where you can\n\t// only use it with DOM objects (what were you smoking, MSFT?)\n\tdefineProperty = function ( obj, prop, desc ) {\n\t\tif ( desc.get ) obj[ prop ] = desc.get();\n\t\telse obj[ prop ] = desc.value;\n\t};\n}\n\ntry {\n\ttry {\n\t\tObject.defineProperties({}, { test: { value: 0 } });\n\t} catch ( err ) {\n\t\t// TODO how do we account for this? noMagic = true;\n\t\tthrow err;\n\t}\n\n\tif ( doc ) {\n\t\tObject.defineProperties( createElement( 'div' ), { test: { value: 0 } });\n\t}\n\n\tdefineProperties = Object.defineProperties;\n} catch ( err ) {\n\tdefineProperties = function ( obj, props ) {\n\t\tvar prop;\n\n\t\tfor ( prop in props ) {\n\t\t\tif ( props.hasOwnProperty( prop ) ) {\n\t\t\t\tdefineProperty( obj, prop, props[ prop ] );\n\t\t\t}\n\t\t}\n\t};\n}\n\ntry {\n\tObject.create( null );\n\n\tcreate = Object.create;\n} catch ( err ) {\n\t// sigh\n\tcreate = (function () {\n\t\tvar F = function () {};\n\n\t\treturn function ( proto, props ) {\n\t\t\tvar obj;\n\n\t\t\tif ( proto === null ) {\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\tF.prototype = proto;\n\t\t\tobj = new F();\n\n\t\t\tif ( props ) {\n\t\t\t\tObject.defineProperties( obj, props );\n\t\t\t}\n\n\t\t\treturn obj;\n\t\t};\n\t}());\n}\n\nfunction extend$1 ( target ) {\n\tvar sources = [], len = arguments.length - 1;\n\twhile ( len-- > 0 ) sources[ len ] = arguments[ len + 1 ];\n\n\tvar prop;\n\n\tsources.forEach( function ( source ) {\n\t\tfor ( prop in source ) {\n\t\t\tif ( hasOwn.call( source, prop ) ) {\n\t\t\t\ttarget[ prop ] = source[ prop ];\n\t\t\t}\n\t\t}\n\t});\n\n\treturn target;\n}\n\nfunction fillGaps ( target ) {\n\tvar sources = [], len = arguments.length - 1;\n\twhile ( len-- > 0 ) sources[ len ] = arguments[ len + 1 ];\n\n\tsources.forEach( function ( s ) {\n\t\tfor ( var key in s ) {\n\t\t\tif ( hasOwn.call( s, key ) && !( key in target ) ) {\n\t\t\t\ttarget[ key ] = s[ key ];\n\t\t\t}\n\t\t}\n\t});\n\n\treturn target;\n}\n\nvar hasOwn = Object.prototype.hasOwnProperty;\n\nvar toString$1$1 = Object.prototype.toString;\nvar arrayLikePattern = /^\\[object (?:Array|FileList)\\]$/;\n\n// thanks, http://perfectionkills.com/instanceof-considered-harmful-or-how-to-write-a-robust-isarray/\nfunction isArray ( thing ) {\n\treturn toString$1$1.call( thing ) === '[object Array]';\n}\n\n\n\nfunction isEqual ( a, b ) {\n\tif ( a === null && b === null ) {\n\t\treturn true;\n\t}\n\n\tif ( typeof a === 'object' || typeof b === 'object' ) {\n\t\treturn false;\n\t}\n\n\treturn a === b;\n}\n\n// http://stackoverflow.com/questions/18082/validate-numbers-in-javascript-isnumeric\nfunction isNumeric ( thing ) {\n\treturn !isNaN( parseFloat( thing ) ) && isFinite( thing );\n}\n\nfunction isObject ( thing ) {\n\treturn ( thing && toString$1$1.call( thing ) === '[object Object]' );\n}\n\nvar noop = function () {};\n\n/* global console */\nvar alreadyWarned = {};\nvar log;\nvar printWarning;\nvar welcome;\n\nif ( hasConsole ) {\n\tvar welcomeIntro = [\n\t\t(\"%cRactive.js %c0.8.0 %cin debug mode, %cmore...\"),\n\t\t'color: rgb(114, 157, 52); font-weight: normal;',\n\t\t'color: rgb(85, 85, 85); font-weight: normal;',\n\t\t'color: rgb(85, 85, 85); font-weight: normal;',\n\t\t'color: rgb(82, 140, 224); font-weight: normal; text-decoration: underline;'\n\t];\n\tvar welcomeMessage = \"You're running Ractive 0.8.0 in debug mode - messages will be printed to the console to help you fix problems and optimise your application.\\n\\nTo disable debug mode, add this line at the start of your app:\\n  Ractive.DEBUG = false;\\n\\nTo disable debug mode when your app is minified, add this snippet:\\n  Ractive.DEBUG = /unminified/.test(function(){/*unminified*/});\\n\\nGet help and support:\\n  http://docs.ractivejs.org\\n  http://stackoverflow.com/questions/tagged/ractivejs\\n  http://groups.google.com/forum/#!forum/ractive-js\\n  http://twitter.com/ractivejs\\n\\nFound a bug? Raise an issue:\\n  https://github.com/ractivejs/ractive/issues\\n\\n\";\n\n\twelcome = function () {\n\t\tvar hasGroup = !!console.groupCollapsed;\n\t\tconsole[ hasGroup ? 'groupCollapsed' : 'log' ].apply( console, welcomeIntro );\n\t\tconsole.log( welcomeMessage );\n\t\tif ( hasGroup ) {\n\t\t\tconsole.groupEnd( welcomeIntro );\n\t\t}\n\n\t\twelcome = noop;\n\t};\n\n\tprintWarning = function ( message, args ) {\n\t\twelcome();\n\n\t\t// extract information about the instance this message pertains to, if applicable\n\t\tif ( typeof args[ args.length - 1 ] === 'object' ) {\n\t\t\tvar options = args.pop();\n\t\t\tvar ractive = options ? options.ractive : null;\n\n\t\t\tif ( ractive ) {\n\t\t\t\t// if this is an instance of a component that we know the name of, add\n\t\t\t\t// it to the message\n\t\t\t\tvar name;\n\t\t\t\tif ( ractive.component && ( name = ractive.component.name ) ) {\n\t\t\t\t\tmessage = \"<\" + name + \"> \" + message;\n\t\t\t\t}\n\n\t\t\t\tvar node;\n\t\t\t\tif ( node = ( options.node || ( ractive.fragment && ractive.fragment.rendered && ractive.find( '*' ) ) ) ) {\n\t\t\t\t\targs.push( node );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconsole.warn.apply( console, [ '%cRactive.js: %c' + message, 'color: rgb(114, 157, 52);', 'color: rgb(85, 85, 85);' ].concat( args ) );\n\t};\n\n\tlog = function () {\n\t\tconsole.log.apply( console, arguments );\n\t};\n} else {\n\tprintWarning = log = welcome = noop;\n}\n\nfunction format ( message, args ) {\n\treturn message.replace( /%s/g, function () { return args.shift(); } );\n}\n\nfunction fatal ( message ) {\n\tvar args = [], len = arguments.length - 1;\n\twhile ( len-- > 0 ) args[ len ] = arguments[ len + 1 ];\n\n\tmessage = format( message, args );\n\tthrow new Error( message );\n}\n\nfunction logIfDebug () {\n\tif ( Ractive.DEBUG ) {\n\t\tlog.apply( null, arguments );\n\t}\n}\n\nfunction warn ( message ) {\n\tvar args = [], len = arguments.length - 1;\n\twhile ( len-- > 0 ) args[ len ] = arguments[ len + 1 ];\n\n\tmessage = format( message, args );\n\tprintWarning( message, args );\n}\n\nfunction warnOnce ( message ) {\n\tvar args = [], len = arguments.length - 1;\n\twhile ( len-- > 0 ) args[ len ] = arguments[ len + 1 ];\n\n\tmessage = format( message, args );\n\n\tif ( alreadyWarned[ message ] ) {\n\t\treturn;\n\t}\n\n\talreadyWarned[ message ] = true;\n\tprintWarning( message, args );\n}\n\nfunction warnIfDebug () {\n\tif ( Ractive.DEBUG ) {\n\t\twarn.apply( null, arguments );\n\t}\n}\n\nfunction warnOnceIfDebug () {\n\tif ( Ractive.DEBUG ) {\n\t\twarnOnce.apply( null, arguments );\n\t}\n}\n\n// Error messages that are used (or could be) in multiple places\nvar badArguments = 'Bad arguments';\nvar noRegistryFunctionReturn = 'A function was specified for \"%s\" %s, but no %s was returned';\nvar missingPlugin = function ( name, type ) { return (\"Missing \\\"\" + name + \"\\\" \" + type + \" plugin. You may need to download a plugin via http://docs.ractivejs.org/latest/plugins#\" + type + \"s\"); };\n\nfunction findInViewHierarchy ( registryName, ractive, name ) {\n\tvar instance = findInstance( registryName, ractive, name );\n\treturn instance ? instance[ registryName ][ name ] : null;\n}\n\nfunction findInstance ( registryName, ractive, name ) {\n\twhile ( ractive ) {\n\t\tif ( name in ractive[ registryName ] ) {\n\t\t\treturn ractive;\n\t\t}\n\n\t\tif ( ractive.isolated ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tractive = ractive.parent;\n\t}\n}\n\nfunction interpolate ( from, to, ractive, type ) {\n\tif ( from === to ) return null;\n\n\tif ( type ) {\n\t\tvar interpol = findInViewHierarchy( 'interpolators', ractive, type );\n\t\tif ( interpol ) return interpol( from, to ) || null;\n\n\t\tfatal( missingPlugin( type, 'interpolator' ) );\n\t}\n\n\treturn interpolators.number( from, to ) ||\n\t       interpolators.array( from, to ) ||\n\t       interpolators.object( from, to ) ||\n\t       null;\n}\n\nfunction snap ( to ) {\n\treturn function () { return to; };\n}\n\nvar interpolators = {\n\tnumber: function ( from, to ) {\n\t\tvar delta;\n\n\t\tif ( !isNumeric( from ) || !isNumeric( to ) ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tfrom = +from;\n\t\tto = +to;\n\n\t\tdelta = to - from;\n\n\t\tif ( !delta ) {\n\t\t\treturn function () { return from; };\n\t\t}\n\n\t\treturn function ( t ) {\n\t\t\treturn from + ( t * delta );\n\t\t};\n\t},\n\n\tarray: function ( from, to ) {\n\t\tvar intermediate, interpolators, len, i;\n\n\t\tif ( !isArray( from ) || !isArray( to ) ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tintermediate = [];\n\t\tinterpolators = [];\n\n\t\ti = len = Math.min( from.length, to.length );\n\t\twhile ( i-- ) {\n\t\t\tinterpolators[i] = interpolate( from[i], to[i] );\n\t\t}\n\n\t\t// surplus values - don't interpolate, but don't exclude them either\n\t\tfor ( i=len; i<from.length; i+=1 ) {\n\t\t\tintermediate[i] = from[i];\n\t\t}\n\n\t\tfor ( i=len; i<to.length; i+=1 ) {\n\t\t\tintermediate[i] = to[i];\n\t\t}\n\n\t\treturn function ( t ) {\n\t\t\tvar i = len;\n\n\t\t\twhile ( i-- ) {\n\t\t\t\tintermediate[i] = interpolators[i]( t );\n\t\t\t}\n\n\t\t\treturn intermediate;\n\t\t};\n\t},\n\n\tobject: function ( from, to ) {\n\t\tvar properties, len, interpolators, intermediate, prop;\n\n\t\tif ( !isObject( from ) || !isObject( to ) ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tproperties = [];\n\t\tintermediate = {};\n\t\tinterpolators = {};\n\n\t\tfor ( prop in from ) {\n\t\t\tif ( hasOwn.call( from, prop ) ) {\n\t\t\t\tif ( hasOwn.call( to, prop ) ) {\n\t\t\t\t\tproperties.push( prop );\n\t\t\t\t\tinterpolators[ prop ] = interpolate( from[ prop ], to[ prop ] ) || snap( to[ prop ] );\n\t\t\t\t}\n\n\t\t\t\telse {\n\t\t\t\t\tintermediate[ prop ] = from[ prop ];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor ( prop in to ) {\n\t\t\tif ( hasOwn.call( to, prop ) && !hasOwn.call( from, prop ) ) {\n\t\t\t\tintermediate[ prop ] = to[ prop ];\n\t\t\t}\n\t\t}\n\n\t\tlen = properties.length;\n\n\t\treturn function ( t ) {\n\t\t\tvar i = len, prop;\n\n\t\t\twhile ( i-- ) {\n\t\t\t\tprop = properties[i];\n\n\t\t\t\tintermediate[ prop ] = interpolators[ prop ]( t );\n\t\t\t}\n\n\t\t\treturn intermediate;\n\t\t};\n\t}\n};\n\n// TODO: deprecate in future release\nvar deprecations = {\n\tconstruct: {\n\t\tdeprecated: 'beforeInit',\n\t\treplacement: 'onconstruct'\n\t},\n\trender: {\n\t\tdeprecated: 'init',\n\t\tmessage: 'The \"init\" method has been deprecated ' +\n\t\t\t'and will likely be removed in a future release. ' +\n\t\t\t'You can either use the \"oninit\" method which will fire ' +\n\t\t\t'only once prior to, and regardless of, any eventual ractive ' +\n\t\t\t'instance being rendered, or if you need to access the ' +\n\t\t\t'rendered DOM, use \"onrender\" instead. ' +\n\t\t\t'See http://docs.ractivejs.org/latest/migrating for more information.'\n\t},\n\tcomplete: {\n\t\tdeprecated: 'complete',\n\t\treplacement: 'oncomplete'\n\t}\n};\n\nvar Hook = function Hook ( event ) {\n\tthis.event = event;\n\tthis.method = 'on' + event;\n\tthis.deprecate = deprecations[ event ];\n};\n\nHook.prototype.call = function call ( method, ractive, arg ) {\n\tif ( ractive[ method ] ) {\n\t\targ ? ractive[ method ]( arg ) : ractive[ method ]();\n\t\treturn true;\n\t}\n};\n\nHook.prototype.fire = function fire ( ractive, arg ) {\n\tthis.call( this.method, ractive, arg );\n\n\t// handle deprecations\n\tif ( !ractive[ this.method ] && this.deprecate && this.call( this.deprecate.deprecated, ractive, arg ) ) {\n\t\tif ( this.deprecate.message ) {\n\t\t\twarnIfDebug( this.deprecate.message );\n\t\t} else {\n\t\t\twarnIfDebug( 'The method \"%s\" has been deprecated in favor of \"%s\" and will likely be removed in a future release. See http://docs.ractivejs.org/latest/migrating for more information.', this.deprecate.deprecated, this.deprecate.replacement );\n\t\t}\n\t}\n\n\t// TODO should probably use internal method, in case ractive.fire was overwritten\n\targ ? ractive.fire( this.event, arg ) : ractive.fire( this.event );\n};\n\nfunction addToArray ( array, value ) {\n\tvar index = array.indexOf( value );\n\n\tif ( index === -1 ) {\n\t\tarray.push( value );\n\t}\n}\n\nfunction arrayContains ( array, value ) {\n\tfor ( var i = 0, c = array.length; i < c; i++ ) {\n\t\tif ( array[i] == value ) {\n\t\t\treturn true;\n\t\t}\n\t}\n\n\treturn false;\n}\n\nfunction arrayContentsMatch ( a, b ) {\n\tvar i;\n\n\tif ( !isArray( a ) || !isArray( b ) ) {\n\t\treturn false;\n\t}\n\n\tif ( a.length !== b.length ) {\n\t\treturn false;\n\t}\n\n\ti = a.length;\n\twhile ( i-- ) {\n\t\tif ( a[i] !== b[i] ) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn true;\n}\n\nfunction ensureArray ( x ) {\n\tif ( typeof x === 'string' ) {\n\t\treturn [ x ];\n\t}\n\n\tif ( x === undefined ) {\n\t\treturn [];\n\t}\n\n\treturn x;\n}\n\nfunction lastItem ( array ) {\n\treturn array[ array.length - 1 ];\n}\n\nfunction removeFromArray ( array, member ) {\n\tif ( !array ) {\n\t\treturn;\n\t}\n\n\tvar index = array.indexOf( member );\n\n\tif ( index !== -1 ) {\n\t\tarray.splice( index, 1 );\n\t}\n}\n\nfunction toArray ( arrayLike ) {\n\tvar array = [], i = arrayLike.length;\n\twhile ( i-- ) {\n\t\tarray[i] = arrayLike[i];\n\t}\n\n\treturn array;\n}\n\nvar _Promise;\nvar PENDING = {};\nvar FULFILLED = {};\nvar REJECTED = {};\n\nif ( typeof Promise === 'function' ) {\n\t// use native Promise\n\t_Promise = Promise;\n} else {\n\t_Promise = function ( callback ) {\n\t\tvar fulfilledHandlers = [],\n\t\t\trejectedHandlers = [],\n\t\t\tstate = PENDING,\n\n\t\t\tresult,\n\t\t\tdispatchHandlers,\n\t\t\tmakeResolver,\n\t\t\tfulfil,\n\t\t\treject,\n\n\t\t\tpromise;\n\n\t\tmakeResolver = function ( newState ) {\n\t\t\treturn function ( value ) {\n\t\t\t\tif ( state !== PENDING ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tresult = value;\n\t\t\t\tstate = newState;\n\n\t\t\t\tdispatchHandlers = makeDispatcher( ( state === FULFILLED ? fulfilledHandlers : rejectedHandlers ), result );\n\n\t\t\t\t// dispatch onFulfilled and onRejected handlers asynchronously\n\t\t\t\twait( dispatchHandlers );\n\t\t\t};\n\t\t};\n\n\t\tfulfil = makeResolver( FULFILLED );\n\t\treject = makeResolver( REJECTED );\n\n\t\ttry {\n\t\t\tcallback( fulfil, reject );\n\t\t} catch ( err ) {\n\t\t\treject( err );\n\t\t}\n\n\t\tpromise = {\n\t\t\t// `then()` returns a Promise - 2.2.7\n\t\t\tthen: function ( onFulfilled, onRejected ) {\n\t\t\t\tvar promise2 = new _Promise( function ( fulfil, reject ) {\n\n\t\t\t\t\tvar processResolutionHandler = function ( handler, handlers, forward ) {\n\n\t\t\t\t\t\t// 2.2.1.1\n\t\t\t\t\t\tif ( typeof handler === 'function' ) {\n\t\t\t\t\t\t\thandlers.push( function ( p1result ) {\n\t\t\t\t\t\t\t\tvar x;\n\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\tx = handler( p1result );\n\t\t\t\t\t\t\t\t\tresolve$1( promise2, x, fulfil, reject );\n\t\t\t\t\t\t\t\t} catch ( err ) {\n\t\t\t\t\t\t\t\t\treject( err );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Forward the result of promise1 to promise2, if resolution handlers\n\t\t\t\t\t\t\t// are not given\n\t\t\t\t\t\t\thandlers.push( forward );\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\n\t\t\t\t\t// 2.2\n\t\t\t\t\tprocessResolutionHandler( onFulfilled, fulfilledHandlers, fulfil );\n\t\t\t\t\tprocessResolutionHandler( onRejected, rejectedHandlers, reject );\n\n\t\t\t\t\tif ( state !== PENDING ) {\n\t\t\t\t\t\t// If the promise has resolved already, dispatch the appropriate handlers asynchronously\n\t\t\t\t\t\twait( dispatchHandlers );\n\t\t\t\t\t}\n\n\t\t\t\t});\n\n\t\t\t\treturn promise2;\n\t\t\t}\n\t\t};\n\n\t\tpromise[ 'catch' ] = function ( onRejected ) {\n\t\t\treturn this.then( null, onRejected );\n\t\t};\n\n\t\treturn promise;\n\t};\n\n\t_Promise.all = function ( promises ) {\n\t\treturn new _Promise( function ( fulfil, reject ) {\n\t\t\tvar result = [], pending, i, processPromise;\n\n\t\t\tif ( !promises.length ) {\n\t\t\t\tfulfil( result );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tprocessPromise = function ( promise, i ) {\n\t\t\t\tif ( promise && typeof promise.then === 'function' ) {\n\t\t\t\t\tpromise.then( function ( value ) {\n\t\t\t\t\t\tresult[i] = value;\n\t\t\t\t\t\t--pending || fulfil( result );\n\t\t\t\t\t}, reject );\n\t\t\t\t}\n\n\t\t\t\telse {\n\t\t\t\t\tresult[i] = promise;\n\t\t\t\t\t--pending || fulfil( result );\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tpending = i = promises.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tprocessPromise( promises[i], i );\n\t\t\t}\n\t\t});\n\t};\n\n\t_Promise.resolve = function ( value ) {\n\t\treturn new _Promise( function ( fulfil ) {\n\t\t\tfulfil( value );\n\t\t});\n\t};\n\n\t_Promise.reject = function ( reason ) {\n\t\treturn new _Promise( function ( fulfil, reject ) {\n\t\t\treject( reason );\n\t\t});\n\t};\n}\n\nvar Promise$1 = _Promise;\n\n// TODO use MutationObservers or something to simulate setImmediate\nfunction wait ( callback ) {\n\tsetTimeout( callback, 0 );\n}\n\nfunction makeDispatcher ( handlers, result ) {\n\treturn function () {\n\t\tvar handler;\n\n\t\twhile ( handler = handlers.shift() ) {\n\t\t\thandler( result );\n\t\t}\n\t};\n}\n\nfunction resolve$1 ( promise, x, fulfil, reject ) {\n\t// Promise Resolution Procedure\n\tvar then;\n\n\t// 2.3.1\n\tif ( x === promise ) {\n\t\tthrow new TypeError( 'A promise\\'s fulfillment handler cannot return the same promise' );\n\t}\n\n\t// 2.3.2\n\tif ( x instanceof _Promise ) {\n\t\tx.then( fulfil, reject );\n\t}\n\n\t// 2.3.3\n\telse if ( x && ( typeof x === 'object' || typeof x === 'function' ) ) {\n\t\ttry {\n\t\t\tthen = x.then; // 2.3.3.1\n\t\t} catch ( e ) {\n\t\t\treject( e ); // 2.3.3.2\n\t\t\treturn;\n\t\t}\n\n\t\t// 2.3.3.3\n\t\tif ( typeof then === 'function' ) {\n\t\t\tvar called, resolvePromise, rejectPromise;\n\n\t\t\tresolvePromise = function ( y ) {\n\t\t\t\tif ( called ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tcalled = true;\n\t\t\t\tresolve$1( promise, y, fulfil, reject );\n\t\t\t};\n\n\t\t\trejectPromise = function ( r ) {\n\t\t\t\tif ( called ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tcalled = true;\n\t\t\t\treject( r );\n\t\t\t};\n\n\t\t\ttry {\n\t\t\t\tthen.call( x, resolvePromise, rejectPromise );\n\t\t\t} catch ( e ) {\n\t\t\t\tif ( !called ) { // 2.3.3.3.4.1\n\t\t\t\t\treject( e ); // 2.3.3.3.4.2\n\t\t\t\t\tcalled = true;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\telse {\n\t\t\tfulfil( x );\n\t\t}\n\t}\n\n\telse {\n\t\tfulfil( x );\n\t}\n}\n\nvar TransitionManager = function TransitionManager ( callback, parent ) {\n\tthis.callback = callback;\n\tthis.parent = parent;\n\n\tthis.intros = [];\n\tthis.outros = [];\n\n\tthis.children = [];\n\tthis.totalChildren = this.outroChildren = 0;\n\n\tthis.detachQueue = [];\n\tthis.outrosComplete = false;\n\n\tif ( parent ) {\n\t\tparent.addChild( this );\n\t}\n};\n\nTransitionManager.prototype.add = function add ( transition ) {\n\tvar list = transition.isIntro ? this.intros : this.outros;\n\tlist.push( transition );\n};\n\nTransitionManager.prototype.addChild = function addChild ( child ) {\n\tthis.children.push( child );\n\n\tthis.totalChildren += 1;\n\tthis.outroChildren += 1;\n};\n\nTransitionManager.prototype.decrementOutros = function decrementOutros () {\n\tthis.outroChildren -= 1;\n\tcheck( this );\n};\n\nTransitionManager.prototype.decrementTotal = function decrementTotal () {\n\tthis.totalChildren -= 1;\n\tcheck( this );\n};\n\nTransitionManager.prototype.detachNodes = function detachNodes () {\n\tthis.detachQueue.forEach( detach$1 );\n\tthis.children.forEach( _detachNodes );\n};\n\nTransitionManager.prototype.ready = function ready () {\n\tdetachImmediate( this );\n};\n\nTransitionManager.prototype.remove = function remove ( transition ) {\n\tvar list = transition.isIntro ? this.intros : this.outros;\n\tremoveFromArray( list, transition );\n\tcheck( this );\n};\n\nTransitionManager.prototype.start = function start () {\n\tthis.children.forEach( function ( c ) { return c.start(); } );\n\tthis.intros.concat( this.outros ).forEach( function ( t ) { return t.start(); } );\n\tthis.ready = true;\n\tcheck( this );\n};\n\nfunction detach$1 ( element ) {\n\telement.detach();\n}\n\nfunction _detachNodes ( tm ) { // _ to avoid transpiler quirk\n\ttm.detachNodes();\n}\n\nfunction check ( tm ) {\n\tif ( !tm.ready || tm.outros.length || tm.outroChildren ) return;\n\n\t// If all outros are complete, and we haven't already done this,\n\t// we notify the parent if there is one, otherwise\n\t// start detaching nodes\n\tif ( !tm.outrosComplete ) {\n\t\ttm.outrosComplete = true;\n\n\t\tif ( tm.parent && !tm.parent.outrosComplete ) {\n\t\t\ttm.parent.decrementOutros( tm );\n\t\t} else {\n\t\t\ttm.detachNodes();\n\t\t}\n\t}\n\n\t// Once everything is done, we can notify parent transition\n\t// manager and call the callback\n\tif ( !tm.intros.length && !tm.totalChildren ) {\n\t\tif ( typeof tm.callback === 'function' ) {\n\t\t\ttm.callback();\n\t\t}\n\n\t\tif ( tm.parent && !tm.notifiedTotal ) {\n\t\t\ttm.notifiedTotal = true;\n\t\t\ttm.parent.decrementTotal();\n\t\t}\n\t}\n}\n\n// check through the detach queue to see if a node is up or downstream from a\n// transition and if not, go ahead and detach it\nfunction detachImmediate ( manager ) {\n\tvar queue = manager.detachQueue;\n\tvar outros = collectAllOutros( manager );\n\n\tvar i = queue.length, j = 0, node, trans;\n\tstart: while ( i-- ) {\n\t\tnode = queue[i].node;\n\t\tj = outros.length;\n\t\twhile ( j-- ) {\n\t\t\ttrans = outros[j].element.node;\n\t\t\t// check to see if the node is, contains, or is contained by the transitioning node\n\t\t\tif ( trans === node || trans.contains( node ) || node.contains( trans ) ) continue start;\n\t\t}\n\n\t\t// no match, we can drop it\n\t\tqueue[i].detach();\n\t\tqueue.splice( i, 1 );\n\t}\n}\n\nfunction collectAllOutros ( manager, list ) {\n\tif ( !list ) {\n\t\tlist = [];\n\t\tvar parent = manager;\n\t\twhile ( parent.parent ) parent = parent.parent;\n\t\treturn collectAllOutros( parent, list );\n\t} else {\n\t\tvar i = manager.children.length;\n\t\twhile ( i-- ) {\n\t\t\tlist = collectAllOutros( manager.children[i], list );\n\t\t}\n\t\tlist = list.concat( manager.outros );\n\t\treturn list;\n\t}\n}\n\nvar changeHook = new Hook( 'change' );\n\nvar batch;\n\nvar runloop = {\n\tstart: function ( instance, returnPromise ) {\n\t\tvar promise, fulfilPromise;\n\n\t\tif ( returnPromise ) {\n\t\t\tpromise = new Promise$1( function ( f ) { return ( fulfilPromise = f ); } );\n\t\t}\n\n\t\tbatch = {\n\t\t\tpreviousBatch: batch,\n\t\t\ttransitionManager: new TransitionManager( fulfilPromise, batch && batch.transitionManager ),\n\t\t\tfragments: [],\n\t\t\ttasks: [],\n\t\t\timmediateObservers: [],\n\t\t\tdeferredObservers: [],\n\t\t\tractives: [],\n\t\t\tinstance: instance\n\t\t};\n\n\t\treturn promise;\n\t},\n\n\tend: function () {\n\t\tflushChanges();\n\n\t\tif ( !batch.previousBatch ) batch.transitionManager.start();\n\n\t\tbatch = batch.previousBatch;\n\t},\n\n\taddFragment: function ( fragment ) {\n\t\taddToArray( batch.fragments, fragment );\n\t},\n\n\t// TODO: come up with a better way to handle fragments that trigger their own update\n\taddFragmentToRoot: function ( fragment ) {\n\t\tif ( !batch ) return;\n\n\t\tvar b = batch;\n\t\twhile ( b.previousBatch ) {\n\t\t\tb = b.previousBatch;\n\t\t}\n\n\t\taddToArray( b.fragments, fragment );\n\t},\n\n\taddInstance: function ( instance ) {\n\t\tif ( batch ) addToArray( batch.ractives, instance );\n\t},\n\n\taddObserver: function ( observer, defer ) {\n\t\taddToArray( defer ? batch.deferredObservers : batch.immediateObservers, observer );\n\t},\n\n\tregisterTransition: function ( transition ) {\n\t\ttransition._manager = batch.transitionManager;\n\t\tbatch.transitionManager.add( transition );\n\t},\n\n\t// synchronise node detachments with transition ends\n\tdetachWhenReady: function ( thing ) {\n\t\tbatch.transitionManager.detachQueue.push( thing );\n\t},\n\n\tscheduleTask: function ( task, postRender ) {\n\t\tvar _batch;\n\n\t\tif ( !batch ) {\n\t\t\ttask();\n\t\t} else {\n\t\t\t_batch = batch;\n\t\t\twhile ( postRender && _batch.previousBatch ) {\n\t\t\t\t// this can't happen until the DOM has been fully updated\n\t\t\t\t// otherwise in some situations (with components inside elements)\n\t\t\t\t// transitions and decorators will initialise prematurely\n\t\t\t\t_batch = _batch.previousBatch;\n\t\t\t}\n\n\t\t\t_batch.tasks.push( task );\n\t\t}\n\t}\n};\n\nfunction dispatch$1 ( observer ) {\n\tobserver.dispatch();\n}\n\nfunction flushChanges () {\n\tvar which = batch.immediateObservers;\n\tbatch.immediateObservers = [];\n\twhich.forEach( dispatch$1 );\n\n\t// Now that changes have been fully propagated, we can update the DOM\n\t// and complete other tasks\n\tvar i = batch.fragments.length;\n\tvar fragment;\n\n\twhich = batch.fragments;\n\tbatch.fragments = [];\n\tvar ractives = batch.ractives;\n\tbatch.ractives = [];\n\n\twhile ( i-- ) {\n\t\tfragment = which[i];\n\n\t\t// TODO deprecate this. It's annoying and serves no useful function\n\t\tvar ractive = fragment.ractive;\n\t\tchangeHook.fire( ractive, ractive.viewmodel.changes );\n\t\tractive.viewmodel.changes = {};\n\t\tremoveFromArray( ractives, ractive );\n\n\t\tfragment.update();\n\t}\n\n\ti = ractives.length;\n\twhile ( i-- ) {\n\t\tvar ractive$1 = ractives[i];\n\t\tchangeHook.fire( ractive$1, ractive$1.viewmodel.changes );\n\t\tractive$1.viewmodel.changes = {};\n\t}\n\n\tbatch.transitionManager.ready();\n\n\twhich = batch.deferredObservers;\n\tbatch.deferredObservers = [];\n\twhich.forEach( dispatch$1 );\n\n\tvar tasks = batch.tasks;\n\tbatch.tasks = [];\n\n\tfor ( i = 0; i < tasks.length; i += 1 ) {\n\t\ttasks[i]();\n\t}\n\n\t// If updating the view caused some model blowback - e.g. a triple\n\t// containing <option> elements caused the binding on the <select>\n\t// to update - then we start over\n\tif ( batch.fragments.length || batch.immediateObservers.length || batch.deferredObservers.length || batch.ractives.length ) return flushChanges();\n}\n\nvar refPattern = /\\[\\s*(\\*|[0-9]|[1-9][0-9]+)\\s*\\]/g;\nvar splitPattern = /([^\\\\](?:\\\\\\\\)*)\\./;\nvar escapeKeyPattern = /\\\\|\\./g;\nvar unescapeKeyPattern = /((?:\\\\)+)\\1|\\\\(\\.)/g;\n\nfunction escapeKey ( key ) {\n\tif ( typeof key === 'string' ) {\n\t\treturn key.replace( escapeKeyPattern, '\\\\$&' );\n\t}\n\n\treturn key;\n}\n\nfunction normalise ( ref ) {\n\treturn ref ? ref.replace( refPattern, '.$1' ) : '';\n}\n\nfunction splitKeypath ( keypath ) {\n\tvar result = [],\n\t\tmatch;\n\n\tkeypath = normalise( keypath );\n\n\twhile ( match = splitPattern.exec( keypath ) ) {\n\t\tvar index = match.index + match[1].length;\n\t\tresult.push( keypath.substr( 0, index ) );\n\t\tkeypath = keypath.substr( index + 1 );\n\t}\n\n\tresult.push(keypath);\n\n\treturn result;\n}\n\nfunction unescapeKey ( key ) {\n\tif ( typeof key === 'string' ) {\n\t\treturn key.replace( unescapeKeyPattern, '$1$2' );\n\t}\n\n\treturn key;\n}\n\nfunction bind$1$1 ( fn, context ) {\n\tif ( !/this/.test( fn.toString() ) ) return fn;\n\n\tvar bound = fn.bind( context );\n\tfor ( var prop in fn ) bound[ prop ] = fn[ prop ];\n\n\treturn bound;\n}\n\nfunction set$1 ( ractive, pairs ) {\n\tvar promise = runloop.start( ractive, true );\n\n\tvar i = pairs.length;\n\twhile ( i-- ) {\n\t\tvar ref = pairs[i], model = ref[0], value = ref[1];\n\t\tif ( typeof value === 'function' ) value = bind$1$1( value, ractive );\n\t\tmodel.set( value );\n\t}\n\n\trunloop.end();\n\n\treturn promise;\n}\n\nvar star = /\\*/;\nfunction gather ( ractive, keypath, base ) {\n\tif ( base === void 0 ) base = ractive.viewmodel;\n\n\tif ( star.test( keypath ) ) {\n\t\treturn base.findMatches( splitKeypath( keypath ) );\n\t} else {\n\t\treturn [ base.joinAll( splitKeypath( keypath ) ) ];\n\t}\n}\n\nfunction build ( ractive, keypath, value ) {\n\tvar sets = [];\n\n\t// set multiple keypaths in one go\n\tif ( isObject( keypath ) ) {\n\t\tvar loop = function ( k ) {\n\t\t\tif ( keypath.hasOwnProperty( k ) ) {\n\t\t\t\tsets.push.apply( sets, gather( ractive, k ).map( function ( m ) { return [ m, keypath[k] ]; } ) );\n\t\t\t}\n\t\t};\n\n\t\tfor ( var k in keypath ) loop( k );\n\n\t}\n\t// set a single keypath\n\telse {\n\t\tsets.push.apply( sets, gather( ractive, keypath ).map( function ( m ) { return [ m, value ]; } ) );\n\t}\n\n\treturn sets;\n}\n\nvar errorMessage = 'Cannot add to a non-numeric value';\n\nfunction add$1 ( ractive, keypath, d ) {\n\tif ( typeof keypath !== 'string' || !isNumeric( d ) ) {\n\t\tthrow new Error( 'Bad arguments' );\n\t}\n\n\tvar sets = build( ractive, keypath, d );\n\n\treturn set$1( ractive, sets.map( function ( pair ) {\n\t\tvar model = pair[0], add = pair[1], value = model.get();\n\t\tif ( !isNumeric( add ) || !isNumeric( value ) ) throw new Error( errorMessage );\n\t\treturn [ model, value + add ];\n\t}));\n}\n\nfunction Ractive$add ( keypath, d ) {\n\treturn add$1( this, keypath, ( d === undefined ? 1 : +d ) );\n}\n\nvar noAnimation = Promise$1.resolve();\ndefineProperty( noAnimation, 'stop', { value: noop });\n\nvar linear = easing.linear;\n\nfunction getOptions ( options, instance ) {\n\toptions = options || {};\n\n\tvar easing$$1;\n\tif ( options.easing ) {\n\t\teasing$$1 = typeof options.easing === 'function' ?\n\t\t\toptions.easing :\n\t\t\tinstance.easing[ options.easing ];\n\t}\n\n\treturn {\n\t\teasing: easing$$1 || linear,\n\t\tduration: 'duration' in options ? options.duration : 400,\n\t\tcomplete: options.complete || noop,\n\t\tstep: options.step || noop\n\t};\n}\n\nfunction animate$1 ( ractive, model, to, options ) {\n\toptions = getOptions( options, ractive );\n\tvar from = model.get();\n\n\t// don't bother animating values that stay the same\n\tif ( isEqual( from, to ) ) {\n\t\toptions.complete( options.to );\n\t\treturn noAnimation; // TODO should this have .then and .catch methods?\n\t}\n\n\tvar interpolator = interpolate( from, to, ractive, options.interpolator );\n\n\t// if we can't interpolate the value, set it immediately\n\tif ( !interpolator ) {\n\t\trunloop.start();\n\t\tmodel.set( to );\n\t\trunloop.end();\n\n\t\treturn noAnimation;\n\t}\n\n\treturn model.animate( from, to, options, interpolator );\n}\n\nfunction Ractive$animate ( keypath, to, options ) {\n\tif ( typeof keypath === 'object' ) {\n\t\tvar keys = Object.keys( keypath );\n\n\t\tthrow new Error( (\"ractive.animate(...) no longer supports objects. Instead of ractive.animate({\\n  \" + (keys.map( function ( key ) { return (\"'\" + key + \"': \" + (keypath[ key ])); } ).join( '\\n  ' )) + \"\\n}, {...}), do\\n\\n\" + (keys.map( function ( key ) { return (\"ractive.animate('\" + key + \"', \" + (keypath[ key ]) + \", {...});\"); } ).join( '\\n' )) + \"\\n\") );\n\t}\n\n\n\treturn animate$1( this, this.viewmodel.joinAll( splitKeypath( keypath ) ), to, options );\n}\n\nvar detachHook = new Hook( 'detach' );\n\nfunction Ractive$detach () {\n\tif ( this.isDetached ) {\n\t\treturn this.el;\n\t}\n\n\tif ( this.el ) {\n\t\tremoveFromArray( this.el.__ractive_instances__, this );\n\t}\n\n\tthis.el = this.fragment.detach();\n\tthis.isDetached = true;\n\n\tdetachHook.fire( this );\n\treturn this.el;\n}\n\nfunction Ractive$find ( selector ) {\n\tif ( !this.el ) throw new Error( (\"Cannot call ractive.find('\" + selector + \"') unless instance is rendered to the DOM\") );\n\n\treturn this.fragment.find( selector );\n}\n\nfunction sortByDocumentPosition ( node, otherNode ) {\n\tif ( node.compareDocumentPosition ) {\n\t\tvar bitmask = node.compareDocumentPosition( otherNode );\n\t\treturn ( bitmask & 2 ) ? 1 : -1;\n\t}\n\n\t// In old IE, we can piggy back on the mechanism for\n\t// comparing component positions\n\treturn sortByItemPosition( node, otherNode );\n}\n\nfunction sortByItemPosition ( a, b ) {\n\tvar ancestryA = getAncestry( a.component || a._ractive.proxy );\n\tvar ancestryB = getAncestry( b.component || b._ractive.proxy );\n\n\tvar oldestA = lastItem( ancestryA );\n\tvar oldestB = lastItem( ancestryB );\n\tvar mutualAncestor;\n\n\t// remove items from the end of both ancestries as long as they are identical\n\t// - the final one removed is the closest mutual ancestor\n\twhile ( oldestA && ( oldestA === oldestB ) ) {\n\t\tancestryA.pop();\n\t\tancestryB.pop();\n\n\t\tmutualAncestor = oldestA;\n\n\t\toldestA = lastItem( ancestryA );\n\t\toldestB = lastItem( ancestryB );\n\t}\n\n\t// now that we have the mutual ancestor, we can find which is earliest\n\toldestA = oldestA.component || oldestA;\n\toldestB = oldestB.component || oldestB;\n\n\tvar fragmentA = oldestA.parentFragment;\n\tvar fragmentB = oldestB.parentFragment;\n\n\t// if both items share a parent fragment, our job is easy\n\tif ( fragmentA === fragmentB ) {\n\t\tvar indexA = fragmentA.items.indexOf( oldestA );\n\t\tvar indexB = fragmentB.items.indexOf( oldestB );\n\n\t\t// if it's the same index, it means one contains the other,\n\t\t// so we see which has the longest ancestry\n\t\treturn ( indexA - indexB ) || ancestryA.length - ancestryB.length;\n\t}\n\n\t// if mutual ancestor is a section, we first test to see which section\n\t// fragment comes first\n\tvar fragments = mutualAncestor.iterations;\n\tif ( fragments ) {\n\t\tvar indexA$1 = fragments.indexOf( fragmentA );\n\t\tvar indexB$1 = fragments.indexOf( fragmentB );\n\n\t\treturn ( indexA$1 - indexB$1 ) || ancestryA.length - ancestryB.length;\n\t}\n\n\tthrow new Error( 'An unexpected condition was met while comparing the position of two components. Please file an issue at https://github.com/ractivejs/ractive/issues - thanks!' );\n}\n\nfunction getParent ( item ) {\n\tvar parentFragment = item.parentFragment;\n\n\tif ( parentFragment ) return parentFragment.owner;\n\n\tif ( item.component && ( parentFragment = item.component.parentFragment ) ) {\n\t\treturn parentFragment.owner;\n\t}\n}\n\nfunction getAncestry ( item ) {\n\tvar ancestry = [ item ];\n\tvar ancestor = getParent( item );\n\n\twhile ( ancestor ) {\n\t\tancestry.push( ancestor );\n\t\tancestor = getParent( ancestor );\n\t}\n\n\treturn ancestry;\n}\n\n\nvar Query = function Query ( ractive, selector, live, isComponentQuery ) {\n\tthis.ractive = ractive;\n\tthis.selector = selector;\n\tthis.live = live;\n\tthis.isComponentQuery = isComponentQuery;\n\n\tthis.result = [];\n\n\tthis.dirty = true;\n};\n\nQuery.prototype.add = function add ( item ) {\n\tthis.result.push( item );\n\tthis.makeDirty();\n};\n\nQuery.prototype.cancel = function cancel () {\n\tvar liveQueries = this._root[ this.isComponentQuery ? 'liveComponentQueries' : 'liveQueries' ];\n\tvar selector = this.selector;\n\n\tvar index = liveQueries.indexOf( selector );\n\n\tif ( index !== -1 ) {\n\t\tliveQueries.splice( index, 1 );\n\t\tliveQueries[ selector ] = null;\n\t}\n};\n\nQuery.prototype.init = function init () {\n\tthis.dirty = false;\n};\n\nQuery.prototype.makeDirty = function makeDirty () {\n\tvar this$1 = this;\n\n\t\tif ( !this.dirty ) {\n\t\tthis.dirty = true;\n\n\t\t// Once the DOM has been updated, ensure the query\n\t\t// is correctly ordered\n\t\trunloop.scheduleTask( function () { return this$1.update(); } );\n\t}\n};\n\nQuery.prototype.remove = function remove ( nodeOrComponent ) {\n\tvar index = this.result.indexOf( this.isComponentQuery ? nodeOrComponent.instance : nodeOrComponent );\n\tif ( index !== -1 ) this.result.splice( index, 1 );\n};\n\nQuery.prototype.update = function update () {\n\tthis.result.sort( this.isComponentQuery ? sortByItemPosition : sortByDocumentPosition );\n\tthis.dirty = false;\n};\n\nQuery.prototype.test = function test ( item ) {\n\treturn this.isComponentQuery ?\n\t\t( !this.selector || item.name === this.selector ) :\n\t\t( item ? matches( item, this.selector ) : null );\n};\n\nfunction Ractive$findAll ( selector, options ) {\n\tif ( !this.el ) throw new Error( (\"Cannot call ractive.findAll('\" + selector + \"', ...) unless instance is rendered to the DOM\") );\n\n\toptions = options || {};\n\tvar liveQueries = this._liveQueries;\n\n\t// Shortcut: if we're maintaining a live query with this\n\t// selector, we don't need to traverse the parallel DOM\n\tvar query = liveQueries[ selector ];\n\tif ( query ) {\n\t\t// Either return the exact same query, or (if not live) a snapshot\n\t\treturn ( options && options.live ) ? query : query.slice();\n\t}\n\n\tquery = new Query( this, selector, !!options.live, false );\n\n\t// Add this to the list of live queries Ractive needs to maintain,\n\t// if applicable\n\tif ( query.live ) {\n\t\tliveQueries.push( selector );\n\t\tliveQueries[ '_' + selector ] = query;\n\t}\n\n\tthis.fragment.findAll( selector, query );\n\n\tquery.init();\n\treturn query.result;\n}\n\nfunction Ractive$findAllComponents ( selector, options ) {\n\toptions = options || {};\n\tvar liveQueries = this._liveComponentQueries;\n\n\t// Shortcut: if we're maintaining a live query with this\n\t// selector, we don't need to traverse the parallel DOM\n\tvar query = liveQueries[ selector ];\n\tif ( query ) {\n\t\t// Either return the exact same query, or (if not live) a snapshot\n\t\treturn ( options && options.live ) ? query : query.slice();\n\t}\n\n\tquery = new Query( this, selector, !!options.live, true );\n\n\t// Add this to the list of live queries Ractive needs to maintain,\n\t// if applicable\n\tif ( query.live ) {\n\t\tliveQueries.push( selector );\n\t\tliveQueries[ '_' + selector ] = query;\n\t}\n\n\tthis.fragment.findAllComponents( selector, query );\n\n\tquery.init();\n\treturn query.result;\n}\n\nfunction Ractive$findComponent ( selector ) {\n\treturn this.fragment.findComponent( selector );\n}\n\nfunction Ractive$findContainer ( selector ) {\n\tif ( this.container ) {\n\t\tif ( this.container.component && this.container.component.name === selector ) {\n\t\t\treturn this.container;\n\t\t} else {\n\t\t\treturn this.container.findContainer( selector );\n\t\t}\n\t}\n\n\treturn null;\n}\n\nfunction Ractive$findParent ( selector ) {\n\n\tif ( this.parent ) {\n\t\tif ( this.parent.component && this.parent.component.name === selector ) {\n\t\t\treturn this.parent;\n\t\t} else {\n\t\t\treturn this.parent.findParent ( selector );\n\t\t}\n\t}\n\n\treturn null;\n}\n\nfunction enqueue ( ractive, event ) {\n\tif ( ractive.event ) {\n\t\tractive._eventQueue.push( ractive.event );\n\t}\n\n\tractive.event = event;\n}\n\nfunction dequeue ( ractive ) {\n\tif ( ractive._eventQueue.length ) {\n\t\tractive.event = ractive._eventQueue.pop();\n\t} else {\n\t\tractive.event = null;\n\t}\n}\n\nvar starMaps = {};\n\n// This function takes a keypath such as 'foo.bar.baz', and returns\n// all the variants of that keypath that include a wildcard in place\n// of a key, such as 'foo.bar.*', 'foo.*.baz', 'foo.*.*' and so on.\n// These are then checked against the dependants map (ractive.viewmodel.depsMap)\n// to see if any pattern observers are downstream of one or more of\n// these wildcard keypaths (e.g. 'foo.bar.*.status')\nfunction getPotentialWildcardMatches ( keypath ) {\n\tvar keys, starMap, mapper, i, result, wildcardKeypath;\n\n\tkeys = splitKeypath( keypath );\n\tif( !( starMap = starMaps[ keys.length ]) ) {\n\t\tstarMap = getStarMap( keys.length );\n\t}\n\n\tresult = [];\n\n\tmapper = function ( star, i ) {\n\t\treturn star ? '*' : keys[i];\n\t};\n\n\ti = starMap.length;\n\twhile ( i-- ) {\n\t\twildcardKeypath = starMap[i].map( mapper ).join( '.' );\n\n\t\tif ( !result.hasOwnProperty( wildcardKeypath ) ) {\n\t\t\tresult.push( wildcardKeypath );\n\t\t\tresult[ wildcardKeypath ] = true;\n\t\t}\n\t}\n\n\treturn result;\n}\n\n// This function returns all the possible true/false combinations for\n// a given number - e.g. for two, the possible combinations are\n// [ true, true ], [ true, false ], [ false, true ], [ false, false ].\n// It does so by getting all the binary values between 0 and e.g. 11\nfunction getStarMap ( num ) {\n\tvar ones = '', max, binary, starMap, mapper, i, j, l, map;\n\n\tif ( !starMaps[ num ] ) {\n\t\tstarMap = [];\n\n\t\twhile ( ones.length < num ) {\n\t\t\tones += 1;\n\t\t}\n\n\t\tmax = parseInt( ones, 2 );\n\n\t\tmapper = function ( digit ) {\n\t\t\treturn digit === '1';\n\t\t};\n\n\t\tfor ( i = 0; i <= max; i += 1 ) {\n\t\t\tbinary = i.toString( 2 );\n\t\t\twhile ( binary.length < num ) {\n\t\t\t\tbinary = '0' + binary;\n\t\t\t}\n\n\t\t\tmap = [];\n\t\t\tl = binary.length;\n\t\t\tfor (j = 0; j < l; j++) {\n\t\t\t\tmap.push( mapper( binary[j] ) );\n\t\t\t}\n\t\t\tstarMap[i] = map;\n\t\t}\n\n\t\tstarMaps[ num ] = starMap;\n\t}\n\n\treturn starMaps[ num ];\n}\n\nvar wildcardCache = {};\n\nfunction fireEvent ( ractive, eventName, options ) {\n\tif ( options === void 0 ) options = {};\n\n\tif ( !eventName ) { return; }\n\n\tif ( !options.event ) {\n\t\toptions.event = {\n\t\t\tname: eventName,\n\t\t\t// until event not included as argument default\n\t\t\t_noArg: true\n\t\t};\n\t} else {\n\t\toptions.event.name = eventName;\n\t}\n\n\tvar eventNames = getWildcardNames( eventName );\n\n\treturn fireEventAs( ractive, eventNames, options.event, options.args, true );\n}\n\nfunction getWildcardNames ( eventName ) {\n\tif ( wildcardCache.hasOwnProperty( eventName ) ) {\n\t\treturn wildcardCache[ eventName ];\n\t} else {\n\t\treturn wildcardCache[ eventName ] = getPotentialWildcardMatches( eventName );\n\t}\n}\n\nfunction fireEventAs  ( ractive, eventNames, event, args, initialFire ) {\n\n\tif ( initialFire === void 0 ) initialFire = false;\n\n\tvar subscribers, i, bubble = true;\n\n\tenqueue( ractive, event );\n\n\tfor ( i = eventNames.length; i >= 0; i-- ) {\n\t\tsubscribers = ractive._subs[ eventNames[ i ] ];\n\n\t\tif ( subscribers ) {\n\t\t\tbubble = notifySubscribers( ractive, subscribers, event, args ) && bubble;\n\t\t}\n\t}\n\n\tdequeue( ractive );\n\n\tif ( ractive.parent && bubble ) {\n\n\t\tif ( initialFire && ractive.component ) {\n\t\t\tvar fullName = ractive.component.name + '.' + eventNames[ eventNames.length-1 ];\n\t\t\teventNames = getWildcardNames( fullName );\n\n\t\t\tif( event && !event.component ) {\n\t\t\t\tevent.component = ractive;\n\t\t\t}\n\t\t}\n\n\t\tfireEventAs( ractive.parent, eventNames, event, args );\n\t}\n\n\treturn bubble;\n}\n\nfunction notifySubscribers ( ractive, subscribers, event, args ) {\n\tvar originalEvent = null, stopEvent = false;\n\n\tif ( event && !event._noArg ) {\n\t\targs = [ event ].concat( args );\n\t}\n\n\t// subscribers can be modified inflight, e.g. \"once\" functionality\n\t// so we need to copy to make sure everyone gets called\n\tsubscribers = subscribers.slice();\n\n\tfor ( var i = 0, len = subscribers.length; i < len; i += 1 ) {\n\t\tif ( subscribers[ i ].apply( ractive, args ) === false ) {\n\t\t\tstopEvent = true;\n\t\t}\n\t}\n\n\tif ( event && !event._noArg && stopEvent && ( originalEvent = event.original ) ) {\n\t\toriginalEvent.preventDefault && originalEvent.preventDefault();\n\t\toriginalEvent.stopPropagation && originalEvent.stopPropagation();\n\t}\n\n\treturn !stopEvent;\n}\n\nfunction Ractive$fire ( eventName ) {\n\tvar args = [], len = arguments.length - 1;\n\twhile ( len-- > 0 ) args[ len ] = arguments[ len + 1 ];\n\n\treturn fireEvent( this, eventName, { args: args });\n}\n\nfunction badReference ( key ) {\n\tthrow new Error( (\"An index or key reference (\" + key + \") cannot have child properties\") );\n}\n\nfunction resolveAmbiguousReference ( fragment, ref ) {\n\tvar localViewmodel = fragment.findContext().root;\n\tvar keys = splitKeypath( ref );\n\tvar key = keys[0];\n\n\tvar hasContextChain;\n\tvar crossedComponentBoundary;\n\tvar aliases;\n\n\twhile ( fragment ) {\n\t\t// repeated fragments\n\t\tif ( fragment.isIteration ) {\n\t\t\tif ( key === fragment.parent.keyRef ) {\n\t\t\t\tif ( keys.length > 1 ) badReference( key );\n\t\t\t\treturn fragment.context.getKeyModel( fragment.key );\n\t\t\t}\n\n\t\t\tif ( key === fragment.parent.indexRef ) {\n\t\t\t\tif ( keys.length > 1 ) badReference( key );\n\t\t\t\treturn fragment.context.getKeyModel( fragment.index );\n\t\t\t}\n\t\t}\n\n\t\t// alias node or iteration\n\t\tif ( ( ( aliases = fragment.owner.aliases ) || ( aliases = fragment.aliases ) ) && aliases.hasOwnProperty( key ) ) {\n\t\t\tvar model = aliases[ key ];\n\n\t\t\tif ( keys.length === 1 ) return model;\n\t\t\telse if ( typeof model.joinAll === 'function' ) {\n\t\t\t\treturn model.joinAll( keys.slice( 1 ) );\n\t\t\t}\n\t\t}\n\n\t\tif ( fragment.context ) {\n\t\t\t// TODO better encapsulate the component check\n\t\t\tif ( !fragment.isRoot || fragment.ractive.component ) hasContextChain = true;\n\n\t\t\tif ( fragment.context.has( key ) ) {\n\t\t\t\tif ( crossedComponentBoundary ) {\n\t\t\t\t\treturn localViewmodel.createLink( key, fragment.context.joinKey( keys.shift() ), key ).joinAll( keys );\n\t\t\t\t}\n\n\t\t\t\treturn fragment.context.joinAll( keys );\n\t\t\t}\n\t\t}\n\n\t\tif ( fragment.componentParent && !fragment.ractive.isolated ) {\n\t\t\t// ascend through component boundary\n\t\t\tfragment = fragment.componentParent;\n\t\t\tcrossedComponentBoundary = true;\n\t\t} else {\n\t\t\tfragment = fragment.parent;\n\t\t}\n\t}\n\n\tif ( !hasContextChain ) {\n\t\treturn localViewmodel.joinAll( keys );\n\t}\n}\n\nvar stack = [];\nvar captureGroup;\n\nfunction startCapturing () {\n\tstack.push( captureGroup = [] );\n}\n\nfunction stopCapturing () {\n\tvar dependencies = stack.pop();\n\tcaptureGroup = stack[ stack.length - 1 ];\n\treturn dependencies;\n}\n\nfunction capture ( model ) {\n\tif ( captureGroup ) {\n\t\tcaptureGroup.push( model );\n\t}\n}\n\nvar KeyModel = function KeyModel ( key, parent ) {\n\tthis.value = key;\n\tthis.isReadonly = this.isKey = true;\n\tthis.deps = [];\n\tthis.links = [];\n\tthis.parent = parent;\n};\n\nKeyModel.prototype.get = function get ( shouldCapture ) {\n\tif ( shouldCapture ) capture( this );\n\treturn unescapeKey( this.value );\n};\n\nKeyModel.prototype.getKeypath = function getKeypath () {\n\treturn unescapeKey( this.value );\n};\n\nKeyModel.prototype.rebinding = function rebinding ( next, previous ) {\n\tvar this$1 = this;\n\n\t\tvar i = this.deps.length;\n\twhile ( i-- ) this$1.deps[i].rebinding( next, previous, false );\n\n\ti = this.links.length;\n\twhile ( i-- ) this$1.links[i].rebinding( next, previous, false );\n};\n\nKeyModel.prototype.register = function register ( dependant ) {\n\tthis.deps.push( dependant );\n};\n\nKeyModel.prototype.registerLink = function registerLink ( link ) {\n\taddToArray( this.links, link );\n};\n\nKeyModel.prototype.unregister = function unregister ( dependant ) {\n\tremoveFromArray( this.deps, dependant );\n};\n\nKeyModel.prototype.unregisterLink = function unregisterLink ( link ) {\n\tremoveFromArray( this.links, link );\n};\n\nfunction bind$2               ( x ) { x.bind(); }\nfunction cancel$1             ( x ) { x.cancel(); }\nfunction handleChange$1$1       ( x ) { x.handleChange(); }\nfunction mark$1$1               ( x ) { x.mark(); }\nfunction marked             ( x ) { x.marked(); }\nfunction notifiedUpstream   ( x ) { x.notifiedUpstream(); }\nfunction render$1$1             ( x ) { x.render(); }\nfunction teardown$1$1           ( x ) { x.teardown(); }\nfunction unbind$1$1             ( x ) { x.unbind(); }\nfunction unrender$1$1           ( x ) { x.unrender(); }\nfunction unrenderAndDestroy ( x ) { x.unrender( true ); }\nfunction update$1$1             ( x ) { x.update(); }\nfunction toString$2           ( x ) { return x.toString(); }\nfunction toEscapedString    ( x ) { return x.toString( true ); }\n\nvar KeypathModel = function KeypathModel ( parent, ractive ) {\n\tthis.parent = parent;\n\tthis.ractive = ractive;\n\tthis.value = ractive ? parent.getKeypath( ractive ) : parent.getKeypath();\n\tthis.deps = [];\n\tthis.children = {};\n\tthis.isReadonly = this.isKeypath = true;\n};\n\nKeypathModel.prototype.get = function get ( shouldCapture ) {\n\tif ( shouldCapture ) capture( this );\n\treturn this.value;\n};\n\nKeypathModel.prototype.getChild = function getChild ( ractive ) {\n\tif ( !( ractive._guid in this.children ) ) {\n\t\tvar model = new KeypathModel( this.parent, ractive );\n\t\tthis.children[ ractive._guid ] = model;\n\t\tmodel.owner = this;\n\t}\n\treturn this.children[ ractive._guid ];\n};\n\nKeypathModel.prototype.getKeypath = function getKeypath () {\n\treturn this.value;\n};\n\nKeypathModel.prototype.handleChange = function handleChange$1 () {\n\tvar this$1 = this;\n\n\t\tvar keys = Object.keys( this.children );\n\tvar i = keys.length;\n\twhile ( i-- ) {\n\t\tthis$1.children[ keys[i] ].handleChange();\n\t}\n\n\tthis.deps.forEach( handleChange$1$1 );\n};\n\nKeypathModel.prototype.rebindChildren = function rebindChildren ( next ) {\n\tvar this$1 = this;\n\n\t\tvar keys = Object.keys( this.children );\n\tvar i = keys.length;\n\twhile ( i-- ) {\n\t\tvar child = this$1.children[keys[i]];\n\t\tchild.value = next.getKeypath( child.ractive );\n\t\tchild.handleChange();\n\t}\n};\n\nKeypathModel.prototype.rebinding = function rebinding ( next, previous ) {\n\tvar this$1 = this;\n\n\t\tvar model = next ? next.getKeypathModel( this.ractive ) : undefined;\n\n\tvar keys = Object.keys( this.children );\n\tvar i = keys.length;\n\twhile ( i-- ) {\n\t\tthis$1.children[ keys[i] ].rebinding( next, previous, false );\n\t}\n\n\ti = this.deps.length;\n\twhile ( i-- ) {\n\t\tthis$1.deps[i].rebinding( model, this$1, false );\n\t}\n};\n\nKeypathModel.prototype.register = function register ( dep ) {\n\tthis.deps.push( dep );\n};\n\nKeypathModel.prototype.removeChild = function removeChild( model ) {\n\tif ( model.ractive ) delete this.children[ model.ractive._guid ];\n};\n\nKeypathModel.prototype.teardown = function teardown () {\n\tvar this$1 = this;\n\n\t\tif ( this.owner ) this.owner.removeChild( this );\n\n\tvar keys = Object.keys( this.children );\n\tvar i = keys.length;\n\twhile ( i-- ) {\n\t\tthis$1.children[ keys[i] ].teardown();\n\t}\n};\n\nKeypathModel.prototype.unregister = function unregister ( dep ) {\n\tremoveFromArray( this.deps, dep );\n\tif ( !this.deps.length ) this.teardown();\n};\n\nvar hasProp = Object.prototype.hasOwnProperty;\n\nvar shuffleTasks = { early: [], mark: [] };\nvar registerQueue = { early: [], mark: [] };\n\nvar ModelBase = function ModelBase ( parent ) {\n\tthis.deps = [];\n\n\tthis.children = [];\n\tthis.childByKey = {};\n\tthis.links = [];\n\n\tthis.keyModels = {};\n\n\tthis.unresolved = [];\n\tthis.unresolvedByKey = {};\n\n\tthis.bindings = [];\n\tthis.patternObservers = [];\n\n\tif ( parent ) {\n\t\tthis.parent = parent;\n\t\tthis.root = parent.root;\n\t}\n};\n\nModelBase.prototype.addUnresolved = function addUnresolved ( key, resolver ) {\n\tif ( !this.unresolvedByKey[ key ] ) {\n\t\tthis.unresolved.push( key );\n\t\tthis.unresolvedByKey[ key ] = [];\n\t}\n\n\tthis.unresolvedByKey[ key ].push( resolver );\n};\n\nModelBase.prototype.addShuffleTask = function addShuffleTask ( task, stage ) { if ( stage === void 0 ) stage = 'early';\n\n\tshuffleTasks[stage].push( task ); };\nModelBase.prototype.addShuffleRegister = function addShuffleRegister ( item, stage ) { if ( stage === void 0 ) stage = 'early';\n\n\tregisterQueue[stage].push({ model: this, item: item }); };\n\nModelBase.prototype.clearUnresolveds = function clearUnresolveds ( specificKey ) {\n\tvar this$1 = this;\n\n\t\tvar i = this.unresolved.length;\n\n\twhile ( i-- ) {\n\t\tvar key = this$1.unresolved[i];\n\n\t\tif ( specificKey && key !== specificKey ) continue;\n\n\t\tvar resolvers = this$1.unresolvedByKey[ key ];\n\t\tvar hasKey = this$1.has( key );\n\n\t\tvar j = resolvers.length;\n\t\twhile ( j-- ) {\n\t\t\tif ( hasKey ) resolvers[j].attemptResolution();\n\t\t\tif ( resolvers[j].resolved ) resolvers.splice( j, 1 );\n\t\t}\n\n\t\tif ( !resolvers.length ) {\n\t\t\tthis$1.unresolved.splice( i, 1 );\n\t\t\tthis$1.unresolvedByKey[ key ] = null;\n\t\t}\n\t}\n};\n\nModelBase.prototype.findMatches = function findMatches ( keys ) {\n\tvar len = keys.length;\n\n\tvar existingMatches = [ this ];\n\tvar matches;\n\tvar i;\n\n\tvar loop = function (  ) {\n\t\tvar key = keys[i];\n\n\t\tif ( key === '*' ) {\n\t\t\tmatches = [];\n\t\t\texistingMatches.forEach( function ( model ) {\n\t\t\t\tmatches.push.apply( matches, model.getValueChildren( model.get() ) );\n\t\t\t});\n\t\t} else {\n\t\t\tmatches = existingMatches.map( function ( model ) { return model.joinKey( key ); } );\n\t\t}\n\n\t\texistingMatches = matches;\n\t};\n\n\t\tfor ( i = 0; i < len; i += 1 ) loop(  );\n\n\treturn matches;\n};\n\nModelBase.prototype.getKeyModel = function getKeyModel ( key, skip ) {\n\tif ( key !== undefined && !skip ) return this.parent.getKeyModel( key, true );\n\n\tif ( !( key in this.keyModels ) ) this.keyModels[ key ] = new KeyModel( escapeKey( key ), this );\n\n\treturn this.keyModels[ key ];\n};\n\nModelBase.prototype.getKeypath = function getKeypath ( ractive ) {\n\tif ( ractive !== this.ractive && this._link ) return this._link.target.getKeypath( ractive );\n\n\tif ( !this.keypath ) {\n\t\tthis.keypath = this.parent.isRoot ? this.key : (\"\" + (this.parent.getKeypath( ractive )) + \".\" + (escapeKey( this.key )));\n\t}\n\n\treturn this.keypath;\n};\n\nModelBase.prototype.getValueChildren = function getValueChildren ( value ) {\n\tvar this$1 = this;\n\n\t\tvar children;\n\tif ( isArray( value ) ) {\n\t\tchildren = [];\n\t\tif ( 'length' in this && this.length !== value.length ) {\n\t\t\tchildren.push( this.joinKey( 'length' ) );\n\t\t}\n\t\tvalue.forEach( function ( m, i ) {\n\t\t\tchildren.push( this$1.joinKey( i ) );\n\t\t});\n\t}\n\n\telse if ( isObject( value ) || typeof value === 'function' ) {\n\t\tchildren = Object.keys( value ).map( function ( key ) { return this$1.joinKey( key ); } );\n\t}\n\n\telse if ( value != null ) {\n\t\treturn [];\n\t}\n\n\treturn children;\n};\n\nModelBase.prototype.getVirtual = function getVirtual ( shouldCapture ) {\n\tvar this$1 = this;\n\n\t\tvar value = this.get( shouldCapture, { virtual: false } );\n\tif ( isObject( value ) ) {\n\t\tvar result = isArray( value ) ? [] : {};\n\n\t\tvar keys = Object.keys( value );\n\t\tvar i = keys.length;\n\t\twhile ( i-- ) {\n\t\t\tvar child = this$1.childByKey[ keys[i] ];\n\t\t\tif ( !child ) result[ keys[i] ] = value[ keys[i] ];\n\t\t\telse if ( child._link ) result[ keys[i] ] = child._link.getVirtual();\n\t\t\telse result[ keys[i] ] = child.getVirtual();\n\t\t}\n\n\t\ti = this.children.length;\n\t\twhile ( i-- ) {\n\t\t\tvar child$1 = this$1.children[i];\n\t\t\tif ( !( child$1.key in result ) && child$1._link ) {\n\t\t\t\tresult[ child$1.key ] = child$1._link.getVirtual();\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t} else return value;\n};\n\nModelBase.prototype.has = function has ( key ) {\n\tif ( this._link ) return this._link.has( key );\n\n\tvar value = this.get();\n\tif ( !value ) return false;\n\n\tkey = unescapeKey( key );\n\tif ( hasProp.call( value, key ) ) return true;\n\n\t// We climb up the constructor chain to find if one of them contains the key\n\tvar constructor = value.constructor;\n\twhile ( constructor !== Function && constructor !== Array && constructor !== Object ) {\n\t\tif ( hasProp.call( constructor.prototype, key ) ) return true;\n\t\tconstructor = constructor.constructor;\n\t}\n\n\treturn false;\n};\n\nModelBase.prototype.joinAll = function joinAll ( keys, opts ) {\n\tvar model = this;\n\tfor ( var i = 0; i < keys.length; i += 1 ) {\n\t\tif ( opts && opts.lastLink === false && i + 1 === keys.length && model.childByKey[keys[i]] && model.childByKey[keys[i]]._link ) return model.childByKey[keys[i]];\n\t\tmodel = model.joinKey( keys[i], opts );\n\t}\n\n\treturn model;\n};\n\nModelBase.prototype.notifyUpstream = function notifyUpstream () {\n\tvar parent = this.parent, prev = this;\n\twhile ( parent ) {\n\t\tif ( parent.patternObservers.length ) parent.patternObservers.forEach( function ( o ) { return o.notify( prev.key ); } );\n\t\tparent.links.forEach( notifiedUpstream );\n\t\tparent.deps.forEach( handleChange$1$1 );\n\t\tprev = parent;\n\t\tparent = parent.parent;\n\t}\n};\n\nModelBase.prototype.rebinding = function rebinding ( next, previous, safe ) {\n\t// tell the deps to move to the new target\n\tvar this$1 = this;\n\n\t\tvar i = this.deps.length;\n\twhile ( i-- ) {\n\t\tif ( this$1.deps[i].rebinding ) this$1.deps[i].rebinding( next, previous, safe );\n\t}\n\n\ti = this.links.length;\n\twhile ( i-- ) {\n\t\tvar link = this$1.links[i];\n\t\t// only relink the root of the link tree\n\t\tif ( link.owner._link ) link.relinking( next, true, safe );\n\t}\n\n\ti = this.children.length;\n\twhile ( i-- ) {\n\t\tvar child = this$1.children[i];\n\t\tchild.rebinding( next ? next.joinKey( child.key ) : undefined, child, safe );\n\t}\n\n\ti = this.unresolved.length;\n\twhile ( i-- ) {\n\t\tvar unresolved = this$1.unresolvedByKey[ this$1.unresolved[i] ];\n\t\tvar c = unresolved.length;\n\t\twhile ( c-- ) {\n\t\t\tunresolved[c].rebinding( next, previous );\n\t\t}\n\t}\n\n\tif ( this.keypathModel ) this.keypathModel.rebinding( next, previous, false );\n\n\ti = this.bindings.length;\n\twhile ( i-- ) {\n\t\tthis$1.bindings[i].rebinding( next, previous, safe );\n\t}\n};\n\nModelBase.prototype.register = function register ( dep ) {\n\tthis.deps.push( dep );\n};\n\nModelBase.prototype.registerChange = function registerChange ( key, value ) {\n\tif ( !this.isRoot ) {\n\t\tthis.root.registerChange( key, value );\n\t} else {\n\t\tthis.changes[ key ] = value;\n\t\trunloop.addInstance( this.root.ractive );\n\t}\n};\n\nModelBase.prototype.registerLink = function registerLink ( link ) {\n\taddToArray( this.links, link );\n};\n\nModelBase.prototype.registerPatternObserver = function registerPatternObserver ( observer ) {\n\tthis.patternObservers.push( observer );\n\tthis.register( observer );\n};\n\nModelBase.prototype.registerTwowayBinding = function registerTwowayBinding ( binding ) {\n\tthis.bindings.push( binding );\n};\n\nModelBase.prototype.removeUnresolved = function removeUnresolved ( key, resolver ) {\n\tvar resolvers = this.unresolvedByKey[ key ];\n\n\tif ( resolvers ) {\n\t\tremoveFromArray( resolvers, resolver );\n\t}\n};\n\nModelBase.prototype.shuffled = function shuffled () {\n\tvar this$1 = this;\n\n\t\tvar i = this.children.length;\n\twhile ( i-- ) {\n\t\tthis$1.children[i].shuffled();\n\t}\n\tif ( this.wrapper ) {\n\t\tthis.wrapper.teardown();\n\t\tthis.wrapper = null;\n\t\tthis.rewrap = true;\n\t}\n};\n\nModelBase.prototype.unregister = function unregister ( dependant ) {\n\tremoveFromArray( this.deps, dependant );\n};\n\nModelBase.prototype.unregisterLink = function unregisterLink ( link ) {\n\tremoveFromArray( this.links, link );\n};\n\nModelBase.prototype.unregisterPatternObserver = function unregisterPatternObserver ( observer ) {\n\tremoveFromArray( this.patternObservers, observer );\n\tthis.unregister( observer );\n};\n\nModelBase.prototype.unregisterTwowayBinding = function unregisterTwowayBinding ( binding ) {\n\tremoveFromArray( this.bindings, binding );\n};\n\nModelBase.prototype.updateFromBindings = function updateFromBindings$1 ( cascade ) {\n\tvar this$1 = this;\n\n\t\tvar i = this.bindings.length;\n\twhile ( i-- ) {\n\t\tvar value = this$1.bindings[i].getValue();\n\t\tif ( value !== this$1.value ) this$1.set( value );\n\t}\n\n\t// check for one-way bindings if there are no two-ways\n\tif ( !this.bindings.length ) {\n\t\tvar oneway = findBoundValue( this.deps );\n\t\tif ( oneway && oneway.value !== this.value ) this.set( oneway.value );\n\t}\n\n\tif ( cascade ) {\n\t\tthis.children.forEach( updateFromBindings );\n\t\tthis.links.forEach( updateFromBindings );\n\t\tif ( this._link ) this._link.updateFromBindings( cascade );\n\t}\n};\n\nfunction updateFromBindings ( model ) {\n\tmodel.updateFromBindings( true );\n}\n\nfunction findBoundValue( list ) {\n\tvar i = list.length;\n\twhile ( i-- ) {\n\t\tif ( list[i].bound ) {\n\t\t\tvar owner = list[i].owner;\n\t\t\tif ( owner ) {\n\t\t\t\tvar value = owner.name === 'checked' ?\n\t\t\t\t\towner.node.checked :\n\t\t\t\t\towner.node.value;\n\t\t\t\treturn { value: value };\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction fireShuffleTasks ( stage ) {\n\tif ( !stage ) {\n\t\tfireShuffleTasks( 'early' );\n\t\tfireShuffleTasks( 'mark' );\n\t} else {\n\t\tvar tasks = shuffleTasks[stage];\n\t\tshuffleTasks[stage] = [];\n\t\tvar i = tasks.length;\n\t\twhile ( i-- ) tasks[i]();\n\n\t\tvar register = registerQueue[stage];\n\t\tregisterQueue[stage] = [];\n\t\ti = register.length;\n\t\twhile ( i-- ) register[i].model.register( register[i].item );\n\t}\n}\n\nKeyModel.prototype.addShuffleTask = ModelBase.prototype.addShuffleTask;\nKeyModel.prototype.addShuffleRegister = ModelBase.prototype.addShuffleRegister;\nKeypathModel.prototype.addShuffleTask = ModelBase.prototype.addShuffleTask;\nKeypathModel.prototype.addShuffleRegister = ModelBase.prototype.addShuffleRegister;\n\n// this is the dry method of checking to see if a rebind applies to\n// a particular keypath because in some cases, a dep may be bound\n// directly to a particular keypath e.g. foo.bars.0.baz and need\n// to avoid getting kicked to foo.bars.1.baz if foo.bars is unshifted\nfunction rebindMatch ( template, next, previous ) {\n\tvar keypath = template.r || template;\n\n\t// no valid keypath, go with next\n\tif ( !keypath || typeof keypath !== 'string' ) return next;\n\n\t// completely contextual ref, go with next\n\tif ( keypath === '.' || keypath[0] === '@' || (next || previous).isKey || (next || previous).isKeypath ) return next;\n\n\tvar parts = keypath.split( '/' );\n\tvar keys = splitKeypath( parts[ parts.length - 1 ] );\n\n\t// check the keypath against the model keypath to see if it matches\n\tvar model = next || previous;\n\tvar i = keys.length;\n\tvar match = true, shuffling = false;\n\n\twhile ( model && i-- ) {\n\t\tif ( model.shuffling ) shuffling = true;\n\t\t// non-strict comparison to account for indices in keypaths\n\t\tif ( keys[i] != model.key ) match = false;\n\t\tmodel = model.parent;\n\t}\n\n\t// next is undefined, but keypath is shuffling and previous matches\n\tif ( !next && match && shuffling ) return previous;\n\t// next is defined, but doesn't match the keypath\n\telse if ( next && !match && shuffling ) return previous;\n\telse return next;\n}\n\nvar LinkModel = (function (ModelBase$$1) {\n\tfunction LinkModel ( parent, owner, target, key ) {\n\t\tModelBase$$1.call( this, parent );\n\n\t\tthis.owner = owner;\n\t\tthis.target = target;\n\t\tthis.key = key === undefined ? owner.key : key;\n\t\tif ( owner.isLink ) this.sourcePath = \"\" + (owner.sourcePath) + \".\" + (this.key);\n\n\t\ttarget.registerLink( this );\n\n\t\tthis.isReadonly = parent.isReadonly;\n\n\t\tthis.isLink = true;\n\t}\n\n\tLinkModel.prototype = Object.create( ModelBase$$1 && ModelBase$$1.prototype );\n\tLinkModel.prototype.constructor = LinkModel;\n\n\tLinkModel.prototype.animate = function animate ( from, to, options, interpolator ) {\n\t\tthis.target.animate( from, to, options, interpolator );\n\t};\n\n\tLinkModel.prototype.applyValue = function applyValue ( value ) {\n\t\tthis.target.applyValue( value );\n\t};\n\n\tLinkModel.prototype.get = function get ( shouldCapture, opts ) {\n\t\tif ( shouldCapture ) {\n\t\t\tcapture( this );\n\n\t\t\t// may need to tell the target to unwrap\n\t\t\topts = opts || {};\n\t\t\topts.unwrap = true;\n\t\t}\n\n\t\treturn this.target.get( false, opts );\n\t};\n\n\tLinkModel.prototype.getKeypath = function getKeypath ( ractive ) {\n\t\tif ( ractive && ractive !== this.root.ractive ) return this.target.getKeypath( ractive );\n\n\t\treturn ModelBase$$1.prototype.getKeypath.call( this, ractive );\n\t};\n\n\tLinkModel.prototype.getKeypathModel = function getKeypathModel ( ractive ) {\n\t\tif ( !this.keypathModel ) this.keypathModel = new KeypathModel( this );\n\t\tif ( ractive && ractive !== this.root.ractive ) return this.keypathModel.getChild( ractive );\n\t\treturn this.keypathModel;\n\t};\n\n\tLinkModel.prototype.handleChange = function handleChange$1 () {\n\t\tthis.deps.forEach( handleChange$1$1 );\n\t\tthis.links.forEach( handleChange$1$1 );\n\t\tthis.notifyUpstream();\n\t};\n\n\tLinkModel.prototype.joinKey = function joinKey ( key ) {\n\t\t// TODO: handle nested links\n\t\tif ( key === undefined || key === '' ) return this;\n\n\t\tif ( !this.childByKey.hasOwnProperty( key ) ) {\n\t\t\tvar child = new LinkModel( this, this, this.target.joinKey( key ), key );\n\t\t\tthis.children.push( child );\n\t\t\tthis.childByKey[ key ] = child;\n\t\t}\n\n\t\treturn this.childByKey[ key ];\n\t};\n\n\tLinkModel.prototype.mark = function mark () {\n\t\tthis.target.mark();\n\t};\n\n\tLinkModel.prototype.marked = function marked$1 () {\n\t\tthis.links.forEach( marked );\n\n\t\tthis.deps.forEach( handleChange$1$1 );\n\t\tthis.clearUnresolveds();\n\t};\n\n\tLinkModel.prototype.notifiedUpstream = function notifiedUpstream$1 () {\n\t\tthis.links.forEach( notifiedUpstream );\n\t\tthis.deps.forEach( handleChange$1$1 );\n\t};\n\n\tLinkModel.prototype.relinked = function relinked () {\n\t\tthis.target.registerLink( this );\n\t\tthis.children.forEach( function ( c ) { return c.relinked(); } );\n\t};\n\n\tLinkModel.prototype.relinking = function relinking ( target, root, safe ) {\n\t\tvar this$1 = this;\n\n\t\tif ( root && this.sourcePath ) target = rebindMatch( this.sourcePath, target, this.target );\n\t\tif ( !target || this.target === target ) return;\n\n\t\tthis.target.unregisterLink( this );\n\t\tif ( this.keypathModel ) this.keypathModel.rebindChildren( target );\n\n\t\tthis.target = target;\n\t\tthis.children.forEach( function ( c ) {\n\t\t\tc.relinking( target.joinKey( c.key ), false, safe );\n\t\t});\n\n\t\tif ( root ) this.addShuffleTask( function () {\n\t\t\tthis$1.relinked();\n\t\t\tif ( !safe ) this$1.notifyUpstream();\n\t\t});\n\t};\n\n\tLinkModel.prototype.set = function set ( value ) {\n\t\tthis.target.set( value );\n\t};\n\n\tLinkModel.prototype.shuffle = function shuffle ( newIndices ) {\n\t\t// let the real model handle firing off shuffles\n\t\tvar this$1 = this;\n\n\t\tif ( !this.target.shuffling ) {\n\t\t\tthis.target.shuffle( newIndices );\n\t\t} else {\n\t\t\tvar i = newIndices.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tvar idx = newIndices[ i ];\n\t\t\t\t// nothing is actually changing, so move in the index and roll on\n\t\t\t\tif ( i === idx ) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\t// rebind the children on i to idx\n\t\t\t\tif ( i in this$1.childByKey ) this$1.childByKey[ i ].rebinding( !~idx ? undefined : this$1.joinKey( idx ), this$1.childByKey[ i ], true );\n\n\t\t\t\tif ( !~idx && this$1.keyModels[ i ] ) {\n\t\t\t\t\tthis$1.keyModels[i].rebinding( undefined, this$1.keyModels[i], false );\n\t\t\t\t} else if ( ~idx && this$1.keyModels[ i ] ) {\n\t\t\t\t\tif ( !this$1.keyModels[ idx ] ) this$1.childByKey[ idx ].getKeyModel( idx );\n\t\t\t\t\tthis$1.keyModels[i].rebinding( this$1.keyModels[ idx ], this$1.keyModels[i], false );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar upstream = this.source().length !== this.source().value.length;\n\n\t\t\tthis.links.forEach( function ( l ) { return l.shuffle( newIndices ); } );\n\n\t\t\ti = this.deps.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tif ( this$1.deps[i].shuffle ) this$1.deps[i].shuffle( newIndices );\n\t\t\t}\n\n\t\t\tthis.marked();\n\n\t\t\tif ( upstream ) this.notifyUpstream();\n\t\t}\n\t};\n\n\tLinkModel.prototype.source = function source () {\n\t\tif ( this.target.source ) return this.target.source();\n\t\telse return this.target;\n\t};\n\n\tLinkModel.prototype.teardown = function teardown$1 () {\n\t\tif ( this._link ) this._link.teardown();\n\t\tthis.children.forEach( teardown$1$1 );\n\t};\n\n\treturn LinkModel;\n}(ModelBase));\n\nModelBase.prototype.link = function link ( model, keypath ) {\n\tvar lnk = this._link || new LinkModel( this.parent, this, model, this.key );\n\tlnk.sourcePath = keypath;\n\tif ( this._link ) this._link.relinking( model, true, false );\n\tthis.rebinding( lnk, this, false );\n\tfireShuffleTasks();\n\n\tvar unresolved = !this._link;\n\tthis._link = lnk;\n\tif ( unresolved ) this.parent.clearUnresolveds();\n\tlnk.marked();\n\treturn lnk;\n};\n\nModelBase.prototype.unlink = function unlink () {\n\tif ( this._link ) {\n\t\tvar ln = this._link;\n\t\tthis._link = undefined;\n\t\tln.rebinding( this, this._link );\n\t\tfireShuffleTasks();\n\t\tln.teardown();\n\t}\n};\n\nvar requestAnimationFrame;\n\n// If window doesn't exist, we don't need requestAnimationFrame\nif ( !win ) {\n\trequestAnimationFrame = null;\n} else {\n\t// https://gist.github.com/paulirish/1579671\n\t(function(vendors$$1, lastTime, win$$1) {\n\n\t\tvar x, setTimeout;\n\n\t\tif ( win$$1.requestAnimationFrame ) {\n\t\t\treturn;\n\t\t}\n\n\t\tfor ( x = 0; x < vendors$$1.length && !win$$1.requestAnimationFrame; ++x ) {\n\t\t\twin$$1.requestAnimationFrame = win$$1[vendors$$1[x]+'RequestAnimationFrame'];\n\t\t}\n\n\t\tif ( !win$$1.requestAnimationFrame ) {\n\t\t\tsetTimeout = win$$1.setTimeout;\n\n\t\t\twin$$1.requestAnimationFrame = function(callback) {\n\t\t\t\tvar currTime, timeToCall, id;\n\n\t\t\t\tcurrTime = Date.now();\n\t\t\t\ttimeToCall = Math.max( 0, 16 - (currTime - lastTime ) );\n\t\t\t\tid = setTimeout( function() { callback(currTime + timeToCall); }, timeToCall );\n\n\t\t\t\tlastTime = currTime + timeToCall;\n\t\t\t\treturn id;\n\t\t\t};\n\t\t}\n\n\t}( vendors, 0, win ));\n\n\trequestAnimationFrame = win.requestAnimationFrame;\n}\n\nvar rAF = requestAnimationFrame;\n\nvar getTime = ( win && win.performance && typeof win.performance.now === 'function' ) ?\n\tfunction () { return win.performance.now(); } :\n\tfunction () { return Date.now(); };\n\n// TODO what happens if a transition is aborted?\n\nvar tickers = [];\nvar running = false;\n\nfunction tick () {\n\trunloop.start();\n\n\tvar now = getTime();\n\n\tvar i;\n\tvar ticker;\n\n\tfor ( i = 0; i < tickers.length; i += 1 ) {\n\t\tticker = tickers[i];\n\n\t\tif ( !ticker.tick( now ) ) {\n\t\t\t// ticker is complete, remove it from the stack, and decrement i so we don't miss one\n\t\t\ttickers.splice( i--, 1 );\n\t\t}\n\t}\n\n\trunloop.end();\n\n\tif ( tickers.length ) {\n\t\trAF( tick );\n\t} else {\n\t\trunning = false;\n\t}\n}\n\nvar Ticker = function Ticker ( options ) {\n\tthis.duration = options.duration;\n\tthis.step = options.step;\n\tthis.complete = options.complete;\n\tthis.easing = options.easing;\n\n\tthis.start = getTime();\n\tthis.end = this.start + this.duration;\n\n\tthis.running = true;\n\n\ttickers.push( this );\n\tif ( !running ) rAF( tick );\n};\n\nTicker.prototype.tick = function tick$1 ( now ) {\n\tif ( !this.running ) return false;\n\n\tif ( now > this.end ) {\n\t\tif ( this.step ) this.step( 1 );\n\t\tif ( this.complete ) this.complete( 1 );\n\n\t\treturn false;\n\t}\n\n\tvar elapsed = now - this.start;\n\tvar eased = this.easing( elapsed / this.duration );\n\n\tif ( this.step ) this.step( eased );\n\n\treturn true;\n};\n\nTicker.prototype.stop = function stop () {\n\tif ( this.abort ) this.abort();\n\tthis.running = false;\n};\n\nvar prefixers = {};\n\n// TODO this is legacy. sooner we can replace the old adaptor API the better\nfunction prefixKeypath ( obj, prefix ) {\n\tvar prefixed = {}, key;\n\n\tif ( !prefix ) {\n\t\treturn obj;\n\t}\n\n\tprefix += '.';\n\n\tfor ( key in obj ) {\n\t\tif ( obj.hasOwnProperty( key ) ) {\n\t\t\tprefixed[ prefix + key ] = obj[ key ];\n\t\t}\n\t}\n\n\treturn prefixed;\n}\n\nfunction getPrefixer ( rootKeypath ) {\n\tvar rootDot;\n\n\tif ( !prefixers[ rootKeypath ] ) {\n\t\trootDot = rootKeypath ? rootKeypath + '.' : '';\n\n\t\tprefixers[ rootKeypath ] = function ( relativeKeypath, value ) {\n\t\t\tvar obj;\n\n\t\t\tif ( typeof relativeKeypath === 'string' ) {\n\t\t\t\tobj = {};\n\t\t\t\tobj[ rootDot + relativeKeypath ] = value;\n\t\t\t\treturn obj;\n\t\t\t}\n\n\t\t\tif ( typeof relativeKeypath === 'object' ) {\n\t\t\t\t// 'relativeKeypath' is in fact a hash, not a keypath\n\t\t\t\treturn rootDot ? prefixKeypath( relativeKeypath, rootKeypath ) : relativeKeypath;\n\t\t\t}\n\t\t};\n\t}\n\n\treturn prefixers[ rootKeypath ];\n}\n\nvar Model = (function (ModelBase$$1) {\n\tfunction Model ( parent, key ) {\n\t\tModelBase$$1.call( this, parent );\n\n\t\tthis.value = undefined;\n\n\t\tthis.ticker = null;\n\n\t\tif ( parent ) {\n\t\t\tthis.key = unescapeKey( key );\n\t\t\tthis.isReadonly = parent.isReadonly;\n\n\t\t\tif ( parent.value ) {\n\t\t\t\tthis.value = parent.value[ this.key ];\n\t\t\t\tif ( isArray( this.value ) ) this.length = this.value.length;\n\t\t\t\tthis.adapt();\n\t\t\t}\n\t\t}\n\t}\n\n\tModel.prototype = Object.create( ModelBase$$1 && ModelBase$$1.prototype );\n\tModel.prototype.constructor = Model;\n\n\tModel.prototype.adapt = function adapt () {\n\t\tvar this$1 = this;\n\n\t\tvar adaptors = this.root.adaptors;\n\t\tvar len = adaptors.length;\n\n\t\tthis.rewrap = false;\n\n\t\t// Exit early if no adaptors\n\t\tif ( len === 0 ) return;\n\n\t\tvar value = this.value;\n\n\t\t// TODO remove this legacy nonsense\n\t\tvar ractive = this.root.ractive;\n\t\tvar keypath = this.getKeypath();\n\n\t\t// tear previous adaptor down if present\n\t\tif ( this.wrapper ) {\n\t\t\tvar shouldTeardown = !this.wrapper.reset || this.wrapper.reset( value ) === false;\n\n\t\t\tif ( shouldTeardown ) {\n\t\t\t\tthis.wrapper.teardown();\n\t\t\t\tthis.wrapper = null;\n\n\t\t\t\t// don't branch for undefined values\n\t\t\t\tif ( this.value !== undefined ) {\n\t\t\t\t\tvar parentValue = this.parent.value || this.parent.createBranch( this.key );\n\t\t\t\t\tif ( parentValue[ this.key ] !== this.value ) parentValue[ this.key ] = value;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.value = this.wrapper.get();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tvar i;\n\n\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\tvar adaptor = adaptors[i];\n\t\t\tif ( adaptor.filter( value, keypath, ractive ) ) {\n\t\t\t\tthis$1.wrapper = adaptor.wrap( ractive, value, keypath, getPrefixer( keypath ) );\n\t\t\t\tthis$1.wrapper.value = this$1.value;\n\t\t\t\tthis$1.wrapper.__model = this$1; // massive temporary hack to enable array adaptor\n\n\t\t\t\tthis$1.value = this$1.wrapper.get();\n\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t};\n\n\tModel.prototype.animate = function animate ( from, to, options, interpolator ) {\n\t\tvar this$1 = this;\n\n\t\tif ( this.ticker ) this.ticker.stop();\n\n\t\tvar fulfilPromise;\n\t\tvar promise = new Promise$1( function ( fulfil ) { return fulfilPromise = fulfil; } );\n\n\t\tthis.ticker = new Ticker({\n\t\t\tduration: options.duration,\n\t\t\teasing: options.easing,\n\t\t\tstep: function ( t ) {\n\t\t\t\tvar value = interpolator( t );\n\t\t\t\tthis$1.applyValue( value );\n\t\t\t\tif ( options.step ) options.step( t, value );\n\t\t\t},\n\t\t\tcomplete: function () {\n\t\t\t\tthis$1.applyValue( to );\n\t\t\t\tif ( options.complete ) options.complete( to );\n\n\t\t\t\tthis$1.ticker = null;\n\t\t\t\tfulfilPromise();\n\t\t\t}\n\t\t});\n\n\t\tpromise.stop = this.ticker.stop;\n\t\treturn promise;\n\t};\n\n\tModel.prototype.applyValue = function applyValue ( value ) {\n\t\tif ( isEqual( value, this.value ) ) return;\n\n\t\t// TODO deprecate this nonsense\n\t\tthis.registerChange( this.getKeypath(), value );\n\n\t\tif ( this.parent.wrapper && this.parent.wrapper.set ) {\n\t\t\tthis.parent.wrapper.set( this.key, value );\n\t\t\tthis.parent.value = this.parent.wrapper.get();\n\n\t\t\tthis.value = this.parent.value[ this.key ];\n\t\t\tthis.adapt();\n\t\t} else if ( this.wrapper ) {\n\t\t\tthis.value = value;\n\t\t\tthis.adapt();\n\t\t} else {\n\t\t\tvar parentValue = this.parent.value || this.parent.createBranch( this.key );\n\t\t\tparentValue[ this.key ] = value;\n\n\t\t\tthis.value = value;\n\t\t\tthis.adapt();\n\t\t}\n\n\t\tthis.parent.clearUnresolveds();\n\t\tthis.clearUnresolveds();\n\n\t\t// keep track of array length\n\t\tif ( isArray( value ) ) this.length = value.length;\n\n\t\t// notify dependants\n\t\tthis.links.forEach( handleChange$1$1 );\n\t\tthis.children.forEach( mark$1$1 );\n\t\tthis.deps.forEach( handleChange$1$1 );\n\n\t\tthis.notifyUpstream();\n\n\t\tif ( this.key === 'length' && isArray( this.parent.value ) ) this.parent.length = this.parent.value.length;\n\t};\n\n\tModel.prototype.createBranch = function createBranch ( key ) {\n\t\tvar branch = isNumeric( key ) ? [] : {};\n\t\tthis.set( branch );\n\n\t\treturn branch;\n\t};\n\n\tModel.prototype.get = function get ( shouldCapture, opts ) {\n\t\tif ( this._link ) return this._link.get( shouldCapture, opts );\n\t\tif ( shouldCapture ) capture( this );\n\t\t// if capturing, this value needs to be unwrapped because it's for external use\n\t\tif ( opts && opts.virtual ) return this.getVirtual( false );\n\t\treturn ( shouldCapture || ( opts && opts.unwrap ) ) && this.wrapper ? this.wrapper.value : this.value;\n\t};\n\n\tModel.prototype.getKeypathModel = function getKeypathModel ( ractive ) {\n\t\tif ( !this.keypathModel ) this.keypathModel = new KeypathModel( this );\n\t\treturn this.keypathModel;\n\t};\n\n\tModel.prototype.joinKey = function joinKey ( key, opts ) {\n\t\tif ( this._link ) {\n\t\t\tif ( opts && !opts.lastLink === false && ( key === undefined || key === '' ) ) return this;\n\t\t\treturn this._link.joinKey( key );\n\t\t}\n\n\t\tif ( key === undefined || key === '' ) return this;\n\n\n\t\tif ( !this.childByKey.hasOwnProperty( key ) ) {\n\t\t\tvar child = new Model( this, key );\n\t\t\tthis.children.push( child );\n\t\t\tthis.childByKey[ key ] = child;\n\t\t}\n\n\t\tif ( this.childByKey[ key ]._link ) return this.childByKey[ key ]._link;\n\t\treturn this.childByKey[ key ];\n\t};\n\n\tModel.prototype.mark = function mark$1 () {\n\t\tif ( this._link ) return this._link.mark();\n\n\t\tvar value = this.retrieve();\n\n\t\tif ( !isEqual( value, this.value ) ) {\n\t\t\tvar old = this.value;\n\t\t\tthis.value = value;\n\n\t\t\t// make sure the wrapper stays in sync\n\t\t\tif ( old !== value || this.rewrap ) this.adapt();\n\n\t\t\t// keep track of array lengths\n\t\t\tif ( isArray( value ) ) this.length = value.length;\n\n\t\t\tthis.children.forEach( mark$1$1 );\n\t\t\tthis.links.forEach( marked );\n\n\t\t\tthis.deps.forEach( handleChange$1$1 );\n\t\t\tthis.clearUnresolveds();\n\t\t}\n\t};\n\n\tModel.prototype.merge = function merge ( array, comparator ) {\n\t\tvar oldArray = this.value, newArray = array;\n\t\tif ( oldArray === newArray ) oldArray = recreateArray( this );\n\t\tif ( comparator ) {\n\t\t\toldArray = oldArray.map( comparator );\n\t\t\tnewArray = newArray.map( comparator );\n\t\t}\n\n\t\tvar oldLength = oldArray.length;\n\n\t\tvar usedIndices = {};\n\t\tvar firstUnusedIndex = 0;\n\n\t\tvar newIndices = oldArray.map( function ( item ) {\n\t\t\tvar index;\n\t\t\tvar start = firstUnusedIndex;\n\n\t\t\tdo {\n\t\t\t\tindex = newArray.indexOf( item, start );\n\n\t\t\t\tif ( index === -1 ) {\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\n\t\t\t\tstart = index + 1;\n\t\t\t} while ( ( usedIndices[ index ] === true ) && start < oldLength );\n\n\t\t\t// keep track of the first unused index, so we don't search\n\t\t\t// the whole of newArray for each item in oldArray unnecessarily\n\t\t\tif ( index === firstUnusedIndex ) {\n\t\t\t\tfirstUnusedIndex += 1;\n\t\t\t}\n\t\t\t// allow next instance of next \"equal\" to be found item\n\t\t\tusedIndices[ index ] = true;\n\t\t\treturn index;\n\t\t});\n\n\t\tthis.parent.value[ this.key ] = array;\n\t\tthis.shuffle( newIndices );\n\t};\n\n\tModel.prototype.retrieve = function retrieve () {\n\t\treturn this.parent.value ? this.parent.value[ this.key ] : undefined;\n\t};\n\n\tModel.prototype.set = function set ( value ) {\n\t\tif ( this.ticker ) this.ticker.stop();\n\t\tthis.applyValue( value );\n\t};\n\n\tModel.prototype.shuffle = function shuffle ( newIndices ) {\n\t\tvar this$1 = this;\n\n\t\tthis.shuffling = true;\n\t\tvar i = newIndices.length;\n\t\twhile ( i-- ) {\n\t\t\tvar idx = newIndices[ i ];\n\t\t\t// nothing is actually changing, so move in the index and roll on\n\t\t\tif ( i === idx ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// rebind the children on i to idx\n\t\t\tif ( i in this$1.childByKey ) this$1.childByKey[ i ].rebinding( !~idx ? undefined : this$1.joinKey( idx ), this$1.childByKey[ i ], true );\n\n\t\t\tif ( !~idx && this$1.keyModels[ i ] ) {\n\t\t\t\tthis$1.keyModels[i].rebinding( undefined, this$1.keyModels[i], false );\n\t\t\t} else if ( ~idx && this$1.keyModels[ i ] ) {\n\t\t\t\tif ( !this$1.keyModels[ idx ] ) this$1.childByKey[ idx ].getKeyModel( idx );\n\t\t\t\tthis$1.keyModels[i].rebinding( this$1.keyModels[ idx ], this$1.keyModels[i], false );\n\t\t\t}\n\t\t}\n\n\t\tvar upstream = this.length !== this.value.length;\n\n\t\tthis.links.forEach( function ( l ) { return l.shuffle( newIndices ); } );\n\t\tfireShuffleTasks( 'early' );\n\n\t\ti = this.deps.length;\n\t\twhile ( i-- ) {\n\t\t\tif ( this$1.deps[i].shuffle ) this$1.deps[i].shuffle( newIndices );\n\t\t}\n\n\t\tthis.mark();\n\t\tfireShuffleTasks( 'mark' );\n\n\t\tif ( upstream ) this.notifyUpstream();\n\t\tthis.shuffling = false;\n\t};\n\n\tModel.prototype.teardown = function teardown$1 () {\n\t\tif ( this._link ) this._link.teardown();\n\t\tthis.children.forEach( teardown$1$1 );\n\t\tif ( this.wrapper ) this.wrapper.teardown();\n\t\tif ( this.keypathModel ) this.keypathModel.teardown();\n\t};\n\n\treturn Model;\n}(ModelBase));\n\nfunction recreateArray( model ) {\n\tvar array = [];\n\n\tfor ( var i = 0; i < model.length; i++ ) {\n\t\tarray[ i ] = (model.childByKey[i] || {}).value;\n\t}\n\n\treturn array;\n}\n\n/* global global */\nvar GlobalModel = (function (Model$$1) {\n\tfunction GlobalModel ( ) {\n\t\tModel$$1.call( this, null, '@global' );\n\t\tthis.value = typeof global !== 'undefined' ? global : window;\n\t\tthis.isRoot = true;\n\t\tthis.root = this;\n\t\tthis.adaptors = [];\n\t}\n\n\tGlobalModel.prototype = Object.create( Model$$1 && Model$$1.prototype );\n\tGlobalModel.prototype.constructor = GlobalModel;\n\n\tGlobalModel.prototype.getKeypath = function getKeypath() {\n\t\treturn '@global';\n\t};\n\n\t// global model doesn't contribute changes events because it has no instance\n\tGlobalModel.prototype.registerChange = function registerChange () {};\n\n\treturn GlobalModel;\n}(Model));\n\nvar GlobalModel$1 = new GlobalModel();\n\nvar keypathExpr = /^@[^\\(]+\\(([^\\)]+)\\)/;\n\nfunction resolveReference ( fragment, ref ) {\n\tvar context = fragment.findContext();\n\n\t// special references\n\t// TODO does `this` become `.` at parse time?\n\tif ( ref === '.' || ref === 'this' ) return context;\n\tif ( ref.indexOf( '@keypath' ) === 0 ) {\n\t\tvar match = keypathExpr.exec( ref );\n\t\tif ( match && match[1] ) {\n\t\t\tvar model = resolveReference( fragment, match[1] );\n\t\t\tif ( model ) return model.getKeypathModel();\n\t\t}\n\t\treturn context.getKeypathModel();\n\t}\n\tif ( ref.indexOf( '@rootpath' ) === 0 ) {\n\t\t// check to see if this is an empty component root\n\t\twhile ( context.isRoot && context.ractive.component ) {\n\t\t\tcontext = context.ractive.component.parentFragment.findContext();\n\t\t}\n\n\t\tvar match$1 = keypathExpr.exec( ref );\n\t\tif ( match$1 && match$1[1] ) {\n\t\t\tvar model$1 = resolveReference( fragment, match$1[1] );\n\t\t\tif ( model$1 ) return model$1.getKeypathModel( fragment.ractive.root );\n\t\t}\n\t\treturn context.getKeypathModel( fragment.ractive.root );\n\t}\n\tif ( ref === '@index' || ref === '@key' ) {\n\t\tvar repeater = fragment.findRepeatingFragment();\n\t\t// make sure the found fragment is actually an iteration\n\t\tif ( !repeater.isIteration ) return;\n\t\treturn repeater.context.getKeyModel( repeater[ ref[1] === 'i' ? 'index' : 'key' ] );\n\t}\n\tif ( ref === '@this' ) {\n\t\treturn fragment.ractive.viewmodel.getRactiveModel();\n\t}\n\tif ( ref === '@global' ) {\n\t\treturn GlobalModel$1;\n\t}\n\n\t// ancestor references\n\tif ( ref[0] === '~' ) return fragment.ractive.viewmodel.joinAll( splitKeypath( ref.slice( 2 ) ) );\n\tif ( ref[0] === '.' ) {\n\t\tvar parts = ref.split( '/' );\n\n\t\twhile ( parts[0] === '.' || parts[0] === '..' ) {\n\t\t\tvar part = parts.shift();\n\n\t\t\tif ( part === '..' ) {\n\t\t\t\tcontext = context.parent;\n\t\t\t}\n\t\t}\n\n\t\tref = parts.join( '/' );\n\n\t\t// special case - `{{.foo}}` means the same as `{{./foo}}`\n\t\tif ( ref[0] === '.' ) ref = ref.slice( 1 );\n\t\treturn context.joinAll( splitKeypath( ref ) );\n\t}\n\n\treturn resolveAmbiguousReference( fragment, ref );\n}\n\nfunction Ractive$get ( keypath, opts ) {\n\tif ( typeof keypath !== 'string' ) return this.viewmodel.get( true, keypath );\n\n\tvar keys = splitKeypath( keypath );\n\tvar key = keys[0];\n\n\tvar model;\n\n\tif ( !this.viewmodel.has( key ) ) {\n\t\t// if this is an inline component, we may need to create\n\t\t// an implicit mapping\n\t\tif ( this.component && !this.isolated ) {\n\t\t\tmodel = resolveReference( this.component.parentFragment, key );\n\n\t\t\tif ( model ) {\n\t\t\t\tthis.viewmodel.map( key, model );\n\t\t\t}\n\t\t}\n\t}\n\n\tmodel = this.viewmodel.joinAll( keys );\n\treturn model.get( true, opts );\n}\n\nfunction gatherRefs( fragment ) {\n\tvar key = {}, index = {};\n\n\t// walk up the template gather refs as we go\n\twhile ( fragment ) {\n\t\tif ( fragment.parent && ( fragment.parent.indexRef || fragment.parent.keyRef ) ) {\n\t\t\tvar ref = fragment.parent.indexRef;\n\t\t\tif ( ref && !( ref in index ) ) index[ref] = fragment.index;\n\t\t\tref = fragment.parent.keyRef;\n\t\t\tif ( ref && !( ref in key ) ) key[ref] = fragment.key;\n\t\t}\n\n\t\tif ( fragment.componentParent && !fragment.ractive.isolated ) {\n\t\t\tfragment = fragment.componentParent;\n\t\t} else {\n\t\t\tfragment = fragment.parent;\n\t\t}\n\t}\n\n\treturn { key: key, index: index };\n}\n\n// This function takes an array, the name of a mutator method, and the\n// arguments to call that mutator method with, and returns an array that\n// maps the old indices to their new indices.\n\n// So if you had something like this...\n//\n//     array = [ 'a', 'b', 'c', 'd' ];\n//     array.push( 'e' );\n//\n// ...you'd get `[ 0, 1, 2, 3 ]` - in other words, none of the old indices\n// have changed. If you then did this...\n//\n//     array.unshift( 'z' );\n//\n// ...the indices would be `[ 1, 2, 3, 4, 5 ]` - every item has been moved\n// one higher to make room for the 'z'. If you removed an item, the new index\n// would be -1...\n//\n//     array.splice( 2, 2 );\n//\n// ...this would result in [ 0, 1, -1, -1, 2, 3 ].\n//\n// This information is used to enable fast, non-destructive shuffling of list\n// sections when you do e.g. `ractive.splice( 'items', 2, 2 );\n\nfunction getNewIndices ( length, methodName, args ) {\n\tvar spliceArguments, newIndices = [], removeStart, removeEnd, balance, i;\n\n\tspliceArguments = getSpliceEquivalent( length, methodName, args );\n\n\tif ( !spliceArguments ) {\n\t\treturn null; // TODO support reverse and sort?\n\t}\n\n\tbalance = ( spliceArguments.length - 2 ) - spliceArguments[1];\n\n\tremoveStart = Math.min( length, spliceArguments[0] );\n\tremoveEnd = removeStart + spliceArguments[1];\n\tnewIndices.startIndex = removeStart;\n\n\tfor ( i = 0; i < removeStart; i += 1 ) {\n\t\tnewIndices.push( i );\n\t}\n\n\tfor ( ; i < removeEnd; i += 1 ) {\n\t\tnewIndices.push( -1 );\n\t}\n\n\tfor ( ; i < length; i += 1 ) {\n\t\tnewIndices.push( i + balance );\n\t}\n\n\t// there is a net shift for the rest of the array starting with index + balance\n\tif ( balance !== 0 ) {\n\t\tnewIndices.touchedFrom = spliceArguments[0];\n\t} else {\n\t\tnewIndices.touchedFrom = length;\n\t}\n\n\treturn newIndices;\n}\n\n\n// The pop, push, shift an unshift methods can all be represented\n// as an equivalent splice\nfunction getSpliceEquivalent ( length, methodName, args ) {\n\tswitch ( methodName ) {\n\t\tcase 'splice':\n\t\t\tif ( args[0] !== undefined && args[0] < 0 ) {\n\t\t\t\targs[0] = length + Math.max( args[0], -length );\n\t\t\t}\n\n\t\t\tif ( args[0] === undefined ) args[0] = 0;\n\n\t\t\twhile ( args.length < 2 ) {\n\t\t\t\targs.push( length - args[0] );\n\t\t\t}\n\n\t\t\tif ( typeof args[1] !== 'number' ) {\n\t\t\t\targs[1] = length - args[0];\n\t\t\t}\n\n\t\t\t// ensure we only remove elements that exist\n\t\t\targs[1] = Math.min( args[1], length - args[0] );\n\n\t\t\treturn args;\n\n\t\tcase 'sort':\n\t\tcase 'reverse':\n\t\t\treturn null;\n\n\t\tcase 'pop':\n\t\t\tif ( length ) {\n\t\t\t\treturn [ length - 1, 1 ];\n\t\t\t}\n\t\t\treturn [ 0, 0 ];\n\n\t\tcase 'push':\n\t\t\treturn [ length, 0 ].concat( args );\n\n\t\tcase 'shift':\n\t\t\treturn [ 0, length ? 1 : 0 ];\n\n\t\tcase 'unshift':\n\t\t\treturn [ 0, 0 ].concat( args );\n\t}\n}\n\nvar arrayProto = Array.prototype;\n\nvar makeArrayMethod = function ( methodName ) {\n\tfunction path ( keypath ) {\n\t\tvar args = [], len = arguments.length - 1;\n\t\twhile ( len-- > 0 ) args[ len ] = arguments[ len + 1 ];\n\n\t\treturn model( this.viewmodel.joinAll( splitKeypath( keypath ) ), args );\n\t}\n\n\tfunction model ( mdl, args ) {\n\t\tvar array = mdl.get();\n\n\t\tif ( !isArray( array ) ) {\n\t\t\tif ( array === undefined ) {\n\t\t\t\tarray = [];\n\t\t\t\tvar result$1 = arrayProto[ methodName ].apply( array, args );\n\t\t\t\tvar promise$1 = runloop.start( this, true ).then( function () { return result$1; } );\n\t\t\t\tmdl.set( array );\n\t\t\t\trunloop.end();\n\t\t\t\treturn promise$1;\n\t\t\t} else {\n\t\t\t\tthrow new Error( (\"shuffle array method \" + methodName + \" called on non-array at \" + (mdl.getKeypath())) );\n\t\t\t}\n\t\t}\n\n\t\tvar newIndices = getNewIndices( array.length, methodName, args );\n\t\tvar result = arrayProto[ methodName ].apply( array, args );\n\n\t\tvar promise = runloop.start( this, true ).then( function () { return result; } );\n\t\tpromise.result = result;\n\n\t\tif ( newIndices ) {\n\t\t\tmdl.shuffle( newIndices );\n\t\t} else {\n\t\t\tmdl.set( result );\n\t\t}\n\n\t\trunloop.end();\n\n\t\treturn promise;\n\t}\n\n\treturn { path: path, model: model };\n};\n\nvar comparators = {};\n\nfunction getComparator ( option ) {\n\tif ( !option ) return null; // use existing arrays\n\tif ( option === true ) return JSON.stringify;\n\tif ( typeof option === 'function' ) return option;\n\n\tif ( typeof option === 'string' ) {\n\t\treturn comparators[ option ] || ( comparators[ option ] = function ( thing ) { return thing[ option ]; } );\n\t}\n\n\tthrow new Error( 'If supplied, options.compare must be a string, function, or `true`' ); // TODO link to docs\n}\n\nfunction merge$2 ( ractive, model, array, options ) {\n\tvar promise = runloop.start( ractive, true );\n\tvar value = model.get();\n\n\tif ( !isArray( value ) || !isArray( array ) ) {\n\t\tthrow new Error( 'You cannot merge an array with a non-array' );\n\t}\n\n\tvar comparator = getComparator( options && options.compare );\n\tmodel.merge( array, comparator );\n\n\trunloop.end();\n\treturn promise;\n}\n\nfunction thisRactive$merge ( keypath, array, options ) {\n\treturn merge$2( this, this.viewmodel.joinAll( splitKeypath( keypath ) ), array, options );\n}\n\nvar updateHook = new Hook( 'update' );\n\nfunction update$3 ( ractive, model ) {\n\tif ( model.parent && model.parent.wrapper ) return update$3( ractive, model.parent );\n\n\tvar promise = runloop.start( ractive, true );\n\n\tmodel.mark();\n\tmodel.registerChange( model.getKeypath(), model.get() );\n\n\tif ( !model.isRoot ) {\n\t\t// there may be unresolved refs that are now resolvable up the context tree\n\t\tvar parent = model.parent, key = model.key;\n\t\twhile ( parent && !parent.isRoot ) {\n\t\t\tif ( parent.clearUnresolveds ) parent.clearUnresolveds( key );\n\t\t\tkey = parent.key;\n\t\t\tparent = parent.parent;\n\t\t}\n\t}\n\n\t// notify upstream of changes\n\tmodel.notifyUpstream();\n\n\trunloop.end();\n\n\tupdateHook.fire( ractive, model );\n\n\treturn promise;\n}\n\nfunction Ractive$update ( keypath ) {\n\tif ( keypath ) keypath = splitKeypath( keypath );\n\n\treturn update$3( this, keypath ? this.viewmodel.joinAll( keypath ) : this.viewmodel );\n}\n\nvar modelPush = makeArrayMethod( 'push' ).model;\nvar modelPop = makeArrayMethod( 'pop' ).model;\nvar modelShift = makeArrayMethod( 'shift' ).model;\nvar modelUnshift = makeArrayMethod( 'unshift' ).model;\nvar modelSort = makeArrayMethod( 'sort' ).model;\nvar modelSplice = makeArrayMethod( 'splice' ).model;\nvar modelReverse = makeArrayMethod( 'reverse' ).model;\n\n// TODO: at some point perhaps this could support relative * keypaths?\nfunction build$1 ( el, keypath, value ) {\n\tvar sets = [];\n\n\t// set multiple keypaths in one go\n\tif ( isObject( keypath ) ) {\n\t\tfor ( var k in keypath ) {\n\t\t\tif ( keypath.hasOwnProperty( k ) ) {\n\t\t\t\tsets.push( [ findModel( el, k ).model, keypath[k] ] );\n\t\t\t}\n\t\t}\n\n\t}\n\t// set a single keypath\n\telse {\n\t\tsets.push( [ findModel( el, keypath ).model, value ] );\n\t}\n\n\treturn sets;\n}\n\n// get relative keypaths and values\nfunction get$1 ( keypath ) {\n\tif ( !keypath ) return this._element.parentFragment.findContext().get( true );\n\n\tvar model = resolveReference( this._element.parentFragment, keypath );\n\n\treturn model ? model.get( true ) : undefined;\n}\n\nfunction resolve$2 ( path, ractive ) {\n\tvar ref = findModel( this, path ), model = ref.model, instance = ref.instance;\n\treturn model ? model.getKeypath( ractive || instance ) : path;\n}\n\nfunction findModel ( el, path ) {\n\tvar frag = el._element.parentFragment;\n\n\tif ( typeof path !== 'string' ) {\n\t\treturn { model: frag.findContext(), instance: path };\n\t}\n\n\treturn { model: resolveReference( frag, path ), instance: frag.ractive };\n}\n\n// the usual mutation suspects\nfunction add$2 ( keypath, value ) {\n\tif ( value === undefined ) value = 1;\n\tif ( !isNumeric( value ) ) throw new Error( 'Bad arguments' );\n\treturn set$1( this.ractive, build$1( this, keypath, value ).map( function ( pair ) {\n\t\tvar model = pair[0], val = pair[1], value = model.get();\n\t\tif ( !isNumeric( val ) || !isNumeric( value ) ) throw new Error( 'Cannot add non-numeric value' );\n\t\treturn [ model, value + val ];\n\t}) );\n}\n\nfunction animate$2 ( keypath, value, options ) {\n\tvar model = findModel( this, keypath ).model;\n\treturn animate$1( this.ractive, model, value, options );\n}\n\nfunction link$1 ( source, dest ) {\n\tvar there = findModel( this, source ).model, here = findModel( this, dest ).model;\n\tvar promise = runloop.start( this.ractive, true );\n\there.link( there, source );\n\trunloop.end();\n\treturn promise;\n}\n\nfunction merge$1 ( keypath, array, options ) {\n\treturn merge$2( this.ractive, findModel( this, keypath ).model, array, options );\n}\n\nfunction pop ( keypath ) {\n\treturn modelPop( findModel( this, keypath ).model, [] );\n}\n\nfunction push ( keypath ) {\n\tvar values = [], len = arguments.length - 1;\n\twhile ( len-- > 0 ) values[ len ] = arguments[ len + 1 ];\n\n\treturn modelPush( findModel( this, keypath ).model, values );\n}\n\nfunction reverse ( keypath ) {\n\treturn modelReverse( findModel( this, keypath ).model, [] );\n}\n\nfunction set$2 ( keypath, value ) {\n\treturn set$1( this.ractive, build$1( this, keypath, value ) );\n}\n\nfunction shift ( keypath ) {\n\treturn modelShift( findModel( this, keypath ).model, [] );\n}\n\nfunction splice ( keypath, index, drop ) {\n\tvar add = [], len = arguments.length - 3;\n\twhile ( len-- > 0 ) add[ len ] = arguments[ len + 3 ];\n\n\tadd.unshift( index, drop );\n\treturn modelSplice( findModel( this, keypath ).model, add );\n}\n\nfunction sort ( keypath ) {\n\treturn modelSort( findModel( this, keypath ).model, [] );\n}\n\nfunction subtract ( keypath, value ) {\n\tif ( value === undefined ) value = 1;\n\tif ( !isNumeric( value ) ) throw new Error( 'Bad arguments' );\n\treturn set$1( this.ractive, build$1( this, keypath, value ).map( function ( pair ) {\n\t\tvar model = pair[0], val = pair[1], value = model.get();\n\t\tif ( !isNumeric( val ) || !isNumeric( value ) ) throw new Error( 'Cannot add non-numeric value' );\n\t\treturn [ model, value - val ];\n\t}) );\n}\n\nfunction toggle ( keypath ) {\n\tvar ref = findModel( this, keypath ), model = ref.model;\n\treturn set$1( this.ractive, [ [ model, !model.get() ] ] );\n}\n\nfunction unlink$1 ( dest ) {\n\tvar here = findModel( this, dest ).model;\n\tvar promise = runloop.start( this.ractive, true );\n\tif ( here.owner && here.owner._link ) here.owner.unlink();\n\trunloop.end();\n\treturn promise;\n}\n\nfunction unshift ( keypath ) {\n\tvar add = [], len = arguments.length - 1;\n\twhile ( len-- > 0 ) add[ len ] = arguments[ len + 1 ];\n\n\treturn modelUnshift( findModel( this, keypath ).model, add );\n}\n\nfunction update$2 ( keypath ) {\n\treturn update$3( this.ractive, findModel( this, keypath ).model );\n}\n\nfunction updateModel$1 ( keypath, cascade ) {\n\tvar ref = findModel( this, keypath ), model = ref.model;\n\tvar promise = runloop.start( this.ractive, true );\n\tmodel.updateFromBindings( cascade );\n\trunloop.end();\n\treturn promise;\n}\n\n// two-way binding related helpers\nfunction isBound () {\n\tvar ref = getBindingModel( this ), model = ref.model;\n\treturn !!model;\n}\n\nfunction getBindingPath ( ractive ) {\n\tvar ref = getBindingModel( this ), model = ref.model, instance = ref.instance;\n\tif ( model ) return model.getKeypath( ractive || instance );\n}\n\nfunction getBinding () {\n\tvar ref = getBindingModel( this ), model = ref.model;\n\tif ( model ) return model.get( true );\n}\n\nfunction getBindingModel ( ctx ) {\n\tvar el = ctx._element;\n\treturn { model: el.binding && el.binding.model, instance: el.parentFragment.ractive };\n}\n\nfunction setBinding ( value ) {\n\tvar ref = getBindingModel( this ), model = ref.model;\n\treturn set$1( this.ractive, [ [ model, value ] ] );\n}\n\n// deprecated getters\nfunction keypath () {\n\twarnOnceIfDebug( (\"Object property keypath is deprecated, please use resolve() instead.\") );\n\treturn this.resolve();\n}\n\nfunction rootpath () {\n\twarnOnceIfDebug( (\"Object property rootpath is deprecated, please use resolve( ractive.root ) instead.\") );\n\treturn this.resolve( this.ractive.root );\n}\n\nfunction context () {\n\twarnOnceIfDebug( (\"Object property context is deprecated, please use get() instead.\") );\n\treturn this.get();\n}\n\nfunction index () {\n\twarnOnceIfDebug( (\"Object property index is deprecated, you can use get( \\\"indexName\\\" ) instead.\") );\n\treturn gatherRefs( this._element.parentFragment ).index;\n}\n\nfunction key () {\n\twarnOnceIfDebug( (\"Object property key is deprecated, you can use get( \\\"keyName\\\" ) instead.\") );\n\treturn gatherRefs( this._element.parentFragment ).key;\n}\n\nfunction addHelpers ( obj, element ) {\n\tdefineProperties( obj, {\n\t\t_element: { value: element },\n\t\tractive: { value: element.parentFragment.ractive },\n\t\tresolve: { value: resolve$2 },\n\t\tget: { value: get$1 },\n\n\t\tadd: { value: add$2 },\n\t\tanimate: { value: animate$2 },\n\t\tlink: { value: link$1 },\n\t\tmerge: { value: merge$1 },\n\t\tpop: { value: pop },\n\t\tpush: { value: push },\n\t\treverse: { value: reverse },\n\t\tset: { value: set$2 },\n\t\tshift: { value: shift },\n\t\tsort: { value: sort },\n\t\tsplice: { value: splice },\n\t\tsubtract: { value: subtract },\n\t\ttoggle: { value: toggle },\n\t\tunlink: { value: unlink$1 },\n\t\tunshift: { value: unshift },\n\t\tupdate: { value: update$2 },\n\t\tupdateModel: { value: updateModel$1 },\n\n\t\tisBound: { value: isBound },\n\t\tgetBindingPath: { value: getBindingPath },\n\t\tgetBinding: { value: getBinding },\n\t\tsetBinding: { value: setBinding },\n\n\t\tkeypath: { get: keypath },\n\t\trootpath: { get: rootpath },\n\t\tcontext: { get: context },\n\t\tindex: { get: index },\n\t\tkey: { get: key }\n\t});\n\n\treturn obj;\n}\n\nvar query = doc && doc.querySelector;\n\nvar staticInfo = function( node ) {\n\tif ( typeof node === 'string' && query ) {\n\t\tnode = query.call( document, node );\n\t}\n\n\tif ( !node || !node._ractive ) return {};\n\n\tvar storage = node._ractive;\n\n\treturn addHelpers( {}, storage.proxy );\n};\n\nfunction getNodeInfo( node ) {\n\tif ( typeof node === 'string' ) {\n\t\tnode = this.find( node );\n\t}\n\n\treturn staticInfo( node );\n}\n\nvar insertHook = new Hook( 'insert' );\n\nfunction Ractive$insert ( target, anchor ) {\n\tif ( !this.fragment.rendered ) {\n\t\t// TODO create, and link to, documentation explaining this\n\t\tthrow new Error( 'The API has changed - you must call `ractive.render(target[, anchor])` to render your Ractive instance. Once rendered you can use `ractive.insert()`.' );\n\t}\n\n\ttarget = getElement( target );\n\tanchor = getElement( anchor ) || null;\n\n\tif ( !target ) {\n\t\tthrow new Error( 'You must specify a valid target to insert into' );\n\t}\n\n\ttarget.insertBefore( this.detach(), anchor );\n\tthis.el = target;\n\n\t( target.__ractive_instances__ || ( target.__ractive_instances__ = [] ) ).push( this );\n\tthis.isDetached = false;\n\n\tfireInsertHook( this );\n}\n\nfunction fireInsertHook( ractive ) {\n\tinsertHook.fire( ractive );\n\n\tractive.findAllComponents('*').forEach( function ( child ) {\n\t\tfireInsertHook( child.instance );\n\t});\n}\n\nfunction link$2( there, here ) {\n\tif ( here === there || (there + '.').indexOf( here + '.' ) === 0 || (here + '.').indexOf( there + '.' ) === 0 ) {\n\t\tthrow new Error( 'A keypath cannot be linked to itself.' );\n\t}\n\n\tvar promise = runloop.start();\n\tvar model;\n\n\t// may need to allow a mapping to resolve implicitly\n\tvar sourcePath = splitKeypath( there );\n\tif ( !this.viewmodel.has( sourcePath[0] ) && this.component ) {\n\t\tmodel = resolveReference( this.component.parentFragment, sourcePath[0] );\n\t\tmodel = model.joinAll( sourcePath.slice( 1 ) );\n\t}\n\n\tthis.viewmodel.joinAll( splitKeypath( here ) ).link( model || this.viewmodel.joinAll( sourcePath ), there );\n\n\trunloop.end();\n\n\treturn promise;\n}\n\nvar ReferenceResolver = function ReferenceResolver ( fragment, reference, callback ) {\n\tvar this$1 = this;\n\n\t\tthis.fragment = fragment;\n\tthis.reference = normalise( reference );\n\tthis.callback = callback;\n\n\tthis.keys = splitKeypath( reference );\n\tthis.resolved = false;\n\n\tthis.contexts = [];\n\n\t// TODO the consumer should take care of addUnresolved\n\t// we attach to all the contexts between here and the root\n\t// - whenever their values change, they can quickly\n\t// check to see if we can resolve\n\twhile ( fragment ) {\n\t\tif ( fragment.context ) {\n\t\t\tfragment.context.addUnresolved( this$1.keys[0], this$1 );\n\t\t\tthis$1.contexts.push( fragment.context );\n\t\t}\n\n\t\tfragment = fragment.componentParent || fragment.parent;\n\t}\n};\n\nReferenceResolver.prototype.attemptResolution = function attemptResolution () {\n\tif ( this.resolved ) return;\n\n\tvar model = resolveAmbiguousReference( this.fragment, this.reference );\n\n\tif ( model ) {\n\t\tthis.resolved = true;\n\t\tthis.callback( model );\n\t}\n};\n\nReferenceResolver.prototype.forceResolution = function forceResolution () {\n\tif ( this.resolved ) return;\n\n\tvar model = this.fragment.findContext().joinAll( this.keys );\n\tthis.callback( model );\n\tthis.resolved = true;\n};\n\nReferenceResolver.prototype.rebinding = function rebinding ( next, previous ) {\n\tvar this$1 = this;\n\n\t\tif ( previous ) previous.removeUnresolved( this.keys[0], this );\n\tif ( next ) runloop.scheduleTask( function () { return next.addUnresolved( this$1.keys[0], this$1 ); } );\n};\n\nReferenceResolver.prototype.unbind = function unbind () {\n\tvar this$1 = this;\n\n\t\tif ( this.fragment ) removeFromArray( this.fragment.unresolved, this );\n\n\tif ( this.resolved ) return;\n\n\tthis.contexts.forEach( function ( c ) { return c.removeUnresolved( this$1.keys[0], this$1 ); } );\n};\n\nfunction observe ( keypath, callback, options ) {\n\tvar this$1 = this;\n\n\tvar observers = [];\n\tvar map;\n\n\tif ( isObject( keypath ) ) {\n\t\tmap = keypath;\n\t\toptions = callback || {};\n\n\t\tObject.keys( map ).forEach( function ( keypath ) {\n\t\t\tvar callback = map[ keypath ];\n\n\t\t\tkeypath.split( ' ' ).forEach( function ( keypath ) {\n\t\t\t\tobservers.push( createObserver( this$1, keypath, callback, options ) );\n\t\t\t});\n\t\t});\n\t}\n\n\telse {\n\t\tvar keypaths;\n\n\t\tif ( typeof keypath === 'function' ) {\n\t\t\toptions = callback;\n\t\t\tcallback = keypath;\n\t\t\tkeypaths = [ '' ];\n\t\t} else {\n\t\t\tkeypaths = keypath.split( ' ' );\n\t\t}\n\n\t\tkeypaths.forEach( function ( keypath ) {\n\t\t\tobservers.push( createObserver( this$1, keypath, callback, options || {} ) );\n\t\t});\n\t}\n\n\t// add observers to the Ractive instance, so they can be\n\t// cancelled on ractive.teardown()\n\tthis._observers.push.apply( this._observers, observers );\n\n\treturn {\n\t\tcancel: function () {\n\t\t\tobservers.forEach( function ( observer ) {\n\t\t\t\tremoveFromArray ( this$1._observers, observer );\n\t\t\t\tobserver.cancel();\n\t\t\t} );\n\t\t}\n\t};\n}\n\nfunction createObserver ( ractive, keypath, callback, options ) {\n\tvar viewmodel = ractive.viewmodel;\n\n\tvar keys = splitKeypath( keypath );\n\tvar wildcardIndex = keys.indexOf( '*' );\n\toptions.keypath = keypath;\n\n\t// normal keypath - no wildcards\n\tif ( !~wildcardIndex ) {\n\t\tvar key = keys[0];\n\t\tvar model;\n\n\t\t// if not the root model itself, check if viewmodel has key.\n\t\tif ( key !== '' && !viewmodel.has( key ) ) {\n\t\t\t// if this is an inline component, we may need to create an implicit mapping\n\t\t\tif ( ractive.component && !ractive.isolated ) {\n\t\t\t\tmodel = resolveReference( ractive.component.parentFragment, key );\n\t\t\t\tif ( model ) {\n\t\t\t\t\tviewmodel.map( key, model );\n\t\t\t\t\tmodel = viewmodel.joinAll( keys );\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tmodel = viewmodel.joinAll( keys );\n\t\t}\n\n\t\treturn new Observer( ractive, model, callback, options );\n\t}\n\n\t// pattern observers - more complex case\n\tvar baseModel = wildcardIndex === 0 ?\n\t\tviewmodel :\n\t\tviewmodel.joinAll( keys.slice( 0, wildcardIndex ) );\n\n\treturn new PatternObserver( ractive, baseModel, keys.splice( wildcardIndex ), callback, options );\n}\n\nvar Observer = function Observer ( ractive, model, callback, options ) {\n\tvar this$1 = this;\n\n\t\tthis.context = options.context || ractive;\n\tthis.callback = callback;\n\tthis.ractive = ractive;\n\n\tif ( model ) this.resolved( model );\n\telse {\n\t\tthis.keypath = options.keypath;\n\t\tthis.resolver = new ReferenceResolver( ractive.fragment, options.keypath, function ( model ) {\n\t\t\tthis$1.resolved( model );\n\t\t});\n\t}\n\n\tif ( options.init !== false ) {\n\t\tthis.dirty = true;\n\t\tthis.dispatch();\n\t} else {\n\t\tthis.oldValue = this.newValue;\n\t}\n\n\tthis.defer = options.defer;\n\tthis.once = options.once;\n\tthis.strict = options.strict;\n\n\tthis.dirty = false;\n};\n\nObserver.prototype.cancel = function cancel () {\n\tthis.cancelled = true;\n\tif ( this.model ) {\n\t\tthis.model.unregister( this );\n\t} else {\n\t\tthis.resolver.unbind();\n\t}\n};\n\nObserver.prototype.dispatch = function dispatch () {\n\tif ( !this.cancelled ) {\n\t\tthis.callback.call( this.context, this.newValue, this.oldValue, this.keypath );\n\t\tthis.oldValue = this.model ? this.model.get() : this.newValue;\n\t\tthis.dirty = false;\n\t}\n};\n\nObserver.prototype.handleChange = function handleChange () {\n\tvar this$1 = this;\n\n\t\tif ( !this.dirty ) {\n\t\tvar newValue = this.model.get();\n\t\tif ( isEqual( newValue, this.oldValue ) ) return;\n\n\t\tthis.newValue = newValue;\n\n\t\tif ( this.strict && this.newValue === this.oldValue ) return;\n\n\t\trunloop.addObserver( this, this.defer );\n\t\tthis.dirty = true;\n\n\t\tif ( this.once ) runloop.scheduleTask( function () { return this$1.cancel(); } );\n\t}\n};\n\nObserver.prototype.rebinding = function rebinding ( next, previous ) {\n\tvar this$1 = this;\n\n\t\tnext = rebindMatch( this.keypath, next, previous );\n\t// TODO: set up a resolver if next is undefined?\n\tif ( next === this.model ) return false;\n\n\tif ( this.model ) this.model.unregister( this );\n\tif ( next ) next.addShuffleTask( function () { return this$1.resolved( next ); } );\n};\n\nObserver.prototype.resolved = function resolved ( model ) {\n\tthis.model = model;\n\tthis.keypath = model.getKeypath( this.ractive );\n\n\tthis.oldValue = undefined;\n\tthis.newValue = model.get();\n\n\tmodel.register( this );\n};\n\nvar PatternObserver = function PatternObserver ( ractive, baseModel, keys, callback, options ) {\n\tvar this$1 = this;\n\n\t\tthis.context = options.context || ractive;\n\tthis.ractive = ractive;\n\tthis.baseModel = baseModel;\n\tthis.keys = keys;\n\tthis.callback = callback;\n\n\tvar pattern = keys.join( '\\\\.' ).replace( /\\*/g, '(.+)' );\n\tvar baseKeypath = baseModel.getKeypath( ractive );\n\tthis.pattern = new RegExp( (\"^\" + (baseKeypath ? baseKeypath + '\\\\.' : '') + \"\" + pattern + \"$\") );\n\n\tthis.oldValues = {};\n\tthis.newValues = {};\n\n\tthis.defer = options.defer;\n\tthis.once = options.once;\n\tthis.strict = options.strict;\n\n\tthis.dirty = false;\n\tthis.changed = [];\n\tthis.partial = false;\n\n\tvar models = baseModel.findMatches( this.keys );\n\n\tmodels.forEach( function ( model ) {\n\t\tthis$1.newValues[ model.getKeypath( this$1.ractive ) ] = model.get();\n\t});\n\n\tif ( options.init !== false ) {\n\t\tthis.dispatch();\n\t} else {\n\t\tthis.oldValues = this.newValues;\n\t}\n\n\tbaseModel.registerPatternObserver( this );\n};\n\nPatternObserver.prototype.cancel = function cancel () {\n\tthis.baseModel.unregisterPatternObserver( this );\n};\n\nPatternObserver.prototype.dispatch = function dispatch () {\n\tvar this$1 = this;\n\n\t\tObject.keys( this.newValues ).forEach( function ( keypath ) {\n\t\tif ( this$1.newKeys && !this$1.newKeys[ keypath ] ) return;\n\n\t\tvar newValue = this$1.newValues[ keypath ];\n\t\tvar oldValue = this$1.oldValues[ keypath ];\n\n\t\tif ( this$1.strict && newValue === oldValue ) return;\n\t\tif ( isEqual( newValue, oldValue ) ) return;\n\n\t\tvar args = [ newValue, oldValue, keypath ];\n\t\tif ( keypath ) {\n\t\t\tvar wildcards = this$1.pattern.exec( keypath );\n\t\t\tif ( wildcards ) {\n\t\t\t\targs = args.concat( wildcards.slice( 1 ) );\n\t\t\t}\n\t\t}\n\n\t\tthis$1.callback.apply( this$1.context, args );\n\t});\n\n\tif ( this.partial ) {\n\t\tfor ( var k in this.newValues ) {\n\t\t\tthis.oldValues[k] = this.newValues[k];\n\t\t}\n\t} else {\n\t\tthis.oldValues = this.newValues;\n\t}\n\n\tthis.newKeys = null;\n\tthis.dirty = false;\n};\n\nPatternObserver.prototype.notify = function notify ( key ) {\n\tthis.changed.push( key );\n};\n\nPatternObserver.prototype.shuffle = function shuffle ( newIndices ) {\n\tvar this$1 = this;\n\n\t\tif ( !isArray( this.baseModel.value ) ) return;\n\n\tvar base = this.baseModel.getKeypath( this.ractive );\n\tvar max = this.baseModel.value.length;\n\tvar suffix = this.keys.length > 1 ? '.' + this.keys.slice( 1 ).join( '.' ) : '';\n\n\tthis.newKeys = {};\n\tfor ( var i = 0; i < newIndices.length; i++ ) {\n\t\tif ( newIndices[ i ] === -1 || newIndices[ i ] === i ) continue;\n\t\tthis$1.newKeys[ (\"\" + base + \".\" + i + \"\" + suffix) ] = true;\n\t}\n\n\tfor ( var i$1 = newIndices.touchedFrom; i$1 < max; i$1++ ) {\n\t\tthis$1.newKeys[ (\"\" + base + \".\" + i$1 + \"\" + suffix) ] = true;\n\t}\n};\n\nPatternObserver.prototype.handleChange = function handleChange () {\n\tvar this$1 = this;\n\n\t\tif ( !this.dirty || this.changed.length ) {\n\t\tif ( !this.dirty ) this.newValues = {};\n\n\t\t// handle case where previously extant keypath no longer exists -\n\t\t// observer should still fire, with undefined as new value\n\t\t// TODO huh. according to the test suite that's not the case...\n\t\t// Object.keys( this.oldValues ).forEach( keypath => {\n\t\t// this.newValues[ keypath ] = undefined;\n\t\t// });\n\n\t\tif ( !this.changed.length ) {\n\t\t\tthis.baseModel.findMatches( this.keys ).forEach( function ( model ) {\n\t\t\t\tvar keypath = model.getKeypath( this$1.ractive );\n\t\t\t\tthis$1.newValues[ keypath ] = model.get();\n\t\t\t});\n\t\t\tthis.partial = false;\n\t\t} else {\n\t\t\tvar ok = this.baseModel.isRoot ?\n\t\t\t\tthis.changed :\n\t\t\t\tthis.changed.map( function ( key ) { return this$1.baseModel.getKeypath( this$1.ractive ) + '.' + escapeKey( key ); } );\n\n\t\t\tthis.baseModel.findMatches( this.keys ).forEach( function ( model ) {\n\t\t\t\tvar keypath = model.getKeypath( this$1.ractive );\n\t\t\t\t// is this model on a changed keypath?\n\t\t\t\tif ( ok.filter( function ( k ) { return keypath.indexOf( k ) === 0 && ( keypath.length === k.length || keypath[k.length] === '.' ); } ).length ) {\n\t\t\t\t\tthis$1.newValues[ keypath ] = model.get();\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.partial = true;\n\t\t}\n\n\t\trunloop.addObserver( this, this.defer );\n\t\tthis.dirty = true;\n\t\tthis.changed.length = 0;\n\n\t\tif ( this.once ) this.cancel();\n\t}\n};\n\nfunction observeList ( keypath, callback, options ) {\n\tif ( typeof keypath !== 'string' ) {\n\t\tthrow new Error( 'ractive.observeList() must be passed a string as its first argument' );\n\t}\n\n\tvar model = this.viewmodel.joinAll( splitKeypath( keypath ) );\n\tvar observer = new ListObserver( this, model, callback, options || {} );\n\n\t// add observer to the Ractive instance, so it can be\n\t// cancelled on ractive.teardown()\n\tthis._observers.push( observer );\n\n\treturn {\n\t\tcancel: function () {\n\t\t\tobserver.cancel();\n\t\t}\n\t};\n}\n\nfunction negativeOne () {\n\treturn -1;\n}\n\nvar ListObserver = function ListObserver ( context, model, callback, options ) {\n\tthis.context = context;\n\tthis.model = model;\n\tthis.keypath = model.getKeypath();\n\tthis.callback = callback;\n\n\tthis.pending = null;\n\n\tmodel.register( this );\n\n\tif ( options.init !== false ) {\n\t\tthis.sliced = [];\n\t\tthis.shuffle([]);\n\t\tthis.handleChange();\n\t} else {\n\t\tthis.sliced = this.slice();\n\t}\n};\n\nListObserver.prototype.handleChange = function handleChange () {\n\tif ( this.pending ) {\n\t\t// post-shuffle\n\t\tthis.callback( this.pending );\n\t\tthis.pending = null;\n\t}\n\n\telse {\n\t\t// entire array changed\n\t\tthis.shuffle( this.sliced.map( negativeOne ) );\n\t\tthis.handleChange();\n\t}\n};\n\nListObserver.prototype.shuffle = function shuffle ( newIndices ) {\n\tvar this$1 = this;\n\n\t\tvar newValue = this.slice();\n\n\tvar inserted = [];\n\tvar deleted = [];\n\tvar start;\n\n\tvar hadIndex = {};\n\n\tnewIndices.forEach( function ( newIndex, oldIndex ) {\n\t\thadIndex[ newIndex ] = true;\n\n\t\tif ( newIndex !== oldIndex && start === undefined ) {\n\t\t\tstart = oldIndex;\n\t\t}\n\n\t\tif ( newIndex === -1 ) {\n\t\t\tdeleted.push( this$1.sliced[ oldIndex ] );\n\t\t}\n\t});\n\n\tif ( start === undefined ) start = newIndices.length;\n\n\tvar len = newValue.length;\n\tfor ( var i = 0; i < len; i += 1 ) {\n\t\tif ( !hadIndex[i] ) inserted.push( newValue[i] );\n\t}\n\n\tthis.pending = { inserted: inserted, deleted: deleted, start: start };\n\tthis.sliced = newValue;\n};\n\nListObserver.prototype.slice = function slice () {\n\tvar value = this.model.get();\n\treturn isArray( value ) ? value.slice() : [];\n};\n\nvar onceOptions = { init: false, once: true };\n\nfunction observeOnce ( keypath, callback, options ) {\n\tif ( isObject( keypath ) || typeof keypath === 'function' ) {\n\t\toptions = extend$1( callback || {}, onceOptions );\n\t\treturn this.observe( keypath, options );\n\t}\n\n\toptions = extend$1( options || {}, onceOptions );\n\treturn this.observe( keypath, callback, options );\n}\n\nvar trim = function ( str ) { return str.trim(); };\n\nvar notEmptyString = function ( str ) { return str !== ''; };\n\nfunction Ractive$off ( eventName, callback ) {\n\t// if no arguments specified, remove all callbacks\n\tvar this$1 = this;\n\n\tif ( !eventName ) {\n\t\t// TODO use this code instead, once the following issue has been resolved\n\t\t// in PhantomJS (tests are unpassable otherwise!)\n\t\t// https://github.com/ariya/phantomjs/issues/11856\n\t\t// defineProperty( this, '_subs', { value: create( null ), configurable: true });\n\t\tfor ( eventName in this._subs ) {\n\t\t\tdelete this._subs[ eventName ];\n\t\t}\n\t}\n\n\telse {\n\t\t// Handle multiple space-separated event names\n\t\tvar eventNames = eventName.split( ' ' ).map( trim ).filter( notEmptyString );\n\n\t\teventNames.forEach( function ( eventName ) {\n\t\t\tvar subscribers = this$1._subs[ eventName ];\n\n\t\t\t// If we have subscribers for this event...\n\t\t\tif ( subscribers ) {\n\t\t\t\t// ...if a callback was specified, only remove that\n\t\t\t\tif ( callback ) {\n\t\t\t\t\tvar index = subscribers.indexOf( callback );\n\t\t\t\t\tif ( index !== -1 ) {\n\t\t\t\t\t\tsubscribers.splice( index, 1 );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// ...otherwise remove all callbacks\n\t\t\t\telse {\n\t\t\t\t\tthis$1._subs[ eventName ] = [];\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\treturn this;\n}\n\nfunction Ractive$on ( eventName, callback ) {\n\t// allow multiple listeners to be bound in one go\n\tvar this$1 = this;\n\n\tif ( typeof eventName === 'object' ) {\n\t\tvar listeners = [];\n\t\tvar n;\n\n\t\tfor ( n in eventName ) {\n\t\t\tif ( eventName.hasOwnProperty( n ) ) {\n\t\t\t\tlisteners.push( this.on( n, eventName[ n ] ) );\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tcancel: function () {\n\t\t\t\tvar listener;\n\t\t\t\twhile ( listener = listeners.pop() ) listener.cancel();\n\t\t\t}\n\t\t};\n\t}\n\n\t// Handle multiple space-separated event names\n\tvar eventNames = eventName.split( ' ' ).map( trim ).filter( notEmptyString );\n\n\teventNames.forEach( function ( eventName ) {\n\t\t( this$1._subs[ eventName ] || ( this$1._subs[ eventName ] = [] ) ).push( callback );\n\t});\n\n\treturn {\n\t\tcancel: function () { return this$1.off( eventName, callback ); }\n\t};\n}\n\nfunction Ractive$once ( eventName, handler ) {\n\tvar listener = this.on( eventName, function () {\n\t\thandler.apply( this, arguments );\n\t\tlistener.cancel();\n\t});\n\n\t// so we can still do listener.cancel() manually\n\treturn listener;\n}\n\nvar pop$1 = makeArrayMethod( 'pop' ).path;\n\nvar push$1 = makeArrayMethod( 'push' ).path;\n\nvar PREFIX = '/* Ractive.js component styles */';\n\n// Holds current definitions of styles.\nvar styleDefinitions = [];\n\n// Flag to tell if we need to update the CSS\nvar isDirty = false;\n\n// These only make sense on the browser. See additional setup below.\nvar styleElement = null;\nvar useCssText = null;\n\nfunction addCSS( styleDefinition ) {\n\tstyleDefinitions.push( styleDefinition );\n\tisDirty = true;\n}\n\nfunction applyCSS() {\n\n\t// Apply only seems to make sense when we're in the DOM. Server-side renders\n\t// can call toCSS to get the updated CSS.\n\tif ( !doc || !isDirty ) return;\n\n\tif ( useCssText ) {\n\t\tstyleElement.styleSheet.cssText = getCSS( null );\n\t} else {\n\t\tstyleElement.innerHTML = getCSS( null );\n\t}\n\n\tisDirty = false;\n}\n\nfunction getCSS( cssIds ) {\n\n\tvar filteredStyleDefinitions = cssIds ? styleDefinitions.filter( function ( style ) { return ~cssIds.indexOf( style.id ); } ) : styleDefinitions;\n\n\treturn filteredStyleDefinitions.reduce( function ( styles, style ) { return (\"\" + styles + \"\\n\\n/* {\" + (style.id) + \"} */\\n\" + (style.styles)); }, PREFIX );\n\n}\n\n// If we're on the browser, additional setup needed.\nif ( doc && ( !styleElement || !styleElement.parentNode ) ) {\n\n\tstyleElement = doc.createElement( 'style' );\n\tstyleElement.type = 'text/css';\n\n\tdoc.getElementsByTagName( 'head' )[ 0 ].appendChild( styleElement );\n\n\tuseCssText = !!styleElement.styleSheet;\n}\n\nvar renderHook = new Hook( 'render' );\nvar completeHook = new Hook( 'complete' );\n\nfunction render$2 ( ractive, target, anchor, occupants ) {\n\t// if `noIntro` is `true`, temporarily disable transitions\n\tvar transitionsEnabled = ractive.transitionsEnabled;\n\tif ( ractive.noIntro ) ractive.transitionsEnabled = false;\n\n\tvar promise = runloop.start( ractive, true );\n\trunloop.scheduleTask( function () { return renderHook.fire( ractive ); }, true );\n\n\tif ( ractive.fragment.rendered ) {\n\t\tthrow new Error( 'You cannot call ractive.render() on an already rendered instance! Call ractive.unrender() first' );\n\t}\n\n\tanchor = getElement( anchor ) || ractive.anchor;\n\n\tractive.el = target;\n\tractive.anchor = anchor;\n\n\t// ensure encapsulated CSS is up-to-date\n\tif ( ractive.cssId ) applyCSS();\n\n\tif ( target ) {\n\t\t( target.__ractive_instances__ || ( target.__ractive_instances__ = [] ) ).push( ractive );\n\n\t\tif ( anchor ) {\n\t\t\tvar docFrag = doc.createDocumentFragment();\n\t\t\tractive.fragment.render( docFrag );\n\t\t\ttarget.insertBefore( docFrag, anchor );\n\t\t} else {\n\t\t\tractive.fragment.render( target, occupants );\n\t\t}\n\t}\n\n\trunloop.end();\n\tractive.transitionsEnabled = transitionsEnabled;\n\n\treturn promise.then( function () { return completeHook.fire( ractive ); } );\n}\n\nfunction Ractive$render ( target, anchor ) {\n\tif ( this.torndown ) {\n\t\twarnIfDebug( 'ractive.render() was called on a Ractive instance that was already torn down' );\n\t\treturn Promise.resolve();\n\t}\n\n\ttarget = getElement( target ) || this.el;\n\n\tif ( !this.append && target ) {\n\t\t// Teardown any existing instances *before* trying to set up the new one -\n\t\t// avoids certain weird bugs\n\t\tvar others = target.__ractive_instances__;\n\t\tif ( others ) others.forEach( teardown$1$1 );\n\n\t\t// make sure we are the only occupants\n\t\tif ( !this.enhance ) {\n\t\t\ttarget.innerHTML = ''; // TODO is this quicker than removeChild? Initial research inconclusive\n\t\t}\n\t}\n\n\tvar occupants = this.enhance ? toArray( target.childNodes ) : null;\n\tvar promise = render$2( this, target, anchor, occupants );\n\n\tif ( occupants ) {\n\t\twhile ( occupants.length ) target.removeChild( occupants.pop() );\n\t}\n\n\treturn promise;\n}\n\nvar adaptConfigurator = {\n\textend: function ( Parent, proto, options ) {\n\t\tproto.adapt = combine( proto.adapt, ensureArray( options.adapt ) );\n\t},\n\n\tinit: function () {}\n};\n\nfunction combine ( a, b ) {\n\tvar c = a.slice();\n\tvar i = b.length;\n\n\twhile ( i-- ) {\n\t\tif ( !~c.indexOf( b[i] ) ) {\n\t\t\tc.push( b[i] );\n\t\t}\n\t}\n\n\treturn c;\n}\n\nvar selectorsPattern = /(?:^|\\})?\\s*([^\\{\\}]+)\\s*\\{/g;\nvar commentsPattern = /\\/\\*.*?\\*\\//g;\nvar selectorUnitPattern = /((?:(?:\\[[^\\]+]\\])|(?:[^\\s\\+\\>~:]))+)((?:::?[^\\s\\+\\>\\~\\(:]+(?:\\([^\\)]+\\))?)*\\s*[\\s\\+\\>\\~]?)\\s*/g;\nvar excludePattern = /^(?:@|\\d+%)/;\nvar dataRvcGuidPattern = /\\[data-ractive-css~=\"\\{[a-z0-9-]+\\}\"]/g;\n\nfunction trim$1 ( str ) {\n\treturn str.trim();\n}\n\nfunction extractString ( unit ) {\n\treturn unit.str;\n}\n\nfunction transformSelector ( selector, parent ) {\n\tvar selectorUnits = [];\n\tvar match;\n\n\twhile ( match = selectorUnitPattern.exec( selector ) ) {\n\t\tselectorUnits.push({\n\t\t\tstr: match[0],\n\t\t\tbase: match[1],\n\t\t\tmodifiers: match[2]\n\t\t});\n\t}\n\n\t// For each simple selector within the selector, we need to create a version\n\t// that a) combines with the id, and b) is inside the id\n\tvar base = selectorUnits.map( extractString );\n\n\tvar transformed = [];\n\tvar i = selectorUnits.length;\n\n\twhile ( i-- ) {\n\t\tvar appended = base.slice();\n\n\t\t// Pseudo-selectors should go after the attribute selector\n\t\tvar unit = selectorUnits[i];\n\t\tappended[i] = unit.base + parent + unit.modifiers || '';\n\n\t\tvar prepended = base.slice();\n\t\tprepended[i] = parent + ' ' + prepended[i];\n\n\t\ttransformed.push( appended.join( ' ' ), prepended.join( ' ' ) );\n\t}\n\n\treturn transformed.join( ', ' );\n}\n\nfunction transformCss ( css, id ) {\n\tvar dataAttr = \"[data-ractive-css~=\\\"{\" + id + \"}\\\"]\";\n\n\tvar transformed;\n\n\tif ( dataRvcGuidPattern.test( css ) ) {\n\t\ttransformed = css.replace( dataRvcGuidPattern, dataAttr );\n\t} else {\n\t\ttransformed = css\n\t\t.replace( commentsPattern, '' )\n\t\t.replace( selectorsPattern, function ( match, $1 ) {\n\t\t\t// don't transform at-rules and keyframe declarations\n\t\t\tif ( excludePattern.test( $1 ) ) return match;\n\n\t\t\tvar selectors = $1.split( ',' ).map( trim$1 );\n\t\t\tvar transformed = selectors\n\t\t\t\t.map( function ( selector ) { return transformSelector( selector, dataAttr ); } )\n\t\t\t\t.join( ', ' ) + ' ';\n\n\t\t\treturn match.replace( $1, transformed );\n\t\t});\n\t}\n\n\treturn transformed;\n}\n\nfunction s4() {\n\treturn Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1);\n}\n\nfunction uuid() {\n\treturn s4() + s4() + '-' + s4() + '-' + s4() + '-' + s4() + '-' + s4() + s4() + s4();\n}\n\nvar cssConfigurator = {\n\tname: 'css',\n\n\t// Called when creating a new component definition\n\textend: function ( Parent, proto, options ) {\n\t\tif ( !options.css ) return;\n\n\t\tvar id = uuid();\n\t\tvar styles = options.noCssTransform ? options.css : transformCss( options.css, id );\n\n\t\tproto.cssId = id;\n\n\t\taddCSS( { id: id, styles: styles } );\n\n\t},\n\n\t// Called when creating a new component instance\n\tinit: function ( Parent, target, options ) {\n\t\tif ( !options.css ) return;\n\n\t\twarnIfDebug( (\"\\nThe css option is currently not supported on a per-instance basis and will be discarded. Instead, we recommend instantiating from a component definition with a css option.\\n\\nconst Component = Ractive.extend({\\n\\t...\\n\\tcss: '/* your css */',\\n\\t...\\n});\\n\\nconst componentInstance = new Component({ ... })\\n\\t\\t\") );\n\t}\n\n};\n\nfunction validate ( data ) {\n\t// Warn if userOptions.data is a non-POJO\n\tif ( data && data.constructor !== Object ) {\n\t\tif ( typeof data === 'function' ) {\n\t\t\t// TODO do we need to support this in the new Ractive() case?\n\t\t} else if ( typeof data !== 'object' ) {\n\t\t\tfatal( (\"data option must be an object or a function, `\" + data + \"` is not valid\") );\n\t\t} else {\n\t\t\twarnIfDebug( 'If supplied, options.data should be a plain JavaScript object - using a non-POJO as the root object may work, but is discouraged' );\n\t\t}\n\t}\n}\n\nvar dataConfigurator = {\n\tname: 'data',\n\n\textend: function ( Parent, proto, options ) {\n\t\tvar key;\n\t\tvar value;\n\n\t\t// check for non-primitives, which could cause mutation-related bugs\n\t\tif ( options.data && isObject( options.data ) ) {\n\t\t\tfor ( key in options.data ) {\n\t\t\t\tvalue = options.data[ key ];\n\n\t\t\t\tif ( value && typeof value === 'object' ) {\n\t\t\t\t\tif ( isObject( value ) || isArray( value ) ) {\n\t\t\t\t\t\twarnIfDebug( (\"Passing a `data` option with object and array properties to Ractive.extend() is discouraged, as mutating them is likely to cause bugs. Consider using a data function instead:\\n\\n  // this...\\n  data: function () {\\n    return {\\n      myObject: {}\\n    };\\n  })\\n\\n  // instead of this:\\n  data: {\\n    myObject: {}\\n  }\") );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tproto.data = combine$1( proto.data, options.data );\n\t},\n\n\tinit: function ( Parent, ractive, options ) {\n\t\tvar result = combine$1( Parent.prototype.data, options.data );\n\n\t\tif ( typeof result === 'function' ) result = result.call( ractive );\n\n\t\t// bind functions to the ractive instance at the top level,\n\t\t// unless it's a non-POJO (in which case alarm bells should ring)\n\t\tif ( result && result.constructor === Object ) {\n\t\t\tfor ( var prop in result ) {\n\t\t\t\tif ( typeof result[ prop ] === 'function' ) result[ prop ] = bind$1$1( result[ prop ], ractive );\n\t\t\t}\n\t\t}\n\n\t\treturn result || {};\n\t},\n\n\treset: function ( ractive ) {\n\t\tvar result = this.init( ractive.constructor, ractive, ractive.viewmodel );\n\t\tractive.viewmodel.root.set( result );\n\t\treturn true;\n\t}\n};\n\nfunction combine$1 ( parentValue, childValue ) {\n\tvalidate( childValue );\n\n\tvar parentIsFn = typeof parentValue === 'function';\n\tvar childIsFn = typeof childValue === 'function';\n\n\t// Very important, otherwise child instance can become\n\t// the default data object on Ractive or a component.\n\t// then ractive.set() ends up setting on the prototype!\n\tif ( !childValue && !parentIsFn ) {\n\t\tchildValue = {};\n\t}\n\n\t// Fast path, where we just need to copy properties from\n\t// parent to child\n\tif ( !parentIsFn && !childIsFn ) {\n\t\treturn fromProperties( childValue, parentValue );\n\t}\n\n\treturn function () {\n\t\tvar child = childIsFn ? callDataFunction( childValue, this ) : childValue;\n\t\tvar parent = parentIsFn ? callDataFunction( parentValue, this ) : parentValue;\n\n\t\treturn fromProperties( child, parent );\n\t};\n}\n\nfunction callDataFunction ( fn, context ) {\n\tvar data = fn.call( context );\n\n\tif ( !data ) return;\n\n\tif ( typeof data !== 'object' ) {\n\t\tfatal( 'Data function must return an object' );\n\t}\n\n\tif ( data.constructor !== Object ) {\n\t\twarnOnceIfDebug( 'Data function returned something other than a plain JavaScript object. This might work, but is strongly discouraged' );\n\t}\n\n\treturn data;\n}\n\nfunction fromProperties ( primary, secondary ) {\n\tif ( primary && secondary ) {\n\t\tfor ( var key in secondary ) {\n\t\t\tif ( !( key in primary ) ) {\n\t\t\t\tprimary[ key ] = secondary[ key ];\n\t\t\t}\n\t\t}\n\n\t\treturn primary;\n\t}\n\n\treturn primary || secondary;\n}\n\nvar TEMPLATE_VERSION = 4;\n\nvar pattern = /\\$\\{([^\\}]+)\\}/g;\n\nfunction fromExpression ( body, length ) {\n\tif ( length === void 0 ) length = 0;\n\n\tvar args = new Array( length );\n\n\twhile ( length-- ) {\n\t\targs[length] = \"_\" + length;\n\t}\n\n\t// Functions created directly with new Function() look like this:\n\t//     function anonymous (_0 /**/) { return _0*2 }\n\t//\n\t// With this workaround, we get a little more compact:\n\t//     function (_0){return _0*2}\n\treturn new Function( [], (\"return function (\" + (args.join(',')) + \"){return(\" + body + \");};\") )();\n}\n\nfunction fromComputationString ( str, bindTo ) {\n\tvar hasThis;\n\n\tvar functionBody = 'return (' + str.replace( pattern, function ( match, keypath ) {\n\t\thasThis = true;\n\t\treturn (\"__ractive.get(\\\"\" + keypath + \"\\\")\");\n\t}) + ');';\n\n\tif ( hasThis ) functionBody = \"var __ractive = this; \" + functionBody;\n\tvar fn = new Function( functionBody );\n\treturn hasThis ? fn.bind( bindTo ) : fn;\n}\n\nvar functions = create( null );\n\nfunction getFunction ( str, i ) {\n\tif ( functions[ str ] ) return functions[ str ];\n\treturn functions[ str ] = createFunction( str, i );\n}\n\nfunction addFunctions( template ) {\n\tif ( !template ) return;\n\n\tvar exp = template.e;\n\n\tif ( !exp ) return;\n\n\tObject.keys( exp ).forEach( function ( str ) {\n\t\tif ( functions[ str ] ) return;\n\t\tfunctions[ str ] = exp[ str ];\n\t});\n}\n\nvar Parser;\nvar ParseError;\nvar leadingWhitespace = /^\\s+/;\n\nParseError = function ( message ) {\n\tthis.name = 'ParseError';\n\tthis.message = message;\n\ttry {\n\t\tthrow new Error(message);\n\t} catch (e) {\n\t\tthis.stack = e.stack;\n\t}\n};\n\nParseError.prototype = Error.prototype;\n\nParser = function ( str, options ) {\n\tvar this$1 = this;\n\n\tvar items, item, lineStart = 0;\n\n\tthis.str = str;\n\tthis.options = options || {};\n\tthis.pos = 0;\n\n\tthis.lines = this.str.split( '\\n' );\n\tthis.lineEnds = this.lines.map( function ( line ) {\n\t\tvar lineEnd = lineStart + line.length + 1; // +1 for the newline\n\n\t\tlineStart = lineEnd;\n\t\treturn lineEnd;\n\t}, 0 );\n\n\t// Custom init logic\n\tif ( this.init ) this.init( str, options );\n\n\titems = [];\n\n\twhile ( ( this$1.pos < this$1.str.length ) && ( item = this$1.read() ) ) {\n\t\titems.push( item );\n\t}\n\n\tthis.leftover = this.remaining();\n\tthis.result = this.postProcess ? this.postProcess( items, options ) : items;\n};\n\nParser.prototype = {\n\tread: function ( converters ) {\n\t\tvar this$1 = this;\n\n\t\tvar pos, i, len, item;\n\n\t\tif ( !converters ) converters = this.converters;\n\n\t\tpos = this.pos;\n\n\t\tlen = converters.length;\n\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\tthis$1.pos = pos; // reset for each attempt\n\n\t\t\tif ( item = converters[i]( this$1 ) ) {\n\t\t\t\treturn item;\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t},\n\n\tgetLinePos: function ( char ) {\n\t\tvar this$1 = this;\n\n\t\tvar lineNum = 0, lineStart = 0, columnNum;\n\n\t\twhile ( char >= this$1.lineEnds[ lineNum ] ) {\n\t\t\tlineStart = this$1.lineEnds[ lineNum ];\n\t\t\tlineNum += 1;\n\t\t}\n\n\t\tcolumnNum = char - lineStart;\n\t\treturn [ lineNum + 1, columnNum + 1, char ]; // line/col should be one-based, not zero-based!\n\t},\n\n\terror: function ( message ) {\n\t\tvar pos = this.getLinePos( this.pos );\n\t\tvar lineNum = pos[0];\n\t\tvar columnNum = pos[1];\n\n\t\tvar line = this.lines[ pos[0] - 1 ];\n\t\tvar numTabs = 0;\n\t\tvar annotation = line.replace( /\\t/g, function ( match, char ) {\n\t\t\tif ( char < pos[1] ) {\n\t\t\t\tnumTabs += 1;\n\t\t\t}\n\n\t\t\treturn '  ';\n\t\t}) + '\\n' + new Array( pos[1] + numTabs ).join( ' ' ) + '^----';\n\n\t\tvar error = new ParseError( (\"\" + message + \" at line \" + lineNum + \" character \" + columnNum + \":\\n\" + annotation) );\n\n\t\terror.line = pos[0];\n\t\terror.character = pos[1];\n\t\terror.shortMessage = message;\n\n\t\tthrow error;\n\t},\n\n\tmatchString: function ( string ) {\n\t\tif ( this.str.substr( this.pos, string.length ) === string ) {\n\t\t\tthis.pos += string.length;\n\t\t\treturn string;\n\t\t}\n\t},\n\n\tmatchPattern: function ( pattern ) {\n\t\tvar match;\n\n\t\tif ( match = pattern.exec( this.remaining() ) ) {\n\t\t\tthis.pos += match[0].length;\n\t\t\treturn match[1] || match[0];\n\t\t}\n\t},\n\n\tallowWhitespace: function () {\n\t\tthis.matchPattern( leadingWhitespace );\n\t},\n\n\tremaining: function () {\n\t\treturn this.str.substring( this.pos );\n\t},\n\n\tnextChar: function () {\n\t\treturn this.str.charAt( this.pos );\n\t}\n};\n\nParser.extend = function ( proto ) {\n\tvar Parent = this, Child, key;\n\n\tChild = function ( str, options ) {\n\t\tParser.call( this, str, options );\n\t};\n\n\tChild.prototype = create( Parent.prototype );\n\n\tfor ( key in proto ) {\n\t\tif ( hasOwn.call( proto, key ) ) {\n\t\t\tChild.prototype[ key ] = proto[ key ];\n\t\t}\n\t}\n\n\tChild.extend = Parser.extend;\n\treturn Child;\n};\n\nvar Parser$1 = Parser;\n\nvar TEXT              = 1;\nvar INTERPOLATOR      = 2;\nvar TRIPLE            = 3;\nvar SECTION           = 4;\nvar INVERTED          = 5;\nvar CLOSING           = 6;\nvar ELEMENT           = 7;\nvar PARTIAL           = 8;\nvar COMMENT           = 9;\nvar DELIMCHANGE       = 10;\nvar ATTRIBUTE         = 13;\nvar CLOSING_TAG       = 14;\nvar COMPONENT         = 15;\nvar YIELDER           = 16;\nvar INLINE_PARTIAL    = 17;\nvar DOCTYPE           = 18;\nvar ALIAS             = 19;\n\nvar NUMBER_LITERAL    = 20;\nvar STRING_LITERAL    = 21;\nvar ARRAY_LITERAL     = 22;\nvar OBJECT_LITERAL    = 23;\nvar BOOLEAN_LITERAL   = 24;\nvar REGEXP_LITERAL    = 25;\n\nvar GLOBAL            = 26;\nvar KEY_VALUE_PAIR    = 27;\n\n\nvar REFERENCE         = 30;\nvar REFINEMENT        = 31;\nvar MEMBER            = 32;\nvar PREFIX_OPERATOR   = 33;\nvar BRACKETED         = 34;\nvar CONDITIONAL       = 35;\nvar INFIX_OPERATOR    = 36;\n\nvar INVOCATION        = 40;\n\nvar SECTION_IF        = 50;\nvar SECTION_UNLESS    = 51;\nvar SECTION_EACH      = 52;\nvar SECTION_WITH      = 53;\nvar SECTION_IF_WITH   = 54;\n\nvar ELSE              = 60;\nvar ELSEIF            = 61;\n\nvar EVENT             = 70;\nvar DECORATOR         = 71;\nvar TRANSITION        = 72;\nvar BINDING_FLAG      = 73;\n\nvar delimiterChangePattern = /^[^\\s=]+/;\nvar whitespacePattern = /^\\s+/;\n\nfunction readDelimiterChange ( parser ) {\n\tvar start, opening, closing;\n\n\tif ( !parser.matchString( '=' ) ) {\n\t\treturn null;\n\t}\n\n\tstart = parser.pos;\n\n\t// allow whitespace before new opening delimiter\n\tparser.allowWhitespace();\n\n\topening = parser.matchPattern( delimiterChangePattern );\n\tif ( !opening ) {\n\t\tparser.pos = start;\n\t\treturn null;\n\t}\n\n\t// allow whitespace (in fact, it's necessary...)\n\tif ( !parser.matchPattern( whitespacePattern ) ) {\n\t\treturn null;\n\t}\n\n\tclosing = parser.matchPattern( delimiterChangePattern );\n\tif ( !closing ) {\n\t\tparser.pos = start;\n\t\treturn null;\n\t}\n\n\t// allow whitespace before closing '='\n\tparser.allowWhitespace();\n\n\tif ( !parser.matchString( '=' ) ) {\n\t\tparser.pos = start;\n\t\treturn null;\n\t}\n\n\treturn [ opening, closing ];\n}\n\nvar regexpPattern = /^(\\/(?:[^\\n\\r\\u2028\\u2029/\\\\[]|\\\\.|\\[(?:[^\\n\\r\\u2028\\u2029\\]\\\\]|\\\\.)*])+\\/(?:([gimuy])(?![a-z]*\\2))*(?![a-zA-Z_$0-9]))/;\n\nfunction readNumberLiteral ( parser ) {\n\tvar result;\n\n\tif ( result = parser.matchPattern( regexpPattern ) ) {\n\t\treturn {\n\t\t\tt: REGEXP_LITERAL,\n\t\t\tv: result\n\t\t};\n\t}\n\n\treturn null;\n}\n\nvar pattern$1 = /[-/\\\\^$*+?.()|[\\]{}]/g;\n\nfunction escapeRegExp ( str ) {\n\treturn str.replace( pattern$1, '\\\\$&' );\n}\n\nvar regExpCache = {};\n\nvar getLowestIndex = function ( haystack, needles ) {\n\treturn haystack.search( regExpCache[needles.join()] || ( regExpCache[needles.join()] = new RegExp( needles.map( escapeRegExp ).join( '|' ) ) ) );\n};\n\n// https://github.com/kangax/html-minifier/issues/63#issuecomment-37763316\nvar booleanAttributes = /^(allowFullscreen|async|autofocus|autoplay|checked|compact|controls|declare|default|defaultChecked|defaultMuted|defaultSelected|defer|disabled|enabled|formNoValidate|hidden|indeterminate|inert|isMap|itemScope|loop|multiple|muted|noHref|noResize|noShade|noValidate|noWrap|open|pauseOnExit|readOnly|required|reversed|scoped|seamless|selected|sortable|translate|trueSpeed|typeMustMatch|visible)$/i;\nvar voidElementNames = /^(?:area|base|br|col|command|doctype|embed|hr|img|input|keygen|link|meta|param|source|track|wbr)$/i;\n\nvar htmlEntities = { quot: 34, amp: 38, apos: 39, lt: 60, gt: 62, nbsp: 160, iexcl: 161, cent: 162, pound: 163, curren: 164, yen: 165, brvbar: 166, sect: 167, uml: 168, copy: 169, ordf: 170, laquo: 171, not: 172, shy: 173, reg: 174, macr: 175, deg: 176, plusmn: 177, sup2: 178, sup3: 179, acute: 180, micro: 181, para: 182, middot: 183, cedil: 184, sup1: 185, ordm: 186, raquo: 187, frac14: 188, frac12: 189, frac34: 190, iquest: 191, Agrave: 192, Aacute: 193, Acirc: 194, Atilde: 195, Auml: 196, Aring: 197, AElig: 198, Ccedil: 199, Egrave: 200, Eacute: 201, Ecirc: 202, Euml: 203, Igrave: 204, Iacute: 205, Icirc: 206, Iuml: 207, ETH: 208, Ntilde: 209, Ograve: 210, Oacute: 211, Ocirc: 212, Otilde: 213, Ouml: 214, times: 215, Oslash: 216, Ugrave: 217, Uacute: 218, Ucirc: 219, Uuml: 220, Yacute: 221, THORN: 222, szlig: 223, agrave: 224, aacute: 225, acirc: 226, atilde: 227, auml: 228, aring: 229, aelig: 230, ccedil: 231, egrave: 232, eacute: 233, ecirc: 234, euml: 235, igrave: 236, iacute: 237, icirc: 238, iuml: 239, eth: 240, ntilde: 241, ograve: 242, oacute: 243, ocirc: 244, otilde: 245, ouml: 246, divide: 247, oslash: 248, ugrave: 249, uacute: 250, ucirc: 251, uuml: 252, yacute: 253, thorn: 254, yuml: 255, OElig: 338, oelig: 339, Scaron: 352, scaron: 353, Yuml: 376, fnof: 402, circ: 710, tilde: 732, Alpha: 913, Beta: 914, Gamma: 915, Delta: 916, Epsilon: 917, Zeta: 918, Eta: 919, Theta: 920, Iota: 921, Kappa: 922, Lambda: 923, Mu: 924, Nu: 925, Xi: 926, Omicron: 927, Pi: 928, Rho: 929, Sigma: 931, Tau: 932, Upsilon: 933, Phi: 934, Chi: 935, Psi: 936, Omega: 937, alpha: 945, beta: 946, gamma: 947, delta: 948, epsilon: 949, zeta: 950, eta: 951, theta: 952, iota: 953, kappa: 954, lambda: 955, mu: 956, nu: 957, xi: 958, omicron: 959, pi: 960, rho: 961, sigmaf: 962, sigma: 963, tau: 964, upsilon: 965, phi: 966, chi: 967, psi: 968, omega: 969, thetasym: 977, upsih: 978, piv: 982, ensp: 8194, emsp: 8195, thinsp: 8201, zwnj: 8204, zwj: 8205, lrm: 8206, rlm: 8207, ndash: 8211, mdash: 8212, lsquo: 8216, rsquo: 8217, sbquo: 8218, ldquo: 8220, rdquo: 8221, bdquo: 8222, dagger: 8224, Dagger: 8225, bull: 8226, hellip: 8230, permil: 8240, prime: 8242, Prime: 8243, lsaquo: 8249, rsaquo: 8250, oline: 8254, frasl: 8260, euro: 8364, image: 8465, weierp: 8472, real: 8476, trade: 8482, alefsym: 8501, larr: 8592, uarr: 8593, rarr: 8594, darr: 8595, harr: 8596, crarr: 8629, lArr: 8656, uArr: 8657, rArr: 8658, dArr: 8659, hArr: 8660, forall: 8704, part: 8706, exist: 8707, empty: 8709, nabla: 8711, isin: 8712, notin: 8713, ni: 8715, prod: 8719, sum: 8721, minus: 8722, lowast: 8727, radic: 8730, prop: 8733, infin: 8734, ang: 8736, and: 8743, or: 8744, cap: 8745, cup: 8746, 'int': 8747, there4: 8756, sim: 8764, cong: 8773, asymp: 8776, ne: 8800, equiv: 8801, le: 8804, ge: 8805, sub: 8834, sup: 8835, nsub: 8836, sube: 8838, supe: 8839, oplus: 8853, otimes: 8855, perp: 8869, sdot: 8901, lceil: 8968, rceil: 8969, lfloor: 8970, rfloor: 8971, lang: 9001, rang: 9002, loz: 9674, spades: 9824, clubs: 9827, hearts: 9829, diams: 9830\t};\nvar controlCharacters = [ 8364, 129, 8218, 402, 8222, 8230, 8224, 8225, 710, 8240, 352, 8249, 338, 141, 381, 143, 144, 8216, 8217, 8220, 8221, 8226, 8211, 8212, 732, 8482, 353, 8250, 339, 157, 382, 376 ];\nvar entityPattern = new RegExp( '&(#?(?:x[\\\\w\\\\d]+|\\\\d+|' + Object.keys( htmlEntities ).join( '|' ) + '));?', 'g' );\nvar codePointSupport = typeof String.fromCodePoint === 'function';\nvar codeToChar = codePointSupport ? String.fromCodePoint : String.fromCharCode;\n\nfunction decodeCharacterReferences ( html ) {\n\treturn html.replace( entityPattern, function ( match, entity ) {\n\t\tvar code;\n\n\t\t// Handle named entities\n\t\tif ( entity[0] !== '#' ) {\n\t\t\tcode = htmlEntities[ entity ];\n\t\t} else if ( entity[1] === 'x' ) {\n\t\t\tcode = parseInt( entity.substring( 2 ), 16 );\n\t\t} else {\n\t\t\tcode = parseInt( entity.substring( 1 ), 10 );\n\t\t}\n\n\t\tif ( !code ) {\n\t\t\treturn match;\n\t\t}\n\n\t\treturn codeToChar( validateCode( code ) );\n\t});\n}\n\nvar lessThan = /</g;\nvar greaterThan = />/g;\nvar amp = /&/g;\nvar invalid = 65533;\n\nfunction escapeHtml ( str ) {\n\treturn str\n\t\t.replace( amp, '&amp;' )\n\t\t.replace( lessThan, '&lt;' )\n\t\t.replace( greaterThan, '&gt;' );\n}\n\n// some code points are verboten. If we were inserting HTML, the browser would replace the illegal\n// code points with alternatives in some cases - since we're bypassing that mechanism, we need\n// to replace them ourselves\n//\n// Source: http://en.wikipedia.org/wiki/Character_encodings_in_HTML#Illegal_characters\nfunction validateCode ( code ) {\n\tif ( !code ) {\n\t\treturn invalid;\n\t}\n\n\t// line feed becomes generic whitespace\n\tif ( code === 10 ) {\n\t\treturn 32;\n\t}\n\n\t// ASCII range. (Why someone would use HTML entities for ASCII characters I don't know, but...)\n\tif ( code < 128 ) {\n\t\treturn code;\n\t}\n\n\t// code points 128-159 are dealt with leniently by browsers, but they're incorrect. We need\n\t// to correct the mistake or we'll end up with missing € signs and so on\n\tif ( code <= 159 ) {\n\t\treturn controlCharacters[ code - 128 ];\n\t}\n\n\t// basic multilingual plane\n\tif ( code < 55296 ) {\n\t\treturn code;\n\t}\n\n\t// UTF-16 surrogate halves\n\tif ( code <= 57343 ) {\n\t\treturn invalid;\n\t}\n\n\t// rest of the basic multilingual plane\n\tif ( code <= 65535 ) {\n\t\treturn code;\n\t} else if ( !codePointSupport ) {\n\t\treturn invalid;\n\t}\n\n\t// supplementary multilingual plane 0x10000 - 0x1ffff\n\tif ( code >= 65536 && code <= 131071 ) {\n\t\treturn code;\n\t}\n\n\t// supplementary ideographic plane 0x20000 - 0x2ffff\n\tif ( code >= 131072 && code <= 196607 ) {\n\t\treturn code;\n\t}\n\n\treturn invalid;\n}\n\nvar expectedExpression = 'Expected a JavaScript expression';\nvar expectedParen = 'Expected closing paren';\n\n// bulletproof number regex from https://gist.github.com/Rich-Harris/7544330\nvar numberPattern = /^(?:[+-]?)0*(?:(?:(?:[1-9]\\d*)?\\.\\d+)|(?:(?:0|[1-9]\\d*)\\.)|(?:0|[1-9]\\d*))(?:[eE][+-]?\\d+)?/;\n\nfunction readNumberLiteral$1 ( parser ) {\n\tvar result;\n\n\tif ( result = parser.matchPattern( numberPattern ) ) {\n\t\treturn {\n\t\t\tt: NUMBER_LITERAL,\n\t\t\tv: result\n\t\t};\n\t}\n\n\treturn null;\n}\n\nfunction readBooleanLiteral ( parser ) {\n\tvar remaining = parser.remaining();\n\n\tif ( remaining.substr( 0, 4 ) === 'true' ) {\n\t\tparser.pos += 4;\n\t\treturn {\n\t\t\tt: BOOLEAN_LITERAL,\n\t\t\tv: 'true'\n\t\t};\n\t}\n\n\tif ( remaining.substr( 0, 5 ) === 'false' ) {\n\t\tparser.pos += 5;\n\t\treturn {\n\t\t\tt: BOOLEAN_LITERAL,\n\t\t\tv: 'false'\n\t\t};\n\t}\n\n\treturn null;\n}\n\nvar stringMiddlePattern;\nvar escapeSequencePattern;\nvar lineContinuationPattern;\n\n// Match one or more characters until: \", ', \\, or EOL/EOF.\n// EOL/EOF is written as (?!.) (meaning there's no non-newline char next).\nstringMiddlePattern = /^(?=.)[^\"'\\\\]+?(?:(?!.)|(?=[\"'\\\\]))/;\n\n// Match one escape sequence, including the backslash.\nescapeSequencePattern = /^\\\\(?:['\"\\\\bfnrt]|0(?![0-9])|x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|(?=.)[^ux0-9])/;\n\n// Match one ES5 line continuation (backslash + line terminator).\nlineContinuationPattern = /^\\\\(?:\\r\\n|[\\u000A\\u000D\\u2028\\u2029])/;\n\n// Helper for defining getDoubleQuotedString and getSingleQuotedString.\nvar makeQuotedStringMatcher = function ( okQuote ) {\n\treturn function ( parser ) {\n\t\tvar literal = '\"';\n\t\tvar done = false;\n\t\tvar next;\n\n\t\twhile ( !done ) {\n\t\t\tnext = ( parser.matchPattern( stringMiddlePattern ) || parser.matchPattern( escapeSequencePattern ) ||\n\t\t\t\tparser.matchString( okQuote ) );\n\t\t\tif ( next ) {\n\t\t\t\tif ( next === (\"\\\"\") ) {\n\t\t\t\t\tliteral += \"\\\\\\\"\";\n\t\t\t\t} else if ( next === (\"\\\\'\") ) {\n\t\t\t\t\tliteral += \"'\";\n\t\t\t\t} else {\n\t\t\t\t\tliteral += next;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tnext = parser.matchPattern( lineContinuationPattern );\n\t\t\t\tif ( next ) {\n\t\t\t\t\t// convert \\(newline-like) into a \\u escape, which is allowed in JSON\n\t\t\t\t\tliteral += '\\\\u' + ( '000' + next.charCodeAt(1).toString(16) ).slice( -4 );\n\t\t\t\t} else {\n\t\t\t\t\tdone = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tliteral += '\"';\n\n\t\t// use JSON.parse to interpret escapes\n\t\treturn JSON.parse( literal );\n\t};\n};\n\nvar getSingleQuotedString = makeQuotedStringMatcher( (\"\\\"\") );\nvar getDoubleQuotedString = makeQuotedStringMatcher( (\"'\") );\n\nvar readStringLiteral = function ( parser ) {\n\tvar start, string;\n\n\tstart = parser.pos;\n\n\tif ( parser.matchString( '\"' ) ) {\n\t\tstring = getDoubleQuotedString( parser );\n\n\t\tif ( !parser.matchString( '\"' ) ) {\n\t\t\tparser.pos = start;\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\tt: STRING_LITERAL,\n\t\t\tv: string\n\t\t};\n\t}\n\n\tif ( parser.matchString( (\"'\") ) ) {\n\t\tstring = getSingleQuotedString( parser );\n\n\t\tif ( !parser.matchString( (\"'\") ) ) {\n\t\t\tparser.pos = start;\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\tt: STRING_LITERAL,\n\t\t\tv: string\n\t\t};\n\t}\n\n\treturn null;\n};\n\nvar name = /^[a-zA-Z_$][a-zA-Z_$0-9]*/;\n\nvar identifier = /^[a-zA-Z_$][a-zA-Z_$0-9]*$/;\n\n// http://mathiasbynens.be/notes/javascript-properties\n// can be any name, string literal, or number literal\nfunction readKey ( parser ) {\n\tvar token;\n\n\tif ( token = readStringLiteral( parser ) ) {\n\t\treturn identifier.test( token.v ) ? token.v : '\"' + token.v.replace( /\"/g, '\\\\\"' ) + '\"';\n\t}\n\n\tif ( token = readNumberLiteral$1( parser ) ) {\n\t\treturn token.v;\n\t}\n\n\tif ( token = parser.matchPattern( name ) ) {\n\t\treturn token;\n\t}\n\n\treturn null;\n}\n\nfunction readKeyValuePair ( parser ) {\n\tvar start, key, value;\n\n\tstart = parser.pos;\n\n\t// allow whitespace between '{' and key\n\tparser.allowWhitespace();\n\n\tvar refKey = parser.nextChar() !== '\\'' && parser.nextChar() !== '\"';\n\n\tkey = readKey( parser );\n\tif ( key === null ) {\n\t\tparser.pos = start;\n\t\treturn null;\n\t}\n\n\t// allow whitespace between key and ':'\n\tparser.allowWhitespace();\n\n\t// es2015 shorthand property\n\tif ( refKey && ( parser.nextChar() === ',' || parser.nextChar() === '}' ) ) {\n\t\tif ( !name.test( key ) ) {\n\t\t\tparser.error( (\"Expected a valid reference, but found '\" + key + \"' instead.\") );\n\t\t}\n\n\t\treturn {\n\t\t\tt: KEY_VALUE_PAIR,\n\t\t\tk: key,\n\t\t\tv: {\n\t\t\t\tt: REFERENCE,\n\t\t\t\tn: key\n\t\t\t}\n\t\t};\n\t}\n\n\t// next character must be ':'\n\tif ( !parser.matchString( ':' ) ) {\n\t\tparser.pos = start;\n\t\treturn null;\n\t}\n\n\t// allow whitespace between ':' and value\n\tparser.allowWhitespace();\n\n\t// next expression must be a, well... expression\n\tvalue = readExpression( parser );\n\tif ( value === null ) {\n\t\tparser.pos = start;\n\t\treturn null;\n\t}\n\n\treturn {\n\t\tt: KEY_VALUE_PAIR,\n\t\tk: key,\n\t\tv: value\n\t};\n}\n\nfunction readKeyValuePairs ( parser ) {\n\tvar start, pairs, pair, keyValuePairs;\n\n\tstart = parser.pos;\n\n\tpair = readKeyValuePair( parser );\n\tif ( pair === null ) {\n\t\treturn null;\n\t}\n\n\tpairs = [ pair ];\n\n\tif ( parser.matchString( ',' ) ) {\n\t\tkeyValuePairs = readKeyValuePairs( parser );\n\n\t\tif ( !keyValuePairs ) {\n\t\t\tparser.pos = start;\n\t\t\treturn null;\n\t\t}\n\n\t\treturn pairs.concat( keyValuePairs );\n\t}\n\n\treturn pairs;\n}\n\nvar readObjectLiteral = function ( parser ) {\n\tvar start, keyValuePairs;\n\n\tstart = parser.pos;\n\n\t// allow whitespace\n\tparser.allowWhitespace();\n\n\tif ( !parser.matchString( '{' ) ) {\n\t\tparser.pos = start;\n\t\treturn null;\n\t}\n\n\tkeyValuePairs = readKeyValuePairs( parser );\n\n\t// allow whitespace between final value and '}'\n\tparser.allowWhitespace();\n\n\tif ( !parser.matchString( '}' ) ) {\n\t\tparser.pos = start;\n\t\treturn null;\n\t}\n\n\treturn {\n\t\tt: OBJECT_LITERAL,\n\t\tm: keyValuePairs\n\t};\n};\n\nfunction readExpressionList ( parser ) {\n\tparser.allowWhitespace();\n\n\tvar expr = readExpression( parser );\n\n\tif ( expr === null ) return null;\n\n\tvar expressions = [ expr ];\n\n\t// allow whitespace between expression and ','\n\tparser.allowWhitespace();\n\n\tif ( parser.matchString( ',' ) ) {\n\t\tvar next = readExpressionList( parser );\n\t\tif ( next === null ) parser.error( expectedExpression );\n\n\t\texpressions.push.apply( expressions, next );\n\t}\n\n\treturn expressions;\n}\n\nvar readArrayLiteral = function ( parser ) {\n\tvar start, expressionList;\n\n\tstart = parser.pos;\n\n\t// allow whitespace before '['\n\tparser.allowWhitespace();\n\n\tif ( !parser.matchString( '[' ) ) {\n\t\tparser.pos = start;\n\t\treturn null;\n\t}\n\n\texpressionList = readExpressionList( parser );\n\n\tif ( !parser.matchString( ']' ) ) {\n\t\tparser.pos = start;\n\t\treturn null;\n\t}\n\n\treturn {\n\t\tt: ARRAY_LITERAL,\n\t\tm: expressionList\n\t};\n};\n\nfunction readLiteral ( parser ) {\n\treturn readNumberLiteral$1( parser )  ||\n\t       readBooleanLiteral( parser ) ||\n\t       readStringLiteral( parser )  ||\n\t       readObjectLiteral( parser )  ||\n\t       readArrayLiteral( parser )   ||\n\t       readNumberLiteral( parser );\n}\n\nvar prefixPattern = /^(?:~\\/|(?:\\.\\.\\/)+|\\.\\/(?:\\.\\.\\/)*|\\.)/;\nvar globals;\nvar keywords;\n\n// if a reference is a browser global, we don't deference it later, so it needs special treatment\nglobals = /^(?:Array|console|Date|RegExp|decodeURIComponent|decodeURI|encodeURIComponent|encodeURI|isFinite|isNaN|parseFloat|parseInt|JSON|Math|NaN|undefined|null|Object|Number|String|Boolean)\\b/;\n\n// keywords are not valid references, with the exception of `this`\nkeywords = /^(?:break|case|catch|continue|debugger|default|delete|do|else|finally|for|function|if|in|instanceof|new|return|switch|throw|try|typeof|var|void|while|with)$/;\n\nvar legalReference = /^(?:[a-zA-Z$_0-9]|\\\\\\.)+(?:(?:\\.(?:[a-zA-Z$_0-9]|\\\\\\.)+)|(?:\\[[0-9]+\\]))*/;\nvar relaxedName = /^[a-zA-Z_$][-\\/a-zA-Z_$0-9]*/;\nvar specials = /^@(?:keypath|rootpath|index|key|this|global)/;\nvar specialCall = /^\\s*\\(/;\nvar spreadPattern = /^\\s*\\.{3}/;\n\nfunction readReference ( parser ) {\n\tvar startPos, prefix, name, global, reference, fullLength, lastDotIndex, spread;\n\n\tstartPos = parser.pos;\n\n\tname = parser.matchPattern( specials );\n\n\tif ( name === '@keypath' || name === '@rootpath' ) {\n\t\tif ( parser.matchPattern( specialCall ) ) {\n\t\t\tvar ref = readReference( parser );\n\t\t\tif ( !ref ) parser.error( (\"Expected a valid reference for a keypath expression\") );\n\n\t\t\tparser.allowWhitespace();\n\n\t\t\tif ( !parser.matchString( ')' ) ) parser.error( (\"Unclosed keypath expression\") );\n\t\t\tname += \"(\" + (ref.n) + \")\";\n\t\t}\n\t}\n\n\tspread = !name && parser.spreadArgs && parser.matchPattern( spreadPattern );\n\n\tif ( !name ) {\n\t\tprefix = parser.matchPattern( prefixPattern ) || '';\n\t\tname = ( !prefix && parser.relaxedNames && parser.matchPattern( relaxedName ) ) ||\n\t\t       parser.matchPattern( legalReference );\n\n\t\tif ( !name && prefix === '.' ) {\n\t\t\tprefix = '';\n\t\t\tname = '.';\n\t\t} else if ( !name && prefix ) {\n\t\t\tname = prefix;\n\t\t\tprefix = '';\n\t\t}\n\t}\n\n\tif ( !name ) {\n\t\treturn null;\n\t}\n\n\t// bug out if it's a keyword (exception for ancestor/restricted refs - see https://github.com/ractivejs/ractive/issues/1497)\n\tif ( !prefix && !parser.relaxedNames && keywords.test( name ) ) {\n\t\tparser.pos = startPos;\n\t\treturn null;\n\t}\n\n\t// if this is a browser global, stop here\n\tif ( !prefix && globals.test( name ) ) {\n\t\tglobal = globals.exec( name )[0];\n\t\tparser.pos = startPos + global.length;\n\n\t\treturn {\n\t\t\tt: GLOBAL,\n\t\t\tv: ( spread ? '...' : '' ) + global\n\t\t};\n\t}\n\n\tfullLength = ( spread ? 3 : 0 ) + ( prefix || '' ).length + name.length;\n\treference = ( prefix || '' ) + normalise( name );\n\n\tif ( parser.matchString( '(' ) ) {\n\t\t// if this is a method invocation (as opposed to a function) we need\n\t\t// to strip the method name from the reference combo, else the context\n\t\t// will be wrong\n\t\t// but only if the reference was actually a member and not a refinement\n\t\tlastDotIndex = reference.lastIndexOf( '.' );\n\t\tif ( lastDotIndex !== -1 && name[ name.length - 1 ] !== ']' ) {\n\t\t\tvar refLength = reference.length;\n\t\t\treference = reference.substr( 0, lastDotIndex );\n\t\t\tparser.pos = startPos + (fullLength - ( refLength - lastDotIndex ) );\n\t\t} else {\n\t\t\tparser.pos -= 1;\n\t\t}\n\t}\n\n\treturn {\n\t\tt: REFERENCE,\n\t\tn: ( spread ? '...' : '' ) + reference.replace( /^this\\./, './' ).replace( /^this$/, '.' )\n\t};\n}\n\nfunction readBracketedExpression ( parser ) {\n\tif ( !parser.matchString( '(' ) ) return null;\n\n\tparser.allowWhitespace();\n\n\tvar expr = readExpression( parser );\n\n\tif ( !expr ) parser.error( expectedExpression );\n\n\tparser.allowWhitespace();\n\n\tif ( !parser.matchString( ')' ) ) parser.error( expectedParen );\n\n\treturn {\n\t\tt: BRACKETED,\n\t\tx: expr\n\t};\n}\n\nvar readPrimary = function ( parser ) {\n\treturn readLiteral( parser )\n\t\t|| readReference( parser )\n\t\t|| readBracketedExpression( parser );\n};\n\nfunction readRefinement ( parser ) {\n\t// some things call for strict refinement (partial names), meaning no space between reference and refinement\n\tif ( !parser.strictRefinement ) {\n\t\tparser.allowWhitespace();\n\t}\n\n\t// \".\" name\n\tif ( parser.matchString( '.' ) ) {\n\t\tparser.allowWhitespace();\n\n\t\tvar name$$1 = parser.matchPattern( name );\n\t\tif ( name$$1 ) {\n\t\t\treturn {\n\t\t\t\tt: REFINEMENT,\n\t\t\t\tn: name$$1\n\t\t\t};\n\t\t}\n\n\t\tparser.error( 'Expected a property name' );\n\t}\n\n\t// \"[\" expression \"]\"\n\tif ( parser.matchString( '[' ) ) {\n\t\tparser.allowWhitespace();\n\n\t\tvar expr = readExpression( parser );\n\t\tif ( !expr ) parser.error( expectedExpression );\n\n\t\tparser.allowWhitespace();\n\n\t\tif ( !parser.matchString( ']' ) ) parser.error( (\"Expected ']'\") );\n\n\t\treturn {\n\t\t\tt: REFINEMENT,\n\t\t\tx: expr\n\t\t};\n\t}\n\n\treturn null;\n}\n\nvar readMemberOrInvocation = function ( parser ) {\n\tvar expression = readPrimary( parser );\n\n\tif ( !expression ) return null;\n\n\twhile ( expression ) {\n\t\tvar refinement = readRefinement( parser );\n\t\tif ( refinement ) {\n\t\t\texpression = {\n\t\t\t\tt: MEMBER,\n\t\t\t\tx: expression,\n\t\t\t\tr: refinement\n\t\t\t};\n\t\t}\n\n\t\telse if ( parser.matchString( '(' ) ) {\n\t\t\tparser.allowWhitespace();\n\t\t\tvar start = parser.spreadArgs;\n\t\t\tparser.spreadArgs = true;\n\t\t\tvar expressionList = readExpressionList( parser );\n\t\t\tparser.spreadArgs = start;\n\n\t\t\tparser.allowWhitespace();\n\n\t\t\tif ( !parser.matchString( ')' ) ) {\n\t\t\t\tparser.error( expectedParen );\n\t\t\t}\n\n\t\t\texpression = {\n\t\t\t\tt: INVOCATION,\n\t\t\t\tx: expression\n\t\t\t};\n\n\t\t\tif ( expressionList ) expression.o = expressionList;\n\t\t}\n\n\t\telse {\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn expression;\n};\n\nvar readTypeOf;\nvar makePrefixSequenceMatcher;\n\nmakePrefixSequenceMatcher = function ( symbol, fallthrough ) {\n\treturn function ( parser ) {\n\t\tvar expression;\n\n\t\tif ( expression = fallthrough( parser ) ) {\n\t\t\treturn expression;\n\t\t}\n\n\t\tif ( !parser.matchString( symbol ) ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tparser.allowWhitespace();\n\n\t\texpression = readExpression( parser );\n\t\tif ( !expression ) {\n\t\t\tparser.error( expectedExpression );\n\t\t}\n\n\t\treturn {\n\t\t\ts: symbol,\n\t\t\to: expression,\n\t\t\tt: PREFIX_OPERATOR\n\t\t};\n\t};\n};\n\n// create all prefix sequence matchers, return readTypeOf\n(function() {\n\tvar i, len, matcher, prefixOperators, fallthrough;\n\n\tprefixOperators = '! ~ + - typeof'.split( ' ' );\n\n\tfallthrough = readMemberOrInvocation;\n\tfor ( i = 0, len = prefixOperators.length; i < len; i += 1 ) {\n\t\tmatcher = makePrefixSequenceMatcher( prefixOperators[i], fallthrough );\n\t\tfallthrough = matcher;\n\t}\n\n\t// typeof operator is higher precedence than multiplication, so provides the\n\t// fallthrough for the multiplication sequence matcher we're about to create\n\t// (we're skipping void and delete)\n\treadTypeOf = fallthrough;\n}());\n\nvar readTypeof = readTypeOf;\n\nvar readLogicalOr;\nvar makeInfixSequenceMatcher;\n\nmakeInfixSequenceMatcher = function ( symbol, fallthrough ) {\n\treturn function ( parser ) {\n\t\tvar start, left, right;\n\n\t\tleft = fallthrough( parser );\n\t\tif ( !left ) {\n\t\t\treturn null;\n\t\t}\n\n\t\t// Loop to handle left-recursion in a case like `a * b * c` and produce\n\t\t// left association, i.e. `(a * b) * c`.  The matcher can't call itself\n\t\t// to parse `left` because that would be infinite regress.\n\t\twhile ( true ) {\n\t\t\tstart = parser.pos;\n\n\t\t\tparser.allowWhitespace();\n\n\t\t\tif ( !parser.matchString( symbol ) ) {\n\t\t\t\tparser.pos = start;\n\t\t\t\treturn left;\n\t\t\t}\n\n\t\t\t// special case - in operator must not be followed by [a-zA-Z_$0-9]\n\t\t\tif ( symbol === 'in' && /[a-zA-Z_$0-9]/.test( parser.remaining().charAt( 0 ) ) ) {\n\t\t\t\tparser.pos = start;\n\t\t\t\treturn left;\n\t\t\t}\n\n\t\t\tparser.allowWhitespace();\n\n\t\t\t// right operand must also consist of only higher-precedence operators\n\t\t\tright = fallthrough( parser );\n\t\t\tif ( !right ) {\n\t\t\t\tparser.pos = start;\n\t\t\t\treturn left;\n\t\t\t}\n\n\t\t\tleft = {\n\t\t\t\tt: INFIX_OPERATOR,\n\t\t\t\ts: symbol,\n\t\t\t\to: [ left, right ]\n\t\t\t};\n\n\t\t\t// Loop back around.  If we don't see another occurrence of the symbol,\n\t\t\t// we'll return left.\n\t\t}\n\t};\n};\n\n// create all infix sequence matchers, and return readLogicalOr\n(function() {\n\tvar i, len, matcher, infixOperators, fallthrough;\n\n\t// All the infix operators on order of precedence (source: https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Operator_Precedence)\n\t// Each sequence matcher will initially fall through to its higher precedence\n\t// neighbour, and only attempt to match if one of the higher precedence operators\n\t// (or, ultimately, a literal, reference, or bracketed expression) already matched\n\tinfixOperators = '* / % + - << >> >>> < <= > >= in instanceof == != === !== & ^ | && ||'.split( ' ' );\n\n\t// A typeof operator is higher precedence than multiplication\n\tfallthrough = readTypeof;\n\tfor ( i = 0, len = infixOperators.length; i < len; i += 1 ) {\n\t\tmatcher = makeInfixSequenceMatcher( infixOperators[i], fallthrough );\n\t\tfallthrough = matcher;\n\t}\n\n\t// Logical OR is the fallthrough for the conditional matcher\n\treadLogicalOr = fallthrough;\n}());\n\nvar readLogicalOr$1 = readLogicalOr;\n\n// The conditional operator is the lowest precedence operator, so we start here\nfunction getConditional ( parser ) {\n\tvar start, expression, ifTrue, ifFalse;\n\n\texpression = readLogicalOr$1( parser );\n\tif ( !expression ) {\n\t\treturn null;\n\t}\n\n\tstart = parser.pos;\n\n\tparser.allowWhitespace();\n\n\tif ( !parser.matchString( '?' ) ) {\n\t\tparser.pos = start;\n\t\treturn expression;\n\t}\n\n\tparser.allowWhitespace();\n\n\tifTrue = readExpression( parser );\n\tif ( !ifTrue ) {\n\t\tparser.error( expectedExpression );\n\t}\n\n\tparser.allowWhitespace();\n\n\tif ( !parser.matchString( ':' ) ) {\n\t\tparser.error( 'Expected \":\"' );\n\t}\n\n\tparser.allowWhitespace();\n\n\tifFalse = readExpression( parser );\n\tif ( !ifFalse ) {\n\t\tparser.error( expectedExpression );\n\t}\n\n\treturn {\n\t\tt: CONDITIONAL,\n\t\to: [ expression, ifTrue, ifFalse ]\n\t};\n}\n\nfunction readExpression ( parser ) {\n\t// The conditional operator is the lowest precedence operator (except yield,\n\t// assignment operators, and commas, none of which are supported), so we\n\t// start there. If it doesn't match, it 'falls through' to progressively\n\t// higher precedence operators, until it eventually matches (or fails to\n\t// match) a 'primary' - a literal or a reference. This way, the abstract syntax\n\t// tree has everything in its proper place, i.e. 2 + 3 * 4 === 14, not 20.\n\treturn getConditional( parser );\n}\n\nfunction flattenExpression ( expression ) {\n\tvar refs, count = 0, stringified;\n\n\textractRefs( expression, refs = [] );\n\tstringified = stringify( expression );\n\n\trefs = refs.map( function ( r ) { return r.indexOf( '...' ) === 0 ? r.substr( 3 ) : r; } );\n\n\treturn {\n\t\tr: refs,\n\t\ts: getVars(stringified)\n\t};\n\n\tfunction getVars(expr) {\n\t\tvar vars = [];\n\t\tfor ( var i = count - 1; i >= 0; i-- ) {\n\t\t\tvars.push( (\"spread$\" + i) );\n\t\t}\n\t\treturn vars.length ? (\"(function(){var \" + (vars.join(',')) + \";return(\" + expr + \");})()\") : expr;\n\t}\n\n\tfunction stringify ( node ) {\n\t\tswitch ( node.t ) {\n\t\t\tcase BOOLEAN_LITERAL:\n\t\t\tcase GLOBAL:\n\t\t\tcase NUMBER_LITERAL:\n\t\t\tcase REGEXP_LITERAL:\n\t\t\t\treturn node.v;\n\n\t\t\tcase STRING_LITERAL:\n\t\t\t\treturn JSON.stringify( String( node.v ) );\n\n\t\t\tcase ARRAY_LITERAL:\n\t\t\t\treturn '[' + ( node.m ? node.m.map( stringify ).join( ',' ) : '' ) + ']';\n\n\t\t\tcase OBJECT_LITERAL:\n\t\t\t\treturn '{' + ( node.m ? node.m.map( stringify ).join( ',' ) : '' ) + '}';\n\n\t\t\tcase KEY_VALUE_PAIR:\n\t\t\t\treturn node.k + ':' + stringify( node.v );\n\n\t\t\tcase PREFIX_OPERATOR:\n\t\t\t\treturn ( node.s === 'typeof' ? 'typeof ' : node.s ) + stringify( node.o );\n\n\t\t\tcase INFIX_OPERATOR:\n\t\t\t\treturn stringify( node.o[0] ) + ( node.s.substr( 0, 2 ) === 'in' ? ' ' + node.s + ' ' : node.s ) + stringify( node.o[1] );\n\n\t\t\tcase INVOCATION:\n\t\t\t\tif ( node.spread ) {\n\t\t\t\t\tvar id = count++;\n\t\t\t\t\treturn (\"(spread$\" + id + \" = \" + (stringify(node.x)) + \").apply(spread$\" + id + \", [].concat(\" + (node.o ? node.o.map( function ( a ) { return a.n && a.n.indexOf( '...' ) === 0 ? stringify( a ) : '[' + stringify(a) + ']'; } ).join( ',' ) : '') + \") )\");\n\t\t\t\t} else {\n\t\t\t\t\treturn stringify( node.x ) + '(' + ( node.o ? node.o.map( stringify ).join( ',' ) : '' ) + ')';\n\t\t\t\t}\n\n\t\t\tcase BRACKETED:\n\t\t\t\treturn '(' + stringify( node.x ) + ')';\n\n\t\t\tcase MEMBER:\n\t\t\t\treturn stringify( node.x ) + stringify( node.r );\n\n\t\t\tcase REFINEMENT:\n\t\t\t\treturn ( node.n ? '.' + node.n : '[' + stringify( node.x ) + ']' );\n\n\t\t\tcase CONDITIONAL:\n\t\t\t\treturn stringify( node.o[0] ) + '?' + stringify( node.o[1] ) + ':' + stringify( node.o[2] );\n\n\t\t\tcase REFERENCE:\n\t\t\t\treturn '_' + refs.indexOf( node.n );\n\n\t\t\tdefault:\n\t\t\t\tthrow new Error( 'Expected legal JavaScript' );\n\t\t}\n\t}\n}\n\n// TODO maybe refactor this?\nfunction extractRefs ( node, refs ) {\n\tvar i, list;\n\n\tif ( node.t === REFERENCE ) {\n\t\tif ( refs.indexOf( node.n ) === -1 ) {\n\t\t\trefs.unshift( node.n );\n\t\t}\n\t}\n\n\tlist = node.o || node.m;\n\tif ( list ) {\n\t\tif ( isObject( list ) ) {\n\t\t\textractRefs( list, refs );\n\t\t} else {\n\t\t\ti = list.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tif ( list[i].n && list[i].n.indexOf('...') === 0 ) {\n\t\t\t\t\tnode.spread = true;\n\t\t\t\t}\n\t\t\t\textractRefs( list[i], refs );\n\t\t\t}\n\t\t}\n\t}\n\n\tif ( node.x ) {\n\t\textractRefs( node.x, refs );\n\t}\n\n\tif ( node.r ) {\n\t\textractRefs( node.r, refs );\n\t}\n\n\tif ( node.v ) {\n\t\textractRefs( node.v, refs );\n\t}\n}\n\n// simple JSON parser, without the restrictions of JSON parse\n// (i.e. having to double-quote keys).\n//\n// If passed a hash of values as the second argument, ${placeholders}\n// will be replaced with those values\n\nvar specials$1 = {\n\t'true': true,\n\t'false': false,\n\t'null': null,\n\tundefined: undefined\n};\n\nvar specialsPattern = new RegExp( '^(?:' + Object.keys( specials$1 ).join( '|' ) + ')' );\nvar numberPattern$1 = /^(?:[+-]?)(?:(?:(?:0|[1-9]\\d*)?\\.\\d+)|(?:(?:0|[1-9]\\d*)\\.)|(?:0|[1-9]\\d*))(?:[eE][+-]?\\d+)?/;\nvar placeholderPattern = /\\$\\{([^\\}]+)\\}/g;\nvar placeholderAtStartPattern = /^\\$\\{([^\\}]+)\\}/;\nvar onlyWhitespace = /^\\s*$/;\n\nvar JsonParser = Parser$1.extend({\n\tinit: function ( str, options ) {\n\t\tthis.values = options.values;\n\t\tthis.allowWhitespace();\n\t},\n\n\tpostProcess: function ( result ) {\n\t\tif ( result.length !== 1 || !onlyWhitespace.test( this.leftover ) ) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn { value: result[0].v };\n\t},\n\n\tconverters: [\n\t\tfunction getPlaceholder ( parser ) {\n\t\t\tif ( !parser.values ) return null;\n\n\t\t\tvar placeholder = parser.matchPattern( placeholderAtStartPattern );\n\n\t\t\tif ( placeholder && ( parser.values.hasOwnProperty( placeholder ) ) ) {\n\t\t\t\treturn { v: parser.values[ placeholder ] };\n\t\t\t}\n\t\t},\n\n\t\tfunction getSpecial ( parser ) {\n\t\t\tvar special = parser.matchPattern( specialsPattern );\n\t\t\tif ( special ) return { v: specials$1[ special ] };\n\t\t},\n\n\t\tfunction getNumber ( parser ) {\n\t\t\tvar number = parser.matchPattern( numberPattern$1 );\n\t\t\tif ( number ) return { v: +number };\n\t\t},\n\n\t\tfunction getString ( parser ) {\n\t\t\tvar stringLiteral = readStringLiteral( parser );\n\t\t\tvar values = parser.values;\n\n\t\t\tif ( stringLiteral && values ) {\n\t\t\t\treturn {\n\t\t\t\t\tv: stringLiteral.v.replace( placeholderPattern, function ( match, $1 ) { return ( $1 in values ? values[ $1 ] : $1 ); } )\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn stringLiteral;\n\t\t},\n\n\t\tfunction getObject ( parser ) {\n\t\t\tif ( !parser.matchString( '{' ) ) return null;\n\n\t\t\tvar result = {};\n\n\t\t\tparser.allowWhitespace();\n\n\t\t\tif ( parser.matchString( '}' ) ) {\n\t\t\t\treturn { v: result };\n\t\t\t}\n\n\t\t\tvar pair;\n\t\t\twhile ( pair = getKeyValuePair( parser ) ) {\n\t\t\t\tresult[ pair.key ] = pair.value;\n\n\t\t\t\tparser.allowWhitespace();\n\n\t\t\t\tif ( parser.matchString( '}' ) ) {\n\t\t\t\t\treturn { v: result };\n\t\t\t\t}\n\n\t\t\t\tif ( !parser.matchString( ',' ) ) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\n\t\tfunction getArray ( parser ) {\n\t\t\tif ( !parser.matchString( '[' ) ) return null;\n\n\t\t\tvar result = [];\n\n\t\t\tparser.allowWhitespace();\n\n\t\t\tif ( parser.matchString( ']' ) ) {\n\t\t\t\treturn { v: result };\n\t\t\t}\n\n\t\t\tvar valueToken;\n\t\t\twhile ( valueToken = parser.read() ) {\n\t\t\t\tresult.push( valueToken.v );\n\n\t\t\t\tparser.allowWhitespace();\n\n\t\t\t\tif ( parser.matchString( ']' ) ) {\n\t\t\t\t\treturn { v: result };\n\t\t\t\t}\n\n\t\t\t\tif ( !parser.matchString( ',' ) ) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tparser.allowWhitespace();\n\t\t\t}\n\n\t\t\treturn null;\n\t\t}\n\t]\n});\n\nfunction getKeyValuePair ( parser ) {\n\tparser.allowWhitespace();\n\n\tvar key = readKey( parser );\n\n\tif ( !key ) return null;\n\n\tvar pair = { key: key };\n\n\tparser.allowWhitespace();\n\tif ( !parser.matchString( ':' ) ) {\n\t\treturn null;\n\t}\n\tparser.allowWhitespace();\n\n\tvar valueToken = parser.read();\n\n\tif ( !valueToken ) return null;\n\n\tpair.value = valueToken.v;\n\treturn pair;\n}\n\nvar parseJSON = function ( str, values ) {\n\tvar parser = new JsonParser( str, { values: values });\n\treturn parser.result;\n};\n\nvar methodCallPattern = /^([a-zA-Z_$][a-zA-Z_$0-9]*)\\(.*\\)\\s*$/;\nvar ExpressionParser;\n\nExpressionParser = Parser$1.extend({\n\tconverters: [ readExpression ],\n\tspreadArgs: true\n});\n\n// TODO clean this up, it's shocking\nfunction processDirective ( tokens, parentParser, type ) {\n\tvar result,\n\t\tmatch,\n\t\ttoken,\n\t\tcolonIndex,\n\t\tdirectiveName,\n\t\tdirectiveArgs,\n\t\tparsed;\n\n\tif ( typeof tokens === 'string' ) {\n\t\tif ( type === DECORATOR || type === TRANSITION ) {\n\t\t\tvar parser = new ExpressionParser( (\"[\" + tokens + \"]\") );\n\t\t\treturn { a: flattenExpression( parser.result[0] ) };\n\t\t}\n\n\t\tif ( type === EVENT && ( match = methodCallPattern.exec( tokens ) ) ) {\n\t\t\twarnOnceIfDebug( (\"Unqualified method events are deprecated. Prefix methods with '@this.' to call methods on the current Ractive instance.\") );\n\t\t\ttokens = \"@this.\" + (match[1]) + \"\" + (tokens.substr(match[1].length));\n\t\t}\n\n\t\tif ( type === EVENT && ~tokens.indexOf( '(' ) ) {\n\t\t\tvar parser$1 = new ExpressionParser( '[' + tokens + ']' );\n\t\t\tif ( parser$1.result && parser$1.result[0] ) {\n\t\t\t\tif ( parser$1.remaining().length ) {\n\t\t\t\t\tparentParser.error( (\"Invalid input after event expression '\" + (parser$1.remaining()) + \"'\") );\n\t\t\t\t}\n\t\t\t\treturn { x: flattenExpression( parser$1.result[0] ) };\n\t\t\t}\n\n\t\t\tif ( tokens.indexOf( ':' ) > tokens.indexOf( '(' ) || !~tokens.indexOf( ':' ) ) {\n\t\t\t\tparentParser.error( (\"Invalid input in event expression '\" + tokens + \"'\") );\n\t\t\t}\n\n\t\t}\n\n\t\tif ( tokens.indexOf( ':' ) === -1 ) {\n\t\t\treturn tokens.trim();\n\t\t}\n\n\t\ttokens = [ tokens ];\n\t}\n\n\tresult = {};\n\n\tdirectiveName = [];\n\tdirectiveArgs = [];\n\n\tif ( tokens ) {\n\t\twhile ( tokens.length ) {\n\t\t\ttoken = tokens.shift();\n\n\t\t\tif ( typeof token === 'string' ) {\n\t\t\t\tcolonIndex = token.indexOf( ':' );\n\n\t\t\t\tif ( colonIndex === -1 ) {\n\t\t\t\t\tdirectiveName.push( token );\n\t\t\t\t} else {\n\t\t\t\t\t// is the colon the first character?\n\t\t\t\t\tif ( colonIndex ) {\n\t\t\t\t\t\t// no\n\t\t\t\t\t\tdirectiveName.push( token.substr( 0, colonIndex ) );\n\t\t\t\t\t}\n\n\t\t\t\t\t// if there is anything after the colon in this token, treat\n\t\t\t\t\t// it as the first token of the directiveArgs fragment\n\t\t\t\t\tif ( token.length > colonIndex + 1 ) {\n\t\t\t\t\t\tdirectiveArgs[0] = token.substring( colonIndex + 1 );\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\telse {\n\t\t\t\tdirectiveName.push( token );\n\t\t\t}\n\t\t}\n\n\t\tdirectiveArgs = directiveArgs.concat( tokens );\n\t}\n\n\tif ( !directiveName.length ) {\n\t\tresult = '';\n\t} else if ( directiveArgs.length || typeof directiveName !== 'string' ) {\n\t\tresult = {\n\t\t\t// TODO is this really necessary? just use the array\n\t\t\tn: ( directiveName.length === 1 && typeof directiveName[0] === 'string' ? directiveName[0] : directiveName )\n\t\t};\n\n\t\tif ( directiveArgs.length === 1 && typeof directiveArgs[0] === 'string' ) {\n\t\t\tparsed = parseJSON( '[' + directiveArgs[0] + ']' );\n\t\t\tresult.a = parsed ? parsed.value : [ directiveArgs[0].trim() ];\n\t\t}\n\n\t\telse {\n\t\t\tresult.d = directiveArgs;\n\t\t}\n\t} else {\n\t\tresult = directiveName;\n\t}\n\n\tif ( directiveArgs.length ) {\n\t\twarnOnceIfDebug( (\"Proxy events with arguments are deprecated. You can fire events with arguments using \\\"@this.fire('eventName', arg1, arg2, ...)\\\".\") );\n\t}\n\n\treturn result;\n}\n\nvar attributeNamePattern = /^[^\\s\"'>\\/=]+/;\nvar onPattern = /^on/;\nvar proxyEventPattern = /^on-([a-zA-Z\\\\*\\\\.$_][a-zA-Z\\\\*\\\\.$_0-9\\-]+)$/;\nvar reservedEventNames = /^(?:change|reset|teardown|update|construct|config|init|render|unrender|detach|insert)$/;\nvar decoratorPattern = /^as-([a-z-A-Z][-a-zA-Z_0-9]*)$/;\nvar transitionPattern = /^([a-zA-Z](?:(?!-in-out)[-a-zA-Z_0-9])*)-(in|out|in-out)$/;\nvar directives = {\n\t\t\t\t   'intro-outro': { t: TRANSITION, v: 't0' },\n\t\t\t\t   intro: { t: TRANSITION, v: 't1' },\n\t\t\t\t   outro: { t: TRANSITION, v: 't2' },\n\t\t\t\t   lazy: { t: BINDING_FLAG, v: 'l' },\n\t\t\t\t   twoway: { t: BINDING_FLAG, v: 't' },\n\t\t\t\t   decorator: { t: DECORATOR }\n\t\t\t\t };\nvar unquotedAttributeValueTextPattern = /^[^\\s\"'=<>`]+/;\n\nfunction readAttribute ( parser ) {\n\tvar attr, name, value, i, nearest, idx;\n\n\tparser.allowWhitespace();\n\n\tname = parser.matchPattern( attributeNamePattern );\n\tif ( !name ) {\n\t\treturn null;\n\t}\n\n\t// check for accidental delimiter consumption e.g. <tag bool{{>attrs}} />\n\tnearest = name.length;\n\tfor ( i = 0; i < parser.tags.length; i++ ) {\n\t\tif ( ~( idx = name.indexOf( parser.tags[ i ].open ) ) ) {\n\t\t\tif ( idx < nearest ) nearest = idx;\n\t\t}\n\t}\n\tif ( nearest < name.length ) {\n\t\tparser.pos -= name.length - nearest;\n\t\tname = name.substr( 0, nearest );\n\t\treturn { n: name };\n\t}\n\n\tattr = { n: name };\n\n\tvalue = readAttributeValue( parser );\n\tif ( value != null ) { // not null/undefined\n\t\tattr.f = value;\n\t}\n\n\treturn attr;\n}\n\nfunction readAttributeValue ( parser ) {\n\tvar start, valueStart, startDepth, value;\n\n\tstart = parser.pos;\n\n\t// next character must be `=`, `/`, `>` or whitespace\n\tif ( !/[=\\/>\\s]/.test( parser.nextChar() ) ) {\n\t\tparser.error( 'Expected `=`, `/`, `>` or whitespace' );\n\t}\n\n\tparser.allowWhitespace();\n\n\tif ( !parser.matchString( '=' ) ) {\n\t\tparser.pos = start;\n\t\treturn null;\n\t}\n\n\tparser.allowWhitespace();\n\n\tvalueStart = parser.pos;\n\tstartDepth = parser.sectionDepth;\n\n\tvalue = readQuotedAttributeValue( parser, (\"'\") ) ||\n\t\t\treadQuotedAttributeValue( parser, (\"\\\"\") ) ||\n\t\t\treadUnquotedAttributeValue( parser );\n\n\tif ( value === null ) {\n\t\tparser.error( 'Expected valid attribute value' );\n\t}\n\n\tif ( parser.sectionDepth !== startDepth ) {\n\t\tparser.pos = valueStart;\n\t\tparser.error( 'An attribute value must contain as many opening section tags as closing section tags' );\n\t}\n\n\tif ( !value.length ) {\n\t\treturn '';\n\t}\n\n\tif ( value.length === 1 && typeof value[0] === 'string' ) {\n\t\treturn decodeCharacterReferences( value[0] );\n\t}\n\n\treturn value;\n}\n\nfunction readUnquotedAttributeValueToken ( parser ) {\n\tvar start, text, haystack, needles, index;\n\n\tstart = parser.pos;\n\n\ttext = parser.matchPattern( unquotedAttributeValueTextPattern );\n\n\tif ( !text ) {\n\t\treturn null;\n\t}\n\n\thaystack = text;\n\tneedles = parser.tags.map( function ( t ) { return t.open; } ); // TODO refactor... we do this in readText.js as well\n\n\tif ( ( index = getLowestIndex( haystack, needles ) ) !== -1 ) {\n\t\ttext = text.substr( 0, index );\n\t\tparser.pos = start + text.length;\n\t}\n\n\treturn text;\n}\n\nfunction readUnquotedAttributeValue ( parser ) {\n\tvar tokens, token;\n\n\tparser.inAttribute = true;\n\n\ttokens = [];\n\n\ttoken = readMustache( parser ) || readUnquotedAttributeValueToken( parser );\n\twhile ( token ) {\n\t\ttokens.push( token );\n\t\ttoken = readMustache( parser ) || readUnquotedAttributeValueToken( parser );\n\t}\n\n\tif ( !tokens.length ) {\n\t\treturn null;\n\t}\n\n\tparser.inAttribute = false;\n\treturn tokens;\n}\n\nfunction readQuotedAttributeValue ( parser, quoteMark ) {\n\tvar start, tokens, token;\n\n\tstart = parser.pos;\n\n\tif ( !parser.matchString( quoteMark ) ) {\n\t\treturn null;\n\t}\n\n\tparser.inAttribute = quoteMark;\n\n\ttokens = [];\n\n\ttoken = readMustache( parser ) || readQuotedStringToken( parser, quoteMark );\n\twhile ( token !== null ) {\n\t\ttokens.push( token );\n\t\ttoken = readMustache( parser ) || readQuotedStringToken( parser, quoteMark );\n\t}\n\n\tif ( !parser.matchString( quoteMark ) ) {\n\t\tparser.pos = start;\n\t\treturn null;\n\t}\n\n\tparser.inAttribute = false;\n\n\treturn tokens;\n}\n\nfunction readQuotedStringToken ( parser, quoteMark ) {\n\tvar haystack = parser.remaining();\n\n\tvar needles = parser.tags.map( function ( t ) { return t.open; } ); // TODO refactor... we do this in readText.js as well\n\tneedles.push( quoteMark );\n\n\tvar index = getLowestIndex( haystack, needles );\n\n\tif ( index === -1 ) {\n\t\tparser.error( 'Quoted attribute value must have a closing quote' );\n\t}\n\n\tif ( !index ) {\n\t\treturn null;\n\t}\n\n\tparser.pos += index;\n\treturn haystack.substr( 0, index );\n}\n\nfunction readAttributeOrDirective ( parser ) {\n\t\tvar match,\n\t\t\tattribute,\n\t\t    directive;\n\n\t\tattribute = readAttribute( parser );\n\n\t\tif ( !attribute ) return null;\n\n\t\t// intro, outro, decorator\n\t\tif ( directive = directives[ attribute.n ] ) {\n\t\t\tattribute.t = directive.t;\n\t\t\tif ( directive.v ) attribute.v = directive.v;\n\t\t\tdelete attribute.n; // no name necessary\n\n\t\t\tif ( directive.t === TRANSITION || directive.t === DECORATOR ) attribute.f = processDirective( attribute.f, parser );\n\n\t\t\tif ( directive.t === TRANSITION ) {\n\t\t\t\twarnOnceIfDebug( (\"\" + (directive.v === 't0' ? 'intro-outro' : directive.v === 't1' ? 'intro' : 'outro') + \" is deprecated. To specify tranisitions, use the transition name suffixed with '-in', '-out', or '-in-out' as an attribute. Arguments can be specified in the attribute value as a simple list of expressions without mustaches.\") );\n\t\t\t} else if ( directive.t === DECORATOR ) {\n\t\t\t\twarnOnceIfDebug( (\"decorator is deprecated. To specify decorators, use the decorator name prefixed with 'as-' as an attribute. Arguments can be specified in the attribute value as a simple list of expressions without mustaches.\") );\n\t\t\t}\n\t\t}\n\n\t\t// decorators\n\t\telse if ( match = decoratorPattern.exec( attribute.n ) ) {\n\t\t\tdelete attribute.n;\n\t\t\tattribute.t = DECORATOR;\n\t\t\tattribute.f = processDirective( attribute.f, parser, DECORATOR );\n\t\t\tif ( typeof attribute.f === 'object' ) attribute.f.n = match[1];\n\t\t\telse attribute.f = match[1];\n\t\t}\n\n\t\t// transitions\n\t\telse if ( match = transitionPattern.exec( attribute.n ) ) {\n\t\t\tdelete attribute.n;\n\t\t\tattribute.t = TRANSITION;\n\t\t\tattribute.f = processDirective( attribute.f, parser, TRANSITION );\n\t\t\tif ( typeof attribute.f === 'object' ) attribute.f.n = match[1];\n\t\t\telse attribute.f = match[1];\n\t\t\tattribute.v = match[2] === 'in-out' ? 't0' : match[2] === 'in' ? 't1' : 't2';\n\t\t}\n\n\t\t// on-click etc\n\t\telse if ( match = proxyEventPattern.exec( attribute.n ) ) {\n\t\t\tattribute.n = match[1];\n\t\t\tattribute.t = EVENT;\n\t\t\tattribute.f = processDirective( attribute.f, parser, EVENT );\n\n\t\t\tif ( reservedEventNames.test( attribute.f.n || attribute.f ) ) {\n\t\t\t\tparser.pos -= ( attribute.f.n || attribute.f ).length;\n\t\t\t\tparser.error( 'Cannot use reserved event names (change, reset, teardown, update, construct, config, init, render, unrender, detach, insert)' );\n\t\t\t}\n\t\t}\n\n\t\telse {\n\t\t\tif ( parser.sanitizeEventAttributes && onPattern.test( attribute.n ) ) {\n\t\t\t\treturn { exclude: true };\n\t\t\t} else {\n\t\t\t\tattribute.f = attribute.f || ( attribute.f === '' ? '' : 0 );\n\t\t\t\tattribute.t = ATTRIBUTE;\n\t\t\t}\n\t\t}\n\n\t\treturn attribute;\n}\n\nvar delimiterChangeToken = { t: DELIMCHANGE, exclude: true };\n\nfunction readMustache ( parser ) {\n\tvar mustache, i;\n\n\t// If we're inside a <script> or <style> tag, and we're not\n\t// interpolating, bug out\n\tif ( parser.interpolate[ parser.inside ] === false ) {\n\t\treturn null;\n\t}\n\n\tfor ( i = 0; i < parser.tags.length; i += 1 ) {\n\t\tif ( mustache = readMustacheOfType( parser, parser.tags[i] ) ) {\n\t\t\treturn mustache;\n\t\t}\n\t}\n\n\tif ( parser.inTag && !parser.inAttribute ) {\n\t\tmustache = readAttributeOrDirective( parser );\n\t\tif ( mustache ) {\n\t\t\tparser.allowWhitespace();\n\t\t\treturn mustache;\n\t\t}\n\t}\n}\n\nfunction readMustacheOfType ( parser, tag ) {\n\tvar start, mustache, reader, i;\n\n\tstart = parser.pos;\n\n\tif ( parser.matchString( '\\\\' + tag.open ) ) {\n\t\tif ( start === 0 || parser.str[ start - 1 ] !== '\\\\' ) {\n\t\t\treturn tag.open;\n\t\t}\n\t} else if ( !parser.matchString( tag.open ) ) {\n\t\treturn null;\n\t}\n\n\t// delimiter change?\n\tif ( mustache = readDelimiterChange( parser ) ) {\n\t\t// find closing delimiter or abort...\n\t\tif ( !parser.matchString( tag.close ) ) {\n\t\t\treturn null;\n\t\t}\n\n\t\t// ...then make the switch\n\t\ttag.open = mustache[0];\n\t\ttag.close = mustache[1];\n\t\tparser.sortMustacheTags();\n\n\t\treturn delimiterChangeToken;\n\t}\n\n\tparser.allowWhitespace();\n\n\t// illegal section closer\n\tif ( parser.matchString( '/' ) ) {\n\t\tparser.pos -= 1;\n\t\tvar rewind = parser.pos;\n\t\tif ( !readNumberLiteral( parser ) ) {\n\t\t\tparser.pos = rewind - ( tag.close.length );\n\t\t\tif ( parser.inAttribute ) {\n\t\t\t\tparser.pos = start;\n\t\t\t\treturn null;\n\t\t\t} else {\n\t\t\t\tparser.error( 'Attempted to close a section that wasn\\'t open' );\n\t\t\t}\n\t\t} else {\n\t\t\tparser.pos = rewind;\n\t\t}\n\t}\n\n\tfor ( i = 0; i < tag.readers.length; i += 1 ) {\n\t\treader = tag.readers[i];\n\n\t\tif ( mustache = reader( parser, tag ) ) {\n\t\t\tif ( tag.isStatic ) {\n\t\t\t\tmustache.s = true; // TODO make this `1` instead - more compact\n\t\t\t}\n\n\t\t\tif ( parser.includeLinePositions ) {\n\t\t\t\tmustache.p = parser.getLinePos( start );\n\t\t\t}\n\n\t\t\treturn mustache;\n\t\t}\n\t}\n\n\tparser.pos = start;\n\treturn null;\n}\n\nfunction refineExpression ( expression, mustache ) {\n\tvar referenceExpression;\n\n\tif ( expression ) {\n\t\twhile ( expression.t === BRACKETED && expression.x ) {\n\t\t\texpression = expression.x;\n\t\t}\n\n\t\tif ( expression.t === REFERENCE ) {\n\t\t\tmustache.r = expression.n;\n\t\t} else {\n\t\t\tif ( referenceExpression = getReferenceExpression( expression ) ) {\n\t\t\t\tmustache.rx = referenceExpression;\n\t\t\t} else {\n\t\t\t\tmustache.x = flattenExpression( expression );\n\t\t\t}\n\t\t}\n\n\t\treturn mustache;\n\t}\n}\n\n// TODO refactor this! it's bewildering\nfunction getReferenceExpression ( expression ) {\n\tvar members = [], refinement;\n\n\twhile ( expression.t === MEMBER && expression.r.t === REFINEMENT ) {\n\t\trefinement = expression.r;\n\n\t\tif ( refinement.x ) {\n\t\t\tif ( refinement.x.t === REFERENCE ) {\n\t\t\t\tmembers.unshift( refinement.x );\n\t\t\t} else {\n\t\t\t\tmembers.unshift( flattenExpression( refinement.x ) );\n\t\t\t}\n\t\t} else {\n\t\t\tmembers.unshift( refinement.n );\n\t\t}\n\n\t\texpression = expression.x;\n\t}\n\n\tif ( expression.t !== REFERENCE ) {\n\t\treturn null;\n\t}\n\n\treturn {\n\t\tr: expression.n,\n\t\tm: members\n\t};\n}\n\nfunction readTriple ( parser, tag ) {\n\tvar expression = readExpression( parser ), triple;\n\n\tif ( !expression ) {\n\t\treturn null;\n\t}\n\n\tif ( !parser.matchString( tag.close ) ) {\n\t\tparser.error( (\"Expected closing delimiter '\" + (tag.close) + \"'\") );\n\t}\n\n\ttriple = { t: TRIPLE };\n\trefineExpression( expression, triple ); // TODO handle this differently - it's mysterious\n\n\treturn triple;\n}\n\nfunction readUnescaped ( parser, tag ) {\n\tvar expression, triple;\n\n\tif ( !parser.matchString( '&' ) ) {\n\t\treturn null;\n\t}\n\n\tparser.allowWhitespace();\n\n\texpression = readExpression( parser );\n\n\tif ( !expression ) {\n\t\treturn null;\n\t}\n\n\tif ( !parser.matchString( tag.close ) ) {\n\t\tparser.error( (\"Expected closing delimiter '\" + (tag.close) + \"'\") );\n\t}\n\n\ttriple = { t: TRIPLE };\n\trefineExpression( expression, triple ); // TODO handle this differently - it's mysterious\n\n\treturn triple;\n}\n\nvar legalAlias = /^(?:[a-zA-Z$_0-9]|\\\\\\.)+(?:(?:(?:[a-zA-Z$_0-9]|\\\\\\.)+)|(?:\\[[0-9]+\\]))*/;\nvar asRE = /^as/i;\n\nfunction readAliases( parser ) {\n\tvar aliases = [], alias, start = parser.pos;\n\n\tparser.allowWhitespace();\n\n\talias = readAlias( parser );\n\n\tif ( alias ) {\n\t\talias.x = refineExpression( alias.x, {} );\n\t\taliases.push( alias );\n\n\t\tparser.allowWhitespace();\n\n\t\twhile ( parser.matchString(',') ) {\n\t\t\talias = readAlias( parser );\n\n\t\t\tif ( !alias ) {\n\t\t\t\tparser.error( 'Expected another alias.' );\n\t\t\t}\n\n\t\t\talias.x = refineExpression( alias.x, {} );\n\t\t\taliases.push( alias );\n\n\t\t\tparser.allowWhitespace();\n\t\t}\n\n\t\treturn aliases;\n\t}\n\n\tparser.pos = start;\n\treturn null;\n}\n\nfunction readAlias( parser ) {\n\tvar expr, alias, start = parser.pos;\n\n\tparser.allowWhitespace();\n\n\texpr = readExpression( parser, [] );\n\n\tif ( !expr ) {\n\t\tparser.pos = start;\n\t\treturn null;\n\t}\n\n\tparser.allowWhitespace();\n\n\tif ( !parser.matchPattern( asRE ) ) {\n\t\tparser.pos = start;\n\t\treturn null;\n\t}\n\n\tparser.allowWhitespace();\n\n\talias = parser.matchPattern( legalAlias );\n\n\tif ( !alias ) {\n\t\tparser.error( 'Expected a legal alias name.' );\n\t}\n\n\treturn { n: alias, x: expr };\n}\n\nfunction readPartial ( parser, tag ) {\n\tif ( !parser.matchString( '>' ) ) return null;\n\n\tparser.allowWhitespace();\n\n\t// Partial names can include hyphens, so we can't use readExpression\n\t// blindly. Instead, we use the `relaxedNames` flag to indicate that\n\t// `foo-bar` should be read as a single name, rather than 'subtract\n\t// bar from foo'\n\tparser.relaxedNames = parser.strictRefinement = true;\n\tvar expression = readExpression( parser );\n\tparser.relaxedNames = parser.strictRefinement = false;\n\n\tif ( !expression ) return null;\n\n\tvar partial = { t: PARTIAL };\n\trefineExpression( expression, partial ); // TODO...\n\n\tparser.allowWhitespace();\n\n\t// check for alias context e.g. `{{>foo bar as bat, bip as bop}}` then\n\t// turn it into `{{#with bar as bat, bip as bop}}{{>foo}}{{/with}}`\n\tvar aliases = readAliases( parser );\n\tif ( aliases ) {\n\t\tpartial = {\n\t\t\tt: ALIAS,\n\t\t\tz: aliases,\n\t\t\tf: [ partial ]\n\t\t};\n\t}\n\n\t// otherwise check for literal context e.g. `{{>foo bar}}` then\n\t// turn it into `{{#with bar}}{{>foo}}{{/with}}`\n\telse {\n\t\tvar context = readExpression( parser );\n\t\tif ( context) {\n\t\t\tpartial = {\n\t\t\t\tt: SECTION,\n\t\t\t\tn: SECTION_WITH,\n\t\t\t\tf: [ partial ]\n\t\t\t};\n\n\t\t\trefineExpression( context, partial );\n\t\t}\n\t}\n\n\tparser.allowWhitespace();\n\n\tif ( !parser.matchString( tag.close ) ) {\n\t\tparser.error( (\"Expected closing delimiter '\" + (tag.close) + \"'\") );\n\t}\n\n\treturn partial;\n}\n\nfunction readComment ( parser, tag ) {\n\tvar index;\n\n\tif ( !parser.matchString( '!' ) ) {\n\t\treturn null;\n\t}\n\n\tindex = parser.remaining().indexOf( tag.close );\n\n\tif ( index !== -1 ) {\n\t\tparser.pos += index + tag.close.length;\n\t\treturn { t: COMMENT };\n\t}\n}\n\nfunction readExpressionOrReference ( parser, expectedFollowers ) {\n\tvar start, expression, i;\n\n\tstart = parser.pos;\n\texpression = readExpression( parser );\n\n\tif ( !expression ) {\n\t\t// valid reference but invalid expression e.g. `{{new}}`?\n\t\tvar ref = parser.matchPattern( /^(\\w+)/ );\n\t\tif ( ref ) {\n\t\t\treturn {\n\t\t\t\tt: REFERENCE,\n\t\t\t\tn: ref\n\t\t\t};\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tfor ( i = 0; i < expectedFollowers.length; i += 1 ) {\n\t\tif ( parser.remaining().substr( 0, expectedFollowers[i].length ) === expectedFollowers[i] ) {\n\t\t\treturn expression;\n\t\t}\n\t}\n\n\tparser.pos = start;\n\treturn readReference( parser );\n}\n\nfunction readInterpolator ( parser, tag ) {\n\tvar start, expression, interpolator, err;\n\n\tstart = parser.pos;\n\n\t// TODO would be good for perf if we could do away with the try-catch\n\ttry {\n\t\texpression = readExpressionOrReference( parser, [ tag.close ]);\n\t} catch ( e ) {\n\t\terr = e;\n\t}\n\n\tif ( !expression ) {\n\t\tif ( parser.str.charAt( start ) === '!' ) {\n\t\t\t// special case - comment\n\t\t\tparser.pos = start;\n\t\t\treturn null;\n\t\t}\n\n\t\tif ( err ) {\n\t\t\tthrow err;\n\t\t}\n\t}\n\n\tif ( !parser.matchString( tag.close ) ) {\n\t\tparser.error( (\"Expected closing delimiter '\" + (tag.close) + \"' after reference\") );\n\n\t\tif ( !expression ) {\n\t\t\t// special case - comment\n\t\t\tif ( parser.nextChar() === '!' ) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tparser.error( (\"Expected expression or legal reference\") );\n\t\t}\n\t}\n\n\tinterpolator = { t: INTERPOLATOR };\n\trefineExpression( expression, interpolator ); // TODO handle this differently - it's mysterious\n\n\treturn interpolator;\n}\n\nvar yieldPattern = /^yield\\s*/;\n\nfunction readYielder ( parser, tag ) {\n\tif ( !parser.matchPattern( yieldPattern ) ) return null;\n\n\tvar name = parser.matchPattern( /^[a-zA-Z_$][a-zA-Z_$0-9\\-]*/ );\n\n\tparser.allowWhitespace();\n\n\tif ( !parser.matchString( tag.close ) ) {\n\t\tparser.error( (\"expected legal partial name\") );\n\t}\n\n\tvar yielder = { t: YIELDER };\n\tif ( name ) yielder.n = name;\n\n\treturn yielder;\n}\n\nfunction readClosing ( parser, tag ) {\n\tvar start, remaining, index, closing;\n\n\tstart = parser.pos;\n\n\tif ( !parser.matchString( tag.open ) ) {\n\t\treturn null;\n\t}\n\n\tparser.allowWhitespace();\n\n\tif ( !parser.matchString( '/' ) ) {\n\t\tparser.pos = start;\n\t\treturn null;\n\t}\n\n\tparser.allowWhitespace();\n\n\tremaining = parser.remaining();\n\tindex = remaining.indexOf( tag.close );\n\n\tif ( index !== -1 ) {\n\t\tclosing = {\n\t\t\tt: CLOSING,\n\t\t\tr: remaining.substr( 0, index ).split( ' ' )[0]\n\t\t};\n\n\t\tparser.pos += index;\n\n\t\tif ( !parser.matchString( tag.close ) ) {\n\t\t\tparser.error( (\"Expected closing delimiter '\" + (tag.close) + \"'\") );\n\t\t}\n\n\t\treturn closing;\n\t}\n\n\tparser.pos = start;\n\treturn null;\n}\n\nvar elsePattern = /^\\s*else\\s*/;\n\nfunction readElse ( parser, tag ) {\n\tvar start = parser.pos;\n\n\tif ( !parser.matchString( tag.open ) ) {\n\t\treturn null;\n\t}\n\n\tif ( !parser.matchPattern( elsePattern ) ) {\n\t\tparser.pos = start;\n\t\treturn null;\n\t}\n\n\tif ( !parser.matchString( tag.close ) ) {\n\t\tparser.error( (\"Expected closing delimiter '\" + (tag.close) + \"'\") );\n\t}\n\n\treturn {\n\t\tt: ELSE\n\t};\n}\n\nvar elsePattern$1 = /^\\s*elseif\\s+/;\n\nfunction readElseIf ( parser, tag ) {\n\tvar start = parser.pos;\n\n\tif ( !parser.matchString( tag.open ) ) {\n\t\treturn null;\n\t}\n\n\tif ( !parser.matchPattern( elsePattern$1 ) ) {\n\t\tparser.pos = start;\n\t\treturn null;\n\t}\n\n\tvar expression = readExpression( parser );\n\n\tif ( !parser.matchString( tag.close ) ) {\n\t\tparser.error( (\"Expected closing delimiter '\" + (tag.close) + \"'\") );\n\t}\n\n\treturn {\n\t\tt: ELSEIF,\n\t\tx: expression\n\t};\n}\n\nvar handlebarsBlockCodes = {\n\t'each':    SECTION_EACH,\n\t'if':      SECTION_IF,\n\t'with':    SECTION_IF_WITH,\n\t'unless':  SECTION_UNLESS\n};\n\nvar indexRefPattern = /^\\s*:\\s*([a-zA-Z_$][a-zA-Z_$0-9]*)/;\nvar keyIndexRefPattern = /^\\s*,\\s*([a-zA-Z_$][a-zA-Z_$0-9]*)/;\nvar handlebarsBlockPattern = new RegExp( '^(' + Object.keys( handlebarsBlockCodes ).join( '|' ) + ')\\\\b' );\n\nfunction readSection ( parser, tag ) {\n\tvar start, expression, section, child, children, hasElse, block, unlessBlock, conditions, closed, i, expectedClose, aliasOnly = false;\n\n\tstart = parser.pos;\n\n\tif ( parser.matchString( '^' ) ) {\n\t\tsection = { t: SECTION, f: [], n: SECTION_UNLESS };\n\t} else if ( parser.matchString( '#' ) ) {\n\t\tsection = { t: SECTION, f: [] };\n\n\t\tif ( parser.matchString( 'partial' ) ) {\n\t\t\tparser.pos = start - parser.standardDelimiters[0].length;\n\t\t\tparser.error( 'Partial definitions can only be at the top level of the template, or immediately inside components' );\n\t\t}\n\n\t\tif ( block = parser.matchPattern( handlebarsBlockPattern ) ) {\n\t\t\texpectedClose = block;\n\t\t\tsection.n = handlebarsBlockCodes[ block ];\n\t\t}\n\t} else {\n\t\treturn null;\n\t}\n\n\tparser.allowWhitespace();\n\n\tif ( block === 'with' ) {\n\t\tvar aliases = readAliases( parser );\n\t\tif ( aliases ) {\n\t\t\taliasOnly = true;\n\t\t\tsection.z = aliases;\n\t\t\tsection.t = ALIAS;\n\t\t}\n\t} else if ( block === 'each' ) {\n\t\tvar alias = readAlias( parser );\n\t\tif ( alias ) {\n\t\t\tsection.z = [ { n: alias.n, x: { r: '.' } } ];\n\t\t\texpression = alias.x;\n\t\t}\n\t}\n\n\tif ( !aliasOnly ) {\n\t\tif ( !expression ) expression = readExpression( parser );\n\n\t\tif ( !expression ) {\n\t\t\tparser.error( 'Expected expression' );\n\t\t}\n\n\t\t// optional index and key references\n\t\tif ( i = parser.matchPattern( indexRefPattern ) ) {\n\t\t\tvar extra;\n\n\t\t\tif ( extra = parser.matchPattern( keyIndexRefPattern ) ) {\n\t\t\t\tsection.i = i + ',' + extra;\n\t\t\t} else {\n\t\t\t\tsection.i = i;\n\t\t\t}\n\t\t}\n\t}\n\n\tparser.allowWhitespace();\n\n\tif ( !parser.matchString( tag.close ) ) {\n\t\tparser.error( (\"Expected closing delimiter '\" + (tag.close) + \"'\") );\n\t}\n\n\tparser.sectionDepth += 1;\n\tchildren = section.f;\n\n\tconditions = [];\n\n\tdo {\n\t\tif ( child = readClosing( parser, tag ) ) {\n\t\t\tif ( expectedClose && child.r !== expectedClose ) {\n\t\t\t\tparser.error( (\"Expected \" + (tag.open) + \"/\" + expectedClose + \"\" + (tag.close)) );\n\t\t\t}\n\n\t\t\tparser.sectionDepth -= 1;\n\t\t\tclosed = true;\n\t\t}\n\n\t\telse if ( !aliasOnly && ( child = readElseIf( parser, tag ) ) ) {\n\t\t\tif ( section.n === SECTION_UNLESS ) {\n\t\t\t\tparser.error( '{{else}} not allowed in {{#unless}}' );\n\t\t\t}\n\n\t\t\tif ( hasElse ) {\n\t\t\t\tparser.error( 'illegal {{elseif...}} after {{else}}' );\n\t\t\t}\n\n\t\t\tif ( !unlessBlock ) {\n\t\t\t\tunlessBlock = [];\n\t\t\t}\n\n\t\t\tvar mustache = {\n\t\t\t\tt: SECTION,\n\t\t\t\tn: SECTION_IF,\n\t\t\t\tf: children = []\n\t\t\t};\n\t\t\trefineExpression( child.x, mustache );\n\n\t\t\tunlessBlock.push( mustache );\n\t\t}\n\n\t\telse if ( !aliasOnly && ( child = readElse( parser, tag ) ) ) {\n\t\t\tif ( section.n === SECTION_UNLESS ) {\n\t\t\t\tparser.error( '{{else}} not allowed in {{#unless}}' );\n\t\t\t}\n\n\t\t\tif ( hasElse ) {\n\t\t\t\tparser.error( 'there can only be one {{else}} block, at the end of a section' );\n\t\t\t}\n\n\t\t\thasElse = true;\n\n\t\t\t// use an unless block if there's no elseif\n\t\t\tif ( !unlessBlock ) {\n\t\t\t\tunlessBlock = [];\n\t\t\t}\n\n\t\t\tunlessBlock.push({\n\t\t\t\tt: SECTION,\n\t\t\t\tn: SECTION_UNLESS,\n\t\t\t\tf: children = []\n\t\t\t});\n\t\t}\n\n\t\telse {\n\t\t\tchild = parser.read( READERS );\n\n\t\t\tif ( !child ) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tchildren.push( child );\n\t\t}\n\t} while ( !closed );\n\n\tif ( unlessBlock ) {\n\t\tsection.l = unlessBlock;\n\t}\n\n\tif ( !aliasOnly ) {\n\t\trefineExpression( expression, section );\n\t}\n\n\t// TODO if a section is empty it should be discarded. Don't do\n\t// that here though - we need to clean everything up first, as\n\t// it may contain removeable whitespace. As a temporary measure,\n\t// to pass the existing tests, remove empty `f` arrays\n\tif ( !section.f.length ) {\n\t\tdelete section.f;\n\t}\n\n\treturn section;\n}\n\nvar OPEN_COMMENT = '<!--';\nvar CLOSE_COMMENT = '-->';\n\nfunction readHtmlComment ( parser ) {\n\tvar start, content, remaining, endIndex, comment;\n\n\tstart = parser.pos;\n\n\tif ( !parser.matchString( OPEN_COMMENT ) ) {\n\t\treturn null;\n\t}\n\n\tremaining = parser.remaining();\n\tendIndex = remaining.indexOf( CLOSE_COMMENT );\n\n\tif ( endIndex === -1 ) {\n\t\tparser.error( 'Illegal HTML - expected closing comment sequence (\\'-->\\')' );\n\t}\n\n\tcontent = remaining.substr( 0, endIndex );\n\tparser.pos += endIndex + 3;\n\n\tcomment = {\n\t\tt: COMMENT,\n\t\tc: content\n\t};\n\n\tif ( parser.includeLinePositions ) {\n\t\tcomment.p = parser.getLinePos( start );\n\t}\n\n\treturn comment;\n}\n\nvar leadingLinebreak = /^[ \\t\\f\\r\\n]*\\r?\\n/;\nvar trailingLinebreak = /\\r?\\n[ \\t\\f\\r\\n]*$/;\n\nvar stripStandalones = function ( items ) {\n\tvar i, current, backOne, backTwo, lastSectionItem;\n\n\tfor ( i=1; i<items.length; i+=1 ) {\n\t\tcurrent = items[i];\n\t\tbackOne = items[i-1];\n\t\tbackTwo = items[i-2];\n\n\t\t// if we're at the end of a [text][comment][text] sequence...\n\t\tif ( isString( current ) && isComment( backOne ) && isString( backTwo ) ) {\n\n\t\t\t// ... and the comment is a standalone (i.e. line breaks either side)...\n\t\t\tif ( trailingLinebreak.test( backTwo ) && leadingLinebreak.test( current ) ) {\n\n\t\t\t\t// ... then we want to remove the whitespace after the first line break\n\t\t\t\titems[i-2] = backTwo.replace( trailingLinebreak, '\\n' );\n\n\t\t\t\t// and the leading line break of the second text token\n\t\t\t\titems[i] = current.replace( leadingLinebreak, '' );\n\t\t\t}\n\t\t}\n\n\t\t// if the current item is a section, and it is preceded by a linebreak, and\n\t\t// its first item is a linebreak...\n\t\tif ( isSection( current ) && isString( backOne ) ) {\n\t\t\tif ( trailingLinebreak.test( backOne ) && isString( current.f[0] ) && leadingLinebreak.test( current.f[0] ) ) {\n\t\t\t\titems[i-1] = backOne.replace( trailingLinebreak, '\\n' );\n\t\t\t\tcurrent.f[0] = current.f[0].replace( leadingLinebreak, '' );\n\t\t\t}\n\t\t}\n\n\t\t// if the last item was a section, and it is followed by a linebreak, and\n\t\t// its last item is a linebreak...\n\t\tif ( isString( current ) && isSection( backOne ) ) {\n\t\t\tlastSectionItem = lastItem( backOne.f );\n\n\t\t\tif ( isString( lastSectionItem ) && trailingLinebreak.test( lastSectionItem ) && leadingLinebreak.test( current ) ) {\n\t\t\t\tbackOne.f[ backOne.f.length - 1 ] = lastSectionItem.replace( trailingLinebreak, '\\n' );\n\t\t\t\titems[i] = current.replace( leadingLinebreak, '' );\n\t\t\t}\n\t\t}\n\t}\n\n\treturn items;\n};\n\nfunction isString ( item ) {\n\treturn typeof item === 'string';\n}\n\nfunction isComment ( item ) {\n\treturn item.t === COMMENT || item.t === DELIMCHANGE;\n}\n\nfunction isSection ( item ) {\n\treturn ( item.t === SECTION || item.t === INVERTED ) && item.f;\n}\n\nvar trimWhitespace = function ( items, leadingPattern, trailingPattern ) {\n\tvar item;\n\n\tif ( leadingPattern ) {\n\t\titem = items[0];\n\t\tif ( typeof item === 'string' ) {\n\t\t\titem = item.replace( leadingPattern, '' );\n\n\t\t\tif ( !item ) {\n\t\t\t\titems.shift();\n\t\t\t} else {\n\t\t\t\titems[0] = item;\n\t\t\t}\n\t\t}\n\t}\n\n\tif ( trailingPattern ) {\n\t\titem = lastItem( items );\n\t\tif ( typeof item === 'string' ) {\n\t\t\titem = item.replace( trailingPattern, '' );\n\n\t\t\tif ( !item ) {\n\t\t\t\titems.pop();\n\t\t\t} else {\n\t\t\t\titems[ items.length - 1 ] = item;\n\t\t\t}\n\t\t}\n\t}\n};\n\nvar contiguousWhitespace = /[ \\t\\f\\r\\n]+/g;\nvar preserveWhitespaceElements = /^(?:pre|script|style|textarea)$/i;\nvar leadingWhitespace$1 = /^[ \\t\\f\\r\\n]+/;\nvar trailingWhitespace = /[ \\t\\f\\r\\n]+$/;\nvar leadingNewLine = /^(?:\\r\\n|\\r|\\n)/;\nvar trailingNewLine = /(?:\\r\\n|\\r|\\n)$/;\n\nfunction cleanup ( items, stripComments, preserveWhitespace, removeLeadingWhitespace, removeTrailingWhitespace ) {\n\tif ( typeof items === 'string' ) return;\n\n\tvar i,\n\t\titem,\n\t\tpreviousItem,\n\t\tnextItem,\n\t\tpreserveWhitespaceInsideFragment,\n\t\tremoveLeadingWhitespaceInsideFragment,\n\t\tremoveTrailingWhitespaceInsideFragment,\n\t\tkey;\n\n\t// First pass - remove standalones and comments etc\n\tstripStandalones( items );\n\n\ti = items.length;\n\twhile ( i-- ) {\n\t\titem = items[i];\n\n\t\t// Remove delimiter changes, unsafe elements etc\n\t\tif ( item.exclude ) {\n\t\t\titems.splice( i, 1 );\n\t\t}\n\n\t\t// Remove comments, unless we want to keep them\n\t\telse if ( stripComments && item.t === COMMENT ) {\n\t\t\titems.splice( i, 1 );\n\t\t}\n\t}\n\n\t// If necessary, remove leading and trailing whitespace\n\ttrimWhitespace( items, removeLeadingWhitespace ? leadingWhitespace$1 : null, removeTrailingWhitespace ? trailingWhitespace : null );\n\n\ti = items.length;\n\twhile ( i-- ) {\n\t\titem = items[i];\n\n\t\t// Recurse\n\t\tif ( item.f ) {\n\t\t\tvar isPreserveWhitespaceElement = item.t === ELEMENT && preserveWhitespaceElements.test( item.e );\n\t\t\tpreserveWhitespaceInsideFragment = preserveWhitespace || isPreserveWhitespaceElement;\n\n\t\t\tif ( !preserveWhitespace && isPreserveWhitespaceElement ) {\n\t\t\t\ttrimWhitespace( item.f, leadingNewLine, trailingNewLine );\n\t\t\t}\n\n\t\t\tif ( !preserveWhitespaceInsideFragment ) {\n\t\t\t\tpreviousItem = items[ i - 1 ];\n\t\t\t\tnextItem = items[ i + 1 ];\n\n\t\t\t\t// if the previous item was a text item with trailing whitespace,\n\t\t\t\t// remove leading whitespace inside the fragment\n\t\t\t\tif ( !previousItem || ( typeof previousItem === 'string' && trailingWhitespace.test( previousItem ) ) ) {\n\t\t\t\t\tremoveLeadingWhitespaceInsideFragment = true;\n\t\t\t\t}\n\n\t\t\t\t// and vice versa\n\t\t\t\tif ( !nextItem || ( typeof nextItem === 'string' && leadingWhitespace$1.test( nextItem ) ) ) {\n\t\t\t\t\tremoveTrailingWhitespaceInsideFragment = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcleanup( item.f, stripComments, preserveWhitespaceInsideFragment, removeLeadingWhitespaceInsideFragment, removeTrailingWhitespaceInsideFragment );\n\n\t\t\t// clean up name templates (events, decorators, etc)\n\t\t\tif ( isArray( item.f.n ) ) {\n\t\t\t\tcleanup( item.f.n, stripComments, preserveWhitespace, removeLeadingWhitespaceInsideFragment, removeTrailingWhitespace );\n\t\t\t}\n\n\t\t\t// clean up arg templates (events, decorators, etc)\n\t\t\tif ( isArray( item.f.d ) ) {\n\t\t\t\tcleanup( item.f.d, stripComments, preserveWhitespace, removeLeadingWhitespaceInsideFragment, removeTrailingWhitespace );\n\t\t\t}\n\t\t}\n\n\t\t// Split if-else blocks into two (an if, and an unless)\n\t\tif ( item.l ) {\n\t\t\tcleanup( item.l, stripComments, preserveWhitespace, removeLeadingWhitespaceInsideFragment, removeTrailingWhitespaceInsideFragment );\n\n\t\t\titem.l.forEach( function ( s ) { return s.l = 1; } );\n\t\t\titem.l.unshift( i + 1, 0 );\n\t\t\titems.splice.apply( items, item.l );\n\t\t\tdelete item.l; // TODO would be nice if there was a way around this\n\t\t}\n\n\t\t// Clean up element attributes\n\t\tif ( item.a ) {\n\t\t\tfor ( key in item.a ) {\n\t\t\t\tif ( item.a.hasOwnProperty( key ) && typeof item.a[ key ] !== 'string' ) {\n\t\t\t\t\tcleanup( item.a[ key ], stripComments, preserveWhitespace, removeLeadingWhitespaceInsideFragment, removeTrailingWhitespaceInsideFragment );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// Clean up conditional attributes\n\t\tif ( item.m ) {\n\t\t\tcleanup( item.m, stripComments, preserveWhitespace, removeLeadingWhitespaceInsideFragment, removeTrailingWhitespaceInsideFragment );\n\t\t\tif ( item.m.length < 1 ) delete item.m;\n\t\t}\n\t}\n\n\t// final pass - fuse text nodes together\n\ti = items.length;\n\twhile ( i-- ) {\n\t\tif ( typeof items[i] === 'string' ) {\n\t\t\tif ( typeof items[i+1] === 'string' ) {\n\t\t\t\titems[i] = items[i] + items[i+1];\n\t\t\t\titems.splice( i + 1, 1 );\n\t\t\t}\n\n\t\t\tif ( !preserveWhitespace ) {\n\t\t\t\titems[i] = items[i].replace( contiguousWhitespace, ' ' );\n\t\t\t}\n\n\t\t\tif ( items[i] === '' ) {\n\t\t\t\titems.splice( i, 1 );\n\t\t\t}\n\t\t}\n\t}\n}\n\nvar closingTagPattern = /^([a-zA-Z]{1,}:?[a-zA-Z0-9\\-]*)\\s*\\>/;\n\nfunction readClosingTag ( parser ) {\n\tvar start, tag;\n\n\tstart = parser.pos;\n\n\t// are we looking at a closing tag?\n\tif ( !parser.matchString( '</' ) ) {\n\t\treturn null;\n\t}\n\n\tif ( tag = parser.matchPattern( closingTagPattern ) ) {\n\t\tif ( parser.inside && tag !== parser.inside ) {\n\t\t\tparser.pos = start;\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\tt: CLOSING_TAG,\n\t\t\te: tag\n\t\t};\n\t}\n\n\t// We have an illegal closing tag, report it\n\tparser.pos -= 2;\n\tparser.error( 'Illegal closing tag' );\n}\n\nvar tagNamePattern = /^[a-zA-Z]{1,}:?[a-zA-Z0-9\\-]*/;\nvar validTagNameFollower = /^[\\s\\n\\/>]/;\nvar exclude = { exclude: true };\nvar disallowedContents;\n\n// based on http://developers.whatwg.org/syntax.html#syntax-tag-omission\ndisallowedContents = {\n\tli: [ 'li' ],\n\tdt: [ 'dt', 'dd' ],\n\tdd: [ 'dt', 'dd' ],\n\tp: 'address article aside blockquote div dl fieldset footer form h1 h2 h3 h4 h5 h6 header hgroup hr main menu nav ol p pre section table ul'.split( ' ' ),\n\trt: [ 'rt', 'rp' ],\n\trp: [ 'rt', 'rp' ],\n\toptgroup: [ 'optgroup' ],\n\toption: [ 'option', 'optgroup' ],\n\tthead: [ 'tbody', 'tfoot' ],\n\ttbody: [ 'tbody', 'tfoot' ],\n\ttfoot: [ 'tbody' ],\n\ttr: [ 'tr', 'tbody' ],\n\ttd: [ 'td', 'th', 'tr' ],\n\tth: [ 'td', 'th', 'tr' ]\n};\n\nfunction readElement$1 ( parser ) {\n\tvar start,\n\t\telement,\n\t\tattribute,\n\t\tselfClosing,\n\t\tchildren,\n\t\tpartials,\n\t\thasPartials,\n\t\tchild,\n\t\tclosed,\n\t\tpos,\n\t\tremaining,\n\t\tclosingTag;\n\n\tstart = parser.pos;\n\n\tif ( parser.inside || parser.inAttribute ) {\n\t\treturn null;\n\t}\n\n\tif ( !parser.matchString( '<' ) ) {\n\t\treturn null;\n\t}\n\n\t// if this is a closing tag, abort straight away\n\tif ( parser.nextChar() === '/' ) {\n\t\treturn null;\n\t}\n\n\telement = {};\n\tif ( parser.includeLinePositions ) {\n\t\telement.p = parser.getLinePos( start );\n\t}\n\n\tif ( parser.matchString( '!' ) ) {\n\t\telement.t = DOCTYPE;\n\t\tif ( !parser.matchPattern( /^doctype/i ) ) {\n\t\t\tparser.error( 'Expected DOCTYPE declaration' );\n\t\t}\n\n\t\telement.a = parser.matchPattern( /^(.+?)>/ );\n\t\treturn element;\n\t}\n\n\telement.t = ELEMENT;\n\n\t// element name\n\telement.e = parser.matchPattern( tagNamePattern );\n\tif ( !element.e ) {\n\t\treturn null;\n\t}\n\n\t// next character must be whitespace, closing solidus or '>'\n\tif ( !validTagNameFollower.test( parser.nextChar() ) ) {\n\t\tparser.error( 'Illegal tag name' );\n\t}\n\n\tparser.allowWhitespace();\n\n\tparser.inTag = true;\n\n\t// directives and attributes\n\twhile ( attribute = readMustache( parser ) ) {\n\t\tif ( attribute !== false ) {\n\t\t\tif ( !element.m ) element.m = [];\n\t\t\telement.m.push( attribute );\n\t\t}\n\n\t\tparser.allowWhitespace();\n\t}\n\n\tparser.inTag = false;\n\n\t// allow whitespace before closing solidus\n\tparser.allowWhitespace();\n\n\t// self-closing solidus?\n\tif ( parser.matchString( '/' ) ) {\n\t\tselfClosing = true;\n\t}\n\n\t// closing angle bracket\n\tif ( !parser.matchString( '>' ) ) {\n\t\treturn null;\n\t}\n\n\tvar lowerCaseName = element.e.toLowerCase();\n\tvar preserveWhitespace = parser.preserveWhitespace;\n\n\tif ( !selfClosing && !voidElementNames.test( element.e ) ) {\n\t\tparser.elementStack.push( lowerCaseName );\n\n\t\t// Special case - if we open a script element, further tags should\n\t\t// be ignored unless they're a closing script element\n\t\tif ( lowerCaseName === 'script' || lowerCaseName === 'style' || lowerCaseName === 'textarea' ) {\n\t\t\tparser.inside = lowerCaseName;\n\t\t}\n\n\t\tchildren = [];\n\t\tpartials = create( null );\n\n\t\tdo {\n\t\t\tpos = parser.pos;\n\t\t\tremaining = parser.remaining();\n\n\t\t\tif ( !remaining ) {\n\t\t\t\tparser.error( (\"Missing end \" + (parser.elementStack.length > 1 ? 'tags' : 'tag') + \" (\" + (parser.elementStack.reverse().map( function ( x ) { return (\"</\" + x + \">\"); } ).join( '' )) + \")\") );\n\t\t\t}\n\n\t\t\t// if for example we're in an <li> element, and we see another\n\t\t\t// <li> tag, close the first so they become siblings\n\t\t\tif ( !canContain( lowerCaseName, remaining ) ) {\n\t\t\t\tclosed = true;\n\t\t\t}\n\n\t\t\t// closing tag\n\t\t\telse if ( closingTag = readClosingTag( parser ) ) {\n\t\t\t\tclosed = true;\n\n\t\t\t\tvar closingTagName = closingTag.e.toLowerCase();\n\n\t\t\t\t// if this *isn't* the closing tag for the current element...\n\t\t\t\tif ( closingTagName !== lowerCaseName ) {\n\t\t\t\t\t// rewind parser\n\t\t\t\t\tparser.pos = pos;\n\n\t\t\t\t\t// if it doesn't close a parent tag, error\n\t\t\t\t\tif ( !~parser.elementStack.indexOf( closingTagName ) ) {\n\t\t\t\t\t\tvar errorMessage = 'Unexpected closing tag';\n\n\t\t\t\t\t\t// add additional help for void elements, since component names\n\t\t\t\t\t\t// might clash with them\n\t\t\t\t\t\tif ( voidElementNames.test( closingTagName ) ) {\n\t\t\t\t\t\t\terrorMessage += \" (<\" + closingTagName + \"> is a void element - it cannot contain children)\";\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tparser.error( errorMessage );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// implicit close by closing section tag. TODO clean this up\n\t\t\telse if ( child = readClosing( parser, { open: parser.standardDelimiters[0], close: parser.standardDelimiters[1] } ) ) {\n\t\t\t\tclosed = true;\n\t\t\t\tparser.pos = pos;\n\t\t\t}\n\n\t\t\telse {\n\t\t\t\tif ( child = parser.read( PARTIAL_READERS ) ) {\n\t\t\t\t\tif ( partials[ child.n ] ) {\n\t\t\t\t\t\tparser.pos = pos;\n\t\t\t\t\t\tparser.error( 'Duplicate partial definition' );\n\t\t\t\t\t}\n\n\t\t\t\t\tcleanup( child.f, parser.stripComments, preserveWhitespace, !preserveWhitespace, !preserveWhitespace );\n\n\t\t\t\t\tpartials[ child.n ] = child.f;\n\t\t\t\t\thasPartials = true;\n\t\t\t\t}\n\n\t\t\t\telse {\n\t\t\t\t\tif ( child = parser.read( READERS ) ) {\n\t\t\t\t\t\tchildren.push( child );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tclosed = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} while ( !closed );\n\n\t\tif ( children.length ) {\n\t\t\telement.f = children;\n\t\t}\n\n\t\tif ( hasPartials ) {\n\t\t\telement.p = partials;\n\t\t}\n\n\t\tparser.elementStack.pop();\n\t}\n\n\tparser.inside = null;\n\n\tif ( parser.sanitizeElements && parser.sanitizeElements.indexOf( lowerCaseName ) !== -1 ) {\n\t\treturn exclude;\n\t}\n\n\treturn element;\n}\n\nfunction canContain ( name, remaining ) {\n\tvar match, disallowed;\n\n\tmatch = /^<([a-zA-Z][a-zA-Z0-9]*)/.exec( remaining );\n\tdisallowed = disallowedContents[ name ];\n\n\tif ( !match || !disallowed ) {\n\t\treturn true;\n\t}\n\n\treturn !~disallowed.indexOf( match[1].toLowerCase() );\n}\n\nfunction readText ( parser ) {\n\tvar index, remaining, disallowed, barrier;\n\n\tremaining = parser.remaining();\n\n\tif ( parser.textOnlyMode ) {\n\t\tdisallowed = parser.tags.map( function ( t ) { return t.open; } );\n\t\tdisallowed = disallowed.concat( parser.tags.map( function ( t ) { return '\\\\' + t.open; } ) );\n\n\t\tindex = getLowestIndex( remaining, disallowed );\n\t} else {\n\t\tbarrier = parser.inside ? '</' + parser.inside : '<';\n\n\t\tif ( parser.inside && !parser.interpolate[ parser.inside ] ) {\n\t\t\tindex = remaining.indexOf( barrier );\n\t\t} else {\n\t\t\tdisallowed = parser.tags.map( function ( t ) { return t.open; } );\n\t\t\tdisallowed = disallowed.concat( parser.tags.map( function ( t ) { return '\\\\' + t.open; } ) );\n\n\t\t\t// http://developers.whatwg.org/syntax.html#syntax-attributes\n\t\t\tif ( parser.inAttribute === true ) {\n\t\t\t\t// we're inside an unquoted attribute value\n\t\t\t\tdisallowed.push( (\"\\\"\"), (\"'\"), (\"=\"), (\"<\"), (\">\"), '`' );\n\t\t\t} else if ( parser.inAttribute ) {\n\t\t\t\t// quoted attribute value\n\t\t\t\tdisallowed.push( parser.inAttribute );\n\t\t\t} else {\n\t\t\t\tdisallowed.push( barrier );\n\t\t\t}\n\n\t\t\tindex = getLowestIndex( remaining, disallowed );\n\t\t}\n\t}\n\n\tif ( !index ) {\n\t\treturn null;\n\t}\n\n\tif ( index === -1 ) {\n\t\tindex = remaining.length;\n\t}\n\n\tparser.pos += index;\n\n\tif ( ( parser.inside && parser.inside !== 'textarea' ) || parser.textOnlyMode ) {\n\t\treturn remaining.substr( 0, index );\n\t} else {\n\t\treturn decodeCharacterReferences( remaining.substr( 0, index ) );\n\t}\n}\n\nvar startPattern = /^<!--\\s*/;\nvar namePattern = /s*>\\s*([a-zA-Z_$][-a-zA-Z_$0-9]*)\\s*/;\nvar finishPattern = /\\s*-->/;\n\nfunction readPartialDefinitionComment$1 ( parser ) {\n\tvar start = parser.pos;\n\tvar open = parser.standardDelimiters[0];\n\tvar close = parser.standardDelimiters[1];\n\n\tif ( !parser.matchPattern( startPattern ) || !parser.matchString( open ) ) {\n\t\tparser.pos = start;\n\t\treturn null;\n\t}\n\n\tvar name = parser.matchPattern( namePattern );\n\n\twarnOnceIfDebug( (\"Inline partial comments are deprecated.\\nUse this...\\n  {{#partial \" + name + \"}} ... {{/partial}}\\n\\n...instead of this:\\n  <!-- {{>\" + name + \"}} --> ... <!-- {{/\" + name + \"}} -->'\") );\n\n\t// make sure the rest of the comment is in the correct place\n\tif ( !parser.matchString( close ) || !parser.matchPattern( finishPattern ) ) {\n\t\tparser.pos = start;\n\t\treturn null;\n\t}\n\n\tvar content = [];\n\tvar closed;\n\n\tvar endPattern = new RegExp('^<!--\\\\s*' + escapeRegExp( open ) + '\\\\s*\\\\/\\\\s*' + name + '\\\\s*' + escapeRegExp( close ) + '\\\\s*-->');\n\n\tdo {\n\t\tif ( parser.matchPattern( endPattern ) ) {\n\t\t\tclosed = true;\n\t\t}\n\n\t\telse {\n\t\t\tvar child = parser.read( READERS );\n\t\t\tif ( !child ) {\n\t\t\t\tparser.error( (\"expected closing comment ('<!-- \" + open + \"/\" + name + \"\" + close + \" -->')\") );\n\t\t\t}\n\n\t\t\tcontent.push( child );\n\t\t}\n\t} while ( !closed );\n\n\treturn {\n\t\tt: INLINE_PARTIAL,\n\t\tf: content,\n\t\tn: name\n\t};\n}\n\nvar partialDefinitionSectionPattern = /^\\s*#\\s*partial\\s+/;\n\nfunction readPartialDefinitionSection ( parser ) {\n\tvar start, name, content, child, closed;\n\n\tstart = parser.pos;\n\n\tvar delimiters = parser.standardDelimiters;\n\n\tif ( !parser.matchString( delimiters[0] ) ) {\n\t\treturn null;\n\t}\n\n\tif ( !parser.matchPattern( partialDefinitionSectionPattern ) ) {\n\t\tparser.pos = start;\n\t\treturn null;\n\t}\n\n\tname = parser.matchPattern( /^[a-zA-Z_$][a-zA-Z_$0-9\\-\\/]*/ );\n\n\tif ( !name ) {\n\t\tparser.error( 'expected legal partial name' );\n\t}\n\n\tparser.allowWhitespace();\n\tif ( !parser.matchString( delimiters[1] ) ) {\n\t\tparser.error( (\"Expected closing delimiter '\" + (delimiters[1]) + \"'\") );\n\t}\n\n\tcontent = [];\n\n\tdo {\n\t\t// TODO clean this up\n\t\tif ( child = readClosing( parser, { open: parser.standardDelimiters[0], close: parser.standardDelimiters[1] }) ) {\n\t\t\tif ( !child.r === 'partial' ) {\n\t\t\t\tparser.error( (\"Expected \" + (delimiters[0]) + \"/partial\" + (delimiters[1])) );\n\t\t\t}\n\n\t\t\tclosed = true;\n\t\t}\n\n\t\telse {\n\t\t\tchild = parser.read( READERS );\n\n\t\t\tif ( !child ) {\n\t\t\t\tparser.error( (\"Expected \" + (delimiters[0]) + \"/partial\" + (delimiters[1])) );\n\t\t\t}\n\n\t\t\tcontent.push( child );\n\t\t}\n\t} while ( !closed );\n\n\treturn {\n\t\tt: INLINE_PARTIAL,\n\t\tn: name,\n\t\tf: content\n\t};\n}\n\nfunction readTemplate ( parser ) {\n\tvar fragment = [];\n\tvar partials = create( null );\n\tvar hasPartials = false;\n\n\tvar preserveWhitespace = parser.preserveWhitespace;\n\n\twhile ( parser.pos < parser.str.length ) {\n\t\tvar pos = parser.pos, item, partial;\n\n\t\tif ( partial = parser.read( PARTIAL_READERS ) ) {\n\t\t\tif ( partials[ partial.n ] ) {\n\t\t\t\tparser.pos = pos;\n\t\t\t\tparser.error( 'Duplicated partial definition' );\n\t\t\t}\n\n\t\t\tcleanup( partial.f, parser.stripComments, preserveWhitespace, !preserveWhitespace, !preserveWhitespace );\n\n\t\t\tpartials[ partial.n ] = partial.f;\n\t\t\thasPartials = true;\n\t\t} else if ( item = parser.read( READERS ) ) {\n\t\t\tfragment.push( item );\n\t\t} else  {\n\t\t\tparser.error( 'Unexpected template content' );\n\t\t}\n\t}\n\n\tvar result = {\n\t\tv: TEMPLATE_VERSION,\n\t\tt: fragment\n\t};\n\n\tif ( hasPartials ) {\n\t\tresult.p = partials;\n\t}\n\n\treturn result;\n}\n\nfunction insertExpressions ( obj, expr ) {\n\n\tObject.keys( obj ).forEach( function ( key ) {\n\t\tif  ( isExpression( key, obj ) ) return addTo( obj, expr );\n\n\t\tvar ref = obj[ key ];\n\t\tif ( hasChildren( ref ) ) insertExpressions( ref, expr );\n \t});\n}\n\nfunction isExpression( key, obj ) {\n\treturn key === 's' && isArray( obj.r );\n}\n\nfunction addTo( obj, expr ) {\n\tvar s = obj.s, r = obj.r;\n\tif ( !expr[ s ] ) expr[ s ] = fromExpression( s, r.length );\n}\n\nfunction hasChildren( ref ) {\n\treturn isArray( ref ) || isObject( ref );\n}\n\n// See https://github.com/ractivejs/template-spec for information\n// about the Ractive template specification\n\nvar STANDARD_READERS = [ readPartial, readUnescaped, readSection, readYielder, readInterpolator, readComment ];\nvar TRIPLE_READERS = [ readTriple ];\nvar STATIC_READERS = [ readUnescaped, readSection, readInterpolator ]; // TODO does it make sense to have a static section?\n\nvar StandardParser;\n\nfunction parse ( template, options ) {\n\treturn new StandardParser( template, options || {} ).result;\n}\n\nparse.computedStrings = function( computed ) {\n\tif ( !computed ) return [];\n\n\tObject.keys( computed ).forEach( function ( key ) {\n\t\tvar value = computed[ key ];\n\t\tif ( typeof value === 'string' ) {\n\t\t\tcomputed[ key ] = fromComputationString( value );\n\t\t}\n\t});\n};\n\n\nvar READERS = [ readMustache, readHtmlComment, readElement$1, readText ];\nvar PARTIAL_READERS = [ readPartialDefinitionComment$1, readPartialDefinitionSection ];\n\nStandardParser = Parser$1.extend({\n\tinit: function ( str, options ) {\n\t\tvar tripleDelimiters = options.tripleDelimiters || [ '{{{', '}}}' ],\n\t\t\tstaticDelimiters = options.staticDelimiters || [ '[[', ']]' ],\n\t\t\tstaticTripleDelimiters = options.staticTripleDelimiters || [ '[[[', ']]]' ];\n\n\t\tthis.standardDelimiters = options.delimiters || [ '{{', '}}' ];\n\n\t\tthis.tags = [\n\t\t\t{ isStatic: false, isTriple: false, open: this.standardDelimiters[0], close: this.standardDelimiters[1], readers: STANDARD_READERS },\n\t\t\t{ isStatic: false, isTriple: true,  open: tripleDelimiters[0],        close: tripleDelimiters[1],        readers: TRIPLE_READERS },\n\t\t\t{ isStatic: true,  isTriple: false, open: staticDelimiters[0],        close: staticDelimiters[1],        readers: STATIC_READERS },\n\t\t\t{ isStatic: true,  isTriple: true,  open: staticTripleDelimiters[0],  close: staticTripleDelimiters[1],  readers: TRIPLE_READERS }\n\t\t];\n\n\t\tthis.sortMustacheTags();\n\n\t\tthis.sectionDepth = 0;\n\t\tthis.elementStack = [];\n\n\t\tthis.interpolate = {\n\t\t\tscript: !options.interpolate || options.interpolate.script !== false,\n\t\t\tstyle: !options.interpolate || options.interpolate.style !== false,\n\t\t\ttextarea: true\n\t\t};\n\n\t\tif ( options.sanitize === true ) {\n\t\t\toptions.sanitize = {\n\t\t\t\t// blacklist from https://code.google.com/p/google-caja/source/browse/trunk/src/com/google/caja/lang/html/html4-elements-whitelist.json\n\t\t\t\telements: 'applet base basefont body frame frameset head html isindex link meta noframes noscript object param script style title'.split( ' ' ),\n\t\t\t\teventAttributes: true\n\t\t\t};\n\t\t}\n\n\t\tthis.stripComments = options.stripComments !== false;\n\t\tthis.preserveWhitespace = options.preserveWhitespace;\n\t\tthis.sanitizeElements = options.sanitize && options.sanitize.elements;\n\t\tthis.sanitizeEventAttributes = options.sanitize && options.sanitize.eventAttributes;\n\t\tthis.includeLinePositions = options.includeLinePositions;\n\t\tthis.textOnlyMode = options.textOnlyMode;\n\t\tthis.csp = options.csp;\n\t},\n\n\tpostProcess: function ( result ) {\n\t\t// special case - empty string\n\t\tif ( !result.length ) {\n\t\t\treturn { t: [], v: TEMPLATE_VERSION };\n\t\t}\n\n\t\tif ( this.sectionDepth > 0 ) {\n\t\t\tthis.error( 'A section was left open' );\n\t\t}\n\n\t\tcleanup( result[0].t, this.stripComments, this.preserveWhitespace, !this.preserveWhitespace, !this.preserveWhitespace );\n\n\t\tif ( this.csp !== false ) {\n\t\t\tvar expr = {};\n\t\t\tinsertExpressions( result[0].t, expr );\n\t\t\tif ( Object.keys( expr ).length ) result[0].e = expr;\n\t\t}\n\n\t\treturn result[0];\n\t},\n\n\tconverters: [\n\t\treadTemplate\n\t],\n\n\tsortMustacheTags: function () {\n\t\t// Sort in order of descending opening delimiter length (longer first),\n\t\t// to protect against opening delimiters being substrings of each other\n\t\tthis.tags.sort( function ( a, b ) {\n\t\t\treturn b.open.length - a.open.length;\n\t\t});\n\t}\n});\n\nvar parseOptions = [\n\t'delimiters',\n\t'tripleDelimiters',\n\t'staticDelimiters',\n\t'staticTripleDelimiters',\n\t'csp',\n\t'interpolate',\n\t'preserveWhitespace',\n\t'sanitize',\n\t'stripComments'\n];\n\nvar TEMPLATE_INSTRUCTIONS = \"Either preparse or use a ractive runtime source that includes the parser. \";\n\nvar COMPUTATION_INSTRUCTIONS = \"Either use:\\n\\n\\tRactive.parse.computedStrings( component.computed )\\n\\nat build time to pre-convert the strings to functions, or use functions instead of strings in computed properties.\";\n\n\nfunction throwNoParse ( method, error, instructions ) {\n\tif ( !method ) {\n\t\tfatal( (\"Missing Ractive.parse - cannot parse \" + error + \". \" + instructions) );\n\t}\n}\n\nfunction createFunction ( body, length ) {\n\tthrowNoParse( fromExpression, 'new expression function', TEMPLATE_INSTRUCTIONS );\n\treturn fromExpression( body, length );\n}\n\nfunction createFunctionFromString ( str, bindTo ) {\n\tthrowNoParse( fromComputationString, 'compution string \"${str}\"', COMPUTATION_INSTRUCTIONS );\n\treturn fromComputationString( str, bindTo );\n}\n\nvar parser = {\n\n\tfromId: function ( id, options ) {\n\t\tif ( !doc ) {\n\t\t\tif ( options && options.noThrow ) { return; }\n\t\t\tthrow new Error( (\"Cannot retrieve template #\" + id + \" as Ractive is not running in a browser.\") );\n\t\t}\n\n\t\tif ( id ) id = id.replace( /^#/, '' );\n\n\t\tvar template;\n\n\t\tif ( !( template = doc.getElementById( id ) )) {\n\t\t\tif ( options && options.noThrow ) { return; }\n\t\t\tthrow new Error( (\"Could not find template element with id #\" + id) );\n\t\t}\n\n\t\tif ( template.tagName.toUpperCase() !== 'SCRIPT' ) {\n\t\t\tif ( options && options.noThrow ) { return; }\n\t\t\tthrow new Error( (\"Template element with id #\" + id + \", must be a <script> element\") );\n\t\t}\n\n\t\treturn ( 'textContent' in template ? template.textContent : template.innerHTML );\n\n\t},\n\n\tisParsed: function ( template) {\n\t\treturn !( typeof template === 'string' );\n\t},\n\n\tgetParseOptions: function ( ractive ) {\n\t\t// Could be Ractive or a Component\n\t\tif ( ractive.defaults ) { ractive = ractive.defaults; }\n\n\t\treturn parseOptions.reduce( function ( val, key ) {\n\t\t\tval[ key ] = ractive[ key ];\n\t\t\treturn val;\n\t\t}, {});\n\t},\n\n\tparse: function ( template, options ) {\n\t\tthrowNoParse( parse, 'template', TEMPLATE_INSTRUCTIONS );\n\t\tvar parsed = parse( template, options );\n\t\taddFunctions( parsed );\n\t\treturn parsed;\n\t},\n\n\tparseFor: function( template, ractive ) {\n\t\treturn this.parse( template, this.getParseOptions( ractive ) );\n\t}\n};\n\nvar templateConfigurator = {\n\tname: 'template',\n\n\textend: function ( Parent, proto, options ) {\n\t\t// only assign if exists\n\t\tif ( 'template' in options ) {\n\t\t\tvar template = options.template;\n\n\t\t\tif ( typeof template === 'function' ) {\n\t\t\t\tproto.template = template;\n\t\t\t} else {\n\t\t\t\tproto.template = parseTemplate( template, proto );\n\t\t\t}\n\t\t}\n\t},\n\n\tinit: function ( Parent, ractive, options ) {\n\t\t// TODO because of prototypal inheritance, we might just be able to use\n\t\t// ractive.template, and not bother passing through the Parent object.\n\t\t// At present that breaks the test mocks' expectations\n\t\tvar template = 'template' in options ? options.template : Parent.prototype.template;\n\t\ttemplate = template || { v: TEMPLATE_VERSION, t: [] };\n\n\t\tif ( typeof template === 'function' ) {\n\t\t\tvar fn = template;\n\t\t\ttemplate = getDynamicTemplate( ractive, fn );\n\n\t\t\tractive._config.template = {\n\t\t\t\tfn: fn,\n\t\t\t\tresult: template\n\t\t\t};\n\t\t}\n\n\t\ttemplate = parseTemplate( template, ractive );\n\n\t\t// TODO the naming of this is confusing - ractive.template refers to [...],\n\t\t// but Component.prototype.template refers to {v:1,t:[],p:[]}...\n\t\t// it's unnecessary, because the developer never needs to access\n\t\t// ractive.template\n\t\tractive.template = template.t;\n\n\t\tif ( template.p ) {\n\t\t\textendPartials( ractive.partials, template.p );\n\t\t}\n\t},\n\n\treset: function ( ractive ) {\n\t\tvar result = resetValue( ractive );\n\n\t\tif ( result ) {\n\t\t\tvar parsed = parseTemplate( result, ractive );\n\n\t\t\tractive.template = parsed.t;\n\t\t\textendPartials( ractive.partials, parsed.p, true );\n\n\t\t\treturn true;\n\t\t}\n\t}\n};\n\nfunction resetValue ( ractive ) {\n\tvar initial = ractive._config.template;\n\n\t// If this isn't a dynamic template, there's nothing to do\n\tif ( !initial || !initial.fn ) {\n\t\treturn;\n\t}\n\n\tvar result = getDynamicTemplate( ractive, initial.fn );\n\n\t// TODO deep equality check to prevent unnecessary re-rendering\n\t// in the case of already-parsed templates\n\tif ( result !== initial.result ) {\n\t\tinitial.result = result;\n\t\treturn result;\n\t}\n}\n\nfunction getDynamicTemplate ( ractive, fn ) {\n\treturn fn.call( ractive, {\n\t\tfromId: parser.fromId,\n\t\tisParsed: parser.isParsed,\n\t\tparse: function ( template, options ) {\n\t\t\tif ( options === void 0 ) options = parser.getParseOptions( ractive );\n\n\t\t\treturn parser.parse( template, options );\n\t\t}\n\t});\n}\n\nfunction parseTemplate ( template, ractive ) {\n\tif ( typeof template === 'string' ) {\n\t\t// parse will validate and add expression functions\n\t\ttemplate = parseAsString( template, ractive );\n\t}\n\telse {\n\t\t// need to validate and add exp for already parsed template\n\t\tvalidate$1( template );\n\t\taddFunctions( template );\n\t}\n\n\treturn template;\n}\n\nfunction parseAsString ( template, ractive ) {\n\t// ID of an element containing the template?\n\tif ( template[0] === '#' ) {\n\t\ttemplate = parser.fromId( template );\n\t}\n\n\treturn parser.parseFor( template, ractive );\n}\n\nfunction validate$1( template ) {\n\n\t// Check that the template even exists\n\tif ( template == undefined ) {\n\t\tthrow new Error( (\"The template cannot be \" + template + \".\") );\n\t}\n\n\t// Check the parsed template has a version at all\n\telse if ( typeof template.v !== 'number' ) {\n\t\tthrow new Error( 'The template parser was passed a non-string template, but the template doesn\\'t have a version.  Make sure you\\'re passing in the template you think you are.' );\n\t}\n\n\t// Check we're using the correct version\n\telse if ( template.v !== TEMPLATE_VERSION ) {\n\t\tthrow new Error( (\"Mismatched template version (expected \" + TEMPLATE_VERSION + \", got \" + (template.v) + \") Please ensure you are using the latest version of Ractive.js in your build process as well as in your app\") );\n\t}\n}\n\nfunction extendPartials ( existingPartials, newPartials, overwrite ) {\n\tif ( !newPartials ) return;\n\n\t// TODO there's an ambiguity here - we need to overwrite in the `reset()`\n\t// case, but not initially...\n\n\tfor ( var key in newPartials ) {\n\t\tif ( overwrite || !existingPartials.hasOwnProperty( key ) ) {\n\t\t\texistingPartials[ key ] = newPartials[ key ];\n\t\t}\n\t}\n}\n\nvar registryNames = [\n\t'adaptors',\n\t'components',\n\t'computed',\n\t'decorators',\n\t'easing',\n\t'events',\n\t'interpolators',\n\t'partials',\n\t'transitions'\n];\n\nvar Registry = function Registry ( name, useDefaults ) {\n\tthis.name = name;\n\tthis.useDefaults = useDefaults;\n};\n\nRegistry.prototype.extend = function extend ( Parent, proto, options ) {\n\tthis.configure(\n\t\tthis.useDefaults ? Parent.defaults : Parent,\n\t\tthis.useDefaults ? proto : proto.constructor,\n\t\toptions );\n};\n\nRegistry.prototype.init = function init () {\n\t// noop\n};\n\nRegistry.prototype.configure = function configure ( Parent, target, options ) {\n\tvar name = this.name;\n\tvar option = options[ name ];\n\n\tvar registry = create( Parent[name] );\n\n\tfor ( var key in option ) {\n\t\tregistry[ key ] = option[ key ];\n\t}\n\n\ttarget[ name ] = registry;\n};\n\nRegistry.prototype.reset = function reset ( ractive ) {\n\tvar registry = ractive[ this.name ];\n\tvar changed = false;\n\n\tObject.keys( registry ).forEach( function ( key ) {\n\t\tvar item = registry[ key ];\n\t\t\t\n\t\tif ( item._fn ) {\n\t\t\tif ( item._fn.isOwner ) {\n\t\t\t\tregistry[key] = item._fn;\n\t\t\t} else {\n\t\t\t\tdelete registry[key];\n\t\t\t}\n\t\t\tchanged = true;\n\t\t}\n\t});\n\n\treturn changed;\n};\n\nvar registries = registryNames.map( function ( name ) { return new Registry( name, name === 'computed' ); } );\n\nfunction wrap ( parent, name, method ) {\n\tif ( !/_super/.test( method ) ) return method;\n\n\tfunction wrapper () {\n\t\tvar superMethod = getSuperMethod( wrapper._parent, name );\n\t\tvar hasSuper = '_super' in this;\n\t\tvar oldSuper = this._super;\n\n\t\tthis._super = superMethod;\n\n\t\tvar result = method.apply( this, arguments );\n\n\t\tif ( hasSuper ) {\n\t\t\tthis._super = oldSuper;\n\t\t} else {\n\t\t\tdelete this._super;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\twrapper._parent = parent;\n\twrapper._method = method;\n\n\treturn wrapper;\n}\n\nfunction getSuperMethod ( parent, name ) {\n\tif ( name in parent ) {\n\t\tvar value = parent[ name ];\n\n\t\treturn typeof value === 'function' ?\n\t\t\tvalue :\n\t\t\tfunction () { return value; };\n\t}\n\n\treturn noop;\n}\n\nfunction getMessage( deprecated, correct, isError ) {\n\treturn \"options.\" + deprecated + \" has been deprecated in favour of options.\" + correct + \".\"\n\t\t+ ( isError ? (\" You cannot specify both options, please use options.\" + correct + \".\") : '' );\n}\n\nfunction deprecateOption ( options, deprecatedOption, correct ) {\n\tif ( deprecatedOption in options ) {\n\t\tif( !( correct in options ) ) {\n\t\t\twarnIfDebug( getMessage( deprecatedOption, correct ) );\n\t\t\toptions[ correct ] = options[ deprecatedOption ];\n\t\t} else {\n\t\t\tthrow new Error( getMessage( deprecatedOption, correct, true ) );\n\t\t}\n\t}\n}\n\nfunction deprecate ( options ) {\n\tdeprecateOption( options, 'beforeInit', 'onconstruct' );\n\tdeprecateOption( options, 'init', 'onrender' );\n\tdeprecateOption( options, 'complete', 'oncomplete' );\n\tdeprecateOption( options, 'eventDefinitions', 'events' );\n\n\t// Using extend with Component instead of options,\n\t// like Human.extend( Spider ) means adaptors as a registry\n\t// gets copied to options. So we have to check if actually an array\n\tif ( isArray( options.adaptors ) ) {\n\t\tdeprecateOption( options, 'adaptors', 'adapt' );\n\t}\n}\n\nvar custom = {\n\tadapt: adaptConfigurator,\n\tcss: cssConfigurator,\n\tdata: dataConfigurator,\n\ttemplate: templateConfigurator\n};\n\nvar defaultKeys = Object.keys( defaults );\n\nvar isStandardKey = makeObj( defaultKeys.filter( function ( key ) { return !custom[ key ]; } ) );\n\n// blacklisted keys that we don't double extend\nvar isBlacklisted = makeObj( defaultKeys.concat( registries.map( function ( r ) { return r.name; } ) ) );\n\nvar order = [].concat(\n\tdefaultKeys.filter( function ( key ) { return !registries[ key ] && !custom[ key ]; } ),\n\tregistries,\n\t//custom.data,\n\tcustom.template,\n\tcustom.css\n);\n\nvar config = {\n\textend: function ( Parent, proto, options ) { return configure$1( 'extend', Parent, proto, options ); },\n\n\tinit: function ( Parent, ractive, options ) { return configure$1( 'init', Parent, ractive, options ); },\n\n\treset: function ( ractive ) {\n\t\treturn order.filter( function ( c ) {\n\t\t\treturn c.reset && c.reset( ractive );\n\t\t}).map( function ( c ) { return c.name; } );\n\t},\n\n\t// this defines the order. TODO this isn't used anywhere in the codebase,\n\t// only in the test suite - should get rid of it\n\torder: order\n};\n\nfunction configure$1 ( method, Parent, target, options ) {\n\tdeprecate( options );\n\n\tfor ( var key in options ) {\n\t\tif ( isStandardKey.hasOwnProperty( key ) ) {\n\t\t\tvar value = options[ key ];\n\n\t\t\t// warn the developer if they passed a function and ignore its value\n\n\t\t\t// NOTE: we allow some functions on \"el\" because we duck type element lists\n\t\t\t// and some libraries or ef'ed-up virtual browsers (phantomJS) return a\n\t\t\t// function object as the result of querySelector methods\n\t\t\tif ( key !== 'el' && typeof value === 'function' ) {\n\t\t\t\twarnIfDebug( (\"\" + key + \" is a Ractive option that does not expect a function and will be ignored\"),\n\t\t\t\t\tmethod === 'init' ? target : null );\n\t\t\t}\n\t\t\telse {\n\t\t\t\ttarget[ key ] = value;\n\t\t\t}\n\t\t}\n\t}\n\n\t// disallow combination of `append` and `enhance`\n\tif ( options.append && options.enhance ) {\n\t\tthrow new Error( 'Cannot use append and enhance at the same time' );\n\t}\n\n\tregistries.forEach( function ( registry ) {\n\t\tregistry[ method ]( Parent, target, options );\n\t});\n\n\tadaptConfigurator[ method ]( Parent, target, options );\n\ttemplateConfigurator[ method ]( Parent, target, options );\n\tcssConfigurator[ method ]( Parent, target, options );\n\n\textendOtherMethods( Parent.prototype, target, options );\n}\n\nfunction extendOtherMethods ( parent, target, options ) {\n\tfor ( var key in options ) {\n\t\tif ( !isBlacklisted[ key ] && options.hasOwnProperty( key ) ) {\n\t\t\tvar member = options[ key ];\n\n\t\t\t// if this is a method that overwrites a method, wrap it:\n\t\t\tif ( typeof member === 'function' ) {\n\t\t\t\tmember = wrap( parent, key, member );\n\t\t\t}\n\n\t\t\ttarget[ key ] = member;\n\t\t}\n\t}\n}\n\nfunction makeObj ( array ) {\n\tvar obj = {};\n\tarray.forEach( function ( x ) { return obj[x] = true; } );\n\treturn obj;\n}\n\nvar shouldRerender = [ 'template', 'partials', 'components', 'decorators', 'events' ];\n\nvar completeHook$1 = new Hook( 'complete' );\nvar resetHook = new Hook( 'reset' );\nvar renderHook$1 = new Hook( 'render' );\nvar unrenderHook = new Hook( 'unrender' );\n\nfunction Ractive$reset ( data ) {\n\tdata = data || {};\n\n\tif ( typeof data !== 'object' ) {\n\t\tthrow new Error( 'The reset method takes either no arguments, or an object containing new data' );\n\t}\n\n\t// TEMP need to tidy this up\n\tdata = dataConfigurator.init( this.constructor, this, { data: data });\n\n\tvar promise = runloop.start( this, true );\n\n\t// If the root object is wrapped, try and use the wrapper's reset value\n\tvar wrapper = this.viewmodel.wrapper;\n\tif ( wrapper && wrapper.reset ) {\n\t\tif ( wrapper.reset( data ) === false ) {\n\t\t\t// reset was rejected, we need to replace the object\n\t\t\tthis.viewmodel.set( data );\n\t\t}\n\t} else {\n\t\tthis.viewmodel.set( data );\n\t}\n\n\t// reset config items and track if need to rerender\n\tvar changes = config.reset( this );\n\tvar rerender;\n\n\tvar i = changes.length;\n\twhile ( i-- ) {\n\t\tif ( shouldRerender.indexOf( changes[i] ) > -1 ) {\n\t\t\trerender = true;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif ( rerender ) {\n\t\tunrenderHook.fire( this );\n\t\tthis.fragment.resetTemplate( this.template );\n\t\trenderHook$1.fire( this );\n\t\tcompleteHook$1.fire( this );\n\t}\n\n\trunloop.end();\n\n\tresetHook.fire( this, data );\n\n\treturn promise;\n}\n\nfunction collect( source, name, attr, dest ) {\n\tsource.forEach( function ( item ) {\n\t\t// queue to rerender if the item is a partial and the current name matches\n\t\tif ( item.type === PARTIAL && ( item.refName ===  name || item.name === name ) ) {\n\t\t\titem.inAttribute = attr;\n\t\t\tdest.push( item );\n\t\t\treturn; // go no further\n\t\t}\n\n\t\t// if it has a fragment, process its items\n\t\tif ( item.fragment ) {\n\t\t\tcollect( item.fragment.iterations || item.fragment.items, name, attr, dest );\n\t\t}\n\n\t\t// or if it is itself a fragment, process its items\n\t\telse if ( isArray( item.items ) ) {\n\t\t\tcollect( item.items, name, attr, dest );\n\t\t}\n\n\t\t// or if it is a component, step in and process its items\n\t\telse if ( item.type === COMPONENT && item.instance ) {\n\t\t\t// ...unless the partial is shadowed\n\t\t\tif ( item.instance.partials[ name ] ) return;\n\t\t\tcollect( item.instance.fragment.items, name, attr, dest );\n\t\t}\n\n\t\t// if the item is an element, process its attributes too\n\t\tif ( item.type === ELEMENT ) {\n\t\t\tif ( isArray( item.attributes ) ) {\n\t\t\t\tcollect( item.attributes, name, true, dest );\n\t\t\t}\n\t\t}\n\t});\n}\n\nfunction forceResetTemplate$1 ( partial ) {\n\tpartial.forceResetTemplate();\n}\n\nvar resetPartial = function ( name, partial ) {\n\tvar collection = [];\n\tcollect( this.fragment.items, name, false, collection );\n\n\tvar promise = runloop.start( this, true );\n\n\tthis.partials[ name ] = partial;\n\tcollection.forEach( forceResetTemplate$1 );\n\n\trunloop.end();\n\n\treturn promise;\n};\n\nvar Item = function Item ( options ) {\n\tthis.parentFragment = options.parentFragment;\n\tthis.ractive = options.parentFragment.ractive;\n\n\tthis.template = options.template;\n\tthis.index = options.index;\n\tthis.type = options.template.t;\n\n\tthis.dirty = false;\n};\n\nItem.prototype.bubble = function bubble () {\n\tif ( !this.dirty ) {\n\t\tthis.dirty = true;\n\t\tthis.parentFragment.bubble();\n\t}\n};\n\nItem.prototype.destroyed = function destroyed () {};\n\nItem.prototype.find = function find () {\n\treturn null;\n};\n\nItem.prototype.findAll = function findAll () {\n\t// noop\n};\n\nItem.prototype.findComponent = function findComponent () {\n\treturn null;\n};\n\nItem.prototype.findAllComponents = function findAllComponents () {\n\t// noop;\n};\n\nItem.prototype.findNextNode = function findNextNode () {\n\treturn this.parentFragment.findNextNode( this );\n};\n\nItem.prototype.shuffled = function shuffled () {\n\tif ( this.fragment ) this.fragment.shuffled();\n};\n\nItem.prototype.valueOf = function valueOf () {\n\treturn this.toString();\n};\n\nvar ComputationChild = (function (Model$$1) {\n\tfunction ComputationChild () {\n\t\tModel$$1.apply(this, arguments);\n\t}\n\n\tComputationChild.prototype = Object.create( Model$$1 && Model$$1.prototype );\n\tComputationChild.prototype.constructor = ComputationChild;\n\n\tComputationChild.prototype.get = function get ( shouldCapture ) {\n\t\tif ( shouldCapture ) capture( this );\n\n\t\tvar parentValue = this.parent.get();\n\t\treturn parentValue ? parentValue[ this.key ] : undefined;\n\t};\n\n\tComputationChild.prototype.handleChange = function handleChange$1 () {\n\t\tthis.dirty = true;\n\n\t\tthis.deps.forEach( handleChange$1$1 );\n\t\tthis.children.forEach( handleChange$1$1 );\n\t\tthis.clearUnresolveds(); // TODO is this necessary?\n\t};\n\n\tComputationChild.prototype.joinKey = function joinKey ( key ) {\n\t\tif ( key === undefined || key === '' ) return this;\n\n\t\tif ( !this.childByKey.hasOwnProperty( key ) ) {\n\t\t\tvar child = new ComputationChild( this, key );\n\t\t\tthis.children.push( child );\n\t\t\tthis.childByKey[ key ] = child;\n\t\t}\n\n\t\treturn this.childByKey[ key ];\n\t};\n\n\treturn ComputationChild;\n}(Model));\n\nfunction createResolver ( proxy, ref, index ) {\n\tvar resolver = proxy.fragment.resolve( ref, function ( model ) {\n\t\tremoveFromArray( proxy.resolvers, resolver );\n\t\tproxy.models[ index ] = model;\n\t\tproxy.bubble();\n\t});\n\n\tproxy.resolvers.push( resolver );\n}\n\nvar ExpressionProxy = (function (Model$$1) {\n\tfunction ExpressionProxy ( fragment, template ) {\n\t\tvar this$1 = this;\n\n\t\tModel$$1.call( this, fragment.ractive.viewmodel, null );\n\n\t\tthis.fragment = fragment;\n\t\tthis.template = template;\n\n\t\tthis.isReadonly = true;\n\t\tthis.dirty = true;\n\n\t\tthis.fn = getFunction( template.s, template.r.length );\n\n\t\tthis.resolvers = [];\n\t\tthis.models = this.template.r.map( function ( ref, index ) {\n\t\t\tvar model = resolveReference( this$1.fragment, ref );\n\n\t\t\tif ( !model ) {\n\t\t\t\tcreateResolver( this$1, ref, index );\n\t\t\t}\n\n\t\t\treturn model;\n\t\t});\n\n\t\tthis.shuffle = undefined;\n\n\t\tthis.bubble();\n\t}\n\n\tExpressionProxy.prototype = Object.create( Model$$1 && Model$$1.prototype );\n\tExpressionProxy.prototype.constructor = ExpressionProxy;\n\n\tExpressionProxy.prototype.bubble = function bubble ( actuallyChanged ) {\n\t\t// refresh the keypath\n\t\tif ( actuallyChanged === void 0 ) actuallyChanged = true;\n\n\t\tif ( this.registered ) delete this.root.expressions[ this.keypath ];\n\t\tthis.keypath = undefined;\n\n\t\tif ( actuallyChanged ) {\n\t\t\tthis.dirty = true;\n\t\t\tthis.handleChange();\n\t\t}\n\t};\n\n\tExpressionProxy.prototype.get = function get ( shouldCapture ) {\n\t\tif ( shouldCapture ) capture( this );\n\n\t\tif ( this.dirty ) {\n\t\t\tthis.dirty = false;\n\t\t\tthis.value = this.getValue();\n\t\t\tthis.adapt();\n\t\t}\n\n\t\treturn shouldCapture && this.wrapper ? this.wrapper.value : this.value;\n\t};\n\n\tExpressionProxy.prototype.getKeypath = function getKeypath () {\n\t\tvar this$1 = this;\n\n\t\tif ( !this.template ) return '@undefined';\n\t\tif ( !this.keypath ) {\n\t\t\tthis.keypath = '@' + this.template.s.replace( /_(\\d+)/g, function ( match, i ) {\n\t\t\t\tif ( i >= this$1.models.length ) return match;\n\n\t\t\t\tvar model = this$1.models[i];\n\t\t\t\treturn model ? model.getKeypath() : '@undefined';\n\t\t\t});\n\n\t\t\tthis.root.expressions[ this.keypath ] = this;\n\t\t\tthis.registered = true;\n\t\t}\n\n\t\treturn this.keypath;\n\t};\n\n\tExpressionProxy.prototype.getValue = function getValue () {\n\t\tvar this$1 = this;\n\n\t\tstartCapturing();\n\t\tvar result;\n\n\t\ttry {\n\t\t\tvar params = this.models.map( function ( m ) { return m ? m.get( true ) : undefined; } );\n\t\t\tresult = this.fn.apply( this.fragment.ractive, params );\n\t\t} catch ( err ) {\n\t\t\twarnIfDebug( (\"Failed to compute \" + (this.getKeypath()) + \": \" + (err.message || err)) );\n\t\t}\n\n\t\tvar dependencies = stopCapturing();\n\t\tif ( this.dependencies ) this.dependencies.forEach( function ( d ) { return d.unregister( this$1 ); } );\n\t\tthis.dependencies = dependencies;\n\t\tthis.dependencies.forEach( function ( d ) { return d.register( this$1 ); } );\n\n\t\treturn result;\n\t};\n\n\tExpressionProxy.prototype.handleChange = function handleChange$1 () {\n\t\tthis.dirty = true;\n\n\t\tthis.links.forEach( marked );\n\t\tthis.deps.forEach( handleChange$1$1 );\n\t\tthis.children.forEach( handleChange$1$1 );\n\n\t\tthis.clearUnresolveds();\n\t};\n\n\tExpressionProxy.prototype.joinKey = function joinKey ( key ) {\n\t\tif ( key === undefined || key === '' ) return this;\n\n\t\tif ( !this.childByKey.hasOwnProperty( key ) ) {\n\t\t\tvar child = new ComputationChild( this, key );\n\t\t\tthis.children.push( child );\n\t\t\tthis.childByKey[ key ] = child;\n\t\t}\n\n\t\treturn this.childByKey[ key ];\n\t};\n\n\tExpressionProxy.prototype.mark = function mark () {\n\t\tthis.handleChange();\n\t};\n\n\tExpressionProxy.prototype.rebinding = function rebinding ( next, previous, safe ) {\n\t\tvar idx = this.models.indexOf( previous );\n\n\t\tif ( ~idx ) {\n\t\t\tnext = rebindMatch( this.template.r[idx], next, previous );\n\t\t\tif ( next !== previous ) {\n\t\t\t\tprevious.unregister( this );\n\t\t\t\tthis.models.splice( idx, 1, next );\n\t\t\t\t// TODO: set up a resolver if there is no next?\n\t\t\t\tif ( next ) next.addShuffleRegister( this, 'mark' );\n\t\t\t}\n\t\t}\n\t\tthis.bubble( !safe );\n\t};\n\n\tExpressionProxy.prototype.retrieve = function retrieve () {\n\t\treturn this.get();\n\t};\n\n\tExpressionProxy.prototype.teardown = function teardown () {\n\t\tvar this$1 = this;\n\n\t\tthis.unbind();\n\t\tthis.fragment = undefined;\n\t\tif ( this.dependencies ) this.dependencies.forEach( function ( d ) { return d.unregister( this$1 ); } );\n\t\tModel$$1.prototype.teardown.call(this);\n\t};\n\n\tExpressionProxy.prototype.unregister = function unregister( dep ) {\n\t\tModel$$1.prototype.unregister.call( this, dep );\n\t\tif ( !this.deps.length ) this.teardown();\n\t};\n\n\tExpressionProxy.prototype.unbind = function unbind$1 () {\n\t\tthis.resolvers.forEach( unbind$1$1 );\n\t};\n\n\treturn ExpressionProxy;\n}(Model));\n\nvar ReferenceExpressionChild = (function (Model$$1) {\n\tfunction ReferenceExpressionChild ( parent, key ) {\n\t\tModel$$1.call ( this, parent, key );\n\t}\n\n\tReferenceExpressionChild.prototype = Object.create( Model$$1 && Model$$1.prototype );\n\tReferenceExpressionChild.prototype.constructor = ReferenceExpressionChild;\n\n\tReferenceExpressionChild.prototype.applyValue = function applyValue ( value ) {\n\t\tif ( isEqual( value, this.value ) ) return;\n\n\t\tvar parent = this.parent, keys = [ this.key ];\n\t\twhile ( parent ) {\n\t\t\tif ( parent.base ) {\n\t\t\t\tvar target = parent.model.joinAll( keys );\n\t\t\t\ttarget.applyValue( value );\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tkeys.unshift( parent.key );\n\n\t\t\tparent = parent.parent;\n\t\t}\n\t};\n\n\tReferenceExpressionChild.prototype.joinKey = function joinKey ( key ) {\n\t\tif ( key === undefined || key === '' ) return this;\n\n\t\tif ( !this.childByKey.hasOwnProperty( key ) ) {\n\t\t\tvar child = new ReferenceExpressionChild( this, key );\n\t\t\tthis.children.push( child );\n\t\t\tthis.childByKey[ key ] = child;\n\t\t}\n\n\t\treturn this.childByKey[ key ];\n\t};\n\n\tReferenceExpressionChild.prototype.retrieve = function retrieve () {\n\t\tvar parent = this.parent.get();\n\t\treturn parent && this.key in parent ? parent[ this.key ] : undefined;\n\t};\n\n\treturn ReferenceExpressionChild;\n}(Model));\n\nvar ReferenceExpressionProxy = (function (Model$$1) {\n\tfunction ReferenceExpressionProxy ( fragment, template ) {\n\t\tvar this$1 = this;\n\n\t\tModel$$1.call( this, null, null );\n\t\tthis.dirty = true;\n\t\tthis.root = fragment.ractive.viewmodel;\n\t\tthis.template = template;\n\n\t\tthis.resolvers = [];\n\n\t\tthis.base = resolve$3( fragment, template );\n\t\tvar baseResolver;\n\n\t\tif ( !this.base ) {\n\t\t\tbaseResolver = fragment.resolve( template.r, function ( model ) {\n\t\t\t\tthis$1.base = model;\n\t\t\t\tthis$1.bubble();\n\n\t\t\t\tremoveFromArray( this$1.resolvers, baseResolver );\n\t\t\t});\n\n\t\t\tthis.resolvers.push( baseResolver );\n\t\t}\n\n\t\tvar intermediary = this.intermediary = {\n\t\t\thandleChange: function () { return this$1.handleChange(); },\n\t\t\trebinding: function ( next, previous ) {\n\t\t\t\tif ( previous === this$1.base ) {\n\t\t\t\t\tnext = rebindMatch( template, next, previous );\n\t\t\t\t\tif ( next !== this$1.base ) {\n\t\t\t\t\t\tthis$1.base.unregister( intermediary );\n\t\t\t\t\t\tthis$1.base = next;\n\t\t\t\t\t\t// TODO: if there is no next, set up a resolver?\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tvar idx = this$1.members.indexOf( previous );\n\t\t\t\t\tif ( ~idx ) {\n\t\t\t\t\t\t// only direct references will rebind... expressions handle themselves\n\t\t\t\t\t\tnext = rebindMatch( template.m[idx].n, next, previous );\n\t\t\t\t\t\tif ( next !== this$1.members[idx] ) {\n\t\t\t\t\t\t\tthis$1.members.splice( idx, 1, next );\n\t\t\t\t\t\t\t// TODO: if there is no next, set up a resolver?\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( next !== previous ) previous.unregister( intermediary );\n\t\t\t\tif ( next ) next.addShuffleTask( function () { return next.register( intermediary ); } );\n\n\t\t\t\tthis$1.bubble();\n\t\t\t}\n\t\t};\n\n\t\tthis.members = template.m.map( function ( template, i ) {\n\t\t\tif ( typeof template === 'string' ) {\n\t\t\t\treturn { get: function () { return template; } };\n\t\t\t}\n\n\t\t\tvar model;\n\t\t\tvar resolver;\n\n\t\t\tif ( template.t === REFERENCE ) {\n\t\t\t\tmodel = resolveReference( fragment, template.n );\n\n\t\t\t\tif ( model ) {\n\t\t\t\t\tmodel.register( intermediary );\n\t\t\t\t} else {\n\t\t\t\t\tresolver = fragment.resolve( template.n, function ( model ) {\n\t\t\t\t\t\tthis$1.members[i] = model;\n\n\t\t\t\t\t\tmodel.register( intermediary );\n\t\t\t\t\t\tthis$1.handleChange();\n\n\t\t\t\t\t\tremoveFromArray( this$1.resolvers, resolver );\n\t\t\t\t\t});\n\n\t\t\t\t\tthis$1.resolvers.push( resolver );\n\t\t\t\t}\n\n\t\t\t\treturn model;\n\t\t\t}\n\n\t\t\tmodel = new ExpressionProxy( fragment, template );\n\t\t\tmodel.register( intermediary );\n\t\t\treturn model;\n\t\t});\n\n\t\tthis.isUnresolved = true;\n\t\tthis.bubble();\n\t}\n\n\tReferenceExpressionProxy.prototype = Object.create( Model$$1 && Model$$1.prototype );\n\tReferenceExpressionProxy.prototype.constructor = ReferenceExpressionProxy;\n\n\tReferenceExpressionProxy.prototype.bubble = function bubble () {\n\t\tif ( !this.base ) return;\n\t\tif ( !this.dirty ) this.handleChange();\n\t};\n\n\tReferenceExpressionProxy.prototype.forceResolution = function forceResolution () {\n\t\tthis.resolvers.forEach( function ( resolver ) { return resolver.forceResolution(); } );\n\t\tthis.dirty = true;\n\t\tthis.bubble();\n\t};\n\n\tReferenceExpressionProxy.prototype.get = function get ( shouldCapture ) {\n\t\tvar this$1 = this;\n\n\t\tif ( this.dirty ) {\n\t\t\tthis.bubble();\n\n\t\t\tvar i = this.members.length, resolved = true;\n\t\t\twhile ( resolved && i-- ) {\n\t\t\t\tif ( !this$1.members[i] ) resolved = false;\n\t\t\t}\n\n\t\t\tif ( this.base && resolved ) {\n\t\t\t\tvar keys = this.members.map( function ( m ) { return escapeKey( String( m.get() ) ); } );\n\t\t\t\tvar model = this.base.joinAll( keys );\n\n\t\t\t\tif ( model !== this.model ) {\n\t\t\t\t\tif ( this.model ) {\n\t\t\t\t\t\tthis.model.unregister( this );\n\t\t\t\t\t\tthis.model.unregisterTwowayBinding( this );\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.model = model;\n\t\t\t\t\tthis.parent = model.parent;\n\t\t\t\t\tthis.model.register( this );\n\t\t\t\t\tthis.model.registerTwowayBinding( this );\n\n\t\t\t\t\tif ( this.keypathModel ) this.keypathModel.handleChange();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.value = this.model ? this.model.get( shouldCapture ) : undefined;\n\t\t\tthis.dirty = false;\n\t\t\tthis.mark();\n\t\t\treturn this.value;\n\t\t} else {\n\t\t\treturn this.model ? this.model.get( shouldCapture ) : undefined;\n\t\t}\n\t};\n\n\t// indirect two-way bindings\n\tReferenceExpressionProxy.prototype.getValue = function getValue () {\n\t\tvar this$1 = this;\n\n\t\tthis.value = this.model ? this.model.get() : undefined;\n\n\t\tvar i = this.bindings.length;\n\t\twhile ( i-- ) {\n\t\t\tvar value = this$1.bindings[i].getValue();\n\t\t\tif ( value !== this$1.value ) return value;\n\t\t}\n\n\t\t// check one-way bindings\n\t\tvar oneway = findBoundValue( this.deps );\n\t\tif ( oneway ) return oneway.value;\n\n\t\treturn this.value;\n\t};\n\n\tReferenceExpressionProxy.prototype.getKeypath = function getKeypath () {\n\t\treturn this.model ? this.model.getKeypath() : '@undefined';\n\t};\n\n\tReferenceExpressionProxy.prototype.handleChange = function handleChange$1 () {\n\t\tthis.dirty = true;\n\t\tthis.mark();\n\t};\n\n\tReferenceExpressionProxy.prototype.joinKey = function joinKey ( key ) {\n\t\tif ( key === undefined || key === '' ) return this;\n\n\t\tif ( !this.childByKey.hasOwnProperty( key ) ) {\n\t\t\tvar child = new ReferenceExpressionChild( this, key );\n\t\t\tthis.children.push( child );\n\t\t\tthis.childByKey[ key ] = child;\n\t\t}\n\n\t\treturn this.childByKey[ key ];\n\t};\n\n\tReferenceExpressionProxy.prototype.mark = function mark$1 () {\n\t\tif ( this.dirty ) {\n\t\t\tthis.deps.forEach( handleChange$1$1 );\n\t\t}\n\n\t\tthis.links.forEach( marked );\n\t\tthis.children.forEach( mark$1$1 );\n\t\tthis.clearUnresolveds();\n\t};\n\n\tReferenceExpressionProxy.prototype.retrieve = function retrieve () {\n\t\treturn this.value;\n\t};\n\n\tReferenceExpressionProxy.prototype.rebinding = function rebinding () { }; // NOOP\n\n\tReferenceExpressionProxy.prototype.set = function set ( value ) {\n\t\tif ( !this.model ) throw new Error( 'Unresolved reference expression. This should not happen!' );\n\t\tthis.model.set( value );\n\t};\n\n\tReferenceExpressionProxy.prototype.unbind = function unbind$1 () {\n\t\tthis.resolvers.forEach( unbind$1$1 );\n\t\tif ( this.model ) {\n\t\t\tthis.model.unregister( this );\n\t\t\tthis.model.unregisterTwowayBinding( this );\n\t\t}\n\t};\n\n\treturn ReferenceExpressionProxy;\n}(Model));\n\nfunction resolve$3 ( fragment, template ) {\n\tif ( template.r ) {\n\t\treturn resolveReference( fragment, template.r );\n\t}\n\n\telse if ( template.x ) {\n\t\treturn new ExpressionProxy( fragment, template.x );\n\t}\n\n\telse if ( template.rx ) {\n\t\treturn new ReferenceExpressionProxy( fragment, template.rx );\n\t}\n}\n\nfunction resolveAliases( section ) {\n\tif ( section.template.z ) {\n\t\tsection.aliases = {};\n\n\t\tvar refs = section.template.z;\n\t\tfor ( var i = 0; i < refs.length; i++ ) {\n\t\t\tsection.aliases[ refs[i].n ] = resolve$3( section.parentFragment, refs[i].x );\n\t\t}\n\t}\n}\n\nvar Alias = (function (Item$$1) {\n\tfunction Alias ( options ) {\n\t\tItem$$1.call( this, options );\n\n\t\tthis.fragment = null;\n\t}\n\n\tAlias.prototype = Object.create( Item$$1 && Item$$1.prototype );\n\tAlias.prototype.constructor = Alias;\n\n\tAlias.prototype.bind = function bind () {\n\t\tresolveAliases( this );\n\n\t\tthis.fragment = new Fragment({\n\t\t\towner: this,\n\t\t\ttemplate: this.template.f\n\t\t}).bind();\n\t};\n\n\tAlias.prototype.detach = function detach () {\n\t\treturn this.fragment ? this.fragment.detach() : createDocumentFragment();\n\t};\n\n\tAlias.prototype.find = function find ( selector ) {\n\t\tif ( this.fragment ) {\n\t\t\treturn this.fragment.find( selector );\n\t\t}\n\t};\n\n\tAlias.prototype.findAll = function findAll ( selector, query ) {\n\t\tif ( this.fragment ) {\n\t\t\tthis.fragment.findAll( selector, query );\n\t\t}\n\t};\n\n\tAlias.prototype.findComponent = function findComponent ( name ) {\n\t\tif ( this.fragment ) {\n\t\t\treturn this.fragment.findComponent( name );\n\t\t}\n\t};\n\n\tAlias.prototype.findAllComponents = function findAllComponents ( name, query ) {\n\t\tif ( this.fragment ) {\n\t\t\tthis.fragment.findAllComponents( name, query );\n\t\t}\n\t};\n\n\tAlias.prototype.firstNode = function firstNode ( skipParent ) {\n\t\treturn this.fragment && this.fragment.firstNode( skipParent );\n\t};\n\n\tAlias.prototype.rebinding = function rebinding () {\n\t\tvar this$1 = this;\n\n\t\tif ( this.locked ) return;\n\t\tthis.locked = true;\n\t\trunloop.scheduleTask( function () {\n\t\t\tthis$1.locked = false;\n\t\t\tresolveAliases( this$1 );\n\t\t});\n\t};\n\n\tAlias.prototype.render = function render ( target ) {\n\t\tthis.rendered = true;\n\t\tif ( this.fragment ) this.fragment.render( target );\n\t};\n\n\tAlias.prototype.toString = function toString ( escape ) {\n\t\treturn this.fragment ? this.fragment.toString( escape ) : '';\n\t};\n\n\tAlias.prototype.unbind = function unbind () {\n\t\tthis.aliases = {};\n\t\tif ( this.fragment ) this.fragment.unbind();\n\t};\n\n\tAlias.prototype.unrender = function unrender ( shouldDestroy ) {\n\t\tif ( this.rendered && this.fragment ) this.fragment.unrender( shouldDestroy );\n\t\tthis.rendered = false;\n\t};\n\n\tAlias.prototype.update = function update () {\n\t\tif ( this.dirty ) {\n\t\t\tthis.dirty = false;\n\t\t\tthis.fragment.update();\n\t\t}\n\t};\n\n\treturn Alias;\n}(Item));\n\nfunction findElement( start, orComponent ) {\n\tif ( orComponent === void 0 ) orComponent = true;\n\n\twhile ( start && start.type !== ELEMENT && ( !orComponent || start.type !== COMPONENT ) ) {\n\t\tif ( start.owner ) start = start.owner;\n\t\telse if ( start.component ) start = start.component.parentFragment;\n\t\telse if ( start.parent ) start = start.parent;\n\t\telse if ( start.parentFragment ) start = start.parentFragment;\n\t\telse start = undefined;\n\t}\n\n\treturn start;\n}\n\nvar camelCase = function ( hyphenatedStr ) {\n\treturn hyphenatedStr.replace( /-([a-zA-Z])/g, function ( match, $1 ) {\n\t\treturn $1.toUpperCase();\n\t});\n};\n\nvar space = /\\s+/;\nvar specials$2 = { 'float': 'cssFloat' };\nvar remove$1 = /\\/\\*(?:[\\s\\S]*?)\\*\\//g;\nvar escape = /url\\(\\s*(['\"])(?:\\\\[\\s\\S]|(?!\\1).)*\\1\\s*\\)|url\\((?:\\\\[\\s\\S]|[^)])*\\)|(['\"])(?:\\\\[\\s\\S]|(?!\\1).)*\\2/gi;\nvar value = /\\0(\\d+)/g;\n\nfunction readStyle ( css ) {\n    var values = [];\n\n    if ( typeof css !== 'string' ) return {};\n\n    return css.replace( escape, function ( match ) { return (\"\\u0000\" + (values.push( match ) - 1)); })\n        .replace( remove$1, '' )\n        .split( ';' )\n        .filter( function ( rule ) { return !!rule.trim(); } )\n        .map( function ( rule ) { return rule.replace( value, function ( match, n ) { return values[ n ]; } ); } )\n        .reduce(function ( rules, rule ) {\n            var i = rule.indexOf(':');\n            var name = camelCase( rule.substr( 0, i ).trim() );\n            rules[ specials$2[ name ] || name ] = rule.substr( i + 1 ).trim();\n            return rules;\n        }, {});\n}\n\nfunction readClass ( str ) {\n  var list = str.split( space );\n\n  // remove any empty entries\n  var i = list.length;\n  while ( i-- ) {\n    if ( !list[i] ) list.splice( i, 1 );\n  }\n\n  return list;\n}\n\nvar textTypes = [ undefined, 'text', 'search', 'url', 'email', 'hidden', 'password', 'search', 'reset', 'submit' ];\n\nfunction getUpdateDelegate ( attribute ) {\n\tvar element = attribute.element, name = attribute.name;\n\n\tif ( name === 'id' ) return updateId;\n\n\tif ( name === 'value' ) {\n\t\tif ( attribute.interpolator ) attribute.interpolator.bound = true;\n\n\t\t// special case - selects\n\t\tif ( element.name === 'select' && name === 'value' ) {\n\t\t\treturn element.getAttribute( 'multiple' ) ? updateMultipleSelectValue : updateSelectValue;\n\t\t}\n\n\t\tif ( element.name === 'textarea' ) return updateStringValue;\n\n\t\t// special case - contenteditable\n\t\tif ( element.getAttribute( 'contenteditable' ) != null ) return updateContentEditableValue;\n\n\t\t// special case - <input>\n\t\tif ( element.name === 'input' ) {\n\t\t\tvar type = element.getAttribute( 'type' );\n\n\t\t\t// type='file' value='{{fileList}}'>\n\t\t\tif ( type === 'file' ) return noop; // read-only\n\n\t\t\t// type='radio' name='{{twoway}}'\n\t\t\tif ( type === 'radio' && element.binding && element.binding.attribute.name === 'name' ) return updateRadioValue;\n\n\t\t\tif ( ~textTypes.indexOf( type ) ) return updateStringValue;\n\t\t}\n\n\t\treturn updateValue;\n\t}\n\n\tvar node = element.node;\n\n\t// special case - <input type='radio' name='{{twoway}}' value='foo'>\n\tif ( attribute.isTwoway && name === 'name' ) {\n\t\tif ( node.type === 'radio' ) return updateRadioName;\n\t\tif ( node.type === 'checkbox' ) return updateCheckboxName;\n\t}\n\n\tif ( name === 'style' ) return updateStyleAttribute;\n\n\tif ( name.indexOf( 'style-' ) === 0 ) return updateInlineStyle;\n\n\t// special case - class names. IE fucks things up, again\n\tif ( name === 'class' && ( !node.namespaceURI || node.namespaceURI === html ) ) return updateClassName;\n\n\tif ( name.indexOf( 'class-' ) === 0 ) return updateInlineClass;\n\n\tif ( attribute.isBoolean ) {\n\t\tvar type$1 = element.getAttribute( 'type' );\n\t\tif ( attribute.interpolator && name === 'checked' && ( type$1 === 'checkbox' || type$1 === 'radio' ) ) attribute.interpolator.bound = true;\n\t\treturn updateBoolean;\n\t}\n\n\tif ( attribute.namespace && attribute.namespace !== attribute.node.namespaceURI ) return updateNamespacedAttribute;\n\n\treturn updateAttribute;\n}\n\nfunction updateId ( reset ) {\n\tvar ref = this, node = ref.node;\n\tvar value = this.getValue();\n\n\t// remove the mapping to this node if it hasn't already been replaced\n\tif ( this.ractive.nodes[ node.id ] === node ) delete this.ractive.nodes[ node.id ];\n\tif ( reset ) return node.removeAttribute( 'id' );\n\n\tthis.ractive.nodes[ value ] = node;\n\n\tnode.id = value;\n}\n\nfunction updateMultipleSelectValue ( reset ) {\n\tvar value = this.getValue();\n\n\tif ( !isArray( value ) ) value = [ value ];\n\n\tvar options = this.node.options;\n\tvar i = options.length;\n\n\tif ( reset ) {\n\t\twhile ( i-- ) options[i].selected = false;\n\t} else {\n\t\twhile ( i-- ) {\n\t\t\tvar option = options[i];\n\t\t\tvar optionValue = option._ractive ?\n\t\t\t\toption._ractive.value :\n\t\t\t\toption.value; // options inserted via a triple don't have _ractive\n\n\t\t\toption.selected = arrayContains( value, optionValue );\n\t\t}\n\t}\n}\n\nfunction updateSelectValue ( reset ) {\n\tvar value = this.getValue();\n\n\tif ( !this.locked ) { // TODO is locked still a thing?\n\t\tthis.node._ractive.value = value;\n\n\t\tvar options = this.node.options;\n\t\tvar i = options.length;\n\t\tvar wasSelected = false;\n\n\t\tif ( reset ) {\n\t\t\twhile ( i-- ) options[i].selected = false;\n\t\t} else {\n\t\t\twhile ( i-- ) {\n\t\t\t\tvar option = options[i];\n\t\t\t\tvar optionValue = option._ractive ?\n\t\t\t\t\toption._ractive.value :\n\t\t\t\t\toption.value; // options inserted via a triple don't have _ractive\n\t\t\t\tif ( option.disabled && option.selected ) wasSelected = true;\n\n\t\t\t\tif ( optionValue == value ) { // double equals as we may be comparing numbers with strings\n\t\t\t\t\toption.selected = true;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif ( !wasSelected ) this.node.selectedIndex = -1;\n\t}\n}\n\n\nfunction updateContentEditableValue ( reset ) {\n\tvar value = this.getValue();\n\n\tif ( !this.locked ) {\n\t\tif ( reset ) this.node.innerHTML = '';\n\t\telse this.node.innerHTML = value === undefined ? '' : value;\n\t}\n}\n\nfunction updateRadioValue ( reset ) {\n\tvar node = this.node;\n\tvar wasChecked = node.checked;\n\n\tvar value = this.getValue();\n\n\tif ( reset ) return node.checked = false;\n\n\t//node.value = this.element.getAttribute( 'value' );\n\tnode.value = this.node._ractive.value = value;\n\tnode.checked = value === this.element.getAttribute( 'name' );\n\n\t// This is a special case - if the input was checked, and the value\n\t// changed so that it's no longer checked, the twoway binding is\n\t// most likely out of date. To fix it we have to jump through some\n\t// hoops... this is a little kludgy but it works\n\tif ( wasChecked && !node.checked && this.element.binding && this.element.binding.rendered ) {\n\t\tthis.element.binding.group.model.set( this.element.binding.group.getValue() );\n\t}\n}\n\nfunction updateValue ( reset ) {\n\tif ( !this.locked ) {\n\t\tif ( reset ) {\n\t\t\tthis.node.removeAttribute( 'value' );\n\t\t\tthis.node.value = this.node._ractive.value = null;\n\t\t\treturn;\n\t\t}\n\n\t\tvar value = this.getValue();\n\n\t\tthis.node.value = this.node._ractive.value = value;\n\t\tthis.node.setAttribute( 'value', value );\n\t}\n}\n\nfunction updateStringValue ( reset ) {\n\tif ( !this.locked ) {\n\t\tif ( reset ) {\n\t\t\tthis.node._ractive.value = '';\n\t\t\tthis.node.removeAttribute( 'value' );\n\t\t\treturn;\n\t\t}\n\n\t\tvar value = this.getValue();\n\n\t\tthis.node._ractive.value = value;\n\n\t\tthis.node.value = safeToStringValue( value );\n\t\tthis.node.setAttribute( 'value', safeToStringValue( value ) );\n\t}\n}\n\nfunction updateRadioName ( reset ) {\n\tif ( reset ) this.node.checked = false;\n\telse this.node.checked = ( this.getValue() == this.node._ractive.value );\n}\n\nfunction updateCheckboxName ( reset ) {\n\tvar ref = this, element = ref.element, node = ref.node;\n\tvar binding = element.binding;\n\n\tvar value = this.getValue();\n\tvar valueAttribute = element.getAttribute( 'value' );\n\n\tif ( reset ) {\n\t\t// TODO: WAT?\n\t}\n\n\tif ( !isArray( value ) ) {\n\t\tbinding.isChecked = node.checked = ( value == valueAttribute );\n\t} else {\n\t\tvar i = value.length;\n\t\twhile ( i-- ) {\n\t\t\tif ( valueAttribute == value[i] ) {\n\t\t\t\tbinding.isChecked = node.checked = true;\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tbinding.isChecked = node.checked = false;\n\t}\n}\n\nfunction updateStyleAttribute ( reset ) {\n\tvar props = reset ? {} : readStyle( this.getValue() || '' );\n\tvar style = this.node.style;\n\tvar keys = Object.keys( props );\n\tvar prev = this.previous || [];\n\n\tvar i = 0;\n\twhile ( i < keys.length ) {\n\t\tif ( keys[i] in style ) style[ keys[i] ] = props[ keys[i] ];\n\t\ti++;\n\t}\n\n\t// remove now-missing attrs\n\ti = prev.length;\n\twhile ( i-- ) {\n\t\tif ( !~keys.indexOf( prev[i] ) && prev[i] in style ) style[ prev[i] ] = '';\n\t}\n\n\tthis.previous = keys;\n}\n\nfunction updateInlineStyle ( reset ) {\n\tif ( !this.styleName ) {\n\t\tthis.styleName = camelize( this.name.substr( 6 ) );\n\t}\n\n\tthis.node.style[ this.styleName ] = reset ? '' : this.getValue();\n}\n\nfunction updateClassName ( reset ) {\n\tvar value = reset ? [] : readClass( safeToStringValue( this.getValue() ) );\n\tvar attr = readClass( this.node.className );\n\tvar prev = this.previous || attr.slice( 0 );\n\n\tvar i = 0;\n\twhile ( i < value.length ) {\n\t\tif ( !~attr.indexOf( value[i] ) ) attr.push( value[i] );\n\t\ti++;\n\t}\n\n\t// remove now-missing classes\n\ti = prev.length;\n\twhile ( i-- ) {\n\t\tif ( !~value.indexOf( prev[i] ) ) {\n\t\t\tvar idx = attr.indexOf( prev[i] );\n\t\t\tif ( ~idx ) attr.splice( idx, 1 );\n\t\t}\n\t}\n\n\tvar className = attr.join( ' ' );\n\n\tif ( className !== this.node.className ) {\n\t\tthis.node.className = className;\n\t}\n\n\tthis.previous = value;\n}\n\nfunction updateInlineClass ( reset ) {\n\tvar name = this.name.substr( 6 );\n\tvar attr = readClass( this.node.className );\n\tvar value = reset ? false : this.getValue();\n\n\tif ( !this.inlineClass ) this.inlineClass = name;\n\n\tif ( value && !~attr.indexOf( name ) ) attr.push( name );\n\telse if ( !value && ~attr.indexOf( name ) ) attr.splice( attr.indexOf( name ), 1 );\n\n\tthis.node.className = attr.join( ' ' );\n}\n\nfunction updateBoolean ( reset ) {\n\t// with two-way binding, only update if the change wasn't initiated by the user\n\t// otherwise the cursor will often be sent to the wrong place\n\tif ( !this.locked ) {\n\t\tif ( reset ) {\n\t\t\tif ( this.useProperty ) this.node[ this.propertyName ] = false;\n\t\t\tthis.node.removeAttribute( this.propertyName );\n\t\t\treturn;\n\t\t}\n\n\t\tif ( this.useProperty ) {\n\t\t\tthis.node[ this.propertyName ] = this.getValue();\n\t\t} else {\n\t\t\tif ( this.getValue() ) {\n\t\t\t\tthis.node.setAttribute( this.propertyName, '' );\n\t\t\t} else {\n\t\t\t\tthis.node.removeAttribute( this.propertyName );\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction updateAttribute ( reset ) {\n\tif ( reset ) this.node.removeAttribute( this.name );\n\telse this.node.setAttribute( this.name, safeToStringValue( this.getString() ) );\n}\n\nfunction updateNamespacedAttribute ( reset ) {\n\tif ( reset ) this.node.removeAttributeNS( this.namespace, this.name.slice( this.name.indexOf( ':' ) + 1 ) );\n\telse this.node.setAttributeNS( this.namespace, this.name.slice( this.name.indexOf( ':' ) + 1 ), safeToStringValue( this.getString() ) );\n}\n\nvar propertyNames = {\n\t'accept-charset': 'acceptCharset',\n\taccesskey: 'accessKey',\n\tbgcolor: 'bgColor',\n\t'class': 'className',\n\tcodebase: 'codeBase',\n\tcolspan: 'colSpan',\n\tcontenteditable: 'contentEditable',\n\tdatetime: 'dateTime',\n\tdirname: 'dirName',\n\t'for': 'htmlFor',\n\t'http-equiv': 'httpEquiv',\n\tismap: 'isMap',\n\tmaxlength: 'maxLength',\n\tnovalidate: 'noValidate',\n\tpubdate: 'pubDate',\n\treadonly: 'readOnly',\n\trowspan: 'rowSpan',\n\ttabindex: 'tabIndex',\n\tusemap: 'useMap'\n};\n\nfunction lookupNamespace ( node, prefix ) {\n\tvar qualified = \"xmlns:\" + prefix;\n\n\twhile ( node ) {\n\t\tif ( node.hasAttribute && node.hasAttribute( qualified ) ) return node.getAttribute( qualified );\n\t\tnode = node.parentNode;\n\t}\n\n\treturn namespaces[ prefix ];\n}\n\nvar Attribute = (function (Item$$1) {\n\tfunction Attribute ( options ) {\n\t\tItem$$1.call( this, options );\n\n\t\tthis.name = options.template.n;\n\t\tthis.namespace = null;\n\n\t\tthis.owner = options.owner || options.parentFragment.owner || options.element || findElement( options.parentFragment );\n\t\tthis.element = options.element || (this.owner.attributeByName ? this.owner : findElement( options.parentFragment ) );\n\t\tthis.parentFragment = options.parentFragment; // shared\n\t\tthis.ractive = this.parentFragment.ractive;\n\n\t\tthis.rendered = false;\n\t\tthis.updateDelegate = null;\n\t\tthis.fragment = null;\n\n\t\tthis.element.attributeByName[ this.name ] = this;\n\n\t\tif ( !isArray( options.template.f ) ) {\n\t\t\tthis.value = options.template.f;\n\t\t\tif ( this.value === 0 ) {\n\t\t\t\tthis.value = '';\n\t\t\t}\n\t\t} else {\n\t\t\tthis.fragment = new Fragment({\n\t\t\t\towner: this,\n\t\t\t\ttemplate: options.template.f\n\t\t\t});\n\t\t}\n\n\t\tthis.interpolator = this.fragment &&\n\t\t\tthis.fragment.items.length === 1 &&\n\t\t\tthis.fragment.items[0].type === INTERPOLATOR &&\n\t\t\tthis.fragment.items[0];\n\n\t\tif ( this.interpolator ) this.interpolator.owner = this;\n\t}\n\n\tAttribute.prototype = Object.create( Item$$1 && Item$$1.prototype );\n\tAttribute.prototype.constructor = Attribute;\n\n\tAttribute.prototype.bind = function bind () {\n\t\tif ( this.fragment ) {\n\t\t\tthis.fragment.bind();\n\t\t}\n\t};\n\n\tAttribute.prototype.bubble = function bubble () {\n\t\tif ( !this.dirty ) {\n\t\t\tthis.parentFragment.bubble();\n\t\t\tthis.element.bubble();\n\t\t\tthis.dirty = true;\n\t\t}\n\t};\n\n\tAttribute.prototype.destroyed = function destroyed () {\n\t\tthis.updateDelegate( true );\n\t};\n\n\tAttribute.prototype.getString = function getString () {\n\t\treturn this.fragment ?\n\t\t\tthis.fragment.toString() :\n\t\t\tthis.value != null ? '' + this.value : '';\n\t};\n\n\t// TODO could getValue ever be called for a static attribute,\n\t// or can we assume that this.fragment exists?\n\tAttribute.prototype.getValue = function getValue () {\n\t\treturn this.fragment ? this.fragment.valueOf() : booleanAttributes.test( this.name ) ? true : this.value;\n\t};\n\n\tAttribute.prototype.render = function render () {\n\t\tvar node = this.element.node;\n\t\tthis.node = node;\n\n\t\t// should we use direct property access, or setAttribute?\n\t\tif ( !node.namespaceURI || node.namespaceURI === namespaces.html ) {\n\t\t\tthis.propertyName = propertyNames[ this.name ] || this.name;\n\n\t\t\tif ( node[ this.propertyName ] !== undefined ) {\n\t\t\t\tthis.useProperty = true;\n\t\t\t}\n\n\t\t\t// is attribute a boolean attribute or 'value'? If so we're better off doing e.g.\n\t\t\t// node.selected = true rather than node.setAttribute( 'selected', '' )\n\t\t\tif ( booleanAttributes.test( this.name ) || this.isTwoway ) {\n\t\t\t\tthis.isBoolean = true;\n\t\t\t}\n\n\t\t\tif ( this.propertyName === 'value' ) {\n\t\t\t\tnode._ractive.value = this.value;\n\t\t\t}\n\t\t}\n\n\t\tif ( node.namespaceURI ) {\n\t\t\tvar index = this.name.indexOf( ':' );\n\t\t\tif ( index !== -1 ) {\n\t\t\t\tthis.namespace = lookupNamespace( node, this.name.slice( 0, index ) );\n\t\t\t} else {\n\t\t\t\tthis.namespace = node.namespaceURI;\n\t\t\t}\n\t\t}\n\n\t\tthis.rendered = true;\n\t\tthis.updateDelegate = getUpdateDelegate( this );\n\t\tthis.updateDelegate();\n\t};\n\n\tAttribute.prototype.toString = function toString () {\n\t\tvar value = this.getValue();\n\n\t\t// Special case - select and textarea values (should not be stringified)\n\t\tif ( this.name === 'value' && ( this.element.getAttribute( 'contenteditable' ) !== undefined || ( this.element.name === 'select' || this.element.name === 'textarea' ) ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Special case – bound radio `name` attributes\n\t\tif ( this.name === 'name' && this.element.name === 'input' && this.interpolator && this.element.getAttribute( 'type' ) === 'radio' ) {\n\t\t\treturn (\"name=\\\"{{\" + (this.interpolator.model.getKeypath()) + \"}}\\\"\");\n\t\t}\n\n\t\t// Special case - style and class attributes and directives\n\t\tif ( this.owner === this.element && ( this.name === 'style' || this.name === 'class' || this.styleName || this.inlineClass ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( booleanAttributes.test( this.name ) ) return value ? this.name : '';\n\t\tif ( value == null ) return '';\n\n\t\tvar str = safeAttributeString( this.getString() );\n\t\treturn str ?\n\t\t\t(\"\" + (this.name) + \"=\\\"\" + str + \"\\\"\") :\n\t\t\tthis.name;\n\t};\n\n\tAttribute.prototype.unbind = function unbind () {\n\t\tif ( this.fragment ) this.fragment.unbind();\n\t};\n\n\tAttribute.prototype.unrender = function unrender () {\n\t\tthis.updateDelegate( true );\n\n\t\tthis.rendered = false;\n\t};\n\n\tAttribute.prototype.update = function update () {\n\t\tif ( this.dirty ) {\n\t\t\tthis.dirty = false;\n\t\t\tif ( this.fragment ) this.fragment.update();\n\t\t\tif ( this.rendered ) this.updateDelegate();\n\t\t\tif ( this.isTwoway && !this.locked ) {\n\t\t\t\tthis.interpolator.twowayBinding.lastVal( true, this.interpolator.model.get() );\n\t\t\t}\n\t\t}\n\t};\n\n\treturn Attribute;\n}(Item));\n\nvar BindingFlag = (function (Item$$1) {\n\tfunction BindingFlag ( options ) {\n\t\tItem$$1.call( this, options );\n\n\t\tthis.owner = options.owner || options.parentFragment.owner || findElement( options.parentFragment );\n\t\tthis.element = this.owner.attributeByName ? this.owner : findElement( options.parentFragment );\n\t\tthis.flag = options.template.v === 'l' ? 'lazy' : 'twoway';\n\n\t\tif ( this.element.type === ELEMENT ) {\n\t\t\tif ( isArray( options.template.f ) ) {\n\t\t\t\tthis.fragment = new Fragment({\n\t\t\t\t\towner: this,\n\t\t\t\t\ttemplate: options.template.f\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.interpolator = this.fragment &&\n\t\t\t\t\t\t\t\tthis.fragment.items.length === 1 &&\n\t\t\t\t\t\t\t\tthis.fragment.items[0].type === INTERPOLATOR &&\n\t\t\t\t\t\t\t\tthis.fragment.items[0];\n\t\t}\n\t}\n\n\tBindingFlag.prototype = Object.create( Item$$1 && Item$$1.prototype );\n\tBindingFlag.prototype.constructor = BindingFlag;\n\n\tBindingFlag.prototype.bind = function bind () {\n\t\tif ( this.fragment ) this.fragment.bind();\n\t\tset$3( this, this.getValue(), true );\n\t};\n\n\tBindingFlag.prototype.bubble = function bubble () {\n\t\tif ( !this.dirty ) {\n\t\t\tthis.element.bubble();\n\t\t\tthis.dirty = true;\n\t\t}\n\t};\n\n\tBindingFlag.prototype.getValue = function getValue () {\n\t\tif ( this.fragment ) return this.fragment.valueOf();\n\t\telse if ( 'value' in this ) return this.value;\n\t\telse if ( 'f' in this.template ) return this.template.f;\n\t\telse return true;\n\t};\n\n\tBindingFlag.prototype.render = function render () {\n\t\tset$3( this, this.getValue(), true );\n\t};\n\n\tBindingFlag.prototype.toString = function toString () { return ''; };\n\n\tBindingFlag.prototype.unbind = function unbind () {\n\t\tif ( this.fragment ) this.fragment.unbind();\n\n\t\tdelete this.element[ this.flag ];\n\t};\n\n\tBindingFlag.prototype.unrender = function unrender () {\n\t\tif ( this.element.rendered ) this.element.recreateTwowayBinding();\n\t};\n\n\tBindingFlag.prototype.update = function update () {\n\t\tif ( this.dirty ) {\n\t\t\tif ( this.fragment ) this.fragment.update();\n\t\t\tset$3( this, this.getValue(), true );\n\t\t}\n\t};\n\n\treturn BindingFlag;\n}(Item));\n\nfunction set$3 ( flag, value, update ) {\n\tif ( value === 0 ) {\n\t\tflag.value = true;\n\t} else if ( value === 'true' ) {\n\t\tflag.value = true;\n\t} else if ( value === 'false' || value === '0' ) {\n\t\tflag.value = false;\n\t} else {\n\t\tflag.value = value;\n\t}\n\n\tvar current = flag.element[ flag.flag ];\n\tflag.element[ flag.flag ] = flag.value;\n\tif ( update && !flag.element.attributes.binding && current !== flag.value ) {\n\t\tflag.element.recreateTwowayBinding();\n\t}\n\n\treturn flag.value;\n}\n\nvar div$1 = doc ? createElement( 'div' ) : null;\n\nvar attributes = false;\nfunction inAttributes() { return attributes; }\nfunction doInAttributes( fn ) {\n\tattributes = true;\n\tfn();\n\tattributes = false;\n}\n\nvar ConditionalAttribute = (function (Item$$1) {\n\tfunction ConditionalAttribute ( options ) {\n\t\tItem$$1.call( this, options );\n\n\t\tthis.attributes = [];\n\n\t\tthis.owner = options.owner;\n\n\t\tthis.fragment = new Fragment({\n\t\t\tractive: this.ractive,\n\t\t\towner: this,\n\t\t\ttemplate: this.template\n\t\t});\n\t\t// this fragment can't participate in node-y things\n\t\tthis.fragment.findNextNode = noop;\n\n\t\tthis.dirty = false;\n\t}\n\n\tConditionalAttribute.prototype = Object.create( Item$$1 && Item$$1.prototype );\n\tConditionalAttribute.prototype.constructor = ConditionalAttribute;\n\n\tConditionalAttribute.prototype.bind = function bind () {\n\t\tthis.fragment.bind();\n\t};\n\n\tConditionalAttribute.prototype.bubble = function bubble () {\n\t\tif ( !this.dirty ) {\n\t\t\tthis.dirty = true;\n\t\t\tthis.owner.bubble();\n\t\t}\n\t};\n\n\tConditionalAttribute.prototype.render = function render () {\n\t\tthis.node = this.owner.node;\n\t\tif ( this.node ) {\n\t\t\tthis.isSvg = this.node.namespaceURI === svg$1;\n\t\t}\n\n\t\tattributes = true;\n\t\tif ( !this.rendered ) this.fragment.render();\n\t\tattributes = false;\n\n\t\tthis.rendered = true;\n\t\tthis.dirty = true; // TODO this seems hacky, but necessary for tests to pass in browser AND node.js\n\t\tthis.update();\n\t};\n\n\tConditionalAttribute.prototype.toString = function toString () {\n\t\treturn this.fragment.toString();\n\t};\n\n\tConditionalAttribute.prototype.unbind = function unbind () {\n\t\tthis.fragment.unbind();\n\t};\n\n\tConditionalAttribute.prototype.unrender = function unrender () {\n\t\tthis.rendered = false;\n\t\tthis.fragment.unrender();\n\t};\n\n\tConditionalAttribute.prototype.update = function update () {\n\t\tvar this$1 = this;\n\n\t\tvar str;\n\t\tvar attrs;\n\n\t\tif ( this.dirty ) {\n\t\t\tthis.dirty = false;\n\n\t\t\tattributes = true;\n\t\t\tthis.fragment.update();\n\t\t\tattributes = false;\n\n\t\t\tif ( this.rendered && this.node ) {\n\t\t\t\tstr = this.fragment.toString();\n\t\t\t\tattrs = parseAttributes( str, this.isSvg );\n\n\t\t\t\t// any attributes that previously existed but no longer do\n\t\t\t\t// must be removed\n\t\t\t\tthis.attributes.filter( function ( a ) { return notIn( attrs, a ); } ).forEach( function ( a ) {\n\t\t\t\t\tthis$1.node.removeAttribute( a.name );\n\t\t\t\t});\n\n\t\t\t\tattrs.forEach( function ( a ) {\n\t\t\t\t\tthis$1.node.setAttribute( a.name, a.value );\n\t\t\t\t});\n\n\t\t\t\tthis.attributes = attrs;\n\t\t\t}\n\t\t}\n\t};\n\n\treturn ConditionalAttribute;\n}(Item));\n\nfunction parseAttributes ( str, isSvg ) {\n\tvar tagName = isSvg ? 'svg' : 'div';\n\treturn str\n\t\t? (div$1.innerHTML = \"<\" + tagName + \" \" + str + \"></\" + tagName + \">\") &&\n\t\t\ttoArray(div$1.childNodes[0].attributes)\n\t\t: [];\n}\n\nfunction notIn ( haystack, needle ) {\n\tvar i = haystack.length;\n\n\twhile ( i-- ) {\n\t\tif ( haystack[i].name === needle.name ) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn true;\n}\n\nvar processWrapper = function ( wrapper, array, methodName, newIndices ) {\n\tvar __model = wrapper.__model;\n\n\tif ( newIndices ) {\n\t\t__model.shuffle( newIndices );\n\t} else {\n\t\t// If this is a sort or reverse, we just do root.set()...\n\t\t// TODO use merge logic?\n\t\t//root.viewmodel.mark( keypath );\n\t}\n};\n\nvar mutatorMethods = [ 'pop', 'push', 'reverse', 'shift', 'sort', 'splice', 'unshift' ];\nvar patchedArrayProto = [];\n\nmutatorMethods.forEach( function ( methodName ) {\n\tvar method = function () {\n\t\tvar this$1 = this;\n\t\tvar args = [], len = arguments.length;\n\t\twhile ( len-- ) args[ len ] = arguments[ len ];\n\n\t\tvar newIndices = getNewIndices( this.length, methodName, args );\n\n\t\t// lock any magic array wrappers, so that things don't get fudged\n\t\tthis._ractive.wrappers.forEach( function ( r ) { if ( r.magic ) r.magic.locked = true; } );\n\n\t\t// apply the underlying method\n\t\tvar result = Array.prototype[ methodName ].apply( this, arguments );\n\n\t\t// trigger changes\n\t\trunloop.start();\n\n\t\tthis._ractive.setting = true;\n\t\tvar i = this._ractive.wrappers.length;\n\t\twhile ( i-- ) {\n\t\t\tprocessWrapper( this$1._ractive.wrappers[i], this$1, methodName, newIndices );\n\t\t}\n\n\t\trunloop.end();\n\n\t\tthis._ractive.setting = false;\n\n\t\t// unlock the magic arrays... magic... bah\n\t\tthis._ractive.wrappers.forEach( function ( r ) { if ( r.magic ) r.magic.locked = false; } );\n\n\t\treturn result;\n\t};\n\n\tdefineProperty( patchedArrayProto, methodName, {\n\t\tvalue: method\n\t});\n});\n\nvar patchArrayMethods;\nvar unpatchArrayMethods;\n\n// can we use prototype chain injection?\n// http://perfectionkills.com/how-ecmascript-5-still-does-not-allow-to-subclass-an-array/#wrappers_prototype_chain_injection\nif ( ({}).__proto__ ) {\n\t// yes, we can\n\tpatchArrayMethods = function ( array ) { return array.__proto__ = patchedArrayProto; };\n\tunpatchArrayMethods = function ( array ) { return array.__proto__ = Array.prototype; };\n}\n\nelse {\n\t// no, we can't\n\tpatchArrayMethods = function ( array ) {\n\t\tvar i = mutatorMethods.length;\n\t\twhile ( i-- ) {\n\t\t\tvar methodName = mutatorMethods[i];\n\t\t\tdefineProperty( array, methodName, {\n\t\t\t\tvalue: patchedArrayProto[ methodName ],\n\t\t\t\tconfigurable: true\n\t\t\t});\n\t\t}\n\t};\n\n\tunpatchArrayMethods = function ( array ) {\n\t\tvar i = mutatorMethods.length;\n\t\twhile ( i-- ) {\n\t\t\tdelete array[ mutatorMethods[i] ];\n\t\t}\n\t};\n}\n\npatchArrayMethods.unpatch = unpatchArrayMethods; // TODO export separately?\nvar patch = patchArrayMethods;\n\nvar errorMessage$1 = 'Something went wrong in a rather interesting way';\n\nvar arrayAdaptor = {\n\tfilter: function ( object ) {\n\t\t// wrap the array if a) b) it's an array, and b) either it hasn't been wrapped already,\n\t\t// or the array didn't trigger the get() itself\n\t\treturn isArray( object ) && ( !object._ractive || !object._ractive.setting );\n\t},\n\twrap: function ( ractive, array, keypath ) {\n\t\treturn new ArrayWrapper( ractive, array, keypath );\n\t}\n};\n\nvar ArrayWrapper = function ArrayWrapper ( ractive, array ) {\n\tthis.root = ractive;\n\tthis.value = array;\n\tthis.__model = null; // filled in later\n\n\t// if this array hasn't already been ractified, ractify it\n\tif ( !array._ractive ) {\n\t\t// define a non-enumerable _ractive property to store the wrappers\n\t\tdefineProperty( array, '_ractive', {\n\t\t\tvalue: {\n\t\t\t\twrappers: [],\n\t\t\t\tinstances: [],\n\t\t\t\tsetting: false\n\t\t\t},\n\t\t\tconfigurable: true\n\t\t});\n\n\t\tpatch( array );\n\t}\n\n\t// store the ractive instance, so we can handle transitions later\n\tif ( !array._ractive.instances[ ractive._guid ] ) {\n\t\tarray._ractive.instances[ ractive._guid ] = 0;\n\t\tarray._ractive.instances.push( ractive );\n\t}\n\n\tarray._ractive.instances[ ractive._guid ] += 1;\n\tarray._ractive.wrappers.push( this );\n};\n\nArrayWrapper.prototype.get = function get () {\n\treturn this.value;\n};\n\nArrayWrapper.prototype.reset = function reset ( value ) {\n\treturn this.value === value;\n};\n\nArrayWrapper.prototype.teardown = function teardown () {\n\tvar array, storage, wrappers, instances, index;\n\n\tarray = this.value;\n\tstorage = array._ractive;\n\twrappers = storage.wrappers;\n\tinstances = storage.instances;\n\n\t// if teardown() was invoked because we're clearing the cache as a result of\n\t// a change that the array itself triggered, we can save ourselves the teardown\n\t// and immediate setup\n\tif ( storage.setting ) {\n\t\treturn false; // so that we don't remove it from cached wrappers\n\t}\n\n\tindex = wrappers.indexOf( this );\n\tif ( index === -1 ) {\n\t\tthrow new Error( errorMessage$1 );\n\t}\n\n\twrappers.splice( index, 1 );\n\n\t// if nothing else depends on this array, we can revert it to its\n\t// natural state\n\tif ( !wrappers.length ) {\n\t\tdelete array._ractive;\n\t\tpatch.unpatch( this.value );\n\t}\n\n\telse {\n\t\t// remove ractive instance if possible\n\t\tinstances[ this.root._guid ] -= 1;\n\t\tif ( !instances[ this.root._guid ] ) {\n\t\t\tindex = instances.indexOf( this.root );\n\n\t\t\tif ( index === -1 ) {\n\t\t\t\tthrow new Error( errorMessage$1 );\n\t\t\t}\n\n\t\t\tinstances.splice( index, 1 );\n\t\t}\n\t}\n};\n\nvar magicAdaptor;\n\ntry {\n\tObject.defineProperty({}, 'test', { get: function() {}, set: function() {} });\n\n\tmagicAdaptor = {\n\t\tfilter: function ( value ) {\n\t\t\treturn value && typeof value === 'object';\n\t\t},\n\t\twrap: function ( ractive, value, keypath ) {\n\t\t\treturn new MagicWrapper( ractive, value, keypath );\n\t\t}\n\t};\n} catch ( err ) {\n\tmagicAdaptor = false;\n}\n\nvar magicAdaptor$1 = magicAdaptor;\n\nfunction createOrWrapDescriptor ( originalDescriptor, ractive, keypath, wrapper ) {\n\tif ( originalDescriptor.set && originalDescriptor.set.__magic ) {\n\t\toriginalDescriptor.set.__magic.dependants.push({ ractive: ractive, keypath: keypath });\n\t\treturn originalDescriptor;\n\t}\n\n\tvar setting;\n\n\tvar dependants = [{ ractive: ractive, keypath: keypath }];\n\n\tvar descriptor = {\n\t\tget: function () {\n\t\t\treturn 'value' in originalDescriptor ? originalDescriptor.value : originalDescriptor.get.call( this );\n\t\t},\n\t\tset: function (value) {\n\t\t\tif ( setting ) return;\n\n\t\t\tif ( 'value' in originalDescriptor ) {\n\t\t\t\toriginalDescriptor.value = value;\n\t\t\t} else {\n\t\t\t\toriginalDescriptor.set.call( this, value );\n\t\t\t}\n\n\t\t\tif ( wrapper.locked ) return;\n\t\t\tsetting = true;\n\t\t\tdependants.forEach( function (ref) {\n\t\t\t\tvar ractive = ref.ractive;\n\t\t\t\tvar keypath = ref.keypath;\n\n\t\t\t\tractive.set( keypath, value );\n\t\t\t});\n\t\t\tsetting = false;\n\t\t},\n\t\tenumerable: true\n\t};\n\n\tdescriptor.set.__magic = { dependants: dependants, originalDescriptor: originalDescriptor };\n\n\treturn descriptor;\n}\n\nfunction revert ( descriptor, ractive, keypath ) {\n\tif ( !descriptor.set || !descriptor.set.__magic ) return true;\n\n\tvar dependants = descriptor.set.__magic;\n\tvar i = dependants.length;\n\twhile ( i-- ) {\n\t\tvar dependant = dependants[i];\n\t\tif ( dependant.ractive === ractive && dependant.keypath === keypath ) {\n\t\t\tdependants.splice( i, 1 );\n\t\t\treturn false;\n\t\t}\n\t}\n}\n\nvar MagicWrapper = function MagicWrapper ( ractive, value, keypath ) {\n\tvar this$1 = this;\n\n\t\tthis.ractive = ractive;\n\tthis.value = value;\n\tthis.keypath = keypath;\n\n\tthis.originalDescriptors = {};\n\n\t// wrap all properties with getters\n\tObject.keys( value ).forEach( function ( key ) {\n\t\tvar originalDescriptor = Object.getOwnPropertyDescriptor( this$1.value, key );\n\t\tthis$1.originalDescriptors[ key ] = originalDescriptor;\n\n\t\tvar childKeypath = keypath ? (\"\" + keypath + \".\" + (escapeKey( key ))) : escapeKey( key );\n\n\t\tvar descriptor = createOrWrapDescriptor( originalDescriptor, ractive, childKeypath, this$1 );\n\n\n\n\t\tObject.defineProperty( this$1.value, key, descriptor );\n\t});\n};\n\nMagicWrapper.prototype.get = function get () {\n\treturn this.value;\n};\n\nMagicWrapper.prototype.reset = function reset ( value ) {\n\treturn this.value === value;\n};\n\nMagicWrapper.prototype.set = function set ( key, value ) {\n\tthis.value[ key ] = value;\n};\n\nMagicWrapper.prototype.teardown = function teardown () {\n\tvar this$1 = this;\n\n\t\tObject.keys( this.value ).forEach( function ( key ) {\n\t\tvar descriptor = Object.getOwnPropertyDescriptor( this$1.value, key );\n\t\tif ( !descriptor.set || !descriptor.set.__magic ) return;\n\n\t\trevert( descriptor );\n\n\t\tif ( descriptor.set.__magic.dependants.length === 1 ) {\n\t\t\tObject.defineProperty( this$1.value, key, descriptor.set.__magic.originalDescriptor );\n\t\t}\n\t});\n};\n\nvar MagicArrayWrapper = function MagicArrayWrapper ( ractive, array, keypath ) {\n\tthis.value = array;\n\n\tthis.magic = true;\n\n\tthis.magicWrapper = magicAdaptor$1.wrap( ractive, array, keypath );\n\tthis.arrayWrapper = arrayAdaptor.wrap( ractive, array, keypath );\n\tthis.arrayWrapper.magic = this.magicWrapper;\n\n\t// ugh, this really is a terrible hack\n\tObject.defineProperty( this, '__model', {\n\t\tget: function () {\n\t\t\treturn this.arrayWrapper.__model;\n\t\t},\n\t\tset: function ( model ) {\n\t\t\tthis.arrayWrapper.__model = model;\n\t\t}\n\t});\n};\n\nMagicArrayWrapper.prototype.get = function get () {\n\treturn this.value;\n};\n\nMagicArrayWrapper.prototype.teardown = function teardown () {\n\tthis.arrayWrapper.teardown();\n\tthis.magicWrapper.teardown();\n};\n\nMagicArrayWrapper.prototype.reset = function reset ( value ) {\n\treturn this.arrayWrapper.reset( value ) && this.magicWrapper.reset( value );\n};\n\nvar magicArrayAdaptor = {\n\tfilter: function ( object, keypath, ractive ) {\n\t\treturn magicAdaptor$1.filter( object, keypath, ractive ) && arrayAdaptor.filter( object );\n\t},\n\n\twrap: function ( ractive, array, keypath ) {\n\t\treturn new MagicArrayWrapper( ractive, array, keypath );\n\t}\n};\n\n/* global console */\n\n// TODO this is probably a bit anal, maybe we should leave it out\nfunction prettify ( fnBody ) {\n\tvar lines = fnBody\n\t\t.replace( /^\\t+/gm, function ( tabs ) { return tabs.split( '\\t' ).join( '  ' ); } )\n\t\t.split( '\\n' );\n\n\tvar minIndent = lines.length < 2 ? 0 :\n\t\tlines.slice( 1 ).reduce( function ( prev, line ) {\n\t\t\treturn Math.min( prev, /^\\s*/.exec( line )[0].length );\n\t\t}, Infinity );\n\n\treturn lines.map( function ( line, i ) {\n\t\treturn '    ' + ( i ? line.substring( minIndent ) : line );\n\t}).join( '\\n' );\n}\n\n// Ditto. This function truncates the stack to only include app code\nfunction truncateStack ( stack ) {\n\tif ( !stack ) return '';\n\n\tvar lines = stack.split( '\\n' );\n\tvar name = Computation.name + '.getValue';\n\n\tvar truncated = [];\n\n\tvar len = lines.length;\n\tfor ( var i = 1; i < len; i += 1 ) {\n\t\tvar line = lines[i];\n\n\t\tif ( ~line.indexOf( name ) ) {\n\t\t\treturn truncated.join( '\\n' );\n\t\t} else {\n\t\t\ttruncated.push( line );\n\t\t}\n\t}\n}\n\nvar Computation = (function (Model$$1) {\n\tfunction Computation ( viewmodel, signature, key ) {\n\t\tModel$$1.call( this, null, null );\n\n\t\tthis.root = this.parent = viewmodel;\n\t\tthis.signature = signature;\n\n\t\tthis.key = key; // not actually used, but helps with debugging\n\t\tthis.isExpression = key && key[0] === '@';\n\n\t\tthis.isReadonly = !this.signature.setter;\n\n\t\tthis.context = viewmodel.computationContext;\n\n\t\tthis.dependencies = [];\n\n\t\tthis.children = [];\n\t\tthis.childByKey = {};\n\n\t\tthis.deps = [];\n\n\t\tthis.dirty = true;\n\n\t\t// TODO: is there a less hackish way to do this?\n\t\tthis.shuffle = undefined;\n\t}\n\n\tComputation.prototype = Object.create( Model$$1 && Model$$1.prototype );\n\tComputation.prototype.constructor = Computation;\n\n\tComputation.prototype.get = function get ( shouldCapture ) {\n\t\tif ( shouldCapture ) capture( this );\n\n\t\tif ( this.dirty ) {\n\t\t\tthis.dirty = false;\n\t\t\tthis.value = this.getValue();\n\t\t\tthis.adapt();\n\t\t}\n\n\t\t// if capturing, this value needs to be unwrapped because it's for external use\n\t\treturn shouldCapture && this.wrapper ? this.wrapper.value : this.value;\n\t};\n\n\tComputation.prototype.getValue = function getValue () {\n\t\tstartCapturing();\n\t\tvar result;\n\n\t\ttry {\n\t\t\tresult = this.signature.getter.call( this.context );\n\t\t} catch ( err ) {\n\t\t\twarnIfDebug( (\"Failed to compute \" + (this.getKeypath()) + \": \" + (err.message || err)) );\n\n\t\t\t// TODO this is all well and good in Chrome, but...\n\t\t\t// ...also, should encapsulate this stuff better, and only\n\t\t\t// show it if Ractive.DEBUG\n\t\t\tif ( hasConsole ) {\n\t\t\t\tif ( console.groupCollapsed ) console.groupCollapsed( '%cshow details', 'color: rgb(82, 140, 224); font-weight: normal; text-decoration: underline;' );\n\t\t\t\tvar functionBody = prettify( this.signature.getterString );\n\t\t\t\tvar stack = this.signature.getterUseStack ? '\\n\\n' + truncateStack( err.stack ) : '';\n\t\t\t\tconsole.error( (\"\" + (err.name) + \": \" + (err.message) + \"\\n\\n\" + functionBody + \"\" + stack) );\n\t\t\t\tif ( console.groupCollapsed ) console.groupEnd();\n\t\t\t}\n\t\t}\n\n\t\tvar dependencies = stopCapturing();\n\t\tthis.setDependencies( dependencies );\n\n\t\treturn result;\n\t};\n\n\tComputation.prototype.handleChange = function handleChange$1 () {\n\t\tthis.dirty = true;\n\n\t\tthis.links.forEach( marked );\n\t\tthis.deps.forEach( handleChange$1$1 );\n\t\tthis.children.forEach( handleChange$1$1 );\n\t\tthis.clearUnresolveds(); // TODO same question as on Model - necessary for primitives?\n\t};\n\n\tComputation.prototype.joinKey = function joinKey ( key ) {\n\t\tif ( key === undefined || key === '' ) return this;\n\n\t\tif ( !this.childByKey.hasOwnProperty( key ) ) {\n\t\t\tvar child = new ComputationChild( this, key );\n\t\t\tthis.children.push( child );\n\t\t\tthis.childByKey[ key ] = child;\n\t\t}\n\n\t\treturn this.childByKey[ key ];\n\t};\n\n\tComputation.prototype.mark = function mark () {\n\t\tthis.handleChange();\n\t};\n\n\tComputation.prototype.rebinding = function rebinding ( next, previous ) {\n\t\t// computations will grab all of their deps again automagically\n\t\tif ( next !== previous ) this.handleChange();\n\t};\n\n\tComputation.prototype.set = function set ( value ) {\n\t\tif ( !this.signature.setter ) {\n\t\t\tthrow new Error( (\"Cannot set read-only computed value '\" + (this.key) + \"'\") );\n\t\t}\n\n\t\tthis.signature.setter( value );\n\t};\n\n\tComputation.prototype.setDependencies = function setDependencies ( dependencies ) {\n\t\t// unregister any soft dependencies we no longer have\n\t\tvar this$1 = this;\n\n\t\tvar i = this.dependencies.length;\n\t\twhile ( i-- ) {\n\t\t\tvar model = this$1.dependencies[i];\n\t\t\tif ( !~dependencies.indexOf( model ) ) model.unregister( this$1 );\n\t\t}\n\n\t\t// and add any new ones\n\t\ti = dependencies.length;\n\t\twhile ( i-- ) {\n\t\t\tvar model$1 = dependencies[i];\n\t\t\tif ( !~this$1.dependencies.indexOf( model$1 ) ) model$1.register( this$1 );\n\t\t}\n\n\t\tthis.dependencies = dependencies;\n\t};\n\n\tComputation.prototype.teardown = function teardown () {\n\t\tvar this$1 = this;\n\n\t\tvar i = this.dependencies.length;\n\t\twhile ( i-- ) {\n\t\t\tif ( this$1.dependencies[i] ) this$1.dependencies[i].unregister( this$1 );\n\t\t}\n\t\tif ( this.root.computations[this.key] === this ) delete this.root.computations[this.key];\n\t\tModel$$1.prototype.teardown.call(this);\n\t};\n\n\tComputation.prototype.unregister = function unregister ( dependent ) {\n\t\tModel$$1.prototype.unregister.call( this, dependent );\n\t\t// tear down expressions with no deps, because they will be replaced when needed\n\t\tif ( this.isExpression && this.deps.length === 0 ) this.teardown();\n\t};\n\n\treturn Computation;\n}(Model));\n\nvar RactiveModel = (function (Model$$1) {\n\tfunction RactiveModel ( ractive ) {\n\t\tModel$$1.call( this, null, '' );\n\t\tthis.value = ractive;\n\t\tthis.isRoot = true;\n\t\tthis.root = this;\n\t\tthis.adaptors = [];\n\t\tthis.ractive = ractive;\n\t\tthis.changes = {};\n\t}\n\n\tRactiveModel.prototype = Object.create( Model$$1 && Model$$1.prototype );\n\tRactiveModel.prototype.constructor = RactiveModel;\n\n\tRactiveModel.prototype.getKeypath = function getKeypath() {\n\t\treturn '@this';\n\t};\n\n\treturn RactiveModel;\n}(Model));\n\nvar hasProp$1 = Object.prototype.hasOwnProperty;\n\nvar RootModel = (function (Model$$1) {\n\tfunction RootModel ( options ) {\n\t\tModel$$1.call( this, null, null );\n\n\t\t// TODO deprecate this\n\t\tthis.changes = {};\n\n\t\tthis.isRoot = true;\n\t\tthis.root = this;\n\t\tthis.ractive = options.ractive; // TODO sever this link\n\n\t\tthis.value = options.data;\n\t\tthis.adaptors = options.adapt;\n\t\tthis.adapt();\n\n\t\tthis.computationContext = options.ractive;\n\t\tthis.computations = {};\n\n\t\t// TODO this is only for deprecation of using expression keypaths\n\t\tthis.expressions = {};\n\t}\n\n\tRootModel.prototype = Object.create( Model$$1 && Model$$1.prototype );\n\tRootModel.prototype.constructor = RootModel;\n\n\tRootModel.prototype.applyChanges = function applyChanges () {\n\t\tthis._changeHash = {};\n\t\tthis.flush();\n\n\t\treturn this._changeHash;\n\t};\n\n\tRootModel.prototype.compute = function compute ( key, signature ) {\n\t\tvar computation = new Computation( this, signature, key );\n\t\tthis.computations[ key ] = computation;\n\n\t\treturn computation;\n\t};\n\n\tRootModel.prototype.createLink = function createLink ( keypath, target, targetPath ) {\n\t\tvar this$1 = this;\n\n\t\tvar keys = splitKeypath( keypath );\n\n\t\tvar model = this;\n\t\twhile ( keys.length ) {\n\t\t\tvar key = keys.shift();\n\t\t\tmodel = this$1.childByKey[ key ] || this$1.joinKey( key );\n\t\t}\n\n\t\treturn model.link( target, targetPath );\n\t};\n\n\tRootModel.prototype.get = function get ( shouldCapture, options ) {\n\t\tvar this$1 = this;\n\n\t\tif ( shouldCapture ) capture( this );\n\n\t\tif ( !options || options.virtual !== false ) {\n\t\t\tvar result = this.getVirtual();\n\t\t\tvar keys = Object.keys( this.computations );\n\t\t\tvar i = keys.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tvar computation = this$1.computations[ keys[i] ];\n\t\t\t\t// exclude template expressions\n\t\t\t\tif ( !computation.isExpression ) {\n\t\t\t\t\tresult[ keys[i] ] = computation.get();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn result;\n\t\t} else {\n\t\t\treturn this.value;\n\t\t}\n\t};\n\n\tRootModel.prototype.getKeypath = function getKeypath () {\n\t\treturn '';\n\t};\n\n\tRootModel.prototype.getRactiveModel = function getRactiveModel() {\n\t\treturn this.ractiveModel || ( this.ractiveModel = new RactiveModel( this.ractive ) );\n\t};\n\n\tRootModel.prototype.getValueChildren = function getValueChildren () {\n\t\tvar children = Model$$1.prototype.getValueChildren.call( this, this.value );\n\n\t\tthis.children.forEach( function ( child ) {\n\t\t\tif ( child._link ) {\n\t\t\t\tvar idx = children.indexOf( child );\n\t\t\t\tif ( ~idx ) children.splice( idx, 1, child._link );\n\t\t\t\telse children.push( child._link );\n\t\t\t}\n\t\t});\n\n\t\tfor ( var k in this.computations ) {\n\t\t\tchildren.push( this.computations[k] );\n\t\t}\n\n\t\treturn children;\n\t};\n\n\tRootModel.prototype.handleChange = function handleChange$1 () {\n\t\tthis.deps.forEach( handleChange$1$1 );\n\t};\n\n\tRootModel.prototype.has = function has ( key ) {\n\t\tvar value = this.value;\n\n\t\tkey = unescapeKey( key );\n\t\tif ( hasProp$1.call( value, key ) ) return true;\n\n\t\t// mappings/links and computations\n\t\tif ( key in this.computations || this.childByKey[key] && this.childByKey[key]._link ) return true;\n\t\t// TODO remove this after deprecation is done\n\t\tif ( key in this.expressions ) return true;\n\n\t\t// We climb up the constructor chain to find if one of them contains the key\n\t\tvar constructor = value.constructor;\n\t\twhile ( constructor !== Function && constructor !== Array && constructor !== Object ) {\n\t\t\tif ( hasProp$1.call( constructor.prototype, key ) ) return true;\n\t\t\tconstructor = constructor.constructor;\n\t\t}\n\n\t\treturn false;\n\t};\n\n\tRootModel.prototype.joinKey = function joinKey ( key, opts ) {\n\t\tif ( key === '@global' ) return GlobalModel$1;\n\t\tif ( key === '@this' ) return this.getRactiveModel();\n\n\t\tif ( this.expressions.hasOwnProperty( key ) ) {\n\t\t\twarnIfDebug( (\"Accessing expression keypaths (\" + (key.substr(1)) + \") from the instance is deprecated. You can used a getNodeInfo or event object to access keypaths with expression context.\") );\n\t\t\treturn this.expressions[ key ];\n\t\t}\n\n\t\treturn this.computations.hasOwnProperty( key ) ? this.computations[ key ] :\n\t\t       Model$$1.prototype.joinKey.call( this, key, opts );\n\t};\n\n\tRootModel.prototype.map = function map ( localKey, origin ) {\n\t\tvar local = this.joinKey( localKey );\n\t\tlocal.link( origin );\n\t};\n\n\tRootModel.prototype.rebinding = function rebinding () {\n\t};\n\n\tRootModel.prototype.set = function set ( value ) {\n\t\t// TODO wrapping root node is a baaaad idea. We should prevent this\n\t\tvar wrapper = this.wrapper;\n\t\tif ( wrapper ) {\n\t\t\tvar shouldTeardown = !wrapper.reset || wrapper.reset( value ) === false;\n\n\t\t\tif ( shouldTeardown ) {\n\t\t\t\twrapper.teardown();\n\t\t\t\tthis.wrapper = null;\n\t\t\t\tthis.value = value;\n\t\t\t\tthis.adapt();\n\t\t\t}\n\t\t} else {\n\t\t\tthis.value = value;\n\t\t\tthis.adapt();\n\t\t}\n\n\t\tthis.deps.forEach( handleChange$1$1 );\n\t\tthis.children.forEach( mark$1$1 );\n\t\tthis.clearUnresolveds(); // TODO do we need to do this with primitive values? if not, what about e.g. unresolved `length` property of null -> string?\n\t};\n\n\tRootModel.prototype.retrieve = function retrieve () {\n\t\treturn this.value;\n\t};\n\n\tRootModel.prototype.update = function update () {\n\t\t// noop\n\t};\n\n\treturn RootModel;\n}(Model));\n\nfunction getComputationSignature ( ractive, key, signature ) {\n\tvar getter;\n\tvar setter;\n\n\t// useful for debugging\n\tvar getterString;\n\tvar getterUseStack;\n\tvar setterString;\n\n\tif ( typeof signature === 'function' ) {\n\t\tgetter = bind$1$1( signature, ractive );\n\t\tgetterString = signature.toString();\n\t\tgetterUseStack = true;\n\t}\n\n\tif ( typeof signature === 'string' ) {\n\t\tgetter = createFunctionFromString( signature, ractive );\n\t\tgetterString = signature;\n\t}\n\n\tif ( typeof signature === 'object' ) {\n\t\tif ( typeof signature.get === 'string' ) {\n\t\t\tgetter = createFunctionFromString( signature.get, ractive );\n\t\t\tgetterString = signature.get;\n\t\t} else if ( typeof signature.get === 'function' ) {\n\t\t\tgetter = bind$1$1( signature.get, ractive );\n\t\t\tgetterString = signature.get.toString();\n\t\t\tgetterUseStack = true;\n\t\t} else {\n\t\t\tfatal( '`%s` computation must have a `get()` method', key );\n\t\t}\n\n\t\tif ( typeof signature.set === 'function' ) {\n\t\t\tsetter = bind$1$1( signature.set, ractive );\n\t\t\tsetterString = signature.set.toString();\n\t\t}\n\t}\n\n\treturn {\n\t\tgetter: getter,\n\t\tsetter: setter,\n\t\tgetterString: getterString,\n\t\tsetterString: setterString,\n\t\tgetterUseStack: getterUseStack\n\t};\n}\n\nvar constructHook = new Hook( 'construct' );\n\nvar registryNames$1 = [\n\t'adaptors',\n\t'components',\n\t'decorators',\n\t'easing',\n\t'events',\n\t'interpolators',\n\t'partials',\n\t'transitions'\n];\n\nvar uid = 0;\n\nfunction construct ( ractive, options ) {\n\tif ( Ractive.DEBUG ) welcome();\n\n\tinitialiseProperties( ractive );\n\n\t// TODO remove this, eventually\n\tdefineProperty( ractive, 'data', { get: deprecateRactiveData });\n\n\t// TODO don't allow `onconstruct` with `new Ractive()`, there's no need for it\n\tconstructHook.fire( ractive, options );\n\n\t// Add registries\n\tregistryNames$1.forEach( function ( name ) {\n\t\tractive[ name ] = extend$1( create( ractive.constructor[ name ] || null ), options[ name ] );\n\t});\n\n\t// Create a viewmodel\n\tvar viewmodel = new RootModel({\n\t\tadapt: getAdaptors( ractive, ractive.adapt, options ),\n\t\tdata: dataConfigurator.init( ractive.constructor, ractive, options ),\n\t\tractive: ractive\n\t});\n\n\tractive.viewmodel = viewmodel;\n\n\t// Add computed properties\n\tvar computed = extend$1( create( ractive.constructor.prototype.computed ), options.computed );\n\n\tfor ( var key in computed ) {\n\t\tvar signature = getComputationSignature( ractive, key, computed[ key ] );\n\t\tviewmodel.compute( key, signature );\n\t}\n}\n\nfunction combine$2 ( a, b ) {\n\tvar c = a.slice();\n\tvar i = b.length;\n\n\twhile ( i-- ) {\n\t\tif ( !~c.indexOf( b[i] ) ) {\n\t\t\tc.push( b[i] );\n\t\t}\n\t}\n\n\treturn c;\n}\n\nfunction getAdaptors ( ractive, protoAdapt, options ) {\n\tprotoAdapt = protoAdapt.map( lookup );\n\tvar adapt = ensureArray( options.adapt ).map( lookup );\n\n\tadapt = combine$2( protoAdapt, adapt );\n\n\tvar magic$$1 = 'magic' in options ? options.magic : ractive.magic;\n\tvar modifyArrays = 'modifyArrays' in options ? options.modifyArrays : ractive.modifyArrays;\n\n\tif ( magic$$1 ) {\n\t\tif ( !magic ) {\n\t\t\tthrow new Error( 'Getters and setters (magic mode) are not supported in this browser' );\n\t\t}\n\n\t\tif ( modifyArrays ) {\n\t\t\tadapt.push( magicArrayAdaptor );\n\t\t}\n\n\t\tadapt.push( magicAdaptor$1 );\n\t}\n\n\tif ( modifyArrays ) {\n\t\tadapt.push( arrayAdaptor );\n\t}\n\n\treturn adapt;\n\n\n\tfunction lookup ( adaptor ) {\n\t\tif ( typeof adaptor === 'string' ) {\n\t\t\tadaptor = findInViewHierarchy( 'adaptors', ractive, adaptor );\n\n\t\t\tif ( !adaptor ) {\n\t\t\t\tfatal( missingPlugin( adaptor, 'adaptor' ) );\n\t\t\t}\n\t\t}\n\n\t\treturn adaptor;\n\t}\n}\n\nfunction initialiseProperties ( ractive ) {\n\t// Generate a unique identifier, for places where you'd use a weak map if it\n\t// existed\n\tractive._guid = 'r-' + uid++;\n\n\t// events\n\tractive._subs = create( null );\n\n\t// storage for item configuration from instantiation to reset,\n\t// like dynamic functions or original values\n\tractive._config = {};\n\n\t// nodes registry\n\tractive.nodes = {};\n\n\t// events\n\tractive.event = null;\n\tractive._eventQueue = [];\n\n\t// live queries\n\tractive._liveQueries = [];\n\tractive._liveComponentQueries = [];\n\n\t// observers\n\tractive._observers = [];\n\n\tif(!ractive.component){\n\t\tractive.root = ractive;\n\t\tractive.parent = ractive.container = null; // TODO container still applicable?\n\t}\n\n}\n\nfunction deprecateRactiveData () {\n\tthrow new Error( 'Using `ractive.data` is no longer supported - you must use the `ractive.get()` API instead' );\n}\n\nfunction getChildQueue ( queue, ractive ) {\n\treturn queue[ ractive._guid ] || ( queue[ ractive._guid ] = [] );\n}\n\nfunction fire$1 ( hookQueue, ractive ) {\n\tvar childQueue = getChildQueue( hookQueue.queue, ractive );\n\n\thookQueue.hook.fire( ractive );\n\n\t// queue is \"live\" because components can end up being\n\t// added while hooks fire on parents that modify data values.\n\twhile ( childQueue.length ) {\n\t\tfire$1( hookQueue, childQueue.shift() );\n\t}\n\n\tdelete hookQueue.queue[ ractive._guid ];\n}\n\nvar HookQueue = function HookQueue ( event ) {\n\tthis.hook = new Hook( event );\n\tthis.inProcess = {};\n\tthis.queue = {};\n};\n\nHookQueue.prototype.begin = function begin ( ractive ) {\n\tthis.inProcess[ ractive._guid ] = true;\n};\n\nHookQueue.prototype.end = function end ( ractive ) {\n\tvar parent = ractive.parent;\n\n\t// If this is *isn't* a child of a component that's in process,\n\t// it should call methods or fire at this point\n\tif ( !parent || !this.inProcess[ parent._guid ] ) {\n\t\tfire$1( this, ractive );\n\t}\n\t// elsewise, handoff to parent to fire when ready\n\telse {\n\t\tgetChildQueue( this.queue, parent ).push( ractive );\n\t}\n\n\tdelete this.inProcess[ ractive._guid ];\n};\n\nvar configHook = new Hook( 'config' );\nvar initHook = new HookQueue( 'init' );\n\nfunction initialise ( ractive, userOptions, options ) {\n\tObject.keys( ractive.viewmodel.computations ).forEach( function ( key ) {\n\t\tvar computation = ractive.viewmodel.computations[ key ];\n\n\t\tif ( ractive.viewmodel.value.hasOwnProperty( key ) ) {\n\t\t\tcomputation.set( ractive.viewmodel.value[ key ] );\n\t\t}\n\t});\n\n\t// init config from Parent and options\n\tconfig.init( ractive.constructor, ractive, userOptions );\n\n\tconfigHook.fire( ractive );\n\tinitHook.begin( ractive );\n\n\tvar fragment;\n\n\t// Render virtual DOM\n\tif ( ractive.template ) {\n\t\tvar cssIds;\n\n\t\tif ( options.cssIds || ractive.cssId ) {\n\t\t\tcssIds = options.cssIds ? options.cssIds.slice() : [];\n\n\t\t\tif ( ractive.cssId ) {\n\t\t\t\tcssIds.push( ractive.cssId );\n\t\t\t}\n\t\t}\n\n\t\tractive.fragment = fragment = new Fragment({\n\t\t\towner: ractive,\n\t\t\ttemplate: ractive.template,\n\t\t\tcssIds: cssIds\n\t\t}).bind( ractive.viewmodel );\n\t}\n\n\tinitHook.end( ractive );\n\n\tif ( fragment ) {\n\t\t// render automatically ( if `el` is specified )\n\t\tvar el = getElement( ractive.el );\n\t\tif ( el ) {\n\t\t\tvar promise = ractive.render( el, ractive.append );\n\n\t\t\tif ( Ractive.DEBUG_PROMISES ) {\n\t\t\t\tpromise['catch']( function ( err ) {\n\t\t\t\t\twarnOnceIfDebug( 'Promise debugging is enabled, to help solve errors that happen asynchronously. Some browsers will log unhandled promise rejections, in which case you can safely disable promise debugging:\\n  Ractive.DEBUG_PROMISES = false;' );\n\t\t\t\t\twarnIfDebug( 'An error happened during rendering', { ractive: ractive });\n\t\t\t\t\tlogIfDebug( err );\n\n\t\t\t\t\tthrow err;\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n}\n\nvar DOMEvent = function DOMEvent ( name, owner ) {\n\tif ( name.indexOf( '*' ) !== -1 ) {\n\t\tfatal( (\"Only component proxy-events may contain \\\"*\\\" wildcards, <\" + (owner.name) + \" on-\" + name + \"=\\\"...\\\"/> is not valid\") );\n\t}\n\n\tthis.name = name;\n\tthis.owner = owner;\n\tthis.node = null;\n\tthis.handler = null;\n};\n\nDOMEvent.prototype.listen = function listen ( directive ) {\n\tvar node = this.node = this.owner.node;\n\tvar name = this.name;\n\n\tif ( !( (\"on\" + name) in node ) ) {\n\t\twarnOnce( missingPlugin( name, 'events' ) );\n\t\t}\n\n\t\tnode.addEventListener( name, this.handler = function( event ) {\n\t\tdirective.fire({\n\t\t\t\tnode: node,\n\t\t\toriginal: event\n\t\t\t});\n\t\t}, false );\n};\n\nDOMEvent.prototype.unlisten = function unlisten () {\n\tthis.node.removeEventListener( this.name, this.handler, false );\n};\n\nvar CustomEvent = function CustomEvent ( eventPlugin, owner ) {\n\tthis.eventPlugin = eventPlugin;\n\tthis.owner = owner;\n\tthis.handler = null;\n};\n\nCustomEvent.prototype.listen = function listen ( directive ) {\n\tvar node = this.owner.node;\n\n\tthis.handler = this.eventPlugin( node, function ( event ) {\n\t\tif ( event === void 0 ) event = {};\n\n\t\t\tevent.node = event.node || node;\n\t\tdirective.fire( event );\n\t});\n};\n\nCustomEvent.prototype.unlisten = function unlisten () {\n\tthis.handler.teardown();\n};\n\nvar RactiveEvent = function RactiveEvent ( ractive, name ) {\n\tthis.ractive = ractive;\n\tthis.name = name;\n\tthis.handler = null;\n};\n\nRactiveEvent.prototype.listen = function listen ( directive ) {\n\tvar ractive = this.ractive;\n\n\tthis.handler = ractive.on( this.name, function () {\n\t\tvar event;\n\n\t\t// semi-weak test, but what else? tag the event obj ._isEvent ?\n\t\tif ( arguments.length && arguments[0] && arguments[0].node ) {\n\t\t\tevent = Array.prototype.shift.call( arguments );\n\t\t\tevent.component = ractive;\n\t\t}\n\n\t\tvar args = Array.prototype.slice.call( arguments );\n\t\tdirective.fire( event, args );\n\n\t\t// cancel bubbling\n\t\treturn false;\n\t});\n};\n\nRactiveEvent.prototype.unlisten = function unlisten () {\n\tthis.handler.cancel();\n};\n\nvar specialPattern = /^(event|arguments)(\\..+)?$/;\nvar dollarArgsPattern = /^\\$(\\d+)(\\..+)?$/;\n\nvar EventDirective = function EventDirective ( options ) {\n\tvar this$1 = this;\n\n\t\tthis.owner = options.owner || options.parentFragment.owner || findElement( options.parentFragment );\n\tthis.element = this.owner.attributeByName ? this.owner : findElement( options.parentFragment );\n\tthis.template = options.template;\n\tthis.parentFragment = options.parentFragment;\n\tthis.ractive = options.parentFragment.ractive;\n\n\tthis.events = [];\n\n\tif ( this.element.type === COMPONENT ) {\n\t\tthis.template.n.split( '-' ).forEach( function ( n ) {\n\t\t\tthis$1.events.push( new RactiveEvent( this$1.element.instance, n ) );\n\t\t});\n\t} else {\n\t\tthis.template.n.split( '-' ).forEach( function ( n ) {\n\t\t\tvar fn = findInViewHierarchy( 'events', this$1.ractive, n );\n\t\t\t// we need to pass in \"this\" in order to get\n\t\t\t// access to node when it is created.\n\t\t\tthis$1.events.push(fn ? new CustomEvent( fn, this$1.element ) : new DOMEvent( n, this$1.element ));\n\t\t});\n\t}\n\n\tthis.context = null;\n\n\t// method calls\n\tthis.resolvers = null;\n\tthis.models = null;\n\n\t// handler directive\n\tthis.action = null;\n\tthis.args = null;\n};\n\nEventDirective.prototype.bind = function bind () {\n\tvar this$1 = this;\n\n\t\tthis.context = this.parentFragment.findContext();\n\n\tvar template = this.template.f;\n\n\tif ( template.x ) {\n\t\tthis.fn = getFunction( template.x.s, template.x.r.length );\n\t\tthis.resolvers = [];\n\t\tthis.models = template.x.r.map( function ( ref, i ) {\n\t\t\tvar specialMatch = specialPattern.exec( ref );\n\t\t\tif ( specialMatch ) {\n\t\t\t\t// on-click=\"foo(event.node)\"\n\t\t\t\treturn {\n\t\t\t\t\tspecial: specialMatch[1],\n\t\t\t\t\tkeys: specialMatch[2] ? splitKeypath( specialMatch[2].substr(1) ) : []\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tvar dollarMatch = dollarArgsPattern.exec( ref );\n\t\t\tif ( dollarMatch ) {\n\t\t\t\t// on-click=\"foo($1)\"\n\t\t\t\treturn {\n\t\t\t\t\tspecial: 'arguments',\n\t\t\t\t\tkeys: [ dollarMatch[1] - 1 ].concat( dollarMatch[2] ? splitKeypath( dollarMatch[2].substr( 1 ) ) : [] )\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tvar resolver;\n\n\t\t\tvar model = resolveReference( this$1.parentFragment, ref );\n\t\t\tif ( !model ) {\n\t\t\t\tresolver = this$1.parentFragment.resolve( ref, function ( model ) {\n\t\t\t\t\tthis$1.models[i] = model;\n\t\t\t\t\tremoveFromArray( this$1.resolvers, resolver );\n\t\t\t\t\tmodel.register( this$1 );\n\t\t\t\t});\n\n\t\t\t\tthis$1.resolvers.push( resolver );\n\t\t\t} else model.register( this$1 );\n\n\t\t\treturn model;\n\t\t});\n\t}\n\n\telse {\n\t\t// TODO deprecate this style of directive\n\t\tthis.action = typeof template === 'string' ? // on-click='foo'\n\t\t\ttemplate :\n\t\t\ttypeof template.n === 'string' ? // on-click='{{dynamic}}'\n\t\t\t\ttemplate.n :\n\t\t\t\tnew Fragment({\n\t\t\t\t\towner: this,\n\t\t\t\t\ttemplate: template.n\n\t\t\t\t});\n\n\t\tthis.args = template.a ? // static arguments\n\t\t\t( typeof template.a === 'string' ? [ template.a ] : template.a ) :\n\t\t\ttemplate.d ? // dynamic arguments\n\t\t\t\tnew Fragment({\n\t\t\t\t\towner: this,\n\t\t\t\t\ttemplate: template.d\n\t\t\t\t}) :\n\t\t\t\t[]; // no arguments\n\t}\n\n\tif ( this.action && typeof this.action !== 'string' ) this.action.bind();\n\tif ( this.args && template.d ) this.args.bind();\n};\n\nEventDirective.prototype.bubble = function bubble () {\n\tif ( !this.dirty ) {\n\t\tthis.dirty = true;\n\t\tthis.owner.bubble();\n\t}\n};\n\nEventDirective.prototype.destroyed = function destroyed () {\n\tthis.events.forEach( function ( e ) { return e.unlisten(); } );\n};\n\nEventDirective.prototype.fire = function fire ( event, passedArgs ) {\n\n\t// augment event object\n\tif ( passedArgs === void 0 ) passedArgs = [];\n\n\t\tif ( event && !event.hasOwnProperty( '_element' ) ) {\n\t\t   addHelpers( event, this.owner );\n\t}\n\n\tif ( this.fn ) {\n\t\tvar values = [];\n\n\t\tif ( event ) passedArgs.unshift( event );\n\n\t\tif ( this.models ) {\n\t\t\tthis.models.forEach( function ( model ) {\n\t\t\t\tif ( !model ) return values.push( undefined );\n\n\t\t\t\tif ( model.special ) {\n\t\t\t\t\tvar obj = model.special === 'event' ? event : passedArgs;\n\t\t\t\t\tvar keys = model.keys.slice();\n\n\t\t\t\t\twhile ( keys.length ) obj = obj[ keys.shift() ];\n\t\t\t\t\treturn values.push( obj );\n\t\t\t\t}\n\n\t\t\t\tif ( model.wrapper ) {\n\t\t\t\t\treturn values.push( model.wrapper.value );\n\t\t\t\t}\n\n\t\t\t\tvalues.push( model.get() );\n\t\t\t});\n\t\t}\n\n\t\t// make event available as `this.event`\n\t\tvar ractive = this.ractive;\n\t\tvar oldEvent = ractive.event;\n\n\t\tractive.event = event;\n\t\tvar result = this.fn.apply( ractive, values ).pop();\n\n\t\t// Auto prevent and stop if return is explicitly false\n\t\tvar original;\n\t\tif ( result === false && ( original = event.original ) ) {\n\t\t\toriginal.preventDefault && original.preventDefault();\n\t\t\toriginal.stopPropagation && original.stopPropagation();\n\t\t}\n\n\t\tractive.event = oldEvent;\n\t}\n\n\telse {\n\t\tvar action = this.action.toString();\n\t\tvar args = this.template.f.d ? this.args.getArgsList() : this.args;\n\n\t\tif ( passedArgs.length ) args = args.concat( passedArgs );\n\n\t\tif ( event ) event.name = action;\n\n\t\tfireEvent( this.ractive, action, {\n\t\t\tevent: event,\n\t\t\targs: args\n\t\t});\n\t}\n};\n\nEventDirective.prototype.handleChange = function handleChange () {};\n\nEventDirective.prototype.rebinding = function rebinding ( next, previous ) {\n\tvar this$1 = this;\n\n\t\tif ( !this.models ) return;\n\tvar idx = this.models.indexOf( previous );\n\n\tif ( ~idx ) {\n\t\tthis.models.splice( idx, 1, next );\n\t\tprevious.unregister( this );\n\t\tif ( next ) next.addShuffleTask( function () { return next.register( this$1 ); } );\n\t}\n};\n\nEventDirective.prototype.render = function render () {\n\t// render events after everything else, so they fire after bindings\n\tvar this$1 = this;\n\n\t\trunloop.scheduleTask( function () { return this$1.events.forEach( function ( e ) { return e.listen( this$1 ); }, true ); } );\n};\n\nEventDirective.prototype.toString = function toString() { return ''; };\n\nEventDirective.prototype.unbind = function unbind$1 () {\n\tvar this$1 = this;\n\n\t\tvar template = this.template.f;\n\n\tif ( template.m ) {\n\t\tif ( this.resolvers ) this.resolvers.forEach( unbind$1$1 );\n\t\tthis.resolvers = [];\n\n\t\tif ( this.models ) this.models.forEach( function ( m ) {\n\t\t\tif ( m.unregister ) m.unregister( this$1 );\n\t\t});\n\t\tthis.models = null;\n\t}\n\n\telse {\n\t\t// TODO this is brittle and non-explicit, fix it\n\t\tif ( this.action && this.action.unbind ) this.action.unbind();\n\t\tif ( this.args && this.args.unbind ) this.args.unbind();\n\t}\n};\n\nEventDirective.prototype.unrender = function unrender () {\n\tthis.events.forEach( function ( e ) { return e.unlisten(); } );\n};\n\nEventDirective.prototype.update = function update () {\n\tif ( this.method || !this.dirty ) return; // nothing to do\n\n\tthis.dirty = false;\n\n\t// ugh legacy\n\tif ( this.action && this.action.update ) this.action.update();\n\tif ( this.args && this.args.update ) this.args.update();\n};\n\n// TODO it's unfortunate that this has to run every time a\n// component is rendered... is there a better way?\nfunction updateLiveQueries ( component ) {\n\t// Does this need to be added to any live queries?\n\tvar instance = component.ractive;\n\n\tdo {\n\t\tvar liveQueries = instance._liveComponentQueries;\n\n\t\tvar i = liveQueries.length;\n\t\twhile ( i-- ) {\n\t\t\tvar name = liveQueries[i];\n\t\t\tvar query = liveQueries[ (\"_\" + name) ];\n\n\t\t\tif ( query.test( component ) ) {\n\t\t\t\tquery.add( component.instance );\n\t\t\t\t// keep register of applicable selectors, for when we teardown\n\t\t\t\tcomponent.liveQueries.push( query );\n\t\t\t}\n\t\t}\n\t} while ( instance = instance.parent );\n}\n\nfunction removeFromLiveComponentQueries ( component ) {\n\tvar instance = component.ractive;\n\n\twhile ( instance ) {\n\t\tvar query = instance._liveComponentQueries[ (\"_\" + (component.name)) ];\n\t\tif ( query ) query.remove( component );\n\n\t\tinstance = instance.parent;\n\t}\n}\n\nfunction makeDirty$1 ( query ) {\n\tquery.makeDirty();\n}\n\nvar teardownHook = new Hook( 'teardown' );\n\nvar Component = (function (Item$$1) {\n\tfunction Component ( options, ComponentConstructor ) {\n\t\tvar this$1 = this;\n\n\t\tItem$$1.call( this, options );\n\t\tthis.type = COMPONENT; // override ELEMENT from super\n\n\t\tvar instance = create( ComponentConstructor.prototype );\n\n\t\tthis.instance = instance;\n\t\tthis.name = options.template.e;\n\t\tthis.parentFragment = options.parentFragment;\n\n\t\tthis.liveQueries = [];\n\n\t\tif ( instance.el ) {\n\t\t\twarnIfDebug( (\"The <\" + (this.name) + \"> component has a default 'el' property; it has been disregarded\") );\n\t\t}\n\n\t\tvar partials = options.template.p || {};\n\t\tif ( !( 'content' in partials ) ) partials.content = options.template.f || [];\n\t\tthis._partials = partials; // TEMP\n\n\t\tthis.yielders = {};\n\n\t\t// find container\n\t\tvar fragment = options.parentFragment;\n\t\tvar container;\n\t\twhile ( fragment ) {\n\t\t\tif ( fragment.owner.type === YIELDER ) {\n\t\t\t\tcontainer = fragment.owner.container;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tfragment = fragment.parent;\n\t\t}\n\n\t\t// add component-instance-specific properties\n\t\tinstance.parent = this.parentFragment.ractive;\n\t\tinstance.container = container || null;\n\t\tinstance.root = instance.parent.root;\n\t\tinstance.component = this;\n\n\t\tconstruct( this.instance, { partials: partials });\n\n\t\t// for hackability, this could be an open option\n\t\t// for any ractive instance, but for now, just\n\t\t// for components and just for ractive...\n\t\tinstance._inlinePartials = partials;\n\n\t\tthis.attributeByName = {};\n\n\t\tthis.attributes = [];\n\t\tvar leftovers = [];\n\t\t( this.template.m || [] ).forEach( function ( template ) {\n\t\t\tswitch ( template.t ) {\n\t\t\t\tcase ATTRIBUTE:\n\t\t\t\tcase EVENT:\n\t\t\t\tcase TRANSITION:\n\t\t\t\t\tthis$1.attributes.push( createItem({\n\t\t\t\t\t\towner: this$1,\n\t\t\t\t\t\tparentFragment: this$1.parentFragment,\n\t\t\t\t\t\ttemplate: template\n\t\t\t\t\t}) );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase BINDING_FLAG:\n\t\t\t\tcase DECORATOR:\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tleftovers.push( template );\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\n\t\tthis.attributes.push( new ConditionalAttribute({\n\t\t\towner: this,\n\t\t\tparentFragment: this.parentFragment,\n\t\t\ttemplate: leftovers\n\t\t}) );\n\n\t\tthis.eventHandlers = [];\n\t\tif ( this.template.v ) this.setupEvents();\n\t}\n\n\tComponent.prototype = Object.create( Item$$1 && Item$$1.prototype );\n\tComponent.prototype.constructor = Component;\n\n\tComponent.prototype.bind = function bind$1 () {\n\t\tthis.attributes.forEach( bind$2 );\n\n\t\tinitialise( this.instance, {\n\t\t\tpartials: this._partials\n\t\t}, {\n\t\t\tcssIds: this.parentFragment.cssIds\n\t\t});\n\n\t\tthis.eventHandlers.forEach( bind$2 );\n\n\t\tthis.bound = true;\n\t};\n\n\tComponent.prototype.bubble = function bubble () {\n\t\tif ( !this.dirty ) {\n\t\t\tthis.dirty = true;\n\t\t\tthis.parentFragment.bubble();\n\t\t}\n\t};\n\n\tComponent.prototype.checkYielders = function checkYielders () {\n\t\tvar this$1 = this;\n\n\t\tObject.keys( this.yielders ).forEach( function ( name ) {\n\t\t\tif ( this$1.yielders[ name ].length > 1 ) {\n\t\t\t\trunloop.end();\n\t\t\t\tthrow new Error( (\"A component template can only have one {{yield\" + (name ? ' ' + name : '') + \"}} declaration at a time\") );\n\t\t\t}\n\t\t});\n\t};\n\n\tComponent.prototype.destroyed = function destroyed () {\n\t\tif ( this.instance.fragment ) this.instance.fragment.destroyed();\n\t};\n\n\tComponent.prototype.detach = function detach () {\n\t\treturn this.instance.fragment.detach();\n\t};\n\n\tComponent.prototype.find = function find ( selector ) {\n\t\treturn this.instance.fragment.find( selector );\n\t};\n\n\tComponent.prototype.findAll = function findAll ( selector, query ) {\n\t\tthis.instance.fragment.findAll( selector, query );\n\t};\n\n\tComponent.prototype.findComponent = function findComponent ( name ) {\n\t\tif ( !name || this.name === name ) return this.instance;\n\n\t\tif ( this.instance.fragment ) {\n\t\t\treturn this.instance.fragment.findComponent( name );\n\t\t}\n\t};\n\n\tComponent.prototype.findAllComponents = function findAllComponents ( name, query ) {\n\t\tif ( query.test( this ) ) {\n\t\t\tquery.add( this.instance );\n\n\t\t\tif ( query.live ) {\n\t\t\t\tthis.liveQueries.push( query );\n\t\t\t}\n\t\t}\n\n\t\tthis.instance.fragment.findAllComponents( name, query );\n\t};\n\n\tComponent.prototype.firstNode = function firstNode ( skipParent ) {\n\t\treturn this.instance.fragment.firstNode( skipParent );\n\t};\n\n\tComponent.prototype.render = function render$1 ( target, occupants ) {\n\t\trender$2( this.instance, target, null, occupants );\n\n\t\tthis.checkYielders();\n\t\tthis.attributes.forEach( render$1$1 );\n\t\tthis.eventHandlers.forEach( render$1$1 );\n\t\tupdateLiveQueries( this );\n\n\t\tthis.rendered = true;\n\t};\n\n\tComponent.prototype.setupEvents = function setupEvents () {\n\t\tvar this$1 = this;\n\n\t\tvar handlers = this.eventHandlers;\n\n\t\tObject.keys( this.template.v ).forEach( function ( key ) {\n\t\t\tvar eventNames = key.split( '-' );\n\t\t\tvar template = this$1.template.v[ key ];\n\n\t\t\teventNames.forEach( function ( eventName ) {\n\t\t\t\tvar event = new RactiveEvent( this$1.instance, eventName );\n\t\t\t\thandlers.push( new EventDirective( this$1, event, template ) );\n\t\t\t});\n\t\t});\n\t};\n\n\tComponent.prototype.shuffled = function shuffled () {\n\t\tthis.liveQueries.forEach( makeDirty$1 );\n\t\tItem$$1.prototype.shuffled.call(this);\n\t};\n\n\tComponent.prototype.toString = function toString () {\n\t\treturn this.instance.toHTML();\n\t};\n\n\tComponent.prototype.unbind = function unbind$1 () {\n\t\tthis.bound = false;\n\n\t\tthis.attributes.forEach( unbind$1$1 );\n\n\t\tvar instance = this.instance;\n\t\tinstance.viewmodel.teardown();\n\t\tinstance.fragment.unbind();\n\t\tinstance._observers.forEach( cancel$1 );\n\n\t\tremoveFromLiveComponentQueries( this );\n\n\t\tif ( instance.fragment.rendered && instance.el.__ractive_instances__ ) {\n\t\t\tremoveFromArray( instance.el.__ractive_instances__, instance );\n\t\t}\n\n\t\tteardownHook.fire( instance );\n\t};\n\n\tComponent.prototype.unrender = function unrender$1 ( shouldDestroy ) {\n\t\tvar this$1 = this;\n\n\t\tthis.rendered = false;\n\n\t\tthis.shouldDestroy = shouldDestroy;\n\t\tthis.instance.unrender();\n\t\tthis.attributes.forEach( unrender$1$1 );\n\t\tthis.eventHandlers.forEach( unrender$1$1 );\n\t\tthis.liveQueries.forEach( function ( query ) { return query.remove( this$1.instance ); } );\n\t};\n\n\tComponent.prototype.update = function update$1 () {\n\t\tthis.dirty = false;\n\t\tthis.instance.fragment.update();\n\t\tthis.checkYielders();\n\t\tthis.attributes.forEach( update$1$1 );\n\t\tthis.eventHandlers.forEach( update$1$1 );\n\t};\n\n\treturn Component;\n}(Item));\n\nvar missingDecorator = {\n\tupdate: noop,\n\tteardown: noop\n};\n\nvar Decorator = function Decorator ( options ) {\n\tthis.owner = options.owner || options.parentFragment.owner || findElement( options.parentFragment );\n\tthis.element = this.owner.attributeByName ? this.owner : findElement( options.parentFragment );\n\tthis.parentFragment = this.owner.parentFragment;\n\tthis.ractive = this.owner.ractive;\n\tvar template = this.template = options.template;\n\n\tthis.dynamicName = typeof template.f.n === 'object';\n\tthis.dynamicArgs = !!template.f.d;\n\n\tif ( this.dynamicName ) {\n\t\tthis.nameFragment = new Fragment({\n\t\t\towner: this,\n\t\t\ttemplate: template.f.n\n\t\t});\n\t} else {\n\t\tthis.name = template.f.n || template.f;\n\t}\n\n\tif ( this.dynamicArgs ) {\n\t\tthis.argsFragment = new Fragment({\n\t\t\towner: this,\n\t\t\ttemplate: template.f.d\n\t\t});\n\t} else {\n\t\tif ( template.f.a && template.f.a.s ) {\n\t\t\tthis.args = [];\n\t\t} else {\n\t\t\tthis.args = template.f.a || [];\n\t\t}\n\t}\n\n\tthis.node = null;\n\tthis.intermediary = null;\n\n\tthis.element.decorators.push( this );\n};\n\nDecorator.prototype.bind = function bind () {\n\tvar this$1 = this;\n\n\t\tif ( this.dynamicName ) {\n\t\tthis.nameFragment.bind();\n\t\tthis.name = this.nameFragment.toString();\n\t}\n\n\tif ( this.dynamicArgs ) this.argsFragment.bind();\n\n\t// TODO: dry this up once deprecation is done\n\tif ( this.template.f.a && this.template.f.a.s ) {\n\t\tthis.resolvers = [];\n\t\tthis.models = this.template.f.a.r.map( function ( ref, i ) {\n\t\t\tvar resolver;\n\t\t\tvar model = resolveReference( this$1.parentFragment, ref );\n\t\t\tif ( !model ) {\n\t\t\t\tresolver = this$1.parentFragment.resolve( ref, function ( model ) {\n\t\t\t\t\tthis$1.models[i] = model;\n\t\t\t\t\tremoveFromArray( this$1.resolvers, resolver );\n\t\t\t\t\tmodel.register( this$1 );\n\t\t\t\t});\n\n\t\t\t\tthis$1.resolvers.push( resolver );\n\t\t\t} else model.register( this$1 );\n\n\t\t\treturn model;\n\t\t});\n\t\tthis.argsFn = getFunction( this.template.f.a.s, this.template.f.a.r.length );\n\t}\n};\n\nDecorator.prototype.bubble = function bubble () {\n\tif ( !this.dirty ) {\n\t\tthis.dirty = true;\n\t\tthis.owner.bubble();\n\t}\n};\n\nDecorator.prototype.destroyed = function destroyed () {\n\tif ( this.intermediary ) this.intermediary.teardown();\n};\n\nDecorator.prototype.handleChange = function handleChange () { this.bubble(); };\n\nDecorator.prototype.rebinding = function rebinding ( next, previous, safe ) {\n\tvar idx = this.models.indexOf( previous );\n\tif ( !~idx ) return;\n\n\tnext = rebindMatch( this.template.f.a.r[ idx ], next, previous );\n\tif ( next === previous ) return;\n\n\tprevious.unregister( this );\n\tthis.models.splice( idx, 1, next );\n\tif ( next ) next.addShuffleRegister( this, 'mark' );\n\n\tif ( !safe ) this.bubble();\n};\n\nDecorator.prototype.render = function render () {\n\tvar this$1 = this;\n\n\t\trunloop.scheduleTask( function () {\n\t\tvar fn = findInViewHierarchy( 'decorators', this$1.ractive, this$1.name );\n\n\t\tif ( !fn ) {\n\t\t\twarnOnce( missingPlugin( this$1.name, 'decorator' ) );\n\t\t\tthis$1.intermediary = missingDecorator;\n\t\t\treturn;\n\t\t}\n\n\t\tthis$1.node = this$1.element.node;\n\n\t\tvar args;\n\t\tif ( this$1.argsFn ) {\n\t\t\targs = this$1.models.map( function ( model ) {\n\t\t\t\tif ( !model ) return undefined;\n\n\t\t\t\treturn model.get();\n\t\t\t});\n\t\t\targs = this$1.argsFn.apply( this$1.ractive, args );\n\t\t} else {\n\t\t\targs = this$1.dynamicArgs ? this$1.argsFragment.getArgsList() : this$1.args;\n\t\t}\n\n\t\tthis$1.intermediary = fn.apply( this$1.ractive, [ this$1.node ].concat( args ) );\n\n\t\tif ( !this$1.intermediary || !this$1.intermediary.teardown ) {\n\t\t\tthrow new Error( (\"The '\" + (this$1.name) + \"' decorator must return an object with a teardown method\") );\n\t\t}\n\t}, true );\n\tthis.rendered = true;\n};\n\nDecorator.prototype.toString = function toString () { return ''; };\n\nDecorator.prototype.unbind = function unbind$1 () {\n\tvar this$1 = this;\n\n\t\tif ( this.dynamicName ) this.nameFragment.unbind();\n\tif ( this.dynamicArgs ) this.argsFragment.unbind();\n\tif ( this.resolvers ) this.resolvers.forEach( unbind$1$1 );\n\tif ( this.models ) this.models.forEach( function ( m ) {\n\t\tif ( m ) m.unregister( this$1 );\n\t});\n};\n\nDecorator.prototype.unrender = function unrender ( shouldDestroy ) {\n\tif ( ( !shouldDestroy || this.element.rendered ) && this.intermediary ) this.intermediary.teardown();\n\tthis.rendered = false;\n};\n\nDecorator.prototype.update = function update () {\n\tif ( !this.dirty ) return;\n\n\tthis.dirty = false;\n\n\tvar nameChanged = false;\n\n\tif ( this.dynamicName && this.nameFragment.dirty ) {\n\t\tvar name = this.nameFragment.toString();\n\t\tnameChanged = name !== this.name;\n\t\tthis.name = name;\n\t}\n\n\tif ( this.intermediary ) {\n\t\tif ( nameChanged || !this.intermediary.update ) {\n\t\t\tthis.unrender();\n\t\t\tthis.render();\n\t\t}\n\t\telse {\n\t\t\tif ( this.dynamicArgs ) {\n\t\t\t\tif ( this.argsFragment.dirty ) {\n\t\t\t\t\tvar args = this.argsFragment.getArgsList();\n\t\t\t\t\tthis.intermediary.update.apply( this.ractive, args );\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if ( this.argsFn ) {\n\t\t\t\tvar args$1 = this.models.map( function ( model ) {\n\t\t\t\t\tif ( !model ) return undefined;\n\n\t\t\t\t\treturn model.get();\n\t\t\t\t});\n\t\t\t\tthis.intermediary.update.apply( this.ractive, this.argsFn.apply( this.ractive, args$1 ) );\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.intermediary.update.apply( this.ractive, this.args );\n\t\t\t}\n\t\t}\n\t}\n\n\t// need to run these for unrender/render cases\n\t// so can't just be in conditional if above\n\n\tif ( this.dynamicName && this.nameFragment.dirty ) {\n\t\tthis.nameFragment.update();\n\t}\n\n\tif ( this.dynamicArgs && this.argsFragment.dirty ) {\n\t\tthis.argsFragment.update();\n\t}\n};\n\nvar Doctype = (function (Item$$1) {\n\tfunction Doctype () {\n\t\tItem$$1.apply(this, arguments);\n\t}\n\n\tDoctype.prototype = Object.create( Item$$1 && Item$$1.prototype );\n\tDoctype.prototype.constructor = Doctype;\n\n\tDoctype.prototype.bind = function bind () {\n\t\t// noop\n\t};\n\n\tDoctype.prototype.render = function render () {\n\t\t// noop\n\t};\n\n\tDoctype.prototype.teardown = function teardown () {\n\t\t// noop\n\t};\n\n\tDoctype.prototype.toString = function toString () {\n\t\treturn '<!DOCTYPE' + this.template.a + '>';\n\t};\n\n\tDoctype.prototype.unbind = function unbind () {\n\t\t// noop\n\t};\n\n\tDoctype.prototype.unrender = function unrender () {\n\t\t// noop\n\t};\n\n\treturn Doctype;\n}(Item));\n\nfunction updateLiveQueries$1 ( element ) {\n\t// Does this need to be added to any live queries?\n\tvar node = element.node;\n\tvar instance = element.ractive;\n\n\tdo {\n\t\tvar liveQueries = instance._liveQueries;\n\n\t\tvar i = liveQueries.length;\n\t\twhile ( i-- ) {\n\t\t\tvar selector = liveQueries[i];\n\t\t\tvar query = liveQueries[ (\"_\" + selector) ];\n\n\t\t\tif ( query.test( node ) ) {\n\t\t\t\tquery.add( node );\n\t\t\t\t// keep register of applicable selectors, for when we teardown\n\t\t\t\telement.liveQueries.push( query );\n\t\t\t}\n\t\t}\n\t} while ( instance = instance.parent );\n}\n\n// TODO element.parent currently undefined\nfunction findParentForm ( element ) {\n\twhile ( element = element.parent ) {\n\t\tif ( element.name === 'form' ) {\n\t\t\treturn element;\n\t\t}\n\t}\n}\n\nfunction warnAboutAmbiguity ( description, ractive ) {\n\twarnOnceIfDebug( (\"The \" + description + \" being used for two-way binding is ambiguous, and may cause unexpected results. Consider initialising your data to eliminate the ambiguity\"), { ractive: ractive });\n}\n\nvar Binding = function Binding ( element, name ) {\n\tif ( name === void 0 ) name = 'value';\n\n\t\tthis.element = element;\n\tthis.ractive = element.ractive;\n\tthis.attribute = element.attributeByName[ name ];\n\n\tvar interpolator = this.attribute.interpolator;\n\tinterpolator.twowayBinding = this;\n\n\tvar model = interpolator.model;\n\n\t// not bound?\n\tif ( !model ) {\n\t\t// try to force resolution\n\t\tinterpolator.resolver.forceResolution();\n\t\tmodel = interpolator.model;\n\n\t\twarnAboutAmbiguity( (\"'\" + (interpolator.template.r) + \"' reference\"), this.ractive );\n\t}\n\n\telse if ( model.isUnresolved ) {\n\t\t// reference expressions (e.g. foo[bar])\n\t\tmodel.forceResolution();\n\t\twarnAboutAmbiguity( 'expression', this.ractive );\n\t}\n\n\t// TODO include index/key/keypath refs as read-only\n\telse if ( model.isReadonly ) {\n\t\tvar keypath = model.getKeypath().replace( /^@/, '' );\n\t\t\twarnOnceIfDebug( (\"Cannot use two-way binding on <\" + (element.name) + \"> element: \" + keypath + \" is read-only. To suppress this warning use <\" + (element.name) + \" twoway='false'...>\"), { ractive: this.ractive });\n\t\treturn false;\n\t}\n\n\tthis.attribute.isTwoway = true;\n\tthis.model = model;\n\n\t// initialise value, if it's undefined\n\tvar value = model.get();\n\tthis.wasUndefined = value === undefined;\n\n\tif ( value === undefined && this.getInitialValue ) {\n\t\tvalue = this.getInitialValue();\n\t\tmodel.set( value );\n\t}\n\n\tvar parentForm = findParentForm( element );\n\tif ( parentForm ) {\n\t\tthis.resetValue = value;\n\t\tparentForm.formBindings.push( this );\n\t}\n};\n\nBinding.prototype.bind = function bind () {\n\tthis.model.registerTwowayBinding( this );\n};\n\nBinding.prototype.handleChange = function handleChange () {\n\tvar this$1 = this;\n\n\t\tvar value = this.getValue();\n\tif ( this.lastVal() === value ) return;\n\n\trunloop.start( this.root );\n\tthis.attribute.locked = true;\n\tthis.model.set( value );\n\tthis.lastVal( true, value );\n\n\t// if the value changes before observers fire, unlock to be updatable cause something weird and potentially freezy is up\n\tif ( this.model.get() !== value ) this.attribute.locked = false;\n\telse runloop.scheduleTask( function () { return this$1.attribute.locked = false; } );\n\n\trunloop.end();\n};\n\nBinding.prototype.lastVal = function lastVal ( setting, value ) {\n\tif ( setting ) this.lastValue = value;\n\telse return this.lastValue;\n};\n\nBinding.prototype.rebinding = function rebinding ( next, previous ) {\n\tvar this$1 = this;\n\n\t\tif ( this.model && this.model === previous ) previous.unregisterTwowayBinding( this );\n\tif ( next ) {\n\t\tthis.model = next;\n\t\trunloop.scheduleTask( function () { return next.registerTwowayBinding( this$1 ); } );\n\t}\n   };\n\nBinding.prototype.render = function render () {\n\tthis.node = this.element.node;\n\tthis.node._ractive.binding = this;\n\tthis.rendered = true; // TODO is this used anywhere?\n};\n\nBinding.prototype.setFromNode = function setFromNode ( node ) {\n\tthis.model.set( node.value );\n};\n\nBinding.prototype.unbind = function unbind () {\n\tthis.model.unregisterTwowayBinding( this );\n};\n\nBinding.prototype.unrender = function unrender () {\n\t// noop?\n};\n\n// This is the handler for DOM events that would lead to a change in the model\n// (i.e. change, sometimes, input, and occasionally click and keyup)\nfunction handleDomEvent () {\n\tthis._ractive.binding.handleChange();\n}\n\nvar CheckboxBinding = (function (Binding$$1) {\n\tfunction CheckboxBinding ( element ) {\n\t\tBinding$$1.call( this, element, 'checked' );\n\t}\n\n\tCheckboxBinding.prototype = Object.create( Binding$$1 && Binding$$1.prototype );\n\tCheckboxBinding.prototype.constructor = CheckboxBinding;\n\n\tCheckboxBinding.prototype.render = function render () {\n\t\tBinding$$1.prototype.render.call(this);\n\n\t\tthis.node.addEventListener( 'change', handleDomEvent, false );\n\n\t\tif ( this.node.attachEvent ) {\n\t\t\tthis.node.addEventListener( 'click', handleDomEvent, false );\n\t\t}\n\t};\n\n\tCheckboxBinding.prototype.unrender = function unrender () {\n\t\tthis.node.removeEventListener( 'change', handleDomEvent, false );\n\t\tthis.node.removeEventListener( 'click', handleDomEvent, false );\n\t};\n\n\tCheckboxBinding.prototype.getInitialValue = function getInitialValue () {\n\t\treturn !!this.element.getAttribute( 'checked' );\n\t};\n\n\tCheckboxBinding.prototype.getValue = function getValue () {\n\t\treturn this.node.checked;\n\t};\n\n\tCheckboxBinding.prototype.setFromNode = function setFromNode ( node ) {\n\t\tthis.model.set( node.checked );\n\t};\n\n\treturn CheckboxBinding;\n}(Binding));\n\nfunction getBindingGroup ( group, model, getValue ) {\n\tvar hash = \"\" + group + \"-bindingGroup\";\n\treturn model[hash] || ( model[ hash ] = new BindingGroup( hash, model, getValue ) );\n}\n\nvar BindingGroup = function BindingGroup ( hash, model, getValue ) {\n\tvar this$1 = this;\n\n\t\tthis.model = model;\n\tthis.hash = hash;\n\tthis.getValue = function () {\n\t\tthis$1.value = getValue.call(this$1);\n\t\treturn this$1.value;\n\t};\n\n\tthis.bindings = [];\n};\n\nBindingGroup.prototype.add = function add ( binding ) {\n\tthis.bindings.push( binding );\n};\n\nBindingGroup.prototype.bind = function bind () {\n\tthis.value = this.model.get();\n\tthis.model.registerTwowayBinding( this );\n\tthis.bound = true;\n};\n\nBindingGroup.prototype.remove = function remove ( binding ) {\n\tremoveFromArray( this.bindings, binding );\n\tif ( !this.bindings.length ) {\n\t\tthis.unbind();\n\t}\n};\n\nBindingGroup.prototype.unbind = function unbind () {\n\tthis.model.unregisterTwowayBinding( this );\n\tthis.bound = false;\n\tdelete this.model[this.hash];\n};\n\nvar push$2 = [].push;\n\nfunction getValue$1$1() {\n\tvar all = this.bindings.filter(function ( b ) { return b.node && b.node.checked; }).map(function ( b ) { return b.element.getAttribute( 'value' ); });\n\tvar res = [];\n\tall.forEach(function ( v ) { if ( !arrayContains( res, v ) ) res.push( v ); });\n\treturn res;\n}\n\nvar CheckboxNameBinding = (function (Binding$$1) {\n\tfunction CheckboxNameBinding ( element ) {\n\t\tBinding$$1.call( this, element, 'name' );\n\n\t\tthis.checkboxName = true; // so that ractive.updateModel() knows what to do with this\n\n\t\t// Each input has a reference to an array containing it and its\n\t\t// group, as two-way binding depends on being able to ascertain\n\t\t// the status of all inputs within the group\n\t\tthis.group = getBindingGroup( 'checkboxes', this.model, getValue$1$1 );\n\t\tthis.group.add( this );\n\n\t\tif ( this.noInitialValue ) {\n\t\t\tthis.group.noInitialValue = true;\n\t\t}\n\n\t\t// If no initial value was set, and this input is checked, we\n\t\t// update the model\n\t\tif ( this.group.noInitialValue && this.element.getAttribute( 'checked' ) ) {\n\t\t\tvar existingValue = this.model.get();\n\t\t\tvar bindingValue = this.element.getAttribute( 'value' );\n\n\t\t\tif ( !arrayContains( existingValue, bindingValue ) ) {\n\t\t\t\tpush$2.call( existingValue, bindingValue ); // to avoid triggering runloop with array adaptor\n\t\t\t}\n\t\t}\n\t}\n\n\tCheckboxNameBinding.prototype = Object.create( Binding$$1 && Binding$$1.prototype );\n\tCheckboxNameBinding.prototype.constructor = CheckboxNameBinding;\n\n\tCheckboxNameBinding.prototype.bind = function bind () {\n\t\tif ( !this.group.bound ) {\n\t\t\tthis.group.bind();\n\t\t}\n\t};\n\n\tCheckboxNameBinding.prototype.changed = function changed () {\n\t\tvar wasChecked = !!this.isChecked;\n\t\tthis.isChecked = this.node.checked;\n\t\treturn this.isChecked === wasChecked;\n\t};\n\n\tCheckboxNameBinding.prototype.getInitialValue = function getInitialValue () {\n\t\t// This only gets called once per group (of inputs that\n\t\t// share a name), because it only gets called if there\n\t\t// isn't an initial value. By the same token, we can make\n\t\t// a note of that fact that there was no initial value,\n\t\t// and populate it using any `checked` attributes that\n\t\t// exist (which users should avoid, but which we should\n\t\t// support anyway to avoid breaking expectations)\n\t\tthis.noInitialValue = true; // TODO are noInitialValue and wasUndefined the same thing?\n\t\treturn [];\n\t};\n\n\tCheckboxNameBinding.prototype.getValue = function getValue$1 () {\n\t\treturn this.group.value;\n\t};\n\n\tCheckboxNameBinding.prototype.handleChange = function handleChange () {\n\t\tthis.isChecked = this.element.node.checked;\n\t\tthis.group.value = this.model.get();\n\t\tvar value = this.element.getAttribute( 'value' );\n\t\tif ( this.isChecked && !arrayContains( this.group.value, value ) ) {\n\t\t\tthis.group.value.push( value );\n\t\t} else if ( !this.isChecked && arrayContains( this.group.value, value ) ) {\n\t\t\tremoveFromArray( this.group.value, value );\n\t\t}\n\t\t// make sure super knows there's a change\n\t\tthis.lastValue = null;\n\t\tBinding$$1.prototype.handleChange.call(this);\n\t};\n\n\tCheckboxNameBinding.prototype.render = function render () {\n\t\tBinding$$1.prototype.render.call(this);\n\n\t\tvar node = this.node;\n\n\t\tvar existingValue = this.model.get();\n\t\tvar bindingValue = this.element.getAttribute( 'value' );\n\n\t\tif ( isArray( existingValue ) ) {\n\t\t\tthis.isChecked = arrayContains( existingValue, bindingValue );\n\t\t} else {\n\t\t\tthis.isChecked = existingValue == bindingValue;\n\t\t}\n\n\t\tnode.name = '{{' + this.model.getKeypath() + '}}';\n\t\tnode.checked = this.isChecked;\n\n\t\tnode.addEventListener( 'change', handleDomEvent, false );\n\n\t\t// in case of IE emergency, bind to click event as well\n\t\tif ( node.attachEvent ) {\n\t\t\tnode.addEventListener( 'click', handleDomEvent, false );\n\t\t}\n\t};\n\n\tCheckboxNameBinding.prototype.setFromNode = function setFromNode ( node ) {\n\t\tthis.group.bindings.forEach( function ( binding ) { return binding.wasUndefined = true; } );\n\n\t\tif ( node.checked ) {\n\t\t\tvar valueSoFar = this.group.getValue();\n\t\t\tvalueSoFar.push( this.element.getAttribute( 'value' ) );\n\n\t\t\tthis.group.model.set( valueSoFar );\n\t\t}\n\t};\n\n\tCheckboxNameBinding.prototype.unbind = function unbind () {\n\t\tthis.group.remove( this );\n\t};\n\n\tCheckboxNameBinding.prototype.unrender = function unrender () {\n\t\tvar node = this.element.node;\n\n\t\tnode.removeEventListener( 'change', handleDomEvent, false );\n\t\tnode.removeEventListener( 'click', handleDomEvent, false );\n\t};\n\n\treturn CheckboxNameBinding;\n}(Binding));\n\nvar ContentEditableBinding = (function (Binding$$1) {\n\tfunction ContentEditableBinding () {\n\t\tBinding$$1.apply(this, arguments);\n\t}\n\n\tContentEditableBinding.prototype = Object.create( Binding$$1 && Binding$$1.prototype );\n\tContentEditableBinding.prototype.constructor = ContentEditableBinding;\n\n\tContentEditableBinding.prototype.getInitialValue = function getInitialValue () {\n\t\treturn this.element.fragment ? this.element.fragment.toString() : '';\n\t};\n\n\tContentEditableBinding.prototype.getValue = function getValue () {\n\t\treturn this.element.node.innerHTML;\n\t};\n\n\tContentEditableBinding.prototype.render = function render () {\n\t\tBinding$$1.prototype.render.call(this);\n\n\t\tvar node = this.node;\n\n\t\tnode.addEventListener( 'change', handleDomEvent, false );\n\t\tnode.addEventListener( 'blur', handleDomEvent, false );\n\n\t\tif ( !this.ractive.lazy ) {\n\t\t\tnode.addEventListener( 'input', handleDomEvent, false );\n\n\t\t\tif ( node.attachEvent ) {\n\t\t\t\tnode.addEventListener( 'keyup', handleDomEvent, false );\n\t\t\t}\n\t\t}\n\t};\n\n\tContentEditableBinding.prototype.setFromNode = function setFromNode ( node ) {\n\t\tthis.model.set( node.innerHTML );\n\t};\n\n\tContentEditableBinding.prototype.unrender = function unrender () {\n\t\tvar node = this.node;\n\n\t\tnode.removeEventListener( 'blur', handleDomEvent, false );\n\t\tnode.removeEventListener( 'change', handleDomEvent, false );\n\t\tnode.removeEventListener( 'input', handleDomEvent, false );\n\t\tnode.removeEventListener( 'keyup', handleDomEvent, false );\n\t};\n\n\treturn ContentEditableBinding;\n}(Binding));\n\nfunction handleBlur () {\n\thandleDomEvent.call( this );\n\n\tvar value = this._ractive.binding.model.get();\n\tthis.value = value == undefined ? '' : value;\n}\n\nfunction handleDelay ( delay ) {\n\tvar timeout;\n\n\treturn function () {\n\t\tvar this$1 = this;\n\n\t\tif ( timeout ) clearTimeout( timeout );\n\n\t\ttimeout = setTimeout( function () {\n\t\t\tvar binding = this$1._ractive.binding;\n\t\t\tif ( binding.rendered ) handleDomEvent.call( this$1 );\n\t\t\ttimeout = null;\n\t\t}, delay );\n\t};\n}\n\nvar GenericBinding = (function (Binding$$1) {\n\tfunction GenericBinding () {\n\t\tBinding$$1.apply(this, arguments);\n\t}\n\n\tGenericBinding.prototype = Object.create( Binding$$1 && Binding$$1.prototype );\n\tGenericBinding.prototype.constructor = GenericBinding;\n\n\tGenericBinding.prototype.getInitialValue = function getInitialValue () {\n\t\treturn '';\n\t};\n\n\tGenericBinding.prototype.getValue = function getValue () {\n\t\treturn this.node.value;\n\t};\n\n\tGenericBinding.prototype.render = function render () {\n\t\tBinding$$1.prototype.render.call(this);\n\n\t\t// any lazy setting for this element overrides the root\n\t\t// if the value is a number, it's a timeout\n\t\tvar lazy = this.ractive.lazy;\n\t\tvar timeout = false;\n\n\t\tif ( 'lazy' in this.element ) {\n\t\t\tlazy = this.element.lazy;\n\t\t}\n\n\t\tif ( isNumeric( lazy ) ) {\n\t\t\ttimeout = +lazy;\n\t\t\tlazy = false;\n\t\t}\n\n\t\tthis.handler = timeout ? handleDelay( timeout ) : handleDomEvent;\n\n\t\tvar node = this.node;\n\n\t\tnode.addEventListener( 'change', handleDomEvent, false );\n\n\t\tif ( !lazy ) {\n\t\t\tnode.addEventListener( 'input', this.handler, false );\n\n\t\t\tif ( node.attachEvent ) {\n\t\t\t\tnode.addEventListener( 'keyup', this.handler, false );\n\t\t\t}\n\t\t}\n\n\t\tnode.addEventListener( 'blur', handleBlur, false );\n\t};\n\n\tGenericBinding.prototype.unrender = function unrender () {\n\t\tvar node = this.element.node;\n\t\tthis.rendered = false;\n\n\t\tnode.removeEventListener( 'change', handleDomEvent, false );\n\t\tnode.removeEventListener( 'input', this.handler, false );\n\t\tnode.removeEventListener( 'keyup', this.handler, false );\n\t\tnode.removeEventListener( 'blur', handleBlur, false );\n\t};\n\n\treturn GenericBinding;\n}(Binding));\n\nfunction getSelectedOptions ( select ) {\n    return select.selectedOptions\n\t\t? toArray( select.selectedOptions )\n\t\t: select.options\n\t\t\t? toArray( select.options ).filter( function ( option ) { return option.selected; } )\n\t\t\t: [];\n}\n\nvar MultipleSelectBinding = (function (Binding$$1) {\n\tfunction MultipleSelectBinding () {\n\t\tBinding$$1.apply(this, arguments);\n\t}\n\n\tMultipleSelectBinding.prototype = Object.create( Binding$$1 && Binding$$1.prototype );\n\tMultipleSelectBinding.prototype.constructor = MultipleSelectBinding;\n\n\tMultipleSelectBinding.prototype.forceUpdate = function forceUpdate () {\n\t\tvar this$1 = this;\n\n\t\tvar value = this.getValue();\n\n\t\tif ( value !== undefined ) {\n\t\t\tthis.attribute.locked = true;\n\t\t\trunloop.scheduleTask( function () { return this$1.attribute.locked = false; } );\n\t\t\tthis.model.set( value );\n\t\t}\n\t};\n\n\tMultipleSelectBinding.prototype.getInitialValue = function getInitialValue () {\n\t\treturn this.element.options\n\t\t\t.filter( function ( option ) { return option.getAttribute( 'selected' ); } )\n\t\t\t.map( function ( option ) { return option.getAttribute( 'value' ); } );\n\t};\n\n\tMultipleSelectBinding.prototype.getValue = function getValue () {\n\t\tvar options = this.element.node.options;\n\t\tvar len = options.length;\n\n\t\tvar selectedValues = [];\n\n\t\tfor ( var i = 0; i < len; i += 1 ) {\n\t\t\tvar option = options[i];\n\n\t\t\tif ( option.selected ) {\n\t\t\t\tvar optionValue = option._ractive ? option._ractive.value : option.value;\n\t\t\t\tselectedValues.push( optionValue );\n\t\t\t}\n\t\t}\n\n\t\treturn selectedValues;\n\t};\n\n\tMultipleSelectBinding.prototype.handleChange = function handleChange () {\n\t\tvar attribute = this.attribute;\n\t\tvar previousValue = attribute.getValue();\n\n\t\tvar value = this.getValue();\n\n\t\tif ( previousValue === undefined || !arrayContentsMatch( value, previousValue ) ) {\n\t\t\tBinding$$1.prototype.handleChange.call(this);\n\t\t}\n\n\t\treturn this;\n\t};\n\n\tMultipleSelectBinding.prototype.render = function render () {\n\t\tBinding$$1.prototype.render.call(this);\n\n\t\tthis.node.addEventListener( 'change', handleDomEvent, false );\n\n\t\tif ( this.model.get() === undefined ) {\n\t\t\t// get value from DOM, if possible\n\t\t\tthis.handleChange();\n\t\t}\n\t};\n\n\tMultipleSelectBinding.prototype.setFromNode = function setFromNode ( node ) {\n\t\tvar selectedOptions = getSelectedOptions( node );\n\t\tvar i = selectedOptions.length;\n\t\tvar result = new Array( i );\n\n\t\twhile ( i-- ) {\n\t\t\tvar option = selectedOptions[i];\n\t\t\tresult[i] = option._ractive ? option._ractive.value : option.value;\n\t\t}\n\n\t\tthis.model.set( result );\n\t};\n\n\tMultipleSelectBinding.prototype.setValue = function setValue () {\n\t\tthrow new Error( 'TODO not implemented yet' );\n\t};\n\n\tMultipleSelectBinding.prototype.unrender = function unrender () {\n\t\tthis.node.removeEventListener( 'change', handleDomEvent, false );\n\t};\n\n\tMultipleSelectBinding.prototype.updateModel = function updateModel () {\n\t\tif ( this.attribute.value === undefined || !this.attribute.value.length ) {\n\t\t\tthis.keypath.set( this.initialValue );\n\t\t}\n\t};\n\n\treturn MultipleSelectBinding;\n}(Binding));\n\nvar NumericBinding = (function (GenericBinding$$1) {\n\tfunction NumericBinding () {\n\t\tGenericBinding$$1.apply(this, arguments);\n\t}\n\n\tNumericBinding.prototype = Object.create( GenericBinding$$1 && GenericBinding$$1.prototype );\n\tNumericBinding.prototype.constructor = NumericBinding;\n\n\tNumericBinding.prototype.getInitialValue = function getInitialValue () {\n\t\treturn undefined;\n\t};\n\n\tNumericBinding.prototype.getValue = function getValue () {\n\t\tvar value = parseFloat( this.node.value );\n\t\treturn isNaN( value ) ? undefined : value;\n\t};\n\n\tNumericBinding.prototype.setFromNode = function setFromNode( node ) {\n\t\tvar value = parseFloat( node.value );\n\t\tif ( !isNaN( value ) ) this.model.set( value );\n\t};\n\n\treturn NumericBinding;\n}(GenericBinding));\n\nvar siblings = {};\n\nfunction getSiblings ( hash ) {\n\treturn siblings[ hash ] || ( siblings[ hash ] = [] );\n}\n\nvar RadioBinding = (function (Binding$$1) {\n\tfunction RadioBinding ( element ) {\n\t\tBinding$$1.call( this, element, 'checked' );\n\n\t\tthis.siblings = getSiblings( this.ractive._guid + this.element.getAttribute( 'name' ) );\n\t\tthis.siblings.push( this );\n\t}\n\n\tRadioBinding.prototype = Object.create( Binding$$1 && Binding$$1.prototype );\n\tRadioBinding.prototype.constructor = RadioBinding;\n\n\tRadioBinding.prototype.getValue = function getValue () {\n\t\treturn this.node.checked;\n\t};\n\n\tRadioBinding.prototype.handleChange = function handleChange () {\n\t\trunloop.start( this.root );\n\n\t\tthis.siblings.forEach( function ( binding ) {\n\t\t\tbinding.model.set( binding.getValue() );\n\t\t});\n\n\t\trunloop.end();\n\t};\n\n\tRadioBinding.prototype.render = function render () {\n\t\tBinding$$1.prototype.render.call(this);\n\n\t\tthis.node.addEventListener( 'change', handleDomEvent, false );\n\n\t\tif ( this.node.attachEvent ) {\n\t\t\tthis.node.addEventListener( 'click', handleDomEvent, false );\n\t\t}\n\t};\n\n\tRadioBinding.prototype.setFromNode = function setFromNode ( node ) {\n\t\tthis.model.set( node.checked );\n\t};\n\n\tRadioBinding.prototype.unbind = function unbind () {\n\t\tremoveFromArray( this.siblings, this );\n\t};\n\n\tRadioBinding.prototype.unrender = function unrender () {\n\t\tthis.node.removeEventListener( 'change', handleDomEvent, false );\n\t\tthis.node.removeEventListener( 'click', handleDomEvent, false );\n\t};\n\n\treturn RadioBinding;\n}(Binding));\n\nfunction getValue$2() {\n\tvar checked = this.bindings.filter( function ( b ) { return b.node.checked; } );\n\tif ( checked.length > 0 ) {\n\t\treturn checked[0].element.getAttribute( 'value' );\n\t}\n}\n\nvar RadioNameBinding = (function (Binding$$1) {\n\tfunction RadioNameBinding ( element ) {\n\t\tBinding$$1.call( this, element, 'name' );\n\n\t\tthis.group = getBindingGroup( 'radioname', this.model, getValue$2 );\n\t\tthis.group.add( this );\n\n\t\tif ( element.checked ) {\n\t\t\tthis.group.value = this.getValue();\n\t\t}\n\t}\n\n\tRadioNameBinding.prototype = Object.create( Binding$$1 && Binding$$1.prototype );\n\tRadioNameBinding.prototype.constructor = RadioNameBinding;\n\n\tRadioNameBinding.prototype.bind = function bind () {\n\t\tvar this$1 = this;\n\n\t\tif ( !this.group.bound ) {\n\t\t\tthis.group.bind();\n\t\t}\n\n\t\t// update name keypath when necessary\n\t\tthis.nameAttributeBinding = {\n\t\t\thandleChange: function () { return this$1.node.name = \"{{\" + (this$1.model.getKeypath()) + \"}}\"; }\n\t\t};\n\n\t\tthis.model.getKeypathModel().register( this.nameAttributeBinding );\n\t};\n\n\tRadioNameBinding.prototype.getInitialValue = function getInitialValue () {\n\t\tif ( this.element.getAttribute( 'checked' ) ) {\n\t\t\treturn this.element.getAttribute( 'value' );\n\t\t}\n\t};\n\n\tRadioNameBinding.prototype.getValue = function getValue$1 () {\n\t\treturn this.element.getAttribute( 'value' );\n\t};\n\n\tRadioNameBinding.prototype.handleChange = function handleChange () {\n\t\t// If this <input> is the one that's checked, then the value of its\n\t\t// `name` model gets set to its value\n\t\tif ( this.node.checked ) {\n\t\t\tthis.group.value = this.getValue();\n\t\t\tBinding$$1.prototype.handleChange.call(this);\n\t\t}\n\t};\n\n\tRadioNameBinding.prototype.lastVal = function lastVal ( setting, value ) {\n\t\tif ( setting ) this.group.lastValue = value;\n\t\telse return this.group.lastValue;\n\t};\n\n\tRadioNameBinding.prototype.render = function render () {\n\t\tBinding$$1.prototype.render.call(this);\n\n\t\tvar node = this.node;\n\n\t\tnode.name = \"{{\" + (this.model.getKeypath()) + \"}}\";\n\t\tnode.checked = this.model.get() == this.element.getAttribute( 'value' );\n\n\t\tnode.addEventListener( 'change', handleDomEvent, false );\n\n\t\tif ( node.attachEvent ) {\n\t\t\tnode.addEventListener( 'click', handleDomEvent, false );\n\t\t}\n\t};\n\n\tRadioNameBinding.prototype.setFromNode = function setFromNode ( node ) {\n\t\tif ( node.checked ) {\n\t\t\tthis.group.model.set( this.element.getAttribute( 'value' ) );\n\t\t}\n\t};\n\n\tRadioNameBinding.prototype.unbind = function unbind () {\n\t\tthis.group.remove( this );\n\n\t\tthis.model.getKeypathModel().unregister( this.nameAttributeBinding );\n\t};\n\n\tRadioNameBinding.prototype.unrender = function unrender () {\n\t\tvar node = this.node;\n\n\t\tnode.removeEventListener( 'change', handleDomEvent, false );\n\t\tnode.removeEventListener( 'click', handleDomEvent, false );\n\t};\n\n\treturn RadioNameBinding;\n}(Binding));\n\nvar SingleSelectBinding = (function (Binding$$1) {\n\tfunction SingleSelectBinding () {\n\t\tBinding$$1.apply(this, arguments);\n\t}\n\n\tSingleSelectBinding.prototype = Object.create( Binding$$1 && Binding$$1.prototype );\n\tSingleSelectBinding.prototype.constructor = SingleSelectBinding;\n\n\tSingleSelectBinding.prototype.forceUpdate = function forceUpdate () {\n\t\tvar this$1 = this;\n\n\t\tvar value = this.getValue();\n\n\t\tif ( value !== undefined ) {\n\t\t\tthis.attribute.locked = true;\n\t\t\trunloop.scheduleTask( function () { return this$1.attribute.locked = false; } );\n\t\t\tthis.model.set( value );\n\t\t}\n\t};\n\n\tSingleSelectBinding.prototype.getInitialValue = function getInitialValue () {\n\t\tif ( this.element.getAttribute( 'value' ) !== undefined ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar options = this.element.options;\n\t\tvar len = options.length;\n\n\t\tif ( !len ) return;\n\n\t\tvar value;\n\t\tvar optionWasSelected;\n\t\tvar i = len;\n\n\t\t// take the final selected option...\n\t\twhile ( i-- ) {\n\t\t\tvar option = options[i];\n\n\t\t\tif ( option.getAttribute( 'selected' ) ) {\n\t\t\t\tif ( !option.getAttribute( 'disabled' ) ) {\n\t\t\t\t\tvalue = option.getAttribute( 'value' );\n\t\t\t\t}\n\n\t\t\t\toptionWasSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\t// or the first non-disabled option, if none are selected\n\t\tif ( !optionWasSelected ) {\n\t\t\twhile ( ++i < len ) {\n\t\t\t\tif ( !options[i].getAttribute( 'disabled' ) ) {\n\t\t\t\t\tvalue = options[i].getAttribute( 'value' );\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// This is an optimisation (aka hack) that allows us to forgo some\n\t\t// other more expensive work\n\t\t// TODO does it still work? seems at odds with new architecture\n\t\tif ( value !== undefined ) {\n\t\t\tthis.element.attributeByName.value.value = value;\n\t\t}\n\n\t\treturn value;\n\t};\n\n\tSingleSelectBinding.prototype.getValue = function getValue () {\n\t\tvar options = this.node.options;\n\t\tvar len = options.length;\n\n\t\tvar i;\n\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\tvar option = options[i];\n\n\t\t\tif ( options[i].selected && !options[i].disabled ) {\n\t\t\t\treturn option._ractive ? option._ractive.value : option.value;\n\t\t\t}\n\t\t}\n\t};\n\n\tSingleSelectBinding.prototype.render = function render () {\n\t\tBinding$$1.prototype.render.call(this);\n\t\tthis.node.addEventListener( 'change', handleDomEvent, false );\n\t};\n\n\tSingleSelectBinding.prototype.setFromNode = function setFromNode ( node ) {\n\t\tvar option = getSelectedOptions( node )[0];\n\t\tthis.model.set( option._ractive ? option._ractive.value : option.value );\n\t};\n\n\t// TODO this method is an anomaly... is it necessary?\n\tSingleSelectBinding.prototype.setValue = function setValue ( value ) {\n\t\tthis.model.set( value );\n\t};\n\n\tSingleSelectBinding.prototype.unrender = function unrender () {\n\t\tthis.node.removeEventListener( 'change', handleDomEvent, false );\n\t};\n\n\treturn SingleSelectBinding;\n}(Binding));\n\nfunction isBindable ( attribute ) {\n\treturn attribute &&\n\t\t   attribute.template.f &&\n\t       attribute.template.f.length === 1 &&\n\t       attribute.template.f[0].t === INTERPOLATOR &&\n\t       !attribute.template.f[0].s;\n}\n\nfunction selectBinding ( element ) {\n\tvar attributes = element.attributeByName;\n\n\t// contenteditable - bind if the contenteditable attribute is true\n\t// or is bindable and may thus become true...\n\tif ( element.getAttribute( 'contenteditable' ) || isBindable( attributes.contenteditable ) ) {\n\t\t// ...and this element also has a value attribute to bind\n\t\treturn isBindable( attributes.value ) ? ContentEditableBinding : null;\n\t}\n\n\t// <input>\n\tif ( element.name === 'input' ) {\n\t\tvar type = element.getAttribute( 'type' );\n\n\t\tif ( type === 'radio' || type === 'checkbox' ) {\n\t\t\tvar bindName = isBindable( attributes.name );\n\t\t\tvar bindChecked = isBindable( attributes.checked );\n\n\t\t\t// for radios we can either bind the name attribute, or the checked attribute - not both\n\t\t\tif ( bindName && bindChecked ) {\n\t\t\t\tif ( type === 'radio' ) {\n\t\t\t\t\twarnIfDebug( 'A radio input can have two-way binding on its name attribute, or its checked attribute - not both', { ractive: element.root });\n\t\t\t\t} else {\n\t\t\t\t\t// A checkbox with bindings for both name and checked - see https://github.com/ractivejs/ractive/issues/1749\n\t\t\t\t\treturn CheckboxBinding;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( bindName ) {\n\t\t\t\treturn type === 'radio' ? RadioNameBinding : CheckboxNameBinding;\n\t\t\t}\n\n\t\t\tif ( bindChecked ) {\n\t\t\t\treturn type === 'radio' ? RadioBinding : CheckboxBinding;\n\t\t\t}\n\t\t}\n\n\t\tif ( type === 'file' && isBindable( attributes.value ) ) {\n\t\t\treturn Binding;\n\t\t}\n\n\t\tif ( isBindable( attributes.value ) ) {\n\t\t\treturn ( type === 'number' || type === 'range' ) ? NumericBinding : GenericBinding;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t// <select>\n\tif ( element.name === 'select' && isBindable( attributes.value ) ) {\n\t\treturn element.getAttribute( 'multiple' ) ? MultipleSelectBinding : SingleSelectBinding;\n\t}\n\n\t// <textarea>\n\tif ( element.name === 'textarea' && isBindable( attributes.value ) ) {\n\t\treturn GenericBinding;\n\t}\n}\n\nfunction makeDirty$2 ( query ) {\n\tquery.makeDirty();\n}\n\nvar endsWithSemi = /;\\s*$/;\n\nvar Element = (function (Item$$1) {\n\tfunction Element ( options ) {\n\t\tvar this$1 = this;\n\n\t\tItem$$1.call( this, options );\n\n\t\tthis.liveQueries = []; // TODO rare case. can we handle differently?\n\n\t\tthis.name = options.template.e.toLowerCase();\n\t\tthis.isVoid = voidElementNames.test( this.name );\n\n\t\t// find parent element\n\t\tthis.parent = findElement( this.parentFragment, false );\n\n\t\tif ( this.parent && this.parent.name === 'option' ) {\n\t\t\tthrow new Error( (\"An <option> element cannot contain other elements (encountered <\" + (this.name) + \">)\") );\n\t\t}\n\n\t\tthis.decorators = [];\n\n\t\t// create attributes\n\t\tthis.attributeByName = {};\n\n\t\tthis.attributes = [];\n\t\tvar leftovers = [];\n\t\t( this.template.m || [] ).forEach( function ( template ) {\n\t\t\tswitch ( template.t ) {\n\t\t\t\tcase ATTRIBUTE:\n\t\t\t\tcase BINDING_FLAG:\n\t\t\t\tcase DECORATOR:\n\t\t\t\tcase EVENT:\n\t\t\t\tcase TRANSITION:\n\t\t\t\t\tthis$1.attributes.push( createItem({\n\t\t\t\t\t\towner: this$1,\n\t\t\t\t\t\tparentFragment: this$1.parentFragment,\n\t\t\t\t\t\ttemplate: template\n\t\t\t\t\t}) );\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tleftovers.push( template );\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\n\t\tthis.attributes.push( new ConditionalAttribute({\n\t\t\towner: this,\n\t\t\tparentFragment: this.parentFragment,\n\t\t\ttemplate: leftovers\n\t\t}) );\n\n\t\tvar i = this.attributes.length;\n\t\twhile ( i-- ) {\n\t\t\tvar attr = this$1.attributes[ i ];\n\t\t\tif ( attr.name === 'type' ) this$1.attributes.unshift( this$1.attributes.splice( i, 1 )[ 0 ] );\n\t\t\telse if ( attr.name === 'max' ) this$1.attributes.unshift( this$1.attributes.splice( i, 1 )[ 0 ] );\n\t\t\telse if ( attr.name === 'min' ) this$1.attributes.unshift( this$1.attributes.splice( i, 1 )[ 0 ] );\n\t\t\telse if ( attr.name === 'class' ) this$1.attributes.unshift( this$1.attributes.splice( i, 1 )[ 0 ] );\n\t\t\telse if ( attr.name === 'value' ) {\n\t\t\t\tthis$1.attributes.push( this$1.attributes.splice( i, 1 )[ 0 ] );\n\t\t\t}\n\t\t}\n\n\t\t// create children\n\t\tif ( options.template.f && !options.deferContent ) {\n\t\t\tthis.fragment = new Fragment({\n\t\t\t\ttemplate: options.template.f,\n\t\t\t\towner: this,\n\t\t\t\tcssIds: null\n\t\t\t});\n\t\t}\n\n\t\tthis.binding = null; // filled in later\n\t}\n\n\tElement.prototype = Object.create( Item$$1 && Item$$1.prototype );\n\tElement.prototype.constructor = Element;\n\n\tElement.prototype.bind = function bind$1 () {\n\t\tthis.attributes.binding = true;\n\t\tthis.attributes.forEach( bind$2 );\n\t\tthis.attributes.binding = false;\n\n\t\tif ( this.fragment ) this.fragment.bind();\n\n\t\t// create two-way binding if necessary\n\t\tif ( !this.binding ) this.recreateTwowayBinding();\n\t};\n\n\tElement.prototype.createTwowayBinding = function createTwowayBinding () {\n\t\tvar shouldBind = 'twoway' in this ? this.twoway : this.ractive.twoway;\n\n\t\tif ( !shouldBind ) return null;\n\n\t\tvar Binding = selectBinding( this );\n\n\t\tif ( !Binding ) return null;\n\n\t\tvar binding = new Binding( this );\n\n\t\treturn binding && binding.model ?\n\t\t\tbinding :\n\t\t\tnull;\n\t};\n\n\tElement.prototype.destroyed = function destroyed () {\n\t\tthis.attributes.forEach( function ( a ) { return a.destroyed(); } );\n\t\tif ( this.fragment ) this.fragment.destroyed();\n\t};\n\n\tElement.prototype.detach = function detach () {\n\t\t// if this element is no longer rendered, the transitions are complete and the attributes can be torn down\n\t\tif ( !this.rendered ) this.destroyed();\n\n\t\treturn detachNode( this.node );\n\t};\n\n\tElement.prototype.find = function find ( selector ) {\n\t\tif ( matches( this.node, selector ) ) return this.node;\n\t\tif ( this.fragment ) {\n\t\t\treturn this.fragment.find( selector );\n\t\t}\n\t};\n\n\tElement.prototype.findAll = function findAll ( selector, query ) {\n\t\t// Add this node to the query, if applicable, and register the\n\t\t// query on this element\n\t\tvar matches$$1 = query.test( this.node );\n\t\tif ( matches$$1 ) {\n\t\t\tquery.add( this.node );\n\t\t\tif ( query.live ) this.liveQueries.push( query );\n\t\t}\n\n\t\tif ( this.fragment ) {\n\t\t\tthis.fragment.findAll( selector, query );\n\t\t}\n\t};\n\n\tElement.prototype.findComponent = function findComponent ( name ) {\n\t\tif ( this.fragment ) {\n\t\t\treturn this.fragment.findComponent( name );\n\t\t}\n\t};\n\n\tElement.prototype.findAllComponents = function findAllComponents ( name, query ) {\n\t\tif ( this.fragment ) {\n\t\t\tthis.fragment.findAllComponents( name, query );\n\t\t}\n\t};\n\n\tElement.prototype.findNextNode = function findNextNode () {\n\t\treturn null;\n\t};\n\n\tElement.prototype.firstNode = function firstNode () {\n\t\treturn this.node;\n\t};\n\n\tElement.prototype.getAttribute = function getAttribute ( name ) {\n\t\tvar attribute = this.attributeByName[ name ];\n\t\treturn attribute ? attribute.getValue() : undefined;\n\t};\n\n\tElement.prototype.recreateTwowayBinding = function recreateTwowayBinding () {\n\t\tif ( this.binding ) {\n\t\t\tthis.binding.unbind();\n\t\t\tthis.binding.unrender();\n\t\t}\n\n\t\tif ( this.binding = this.createTwowayBinding() ) {\n\t\t\tthis.binding.bind();\n\t\t\tif ( this.rendered ) this.binding.render();\n\t\t}\n\t};\n\n\tElement.prototype.render = function render$1 ( target, occupants ) {\n\t\t// TODO determine correct namespace\n\t\tvar this$1 = this;\n\n\t\tthis.namespace = getNamespace( this );\n\n\t\tvar node;\n\t\tvar existing = false;\n\n\t\tif ( occupants ) {\n\t\t\tvar n;\n\t\t\twhile ( ( n = occupants.shift() ) ) {\n\t\t\t\tif ( n.nodeName.toUpperCase() === this$1.template.e.toUpperCase() && n.namespaceURI === this$1.namespace ) {\n\t\t\t\t\tthis$1.node = node = n;\n\t\t\t\t\texisting = true;\n\t\t\t\t\tbreak;\n\t\t\t\t} else {\n\t\t\t\t\tdetachNode( n );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif ( !node ) {\n\t\t\tnode = createElement( this.template.e, this.namespace, this.getAttribute( 'is' ) );\n\t\t\tthis.node = node;\n\t\t}\n\n\t\tdefineProperty( node, '_ractive', {\n\t\t\tvalue: {\n\t\t\t\tproxy: this\n\t\t\t}\n\t\t});\n\n\t\t// Is this a top-level node of a component? If so, we may need to add\n\t\t// a data-ractive-css attribute, for CSS encapsulation\n\t\tif ( this.parentFragment.cssIds ) {\n\t\t\tnode.setAttribute( 'data-ractive-css', this.parentFragment.cssIds.map( function ( x ) { return (\"{\" + x + \"}\"); } ).join( ' ' ) );\n\t\t}\n\n\t\tif ( existing && this.foundNode ) this.foundNode( node );\n\n\t\tif ( this.fragment ) {\n\t\t\tvar children = existing ? toArray( node.childNodes ) : undefined;\n\n\t\t\tthis.fragment.render( node, children );\n\n\t\t\t// clean up leftover children\n\t\t\tif ( children ) {\n\t\t\t\tchildren.forEach( detachNode );\n\t\t\t}\n\t\t}\n\n\t\tif ( existing ) {\n\t\t\t// store initial values for two-way binding\n\t\t\tif ( this.binding && this.binding.wasUndefined ) this.binding.setFromNode( node );\n\t\t\t// remove unused attributes\n\t\t\tvar i = node.attributes.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tvar name = node.attributes[i].name;\n\t\t\t\tif ( !( name in this$1.attributeByName ) ) node.removeAttribute( name );\n\t\t\t}\n\t\t}\n\n\t\tthis.attributes.forEach( render$1$1 );\n\n\t\tif ( this.binding ) this.binding.render();\n\n\t\tupdateLiveQueries$1( this );\n\n\t\tif ( this._introTransition && this.ractive.transitionsEnabled ) {\n\t\t\tthis._introTransition.isIntro = true;\n\t\t\trunloop.registerTransition( this._introTransition );\n\t\t}\n\n\t\tif ( !existing ) {\n\t\t\ttarget.appendChild( node );\n\t\t}\n\n\t\tthis.rendered = true;\n\t};\n\n\tElement.prototype.shuffled = function shuffled () {\n\t\tthis.liveQueries.forEach( makeDirty$2 );\n\t\tItem$$1.prototype.shuffled.call(this);\n\t};\n\n\tElement.prototype.toString = function toString () {\n\t\tvar tagName = this.template.e;\n\n\t\tvar attrs = this.attributes.map( stringifyAttribute ).join( '' );\n\n\t\t// Special case - selected options\n\t\tif ( this.name === 'option' && this.isSelected() ) {\n\t\t\tattrs += ' selected';\n\t\t}\n\n\t\t// Special case - two-way radio name bindings\n\t\tif ( this.name === 'input' && inputIsCheckedRadio( this ) ) {\n\t\t\tattrs += ' checked';\n\t\t}\n\n\t\t// Special case style and class attributes and directives\n\t\tvar style, cls;\n\t\tthis.attributes.forEach( function ( attr ) {\n\t\t\tif ( attr.name === 'class' ) {\n\t\t\t\tcls = ( cls || '' ) + ( cls ? ' ' : '' ) + safeAttributeString( attr.getString() );\n\t\t\t} else if ( attr.name === 'style' ) {\n\t\t\t\tstyle = ( style || '' ) + ( style ? ' ' : '' ) + safeAttributeString( attr.getString() );\n\t\t\t\tif ( style && !endsWithSemi.test( style ) ) style += ';';\n\t\t\t} else if ( attr.styleName ) {\n\t\t\t\tstyle = ( style || '' ) + ( style ? ' ' : '' ) +  \"\" + (decamelize( attr.styleName )) + \": \" + (safeAttributeString( attr.getString() )) + \";\";\n\t\t\t} else if ( attr.inlineClass && attr.getValue() ) {\n\t\t\t\tcls = ( cls || '' ) + ( cls ? ' ' : '' ) + attr.inlineClass;\n\t\t\t}\n\t\t});\n\t\t// put classes first, then inline style\n\t\tif ( style !== undefined ) attrs = ' style' + ( style ? (\"=\\\"\" + style + \"\\\"\") : '' ) + attrs;\n\t\tif ( cls !== undefined ) attrs = ' class' + (cls ? (\"=\\\"\" + cls + \"\\\"\") : '') + attrs;\n\n\t\tvar str = \"<\" + tagName + \"\" + attrs + \">\";\n\n\t\tif ( this.isVoid ) return str;\n\n\t\t// Special case - textarea\n\t\tif ( this.name === 'textarea' && this.getAttribute( 'value' ) !== undefined ) {\n\t\t\tstr += escapeHtml( this.getAttribute( 'value' ) );\n\t\t}\n\n\t\t// Special case - contenteditable\n\t\telse if ( this.getAttribute( 'contenteditable' ) !== undefined ) {\n\t\t\tstr += ( this.getAttribute( 'value' ) || '' );\n\t\t}\n\n\t\tif ( this.fragment ) {\n\t\t\tstr += this.fragment.toString( !/^(?:script|style)$/i.test( this.template.e ) ); // escape text unless script/style\n\t\t}\n\n\t\tstr += \"</\" + tagName + \">\";\n\t\treturn str;\n\t};\n\n\tElement.prototype.unbind = function unbind$1 () {\n\t\tthis.attributes.forEach( unbind$1$1 );\n\n\t\tif ( this.binding ) this.binding.unbind();\n\t\tif ( this.fragment ) this.fragment.unbind();\n\t};\n\n\tElement.prototype.unrender = function unrender ( shouldDestroy ) {\n\t\tif ( !this.rendered ) return;\n\t\tthis.rendered = false;\n\n\t\t// unrendering before intro completed? complete it now\n\t\t// TODO should be an API for aborting transitions\n\t\tvar transition = this._introTransition;\n\t\tif ( transition && transition.complete ) transition.complete();\n\n\t\t// Detach as soon as we can\n\t\tif ( this.name === 'option' ) {\n\t\t\t// <option> elements detach immediately, so that\n\t\t\t// their parent <select> element syncs correctly, and\n\t\t\t// since option elements can't have transitions anyway\n\t\t\tthis.detach();\n\t\t} else if ( shouldDestroy ) {\n\t\t\trunloop.detachWhenReady( this );\n\t\t}\n\n\t\tif ( this.fragment ) this.fragment.unrender();\n\n\t\tif ( this.binding ) this.binding.unrender();\n\n\t\t// outro transition\n\t\tif ( this._outroTransition && this.ractive.transitionsEnabled ) {\n\t\t\tthis._outroTransition.isIntro = false;\n\t\t\trunloop.registerTransition( this._outroTransition );\n\t\t}\n\n\t\tremoveFromLiveQueries( this );\n\t\t// TODO forms are a special case\n\t};\n\n\tElement.prototype.update = function update$1 () {\n\t\tif ( this.dirty ) {\n\t\t\tthis.dirty = false;\n\n\t\t\tthis.attributes.forEach( update$1$1 );\n\n\t\t\tif ( this.fragment ) this.fragment.update();\n\t\t}\n\t};\n\n\treturn Element;\n}(Item));\n\nfunction inputIsCheckedRadio ( element ) {\n\tvar attributes = element.attributeByName;\n\n\tvar typeAttribute  = attributes.type;\n\tvar valueAttribute = attributes.value;\n\tvar nameAttribute  = attributes.name;\n\n\tif ( !typeAttribute || ( typeAttribute.value !== 'radio' ) || !valueAttribute || !nameAttribute.interpolator ) {\n\t\treturn;\n\t}\n\n\tif ( valueAttribute.getValue() === nameAttribute.interpolator.model.get() ) {\n\t\treturn true;\n\t}\n}\n\nfunction stringifyAttribute ( attribute ) {\n\tvar str = attribute.toString();\n\treturn str ? ' ' + str : '';\n}\n\nfunction removeFromLiveQueries ( element ) {\n\tvar i = element.liveQueries.length;\n\twhile ( i-- ) {\n\t\tvar query = element.liveQueries[i];\n\t\tquery.remove( element.node );\n\t}\n}\n\nfunction getNamespace ( element ) {\n\t// Use specified namespace...\n\tvar xmlns$$1 = element.getAttribute( 'xmlns' );\n\tif ( xmlns$$1 ) return xmlns$$1;\n\n\t// ...or SVG namespace, if this is an <svg> element\n\tif ( element.name === 'svg' ) return svg$1;\n\n\tvar parent = element.parent;\n\n\tif ( parent ) {\n\t\t// ...or HTML, if the parent is a <foreignObject>\n\t\tif ( parent.name === 'foreignobject' ) return html;\n\n\t\t// ...or inherit from the parent node\n\t\treturn parent.node.namespaceURI;\n\t}\n\n\treturn element.ractive.el.namespaceURI;\n}\n\nvar Form = (function (Element$$1) {\n\tfunction Form ( options ) {\n\t\tElement$$1.call( this, options );\n\t\tthis.formBindings = [];\n\t}\n\n\tForm.prototype = Object.create( Element$$1 && Element$$1.prototype );\n\tForm.prototype.constructor = Form;\n\n\tForm.prototype.render = function render ( target, occupants ) {\n\t\tElement$$1.prototype.render.call( this, target, occupants );\n\t\tthis.node.addEventListener( 'reset', handleReset, false );\n\t};\n\n\tForm.prototype.unrender = function unrender ( shouldDestroy ) {\n\t\tthis.node.removeEventListener( 'reset', handleReset, false );\n\t\tElement$$1.prototype.unrender.call( this, shouldDestroy );\n\t};\n\n\treturn Form;\n}(Element));\n\nfunction handleReset () {\n\tvar element = this._ractive.proxy;\n\n\trunloop.start();\n\telement.formBindings.forEach( updateModel$2 );\n\trunloop.end();\n}\n\nfunction updateModel$2 ( binding ) {\n\tbinding.model.set( binding.resetValue );\n}\n\nvar Mustache = (function (Item$$1) {\n\tfunction Mustache ( options ) {\n\t\tItem$$1.call( this, options );\n\n\t\tthis.parentFragment = options.parentFragment;\n\t\tthis.template = options.template;\n\t\tthis.index = options.index;\n\t\tif ( options.owner ) this.parent = options.owner;\n\n\t\tthis.isStatic = !!options.template.s;\n\n\t\tthis.model = null;\n\t\tthis.dirty = false;\n\t}\n\n\tMustache.prototype = Object.create( Item$$1 && Item$$1.prototype );\n\tMustache.prototype.constructor = Mustache;\n\n\tMustache.prototype.bind = function bind () {\n\t\t// try to find a model for this view\n\t\tvar this$1 = this;\n\n\t\tvar model = resolve$3( this.parentFragment, this.template );\n\t\tvar value = model ? model.get() : undefined;\n\n\t\tif ( this.isStatic ) {\n\t\t\tthis.model = { get: function () { return value; } };\n\t\t\treturn;\n\t\t}\n\n\t\tif ( model ) {\n\t\t\tmodel.register( this );\n\t\t\tthis.model = model;\n\t\t} else {\n\t\t\tthis.resolver = this.parentFragment.resolve( this.template.r, function ( model ) {\n\t\t\t\tthis$1.model = model;\n\t\t\t\tmodel.register( this$1 );\n\n\t\t\t\tthis$1.handleChange();\n\t\t\t\tthis$1.resolver = null;\n\t\t\t});\n\t\t}\n\t};\n\n\tMustache.prototype.handleChange = function handleChange () {\n\t\tthis.bubble();\n\t};\n\n\tMustache.prototype.rebinding = function rebinding ( next, previous, safe ) {\n\t\tnext = rebindMatch( this.template, next, previous );\n\t\tif ( this['static'] ) return false;\n\t\tif ( next === this.model ) return false;\n\n\t\tif ( this.model ) {\n\t\t\tthis.model.unregister( this );\n\t\t}\n\t\tif ( next ) next.addShuffleRegister( this, 'mark' );\n\t\tthis.model = next;\n\t\tif ( !safe ) this.handleChange();\n\t\treturn true;\n\t};\n\n\tMustache.prototype.unbind = function unbind () {\n\t\tif ( !this.isStatic ) {\n\t\t\tthis.model && this.model.unregister( this );\n\t\t\tthis.model = undefined;\n\t\t\tthis.resolver && this.resolver.unbind();\n\t\t}\n\t};\n\n\treturn Mustache;\n}(Item));\n\nvar Interpolator = (function (Mustache$$1) {\n\tfunction Interpolator () {\n\t\tMustache$$1.apply(this, arguments);\n\t}\n\n\tInterpolator.prototype = Object.create( Mustache$$1 && Mustache$$1.prototype );\n\tInterpolator.prototype.constructor = Interpolator;\n\n\tInterpolator.prototype.bubble = function bubble () {\n\t\tif ( this.owner ) this.owner.bubble();\n\t\tMustache$$1.prototype.bubble.call(this);\n\t};\n\n\tInterpolator.prototype.detach = function detach () {\n\t\treturn detachNode( this.node );\n\t};\n\n\tInterpolator.prototype.firstNode = function firstNode () {\n\t\treturn this.node;\n\t};\n\n\tInterpolator.prototype.getString = function getString () {\n\t\treturn this.model ? safeToStringValue( this.model.get() ) : '';\n\t};\n\n\tInterpolator.prototype.render = function render ( target, occupants ) {\n\t\tif ( inAttributes() ) return;\n\t\tvar value = this.getString();\n\n\t\tthis.rendered = true;\n\n\t\tif ( occupants ) {\n\t\t\tvar n = occupants[0];\n\t\t\tif ( n && n.nodeType === 3 ) {\n\t\t\t\toccupants.shift();\n\t\t\t\tif ( n.nodeValue !== value ) {\n\t\t\t\t\tn.nodeValue = value;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tn = this.node = doc.createTextNode( value );\n\t\t\t\tif ( occupants[0] ) {\n\t\t\t\t\ttarget.insertBefore( n, occupants[0] );\n\t\t\t\t} else {\n\t\t\t\t\ttarget.appendChild( n );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.node = n;\n\t\t} else {\n\t\t\tthis.node = doc.createTextNode( value );\n\t\t\ttarget.appendChild( this.node );\n\t\t}\n\t};\n\n\tInterpolator.prototype.toString = function toString ( escape ) {\n\t\tvar string = this.getString();\n\t\treturn escape ? escapeHtml( string ) : string;\n\t};\n\n\tInterpolator.prototype.unrender = function unrender ( shouldDestroy ) {\n\t\tif ( shouldDestroy ) this.detach();\n\t\tthis.rendered = false;\n\t};\n\n\tInterpolator.prototype.update = function update () {\n\t\tif ( this.dirty ) {\n\t\t\tthis.dirty = false;\n\t\t\tif ( this.rendered ) {\n\t\t\t\tthis.node.data = this.getString();\n\t\t\t}\n\t\t}\n\t};\n\n\tInterpolator.prototype.valueOf = function valueOf () {\n\t\treturn this.model ? this.model.get() : undefined;\n\t};\n\n\treturn Interpolator;\n}(Mustache));\n\nvar Input = (function (Element$$1) {\n\tfunction Input () {\n\t\tElement$$1.apply(this, arguments);\n\t}\n\n\tInput.prototype = Object.create( Element$$1 && Element$$1.prototype );\n\tInput.prototype.constructor = Input;\n\n\tInput.prototype.render = function render ( target, occupants ) {\n\t\tElement$$1.prototype.render.call( this, target, occupants );\n\t\tthis.node.defaultValue = this.node.value;\n\t};\n\n\treturn Input;\n}(Element));\n\nvar Mapping = (function (Item$$1) {\n\tfunction Mapping ( options ) {\n\t\tItem$$1.call( this, options );\n\n\t\tthis.name = options.template.n;\n\n\t\tthis.owner = options.owner || options.parentFragment.owner || options.element || findElement( options.parentFragment );\n\t\tthis.element = options.element || (this.owner.attributeByName ? this.owner : findElement( options.parentFragment ) );\n\t\tthis.parentFragment = this.element.parentFragment; // shared\n\t\tthis.ractive = this.parentFragment.ractive;\n\n\t\tthis.fragment = null;\n\n\t\tthis.element.attributeByName[ this.name ] = this;\n\n\t\tthis.value = options.template.f;\n\t}\n\n\tMapping.prototype = Object.create( Item$$1 && Item$$1.prototype );\n\tMapping.prototype.constructor = Mapping;\n\n\tMapping.prototype.bind = function bind () {\n\t\tif ( this.fragment ) {\n\t\t\tthis.fragment.bind();\n\t\t}\n\n\t\tvar template = this.template.f;\n\t\tvar viewmodel = this.element.instance.viewmodel;\n\n\t\tif ( template === 0 ) {\n\t\t\t// empty attributes are `true`\n\t\t\tviewmodel.joinKey( this.name ).set( true );\n\t\t}\n\n\t\telse if ( typeof template === 'string' ) {\n\t\t\tvar parsed = parseJSON( template );\n\t\t\tviewmodel.joinKey( this.name ).set( parsed ? parsed.value : template );\n\t\t}\n\n\t\telse if ( isArray( template ) ) {\n\t\t\tcreateMapping( this, true );\n\t\t}\n\t};\n\n\tMapping.prototype.render = function render () {};\n\n\tMapping.prototype.unbind = function unbind () {\n\t\tif ( this.fragment ) this.fragment.unbind();\n\t\tif ( this.boundFragment ) this.boundFragment.unbind();\n\n\t\tif ( this.element.bound ) {\n\t\t\tif ( this.link.target === this.model ) this.link.owner.unlink();\n\t\t}\n\t};\n\n\tMapping.prototype.unrender = function unrender () {};\n\n\tMapping.prototype.update = function update () {\n\t\tif ( this.dirty ) {\n\t\t\tthis.dirty = false;\n\t\t\tif ( this.fragment ) this.fragment.update();\n\t\t\tif ( this.boundFragment ) this.boundFragment.update();\n\t\t\tif ( this.rendered ) this.updateDelegate();\n\t\t}\n\t};\n\n\treturn Mapping;\n}(Item));\n\nfunction createMapping ( item ) {\n\tvar template = item.template.f;\n\tvar viewmodel = item.element.instance.viewmodel;\n\tvar childData = viewmodel.value;\n\n\tif ( template.length === 1 && template[0].t === INTERPOLATOR ) {\n\t\titem.model = resolve$3( item.parentFragment, template[0] );\n\n\t\tif ( !item.model ) {\n\t\t\twarnOnceIfDebug( (\"The \" + (item.name) + \"='{{\" + (template[0].r) + \"}}' mapping is ambiguous, and may cause unexpected results. Consider initialising your data to eliminate the ambiguity\"), { ractive: item.element.instance }); // TODO add docs page explaining item\n\t\t\titem.parentFragment.ractive.get( item.name ); // side-effect: create mappings as necessary\n\t\t\titem.model = item.parentFragment.findContext().joinKey( item.name );\n\t\t}\n\n\t\titem.link = viewmodel.createLink( item.name, item.model, template[0].r );\n\n\t\tif ( item.model.get() === undefined && item.name in childData ) {\n\t\t\titem.model.set( childData[ item.name ] );\n\t\t}\n\t}\n\n\telse {\n\t\titem.boundFragment = new Fragment({\n\t\t\towner: item,\n\t\t\ttemplate: template\n\t\t}).bind();\n\n\t\titem.model = viewmodel.joinKey( item.name );\n\t\titem.model.set( item.boundFragment.valueOf() );\n\n\t\t// item is a *bit* of a hack\n\t\titem.boundFragment.bubble = function () {\n\t\t\tFragment.prototype.bubble.call( item.boundFragment );\n\t\t\t// defer this to avoid mucking around model deps if there happens to be an expression involved\n\t\t\trunloop.scheduleTask(function () {\n\t\t\t\titem.boundFragment.update();\n\t\t\t\titem.model.set( item.boundFragment.valueOf() );\n\t\t\t});\n\t\t};\n\t}\n}\n\nfunction findParentSelect ( element ) {\n\twhile ( element ) {\n\t\tif ( element.name === 'select' ) return element;\n\t\telement = element.parent;\n\t}\n}\n\nvar Option = (function (Element$$1) {\n\tfunction Option ( options ) {\n\t\tvar template = options.template;\n\t\tif ( !template.a ) template.a = {};\n\n\t\t// If the value attribute is missing, use the element's content,\n\t\t// as long as it isn't disabled\n\t\tif ( template.a.value === undefined && !( 'disabled' in template.a ) ) {\n\t\t\ttemplate.a.value = template.f || '';\n\t\t}\n\n\t\tElement$$1.call( this, options );\n\n\t\tthis.select = findParentSelect( this.parent );\n\t}\n\n\tOption.prototype = Object.create( Element$$1 && Element$$1.prototype );\n\tOption.prototype.constructor = Option;\n\n\tOption.prototype.bind = function bind () {\n\t\tif ( !this.select ) {\n\t\t\tElement$$1.prototype.bind.call(this);\n\t\t\treturn;\n\t\t}\n\n\t\t// If the select has a value, it overrides the `selected` attribute on\n\t\t// this option - so we delete the attribute\n\t\tvar selectedAttribute = this.attributeByName.selected;\n\t\tif ( selectedAttribute && this.select.getAttribute( 'value' ) !== undefined ) {\n\t\t\tvar index = this.attributes.indexOf( selectedAttribute );\n\t\t\tthis.attributes.splice( index, 1 );\n\t\t\tdelete this.attributeByName.selected;\n\t\t}\n\n\t\tElement$$1.prototype.bind.call(this);\n\t\tthis.select.options.push( this );\n\t};\n\n\tOption.prototype.bubble = function bubble () {\n\t\t// if we're using content as value, may need to update here\n\t\tvar value = this.getAttribute( 'value' );\n\t\tif ( this.node.value !== value ) {\n\t\t\tthis.node._ractive.value = value;\n\t\t}\n\t\tElement$$1.prototype.bubble.call(this);\n\t};\n\n\tOption.prototype.getAttribute = function getAttribute ( name ) {\n\t\tvar attribute = this.attributeByName[ name ];\n\t\treturn attribute ? attribute.getValue() : name === 'value' && this.fragment ? this.fragment.valueOf() : undefined;\n\t};\n\n\tOption.prototype.isSelected = function isSelected () {\n\t\tvar optionValue = this.getAttribute( 'value' );\n\n\t\tif ( optionValue === undefined || !this.select ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tvar selectValue = this.select.getAttribute( 'value' );\n\n\t\tif ( selectValue == optionValue ) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif ( this.select.getAttribute( 'multiple' ) && isArray( selectValue ) ) {\n\t\t\tvar i = selectValue.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tif ( selectValue[i] == optionValue ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\tOption.prototype.render = function render ( target, occupants ) {\n\t\tElement$$1.prototype.render.call( this, target, occupants );\n\n\t\tif ( !this.attributeByName.value ) {\n\t\t\tthis.node._ractive.value = this.getAttribute( 'value' );\n\t\t}\n\t};\n\n\tOption.prototype.unbind = function unbind () {\n\t\tElement$$1.prototype.unbind.call(this);\n\n\t\tif ( this.select ) {\n\t\t\tremoveFromArray( this.select.options, this );\n\t\t}\n\t};\n\n\treturn Option;\n}(Element));\n\nfunction getPartialTemplate ( ractive, name, parentFragment ) {\n\t// If the partial in instance or view heirarchy instances, great\n\tvar partial = getPartialFromRegistry( ractive, name, parentFragment || {} );\n\tif ( partial ) return partial;\n\n\t// Does it exist on the page as a script tag?\n\tpartial = parser.fromId( name, { noThrow: true } );\n\tif ( partial ) {\n\t\t// parse and register to this ractive instance\n\t\tvar parsed = parser.parseFor( partial, ractive );\n\n\t\t// register extra partials on the ractive instance if they don't already exist\n\t\tif ( parsed.p ) fillGaps( ractive.partials, parsed.p );\n\n\t\t// register (and return main partial if there are others in the template)\n\t\treturn ractive.partials[ name ] = parsed.t;\n\t}\n}\n\nfunction getPartialFromRegistry ( ractive, name, parentFragment ) {\n\t// if there was an instance up-hierarchy, cool\n\tvar partial = findParentPartial( name, parentFragment.owner );\n\tif ( partial ) return partial;\n\n\t// find first instance in the ractive or view hierarchy that has this partial\n\tvar instance = findInstance( 'partials', ractive, name );\n\n\tif ( !instance ) { return; }\n\n\tpartial = instance.partials[ name ];\n\n\t// partial is a function?\n\tvar fn;\n\tif ( typeof partial === 'function' ) {\n\t\tfn = partial.bind( instance );\n\t\tfn.isOwner = instance.partials.hasOwnProperty(name);\n\t\tpartial = fn.call( ractive, parser );\n\t}\n\n\tif ( !partial && partial !== '' ) {\n\t\twarnIfDebug( noRegistryFunctionReturn, name, 'partial', 'partial', { ractive: ractive });\n\t\treturn;\n\t}\n\n\t// If this was added manually to the registry,\n\t// but hasn't been parsed, parse it now\n\tif ( !parser.isParsed( partial ) ) {\n\t\t// use the parseOptions of the ractive instance on which it was found\n\t\tvar parsed = parser.parseFor( partial, instance );\n\n\t\t// Partials cannot contain nested partials!\n\t\t// TODO add a test for this\n\t\tif ( parsed.p ) {\n\t\t\twarnIfDebug( 'Partials ({{>%s}}) cannot contain nested inline partials', name, { ractive: ractive });\n\t\t}\n\n\t\t// if fn, use instance to store result, otherwise needs to go\n\t\t// in the correct point in prototype chain on instance or constructor\n\t\tvar target = fn ? instance : findOwner( instance, name );\n\n\t\t// may be a template with partials, which need to be registered and main template extracted\n\t\ttarget.partials[ name ] = partial = parsed.t;\n\t}\n\n\t// store for reset\n\tif ( fn ) partial._fn = fn;\n\n\treturn partial.v ? partial.t : partial;\n}\n\nfunction findOwner ( ractive, key ) {\n\treturn ractive.partials.hasOwnProperty( key )\n\t\t? ractive\n\t\t: findConstructor( ractive.constructor, key);\n}\n\nfunction findConstructor ( constructor, key ) {\n\tif ( !constructor ) { return; }\n\treturn constructor.partials.hasOwnProperty( key )\n\t\t? constructor\n\t\t: findConstructor( constructor._Parent, key );\n}\n\nfunction findParentPartial( name, parent ) {\n\tif ( parent ) {\n\t\tif ( parent.template && parent.template.p && parent.template.p[name] ) {\n\t\t\treturn parent.template.p[name];\n\t\t} else if ( parent.parentFragment && parent.parentFragment.owner ) {\n\t\t\treturn findParentPartial( name, parent.parentFragment.owner );\n\t\t}\n\t}\n}\n\nvar Partial = (function (Mustache$$1) {\n\tfunction Partial () {\n\t\tMustache$$1.apply(this, arguments);\n\t}\n\n\tPartial.prototype = Object.create( Mustache$$1 && Mustache$$1.prototype );\n\tPartial.prototype.constructor = Partial;\n\n\tPartial.prototype.bind = function bind () {\n\t\t// keep track of the reference name for future resets\n\t\tthis.refName = this.template.r;\n\n\t\t// name matches take priority over expressions\n\t\tvar template = this.refName ? getPartialTemplate( this.ractive, this.refName, this.parentFragment ) || null : null;\n\t\tvar templateObj;\n\n\t\tif ( template ) {\n\t\t\tthis.named = true;\n\t\t\tthis.setTemplate( this.template.r, template );\n\t\t}\n\n\t\tif ( !template ) {\n\t\t\tMustache$$1.prototype.bind.call(this);\n\t\t\tif ( this.model && ( templateObj = this.model.get() ) && typeof templateObj === 'object' && ( typeof templateObj.template === 'string' || isArray( templateObj.t ) ) ) {\n\t\t\t\tif ( templateObj.template ) {\n\t\t\t\t\tthis.source = templateObj.template;\n\t\t\t\t\ttemplateObj = parsePartial( this.template.r, templateObj.template, this.ractive );\n\t\t\t\t} else {\n\t\t\t\t\tthis.source = templateObj.t;\n\t\t\t\t}\n\t\t\t\tthis.setTemplate( this.template.r, templateObj.t );\n\t\t\t} else if ( ( !this.model || typeof this.model.get() !== 'string' ) && this.refName ) {\n\t\t\t\tthis.setTemplate( this.refName, template );\n\t\t\t} else {\n\t\t\t\tthis.setTemplate( this.model.get() );\n\t\t\t}\n\t\t}\n\n\t\tthis.fragment = new Fragment({\n\t\t\towner: this,\n\t\t\ttemplate: this.partialTemplate\n\t\t}).bind();\n\t};\n\n\tPartial.prototype.destroyed = function destroyed () {\n\t\tthis.fragment.destroyed();\n\t};\n\n\tPartial.prototype.detach = function detach () {\n\t\treturn this.fragment.detach();\n\t};\n\n\tPartial.prototype.find = function find ( selector ) {\n\t\treturn this.fragment.find( selector );\n\t};\n\n\tPartial.prototype.findAll = function findAll ( selector, query ) {\n\t\tthis.fragment.findAll( selector, query );\n\t};\n\n\tPartial.prototype.findComponent = function findComponent ( name ) {\n\t\treturn this.fragment.findComponent( name );\n\t};\n\n\tPartial.prototype.findAllComponents = function findAllComponents ( name, query ) {\n\t\tthis.fragment.findAllComponents( name, query );\n\t};\n\n\tPartial.prototype.firstNode = function firstNode ( skipParent ) {\n\t\treturn this.fragment.firstNode( skipParent );\n\t};\n\n\tPartial.prototype.forceResetTemplate = function forceResetTemplate () {\n\t\tvar this$1 = this;\n\n\t\tthis.partialTemplate = undefined;\n\n\t\t// on reset, check for the reference name first\n\t\tif ( this.refName ) {\n\t\t\tthis.partialTemplate = getPartialTemplate( this.ractive, this.refName, this.parentFragment );\n\t\t}\n\n\t\t// then look for the resolved name\n\t\tif ( !this.partialTemplate ) {\n\t\t\tthis.partialTemplate = getPartialTemplate( this.ractive, this.name, this.parentFragment );\n\t\t}\n\n\t\tif ( !this.partialTemplate ) {\n\t\t\twarnOnceIfDebug( (\"Could not find template for partial '\" + (this.name) + \"'\") );\n\t\t\tthis.partialTemplate = [];\n\t\t}\n\n\t\tif ( this.inAttribute ) {\n\t\t\tdoInAttributes( function () { return this$1.fragment.resetTemplate( this$1.partialTemplate ); } );\n\t\t} else {\n\t\t\tthis.fragment.resetTemplate( this.partialTemplate );\n\t\t}\n\n\t\tthis.bubble();\n\t};\n\n\tPartial.prototype.render = function render ( target, occupants ) {\n\t\tthis.fragment.render( target, occupants );\n\t};\n\n\tPartial.prototype.setTemplate = function setTemplate ( name, template ) {\n\t\tthis.name = name;\n\n\t\tif ( !template && template !== null ) template = getPartialTemplate( this.ractive, name, this.parentFragment );\n\n\t\tif ( !template ) {\n\t\t\twarnOnceIfDebug( (\"Could not find template for partial '\" + name + \"'\") );\n\t\t}\n\n\t\tthis.partialTemplate = template || [];\n\t};\n\n\tPartial.prototype.toString = function toString ( escape ) {\n\t\treturn this.fragment.toString( escape );\n\t};\n\n\tPartial.prototype.unbind = function unbind () {\n\t\tMustache$$1.prototype.unbind.call(this);\n\t\tthis.fragment.unbind();\n\t};\n\n\tPartial.prototype.unrender = function unrender ( shouldDestroy ) {\n\t\tthis.fragment.unrender( shouldDestroy );\n\t};\n\n\tPartial.prototype.update = function update () {\n\t\tvar template;\n\n\t\tif ( this.dirty ) {\n\t\t\tthis.dirty = false;\n\n\t\t\tif ( !this.named ) {\n\t\t\t\tif ( this.model ) {\n\t\t\t\t\ttemplate = this.model.get();\n\t\t\t\t}\n\n\t\t\t\tif ( template && typeof template === 'string' && template !== this.name ) {\n\t\t\t\t\tthis.setTemplate( template );\n\t\t\t\t\tthis.fragment.resetTemplate( this.partialTemplate );\n\t\t\t\t} else if ( template && typeof template === 'object' && ( typeof template.template === 'string' || isArray( template.t ) ) ) {\n\t\t\t\t\tif ( template.t !== this.source && template.template !== this.source ) {\n\t\t\t\t\t\tif ( template.template ) {\n\t\t\t\t\t\t\tthis.source = template.template;\n\t\t\t\t\t\t\ttemplate = parsePartial( this.name, template.template, this.ractive );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.source = template.t;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.setTemplate( this.name, template.t );\n\t\t\t\t\t\tthis.fragment.resetTemplate( this.partialTemplate );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.fragment.update();\n\t\t}\n\t};\n\n\treturn Partial;\n}(Mustache));\n\nfunction parsePartial( name, partial, ractive ) {\n\tvar parsed;\n\n\ttry {\n\t\tparsed = parser.parse( partial, parser.getParseOptions( ractive ) );\n\t} catch (e) {\n\t\twarnIfDebug( (\"Could not parse partial from expression '\" + name + \"'\\n\" + (e.message)) );\n\t}\n\n\treturn parsed || { t: [] };\n}\n\nvar RepeatedFragment = function RepeatedFragment ( options ) {\n\tthis.parent = options.owner.parentFragment;\n\n\t// bit of a hack, so reference resolution works without another\n\t// layer of indirection\n\tthis.parentFragment = this;\n\tthis.owner = options.owner;\n\tthis.ractive = this.parent.ractive;\n\n\t// encapsulated styles should be inherited until they get applied by an element\n\tthis.cssIds = 'cssIds' in options ? options.cssIds : ( this.parent ? this.parent.cssIds : null );\n\n\tthis.context = null;\n\tthis.rendered = false;\n\tthis.iterations = [];\n\n\tthis.template = options.template;\n\n\tthis.indexRef = options.indexRef;\n\tthis.keyRef = options.keyRef;\n\n\tthis.pendingNewIndices = null;\n\tthis.previousIterations = null;\n\n\t// track array versus object so updates of type rest\n\tthis.isArray = false;\n};\n\nRepeatedFragment.prototype.bind = function bind ( context ) {\n\tvar this$1 = this;\n\n\t\tthis.context = context;\n\tvar value = context.get();\n\n\t// {{#each array}}...\n\tif ( this.isArray = isArray( value ) ) {\n\t\t// we can't use map, because of sparse arrays\n\t\tthis.iterations = [];\n\t\tvar max = value.length;\n\t\tfor ( var i = 0; i < max; i += 1 ) {\n\t\t\tthis$1.iterations[i] = this$1.createIteration( i, i );\n\t\t}\n\t}\n\n\t// {{#each object}}...\n\telse if ( isObject( value ) ) {\n\t\tthis.isArray = false;\n\n\t\t// TODO this is a dreadful hack. There must be a neater way\n\t\tif ( this.indexRef ) {\n\t\t\tvar refs = this.indexRef.split( ',' );\n\t\t\tthis.keyRef = refs[0];\n\t\t\tthis.indexRef = refs[1];\n\t\t}\n\n\t\tthis.iterations = Object.keys( value ).map( function ( key, index ) {\n\t\t\treturn this$1.createIteration( key, index );\n\t\t});\n\t}\n\n\treturn this;\n};\n\nRepeatedFragment.prototype.bubble = function bubble () {\n\tthis.owner.bubble();\n};\n\nRepeatedFragment.prototype.createIteration = function createIteration ( key, index ) {\n\tvar fragment = new Fragment({\n\t\towner: this,\n\t\ttemplate: this.template\n\t});\n\n\t// TODO this is a bit hacky\n\tfragment.key = key;\n\tfragment.index = index;\n\tfragment.isIteration = true;\n\n\tvar model = this.context.joinKey( key );\n\n\t// set up an iteration alias if there is one\n\tif ( this.owner.template.z ) {\n\t\tfragment.aliases = {};\n\t\tfragment.aliases[ this.owner.template.z[0].n ] = model;\n\t}\n\n\treturn fragment.bind( model );\n};\n\nRepeatedFragment.prototype.destroyed = function destroyed () {\n\tthis.iterations.forEach( function ( i ) { return i.destroyed(); } );\n};\n\nRepeatedFragment.prototype.detach = function detach () {\n\tvar docFrag = createDocumentFragment();\n\tthis.iterations.forEach( function ( fragment ) { return docFrag.appendChild( fragment.detach() ); } );\n\treturn docFrag;\n};\n\nRepeatedFragment.prototype.find = function find ( selector ) {\n\tvar this$1 = this;\n\n\t\tvar len = this.iterations.length;\n\tvar i;\n\n\tfor ( i = 0; i < len; i += 1 ) {\n\t\tvar found = this$1.iterations[i].find( selector );\n\t\tif ( found ) return found;\n\t}\n};\n\nRepeatedFragment.prototype.findAll = function findAll ( selector, query ) {\n\tvar this$1 = this;\n\n\t\tvar len = this.iterations.length;\n\tvar i;\n\n\tfor ( i = 0; i < len; i += 1 ) {\n\t\tthis$1.iterations[i].findAll( selector, query );\n\t}\n};\n\nRepeatedFragment.prototype.findComponent = function findComponent ( name ) {\n\tvar this$1 = this;\n\n\t\tvar len = this.iterations.length;\n\tvar i;\n\n\tfor ( i = 0; i < len; i += 1 ) {\n\t\tvar found = this$1.iterations[i].findComponent( name );\n\t\tif ( found ) return found;\n\t}\n};\n\nRepeatedFragment.prototype.findAllComponents = function findAllComponents ( name, query ) {\n\tvar this$1 = this;\n\n\t\tvar len = this.iterations.length;\n\tvar i;\n\n\tfor ( i = 0; i < len; i += 1 ) {\n\t\tthis$1.iterations[i].findAllComponents( name, query );\n\t}\n};\n\nRepeatedFragment.prototype.findNextNode = function findNextNode ( iteration ) {\n\tvar this$1 = this;\n\n\t\tif ( iteration.index < this.iterations.length - 1 ) {\n\t\tfor ( var i = iteration.index + 1; i < this$1.iterations.length; i++ ) {\n\t\t\tvar node = this$1.iterations[ i ].firstNode( true );\n\t\t\tif ( node ) return node;\n\t\t}\n\t}\n\n\treturn this.owner.findNextNode();\n};\n\nRepeatedFragment.prototype.firstNode = function firstNode ( skipParent ) {\n\treturn this.iterations[0] ? this.iterations[0].firstNode( skipParent ) : null;\n};\n\nRepeatedFragment.prototype.rebinding = function rebinding ( next ) {\n\tvar this$1 = this;\n\n\t\tthis.context = next;\n\tthis.iterations.forEach( function ( fragment ) {\n\t\tvar model = next ? next.joinKey( fragment.key || fragment.index ) : undefined;\n\t\tfragment.context = model;\n\t\tif ( this$1.owner.template.z ) {\n\t\t\tfragment.aliases = {};\n\t\t\tfragment.aliases[ this$1.owner.template.z[0].n ] = model;\n\t\t}\n\t});\n};\n\nRepeatedFragment.prototype.render = function render ( target, occupants ) {\n\t// TODO use docFrag.cloneNode...\n\n\tif ( this.iterations ) {\n\t\tthis.iterations.forEach( function ( fragment ) { return fragment.render( target, occupants ); } );\n\t}\n\n\tthis.rendered = true;\n};\n\nRepeatedFragment.prototype.shuffle = function shuffle ( newIndices ) {\n\tvar this$1 = this;\n\n\t\tif ( !this.pendingNewIndices ) this.previousIterations = this.iterations.slice();\n\n\tif ( !this.pendingNewIndices ) this.pendingNewIndices = [];\n\n\tthis.pendingNewIndices.push( newIndices );\n\n\tvar iterations = [];\n\n\tnewIndices.forEach( function ( newIndex, oldIndex ) {\n\t\tif ( newIndex === -1 ) return;\n\n\t\tvar fragment = this$1.iterations[ oldIndex ];\n\t\titerations[ newIndex ] = fragment;\n\n\t\tif ( newIndex !== oldIndex && fragment ) fragment.dirty = true;\n\t});\n\n\tthis.iterations = iterations;\n\n\tthis.bubble();\n};\n\nRepeatedFragment.prototype.shuffled = function shuffled () {\n\tthis.iterations.forEach( function ( i ) { return i.shuffled(); } );\n};\n\nRepeatedFragment.prototype.toString = function toString$1 ( escape ) {\n\treturn this.iterations ?\n\t\tthis.iterations.map( escape ? toEscapedString : toString$2 ).join( '' ) :\n\t\t'';\n};\n\nRepeatedFragment.prototype.unbind = function unbind$1 () {\n\tthis.iterations.forEach( unbind$1$1 );\n\treturn this;\n};\n\nRepeatedFragment.prototype.unrender = function unrender$1 ( shouldDestroy ) {\n\tthis.iterations.forEach( shouldDestroy ? unrenderAndDestroy : unrender$1$1 );\n\tif ( this.pendingNewIndices && this.previousIterations ) {\n\t\tthis.previousIterations.forEach( function ( fragment ) {\n\t\t\tif ( fragment.rendered ) shouldDestroy ? unrenderAndDestroy( fragment ) : unrender$1$1( fragment );\n\t\t});\n\t}\n\tthis.rendered = false;\n};\n\n// TODO smart update\nRepeatedFragment.prototype.update = function update$1 () {\n\t// skip dirty check, since this is basically just a facade\n\n\tvar this$1 = this;\n\n\t\tif ( this.pendingNewIndices ) {\n\t\tthis.updatePostShuffle();\n\t\treturn;\n\t}\n\n\tif ( this.updating ) return;\n\tthis.updating = true;\n\n\tvar value = this.context.get(),\n\t\t\t  wasArray = this.isArray;\n\n\tvar toRemove;\n\tvar oldKeys;\n\tvar reset = true;\n\tvar i;\n\n\tif ( this.isArray = isArray( value ) ) {\n\t\tif ( wasArray ) {\n\t\t\treset = false;\n\t\t\tif ( this.iterations.length > value.length ) {\n\t\t\t\ttoRemove = this.iterations.splice( value.length );\n\t\t\t}\n\t\t}\n\t} else if ( isObject( value ) && !wasArray ) {\n\t\treset = false;\n\t\ttoRemove = [];\n\t\toldKeys = {};\n\t\ti = this.iterations.length;\n\n\t\twhile ( i-- ) {\n\t\t\tvar fragment$1 = this$1.iterations[i];\n\t\t\tif ( fragment$1.key in value ) {\n\t\t\t\toldKeys[ fragment$1.key ] = true;\n\t\t\t} else {\n\t\t\t\tthis$1.iterations.splice( i, 1 );\n\t\t\t\ttoRemove.push( fragment$1 );\n\t\t\t}\n\t\t}\n\t}\n\n\tif ( reset ) {\n\t\ttoRemove = this.iterations;\n\t\tthis.iterations = [];\n\t}\n\n\tif ( toRemove ) {\n\t\ttoRemove.forEach( function ( fragment ) {\n\t\t\tfragment.unbind();\n\t\t\tfragment.unrender( true );\n\t\t});\n\t}\n\n\t// update the remaining ones\n\tthis.iterations.forEach( update$1$1 );\n\n\t// add new iterations\n\tvar newLength = isArray( value ) ?\n\t\tvalue.length :\n\t\tisObject( value ) ?\n\t\t\tObject.keys( value ).length :\n\t\t\t0;\n\n\tvar docFrag;\n\tvar fragment;\n\n\tif ( newLength > this.iterations.length ) {\n\t\tdocFrag = this.rendered ? createDocumentFragment() : null;\n\t\ti = this.iterations.length;\n\n\t\tif ( isArray( value ) ) {\n\t\t\twhile ( i < value.length ) {\n\t\t\t\tfragment = this$1.createIteration( i, i );\n\n\t\t\t\tthis$1.iterations.push( fragment );\n\t\t\t\tif ( this$1.rendered ) fragment.render( docFrag );\n\n\t\t\t\ti += 1;\n\t\t\t}\n\t\t}\n\n\t\telse if ( isObject( value ) ) {\n\t\t\t// TODO this is a dreadful hack. There must be a neater way\n\t\t\tif ( this.indexRef && !this.keyRef ) {\n\t\t\t\tvar refs = this.indexRef.split( ',' );\n\t\t\t\tthis.keyRef = refs[0];\n\t\t\t\tthis.indexRef = refs[1];\n\t\t\t}\n\n\t\t\tObject.keys( value ).forEach( function ( key ) {\n\t\t\t\tif ( !oldKeys || !( key in oldKeys ) ) {\n\t\t\t\t\tfragment = this$1.createIteration( key, i );\n\n\t\t\t\t\tthis$1.iterations.push( fragment );\n\t\t\t\t\tif ( this$1.rendered ) fragment.render( docFrag );\n\n\t\t\t\t\ti += 1;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif ( this.rendered ) {\n\t\t\tvar parentNode = this.parent.findParentNode();\n\t\t\tvar anchor = this.parent.findNextNode( this.owner );\n\n\t\t\tparentNode.insertBefore( docFrag, anchor );\n\t\t}\n\t}\n\n\tthis.updating = false;\n};\n\nRepeatedFragment.prototype.updatePostShuffle = function updatePostShuffle () {\n\tvar this$1 = this;\n\n\t\tvar newIndices = this.pendingNewIndices[ 0 ];\n\n\t// map first shuffle through\n\tthis.pendingNewIndices.slice( 1 ).forEach( function ( indices ) {\n\t\tnewIndices.forEach( function ( newIndex, oldIndex ) {\n\t\t\tnewIndices[ oldIndex ] = indices[ newIndex ];\n\t\t});\n\t});\n\n\t// This algorithm (for detaching incorrectly-ordered fragments from the DOM and\n\t// storing them in a document fragment for later reinsertion) seems a bit hokey,\n\t// but it seems to work for now\n\tvar len = this.context.get().length, oldLen = this.previousIterations.length;\n\tvar i;\n\tvar removed = {};\n\n\tnewIndices.forEach( function ( newIndex, oldIndex ) {\n\t\tvar fragment = this$1.previousIterations[ oldIndex ];\n\t\tthis$1.previousIterations[ oldIndex ] = null;\n\n\t\tif ( newIndex === -1 ) {\n\t\t\tremoved[ oldIndex ] = fragment;\n\t\t} else if ( fragment.index !== newIndex ) {\n\t\t\tvar model = this$1.context.joinKey( newIndex );\n\t\t\tfragment.index = newIndex;\n\t\t\tfragment.context = model;\n\t\t\tif ( this$1.owner.template.z ) {\n\t\t\t\tfragment.aliases = {};\n\t\t\t\tfragment.aliases[ this$1.owner.template.z[0].n ] = model;\n\t\t\t}\n\t\t}\n\t});\n\n\t// if the array was spliced outside of ractive, sometimes there are leftover fragments not in the newIndices\n\tthis.previousIterations.forEach( function ( frag, i ) {\n\t\tif ( frag ) removed[ i ] = frag;\n\t});\n\n\t// create new/move existing iterations\n\tvar docFrag = this.rendered ? createDocumentFragment() : null;\n\tvar parentNode = this.rendered ? this.parent.findParentNode() : null;\n\n\tvar contiguous = 'startIndex' in newIndices;\n\ti = contiguous ? newIndices.startIndex : 0;\n\n\tfor ( i; i < len; i++ ) {\n\t\tvar frag = this$1.iterations[i];\n\n\t\tif ( frag && contiguous ) {\n\t\t\t// attach any built-up iterations\n\t\t\tif ( this$1.rendered ) {\n\t\t\t\tif ( removed[i] ) docFrag.appendChild( removed[i].detach() );\n\t\t\t\tif ( docFrag.childNodes.length  ) parentNode.insertBefore( docFrag, frag.firstNode() );\n\t\t\t}\n\t\t\tcontinue;\n\t\t}\n\n\t\tif ( !frag ) this$1.iterations[i] = this$1.createIteration( i, i );\n\n\t\tif ( this$1.rendered ) {\n\t\t\tif ( removed[i] ) docFrag.appendChild( removed[i].detach() );\n\n\t\t\tif ( frag ) docFrag.appendChild( frag.detach() );\n\t\t\telse {\n\t\t\t\tthis$1.iterations[i].render( docFrag );\n\t\t\t}\n\t\t}\n\t}\n\n\t// append any leftovers\n\tif ( this.rendered ) {\n\t\tfor ( i = len; i < oldLen; i++ ) {\n\t\t\tif ( removed[i] ) docFrag.appendChild( removed[i].detach() );\n\t\t}\n\n\t\tif ( docFrag.childNodes.length ) {\n\t\t\tparentNode.insertBefore( docFrag, this.owner.findNextNode() );\n\t\t}\n\t}\n\n\t// trigger removal on old nodes\n\tObject.keys( removed ).forEach( function ( k ) { return removed[k].unbind().unrender( true ); } );\n\n\tthis.iterations.forEach( update$1$1 );\n\n\tthis.pendingNewIndices = null;\n\n\tthis.shuffled();\n};\n\nfunction isEmpty ( value ) {\n\treturn !value ||\n\t       ( isArray( value ) && value.length === 0 ) ||\n\t\t   ( isObject( value ) && Object.keys( value ).length === 0 );\n}\n\nfunction getType ( value, hasIndexRef ) {\n\tif ( hasIndexRef || isArray( value ) ) return SECTION_EACH;\n\tif ( isObject( value ) || typeof value === 'function' ) return SECTION_IF_WITH;\n\tif ( value === undefined ) return null;\n\treturn SECTION_IF;\n}\n\nvar Section = (function (Mustache$$1) {\n\tfunction Section ( options ) {\n\t\tMustache$$1.call( this, options );\n\n\t\tthis.sectionType = options.template.n || null;\n\t\tthis.templateSectionType = this.sectionType;\n\t\tthis.subordinate = options.template.l === 1;\n\t\tthis.fragment = null;\n\t}\n\n\tSection.prototype = Object.create( Mustache$$1 && Mustache$$1.prototype );\n\tSection.prototype.constructor = Section;\n\n\tSection.prototype.bind = function bind () {\n\t\tMustache$$1.prototype.bind.call(this);\n\n\t\tif ( this.subordinate ) {\n\t\t\tthis.sibling = this.parentFragment.items[ this.parentFragment.items.indexOf( this ) - 1 ];\n\t\t\tthis.sibling.nextSibling = this;\n\t\t}\n\n\t\t// if we managed to bind, we need to create children\n\t\tif ( this.model ) {\n\t\t\tthis.dirty = true;\n\t\t\tthis.update();\n\t\t} else if ( this.sectionType && this.sectionType === SECTION_UNLESS && ( !this.sibling || !this.sibling.isTruthy() ) ) {\n\t\t\tthis.fragment = new Fragment({\n\t\t\t\towner: this,\n\t\t\t\ttemplate: this.template.f\n\t\t\t}).bind();\n\t\t}\n\t};\n\n\tSection.prototype.destroyed = function destroyed () {\n\t\tif ( this.fragment ) this.fragment.destroyed();\n\t};\n\n\tSection.prototype.detach = function detach () {\n\t\treturn this.fragment ? this.fragment.detach() : createDocumentFragment();\n\t};\n\n\tSection.prototype.find = function find ( selector ) {\n\t\tif ( this.fragment ) {\n\t\t\treturn this.fragment.find( selector );\n\t\t}\n\t};\n\n\tSection.prototype.findAll = function findAll ( selector, query ) {\n\t\tif ( this.fragment ) {\n\t\t\tthis.fragment.findAll( selector, query );\n\t\t}\n\t};\n\n\tSection.prototype.findComponent = function findComponent ( name ) {\n\t\tif ( this.fragment ) {\n\t\t\treturn this.fragment.findComponent( name );\n\t\t}\n\t};\n\n\tSection.prototype.findAllComponents = function findAllComponents ( name, query ) {\n\t\tif ( this.fragment ) {\n\t\t\tthis.fragment.findAllComponents( name, query );\n\t\t}\n\t};\n\n\tSection.prototype.firstNode = function firstNode ( skipParent ) {\n\t\treturn this.fragment && this.fragment.firstNode( skipParent );\n\t};\n\n\tSection.prototype.isTruthy = function isTruthy () {\n\t\tif ( this.subordinate && this.sibling.isTruthy() ) return true;\n\t\tvar value = !this.model ? undefined : this.model.isRoot ? this.model.value : this.model.get();\n\t\treturn !!value && !isEmpty( value );\n\t};\n\n\tSection.prototype.rebinding = function rebinding ( next, previous, safe ) {\n\t\tif ( Mustache$$1.prototype.rebinding.call( this, next, previous, safe ) ) {\n\t\t\tif ( this.fragment && this.sectionType !== SECTION_IF && this.sectionType !== SECTION_UNLESS ) {\n\t\t\t\tthis.fragment.rebinding( next, previous );\n\t\t\t}\n\t\t}\n\t};\n\n\tSection.prototype.render = function render ( target, occupants ) {\n\t\tthis.rendered = true;\n\t\tif ( this.fragment ) this.fragment.render( target, occupants );\n\t};\n\n\tSection.prototype.shuffle = function shuffle ( newIndices ) {\n\t\tif ( this.fragment && this.sectionType === SECTION_EACH ) {\n\t\t\tthis.fragment.shuffle( newIndices );\n\t\t}\n\t};\n\n\tSection.prototype.toString = function toString ( escape ) {\n\t\treturn this.fragment ? this.fragment.toString( escape ) : '';\n\t};\n\n\tSection.prototype.unbind = function unbind () {\n\t\tMustache$$1.prototype.unbind.call(this);\n\t\tif ( this.fragment ) this.fragment.unbind();\n\t};\n\n\tSection.prototype.unrender = function unrender ( shouldDestroy ) {\n\t\tif ( this.rendered && this.fragment ) this.fragment.unrender( shouldDestroy );\n\t\tthis.rendered = false;\n\t};\n\n\tSection.prototype.update = function update () {\n\t\tif ( !this.dirty ) return;\n\n\t\tif ( this.fragment && this.sectionType !== SECTION_IF && this.sectionType !== SECTION_UNLESS ) {\n\t\t\tthis.fragment.context = this.model;\n\t\t}\n\n\t\tif ( !this.model && this.sectionType !== SECTION_UNLESS ) return;\n\n\t\tthis.dirty = false;\n\n\t\tvar value = !this.model ? undefined : this.model.isRoot ? this.model.value : this.model.get();\n\t\tvar siblingFalsey = !this.subordinate || !this.sibling.isTruthy();\n\t\tvar lastType = this.sectionType;\n\n\t\t// watch for switching section types\n\t\tif ( this.sectionType === null || this.templateSectionType === null ) this.sectionType = getType( value, this.template.i );\n\t\tif ( lastType && lastType !== this.sectionType && this.fragment ) {\n\t\t\tif ( this.rendered ) {\n\t\t\t\tthis.fragment.unbind().unrender( true );\n\t\t\t}\n\n\t\t\tthis.fragment = null;\n\t\t}\n\n\t\tvar newFragment;\n\n\t\tif ( this.sectionType === SECTION_EACH ) {\n\t\t\tif ( this.fragment ) {\n\t\t\t\tthis.fragment.update();\n\t\t\t} else {\n\t\t\t\t// TODO can this happen?\n\t\t\t\tnewFragment = new RepeatedFragment({\n\t\t\t\t\towner: this,\n\t\t\t\t\ttemplate: this.template.f,\n\t\t\t\t\tindexRef: this.template.i\n\t\t\t\t}).bind( this.model );\n\t\t\t}\n\t\t}\n\n\t\t// WITH is now IF_WITH; WITH is only used for {{>partial context}}\n\t\telse if ( this.sectionType === SECTION_WITH ) {\n\t\t\tif ( this.fragment ) {\n\t\t\t\tthis.fragment.update();\n\t\t\t} else {\n\t\t\t\tnewFragment = new Fragment({\n\t\t\t\t\towner: this,\n\t\t\t\t\ttemplate: this.template.f\n\t\t\t\t}).bind( this.model );\n\t\t\t}\n\t\t}\n\n\t\telse if ( this.sectionType === SECTION_IF_WITH ) {\n\t\t\tif ( this.fragment ) {\n\t\t\t\tif ( isEmpty( value ) ) {\n\t\t\t\t\tif ( this.rendered ) {\n\t\t\t\t\t\tthis.fragment.unbind().unrender( true );\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.fragment = null;\n\t\t\t\t} else {\n\t\t\t\t\tthis.fragment.update();\n\t\t\t\t}\n\t\t\t} else if ( !isEmpty( value ) ) {\n\t\t\t\tnewFragment = new Fragment({\n\t\t\t\t\towner: this,\n\t\t\t\t\ttemplate: this.template.f\n\t\t\t\t}).bind( this.model );\n\t\t\t}\n\t\t}\n\n\t\telse {\n\t\t\tvar fragmentShouldExist = siblingFalsey && ( this.sectionType === SECTION_UNLESS ? isEmpty( value ) : !!value && !isEmpty( value ) );\n\n\t\t\tif ( this.fragment ) {\n\t\t\t\tif ( fragmentShouldExist ) {\n\t\t\t\t\tthis.fragment.update();\n\t\t\t\t} else {\n\t\t\t\t\tif ( this.rendered ) {\n\t\t\t\t\t\tthis.fragment.unbind().unrender( true );\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.fragment = null;\n\t\t\t\t}\n\t\t\t} else if ( fragmentShouldExist ) {\n\t\t\t\tnewFragment = new Fragment({\n\t\t\t\t\towner: this,\n\t\t\t\t\ttemplate: this.template.f\n\t\t\t\t}).bind( null );\n\t\t\t}\n\t\t}\n\n\t\tif ( newFragment ) {\n\t\t\tif ( this.rendered ) {\n\t\t\t\tvar parentNode = this.parentFragment.findParentNode();\n\t\t\t\tvar anchor = this.parentFragment.findNextNode( this );\n\n\t\t\t\tif ( anchor ) {\n\t\t\t\t\tvar docFrag = createDocumentFragment();\n\t\t\t\t\tnewFragment.render( docFrag );\n\n\t\t\t\t\t// we use anchor.parentNode, not parentNode, because the sibling\n\t\t\t\t\t// may be temporarily detached as a result of a shuffle\n\t\t\t\t\tanchor.parentNode.insertBefore( docFrag, anchor );\n\t\t\t\t} else {\n\t\t\t\t\tnewFragment.render( parentNode );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.fragment = newFragment;\n\t\t}\n\n\t\tif ( this.nextSibling ) {\n\t\t\tthis.nextSibling.dirty = true;\n\t\t\tthis.nextSibling.update();\n\t\t}\n\t};\n\n\treturn Section;\n}(Mustache));\n\nfunction valueContains ( selectValue, optionValue ) {\n\tvar i = selectValue.length;\n\twhile ( i-- ) {\n\t\tif ( selectValue[i] == optionValue ) return true;\n\t}\n}\n\nvar Select = (function (Element$$1) {\n\tfunction Select ( options ) {\n\t\tElement$$1.call( this, options );\n\t\tthis.options = [];\n\t}\n\n\tSelect.prototype = Object.create( Element$$1 && Element$$1.prototype );\n\tSelect.prototype.constructor = Select;\n\n\tSelect.prototype.foundNode = function foundNode ( node ) {\n\t\tif ( this.binding ) {\n\t\t\tvar selectedOptions = getSelectedOptions( node );\n\n\t\t\tif ( selectedOptions.length > 0 ) {\n\t\t\t\tthis.selectedOptions = selectedOptions;\n\t\t\t}\n\t\t}\n\t};\n\n\tSelect.prototype.render = function render ( target, occupants ) {\n\t\tElement$$1.prototype.render.call( this, target, occupants );\n\t\tthis.sync();\n\n\t\tvar node = this.node;\n\n\t\tvar i = node.options.length;\n\t\twhile ( i-- ) {\n\t\t\tnode.options[i].defaultSelected = node.options[i].selected;\n\t\t}\n\n\t\tthis.rendered = true;\n\t};\n\n\tSelect.prototype.sync = function sync () {\n\t\tvar this$1 = this;\n\n\t\tvar selectNode = this.node;\n\n\t\tif ( !selectNode ) return;\n\n\t\tvar options = toArray( selectNode.options );\n\n\t\tif ( this.selectedOptions ) {\n\t\t\toptions.forEach( function ( o ) {\n\t\t\t\tif ( this$1.selectedOptions.indexOf( o ) >= 0 ) o.selected = true;\n\t\t\t\telse o.selected = false;\n\t\t\t});\n\t\t\tthis.binding.setFromNode( selectNode );\n\t\t\tdelete this.selectedOptions;\n\t\t\treturn;\n\t\t}\n\n\t\tvar selectValue = this.getAttribute( 'value' );\n\t\tvar isMultiple = this.getAttribute( 'multiple' );\n\n\t\t// If the <select> has a specified value, that should override\n\t\t// these options\n\t\tif ( selectValue !== undefined ) {\n\t\t\tvar optionWasSelected;\n\n\t\t\toptions.forEach( function ( o ) {\n\t\t\t\tvar optionValue = o._ractive ? o._ractive.value : o.value;\n\t\t\t\tvar shouldSelect = isMultiple ? valueContains( selectValue, optionValue ) : selectValue == optionValue;\n\n\t\t\t\tif ( shouldSelect ) {\n\t\t\t\t\toptionWasSelected = true;\n\t\t\t\t}\n\n\t\t\t\to.selected = shouldSelect;\n\t\t\t});\n\n\t\t\tif ( !optionWasSelected && !isMultiple ) {\n\t\t\t\tif ( this.binding ) {\n\t\t\t\t\tthis.binding.forceUpdate();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Otherwise the value should be initialised according to which\n\t\t// <option> element is selected, if twoway binding is in effect\n\t\telse if ( this.binding ) {\n\t\t\tthis.binding.forceUpdate();\n\t\t}\n\t};\n\n\tSelect.prototype.update = function update () {\n\t\tElement$$1.prototype.update.call(this);\n\t\tthis.sync();\n\t};\n\n\treturn Select;\n}(Element));\n\nvar Textarea = (function (Input$$1) {\n\tfunction Textarea( options ) {\n\t\tvar template = options.template;\n\n\t\toptions.deferContent = true;\n\n\t\tInput$$1.call( this, options );\n\n\t\t// check for single interpolator binding\n\t\tif ( !this.attributeByName.value ) {\n\t\t\tif ( template.f && isBindable( { template: template } ) ) {\n\t\t\t\tthis.attributes.push( createItem( {\n\t\t\t\t\towner: this,\n\t\t\t\t\ttemplate: { t: ATTRIBUTE, f: template.f, n: 'value' },\n\t\t\t\t\tparentFragment: this.parentFragment\n\t\t\t\t} ) );\n\t\t\t} else {\n\t\t\t\tthis.fragment = new Fragment({ owner: this, cssIds: null, template: template.f });\n\t\t\t}\n\t\t}\n\t}\n\n\tTextarea.prototype = Object.create( Input$$1 && Input$$1.prototype );\n\tTextarea.prototype.constructor = Textarea;\n\n\tTextarea.prototype.bubble = function bubble () {\n\t\tvar this$1 = this;\n\n\t\tif ( !this.dirty ) {\n\t\t\tthis.dirty = true;\n\n\t\t\tif ( this.rendered && !this.binding && this.fragment ) {\n\t\t\t\trunloop.scheduleTask( function () {\n\t\t\t\t\tthis$1.dirty = false;\n\t\t\t\t\tthis$1.node.value = this$1.fragment.toString();\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.parentFragment.bubble(); // default behaviour\n\t\t}\n\t};\n\n\treturn Textarea;\n}(Input));\n\nvar Text = (function (Item$$1) {\n\tfunction Text ( options ) {\n\t\tItem$$1.call( this, options );\n\t\tthis.type = TEXT;\n\t}\n\n\tText.prototype = Object.create( Item$$1 && Item$$1.prototype );\n\tText.prototype.constructor = Text;\n\n\tText.prototype.bind = function bind () {\n\t\t// noop\n\t};\n\n\tText.prototype.detach = function detach () {\n\t\treturn detachNode( this.node );\n\t};\n\n\tText.prototype.firstNode = function firstNode () {\n\t\treturn this.node;\n\t};\n\n\tText.prototype.render = function render ( target, occupants ) {\n\t\tif ( inAttributes() ) return;\n\t\tthis.rendered = true;\n\n\t\tif ( occupants ) {\n\t\t\tvar n = occupants[0];\n\t\t\tif ( n && n.nodeType === 3 ) {\n\t\t\t\toccupants.shift();\n\t\t\t\tif ( n.nodeValue !== this.template ) {\n\t\t\t\t\tn.nodeValue = this.template;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tn = this.node = doc.createTextNode( this.template );\n\t\t\t\tif ( occupants[0] ) {\n\t\t\t\t\ttarget.insertBefore( n, occupants[0] );\n\t\t\t\t} else {\n\t\t\t\t\ttarget.appendChild( n );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.node = n;\n\t\t} else {\n\t\t\tthis.node = doc.createTextNode( this.template );\n\t\t\ttarget.appendChild( this.node );\n\t\t}\n\t};\n\n\tText.prototype.toString = function toString ( escape ) {\n\t\treturn escape ? escapeHtml( this.template ) : this.template;\n\t};\n\n\tText.prototype.unbind = function unbind () {\n\t\t// noop\n\t};\n\n\tText.prototype.unrender = function unrender ( shouldDestroy ) {\n\t\tif ( this.rendered && shouldDestroy ) this.detach();\n\t\tthis.rendered = false;\n\t};\n\n\tText.prototype.update = function update () {\n\t\t// noop\n\t};\n\n\tText.prototype.valueOf = function valueOf () {\n\t\treturn this.template;\n\t};\n\n\treturn Text;\n}(Item));\n\nvar prefix;\n\nif ( !isClient ) {\n\tprefix = null;\n} else {\n\tvar prefixCache = {};\n\tvar testStyle = createElement( 'div' ).style;\n\n\tprefix = function ( prop ) {\n\t\tprop = camelCase( prop );\n\n\t\tif ( !prefixCache[ prop ] ) {\n\t\t\tif ( testStyle[ prop ] !== undefined ) {\n\t\t\t\tprefixCache[ prop ] = prop;\n\t\t\t}\n\n\t\t\telse {\n\t\t\t\t// test vendors...\n\t\t\t\tvar capped = prop.charAt( 0 ).toUpperCase() + prop.substring( 1 );\n\n\t\t\t\tvar i = vendors.length;\n\t\t\t\twhile ( i-- ) {\n\t\t\t\t\tvar vendor = vendors[i];\n\t\t\t\t\tif ( testStyle[ vendor + capped ] !== undefined ) {\n\t\t\t\t\t\tprefixCache[ prop ] = vendor + capped;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn prefixCache[ prop ];\n\t};\n}\n\nvar prefix$1 = prefix;\n\nvar visible;\nvar hidden = 'hidden';\n\nif ( doc ) {\n\tvar prefix$2;\n\n\tif ( hidden in doc ) {\n\t\tprefix$2 = '';\n\t} else {\n\t\tvar i$1 = vendors.length;\n\t\twhile ( i$1-- ) {\n\t\t\tvar vendor = vendors[i$1];\n\t\t\thidden = vendor + 'Hidden';\n\n\t\t\tif ( hidden in doc ) {\n\t\t\t\tprefix$2 = vendor;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tif ( prefix$2 !== undefined ) {\n\t\tdoc.addEventListener( prefix$2 + 'visibilitychange', onChange );\n\t\tonChange();\n\t} else {\n\t\t// gah, we're in an old browser\n\t\tif ( 'onfocusout' in doc ) {\n\t\t\tdoc.addEventListener( 'focusout', onHide );\n\t\t\tdoc.addEventListener( 'focusin', onShow );\n\t\t}\n\n\t\telse {\n\t\t\twin.addEventListener( 'pagehide', onHide );\n\t\t\twin.addEventListener( 'blur', onHide );\n\n\t\t\twin.addEventListener( 'pageshow', onShow );\n\t\t\twin.addEventListener( 'focus', onShow );\n\t\t}\n\n\t\tvisible = true; // until proven otherwise. Not ideal but hey\n\t}\n}\n\nfunction onChange () {\n\tvisible = !doc[ hidden ];\n}\n\nfunction onHide () {\n\tvisible = false;\n}\n\nfunction onShow () {\n\tvisible = true;\n}\n\nvar unprefixPattern = new RegExp( '^-(?:' + vendors.join( '|' ) + ')-' );\n\nvar unprefix = function ( prop ) {\n\treturn prop.replace( unprefixPattern, '' );\n};\n\nvar vendorPattern = new RegExp( '^(?:' + vendors.join( '|' ) + ')([A-Z])' );\n\nvar hyphenate = function ( str ) {\n\tif ( !str ) return ''; // edge case\n\n\tif ( vendorPattern.test( str ) ) str = '-' + str;\n\n\treturn str.replace( /[A-Z]/g, function ( match ) { return '-' + match.toLowerCase(); } );\n};\n\nvar createTransitions;\n\nif ( !isClient ) {\n\tcreateTransitions = null;\n} else {\n\tvar testStyle$1 = createElement( 'div' ).style;\n\tvar linear$1 = function ( x ) { return x; };\n\n\tvar canUseCssTransitions = {};\n\tvar cannotUseCssTransitions = {};\n\n\t// determine some facts about our environment\n\tvar TRANSITION$1;\n\tvar TRANSITIONEND;\n\tvar CSS_TRANSITIONS_ENABLED;\n\tvar TRANSITION_DURATION;\n\tvar TRANSITION_PROPERTY;\n\tvar TRANSITION_TIMING_FUNCTION;\n\n\tif ( testStyle$1.transition !== undefined ) {\n\t\tTRANSITION$1 = 'transition';\n\t\tTRANSITIONEND = 'transitionend';\n\t\tCSS_TRANSITIONS_ENABLED = true;\n\t} else if ( testStyle$1.webkitTransition !== undefined ) {\n\t\tTRANSITION$1 = 'webkitTransition';\n\t\tTRANSITIONEND = 'webkitTransitionEnd';\n\t\tCSS_TRANSITIONS_ENABLED = true;\n\t} else {\n\t\tCSS_TRANSITIONS_ENABLED = false;\n\t}\n\n\tif ( TRANSITION$1 ) {\n\t\tTRANSITION_DURATION = TRANSITION$1 + 'Duration';\n\t\tTRANSITION_PROPERTY = TRANSITION$1 + 'Property';\n\t\tTRANSITION_TIMING_FUNCTION = TRANSITION$1 + 'TimingFunction';\n\t}\n\n\tcreateTransitions = function ( t, to, options, changedProperties, resolve ) {\n\n\t\t// Wait a beat (otherwise the target styles will be applied immediately)\n\t\t// TODO use a fastdom-style mechanism?\n\t\tsetTimeout( function () {\n\t\t\tvar jsTransitionsComplete;\n\t\t\tvar cssTransitionsComplete;\n\t\t\tvar cssTimeout;\n\n\t\t\tfunction transitionDone () { clearTimeout( cssTimeout ); }\n\n\t\t\tfunction checkComplete () {\n\t\t\t\tif ( jsTransitionsComplete && cssTransitionsComplete ) {\n\t\t\t\t\tt.unregisterCompleteHandler( transitionDone );\n\t\t\t\t\t// will changes to events and fire have an unexpected consequence here?\n\t\t\t\t\tt.ractive.fire( t.name + ':end', t.node, t.isIntro );\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// this is used to keep track of which elements can use CSS to animate\n\t\t\t// which properties\n\t\t\tvar hashPrefix = ( t.node.namespaceURI || '' ) + t.node.tagName;\n\n\t\t\t// need to reset transition properties\n\t\t\tvar style = t.node.style;\n\t\t\tvar previous = {\n\t\t\t\tproperty: style[ TRANSITION_PROPERTY ],\n\t\t\t\ttiming: style[ TRANSITION_TIMING_FUNCTION ],\n\t\t\t\tduration: style[ TRANSITION_DURATION ]\n\t\t\t};\n\n\t\t\tstyle[ TRANSITION_PROPERTY ] = changedProperties.map( prefix$1 ).map( hyphenate ).join( ',' );\n\t\t\tstyle[ TRANSITION_TIMING_FUNCTION ] = hyphenate( options.easing || 'linear' );\n\t\t\tstyle[ TRANSITION_DURATION ] = ( options.duration / 1000 ) + 's';\n\n\t\t\tfunction transitionEndHandler ( event ) {\n\t\t\t\tvar index = changedProperties.indexOf( camelCase( unprefix( event.propertyName ) ) );\n\n\t\t\t\tif ( index !== -1 ) {\n\t\t\t\t\tchangedProperties.splice( index, 1 );\n\t\t\t\t}\n\n\t\t\t\tif ( changedProperties.length ) {\n\t\t\t\t\t// still transitioning...\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tclearTimeout( cssTimeout );\n\t\t\t\tcssTransitionsDone();\n\t\t\t}\n\n\t\t\tfunction cssTransitionsDone () {\n\t\t\t\tstyle[ TRANSITION_PROPERTY ] = previous.property;\n\t\t\t\tstyle[ TRANSITION_TIMING_FUNCTION ] = previous.duration;\n\t\t\t\tstyle[ TRANSITION_DURATION ] = previous.timing;\n\n\t\t\t\tt.node.removeEventListener( TRANSITIONEND, transitionEndHandler, false );\n\n\t\t\t\tcssTransitionsComplete = true;\n\t\t\t\tcheckComplete();\n\t\t\t}\n\n\t\t\tt.node.addEventListener( TRANSITIONEND, transitionEndHandler, false );\n\n\t\t\t// safety net in case transitionend never fires\n\t\t\tcssTimeout = setTimeout( function () {\n\t\t\t\tchangedProperties = [];\n\t\t\t\tcssTransitionsDone();\n\t\t\t}, options.duration + ( options.delay || 0 ) + 50 );\n\t\t\tt.registerCompleteHandler( transitionDone );\n\n\t\t\tsetTimeout( function () {\n\t\t\t\tvar i = changedProperties.length;\n\t\t\t\tvar hash;\n\t\t\t\tvar originalValue;\n\t\t\t\tvar index;\n\t\t\t\tvar propertiesToTransitionInJs = [];\n\t\t\t\tvar prop;\n\t\t\t\tvar suffix;\n\t\t\t\tvar interpolator;\n\n\t\t\t\twhile ( i-- ) {\n\t\t\t\t\tprop = changedProperties[i];\n\t\t\t\t\thash = hashPrefix + prop;\n\n\t\t\t\t\tif ( CSS_TRANSITIONS_ENABLED && !cannotUseCssTransitions[ hash ] ) {\n\t\t\t\t\t\tstyle[ prefix$1( prop ) ] = to[ prop ];\n\n\t\t\t\t\t\t// If we're not sure if CSS transitions are supported for\n\t\t\t\t\t\t// this tag/property combo, find out now\n\t\t\t\t\t\tif ( !canUseCssTransitions[ hash ] ) {\n\t\t\t\t\t\t\toriginalValue = t.getStyle( prop );\n\n\t\t\t\t\t\t\t// if this property is transitionable in this browser,\n\t\t\t\t\t\t\t// the current style will be different from the target style\n\t\t\t\t\t\t\tcanUseCssTransitions[ hash ] = ( t.getStyle( prop ) != to[ prop ] );\n\t\t\t\t\t\t\tcannotUseCssTransitions[ hash ] = !canUseCssTransitions[ hash ];\n\n\t\t\t\t\t\t\t// Reset, if we're going to use timers after all\n\t\t\t\t\t\t\tif ( cannotUseCssTransitions[ hash ] ) {\n\t\t\t\t\t\t\t\tstyle[ prefix$1( prop ) ] = originalValue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( !CSS_TRANSITIONS_ENABLED || cannotUseCssTransitions[ hash ] ) {\n\t\t\t\t\t\t// we need to fall back to timer-based stuff\n\t\t\t\t\t\tif ( originalValue === undefined ) {\n\t\t\t\t\t\t\toriginalValue = t.getStyle( prop );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// need to remove this from changedProperties, otherwise transitionEndHandler\n\t\t\t\t\t\t// will get confused\n\t\t\t\t\t\tindex = changedProperties.indexOf( prop );\n\t\t\t\t\t\tif ( index === -1 ) {\n\t\t\t\t\t\t\twarnIfDebug( 'Something very strange happened with transitions. Please raise an issue at https://github.com/ractivejs/ractive/issues - thanks!', { node: t.node });\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tchangedProperties.splice( index, 1 );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// TODO Determine whether this property is animatable at all\n\n\t\t\t\t\t\tsuffix = /[^\\d]*$/.exec( to[ prop ] )[0];\n\t\t\t\t\t\tinterpolator = interpolate( parseFloat( originalValue ), parseFloat( to[ prop ] ) ) || ( function () { return to[ prop ]; } );\n\n\t\t\t\t\t\t// ...then kick off a timer-based transition\n\t\t\t\t\t\tpropertiesToTransitionInJs.push({\n\t\t\t\t\t\t\tname: prefix$1( prop ),\n\t\t\t\t\t\t\tinterpolator: interpolator,\n\t\t\t\t\t\t\tsuffix: suffix\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// javascript transitions\n\t\t\t\tif ( propertiesToTransitionInJs.length ) {\n\t\t\t\t\tvar easing;\n\n\t\t\t\t\tif ( typeof options.easing === 'string' ) {\n\t\t\t\t\t\teasing = t.ractive.easing[ options.easing ];\n\n\t\t\t\t\t\tif ( !easing ) {\n\t\t\t\t\t\t\twarnOnceIfDebug( missingPlugin( options.easing, 'easing' ) );\n\t\t\t\t\t\t\teasing = linear$1;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if ( typeof options.easing === 'function' ) {\n\t\t\t\t\t\teasing = options.easing;\n\t\t\t\t\t} else {\n\t\t\t\t\t\teasing = linear$1;\n\t\t\t\t\t}\n\n\t\t\t\t\tnew Ticker({\n\t\t\t\t\t\tduration: options.duration,\n\t\t\t\t\t\teasing: easing,\n\t\t\t\t\t\tstep: function ( pos ) {\n\t\t\t\t\t\t\tvar i = propertiesToTransitionInJs.length;\n\t\t\t\t\t\t\twhile ( i-- ) {\n\t\t\t\t\t\t\t\tvar prop = propertiesToTransitionInJs[i];\n\t\t\t\t\t\t\t\tt.node.style[ prop.name ] = prop.interpolator( pos ) + prop.suffix;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcomplete: function () {\n\t\t\t\t\t\t\tjsTransitionsComplete = true;\n\t\t\t\t\t\t\tcheckComplete();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tjsTransitionsComplete = true;\n\t\t\t\t}\n\n\t\t\t\tif ( !changedProperties.length ) {\n\t\t\t\t\t// We need to cancel the transitionEndHandler, and deal with\n\t\t\t\t\t// the fact that it will never fire\n\t\t\t\t\tt.node.removeEventListener( TRANSITIONEND, transitionEndHandler, false );\n\t\t\t\t\tcssTransitionsComplete = true;\n\t\t\t\t\tcheckComplete();\n\t\t\t\t}\n\t\t\t}, 0 );\n\t\t}, options.delay || 0 );\n\t};\n}\n\nvar createTransitions$1 = createTransitions;\n\nfunction resetStyle ( node, style ) {\n\tif ( style ) {\n\t\tnode.setAttribute( 'style', style );\n\t} else {\n\t\t// Next line is necessary, to remove empty style attribute!\n\t\t// See http://stackoverflow.com/a/7167553\n\t\tnode.getAttribute( 'style' );\n\t\tnode.removeAttribute( 'style' );\n\t}\n}\n\nvar getComputedStyle = win && ( win.getComputedStyle || legacy.getComputedStyle );\nvar resolved$1 = Promise$1.resolve();\n\nvar names = {\n\tt0: 'intro-outro',\n\tt1: 'intro',\n\tt2: 'outro'\n};\n\nvar Transition = function Transition ( options ) {\n\tthis.owner = options.owner || options.parentFragment.owner || findElement( options.parentFragment );\n\tthis.element = this.owner.attributeByName ? this.owner : findElement( options.parentFragment );\n\tthis.ractive = this.owner.ractive;\n\tthis.template = options.template;\n\tthis.parentFragment = options.parentFragment;\n\tthis.options = options;\n\tthis.onComplete = [];\n};\n\nTransition.prototype.animateStyle = function animateStyle ( style, value, options ) {\n\tvar this$1 = this;\n\n\t\tif ( arguments.length === 4 ) {\n\t\tthrow new Error( 't.animateStyle() returns a promise - use .then() instead of passing a callback' );\n\t}\n\n\t// Special case - page isn't visible. Don't animate anything, because\n\t// that way you'll never get CSS transitionend events\n\tif ( !visible ) {\n\t\tthis.setStyle( style, value );\n\t\treturn resolved$1;\n\t}\n\n\tvar to;\n\n\tif ( typeof style === 'string' ) {\n\t\tto = {};\n\t\tto[ style ] = value;\n\t} else {\n\t\tto = style;\n\n\t\t// shuffle arguments\n\t\toptions = value;\n\t}\n\n\t// As of 0.3.9, transition authors should supply an `option` object with\n\t// `duration` and `easing` properties (and optional `delay`), plus a\n\t// callback function that gets called after the animation completes\n\n\t// TODO remove this check in a future version\n\tif ( !options ) {\n\t\twarnOnceIfDebug( 'The \"%s\" transition does not supply an options object to `t.animateStyle()`. This will break in a future version of Ractive. For more info see https://github.com/RactiveJS/Ractive/issues/340', this.name );\n\t\toptions = this;\n\t}\n\n\treturn new Promise$1( function ( fulfil ) {\n\t\t// Edge case - if duration is zero, set style synchronously and complete\n\t\tif ( !options.duration ) {\n\t\t\tthis$1.setStyle( to );\n\t\t\tfulfil();\n\t\t\treturn;\n\t\t}\n\n\t\t// Get a list of the properties we're animating\n\t\tvar propertyNames = Object.keys( to );\n\t\tvar changedProperties = [];\n\n\t\t// Store the current styles\n\t\tvar computedStyle = getComputedStyle( this$1.owner.node );\n\n\t\tvar i = propertyNames.length;\n\t\twhile ( i-- ) {\n\t\t\tvar prop = propertyNames[i];\n\t\t\tvar current = computedStyle[ prefix$1( prop ) ];\n\n\t\t\tif ( current === '0px' ) current = 0;\n\n\t\t\t// we need to know if we're actually changing anything\n\t\t\tif ( current != to[ prop ] ) { // use != instead of !==, so we can compare strings with numbers\n\t\t\t\tchangedProperties.push( prop );\n\n\t\t\t\t// make the computed style explicit, so we can animate where\n\t\t\t\t// e.g. height='auto'\n\t\t\t\tthis$1.owner.node.style[ prefix$1( prop ) ] = current;\n\t\t\t}\n\t\t}\n\n\t\t// If we're not actually changing anything, the transitionend event\n\t\t// will never fire! So we complete early\n\t\tif ( !changedProperties.length ) {\n\t\t\tfulfil();\n\t\t\treturn;\n\t\t}\n\n\t\tcreateTransitions$1( this$1, to, options, changedProperties, fulfil );\n\t});\n};\n\nTransition.prototype.bind = function bind () {\n\tvar this$1 = this;\n\n\t\tvar options = this.options;\n\tif ( options.template ) {\n\t\tif ( options.template.v === 't0' || options.template.v == 't1' ) this.element._introTransition = this;\n\t\tif ( options.template.v === 't0' || options.template.v == 't2' ) this.element._outroTransition = this;\n\t\tthis.eventName = names[ options.template.v ];\n\t}\n\n\tvar ractive = this.owner.ractive;\n\n\tif ( options.name ) {\n\t\tthis.name = options.name;\n\t} else {\n\t\tvar name = options.template.f;\n\t\tif ( typeof name.n === 'string' ) name = name.n;\n\n\t\tif ( typeof name !== 'string' ) {\n\t\t\tvar fragment = new Fragment({\n\t\t\t\towner: this.owner,\n\t\t\t\ttemplate: name.n\n\t\t\t}).bind(); // TODO need a way to capture values without bind()\n\n\t\t\tname = fragment.toString();\n\t\t\tfragment.unbind();\n\n\t\t\tif ( name === '' ) {\n\t\t\t\t// empty string okay, just no transition\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tthis.name = name;\n\t}\n\n\tif ( options.params ) {\n\t\tthis.params = options.params;\n\t} else {\n\t\tif ( options.template.f.a && !options.template.f.a.s ) {\n\t\t\tthis.params = options.template.f.a;\n\t\t}\n\n\t\telse if ( options.template.f.d ) {\n\t\t\t// TODO is there a way to interpret dynamic arguments without all the\n\t\t\t// 'dependency thrashing'?\n\t\t\tvar fragment$1 = new Fragment({\n\t\t\t\towner: this.owner,\n\t\t\t\ttemplate: options.template.f.d\n\t\t\t}).bind();\n\n\t\t\tthis.params = fragment$1.getArgsList();\n\t\t\tfragment$1.unbind();\n\t\t}\n\t}\n\n\tif ( typeof this.name === 'function' ) {\n\t\tthis._fn = this.name;\n\t\tthis.name = this._fn.name;\n\t} else {\n\t\tthis._fn = findInViewHierarchy( 'transitions', ractive, this.name );\n\t}\n\n\tif ( !this._fn ) {\n\t\twarnOnceIfDebug( missingPlugin( this.name, 'transition' ), { ractive: ractive });\n\t}\n\n\t// TODO: dry up after deprecation is done\n\tif ( options.template && this.template.f.a && this.template.f.a.s ) {\n\t\tthis.resolvers = [];\n\t\tthis.models = this.template.f.a.r.map( function ( ref, i ) {\n\t\t\tvar resolver;\n\t\t\tvar model = resolveReference( this$1.parentFragment, ref );\n\t\t\tif ( !model ) {\n\t\t\t\tresolver = this$1.parentFragment.resolve( ref, function ( model ) {\n\t\t\t\t\tthis$1.models[i] = model;\n\t\t\t\t\tremoveFromArray( this$1.resolvers, resolver );\n\t\t\t\t\tmodel.register( this$1 );\n\t\t\t\t});\n\n\t\t\t\tthis$1.resolvers.push( resolver );\n\t\t\t} else model.register( this$1 );\n\n\t\t\treturn model;\n\t\t});\n\t\tthis.argsFn = getFunction( this.template.f.a.s, this.template.f.a.r.length );\n\t}\n};\n\nTransition.prototype.destroyed = function destroyed () {};\n\nTransition.prototype.getStyle = function getStyle ( props ) {\n\tvar computedStyle = getComputedStyle( this.owner.node );\n\n\tif ( typeof props === 'string' ) {\n\t\tvar value = computedStyle[ prefix$1( props ) ];\n\t\treturn value === '0px' ? 0 : value;\n\t}\n\n\tif ( !isArray( props ) ) {\n\t\tthrow new Error( 'Transition$getStyle must be passed a string, or an array of strings representing CSS properties' );\n\t}\n\n\tvar styles = {};\n\n\tvar i = props.length;\n\twhile ( i-- ) {\n\t\tvar prop = props[i];\n\t\tvar value$1 = computedStyle[ prefix$1( prop ) ];\n\n\t\tif ( value$1 === '0px' ) value$1 = 0;\n\t\tstyles[ prop ] = value$1;\n\t}\n\n\treturn styles;\n};\n\nTransition.prototype.processParams = function processParams ( params, defaults ) {\n\tif ( typeof params === 'number' ) {\n\t\tparams = { duration: params };\n\t}\n\n\telse if ( typeof params === 'string' ) {\n\t\tif ( params === 'slow' ) {\n\t\t\tparams = { duration: 600 };\n\t\t} else if ( params === 'fast' ) {\n\t\t\tparams = { duration: 200 };\n\t\t} else {\n\t\t\tparams = { duration: 400 };\n\t\t}\n\t} else if ( !params ) {\n\t\tparams = {};\n\t}\n\n\treturn extend$1( {}, defaults, params );\n};\n\nTransition.prototype.rebinding = function rebinding ( next, previous ) {\n\tvar idx = this.models.indexOf( previous );\n\tif ( !~idx ) return;\n\n\tnext = rebindMatch( this.template.f.a.r[ idx ], next, previous );\n\tif ( next === previous ) return;\n\n\tprevious.unregister( this );\n\tthis.models.splice( idx, 1, next );\n\tif ( next ) next.addShuffleRegister( this, 'mark' );\n};\n\nTransition.prototype.registerCompleteHandler = function registerCompleteHandler ( fn ) {\n\taddToArray( this.onComplete, fn );\n};\n\nTransition.prototype.render = function render () {};\n\nTransition.prototype.setStyle = function setStyle ( style, value ) {\n\tif ( typeof style === 'string' ) {\n\t\tthis.owner.node.style[ prefix$1( style ) ] = value;\n\t}\n\n\telse {\n\t\tvar prop;\n\t\tfor ( prop in style ) {\n\t\t\tif ( style.hasOwnProperty( prop ) ) {\n\t\t\t\tthis.owner.node.style[ prefix$1( prop ) ] = style[ prop ];\n\t\t\t}\n\t\t}\n\t}\n\n\treturn this;\n};\n\nTransition.prototype.start = function start () {\n\tvar this$1 = this;\n\n\t\tvar node = this.node = this.element.node;\n\tvar originalStyle = node.getAttribute( 'style' );\n\n\tvar completed;\n\tvar args = this.params;\n\n\t// create t.complete() - we don't want this on the prototype,\n\t// because we don't want `this` silliness when passing it as\n\t// an argument\n\tthis.complete = function ( noReset ) {\n\t\tif ( completed ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis$1.onComplete.forEach( function ( fn ) { return fn(); } );\n\t\tif ( !noReset && this$1.isIntro ) {\n\t\t\tresetStyle( node, originalStyle);\n\t\t}\n\n\t\tthis$1._manager.remove( this$1 );\n\n\t\tcompleted = true;\n\t};\n\n\t// If the transition function doesn't exist, abort\n\tif ( !this._fn ) {\n\t\tthis.complete();\n\t\treturn;\n\t}\n\n\t// get expression args if supplied\n\tif ( this.argsFn ) {\n\t\tvar values = this.models.map( function ( model ) {\n\t\t\tif ( !model ) return undefined;\n\n\t\t\treturn model.get();\n\t\t});\n\t\targs = this.argsFn.apply( this.ractive, values );\n\t}\n\n\tvar promise = this._fn.apply( this.ractive, [ this ].concat( args ) );\n\tif ( promise ) promise.then( this.complete );\n};\n\nTransition.prototype.toString = function toString () { return ''; };\n\nTransition.prototype.unbind = function unbind$1 () {\n\tif ( this.resolvers ) this.resolvers.forEach( unbind$1$1 );\n};\n\nTransition.prototype.unregisterCompleteHandler = function unregisterCompleteHandler ( fn ) {\n\tremoveFromArray( this.onComplete, fn );\n};\n\nTransition.prototype.unrender = function unrender () {};\n\nTransition.prototype.update = function update () {};\n\nvar elementCache = {};\n\nvar ieBug;\nvar ieBlacklist;\n\ntry {\n\tcreateElement( 'table' ).innerHTML = 'foo';\n} catch ( err ) {\n\tieBug = true;\n\n\tieBlacklist = {\n\t\tTABLE:  [ '<table class=\"x\">', '</table>' ],\n\t\tTHEAD:  [ '<table><thead class=\"x\">', '</thead></table>' ],\n\t\tTBODY:  [ '<table><tbody class=\"x\">', '</tbody></table>' ],\n\t\tTR:     [ '<table><tr class=\"x\">', '</tr></table>' ],\n\t\tSELECT: [ '<select class=\"x\">', '</select>' ]\n\t};\n}\n\nvar insertHtml = function ( html$$1, node, docFrag ) {\n\tvar nodes = [];\n\n\t// render 0 and false\n\tif ( html$$1 == null || html$$1 === '' ) return nodes;\n\n\tvar container;\n\tvar wrapper;\n\tvar selectedOption;\n\n\tif ( ieBug && ( wrapper = ieBlacklist[ node.tagName ] ) ) {\n\t\tcontainer = element( 'DIV' );\n\t\tcontainer.innerHTML = wrapper[0] + html$$1 + wrapper[1];\n\t\tcontainer = container.querySelector( '.x' );\n\n\t\tif ( container.tagName === 'SELECT' ) {\n\t\t\tselectedOption = container.options[ container.selectedIndex ];\n\t\t}\n\t}\n\n\telse if ( node.namespaceURI === svg$1 ) {\n\t\tcontainer = element( 'DIV' );\n\t\tcontainer.innerHTML = '<svg class=\"x\">' + html$$1 + '</svg>';\n\t\tcontainer = container.querySelector( '.x' );\n\t}\n\n\telse if ( node.tagName === 'TEXTAREA' ) {\n\t\tcontainer = createElement( 'div' );\n\n\t\tif ( typeof container.textContent !== 'undefined' ) {\n\t\t\tcontainer.textContent = html$$1;\n\t\t} else {\n\t\t\tcontainer.innerHTML = html$$1;\n\t\t}\n\t}\n\n\telse {\n\t\tcontainer = element( node.tagName );\n\t\tcontainer.innerHTML = html$$1;\n\n\t\tif ( container.tagName === 'SELECT' ) {\n\t\t\tselectedOption = container.options[ container.selectedIndex ];\n\t\t}\n\t}\n\n\tvar child;\n\twhile ( child = container.firstChild ) {\n\t\tnodes.push( child );\n\t\tdocFrag.appendChild( child );\n\t}\n\n\t// This is really annoying. Extracting <option> nodes from the\n\t// temporary container <select> causes the remaining ones to\n\t// become selected. So now we have to deselect them. IE8, you\n\t// amaze me. You really do\n\t// ...and now Chrome too\n\tvar i;\n\tif ( node.tagName === 'SELECT' ) {\n\t\ti = nodes.length;\n\t\twhile ( i-- ) {\n\t\t\tif ( nodes[i] !== selectedOption ) {\n\t\t\t\tnodes[i].selected = false;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn nodes;\n};\n\nfunction element ( tagName ) {\n\treturn elementCache[ tagName ] || ( elementCache[ tagName ] = createElement( tagName ) );\n}\n\nvar Triple = (function (Mustache$$1) {\n\tfunction Triple ( options ) {\n\t\tMustache$$1.call( this, options );\n\t}\n\n\tTriple.prototype = Object.create( Mustache$$1 && Mustache$$1.prototype );\n\tTriple.prototype.constructor = Triple;\n\n\tTriple.prototype.detach = function detach () {\n\t\tvar docFrag = createDocumentFragment();\n\t\tthis.nodes.forEach( function ( node ) { return docFrag.appendChild( node ); } );\n\t\treturn docFrag;\n\t};\n\n\tTriple.prototype.find = function find ( selector ) {\n\t\tvar this$1 = this;\n\n\t\tvar len = this.nodes.length;\n\t\tvar i;\n\n\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\tvar node = this$1.nodes[i];\n\n\t\t\tif ( node.nodeType !== 1 ) continue;\n\n\t\t\tif ( matches( node, selector ) ) return node;\n\n\t\t\tvar queryResult = node.querySelector( selector );\n\t\t\tif ( queryResult ) return queryResult;\n\t\t}\n\n\t\treturn null;\n\t};\n\n\tTriple.prototype.findAll = function findAll ( selector, query ) {\n\t\tvar this$1 = this;\n\n\t\tvar len = this.nodes.length;\n\t\tvar i;\n\n\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\tvar node = this$1.nodes[i];\n\n\t\t\tif ( node.nodeType !== 1 ) continue;\n\n\t\t\tif ( query.test( node ) ) query.add( node );\n\n\t\t\tvar queryAllResult = node.querySelectorAll( selector );\n\t\t\tif ( queryAllResult ) {\n\t\t\t\tvar numNodes = queryAllResult.length;\n\t\t\t\tvar j;\n\n\t\t\t\tfor ( j = 0; j < numNodes; j += 1 ) {\n\t\t\t\t\tquery.add( queryAllResult[j] );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\tTriple.prototype.findComponent = function findComponent () {\n\t\treturn null;\n\t};\n\n\tTriple.prototype.firstNode = function firstNode () {\n\t\treturn this.nodes[0];\n\t};\n\n\tTriple.prototype.render = function render ( target ) {\n\t\tvar html = this.model ? this.model.get() : '';\n\t\tthis.nodes = insertHtml( html, this.parentFragment.findParentNode(), target );\n\t\tthis.rendered = true;\n\t};\n\n\tTriple.prototype.toString = function toString () {\n\t\treturn this.model && this.model.get() != null ? decodeCharacterReferences( '' + this.model.get() ) : '';\n\t};\n\n\tTriple.prototype.unrender = function unrender () {\n\t\tif ( this.nodes ) this.nodes.forEach( function ( node ) { return detachNode( node ); } );\n\t\tthis.rendered = false;\n\t};\n\n\tTriple.prototype.update = function update () {\n\t\tif ( this.rendered && this.dirty ) {\n\t\t\tthis.dirty = false;\n\n\t\t\tthis.unrender();\n\t\t\tvar docFrag = createDocumentFragment();\n\t\t\tthis.render( docFrag );\n\n\t\t\tvar parentNode = this.parentFragment.findParentNode();\n\t\t\tvar anchor = this.parentFragment.findNextNode( this );\n\n\t\t\tparentNode.insertBefore( docFrag, anchor );\n\t\t}\n\t};\n\n\treturn Triple;\n}(Mustache));\n\nvar Yielder = (function (Item$$1) {\n\tfunction Yielder ( options ) {\n\t\tItem$$1.call( this, options );\n\n\t\tthis.container = options.parentFragment.ractive;\n\t\tthis.component = this.container.component;\n\n\t\tthis.containerFragment = options.parentFragment;\n\t\tthis.parentFragment = this.component.parentFragment;\n\n\t\t// {{yield}} is equivalent to {{yield content}}\n\t\tthis.name = options.template.n || '';\n\t}\n\n\tYielder.prototype = Object.create( Item$$1 && Item$$1.prototype );\n\tYielder.prototype.constructor = Yielder;\n\n\tYielder.prototype.bind = function bind () {\n\t\tvar name = this.name;\n\n\t\t( this.component.yielders[ name ] || ( this.component.yielders[ name ] = [] ) ).push( this );\n\n\t\t// TODO don't parse here\n\t\tvar template = this.container._inlinePartials[ name || 'content' ];\n\n\t\tif ( typeof template === 'string' ) {\n\t\t\ttemplate = parse( template ).t;\n\t\t}\n\n\t\tif ( !template ) {\n\t\t\twarnIfDebug( (\"Could not find template for partial \\\"\" + name + \"\\\"\"), { ractive: this.ractive });\n\t\t\ttemplate = [];\n\t\t}\n\n\t\tthis.fragment = new Fragment({\n\t\t\towner: this,\n\t\t\tractive: this.container.parent,\n\t\t\ttemplate: template\n\t\t}).bind();\n\t};\n\n\tYielder.prototype.bubble = function bubble () {\n\t\tif ( !this.dirty ) {\n\t\t\tthis.containerFragment.bubble();\n\t\t\tthis.dirty = true;\n\t\t}\n\t};\n\n\tYielder.prototype.detach = function detach () {\n\t\treturn this.fragment.detach();\n\t};\n\n\tYielder.prototype.find = function find ( selector ) {\n\t\treturn this.fragment.find( selector );\n\t};\n\n\tYielder.prototype.findAll = function findAll ( selector, queryResult ) {\n\t\tthis.fragment.find( selector, queryResult );\n\t};\n\n\tYielder.prototype.findComponent = function findComponent ( name ) {\n\t\treturn this.fragment.findComponent( name );\n\t};\n\n\tYielder.prototype.findAllComponents = function findAllComponents ( name, queryResult ) {\n\t\tthis.fragment.findAllComponents( name, queryResult );\n\t};\n\n\tYielder.prototype.findNextNode = function findNextNode() {\n\t\treturn this.containerFragment.findNextNode( this );\n\t};\n\n\tYielder.prototype.firstNode = function firstNode ( skipParent ) {\n\t\treturn this.fragment.firstNode( skipParent );\n\t};\n\n\tYielder.prototype.render = function render ( target, occupants ) {\n\t\treturn this.fragment.render( target, occupants );\n\t};\n\n\tYielder.prototype.setTemplate = function setTemplate ( name ) {\n\t\tvar template = this.parentFragment.ractive.partials[ name ];\n\n\t\tif ( typeof template === 'string' ) {\n\t\t\ttemplate = parse( template ).t;\n\t\t}\n\n\t\tthis.partialTemplate = template || []; // TODO warn on missing partial\n\t};\n\n\tYielder.prototype.toString = function toString ( escape ) {\n\t\treturn this.fragment.toString( escape );\n\t};\n\n\tYielder.prototype.unbind = function unbind () {\n\t\tthis.fragment.unbind();\n\t\tremoveFromArray( this.component.yielders[ this.name ], this );\n\t};\n\n\tYielder.prototype.unrender = function unrender ( shouldDestroy ) {\n\t\tthis.fragment.unrender( shouldDestroy );\n\t};\n\n\tYielder.prototype.update = function update () {\n\t\tthis.dirty = false;\n\t\tthis.fragment.update();\n\t};\n\n\treturn Yielder;\n}(Item));\n\n// finds the component constructor in the registry or view hierarchy registries\nfunction getComponentConstructor ( ractive, name ) {\n\tvar instance = findInstance( 'components', ractive, name );\n\tvar Component;\n\n\tif ( instance ) {\n\t\tComponent = instance.components[ name ];\n\n\t\t// best test we have for not Ractive.extend\n\t\tif ( !Component._Parent ) {\n\t\t\t// function option, execute and store for reset\n\t\t\tvar fn = Component.bind( instance );\n\t\t\tfn.isOwner = instance.components.hasOwnProperty( name );\n\t\t\tComponent = fn();\n\n\t\t\tif ( !Component ) {\n\t\t\t\twarnIfDebug( noRegistryFunctionReturn, name, 'component', 'component', { ractive: ractive });\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( typeof Component === 'string' ) {\n\t\t\t\t// allow string lookup\n\t\t\t\tComponent = getComponentConstructor( ractive, Component );\n\t\t\t}\n\n\t\t\tComponent._fn = fn;\n\t\t\tinstance.components[ name ] = Component;\n\t\t}\n\t}\n\n\treturn Component;\n}\n\nvar constructors = {};\nconstructors[ ALIAS ] = Alias;\nconstructors[ DOCTYPE ] = Doctype;\nconstructors[ INTERPOLATOR ] = Interpolator;\nconstructors[ PARTIAL ] = Partial;\nconstructors[ SECTION ] = Section;\nconstructors[ TRIPLE ] = Triple;\nconstructors[ YIELDER ] = Yielder;\n\nconstructors[ ATTRIBUTE ] = Attribute;\nconstructors[ BINDING_FLAG ] = BindingFlag;\nconstructors[ DECORATOR ] = Decorator;\nconstructors[ EVENT ] = EventDirective;\nconstructors[ TRANSITION ] = Transition;\n\nvar specialElements = {\n\tdoctype: Doctype,\n\tform: Form,\n\tinput: Input,\n\toption: Option,\n\tselect: Select,\n\ttextarea: Textarea\n};\n\nfunction createItem ( options ) {\n\tif ( typeof options.template === 'string' ) {\n\t\treturn new Text( options );\n\t}\n\n\tif ( options.template.t === ELEMENT ) {\n\t\t// could be component or element\n\t\tvar ComponentConstructor = getComponentConstructor( options.parentFragment.ractive, options.template.e );\n\t\tif ( ComponentConstructor ) {\n\t\t\treturn new Component( options, ComponentConstructor );\n\t\t}\n\n\t\tvar tagName = options.template.e.toLowerCase();\n\n\t\tvar ElementConstructor = specialElements[ tagName ] || Element;\n\t\treturn new ElementConstructor( options );\n\t}\n\n\tvar Item;\n\n\t// component mappings are a special case of attribute\n\tif ( options.template.t === ATTRIBUTE ) {\n\t\tvar el = options.owner;\n\t\tif ( !el || ( el.type !== COMPONENT && el.type !== ELEMENT ) ) {\n\t\t\tel = findElement( options.parentFragment );\n\t\t}\n\t\toptions.element = el;\n\n\t\tItem = el.type === COMPONENT ? Mapping : Attribute;\n\t} else {\n\t\tItem = constructors[ options.template.t ];\n\t}\n\n\tif ( !Item ) throw new Error( (\"Unrecognised item type \" + (options.template.t)) );\n\n\treturn new Item( options );\n}\n\n// TODO all this code needs to die\nfunction processItems ( items, values, guid, counter ) {\n\tif ( counter === void 0 ) counter = 0;\n\n\treturn items.map( function ( item ) {\n\t\tif ( item.type === TEXT ) {\n\t\t\treturn item.template;\n\t\t}\n\n\t\tif ( item.fragment ) {\n\t\t\tif ( item.fragment.iterations ) {\n\t\t\t\treturn item.fragment.iterations.map( function ( fragment ) {\n\t\t\t\t\treturn processItems( fragment.items, values, guid, counter );\n\t\t\t\t}).join( '' );\n\t\t\t} else {\n\t\t\t\treturn processItems( item.fragment.items, values, guid, counter );\n\t\t\t}\n\t\t}\n\n\t\tvar placeholderId = \"\" + guid + \"-\" + (counter++);\n\t\tvar model = item.model || item.newModel;\n\n\t\tvalues[ placeholderId ] = model ?\n\t\t\tmodel.wrapper ?\n\t\t\t\tmodel.wrapper.value :\n\t\t\t\tmodel.get() :\n\t\t\tundefined;\n\n\t\treturn '${' + placeholderId + '}';\n\t}).join( '' );\n}\n\nfunction unrenderAndDestroy$1 ( item ) {\n\titem.unrender( true );\n}\n\nvar Fragment = function Fragment ( options ) {\n\tthis.owner = options.owner; // The item that owns this fragment - an element, section, partial, or attribute\n\n\tthis.isRoot = !options.owner.parentFragment;\n\tthis.parent = this.isRoot ? null : this.owner.parentFragment;\n\tthis.ractive = options.ractive || ( this.isRoot ? options.owner : this.parent.ractive );\n\n\tthis.componentParent = ( this.isRoot && this.ractive.component ) ? this.ractive.component.parentFragment : null;\n\n\tthis.context = null;\n\tthis.rendered = false;\n\n\t// encapsulated styles should be inherited until they get applied by an element\n\tthis.cssIds = 'cssIds' in options ? options.cssIds : ( this.parent ? this.parent.cssIds : null );\n\n\tthis.resolvers = [];\n\n\tthis.dirty = false;\n\tthis.dirtyArgs = this.dirtyValue = true; // TODO getArgsList is nonsense - should deprecate legacy directives style\n\n\tthis.template = options.template || [];\n\tthis.createItems();\n};\n\nFragment.prototype.bind = function bind$1 ( context ) {\n\tthis.context = context;\n\tthis.items.forEach( bind$2 );\n\tthis.bound = true;\n\n\t// in rare cases, a forced resolution (or similar) will cause the\n\t// fragment to be dirty before it's even finished binding. In those\n\t// cases we update immediately\n\tif ( this.dirty ) this.update();\n\n\treturn this;\n};\n\nFragment.prototype.bubble = function bubble () {\n\tthis.dirtyArgs = this.dirtyValue = true;\n\n\tif ( !this.dirty ) {\n\t\tthis.dirty = true;\n\n\t\tif ( this.isRoot ) { // TODO encapsulate 'is component root, but not overall root' check?\n\t\t\tif ( this.ractive.component ) {\n\t\t\t\tthis.ractive.component.bubble();\n\t\t\t} else if ( this.bound ) {\n\t\t\t\trunloop.addFragment( this );\n\t\t\t}\n\t\t} else {\n\t\t\tthis.owner.bubble();\n\t\t}\n\t}\n};\n\nFragment.prototype.createItems = function createItems () {\n\t// this is a hot code path\n\tvar this$1 = this;\n\n\t\tvar max = this.template.length;\n\tthis.items = [];\n\tfor ( var i = 0; i < max; i++ ) {\n\t\tthis$1.items[i] = createItem({ parentFragment: this$1, template: this$1.template[i], index: i });\n\t}\n};\n\nFragment.prototype.destroyed = function destroyed () {\n\tthis.items.forEach( function ( i ) { return i.destroyed(); } );\n};\n\nFragment.prototype.detach = function detach () {\n\tvar docFrag = createDocumentFragment();\n\tthis.items.forEach( function ( item ) { return docFrag.appendChild( item.detach() ); } );\n\treturn docFrag;\n};\n\nFragment.prototype.find = function find ( selector ) {\n\tvar this$1 = this;\n\n\t\tvar len = this.items.length;\n\tvar i;\n\n\tfor ( i = 0; i < len; i += 1 ) {\n\t\tvar found = this$1.items[i].find( selector );\n\t\tif ( found ) return found;\n\t}\n};\n\nFragment.prototype.findAll = function findAll ( selector, query ) {\n\tvar this$1 = this;\n\n\t\tif ( this.items ) {\n\t\tvar len = this.items.length;\n\t\tvar i;\n\n\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\tvar item = this$1.items[i];\n\n\t\t\tif ( item.findAll ) {\n\t\t\t\titem.findAll( selector, query );\n\t\t\t}\n\t\t}\n\t}\n\n\treturn query;\n};\n\nFragment.prototype.findComponent = function findComponent ( name ) {\n\tvar this$1 = this;\n\n\t\tvar len = this.items.length;\n\tvar i;\n\n\tfor ( i = 0; i < len; i += 1 ) {\n\t\tvar found = this$1.items[i].findComponent( name );\n\t\tif ( found ) return found;\n\t}\n};\n\nFragment.prototype.findAllComponents = function findAllComponents ( name, query ) {\n\tvar this$1 = this;\n\n\t\tif ( this.items ) {\n\t\tvar len = this.items.length;\n\t\tvar i;\n\n\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\tvar item = this$1.items[i];\n\n\t\t\tif ( item.findAllComponents ) {\n\t\t\t\titem.findAllComponents( name, query );\n\t\t\t}\n\t\t}\n\t}\n\n\treturn query;\n};\n\nFragment.prototype.findContext = function findContext () {\n\tvar fragment = this;\n\twhile ( fragment && !fragment.context ) fragment = fragment.parent;\n\tif ( !fragment ) return this.ractive.viewmodel;\n\telse return fragment.context;\n};\n\nFragment.prototype.findNextNode = function findNextNode ( item ) {\n\t// search for the next node going forward\n\tvar this$1 = this;\n\n\t\tfor ( var i = item.index + 1; i < this$1.items.length; i++ ) {\n\t\tif ( !this$1.items[ i ] ) continue;\n\n\t\tvar node = this$1.items[ i ].firstNode( true );\n\t\tif ( node ) return node;\n\t}\n\n\t// if this is the root fragment, and there are no more items,\n\t// it means we're at the end...\n\tif ( this.isRoot ) {\n\t\tif ( this.ractive.component ) {\n\t\t\treturn this.ractive.component.parentFragment.findNextNode( this.ractive.component );\n\t\t}\n\n\t\t// TODO possible edge case with other content\n\t\t// appended to this.ractive.el?\n\t\treturn null;\n\t}\n\n\treturn this.owner.findNextNode( this ); // the argument is in case the parent is a RepeatedFragment\n};\n\nFragment.prototype.findParentNode = function findParentNode () {\n\tvar fragment = this;\n\n\tdo {\n\t\tif ( fragment.owner.type === ELEMENT ) {\n\t\t\treturn fragment.owner.node;\n\t\t}\n\n\t\tif ( fragment.isRoot && !fragment.ractive.component ) { // TODO encapsulate check\n\t\t\treturn fragment.ractive.el;\n\t\t}\n\n\t\tif ( fragment.owner.type === YIELDER ) {\n\t\t\tfragment = fragment.owner.containerFragment;\n\t\t} else {\n\t\t\tfragment = fragment.componentParent || fragment.parent; // TODO ugh\n\t\t}\n\t} while ( fragment );\n\n\tthrow new Error( 'Could not find parent node' ); // TODO link to issue tracker\n};\n\nFragment.prototype.findRepeatingFragment = function findRepeatingFragment () {\n\tvar fragment = this;\n\t// TODO better check than fragment.parent.iterations\n\twhile ( ( fragment.parent || fragment.componentParent ) && !fragment.isIteration ) {\n\t\tfragment = fragment.parent || fragment.componentParent;\n\t}\n\n\treturn fragment;\n};\n\nFragment.prototype.firstNode = function firstNode ( skipParent ) {\n\tvar this$1 = this;\n\n\t\tvar node;\n\tfor ( var i = 0; i < this$1.items.length; i++ ) {\n\t\tnode = this$1.items[i].firstNode( true );\n\n\t\tif ( node ) {\n\t\t\treturn node;\n\t\t}\n\t}\n\n\tif ( skipParent ) return null;\n\n\treturn this.parent.findNextNode( this.owner );\n};\n\n// TODO ideally, this would be deprecated in favour of an\n// expression-like approach\nFragment.prototype.getArgsList = function getArgsList () {\n\tif ( this.dirtyArgs ) {\n\t\tvar values = {};\n\t\tvar source = processItems( this.items, values, this.ractive._guid );\n\t\tvar parsed = parseJSON( '[' + source + ']', values );\n\n\t\tthis.argsList = parsed ?\n\t\t\tparsed.value :\n\t\t\t[ this.toString() ];\n\n\t\tthis.dirtyArgs = false;\n\t}\n\n\treturn this.argsList;\n};\n\nFragment.prototype.rebinding = function rebinding ( next ) {\n\tthis.context = next;\n};\n\nFragment.prototype.render = function render ( target, occupants ) {\n\tif ( this.rendered ) throw new Error( 'Fragment is already rendered!' );\n\tthis.rendered = true;\n\n\tthis.items.forEach( function ( item ) { return item.render( target, occupants ); } );\n};\n\nFragment.prototype.resetTemplate = function resetTemplate ( template ) {\n\tvar wasBound = this.bound;\n\tvar wasRendered = this.rendered;\n\n\t// TODO ensure transitions are disabled globally during reset\n\n\tif ( wasBound ) {\n\t\tif ( wasRendered ) this.unrender( true );\n\t\tthis.unbind();\n\t}\n\n\tthis.template = template;\n\tthis.createItems();\n\n\tif ( wasBound ) {\n\t\tthis.bind( this.context );\n\n\t\tif ( wasRendered ) {\n\t\t\tvar parentNode = this.findParentNode();\n\t\t\tvar anchor = this.parent ? this.parent.findNextNode( this.owner ) : null;\n\n\t\t\tif ( anchor ) {\n\t\t\t\tvar docFrag = createDocumentFragment();\n\t\t\t\tthis.render( docFrag );\n\t\t\t\tparentNode.insertBefore( docFrag, anchor );\n\t\t\t} else {\n\t\t\t\tthis.render( parentNode );\n\t\t\t}\n\t\t}\n\t}\n};\n\nFragment.prototype.resolve = function resolve ( template, callback ) {\n\tif ( !this.context && this.parent.resolve ) {\n\t\treturn this.parent.resolve( template, callback );\n\t}\n\n\tvar resolver = new ReferenceResolver( this, template, callback );\n\tthis.resolvers.push( resolver );\n\n\treturn resolver; // so we can e.g. force resolution\n};\n\nFragment.prototype.shuffled = function shuffled () {\n\tthis.items.forEach( function ( i ) { return i.shuffled(); } );\n};\n\nFragment.prototype.toHtml = function toHtml () {\n\treturn this.toString();\n};\n\nFragment.prototype.toString = function toString$1 ( escape ) {\n\treturn this.items.map( escape ? toEscapedString : toString$2 ).join( '' );\n};\n\nFragment.prototype.unbind = function unbind$1 () {\n\tthis.items.forEach( unbind$1$1 );\n\tthis.bound = false;\n\n\treturn this;\n};\n\nFragment.prototype.unrender = function unrender$1 ( shouldDestroy ) {\n\tthis.items.forEach( shouldDestroy ? unrenderAndDestroy$1 : unrender$1$1 );\n\tthis.rendered = false;\n};\n\nFragment.prototype.update = function update$1 () {\n\tif ( this.dirty ) {\n\t\tif ( !this.updating ) {\n\t\t\tthis.dirty = false;\n\t\t\tthis.updating = true;\n\t\t\tthis.items.forEach( update$1$1 );\n\t\t\tthis.updating = false;\n\t\t} else if ( this.isRoot ) {\n\t\t\trunloop.addFragmentToRoot( this );\n\t\t}\n\t}\n};\n\nFragment.prototype.valueOf = function valueOf () {\n\tif ( this.items.length === 1 ) {\n\t\treturn this.items[0].valueOf();\n\t}\n\n\tif ( this.dirtyValue ) {\n\t\tvar values = {};\n\t\tvar source = processItems( this.items, values, this.ractive._guid );\n\t\tvar parsed = parseJSON( source, values );\n\n\t\tthis.value = parsed ?\n\t\t\tparsed.value :\n\t\t\tthis.toString();\n\n\t\tthis.dirtyValue = false;\n\t}\n\n\treturn this.value;\n};\n\n// TODO should resetTemplate be asynchronous? i.e. should it be a case\n// of outro, update template, intro? I reckon probably not, since that\n// could be achieved with unrender-resetTemplate-render. Also, it should\n// conceptually be similar to resetPartial, which couldn't be async\n\nfunction Ractive$resetTemplate ( template ) {\n\ttemplateConfigurator.init( null, this, { template: template });\n\n\tvar transitionsEnabled = this.transitionsEnabled;\n\tthis.transitionsEnabled = false;\n\n\t// Is this is a component, we need to set the `shouldDestroy`\n\t// flag, otherwise it will assume by default that a parent node\n\t// will be detached, and therefore it doesn't need to bother\n\t// detaching its own nodes\n\tvar component = this.component;\n\tif ( component ) component.shouldDestroy = true;\n\tthis.unrender();\n\tif ( component ) component.shouldDestroy = false;\n\n\t// remove existing fragment and create new one\n\tthis.fragment.unbind().unrender( true );\n\n\tthis.fragment = new Fragment({\n\t\ttemplate: this.template,\n\t\troot: this,\n\t\towner: this\n\t});\n\n\tvar docFrag = createDocumentFragment();\n\tthis.fragment.bind( this.viewmodel ).render( docFrag );\n\n\t// if this is a component, its el may not be valid, so find a\n\t// target based on the component container\n\tif ( component ) {\n\t\tthis.fragment.findParentNode().insertBefore( docFrag, component.findNextNode() );\n\t} else {\n\t\tthis.el.insertBefore( docFrag, this.anchor );\n\t}\n\n\tthis.transitionsEnabled = transitionsEnabled;\n}\n\nvar reverse$1 = makeArrayMethod( 'reverse' ).path;\n\nfunction Ractive$set ( keypath, value ) {\n\tvar ractive = this;\n\n\treturn set$1( ractive, build( ractive, keypath, value ) );\n}\n\nvar shift$1 = makeArrayMethod( 'shift' ).path;\n\nvar sort$1 = makeArrayMethod( 'sort' ).path;\n\nvar splice$1 = makeArrayMethod( 'splice' ).path;\n\nfunction Ractive$subtract ( keypath, d ) {\n\treturn add$1( this, keypath, ( d === undefined ? -1 : -d ) );\n}\n\nvar teardownHook$1 = new Hook( 'teardown' );\n\n// Teardown. This goes through the root fragment and all its children, removing observers\n// and generally cleaning up after itself\n\nfunction Ractive$teardown () {\n\tif ( this.torndown ) {\n\t\twarnIfDebug( 'ractive.teardown() was called on a Ractive instance that was already torn down' );\n\t\treturn Promise$1.resolve();\n\t}\n\n\tthis.torndown = true;\n\tthis.fragment.unbind();\n\tthis.viewmodel.teardown();\n\n\tthis._observers.forEach( cancel$1 );\n\n\tif ( this.fragment.rendered && this.el.__ractive_instances__ ) {\n\t\tremoveFromArray( this.el.__ractive_instances__, this );\n\t}\n\n\tthis.shouldDestroy = true;\n\tvar promise = ( this.fragment.rendered ? this.unrender() : Promise$1.resolve() );\n\n\tteardownHook$1.fire( this );\n\n\treturn promise;\n}\n\nfunction Ractive$toggle ( keypath ) {\n\tif ( typeof keypath !== 'string' ) {\n\t\tthrow new TypeError( badArguments );\n\t}\n\n\treturn set$1( this, gather( this, keypath ).map( function ( m ) { return [ m, !m.get() ]; } ) );\n}\n\nfunction Ractive$toCSS() {\n\tvar cssIds = [ this.cssId ].concat( this.findAllComponents().map( function ( c ) { return c.cssId; } ) );\n\tvar uniqueCssIds = Object.keys(cssIds.reduce( function ( ids, id ) { return (ids[id] = true, ids); }, {}));\n\treturn getCSS( uniqueCssIds );\n}\n\nfunction Ractive$toHTML () {\n\treturn this.fragment.toString( true );\n}\n\nfunction Ractive$transition ( name, node, params ) {\n\n\tif ( node instanceof HTMLElement ) {\n\t\t// good to go\n\t}\n\telse if ( isObject( node ) ) {\n\t\t// omitted, use event node\n\t\tparams = node;\n\t}\n\n\t// if we allow query selector, then it won't work\n\t// simple params like \"fast\"\n\n\t// else if ( typeof node === 'string' ) {\n\t// \t// query selector\n\t// \tnode = this.find( node )\n\t// }\n\n\tnode = node || this.event.node;\n\n\tif ( !node || !node._ractive ) {\n\t\tfatal( (\"No node was supplied for transition \" + name) );\n\t}\n\n\tparams = params || {};\n\tvar owner = node._ractive.proxy;\n\tvar transition = new Transition({ owner: owner, parentFragment: owner.parentFragment, name: name, params: params });\n\ttransition.bind();\n\n\tvar promise = runloop.start( this, true );\n\trunloop.registerTransition( transition );\n\trunloop.end();\n\n\tpromise.then( function () { return transition.unbind(); } );\n\treturn promise;\n}\n\nfunction unlink$2( here ) {\n\tvar promise = runloop.start();\n\tthis.viewmodel.joinAll( splitKeypath( here ), { lastLink: false } ).unlink();\n\trunloop.end();\n\treturn promise;\n}\n\nvar unrenderHook$1 = new Hook( 'unrender' );\n\nfunction Ractive$unrender () {\n\tif ( !this.fragment.rendered ) {\n\t\twarnIfDebug( 'ractive.unrender() was called on a Ractive instance that was not rendered' );\n\t\treturn Promise$1.resolve();\n\t}\n\n\tvar promise = runloop.start( this, true );\n\n\t// If this is a component, and the component isn't marked for destruction,\n\t// don't detach nodes from the DOM unnecessarily\n\tvar shouldDestroy = !this.component || this.component.shouldDestroy || this.shouldDestroy;\n\tthis.fragment.unrender( shouldDestroy );\n\n\tremoveFromArray( this.el.__ractive_instances__, this );\n\n\tunrenderHook$1.fire( this );\n\n\trunloop.end();\n\treturn promise;\n}\n\nvar unshift$1 = makeArrayMethod( 'unshift' ).path;\n\nfunction Ractive$updateModel ( keypath, cascade ) {\n\tvar promise = runloop.start( this, true );\n\n\tif ( !keypath ) {\n\t\tthis.viewmodel.updateFromBindings( true );\n\t} else {\n\t\tthis.viewmodel.joinAll( splitKeypath( keypath ) ).updateFromBindings( cascade !== false );\n\t}\n\n\trunloop.end();\n\n\treturn promise;\n}\n\nvar proto = {\n\tadd: Ractive$add,\n\tanimate: Ractive$animate,\n\tdetach: Ractive$detach,\n\tfind: Ractive$find,\n\tfindAll: Ractive$findAll,\n\tfindAllComponents: Ractive$findAllComponents,\n\tfindComponent: Ractive$findComponent,\n\tfindContainer: Ractive$findContainer,\n\tfindParent: Ractive$findParent,\n\tfire: Ractive$fire,\n\tget: Ractive$get,\n\tgetNodeInfo: getNodeInfo,\n\tinsert: Ractive$insert,\n\tlink: link$2,\n\tmerge: thisRactive$merge,\n\tobserve: observe,\n\tobserveList: observeList,\n\tobserveOnce: observeOnce,\n\t// TODO reinstate these\n\t// observeListOnce,\n\toff: Ractive$off,\n\ton: Ractive$on,\n\tonce: Ractive$once,\n\tpop: pop$1,\n\tpush: push$1,\n\trender: Ractive$render,\n\treset: Ractive$reset,\n\tresetPartial: resetPartial,\n\tresetTemplate: Ractive$resetTemplate,\n\treverse: reverse$1,\n\tset: Ractive$set,\n\tshift: shift$1,\n\tsort: sort$1,\n\tsplice: splice$1,\n\tsubtract: Ractive$subtract,\n\tteardown: Ractive$teardown,\n\ttoggle: Ractive$toggle,\n\ttoCSS: Ractive$toCSS,\n\ttoCss: Ractive$toCSS,\n\ttoHTML: Ractive$toHTML,\n\ttoHtml: Ractive$toHTML,\n\ttransition: Ractive$transition,\n\tunlink: unlink$2,\n\tunrender: Ractive$unrender,\n\tunshift: unshift$1,\n\tupdate: Ractive$update,\n\tupdateModel: Ractive$updateModel\n};\n\nvar wrap$1 = function ( method, superMethod, force ) {\n\n\tif ( force || needsSuper( method, superMethod ) )  {\n\n\t\treturn function () {\n\n\t\t\tvar hasSuper = ( '_super' in this ), _super = this._super, result;\n\n\t\t\tthis._super = superMethod;\n\n\t\t\tresult = method.apply( this, arguments );\n\n\t\t\tif ( hasSuper ) {\n\t\t\t\tthis._super = _super;\n\t\t\t}\n\n\t\t\treturn result;\n\t\t};\n\t}\n\n\telse {\n\t\treturn method;\n\t}\n};\n\nfunction needsSuper ( method, superMethod ) {\n\treturn typeof superMethod === 'function' && /_super/.test( method );\n}\n\nfunction unwrap ( Child ) {\n\tvar options = {};\n\n\twhile ( Child ) {\n\t\taddRegistries( Child, options );\n\t\taddOtherOptions( Child, options );\n\n\t\tif ( Child._Parent !== Ractive ) {\n\t\t\tChild = Child._Parent;\n\t\t} else {\n\t\t\tChild = false;\n\t\t}\n\t}\n\n\treturn options;\n}\n\nfunction addRegistries ( Child, options ) {\n\tregistries.forEach( function ( r ) {\n\t\taddRegistry(\n\t\t\tr.useDefaults ? Child.prototype : Child,\n\t\t\toptions, r.name );\n\t});\n}\n\nfunction addRegistry ( target, options, name ) {\n\tvar registry, keys = Object.keys( target[ name ] );\n\n\tif ( !keys.length ) { return; }\n\n\tif ( !( registry = options[ name ] ) ) {\n\t\tregistry = options[ name ] = {};\n\t}\n\n\tkeys\n\t\t.filter( function ( key ) { return !( key in registry ); } )\n\t\t.forEach( function ( key ) { return registry[ key ] = target[ name ][ key ]; } );\n}\n\nfunction addOtherOptions ( Child, options ) {\n\tObject.keys( Child.prototype ).forEach( function ( key ) {\n\t\tif ( key === 'computed' ) { return; }\n\n\t\tvar value = Child.prototype[ key ];\n\n\t\tif ( !( key in options ) ) {\n\t\t\toptions[ key ] = value._method ? value._method : value;\n\t\t}\n\n\t\t// is it a wrapped function?\n\t\telse if ( typeof options[ key ] === 'function'\n\t\t\t\t&& typeof value === 'function'\n\t\t\t\t&& options[ key ]._method ) {\n\n\t\t\tvar result, needsSuper = value._method;\n\n\t\t\tif ( needsSuper ) { value = value._method; }\n\n\t\t\t// rewrap bound directly to parent fn\n\t\t\tresult = wrap$1( options[ key ]._method, value );\n\n\t\t\tif ( needsSuper ) { result._method = result; }\n\n\t\t\toptions[ key ] = result;\n\t\t}\n\t});\n}\n\nfunction extend$3 () {\n\tvar options = [], len = arguments.length;\n\twhile ( len-- ) options[ len ] = arguments[ len ];\n\n\tif( !options.length ) {\n\t\treturn extendOne( this );\n\t} else {\n\t\treturn options.reduce( extendOne, this );\n\t}\n}\n\nfunction extendOne ( Parent, options ) {\n\tif ( options === void 0 ) options = {};\n\n\tvar Child, proto;\n\n\t// if we're extending with another Ractive instance...\n\t//\n\t//   var Human = Ractive.extend(...), Spider = Ractive.extend(...);\n\t//   var Spiderman = Human.extend( Spider );\n\t//\n\t// ...inherit prototype methods and default options as well\n\tif ( options.prototype instanceof Ractive ) {\n\t\toptions = unwrap( options );\n\t}\n\n\tChild = function ( options ) {\n\t\tif ( !( this instanceof Child ) ) return new Child( options );\n\n\t\tconstruct( this, options || {} );\n\t\tinitialise( this, options || {}, {} );\n\t};\n\n\tproto = create( Parent.prototype );\n\tproto.constructor = Child;\n\n\t// Static properties\n\tdefineProperties( Child, {\n\t\t// alias prototype as defaults\n\t\tdefaults: { value: proto },\n\n\t\t// extendable\n\t\textend: { value: extend$3, writable: true, configurable: true },\n\n\t\t// Parent - for IE8, can't use Object.getPrototypeOf\n\t\t_Parent: { value: Parent }\n\t});\n\n\t// extend configuration\n\tconfig.extend( Parent, proto, options );\n\n\tdataConfigurator.extend( Parent, proto, options );\n\n\tif ( options.computed ) {\n\t\tproto.computed = extend$1( create( Parent.prototype.computed ), options.computed );\n\t}\n\n\tChild.prototype = proto;\n\n\treturn Child;\n}\n\nfunction joinKeys () {\n\tvar keys = [], len = arguments.length;\n\twhile ( len-- ) keys[ len ] = arguments[ len ];\n\n\treturn keys.map( escapeKey ).join( '.' );\n}\n\nfunction splitKeypath$1 ( keypath ) {\n\treturn splitKeypath( keypath ).map( unescapeKey );\n}\n\n// Ractive.js makes liberal use of things like Array.prototype.indexOf. In\n// older browsers, these are made available via a shim - here, we do a quick\n// pre-flight check to make sure that either a) we're not in a shit browser,\n// or b) we're using a Ractive-legacy.js build\nvar FUNCTION = 'function';\n\nif (\n\ttypeof Date.now !== FUNCTION                 ||\n\ttypeof String.prototype.trim !== FUNCTION    ||\n\ttypeof Object.keys !== FUNCTION              ||\n\ttypeof Array.prototype.indexOf !== FUNCTION  ||\n\ttypeof Array.prototype.forEach !== FUNCTION  ||\n\ttypeof Array.prototype.map !== FUNCTION      ||\n\ttypeof Array.prototype.filter !== FUNCTION   ||\n\t( win && typeof win.addEventListener !== FUNCTION )\n) {\n\tthrow new Error( 'It looks like you\\'re attempting to use Ractive.js in an older browser. You\\'ll need to use one of the \\'legacy builds\\' in order to continue - see http://docs.ractivejs.org/latest/legacy-builds for more information.' );\n}\n\nfunction Ractive ( options ) {\n\tif ( !( this instanceof Ractive ) ) return new Ractive( options );\n\n\tconstruct( this, options || {} );\n\tinitialise( this, options || {}, {} );\n}\n\nextend$1( Ractive.prototype, proto, defaults );\nRactive.prototype.constructor = Ractive;\n\n// alias prototype as `defaults`\nRactive.defaults = Ractive.prototype;\n\n// static properties\ndefineProperties( Ractive, {\n\n\t// debug flag\n\tDEBUG:          { writable: true, value: true },\n\tDEBUG_PROMISES: { writable: true, value: true },\n\n\t// static methods:\n\textend:         { value: extend$3 },\n\tescapeKey:      { value: escapeKey },\n\tgetNodeInfo:    { value: staticInfo },\n\tjoinKeys:       { value: joinKeys },\n\tparse:          { value: parse },\n\tsplitKeypath:   { value: splitKeypath$1 },\n\tunescapeKey:    { value: unescapeKey },\n\tgetCSS:         { value: getCSS },\n\n\t// namespaced constructors\n\tPromise:        { value: Promise$1 },\n\n\t// support\n\tenhance:        { writable: true, value: false },\n\tsvg:            { value: svg },\n\tmagic:          { value: magic },\n\n\t// version\n\tVERSION:        { value: '0.8.0' },\n\n\t// plugins\n\tadaptors:       { writable: true, value: {} },\n\tcomponents:     { writable: true, value: {} },\n\tdecorators:     { writable: true, value: {} },\n\teasing:         { writable: true, value: easing },\n\tevents:         { writable: true, value: {} },\n\tinterpolators:  { writable: true, value: interpolators },\n\tpartials:       { writable: true, value: {} },\n\ttransitions:    { writable: true, value: {} }\n});\n\nreturn Ractive;\n\n})));\n"],"names":["Text","prototype","valueOf","this","template","Item","isClient","prefixCache","testStyle","createElement","style","prefix","prop","camelCase","undefined","capped","charAt","toUpperCase","substring","i","vendors","length","vendor","visible","prefix$1","hidden","doc","prefix$2","i$1","addEventListener","onChange","onHide","onShow","win","createTransitions","unprefixPattern","RegExp","join","unprefix","replace","vendorPattern","hyphenate","str","test","match","toLowerCase","TRANSITION$1","TRANSITIONEND","CSS_TRANSITIONS_ENABLED","TRANSITION_DURATION","TRANSITION_PROPERTY","TRANSITION_TIMING_FUNCTION","testStyle$1","linear$1","x","canUseCssTransitions","cannotUseCssTransitions","transition","webkitTransition","t","to","options","changedProperties","resolve","setTimeout","transitionDone","clearTimeout","cssTimeout","checkComplete","jsTransitionsComplete","cssTransitionsComplete","unregisterCompleteHandler","ractive","fire","name","node","isIntro","transitionEndHandler","event","index","indexOf","propertyName","splice","cssTransitionsDone","previous","property","duration","timing","removeEventListener","hashPrefix","namespaceURI","tagName","map","easing","delay","registerCompleteHandler","hash","originalValue","suffix","interpolator","propertiesToTransitionInJs","getStyle","warnIfDebug","exec","interpolate","parseFloat","push","warnOnceIfDebug","missingPlugin","Ticker","step","pos","complete","createTransitions$1","getComputedStyle","legacy","resolved$1","Promise$1","names","t0","t1","t2","Transition","owner","parentFragment","findElement","element","attributeByName","onComplete","animateStyle","value","this$1","arguments","Error","setStyle","fulfil","propertyNames","Object","keys","computedStyle","current","bind","v","_introTransition","_outroTransition","eventName","f","n","fragment","Fragment","toString","unbind","params","a","s","d","fragment$1","getArgsList","_fn","findInViewHierarchy","resolvers","models","r","ref","resolver","model","resolveReference","register","removeFromArray","argsFn","getFunction","destroyed","props","isArray","styles","value$1","processParams","defaults","extend$1","rebinding","next","idx","rebindMatch","unregister","addShuffleRegister","fn","addToArray","render","hasOwnProperty","start","completed","originalStyle","getAttribute","args","noReset","forEach","resetStyle","_manager","remove","values","get","apply","promise","concat","then","unbind$1$1","unrender","update","ieBug","ieBlacklist","elementCache","innerHTML","err","TABLE","THEAD","TBODY","TR","SELECT","insertHtml","html$$1","docFrag","nodes","container","wrapper","selectedOption","querySelector","selectedIndex","svg$1","textContent","child","firstChild","appendChild","selected","Triple","Mustache$$1","call","create","constructor","detach","createDocumentFragment","find","selector","len","nodeType","matches","queryResult","findAll","query","add","queryAllResult","querySelectorAll","j","numNodes","findComponent","firstNode","target","html","findParentNode","rendered","decodeCharacterReferences","detachNode","dirty","parentNode","anchor","findNextNode","insertBefore","Mustache","Yielder","Item$$1","component","containerFragment","yielders","_inlinePartials","parse","parent","bubble","findAllComponents","skipParent","occupants","setTemplate","partials","partialTemplate","escape","shouldDestroy","constructors","ALIAS","Alias","DOCTYPE","Doctype","INTERPOLATOR","Interpolator","PARTIAL","Partial","SECTION","Section","TRIPLE","YIELDER","ATTRIBUTE","Attribute","BINDING_FLAG","BindingFlag","DECORATOR","Decorator","EVENT","EventDirective","TRANSITION","specialElements","doctype","form","Form","input","Input","option","Option","select","Select","textarea","Textarea","isRoot","componentParent","context","cssIds","dirtyArgs","dirtyValue","createItems","items","bind$2","bound","runloop","addFragment","max","createItem","item","found","findContext","viewmodel","type","ELEMENT","el","findRepeatingFragment","isIteration","source","processItems","_guid","parsed","parseJSON","argsList","resetTemplate","wasBound","wasRendered","callback","ReferenceResolver","shuffled","toHtml","toEscapedString","toString$2","unrenderAndDestroy$1","unrender$1$1","updating","addFragmentToRoot","update$1$1","reverse$1","makeArrayMethod","path","shift$1","sort$1","splice$1","teardownHook$1","Hook","unrenderHook$1","unshift$1","proto","Ractive$add","animate","Ractive$animate","Ractive$detach","Ractive$find","Ractive$findAll","Ractive$findAllComponents","Ractive$findComponent","findContainer","Ractive$findContainer","findParent","Ractive$findParent","Ractive$fire","Ractive$get","getNodeInfo","insert","Ractive$insert","link","link$2","merge","thisRactive$merge","observe","observeList","observeOnce","off","Ractive$off","on","Ractive$on","once","Ractive$once","pop","pop$1","push$1","Ractive$render","reset","Ractive$reset","resetPartial","Ractive$resetTemplate","reverse","set","Ractive$set","shift","sort","subtract","Ractive$subtract","teardown","Ractive$teardown","toggle","Ractive$toggle","toCSS","Ractive$toCSS","toCss","toHTML","Ractive$toHTML","Ractive$transition","unlink","unlink$2","Ractive$unrender","unshift","Ractive$update","updateModel","Ractive$updateModel","wrap$1","method","superMethod","force","needsSuper","result","hasSuper","_super","FUNCTION","Date","now","String","trim","Array","filter","Ractive","defineProperties","DEBUG","writable","DEBUG_PROMISES","extend","extend$3","escapeKey","staticInfo","joinKeys","splitKeypath","splitKeypath$1","unescapeKey","getCSS","Promise","enhance","svg","magic","VERSION","adaptors","components","decorators","events","interpolators","transitions","Binding$$1","handleDomEvent","lazy","attachEvent","ContentEditableBinding","setFromNode","Binding","GenericBinding","getInitialValue","getValue","timeout","isNumeric","handler","handleDelay","handleBlur","MultipleSelectBinding","forceUpdate","attribute","locked","scheduleTask","selectedValues","optionValue","_ractive","handleChange","previousValue","arrayContentsMatch","selectedOptions","getSelectedOptions","setValue","keypath","initialValue","NumericBinding","GenericBinding$$1","isNaN","siblings","RadioBinding","getSiblings","checked","root","binding","end","RadioNameBinding","group","getBindingGroup","getValue$2","nameAttributeBinding","getKeypath","getKeypathModel","lastVal","setting","lastValue","SingleSelectBinding","optionWasSelected","disabled","endsWithSemi","Element","liveQueries","e","isVoid","voidElementNames","attributes","leftovers","m","ConditionalAttribute","attr","deferContent","recreateTwowayBinding","createTwowayBinding","shouldBind","twoway","selectBinding","matches$$1","live","namespace","getNamespace","existing","nodeName","defineProperty","proxy","setAttribute","foundNode","children","toArray","childNodes","wasUndefined","removeAttribute","render$1$1","updateLiveQueries$1","transitionsEnabled","registerTransition","makeDirty$2","attrs","stringifyAttribute","isSelected","inputIsCheckedRadio","cls","safeAttributeString","getString","styleName","decamelize","inlineClass","escapeHtml","detachWhenReady","removeFromLiveQueries","Element$$1","formBindings","handleReset","isStatic","resolve$3","safe","safeToStringValue","inAttributes","nodeValue","createTextNode","string","data","defaultValue","Mapping","instance","joinKey","createMapping","boundFragment","updateDelegate","findParentSelect","selectedAttribute","selectValue","refName","templateObj","getPartialTemplate","named","parsePartial","forceResetTemplate","inAttribute","doInAttributes","RepeatedFragment","iterations","indexRef","keyRef","pendingNewIndices","previousIterations","createIteration","isObject","refs","split","key","z","aliases","iteration","shuffle","newIndices","slice","newIndex","oldIndex","unrenderAndDestroy","updatePostShuffle","toRemove","oldKeys","wasArray","newLength","indices","oldLen","removed","frag","contiguous","startIndex","k","sectionType","templateSectionType","subordinate","l","sibling","nextSibling","SECTION_UNLESS","isTruthy","isEmpty","SECTION_IF","SECTION_EACH","siblingFalsey","lastType","getType","newFragment","SECTION_WITH","SECTION_IF_WITH","fragmentShouldExist","sync","defaultSelected","selectNode","o","isMultiple","shouldSelect","valueContains","Input$$1","isBindable","TEXT","hyphenatedStr","$1","space","specials$2","float","remove$1","textTypes","accept-charset","accesskey","bgcolor","class","codebase","colspan","contenteditable","datetime","dirname","for","http-equiv","ismap","maxlength","novalidate","pubdate","readonly","rowspan","tabindex","usemap","booleanAttributes","namespaces","useProperty","isTwoway","isBoolean","lookupNamespace","getUpdateDelegate","twowayBinding","flag","set$3","div$1","noop","isSvg","parseAttributes","notIn","processWrapper","array","methodName","__model","mutatorMethods","patchedArrayProto","getNewIndices","wrappers","patchArrayMethods","unpatchArrayMethods","__proto__","configurable","unpatch","patch","errorMessage$1","arrayAdaptor","object","wrap","ArrayWrapper","instances","storage","magicAdaptor","MagicWrapper","magicAdaptor$1","originalDescriptors","originalDescriptor","getOwnPropertyDescriptor","childKeypath","descriptor","createOrWrapDescriptor","__magic","revert","dependants","MagicArrayWrapper","magicWrapper","arrayWrapper","magicArrayAdaptor","Computation","Model$$1","signature","isExpression","isReadonly","setter","computationContext","dependencies","childByKey","deps","shouldCapture","capture","adapt","startCapturing","getter","message","hasConsole","console","groupCollapsed","functionBody","prettify","getterString","stack","getterUseStack","truncateStack","error","groupEnd","stopCapturing","setDependencies","links","marked","handleChange$1$1","clearUnresolveds","ComputationChild","mark","model$1","computations","dependent","Model","RactiveModel","changes","hasProp$1","RootModel","expressions","applyChanges","_changeHash","flush","compute","computation","createLink","targetPath","virtual","getVirtual","getRactiveModel","ractiveModel","getValueChildren","_link","has","Function","opts","GlobalModel$1","substr","localKey","origin","local","shouldTeardown","mark$1$1","retrieve","constructHook","registryNames$1","uid","HookQueue","hook","inProcess","queue","begin","getChildQueue","fire$1","configHook","initHook","DOMEvent","fatal","listen","directive","warnOnce","original","unlisten","CustomEvent","eventPlugin","RactiveEvent","cancel","specialPattern","dollarArgsPattern","COMPONENT","action","specialMatch","special","dollarMatch","passedArgs","addHelpers","obj","oldEvent","preventDefault","stopPropagation","fireEvent","addShuffleTask","teardownHook","Component","ComponentConstructor","p","content","_partials","construct","eventHandlers","setupEvents","initialise","checkYielders","render$2","updateLiveQueries","handlers","eventNames","makeDirty$1","_observers","cancel$1","removeFromLiveComponentQueries","__ractive_instances__","missingDecorator","dynamicName","dynamicArgs","nameFragment","argsFragment","intermediary","nameChanged","args$1","isUnresolved","forceResolution","warnAboutAmbiguity","parentForm","findParentForm","resetValue","registerTwowayBinding","unregisterTwowayBinding","CheckboxBinding","BindingGroup","bindings","push$2","CheckboxNameBinding","checkboxName","getValue$1$1","noInitialValue","existingValue","bindingValue","arrayContains","changed","wasChecked","isChecked","valueSoFar","resolved","resolveAmbiguousReference","reference","joinAll","removeUnresolved","addUnresolved","unresolved","contexts","c","Observer","init","dispatch","oldValue","newValue","defer","strict","cancelled","isEqual","addObserver","PatternObserver","baseModel","pattern","baseKeypath","oldValues","newValues","partial","findMatches","registerPatternObserver","unregisterPatternObserver","newKeys","wildcards","notify","base","touchedFrom","ok","ListObserver","pending","sliced","negativeOne","inserted","deleted","hadIndex","onceOptions","notEmptyString","PREFIX","styleDefinitions","isDirty","styleElement","useCssText","getElementsByTagName","styleSheet","Parser","ParseError","renderHook","completeHook","adaptConfigurator","Parent","combine","ensureArray","selectorsPattern","commentsPattern","selectorUnitPattern","excludePattern","dataRvcGuidPattern","cssConfigurator","css","id","uuid","noCssTransform","transformCss","cssId","addCSS","dataConfigurator","combine$1","bind$1$1","TEMPLATE_VERSION","functions","leadingWhitespace","lineStart","lines","lineEnds","line","lineEnd","read","leftover","remaining","postProcess","converters","getLinePos","char","columnNum","lineNum","numTabs","annotation","character","shortMessage","matchString","matchPattern","allowWhitespace","nextChar","Child","hasOwn","stringMiddlePattern","escapeSequencePattern","lineContinuationPattern","Parser$1","INVERTED","CLOSING","COMMENT","DELIMCHANGE","CLOSING_TAG","INLINE_PARTIAL","NUMBER_LITERAL","STRING_LITERAL","ARRAY_LITERAL","OBJECT_LITERAL","BOOLEAN_LITERAL","REGEXP_LITERAL","GLOBAL","KEY_VALUE_PAIR","REFERENCE","REFINEMENT","MEMBER","PREFIX_OPERATOR","BRACKETED","CONDITIONAL","INFIX_OPERATOR","INVOCATION","ELSE","ELSEIF","delimiterChangePattern","whitespacePattern","regexpPattern","pattern$1","regExpCache","getLowestIndex","haystack","needles","search","escapeRegExp","htmlEntities","quot","amp","apos","lt","gt","nbsp","iexcl","cent","pound","curren","yen","brvbar","sect","uml","copy","ordf","laquo","not","shy","reg","macr","deg","plusmn","sup2","sup3","acute","micro","para","middot","cedil","sup1","ordm","raquo","frac14","frac12","frac34","iquest","Agrave","Aacute","Acirc","Atilde","Auml","Aring","AElig","Ccedil","Egrave","Eacute","Ecirc","Euml","Igrave","Iacute","Icirc","Iuml","ETH","Ntilde","Ograve","Oacute","Ocirc","Otilde","Ouml","times","Oslash","Ugrave","Uacute","Ucirc","Uuml","Yacute","THORN","szlig","agrave","aacute","acirc","atilde","auml","aring","aelig","ccedil","egrave","eacute","ecirc","euml","igrave","iacute","icirc","iuml","eth","ntilde","ograve","oacute","ocirc","otilde","ouml","divide","oslash","ugrave","uacute","ucirc","uuml","yacute","thorn","yuml","OElig","oelig","Scaron","scaron","Yuml","fnof","circ","tilde","Alpha","Beta","Gamma","Delta","Epsilon","Zeta","Eta","Theta","Iota","Kappa","Lambda","Mu","Nu","Xi","Omicron","Pi","Rho","Sigma","Tau","Upsilon","Phi","Chi","Psi","Omega","alpha","beta","gamma","delta","epsilon","zeta","eta","theta","iota","kappa","lambda","mu","nu","xi","omicron","pi","rho","sigmaf","sigma","tau","upsilon","phi","chi","psi","omega","thetasym","upsih","piv","ensp","emsp","thinsp","zwnj","zwj","lrm","rlm","ndash","mdash","lsquo","rsquo","sbquo","ldquo","rdquo","bdquo","dagger","Dagger","bull","hellip","permil","prime","Prime","lsaquo","rsaquo","oline","frasl","euro","image","weierp","real","trade","alefsym","larr","uarr","rarr","darr","harr","crarr","lArr","uArr","rArr","dArr","hArr","forall","part","exist","empty","nabla","isin","notin","ni","prod","sum","minus","lowast","radic","infin","ang","and","or","cap","cup","int","there4","sim","cong","asymp","ne","equiv","le","ge","sub","sup","nsub","sube","supe","oplus","otimes","perp","sdot","lceil","rceil","lfloor","rfloor","lang","rang","loz","spades","clubs","hearts","diams","controlCharacters","entityPattern","codePointSupport","fromCodePoint","codeToChar","fromCharCode","lessThan","greaterThan","invalid","expectedExpression","expectedParen","numberPattern","globals","keywords","makeQuotedStringMatcher","okQuote","parser","literal","done","charCodeAt","JSON","getSingleQuotedString","getDoubleQuotedString","readStringLiteral","identifier","readObjectLiteral","keyValuePairs","readKeyValuePairs","readArrayLiteral","expressionList","readExpressionList","prefixPattern","readTypeOf","makePrefixSequenceMatcher","legalReference","relaxedName","specials","specialCall","spreadPattern","readPrimary","readLiteral","readReference","readBracketedExpression","readMemberOrInvocation","expression","refinement","readRefinement","spreadArgs","symbol","fallthrough","readExpression","matcher","prefixOperators","readLogicalOr","makeInfixSequenceMatcher","readTypeof","left","right","infixOperators","ExpressionParser","readLogicalOr$1","specials$1","true","false","null","specialsPattern","numberPattern$1","placeholderPattern","placeholderAtStartPattern","onlyWhitespace","JsonParser","placeholder","number","stringLiteral","pair","getKeyValuePair","valueToken","methodCallPattern","disallowedContents","attributeNamePattern","onPattern","proxyEventPattern","reservedEventNames","decoratorPattern","transitionPattern","directives","intro-outro","intro","outro","decorator","unquotedAttributeValueTextPattern","delimiterChangeToken","exclude","legalAlias","asRE","yieldPattern","elsePattern","elsePattern$1","handlebarsBlockCodes","each","if","with","unless","indexRefPattern","keyIndexRefPattern","handlebarsBlockPattern","OPEN_COMMENT","CLOSE_COMMENT","leadingLinebreak","trailingLinebreak","stripStandalones","backOne","backTwo","lastSectionItem","isString","isComment","isSection","lastItem","trimWhitespace","leadingPattern","trailingPattern","contiguousWhitespace","preserveWhitespaceElements","leadingWhitespace$1","trailingWhitespace","leadingNewLine","trailingNewLine","closingTagPattern","tagNamePattern","validTagNameFollower","li","dt","dd","rt","rp","optgroup","thead","tbody","tfoot","tr","td","th","StandardParser","startPattern","namePattern","finishPattern","partialDefinitionSectionPattern","STANDARD_READERS","readPartial","readUnescaped","readSection","readYielder","readInterpolator","readComment","TRIPLE_READERS","readTriple","STATIC_READERS","computedStrings","computed","fromComputationString","READERS","readMustache","readHtmlComment","readElement$1","readText","PARTIAL_READERS","readPartialDefinitionComment$1","readPartialDefinitionSection","tripleDelimiters","staticDelimiters","staticTripleDelimiters","standardDelimiters","delimiters","tags","isTriple","open","close","readers","sortMustacheTags","sectionDepth","elementStack","script","sanitize","elements","eventAttributes","stripComments","preserveWhitespace","sanitizeElements","sanitizeEventAttributes","includeLinePositions","textOnlyMode","csp","cleanup","expr","insertExpressions","readTemplate","b","parseOptions","TEMPLATE_INSTRUCTIONS","COMPUTATION_INSTRUCTIONS","fromId","noThrow","getElementById","isParsed","getParseOptions","reduce","val","throwNoParse","addFunctions","parseFor","templateConfigurator","parseTemplate","getDynamicTemplate","_config","extendPartials","registryNames","Registry","useDefaults","configure","registry","isOwner","registries","custom","defaultKeys","isStandardKey","makeObj","isBlacklisted","order","config","configure$1","shouldRerender","completeHook$1","resetHook","renderHook$1","unrenderHook","collection","collect","forceResetTemplate$1","parentValue","ExpressionProxy","createResolver","actuallyChanged","registered","dep","ReferenceExpressionChild","applyValue","ReferenceExpressionProxy","baseResolver","members","keypathModel","oneway","findBoundValue","resolveAliases","getComponentConstructor","ElementConstructor","guid","counter","placeholderId","newModel","set$1","build","add$1","torndown","TypeError","badArguments","gather","uniqueCssIds","ids","HTMLElement","here","lastLink","cascade","updateFromBindings","unwrap","addRegistries","addOtherOptions","_Parent","addRegistry","_method","extendOne","append","modifyArrays","isolated","noIntro","linear","easeIn","Math","pow","easeOut","easeInOut","window","document","navigator","appName","warn","div","methodNames","unprefixed","prefixed","makeFunction","implementation","hasFeature","mathml","xlink","xml","xmlns","ns","createElementNS","cloneNode","camel","decamel","desc","F","log","printWarning","welcome","toString$1$1","alreadyWarned","welcomeIntro","welcomeMessage","hasGroup","noRegistryFunctionReturn","from","intermediate","min","properties","snap","deprecations","deprecated","replacement","deprecate","arg","_Promise","PENDING","FULFILLED","REJECTED","dispatchHandlers","makeResolver","reject","fulfilledHandlers","rejectedHandlers","state","newState","makeDispatcher","wait","onFulfilled","onRejected","promise2","processResolutionHandler","forward","p1result","resolve$1","all","promises","processPromise","reason","TransitionManager","intros","outros","totalChildren","outroChildren","detachQueue","outrosComplete","addChild","list","decrementOutros","check","decrementTotal","detachNodes","detach$1","_detachNodes","ready","detachImmediate","batch","changeHook","returnPromise","fulfilPromise","previousBatch","transitionManager","fragments","tasks","immediateObservers","deferredObservers","ractives","flushChanges","addInstance","observer","thing","task","postRender","_batch","refPattern","splitPattern","escapeKeyPattern","unescapeKeyPattern","star","errorMessage","noAnimation","detachHook","Query","isComponentQuery","makeDirty","_root","nodeOrComponent","sortByItemPosition","sortByDocumentPosition","captureGroup","starMaps","wildcardCache","KeyModel","isKey","dependant","registerLink","unregisterLink","KeypathModel","isKeypath","getChild","rebindChildren","removeChild","hasProp","shuffleTasks","early","registerQueue","ModelBase","keyModels","unresolvedByKey","patternObservers","stage","specificKey","hasKey","attemptResolution","existingMatches","loop","getKeyModel","skip","child$1","notifyUpstream","prev","notifiedUpstream","relinking","registerChange","rewrap","LinkModel","ModelBase$$1","isLink","sourcePath","relinked","shuffling","upstream","teardown$1$1","lnk","fireShuffleTasks","ln","requestAnimationFrame","vendors$$1","lastTime","win$$1","currTime","timeToCall","rAF","getTime","performance","tickers","running","tick","elapsed","eased","stop","abort","prefixers","ticker","createBranch","adaptor","getPrefixer","branch","old","comparator","oldArray","newArray","recreateArray","oldLength","usedIndices","firstUnusedIndex","GlobalModel","global","keypathExpr","arrayProto","mdl","result$1","promise$1","comparators","updateHook","modelPush","modelPop","modelShift","modelUnshift","modelSort","modelSplice","modelReverse","insertHook","normalise","nearest","readAttributeValue","valueStart","startDepth","readQuotedAttributeValue","readUnquotedAttributeValue","readUnquotedAttributeValueToken","text","tokens","token","quoteMark","readQuotedStringToken","readAttributeOrDirective","readAttribute","processDirective","mustache","inside","readMustacheOfType","inTag","tag","reader","readDelimiterChange","rewind","readNumberLiteral","refineExpression","referenceExpression","getReferenceExpression","rx","flattenExpression","triple","readAliases","alias","readAlias","relaxedNames","strictRefinement","readExpressionOrReference","expectedFollowers","yielder","readClosing","closing","readElse","readElseIf","section","hasElse","block","unlessBlock","conditions","closed","expectedClose","aliasOnly","extra","endIndex","comment","removeLeadingWhitespace","removeTrailingWhitespace","previousItem","nextItem","preserveWhitespaceInsideFragment","removeLeadingWhitespaceInsideFragment","removeTrailingWhitespaceInsideFragment","isPreserveWhitespaceElement","readClosingTag","selfClosing","hasPartials","closingTag","lowerCaseName","canContain","closingTagName","disallowed","barrier","endPattern","addTo","hasChildren","fromExpression","instructions","createFunction","body","createFunctionFromString","bindTo","initial","parseAsString","validate$1","existingPartials","newPartials","overwrite","getSuperMethod","_parent","oldSuper","getMessage","correct","isError","deprecateOption","deprecatedOption","extendOtherMethods","member","rerender","dest","orComponent","readStyle","rule","rules","readClass","updateId","updateMultipleSelectValue","updateSelectValue","updateStringValue","updateContentEditableValue","updateRadioValue","updateValue","updateRadioName","updateCheckboxName","updateStyleAttribute","updateInlineStyle","updateClassName","updateInlineClass","type$1","updateBoolean","updateNamespacedAttribute","updateAttribute","wasSelected","valueAttribute","camelize","className","removeAttributeNS","setAttributeNS","qualified","hasAttribute","needle","enumerable","fnBody","tabs","minIndent","Infinity","truncated","getComputationSignature","setterString","initialiseProperties","deprecateRactiveData","getAdaptors","combine$2","protoAdapt","lookup","magic$$1","_subs","_eventQueue","_liveQueries","_liveComponentQueries","hookQueue","childQueue","userOptions","getElement","logIfDebug","description","res","bindName","bindChecked","typeAttribute","nameAttribute","xmlns$$1","updateModel$2","childData","getPartialFromRegistry","fillGaps","findParentPartial","findInstance","findOwner","findConstructor","hasIndexRef","factory","exports","module","define","amd","noConflict","output","sources","isFinite","format","registryName","interpol","arrayLike","called","resolvePromise","rejectPromise","y","tm","notifiedTotal","manager","trans","collectAllOutros","contains","dispatch$1","which","ractive$1","pairs","sets","getOptions","easing$$1","animate$1","isDetached","otherNode","compareDocumentPosition","bitmask","mutualAncestor","ancestryA","getAncestry","ancestryB","oldestA","oldestB","fragmentA","fragmentB","indexA","indexB","indexA$1","indexB$1","getParent","ancestry","ancestor","enqueue","dequeue","getPotentialWildcardMatches","starMap","mapper","wildcardKeypath","getStarMap","num","binary","ones","parseInt","digit","_noArg","getWildcardNames","fireEventAs","initialFire","subscribers","notifySubscribers","fullName","originalEvent","stopEvent","badReference","hasContextChain","crossedComponentBoundary","localViewmodel","parts","prefixKeypath","rootKeypath","rootDot","relativeKeypath","match$1","repeater","gatherRefs","spliceArguments","removeStart","removeEnd","balance","getSpliceEquivalent","getComparator","stringify","merge$2","compare","update$3","build$1","findModel","get$1","_element","resolve$2","add$2","animate$2","link$1","there","merge$1","set$2","drop","unlink$1","update$2","updateModel$1","isBound","getBindingModel","getBindingPath","getBinding","ctx","setBinding","rootpath","fireInsertHook","observers","createObserver","keypaths","wildcardIndex","listeners","listener","styleDefinition","applyCSS","cssText","filteredStyleDefinitions","others","trim$1","extractString","unit","transformSelector","selectorUnits","modifiers","transformed","appended","prepended","dataAttr","selectors","s4","floor","random","validate","childValue","parentIsFn","childIsFn","callDataFunction","fromProperties","primary","secondary","hasThis","exp","opening","entity","code","validateCode","readNumberLiteral$1","readBooleanLiteral","readKey","readKeyValuePair","refKey","startPos","fullLength","lastDotIndex","spread","lastIndexOf","refLength","name$$1","getConditional","ifTrue","ifFalse","getVars","vars","count","stringified","extractRefs","parentParser","colonIndex","directiveName","directiveArgs","parser$1"],"mappings":"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C,MAAO,IAAKC,OAAQ,IAAKC,KAAM,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,KAAM,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,KAAM,IAAKC,MAAO,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,KAAM,IAAKC,KAAM,IAAKC,KAAM,IAAKC,MAAO,IAAKC,MAAO,IAAKC,KAAM,IAAKC,MAAO,IAAKC,MAAO,IAAKC,QAAS,IAAKC,KAAM,IAAKC,IAAK,IAAKC,MAAO,IAAKC,KAAM,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,GAAI,IAAKC,GAAI,IAAKC,GAAI,IAAKC,QAAS,IAAKC,GAAI,IAAKC,IAAK,IAAKC,MAAO,IAAKC,IAAK,IAAKC,QAAS,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,MAAO,IAAKC,MAAO,IAAKC,KAAM,IAAKC,MAAO,IAAKC,MAAO,IAAKC,QAAS,IAAKC,KAAM,IAAKC,IAAK,IAAKC,MAAO,IAAKC,KAAM,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,GAAI,IAAKC,GAAI,IAAKC,GAAI,IAAKC,QAAS,IAAKC,GAAI,IAAKC,IAAK,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,IAAK,IAAKC,QAAS,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,MAAO,IAAKC,SAAU,IAAKC,MAAO,IAAKC,IAAK,IAAKC,KAAM,KAAMC,KAAM,KAAMC,OAAQ,KAAMC,KAAM,KAAMC,IAAK,KAAMC,IAAK,KAAMC,IAAK,KAAMC,MAAO,KAAMC,MAAO,KAAMC,MAAO,KAAMC,MAAO,KAAMC,MAAO,KAAMC,MAAO,KAAMC,MAAO,KAAMC,MAAO,KAAMC,OAAQ,KAAMC,OAAQ,KAAMC,KAAM,KAAMC,OAAQ,KAAMC,OAAQ,KAAMC,MAAO,KAAMC,MAAO,KAAMC,OAAQ,KAAMC,OAAQ,KAAMC,MAAO,KAAMC,MAAO,KAAMC,KAAM,KAAMC,MAAO,KAAMC,OAAQ,KAAMC,KAAM,KAAMC,MAAO,KAAMC,QAAS,KAAMC,KAAM,KAAMC,KAAM,KAAMC,KAAM,KAAMC,KAAM,KAAMC,KAAM,KAAMC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"}