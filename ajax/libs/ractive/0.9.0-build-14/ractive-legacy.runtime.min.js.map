{"version":3,"file":"ractive-legacy.runtime.min.js","sources":["ractive-legacy.runtime.js"],"sourcesContent":["/*\n\tRactive.js v0.9.0-edge\n\tWed Nov 16 2016 07:14:10 GMT+0000 (UTC) - commit 3cba8c713ddf8f6209ab82d2ae6c0192860c6601\n\n\thttp://ractivejs.org\n\thttp://twitter.com/RactiveJS\n\n\tReleased under the MIT License.\n*/\n\n\n(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n\ttypeof define === 'function' && define.amd ? define(factory) :\n\t((function() { var current = global.Ractive; var next = factory(); next.noConflict = function() { global.Ractive = current; return next; }; return global.Ractive = next; })());\n}(this, (function () { 'use strict';\n\nvar defaults = {\n\t// render placement:\n\tel:                     void 0,\n\tappend:\t\t\t\t    false,\n\n\t// template:\n\ttemplate:               null,\n\n\t// parse:\n\tdelimiters:             [ '{{', '}}' ],\n\ttripleDelimiters:       [ '{{{', '}}}' ],\n\tstaticDelimiters:       [ '[[', ']]' ],\n\tstaticTripleDelimiters: [ '[[[', ']]]' ],\n\tcsp: \t\t\t\t\ttrue,\n\tinterpolate:            false,\n\tpreserveWhitespace:     false,\n\tsanitize:               false,\n\tstripComments:          true,\n\tcontextLines:           0,\n\n\t// data & binding:\n\tdata:                   {},\n\tcomputed:               {},\n\tsyncComputedChildren:   false,\n\tresolveInstanceMembers: true,\n\twarnAboutAmbiguity:     false,\n\tmagic:                  false,\n\tmodifyArrays:           false,\n\tadapt:                  [],\n\tisolated:               false,\n\ttwoway:                 true,\n\tlazy:                   false,\n\n\t// transitions:\n\tnoIntro:                false,\n\ttransitionsEnabled:     true,\n\tcomplete:               void 0,\n\n\t// css:\n\tcss:                    null,\n\tnoCssTransform:         false\n};\n\n// These are a subset of the easing equations found at\n// https://raw.github.com/danro/easing-js - license info\n// follows:\n\n// --------------------------------------------------\n// easing.js v0.5.4\n// Generic set of easing functions with AMD support\n// https://github.com/danro/easing-js\n// This code may be freely distributed under the MIT license\n// http://danro.mit-license.org/\n// --------------------------------------------------\n// All functions adapted from Thomas Fuchs & Jeremy Kahn\n// Easing Equations (c) 2003 Robert Penner, BSD license\n// https://raw.github.com/danro/easing-js/master/LICENSE\n// --------------------------------------------------\n\n// In that library, the functions named easeIn, easeOut, and\n// easeInOut below are named easeInCubic, easeOutCubic, and\n// (you guessed it) easeInOutCubic.\n//\n// You can add additional easing functions to this list, and they\n// will be globally available.\n\n\nvar easing = {\n\tlinear: function linear ( pos ) { return pos; },\n\teaseIn: function easeIn ( pos ) { return Math.pow( pos, 3 ); },\n\teaseOut: function easeOut ( pos ) { return ( Math.pow( ( pos - 1 ), 3 ) + 1 ); },\n\teaseInOut: function easeInOut ( pos ) {\n\t\tif ( ( pos /= 0.5 ) < 1 ) { return ( 0.5 * Math.pow( pos, 3 ) ); }\n\t\treturn ( 0.5 * ( Math.pow( ( pos - 2 ), 3 ) + 2 ) );\n\t}\n};\n\n/* global console, navigator */\n/* eslint no-console:\"off\" */\n\nvar win = typeof window !== 'undefined' ? window : null;\nvar doc = win ? document : null;\n\nvar isClient = !!doc;\nvar isJsdom = ( typeof navigator !== 'undefined' && /jsDom/.test( navigator.appName ) );\nvar hasConsole = ( typeof console !== 'undefined' && typeof console.warn === 'function' && typeof console.warn.apply === 'function' );\n\nvar magic;\ntry {\n\tObject.defineProperty({}, 'test', { value: 0 });\n\tmagic = true;\n} catch ( e ) {\n\tmagic = false;\n}\n\nvar svg = doc ?\n\tdoc.implementation.hasFeature( 'http://www.w3.org/TR/SVG11/feature#BasicStructure', '1.1' ) :\n\tfalse;\n\nvar vendors = [ 'o', 'ms', 'moz', 'webkit' ];\n\nvar noop = function () {};\n\nvar exportedShims;\n\nif ( !win ) {\n\texportedShims = null;\n} else {\n\texportedShims = {};\n\n\t// Shims for older browsers\n\n\tif ( !Date.now ) {\n\t\tDate.now = function () { return +new Date(); };\n\t}\n\n\tif ( !String.prototype.trim ) {\n\t\tString.prototype.trim = function () {\n\t\t\treturn this.replace(/^\\s+/, '').replace(/\\s+$/, '');\n\t\t};\n\t}\n\n\t// Polyfill for Object.create\n\tif ( !Object.create ) {\n\t\tObject.create = (function () {\n\t\t\tvar Temp = function () {};\n\t\t\treturn function ( prototype, properties ) {\n\t\t\t\tif ( typeof prototype !== 'object' ) {\n\t\t\t\t\tthrow new TypeError( 'Prototype must be an object' );\n\t\t\t\t}\n\t\t\t\tTemp.prototype = prototype;\n\t\t\t\tvar result = new Temp();\n\t\t\t\tdefineProperties( result, properties );\n\t\t\t\tTemp.prototype = null;\n\t\t\t\treturn result;\n\t\t\t};\n\t\t})();\n\t}\n\n\t// Polyfill Object.defineProperty\n\tif ( !Object.defineProperty ) {\n\t\tObject.defineProperty = defineProperty;\n\t}\n\n\tif ( !Object.freeze ) {\n\t\tObject.freeze = function () { 'LOL'; };\n\t}\n\n\t// Polyfill for Object.keys\n\t// https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/keys\n\tif ( !Object.keys ) {\n\t\tObject.keys = (function () {\n\t\t\tvar hasOwnProperty = Object.prototype.hasOwnProperty;\n\t\t\tvar hasDontEnumBug = !({toString: null}).propertyIsEnumerable('toString');\n\t\t\tvar dontEnums = [\n\t\t\t\t'toString',\n\t\t\t\t'toLocaleString',\n\t\t\t\t'valueOf',\n\t\t\t\t'hasOwnProperty',\n\t\t\t\t'isPrototypeOf',\n\t\t\t\t'propertyIsEnumerable',\n\t\t\t\t'constructor'\n\t\t\t];\n\t\t\tvar dontEnumsLength = dontEnums.length;\n\n\t\t\treturn function ( obj ) {\n\t\t\t\tif ( typeof obj !== 'object' && typeof obj !== 'function' || obj === null ) {\n\t\t\t\t\tthrow new TypeError( 'Object.keys called on non-object' );\n\t\t\t\t}\n\n\t\t\t\tvar result = [];\n\n\t\t\t\tfor ( var prop in obj ) {\n\t\t\t\t\tif ( hasOwnProperty.call( obj, prop ) ){\n\t\t\t\t\t\tresult.push( prop );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( hasDontEnumBug ) {\n\t\t\t\t\tfor ( var i=0; i < dontEnumsLength; i++ ) {\n\t\t\t\t\t\tif ( hasOwnProperty.call( obj, dontEnums[i] ) ){\n\t\t\t\t\t\t\tresult.push( dontEnums[i] );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t};\n\t\t}());\n\t}\n\n\t// TODO: use defineProperty to make these non-enumerable\n\n\t// Array extras\n\tif ( !Array.prototype.indexOf ) {\n\t\tArray.prototype.indexOf = function ( needle, i ) {\n\t\t\tvar this$1 = this;\n\n\t\t\tvar len;\n\n\t\t\tif ( i === undefined ) {\n\t\t\t\ti = 0;\n\t\t\t}\n\n\t\t\tif ( i < 0 ) {\n\t\t\t\ti+= this.length;\n\t\t\t}\n\n\t\t\tif ( i < 0 ) {\n\t\t\t\ti = 0;\n\t\t\t}\n\n\t\t\tfor ( len = this.length; i<len; i++ ) {\n\t\t\t\tif ( this$1.hasOwnProperty( i ) && this$1[i] === needle ) {\n\t\t\t\t\treturn i;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn -1;\n\t\t};\n\t}\n\n\tif ( !Array.prototype.forEach ) {\n\t\tArray.prototype.forEach = function ( callback, context ) {\n\t\t\tvar this$1 = this;\n\n\t\t\tvar i, len;\n\n\t\t\tfor ( i=0, len=this.length; i<len; i+=1 ) {\n\t\t\t\tif ( this$1.hasOwnProperty( i ) ) {\n\t\t\t\t\tcallback.call( context, this$1[i], i, this$1 );\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\n\tif ( !Array.prototype.map ) {\n\t\tArray.prototype.map = function ( mapper, context ) {\n\t\t\tvar i, len, isActuallyString;\n\t\t\tvar array = this;\n\t\t\tvar mapped = [];\n\n\t\t\t// incredibly, if you do something like\n\t\t\t// Array.prototype.map.call( someString, iterator )\n\t\t\t// then `this` will become an instance of String in IE8.\n\t\t\t// And in IE8, you then can't do string[i]. Facepalm.\n\t\t\tif ( array instanceof String ) {\n\t\t\t\tarray = array.toString();\n\t\t\t\tisActuallyString = true;\n\t\t\t}\n\n\t\t\tfor ( i=0, len=array.length; i<len; i+=1 ) {\n\t\t\t\tif ( array.hasOwnProperty( i ) || isActuallyString ) {\n\t\t\t\t\tmapped[i] = mapper.call( context, array[i], i, array );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn mapped;\n\t\t};\n\t}\n\n\tif ( typeof Array.prototype.reduce !== 'function' ) {\n\t\tArray.prototype.reduce = function(callback, opt_initialValue){\n\t\t\tvar this$1 = this;\n\n\t\t\tvar i, value, valueIsSet;\n\n\t\t\tif ('function' !== typeof callback) {\n\t\t\t\tthrow new TypeError(callback + ' is not a function');\n\t\t\t}\n\n\t\t\tvar len = this.length;\n\t\t\tvalueIsSet = false;\n\n\t\t\tif ( arguments.length > 1 ) {\n\t\t\t\tvalue = opt_initialValue;\n\t\t\t\tvalueIsSet = true;\n\t\t\t}\n\n\t\t\tfor ( i = 0; i < len; i += 1) {\n\t\t\t\tif ( this$1.hasOwnProperty( i ) ) {\n\t\t\t\t\tif ( valueIsSet ) {\n\t\t\t\t\t\tvalue = callback(value, this$1[i], i, this$1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tvalue = this$1[i];\n\t\t\t\t\tvalueIsSet = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( !valueIsSet ) {\n\t\t\t\tthrow new TypeError( 'Reduce of empty array with no initial value' );\n\t\t\t}\n\n\t\t\treturn value;\n\t\t};\n\t}\n\n\tif ( !Array.prototype.filter ) {\n\t\tArray.prototype.filter = function ( filter, context ) {\n\t\t\tvar this$1 = this;\n\n\t\t\tvar i, len;\n\t\t\tvar filtered = [];\n\n\t\t\tfor ( i=0, len=this.length; i<len; i+=1 ) {\n\t\t\t\tif ( this$1.hasOwnProperty( i ) && filter.call( context, this$1[i], i, this$1 ) ) {\n\t\t\t\t\tfiltered[ filtered.length ] = this$1[i];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn filtered;\n\t\t};\n\t}\n\n\tif ( !Array.prototype.every ) {\n\t\tArray.prototype.every = function ( iterator, context ) {\n\t\t\tvar i;\n\n\t\t\tif ( this == null ) {\n\t\t\t\tthrow new TypeError();\n\t\t\t}\n\n\t\t\tvar t = Object( this );\n\t\t\tvar len = t.length >>> 0;\n\n\t\t\tif ( typeof iterator !== 'function' ) {\n\t\t\t\tthrow new TypeError();\n\t\t\t}\n\n\t\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\t\tif ( i in t && !iterator.call( context, t[i], i, t) ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn true;\n\t\t};\n\t}\n\n\tif ( typeof Function.prototype.bind !== 'function' ) {\n\t\tFunction.prototype.bind = function ( context ) {\n\t\t\tvar slice = [].slice;\n\n\t\t\tif ( typeof this !== 'function' ) {\n\t\t\t\tthrow new TypeError( 'Function.prototype.bind called on non-function' );\n\t\t\t}\n\n\t\t\tvar args = slice.call( arguments, 1 );\n\t\t\tvar fn = this;\n\t\t\tvar Empty = function () {};\n\n\t\t\tvar bound = function () {\n\t\t\t\tvar ctx = this instanceof Empty && context ? this : context;\n\t\t\t\treturn fn.apply( ctx, args.concat( slice.call( arguments ) ) );\n\t\t\t};\n\n\t\t\tEmpty.prototype = this.prototype;\n\t\t\tbound.prototype = new Empty();\n\n\t\t\treturn bound;\n\t\t};\n\t}\n\n\t// https://gist.github.com/Rich-Harris/6010282 via https://gist.github.com/jonathantneal/2869388\n\t// addEventListener polyfill IE6+\n\tif ( !win.addEventListener ) {\n\t\t((function(win$$1, doc$$1) {\n\t\t\t// because sometimes inquiring minds want to know\n\t\t\twin$$1.appearsToBeIELessEqual8 = true;\n\n\t\t\tvar Event = function ( e, element ) {\n\t\t\t\tvar instance = this;\n\n\t\t\t\tfor ( var property in e ) {\n\t\t\t\t\tinstance[ property ] = e[ property ];\n\t\t\t\t}\n\n\t\t\t\tinstance.currentTarget =  element;\n\t\t\t\tinstance.target = e.srcElement || element;\n\t\t\t\tinstance.timeStamp = +new Date();\n\n\t\t\t\tinstance.preventDefault = function () {\n\t\t\t\t\te.returnValue = false;\n\t\t\t\t};\n\n\t\t\t\tinstance.stopPropagation = function () {\n\t\t\t\t\te.cancelBubble = true;\n\t\t\t\t};\n\t\t\t};\n\n\t\t\tvar addEventListener = function ( type, listener ) {\n\t\t\t\tvar element = this;\n\t\t\t\tvar listeners = element.listeners || ( element.listeners = [] );\n\t\t\t\tvar i = listeners.length;\n\n\t\t\t\tlisteners[i] = [ listener, function (e) {\n\t\t\t\t\tlistener.call( element, new Event( e, element ) );\n\t\t\t\t}];\n\n\t\t\t\telement.attachEvent( 'on' + type, listeners[i][1] );\n\t\t\t};\n\n\t\t\tvar removeEventListener = function ( type, listener ) {\n\t\t\t\tvar element = this;\n\n\t\t\t\tif ( !element.listeners ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar listeners = element.listeners;\n\t\t\t\tvar i = listeners.length;\n\n\t\t\t\twhile ( i-- ) {\n\t\t\t\t\tif (listeners[i][0] === listener) {\n\t\t\t\t\t\telement.detachEvent( 'on' + type, listeners[i][1] );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t\twin$$1.addEventListener = doc$$1.addEventListener = addEventListener;\n\t\t\twin$$1.removeEventListener = doc$$1.removeEventListener = removeEventListener;\n\n\t\t\tif ( 'Element' in win$$1 ) {\n\t\t\t\twin$$1.Element.prototype.addEventListener = addEventListener;\n\t\t\t\twin$$1.Element.prototype.removeEventListener = removeEventListener;\n\t\t\t} else {\n\t\t\t\t// First, intercept any calls to document.createElement - this is necessary\n\t\t\t\t// because the CSS hack (see below) doesn't come into play until after a\n\t\t\t\t// node is added to the DOM, which is too late for a lot of Ractive setup work\n\t\t\t\tvar origCreateElement = doc$$1.createElement;\n\n\t\t\t\tdoc$$1.createElement = function ( tagName ) {\n\t\t\t\t\tvar el = origCreateElement( tagName );\n\t\t\t\t\tel.addEventListener = addEventListener;\n\t\t\t\t\tel.removeEventListener = removeEventListener;\n\t\t\t\t\treturn el;\n\t\t\t\t};\n\n\t\t\t\t// Then, mop up any additional elements that weren't created via\n\t\t\t\t// document.createElement (i.e. with innerHTML).\n\t\t\t\tvar head = doc$$1.getElementsByTagName('head')[0];\n\t\t\t\tvar style = doc$$1.createElement('style');\n\n\t\t\t\thead.insertBefore( style, head.firstChild );\n\n\t\t\t\t//style.styleSheet.cssText = '*{-ms-event-prototype:expression(!this.addEventListener&&(this.addEventListener=addEventListener)&&(this.removeEventListener=removeEventListener))}';\n\t\t\t}\n\t\t})( win, doc ));\n\t}\n\n\t// The getComputedStyle polyfill interacts badly with jQuery, so we don't attach\n\t// it to window. Instead, we export it for other modules to use as needed\n\n\t// https://github.com/jonathantneal/Polyfills-for-IE8/blob/master/getComputedStyle.js\n\tif ( !win.getComputedStyle ) {\n\t\texportedShims.getComputedStyle = (function () {\n\t\t\tvar borderSizes = {};\n\n\t\t\tfunction getPixelSize ( element, style, property, fontSize ) {\n\t\t\t\tvar sizeWithSuffix = style[property];\n\t\t\t\tvar size = parseFloat(sizeWithSuffix);\n\t\t\t\tvar suffix = sizeWithSuffix.split(/\\d/)[0];\n\n\t\t\t\tif ( isNaN( size ) ) {\n\t\t\t\t\tif ( /^thin|medium|thick$/.test( sizeWithSuffix ) ) {\n\t\t\t\t\t\tsize = getBorderPixelSize( sizeWithSuffix );\n\t\t\t\t\t\tsuffix = '';\n\t\t\t\t\t}\n\n\t\t\t\t\telse {\n\t\t\t\t\t\t// TODO...\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfontSize = fontSize != null ? fontSize : /%|em/.test(suffix) && element.parentElement ? getPixelSize(element.parentElement, element.parentElement.currentStyle, 'fontSize', null) : 16;\n\t\t\t\tvar rootSize = property == 'fontSize' ? fontSize : /width/i.test(property) ? element.clientWidth : element.clientHeight;\n\n\t\t\t\treturn (suffix == 'em') ? size * fontSize : (suffix == 'in') ? size * 96 : (suffix == 'pt') ? size * 96 / 72 : (suffix == '%') ? size / 100 * rootSize : size;\n\t\t\t}\n\n\t\t\tfunction getBorderPixelSize ( size ) {\n\t\t\t\tvar div, bcr;\n\n\t\t\t\t// `thin`, `medium` and `thick` vary between browsers. (Don't ever use them.)\n\t\t\t\tif ( !borderSizes[ size ] ) {\n\t\t\t\t\tdiv = doc.createElement( 'div' );\n\t\t\t\t\tdiv.style.display = 'block';\n\t\t\t\t\tdiv.style.position = 'fixed';\n\t\t\t\t\tdiv.style.width = div.style.height = '0';\n\t\t\t\t\tdiv.style.borderRight = size + ' solid black';\n\n\t\t\t\t\tdoc.getElementsByTagName( 'body' )[0].appendChild( div );\n\t\t\t\t\tbcr = div.getBoundingClientRect();\n\n\t\t\t\t\tborderSizes[ size ] = bcr.right - bcr.left;\n\t\t\t\t}\n\n\t\t\t\treturn borderSizes[ size ];\n\t\t\t}\n\n\t\t\tfunction setShortStyleProperty(style, property) {\n\t\t\t\tvar borderSuffix = property == 'border' ? 'Width' : '';\n\t\t\t\tvar t = property + \"Top\" + borderSuffix;\n\t\t\t\tvar r = property + \"Right\" + borderSuffix;\n\t\t\t\tvar b = property + \"Bottom\" + borderSuffix;\n\t\t\t\tvar l = property + \"Left\" + borderSuffix;\n\n\t\t\t\tstyle[property] = (style[t] == style[r] == style[b] == style[l] ? [style[t]]\n\t\t\t\t: style[t] == style[b] && style[l] == style[r] ? [style[t], style[r]]\n\t\t\t\t: style[l] == style[r] ? [style[t], style[r], style[b]]\n\t\t\t\t: [style[t], style[r], style[b], style[l]]).join(' ');\n\t\t\t}\n\n\t\t\tvar normalProps = {\n\t\t\t\tfontWeight: 400,\n\t\t\t\tlineHeight: 1.2, // actually varies depending on font-family, but is generally close enough...\n\t\t\t\tletterSpacing: 0\n\t\t\t};\n\n\t\t\tfunction CSSStyleDeclaration(element) {\n\t\t\t\tvar currentStyle = element.currentStyle;\n\t\t\t\tvar style = this;\n\t\t\t\tvar fontSize = getPixelSize(element, currentStyle, 'fontSize', null);\n\n\t\t\t\t// TODO tidy this up, test it, send PR to jonathantneal!\n\t\t\t\tfor ( var property in currentStyle ) {\n\t\t\t\t\tif ( currentStyle[property] === 'normal' && normalProps.hasOwnProperty( property ) ) {\n\t\t\t\t\t\tstyle[ property ] = normalProps[ property ];\n\t\t\t\t\t} else if ( /width|height|margin.|padding.|border.+W/.test(property) ) {\n\t\t\t\t\t\tif ( currentStyle[ property ] === 'auto' ) {\n\t\t\t\t\t\t\tif ( /^width|height/.test( property ) ) {\n\t\t\t\t\t\t\t\t// just use clientWidth/clientHeight...\n\t\t\t\t\t\t\t\tstyle[ property ] = ( property === 'width' ? element.clientWidth : element.clientHeight ) + 'px';\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\telse if ( /(?:padding)?Top|Bottom$/.test( property ) ) {\n\t\t\t\t\t\t\t\tstyle[ property ] = '0px';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tstyle[ property ] = getPixelSize(element, currentStyle, property, fontSize) + 'px';\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (property === 'styleFloat') {\n\t\t\t\t\t\tstyle.float = currentStyle[property];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstyle[property] = currentStyle[property];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tsetShortStyleProperty(style, 'margin');\n\t\t\t\tsetShortStyleProperty(style, 'padding');\n\t\t\t\tsetShortStyleProperty(style, 'border');\n\n\t\t\t\tstyle.fontSize = fontSize + 'px';\n\n\t\t\t\treturn style;\n\t\t\t}\n\n\t\t\tCSSStyleDeclaration.prototype = {\n\t\t\t\tconstructor: CSSStyleDeclaration,\n\t\t\t\tgetPropertyPriority: noop,\n\t\t\t\tgetPropertyValue: function getPropertyValue ( prop ) {\n\t\t\t\t\treturn this[prop] || '';\n\t\t\t\t},\n\t\t\t\titem: noop,\n\t\t\t\tremoveProperty: noop,\n\t\t\t\tsetProperty: noop,\n\t\t\t\tgetPropertyCSSValue: noop\n\t\t\t};\n\n\t\t\tfunction getComputedStyle(element) {\n\t\t\t\treturn new CSSStyleDeclaration(element);\n\t\t\t}\n\n\t\t\treturn getComputedStyle;\n\t\t}());\n\t}\n}\n\nvar legacy = exportedShims;\n\nvar html   = 'http://www.w3.org/1999/xhtml';\nvar mathml = 'http://www.w3.org/1998/Math/MathML';\nvar svg$1    = 'http://www.w3.org/2000/svg';\nvar xlink  = 'http://www.w3.org/1999/xlink';\nvar xml    = 'http://www.w3.org/XML/1998/namespace';\nvar xmlns  = 'http://www.w3.org/2000/xmlns';\n\nvar namespaces = { html: html, mathml: mathml, svg: svg$1, xlink: xlink, xml: xml, xmlns: xmlns };\n\nvar createElement;\nvar matches;\nvar div;\nvar methodNames;\nvar unprefixed;\nvar prefixed;\nvar i;\nvar j;\nvar makeFunction;\n\n// Test for SVG support\nif ( !svg ) {\n\tcreateElement = function ( type, ns, extend ) {\n\t\tif ( ns && ns !== html ) {\n\t\t\tthrow 'This browser does not support namespaces other than http://www.w3.org/1999/xhtml. The most likely cause of this error is that you\\'re trying to render SVG in an older browser. See http://docs.ractivejs.org/latest/svg-and-older-browsers for more information';\n\t\t}\n\n\t\treturn extend ?\n\t\t\tdoc.createElement( type, extend ) :\n\t\t\tdoc.createElement( type );\n\t};\n} else {\n\tcreateElement = function ( type, ns, extend ) {\n\t\tif ( !ns || ns === html ) {\n\t\t\treturn extend ?\n\t\t\t\tdoc.createElement( type, extend ) :\n\t\t\t\tdoc.createElement( type );\n\t\t}\n\n\t\treturn extend ?\n\t\t\tdoc.createElementNS( ns, type, extend ) :\n\t\t\tdoc.createElementNS( ns, type );\n\t};\n}\n\nfunction createDocumentFragment () {\n\treturn doc.createDocumentFragment();\n}\n\nfunction getElement ( input ) {\n\tvar output;\n\n\tif ( !input || typeof input === 'boolean' ) { return; }\n\n\tif ( !win || !doc || !input ) {\n\t\treturn null;\n\t}\n\n\t// We already have a DOM node - no work to do. (Duck typing alert!)\n\tif ( input.nodeType ) {\n\t\treturn input;\n\t}\n\n\t// Get node from string\n\tif ( typeof input === 'string' ) {\n\t\t// try ID first\n\t\toutput = doc.getElementById( input );\n\n\t\t// then as selector, if possible\n\t\tif ( !output && doc.querySelector ) {\n\t\t\toutput = doc.querySelector( input );\n\t\t}\n\n\t\t// did it work?\n\t\tif ( output && output.nodeType ) {\n\t\t\treturn output;\n\t\t}\n\t}\n\n\t// If we've been given a collection (jQuery, Zepto etc), extract the first item\n\tif ( input[0] && input[0].nodeType ) {\n\t\treturn input[0];\n\t}\n\n\treturn null;\n}\n\nif ( !isClient ) {\n\tmatches = null;\n} else {\n\tdiv = createElement( 'div' );\n\tmethodNames = [ 'matches', 'matchesSelector' ];\n\n\tmakeFunction = function ( methodName ) {\n\t\treturn function ( node, selector ) {\n\t\t\treturn node[ methodName ]( selector );\n\t\t};\n\t};\n\n\ti = methodNames.length;\n\n\twhile ( i-- && !matches ) {\n\t\tunprefixed = methodNames[i];\n\n\t\tif ( div[ unprefixed ] ) {\n\t\t\tmatches = makeFunction( unprefixed );\n\t\t} else {\n\t\t\tj = vendors.length;\n\t\t\twhile ( j-- ) {\n\t\t\t\tprefixed = vendors[i] + unprefixed.substr( 0, 1 ).toUpperCase() + unprefixed.substring( 1 );\n\n\t\t\t\tif ( div[ prefixed ] ) {\n\t\t\t\t\tmatches = makeFunction( prefixed );\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// IE8...\n\tif ( !matches ) {\n\t\tmatches = function ( node, selector ) {\n\t\t\tvar parentNode, i;\n\n\t\t\tparentNode = node.parentNode;\n\n\t\t\tif ( !parentNode ) {\n\t\t\t\t// empty dummy <div>\n\t\t\t\tdiv.innerHTML = '';\n\n\t\t\t\tparentNode = div;\n\t\t\t\tnode = node.cloneNode();\n\n\t\t\t\tdiv.appendChild( node );\n\t\t\t}\n\n\t\t\tvar nodes = parentNode.querySelectorAll( selector );\n\n\t\t\ti = nodes.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tif ( nodes[i] === node ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn false;\n\t\t};\n\t}\n}\n\nfunction detachNode ( node ) {\n\t// stupid ie\n\tif ( node && typeof node.parentNode !== 'unknown' && node.parentNode ) { // eslint-disable-line valid-typeof\n\t\tnode.parentNode.removeChild( node );\n\t}\n\n\treturn node;\n}\n\nfunction safeToStringValue ( value ) {\n\treturn ( value == null || !value.toString ) ? '' : '' + value;\n}\n\nfunction safeAttributeString ( string ) {\n\treturn safeToStringValue( string )\n\t\t.replace( /&/g, '&amp;' )\n\t\t.replace( /\"/g, '&quot;' )\n\t\t.replace( /'/g, '&#39;' );\n}\n\nvar camel = /(-.)/g;\nfunction camelize ( string ) {\n\treturn string.replace( camel, function (s) { return s.charAt( 1 ).toUpperCase(); } );\n}\n\nvar decamel = /[A-Z]/g;\nfunction decamelize ( string ) {\n\treturn string.replace( decamel, function (s) { return (\"-\" + (s.toLowerCase())); } );\n}\n\nvar create;\nvar defineProperty;\nvar defineProperties;\n\ntry {\n\tObject.defineProperty({}, 'test', { get: function get() {}, set: function set() {} });\n\n\tif ( doc ) {\n\t\tObject.defineProperty( createElement( 'div' ), 'test', { value: 0 });\n\t}\n\n\tdefineProperty = Object.defineProperty;\n} catch ( err ) {\n\t// Object.defineProperty doesn't exist, or we're in IE8 where you can\n\t// only use it with DOM objects (what were you smoking, MSFT?)\n\tdefineProperty = function ( obj, prop, desc ) {\n\t\tif ( desc.get ) { obj[ prop ] = desc.get(); }\n\t\telse { obj[ prop ] = desc.value; }\n\t};\n}\n\ntry {\n\ttry {\n\t\tObject.defineProperties({}, { test: { value: 0 } });\n\t} catch ( err ) {\n\t\t// TODO how do we account for this? noMagic = true;\n\t\tthrow err;\n\t}\n\n\tif ( doc ) {\n\t\tObject.defineProperties( createElement( 'div' ), { test: { value: 0 } });\n\t}\n\n\tdefineProperties = Object.defineProperties;\n} catch ( err ) {\n\tdefineProperties = function ( obj, props ) {\n\t\tvar prop;\n\n\t\tfor ( prop in props ) {\n\t\t\tif ( props.hasOwnProperty( prop ) ) {\n\t\t\t\tdefineProperty( obj, prop, props[ prop ] );\n\t\t\t}\n\t\t}\n\t};\n}\n\ntry {\n\tObject.create( null );\n\n\tcreate = Object.create;\n} catch ( err ) {\n\t// sigh\n\tcreate = (function () {\n\t\tvar F = function () {};\n\n\t\treturn function ( proto, props ) {\n\t\t\tif ( proto === null ) {\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\tF.prototype = proto;\n\t\t\tvar obj = new F();\n\n\t\t\tif ( props ) {\n\t\t\t\tObject.defineProperties( obj, props );\n\t\t\t}\n\n\t\t\treturn obj;\n\t\t};\n\t}());\n}\n\nfunction extend$1 ( target ) {\n\tvar sources = [], len = arguments.length - 1;\n\twhile ( len-- > 0 ) sources[ len ] = arguments[ len + 1 ];\n\n\tvar prop;\n\n\tsources.forEach( function (source) {\n\t\tfor ( prop in source ) {\n\t\t\tif ( hasOwn.call( source, prop ) ) {\n\t\t\t\ttarget[ prop ] = source[ prop ];\n\t\t\t}\n\t\t}\n\t});\n\n\treturn target;\n}\n\nfunction fillGaps ( target ) {\n\tvar sources = [], len = arguments.length - 1;\n\twhile ( len-- > 0 ) sources[ len ] = arguments[ len + 1 ];\n\n\tsources.forEach( function (s) {\n\t\tfor ( var key in s ) {\n\t\t\tif ( hasOwn.call( s, key ) && !( key in target ) ) {\n\t\t\t\ttarget[ key ] = s[ key ];\n\t\t\t}\n\t\t}\n\t});\n\n\treturn target;\n}\n\nvar hasOwn = Object.prototype.hasOwnProperty;\n\nvar toString$1$1 = Object.prototype.toString;\nvar arrayLikePattern = /^\\[object (?:Array|FileList)\\]$/;\n\n// thanks, http://perfectionkills.com/instanceof-considered-harmful-or-how-to-write-a-robust-isarray/\nfunction isArray ( thing ) {\n\treturn toString$1$1.call( thing ) === '[object Array]';\n}\n\n\n\nfunction isEqual ( a, b ) {\n\tif ( a === null && b === null ) {\n\t\treturn true;\n\t}\n\n\tif ( typeof a === 'object' || typeof b === 'object' ) {\n\t\treturn false;\n\t}\n\n\treturn a === b;\n}\n\n// http://stackoverflow.com/questions/18082/validate-numbers-in-javascript-isnumeric\nfunction isNumeric ( thing ) {\n\treturn !isNaN( parseFloat( thing ) ) && isFinite( thing );\n}\n\nfunction isObject ( thing ) {\n\treturn ( thing && toString$1$1.call( thing ) === '[object Object]' );\n}\n\nfunction isObjectLike ( thing ) {\n\tif ( !thing ) { return false; }\n\tvar type = typeof thing;\n\tif ( type === 'object' || type === 'function' ) { return true; }\n}\n\n/* global console */\n/* eslint no-console:\"off\" */\n\nvar alreadyWarned = {};\nvar log;\nvar printWarning;\nvar welcome;\n\nif ( hasConsole ) {\n\tvar welcomeIntro = [\n\t\t\"%cRactive.js %c0.9.0-edge-3cba8c713ddf8f6209ab82d2ae6c0192860c6601 %cin debug mode, %cmore...\",\n\t\t'color: rgb(114, 157, 52); font-weight: normal;',\n\t\t'color: rgb(85, 85, 85); font-weight: normal;',\n\t\t'color: rgb(85, 85, 85); font-weight: normal;',\n\t\t'color: rgb(82, 140, 224); font-weight: normal; text-decoration: underline;'\n\t];\n\tvar welcomeMessage = \"You're running Ractive 0.9.0-edge-3cba8c713ddf8f6209ab82d2ae6c0192860c6601 in debug mode - messages will be printed to the console to help you fix problems and optimise your application.\\n\\nTo disable debug mode, add this line at the start of your app:\\n  Ractive.DEBUG = false;\\n\\nTo disable debug mode when your app is minified, add this snippet:\\n  Ractive.DEBUG = /unminified/.test(function(){/*unminified*/});\\n\\nGet help and support:\\n  http://docs.ractivejs.org\\n  http://stackoverflow.com/questions/tagged/ractivejs\\n  http://groups.google.com/forum/#!forum/ractive-js\\n  http://twitter.com/ractivejs\\n\\nFound a bug? Raise an issue:\\n  https://github.com/ractivejs/ractive/issues\\n\\n\";\n\n\twelcome = function () {\n\t\tif ( Ractive.WELCOME_MESSAGE === false ) {\n\t\t\twelcome = noop;\n\t\t\treturn;\n\t\t}\n\t\tvar message = 'WELCOME_MESSAGE' in Ractive ? Ractive.WELCOME_MESSAGE : welcomeMessage;\n\t\tvar hasGroup = !!console.groupCollapsed;\n\t\tif ( hasGroup ) { console.groupCollapsed.apply( console, welcomeIntro ); }\n\t\tconsole.log( message );\n\t\tif ( hasGroup ) {\n\t\t\tconsole.groupEnd( welcomeIntro );\n\t\t}\n\n\t\twelcome = noop;\n\t};\n\n\tprintWarning = function ( message, args ) {\n\t\twelcome();\n\n\t\t// extract information about the instance this message pertains to, if applicable\n\t\tif ( typeof args[ args.length - 1 ] === 'object' ) {\n\t\t\tvar options = args.pop();\n\t\t\tvar ractive = options ? options.ractive : null;\n\n\t\t\tif ( ractive ) {\n\t\t\t\t// if this is an instance of a component that we know the name of, add\n\t\t\t\t// it to the message\n\t\t\t\tvar name;\n\t\t\t\tif ( ractive.component && ( name = ractive.component.name ) ) {\n\t\t\t\t\tmessage = \"<\" + name + \"> \" + message;\n\t\t\t\t}\n\n\t\t\t\tvar node;\n\t\t\t\tif ( node = ( options.node || ( ractive.fragment && ractive.fragment.rendered && ractive.find( '*' ) ) ) ) {\n\t\t\t\t\targs.push( node );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconsole.warn.apply( console, [ '%cRactive.js: %c' + message, 'color: rgb(114, 157, 52);', 'color: rgb(85, 85, 85);' ].concat( args ) );\n\t};\n\n\tlog = function () {\n\t\tconsole.log.apply( console, arguments );\n\t};\n} else {\n\tprintWarning = log = welcome = noop;\n}\n\nfunction format ( message, args ) {\n\treturn message.replace( /%s/g, function () { return args.shift(); } );\n}\n\nfunction fatal ( message ) {\n\tvar args = [], len = arguments.length - 1;\n\twhile ( len-- > 0 ) args[ len ] = arguments[ len + 1 ];\n\n\tmessage = format( message, args );\n\tthrow new Error( message );\n}\n\nfunction logIfDebug () {\n\tif ( Ractive.DEBUG ) {\n\t\tlog.apply( null, arguments );\n\t}\n}\n\nfunction warn ( message ) {\n\tvar args = [], len = arguments.length - 1;\n\twhile ( len-- > 0 ) args[ len ] = arguments[ len + 1 ];\n\n\tmessage = format( message, args );\n\tprintWarning( message, args );\n}\n\nfunction warnOnce ( message ) {\n\tvar args = [], len = arguments.length - 1;\n\twhile ( len-- > 0 ) args[ len ] = arguments[ len + 1 ];\n\n\tmessage = format( message, args );\n\n\tif ( alreadyWarned[ message ] ) {\n\t\treturn;\n\t}\n\n\talreadyWarned[ message ] = true;\n\tprintWarning( message, args );\n}\n\nfunction warnIfDebug () {\n\tif ( Ractive.DEBUG ) {\n\t\twarn.apply( null, arguments );\n\t}\n}\n\nfunction warnOnceIfDebug () {\n\tif ( Ractive.DEBUG ) {\n\t\twarnOnce.apply( null, arguments );\n\t}\n}\n\n// Error messages that are used (or could be) in multiple places\nvar badArguments = 'Bad arguments';\nvar noRegistryFunctionReturn = 'A function was specified for \"%s\" %s, but no %s was returned';\nvar missingPlugin = function ( name, type ) { return (\"Missing \\\"\" + name + \"\\\" \" + type + \" plugin. You may need to download a plugin via http://docs.ractivejs.org/latest/plugins#\" + type + \"s\"); };\n\nfunction findInViewHierarchy ( registryName, ractive, name ) {\n\tvar instance = findInstance( registryName, ractive, name );\n\treturn instance ? instance[ registryName ][ name ] : null;\n}\n\nfunction findInstance ( registryName, ractive, name ) {\n\twhile ( ractive ) {\n\t\tif ( name in ractive[ registryName ] ) {\n\t\t\treturn ractive;\n\t\t}\n\n\t\tif ( ractive.isolated ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tractive = ractive.parent;\n\t}\n}\n\nfunction interpolate ( from, to, ractive, type ) {\n\tif ( from === to ) { return null; }\n\n\tif ( type ) {\n\t\tvar interpol = findInViewHierarchy( 'interpolators', ractive, type );\n\t\tif ( interpol ) { return interpol( from, to ) || null; }\n\n\t\tfatal( missingPlugin( type, 'interpolator' ) );\n\t}\n\n\treturn interpolators.number( from, to ) ||\n\t       interpolators.array( from, to ) ||\n\t       interpolators.object( from, to ) ||\n\t       null;\n}\n\nfunction snap ( to ) {\n\treturn function () { return to; };\n}\n\nvar interpolators = {\n\tnumber: function number ( from, to ) {\n\t\tif ( !isNumeric( from ) || !isNumeric( to ) ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tfrom = +from;\n\t\tto = +to;\n\n\t\tvar delta = to - from;\n\n\t\tif ( !delta ) {\n\t\t\treturn function () { return from; };\n\t\t}\n\n\t\treturn function ( t ) {\n\t\t\treturn from + ( t * delta );\n\t\t};\n\t},\n\n\tarray: function array ( from, to ) {\n\t\tvar len, i;\n\n\t\tif ( !isArray( from ) || !isArray( to ) ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tvar intermediate = [];\n\t\tvar interpolators = [];\n\n\t\ti = len = Math.min( from.length, to.length );\n\t\twhile ( i-- ) {\n\t\t\tinterpolators[i] = interpolate( from[i], to[i] );\n\t\t}\n\n\t\t// surplus values - don't interpolate, but don't exclude them either\n\t\tfor ( i=len; i<from.length; i+=1 ) {\n\t\t\tintermediate[i] = from[i];\n\t\t}\n\n\t\tfor ( i=len; i<to.length; i+=1 ) {\n\t\t\tintermediate[i] = to[i];\n\t\t}\n\n\t\treturn function ( t ) {\n\t\t\tvar i = len;\n\n\t\t\twhile ( i-- ) {\n\t\t\t\tintermediate[i] = interpolators[i]( t );\n\t\t\t}\n\n\t\t\treturn intermediate;\n\t\t};\n\t},\n\n\tobject: function object ( from, to ) {\n\t\tif ( !isObject( from ) || !isObject( to ) ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tvar properties = [];\n\t\tvar intermediate = {};\n\t\tvar interpolators = {};\n\n\t\tfor ( var prop in from ) {\n\t\t\tif ( hasOwn.call( from, prop ) ) {\n\t\t\t\tif ( hasOwn.call( to, prop ) ) {\n\t\t\t\t\tproperties.push( prop );\n\t\t\t\t\tinterpolators[ prop ] = interpolate( from[ prop ], to[ prop ] ) || snap( to[ prop ] );\n\t\t\t\t}\n\n\t\t\t\telse {\n\t\t\t\t\tintermediate[ prop ] = from[ prop ];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor ( var prop$1 in to ) {\n\t\t\tif ( hasOwn.call( to, prop$1 ) && !hasOwn.call( from, prop$1 ) ) {\n\t\t\t\tintermediate[ prop$1 ] = to[ prop$1 ];\n\t\t\t}\n\t\t}\n\n\t\tvar len = properties.length;\n\n\t\treturn function ( t ) {\n\t\t\tvar i = len;\n\n\t\t\twhile ( i-- ) {\n\t\t\t\tvar prop = properties[i];\n\n\t\t\t\tintermediate[ prop ] = interpolators[ prop ]( t );\n\t\t\t}\n\n\t\t\treturn intermediate;\n\t\t};\n\t}\n};\n\nfunction enqueue ( ractive, event ) {\n\tif ( ractive.event ) {\n\t\tractive._eventQueue.push( ractive.event );\n\t}\n\n\tractive.event = event;\n}\n\nfunction dequeue ( ractive ) {\n\tif ( ractive._eventQueue.length ) {\n\t\tractive.event = ractive._eventQueue.pop();\n\t} else {\n\t\tractive.event = null;\n\t}\n}\n\nvar refPattern = /\\[\\s*(\\*|[0-9]|[1-9][0-9]+)\\s*\\]/g;\nvar splitPattern = /([^\\\\](?:\\\\\\\\)*)\\./;\nvar escapeKeyPattern = /\\\\|\\./g;\nvar unescapeKeyPattern = /((?:\\\\)+)\\1|\\\\(\\.)/g;\n\nfunction escapeKey ( key ) {\n\tif ( typeof key === 'string' ) {\n\t\treturn key.replace( escapeKeyPattern, '\\\\$&' );\n\t}\n\n\treturn key;\n}\n\nfunction normalise ( ref ) {\n\treturn ref ? ref.replace( refPattern, '.$1' ) : '';\n}\n\nfunction splitKeypath ( keypath ) {\n\tvar result = [];\n\tvar match;\n\n\tkeypath = normalise( keypath );\n\n\twhile ( match = splitPattern.exec( keypath ) ) {\n\t\tvar index = match.index + match[1].length;\n\t\tresult.push( keypath.substr( 0, index ) );\n\t\tkeypath = keypath.substr( index + 1 );\n\t}\n\n\tresult.push( keypath );\n\n\treturn result;\n}\n\nfunction unescapeKey ( key ) {\n\tif ( typeof key === 'string' ) {\n\t\treturn key.replace( unescapeKeyPattern, '$1$2' );\n\t}\n\n\treturn key;\n}\n\nvar starMaps = {};\n\n// This function takes a keypath such as 'foo.bar.baz', and returns\n// all the variants of that keypath that include a wildcard in place\n// of a key, such as 'foo.bar.*', 'foo.*.baz', 'foo.*.*' and so on.\n// These are then checked against the dependants map (ractive.viewmodel.depsMap)\n// to see if any pattern observers are downstream of one or more of\n// these wildcard keypaths (e.g. 'foo.bar.*.status')\nfunction getPotentialWildcardMatches ( keypath ) {\n\tvar starMap, i, wildcardKeypath;\n\n\tvar keys = splitKeypath( keypath );\n\tif( !( starMap = starMaps[ keys.length ]) ) {\n\t\tstarMap = getStarMap( keys.length );\n\t}\n\n\tvar result = [];\n\n\tvar mapper = function ( star, i ) {\n\t\treturn star ? '*' : keys[i];\n\t};\n\n\ti = starMap.length;\n\twhile ( i-- ) {\n\t\twildcardKeypath = starMap[i].map( mapper ).join( '.' );\n\n\t\tif ( !result.hasOwnProperty( wildcardKeypath ) ) {\n\t\t\tresult.push( wildcardKeypath );\n\t\t\tresult[ wildcardKeypath ] = true;\n\t\t}\n\t}\n\n\treturn result;\n}\n\n// This function returns all the possible true/false combinations for\n// a given number - e.g. for two, the possible combinations are\n// [ true, true ], [ true, false ], [ false, true ], [ false, false ].\n// It does so by getting all the binary values between 0 and e.g. 11\nfunction getStarMap ( num ) {\n\tvar ones = '';\n\tvar max, binary, starMap, mapper, i, j, l, map;\n\n\tif ( !starMaps[ num ] ) {\n\t\tstarMap = [];\n\n\t\twhile ( ones.length < num ) {\n\t\t\tones += 1;\n\t\t}\n\n\t\tmax = parseInt( ones, 2 );\n\n\t\tmapper = function ( digit ) {\n\t\t\treturn digit === '1';\n\t\t};\n\n\t\tfor ( i = 0; i <= max; i += 1 ) {\n\t\t\tbinary = i.toString( 2 );\n\t\t\twhile ( binary.length < num ) {\n\t\t\t\tbinary = '0' + binary;\n\t\t\t}\n\n\t\t\tmap = [];\n\t\t\tl = binary.length;\n\t\t\tfor (j = 0; j < l; j++) {\n\t\t\t\tmap.push( mapper( binary[j] ) );\n\t\t\t}\n\t\t\tstarMap[i] = map;\n\t\t}\n\n\t\tstarMaps[ num ] = starMap;\n\t}\n\n\treturn starMaps[ num ];\n}\n\nvar wildcardCache = {};\n\nfunction fireEvent ( ractive, eventName, options ) {\n\tif ( options === void 0 ) options = {};\n\n\tif ( !eventName ) { return; }\n\n\tif ( !options.event ) {\n\t\toptions.event = {\n\t\t\tname: eventName,\n\t\t\t// until event not included as argument default\n\t\t\t_noArg: true\n\t\t};\n\t} else {\n\t\toptions.event.name = eventName;\n\t}\n\n\tvar eventNames = getWildcardNames( eventName );\n\n\treturn fireEventAs( ractive, eventNames, options.event, options.args, true );\n}\n\nfunction getWildcardNames ( eventName ) {\n\tif ( wildcardCache.hasOwnProperty( eventName ) ) {\n\t\treturn wildcardCache[ eventName ];\n\t} else {\n\t\treturn wildcardCache[ eventName ] = getPotentialWildcardMatches( eventName );\n\t}\n}\n\nfunction fireEventAs  ( ractive, eventNames, event, args, initialFire ) {\n\tif ( initialFire === void 0 ) initialFire = false;\n\n\tvar subscribers, i;\n\tvar bubble = true;\n\n\tenqueue( ractive, event );\n\n\tfor ( i = eventNames.length; i >= 0; i-- ) {\n\t\tsubscribers = ractive._subs[ eventNames[ i ] ];\n\n\t\tif ( subscribers ) {\n\t\t\tbubble = notifySubscribers( ractive, subscribers, event, args ) && bubble;\n\t\t}\n\t}\n\n\tdequeue( ractive );\n\n\tif ( ractive.parent && bubble ) {\n\n\t\tif ( initialFire && ractive.component ) {\n\t\t\tvar fullName = ractive.component.name + '.' + eventNames[ eventNames.length-1 ];\n\t\t\teventNames = getWildcardNames( fullName );\n\n\t\t\tif( event && !event.component ) {\n\t\t\t\tevent.component = ractive;\n\t\t\t}\n\t\t}\n\n\t\tfireEventAs( ractive.parent, eventNames, event, args );\n\t}\n\n\treturn bubble;\n}\n\nfunction notifySubscribers ( ractive, subscribers, event, args ) {\n\tvar originalEvent = null;\n\tvar stopEvent = false;\n\n\tif ( event && !event._noArg ) {\n\t\targs = [ event ].concat( args );\n\t}\n\n\t// subscribers can be modified inflight, e.g. \"once\" functionality\n\t// so we need to copy to make sure everyone gets called\n\tsubscribers = subscribers.slice();\n\n\tfor ( var i = 0, len = subscribers.length; i < len; i += 1 ) {\n\t\tif ( !subscribers[ i ].off && subscribers[ i ].apply( ractive, args ) === false ) {\n\t\t\tstopEvent = true;\n\t\t}\n\t}\n\n\tif ( event && !event._noArg && stopEvent && ( originalEvent = event.original ) ) {\n\t\toriginalEvent.preventDefault && originalEvent.preventDefault();\n\t\toriginalEvent.stopPropagation && originalEvent.stopPropagation();\n\t}\n\n\treturn !stopEvent;\n}\n\nvar Hook = function Hook ( event ) {\n\tthis.event = event;\n\tthis.method = 'on' + event;\n};\n\nHook.prototype.fire = function fire ( ractive, arg ) {\n\tif ( ractive[ this.method ] ) {\n\t\targ ? ractive[ this.method ]( arg ) : ractive[ this.method ]();\n\t}\n\n\tvar options = { args: [] };\n\tif ( arg ) { options.args.push( arg ); }\n\toptions.args.push( ractive );\n\tfireEvent( ractive, this.event, options );\n};\n\nfunction addToArray ( array, value ) {\n\tvar index = array.indexOf( value );\n\n\tif ( index === -1 ) {\n\t\tarray.push( value );\n\t}\n}\n\nfunction arrayContains ( array, value ) {\n\tfor ( var i = 0, c = array.length; i < c; i++ ) {\n\t\tif ( array[i] == value ) {\n\t\t\treturn true;\n\t\t}\n\t}\n\n\treturn false;\n}\n\nfunction arrayContentsMatch ( a, b ) {\n\tvar i;\n\n\tif ( !isArray( a ) || !isArray( b ) ) {\n\t\treturn false;\n\t}\n\n\tif ( a.length !== b.length ) {\n\t\treturn false;\n\t}\n\n\ti = a.length;\n\twhile ( i-- ) {\n\t\tif ( a[i] !== b[i] ) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn true;\n}\n\nfunction ensureArray ( x ) {\n\tif ( typeof x === 'string' ) {\n\t\treturn [ x ];\n\t}\n\n\tif ( x === undefined ) {\n\t\treturn [];\n\t}\n\n\treturn x;\n}\n\nfunction lastItem ( array ) {\n\treturn array[ array.length - 1 ];\n}\n\nfunction removeFromArray ( array, member ) {\n\tif ( !array ) {\n\t\treturn;\n\t}\n\n\tvar index = array.indexOf( member );\n\n\tif ( index !== -1 ) {\n\t\tarray.splice( index, 1 );\n\t}\n}\n\nfunction toArray ( arrayLike ) {\n\tvar array = [];\n\tvar i = arrayLike.length;\n\twhile ( i-- ) {\n\t\tarray[i] = arrayLike[i];\n\t}\n\n\treturn array;\n}\n\nfunction find$1 ( array, fn ) {\n\tvar len = array.length;\n\tfor ( var i = 0; i < len; i++ ) {\n\t\tif ( fn( array[i] ) ) { return array[i]; }\n\t}\n}\n\nfunction findMap ( array, fn ) {\n\tvar len = array.length;\n\tfor ( var i = 0; i < len; i++ ) {\n\t\tvar result = fn( array[i] );\n\t\tif ( result ) { return result; }\n\t}\n}\n\nvar _Promise;\nvar PENDING = {};\nvar FULFILLED = {};\nvar REJECTED = {};\n\nif ( typeof Promise === 'function' ) {\n\t// use native Promise\n\t_Promise = Promise;\n} else {\n\t_Promise = function ( callback ) {\n\t\tvar fulfilledHandlers = [];\n\t\tvar rejectedHandlers = [];\n\t\tvar state = PENDING;\n\t\tvar result, dispatchHandlers;\n\n\t\tvar makeResolver = function ( newState ) {\n\t\t\treturn function ( value ) {\n\t\t\t\tif ( state !== PENDING ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tresult = value;\n\t\t\t\tstate = newState;\n\n\t\t\t\tdispatchHandlers = makeDispatcher( ( state === FULFILLED ? fulfilledHandlers : rejectedHandlers ), result );\n\n\t\t\t\t// dispatch onFulfilled and onRejected handlers asynchronously\n\t\t\t\twait( dispatchHandlers );\n\t\t\t};\n\t\t};\n\n\t\tvar fulfil = makeResolver( FULFILLED );\n\t\tvar reject = makeResolver( REJECTED );\n\n\t\ttry {\n\t\t\tcallback( fulfil, reject );\n\t\t} catch ( err ) {\n\t\t\treject( err );\n\t\t}\n\n\t\tvar promise = {\n\t\t\t// `then()` returns a Promise - 2.2.7\n\t\t\tthen: function then ( onFulfilled, onRejected ) {\n\t\t\t\tvar promise2 = new _Promise( function ( fulfil, reject ) {\n\n\t\t\t\t\tvar processResolutionHandler = function ( handler, handlers, forward ) {\n\n\t\t\t\t\t\t// 2.2.1.1\n\t\t\t\t\t\tif ( typeof handler === 'function' ) {\n\t\t\t\t\t\t\thandlers.push( function ( p1result ) {\n\t\t\t\t\t\t\t\tvar x;\n\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\tx = handler( p1result );\n\t\t\t\t\t\t\t\t\tresolve$1( promise2, x, fulfil, reject );\n\t\t\t\t\t\t\t\t} catch ( err ) {\n\t\t\t\t\t\t\t\t\treject( err );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Forward the result of promise1 to promise2, if resolution handlers\n\t\t\t\t\t\t\t// are not given\n\t\t\t\t\t\t\thandlers.push( forward );\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\n\t\t\t\t\t// 2.2\n\t\t\t\t\tprocessResolutionHandler( onFulfilled, fulfilledHandlers, fulfil );\n\t\t\t\t\tprocessResolutionHandler( onRejected, rejectedHandlers, reject );\n\n\t\t\t\t\tif ( state !== PENDING ) {\n\t\t\t\t\t\t// If the promise has resolved already, dispatch the appropriate handlers asynchronously\n\t\t\t\t\t\twait( dispatchHandlers );\n\t\t\t\t\t}\n\n\t\t\t\t});\n\n\t\t\t\treturn promise2;\n\t\t\t}\n\t\t};\n\n\t\tpromise[ 'catch' ] = function ( onRejected ) {\n\t\t\treturn this.then( null, onRejected );\n\t\t};\n\n\t\treturn promise;\n\t};\n\n\t_Promise.all = function ( promises ) {\n\t\treturn new _Promise( function ( fulfil, reject ) {\n\t\t\tvar result = [];\n\t\t\tvar pending, i;\n\n\t\t\tif ( !promises.length ) {\n\t\t\t\tfulfil( result );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar processPromise = function ( promise, i ) {\n\t\t\t\tif ( promise && typeof promise.then === 'function' ) {\n\t\t\t\t\tpromise.then( function (value) {\n\t\t\t\t\t\tresult[i] = value;\n\t\t\t\t\t\t--pending || fulfil( result );\n\t\t\t\t\t}, reject );\n\t\t\t\t}\n\n\t\t\t\telse {\n\t\t\t\t\tresult[i] = promise;\n\t\t\t\t\t--pending || fulfil( result );\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tpending = i = promises.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tprocessPromise( promises[i], i );\n\t\t\t}\n\t\t});\n\t};\n\n\t_Promise.resolve = function ( value ) {\n\t\treturn new _Promise( function ( fulfil ) {\n\t\t\tfulfil( value );\n\t\t});\n\t};\n\n\t_Promise.reject = function ( reason ) {\n\t\treturn new _Promise( function ( fulfil, reject ) {\n\t\t\treject( reason );\n\t\t});\n\t};\n}\n\nvar Promise$1 = _Promise;\n\n// TODO use MutationObservers or something to simulate setImmediate\nfunction wait ( callback ) {\n\tsetTimeout( callback, 0 );\n}\n\nfunction makeDispatcher ( handlers, result ) {\n\treturn function () {\n\t\tvar handler;\n\n\t\twhile ( handler = handlers.shift() ) {\n\t\t\thandler( result );\n\t\t}\n\t};\n}\n\nfunction resolve$1 ( promise, x, fulfil, reject ) {\n\t// Promise Resolution Procedure\n\tvar then;\n\n\t// 2.3.1\n\tif ( x === promise ) {\n\t\tthrow new TypeError( 'A promise\\'s fulfillment handler cannot return the same promise' );\n\t}\n\n\t// 2.3.2\n\tif ( x instanceof _Promise ) {\n\t\tx.then( fulfil, reject );\n\t}\n\n\t// 2.3.3\n\telse if ( x && ( typeof x === 'object' || typeof x === 'function' ) ) {\n\t\ttry {\n\t\t\tthen = x.then; // 2.3.3.1\n\t\t} catch ( e ) {\n\t\t\treject( e ); // 2.3.3.2\n\t\t\treturn;\n\t\t}\n\n\t\t// 2.3.3.3\n\t\tif ( typeof then === 'function' ) {\n\t\t\tvar called;\n\n\t\t\tvar resolvePromise = function ( y ) {\n\t\t\t\tif ( called ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tcalled = true;\n\t\t\t\tresolve$1( promise, y, fulfil, reject );\n\t\t\t};\n\n\t\t\tvar rejectPromise = function ( r ) {\n\t\t\t\tif ( called ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tcalled = true;\n\t\t\t\treject( r );\n\t\t\t};\n\n\t\t\ttry {\n\t\t\t\tthen.call( x, resolvePromise, rejectPromise );\n\t\t\t} catch ( e ) {\n\t\t\t\tif ( !called ) { // 2.3.3.3.4.1\n\t\t\t\t\treject( e ); // 2.3.3.3.4.2\n\t\t\t\t\tcalled = true;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\telse {\n\t\t\tfulfil( x );\n\t\t}\n\t}\n\n\telse {\n\t\tfulfil( x );\n\t}\n}\n\nvar TransitionManager = function TransitionManager ( callback, parent ) {\n\tthis.callback = callback;\n\tthis.parent = parent;\n\n\tthis.intros = [];\n\tthis.outros = [];\n\n\tthis.children = [];\n\tthis.totalChildren = this.outroChildren = 0;\n\n\tthis.detachQueue = [];\n\tthis.outrosComplete = false;\n\n\tif ( parent ) {\n\t\tparent.addChild( this );\n\t}\n};\n\nTransitionManager.prototype.add = function add ( transition ) {\n\tvar list = transition.isIntro ? this.intros : this.outros;\n\tlist.push( transition );\n};\n\nTransitionManager.prototype.addChild = function addChild ( child ) {\n\tthis.children.push( child );\n\n\tthis.totalChildren += 1;\n\tthis.outroChildren += 1;\n};\n\nTransitionManager.prototype.decrementOutros = function decrementOutros () {\n\tthis.outroChildren -= 1;\n\tcheck( this );\n};\n\nTransitionManager.prototype.decrementTotal = function decrementTotal () {\n\tthis.totalChildren -= 1;\n\tcheck( this );\n};\n\nTransitionManager.prototype.detachNodes = function detachNodes () {\n\tthis.detachQueue.forEach( detach$1 );\n\tthis.children.forEach( _detachNodes );\n};\n\nTransitionManager.prototype.ready = function ready () {\n\tdetachImmediate( this );\n};\n\nTransitionManager.prototype.remove = function remove ( transition ) {\n\tvar list = transition.isIntro ? this.intros : this.outros;\n\tremoveFromArray( list, transition );\n\tcheck( this );\n};\n\nTransitionManager.prototype.start = function start () {\n\tthis.children.forEach( function (c) { return c.start(); } );\n\tthis.intros.concat( this.outros ).forEach( function (t) { return t.start(); } );\n\tthis.ready = true;\n\tcheck( this );\n};\n\nfunction detach$1 ( element ) {\n\telement.detach();\n}\n\nfunction _detachNodes ( tm ) { // _ to avoid transpiler quirk\n\ttm.detachNodes();\n}\n\nfunction check ( tm ) {\n\tif ( !tm.ready || tm.outros.length || tm.outroChildren ) { return; }\n\n\t// If all outros are complete, and we haven't already done this,\n\t// we notify the parent if there is one, otherwise\n\t// start detaching nodes\n\tif ( !tm.outrosComplete ) {\n\t\ttm.outrosComplete = true;\n\n\t\tif ( tm.parent && !tm.parent.outrosComplete ) {\n\t\t\ttm.parent.decrementOutros( tm );\n\t\t} else {\n\t\t\ttm.detachNodes();\n\t\t}\n\t}\n\n\t// Once everything is done, we can notify parent transition\n\t// manager and call the callback\n\tif ( !tm.intros.length && !tm.totalChildren ) {\n\t\tif ( typeof tm.callback === 'function' ) {\n\t\t\ttm.callback();\n\t\t}\n\n\t\tif ( tm.parent && !tm.notifiedTotal ) {\n\t\t\ttm.notifiedTotal = true;\n\t\t\ttm.parent.decrementTotal();\n\t\t}\n\t}\n}\n\n// check through the detach queue to see if a node is up or downstream from a\n// transition and if not, go ahead and detach it\nfunction detachImmediate ( manager ) {\n\tvar queue = manager.detachQueue;\n\tvar outros = collectAllOutros( manager );\n\n\tvar i = queue.length;\n\tvar j = 0;\n\tvar node, trans;\n\tstart: while ( i-- ) {\n\t\tnode = queue[i].node;\n\t\tj = outros.length;\n\t\twhile ( j-- ) {\n\t\t\ttrans = outros[j].element.node;\n\t\t\t// check to see if the node is, contains, or is contained by the transitioning node\n\t\t\tif ( trans === node || trans.contains( node ) || node.contains( trans ) ) { continue start; }\n\t\t}\n\n\t\t// no match, we can drop it\n\t\tqueue[i].detach();\n\t\tqueue.splice( i, 1 );\n\t}\n}\n\nfunction collectAllOutros ( manager, list ) {\n\tif ( !list ) {\n\t\tlist = [];\n\t\tvar parent = manager;\n\t\twhile ( parent.parent ) { parent = parent.parent; }\n\t\treturn collectAllOutros( parent, list );\n\t} else {\n\t\tvar i = manager.children.length;\n\t\twhile ( i-- ) {\n\t\t\tlist = collectAllOutros( manager.children[i], list );\n\t\t}\n\t\tlist = list.concat( manager.outros );\n\t\treturn list;\n\t}\n}\n\nvar changeHook = new Hook( 'change' );\n\nvar batch;\n\nvar runloop = {\n\tstart: function start ( instance ) {\n\t\tvar fulfilPromise;\n\t\tvar promise = new Promise$1( function (f) { return ( fulfilPromise = f ); } );\n\n\t\tbatch = {\n\t\t\tpreviousBatch: batch,\n\t\t\ttransitionManager: new TransitionManager( fulfilPromise, batch && batch.transitionManager ),\n\t\t\tfragments: [],\n\t\t\ttasks: [],\n\t\t\timmediateObservers: [],\n\t\t\tdeferredObservers: [],\n\t\t\tractives: [],\n\t\t\tinstance: instance,\n\t\t\tpromise: promise\n\t\t};\n\n\t\treturn promise;\n\t},\n\n\tend: function end () {\n\t\tflushChanges();\n\n\t\tif ( !batch.previousBatch ) { batch.transitionManager.start(); }\n\n\t\tbatch = batch.previousBatch;\n\t},\n\n\taddFragment: function addFragment ( fragment ) {\n\t\taddToArray( batch.fragments, fragment );\n\t},\n\n\t// TODO: come up with a better way to handle fragments that trigger their own update\n\taddFragmentToRoot: function addFragmentToRoot ( fragment ) {\n\t\tif ( !batch ) { return; }\n\n\t\tvar b = batch;\n\t\twhile ( b.previousBatch ) {\n\t\t\tb = b.previousBatch;\n\t\t}\n\n\t\taddToArray( b.fragments, fragment );\n\t},\n\n\taddInstance: function addInstance ( instance ) {\n\t\tif ( batch ) { addToArray( batch.ractives, instance ); }\n\t},\n\n\taddObserver: function addObserver ( observer, defer ) {\n\t\taddToArray( defer ? batch.deferredObservers : batch.immediateObservers, observer );\n\t},\n\n\tregisterTransition: function registerTransition ( transition ) {\n\t\ttransition._manager = batch.transitionManager;\n\t\tbatch.transitionManager.add( transition );\n\t},\n\n\t// synchronise node detachments with transition ends\n\tdetachWhenReady: function detachWhenReady ( thing ) {\n\t\tbatch.transitionManager.detachQueue.push( thing );\n\t},\n\n\tscheduleTask: function scheduleTask ( task, postRender ) {\n\t\tvar _batch;\n\n\t\tif ( !batch ) {\n\t\t\ttask();\n\t\t} else {\n\t\t\t_batch = batch;\n\t\t\twhile ( postRender && _batch.previousBatch ) {\n\t\t\t\t// this can't happen until the DOM has been fully updated\n\t\t\t\t// otherwise in some situations (with components inside elements)\n\t\t\t\t// transitions and decorators will initialise prematurely\n\t\t\t\t_batch = _batch.previousBatch;\n\t\t\t}\n\n\t\t\t_batch.tasks.push( task );\n\t\t}\n\t},\n\n\tpromise: function promise () {\n\t\tif ( !batch ) { return Promise$1.resolve(); }\n\n\t\tvar target = batch;\n\t\twhile ( target.previousBatch ) {\n\t\t\ttarget = target.previousBatch;\n\t\t}\n\n\t\treturn target.promise || Promise$1.resolve();\n\t}\n};\n\nfunction dispatch$1 ( observer ) {\n\tobserver.dispatch();\n}\n\nfunction flushChanges () {\n\tvar which = batch.immediateObservers;\n\tbatch.immediateObservers = [];\n\twhich.forEach( dispatch$1 );\n\n\t// Now that changes have been fully propagated, we can update the DOM\n\t// and complete other tasks\n\tvar i = batch.fragments.length;\n\tvar fragment;\n\n\twhich = batch.fragments;\n\tbatch.fragments = [];\n\tvar ractives = batch.ractives;\n\tbatch.ractives = [];\n\n\twhile ( i-- ) {\n\t\tfragment = which[i];\n\n\t\t// TODO deprecate this. It's annoying and serves no useful function\n\t\tvar ractive = fragment.ractive;\n\t\tif ( Object.keys( ractive.viewmodel.changes ).length ) {\n\t\t\tchangeHook.fire( ractive, ractive.viewmodel.changes );\n\t\t}\n\t\tractive.viewmodel.changes = {};\n\t\tremoveFromArray( ractives, ractive );\n\n\t\tfragment.update();\n\t}\n\n\ti = ractives.length;\n\twhile ( i-- ) {\n\t\tvar ractive$1 = ractives[i];\n\t\tchangeHook.fire( ractive$1, ractive$1.viewmodel.changes );\n\t\tractive$1.viewmodel.changes = {};\n\t}\n\n\tbatch.transitionManager.ready();\n\n\twhich = batch.deferredObservers;\n\tbatch.deferredObservers = [];\n\twhich.forEach( dispatch$1 );\n\n\tvar tasks = batch.tasks;\n\tbatch.tasks = [];\n\n\tfor ( i = 0; i < tasks.length; i += 1 ) {\n\t\ttasks[i]();\n\t}\n\n\t// If updating the view caused some model blowback - e.g. a triple\n\t// containing <option> elements caused the binding on the <select>\n\t// to update - then we start over\n\tif ( batch.fragments.length || batch.immediateObservers.length || batch.deferredObservers.length || batch.ractives.length || batch.tasks.length ) { return flushChanges(); }\n}\n\nfunction set$1 ( ractive, pairs ) {\n\tvar promise = runloop.start( ractive, true );\n\n\tvar i = pairs.length;\n\twhile ( i-- ) {\n\t\tvar model = pairs[i][0];\n\t\tvar value = pairs[i][1];\n\t\tvar keypath = pairs[i][2];\n\n\t\tif ( !model ) {\n\t\t\trunloop.end();\n\t\t\tthrow new Error( (\"Failed to set invalid keypath '\" + keypath + \"'\") );\n\t\t}\n\n\t\tmodel.set( value );\n\t}\n\n\trunloop.end();\n\n\treturn promise;\n}\n\nvar star = /\\*/;\nfunction gather ( ractive, keypath, base ) {\n\tif ( !base && keypath[0] === '.' ) {\n\t\twarnIfDebug( \"Attempted to set a relative keypath from a non-relative context. You can use a getNodeInfo or event object to set relative keypaths.\" );\n\t\treturn [];\n\t}\n\n\tvar model = base || ractive.viewmodel;\n\tif ( star.test( keypath ) ) {\n\t\treturn model.findMatches( splitKeypath( keypath ) );\n\t} else {\n\t\treturn [ model.joinAll( splitKeypath( keypath ) ) ];\n\t}\n}\n\nfunction build ( ractive, keypath, value ) {\n\tvar sets = [];\n\n\t// set multiple keypaths in one go\n\tif ( isObject( keypath ) ) {\n\t\tvar loop = function ( k ) {\n\t\t\tif ( keypath.hasOwnProperty( k ) ) {\n\t\t\t\tsets.push.apply( sets, gather( ractive, k ).map( function (m) { return [ m, keypath[k], k ]; } ) );\n\t\t\t}\n\t\t};\n\n\t\tfor ( var k in keypath ) loop( k );\n\n\t}\n\t// set a single keypath\n\telse {\n\t\tsets.push.apply( sets, gather( ractive, keypath ).map( function (m) { return [ m, value, keypath ]; } ) );\n\t}\n\n\treturn sets;\n}\n\nvar errorMessage = 'Cannot add to a non-numeric value';\n\nfunction add$1 ( ractive, keypath, d ) {\n\tif ( typeof keypath !== 'string' || !isNumeric( d ) ) {\n\t\tthrow new Error( 'Bad arguments' );\n\t}\n\n\tvar sets = build( ractive, keypath, d );\n\n\treturn set$1( ractive, sets.map( function (pair) {\n\t\tvar model = pair[0];\n\t\tvar add = pair[1];\n\t\tvar value = model.get();\n\t\tif ( !isNumeric( add ) || !isNumeric( value ) ) { throw new Error( errorMessage ); }\n\t\treturn [ model, value + add ];\n\t}));\n}\n\nfunction Ractive$add ( keypath, d ) {\n\treturn add$1( this, keypath, ( d === undefined ? 1 : +d ) );\n}\n\nvar noAnimation = Promise$1.resolve();\ndefineProperty( noAnimation, 'stop', { value: noop });\n\nvar linear$1 = easing.linear;\n\nfunction getOptions ( options, instance ) {\n\toptions = options || {};\n\n\tvar easing$$1;\n\tif ( options.easing ) {\n\t\teasing$$1 = typeof options.easing === 'function' ?\n\t\t\toptions.easing :\n\t\t\tinstance.easing[ options.easing ];\n\t}\n\n\treturn {\n\t\teasing: easing$$1 || linear$1,\n\t\tduration: 'duration' in options ? options.duration : 400,\n\t\tcomplete: options.complete || noop,\n\t\tstep: options.step || noop\n\t};\n}\n\nfunction animate$1 ( ractive, model, to, options ) {\n\toptions = getOptions( options, ractive );\n\tvar from = model.get();\n\n\t// don't bother animating values that stay the same\n\tif ( isEqual( from, to ) ) {\n\t\toptions.complete( options.to );\n\t\treturn noAnimation; // TODO should this have .then and .catch methods?\n\t}\n\n\tvar interpolator = interpolate( from, to, ractive, options.interpolator );\n\n\t// if we can't interpolate the value, set it immediately\n\tif ( !interpolator ) {\n\t\trunloop.start();\n\t\tmodel.set( to );\n\t\trunloop.end();\n\n\t\treturn noAnimation;\n\t}\n\n\treturn model.animate( from, to, options, interpolator );\n}\n\nfunction Ractive$animate ( keypath, to, options ) {\n\tif ( typeof keypath === 'object' ) {\n\t\tvar keys = Object.keys( keypath );\n\n\t\tthrow new Error( (\"ractive.animate(...) no longer supports objects. Instead of ractive.animate({\\n  \" + (keys.map( function (key) { return (\"'\" + key + \"': \" + (keypath[ key ])); } ).join( '\\n  ' )) + \"\\n}, {...}), do\\n\\n\" + (keys.map( function (key) { return (\"ractive.animate('\" + key + \"', \" + (keypath[ key ]) + \", {...});\"); } ).join( '\\n' )) + \"\\n\") );\n\t}\n\n\n\treturn animate$1( this, this.viewmodel.joinAll( splitKeypath( keypath ) ), to, options );\n}\n\nfunction updateLiveQueries ( element ) {\n\t// Does this need to be added to any live queries?\n\tvar node = element.node;\n\tvar instance = element.ractive;\n\tvar queries = [];\n\tvar remotes = {};\n\tvar remote = instance.component && instance.component.target === false;\n\tvar i;\n\n\tdo {\n\t\tvar liveQueries = instance._liveQueries;\n\n\t\ti = liveQueries.length;\n\t\twhile ( i-- ) {\n\t\t\tvar query = liveQueries[i];\n\n\t\t\tif ( query.test( node ) ) {\n\t\t\t\tqueries.push( query );\n\t\t\t}\n\t\t}\n\n\t\tif ( !remote && instance.component && instance.component.target === false ) { remote = true; }\n\t\tremotes[ instance._guid ] = remote;\n\t} while ( instance = instance.parent );\n\n\ti = queries.length;\n\twhile ( i-- ) {\n\t\tvar query$1 = queries[i];\n\t\tif ( query$1.remote || !remotes[ query$1.ractive._guid ] ) {\n\t\t\tquery$1.add( node );\n\t\t\t// keep register of applicable selectors, for when we teardown\n\t\t\telement.liveQueries.push( query$1 );\n\t\t}\n\t}\n}\n\n// TODO it's unfortunate that this has to run every time a\n// component is rendered... is there a better way?\nfunction updateLiveQueries$1 ( component ) {\n\t// Does this need to be added to any live queries?\n\tvar instance = component.ractive;\n\tvar queries = [];\n\tvar remotes = {};\n\tvar remote = component.target === false;\n\tvar i;\n\n\tdo {\n\t\tvar liveQueries = instance._liveComponentQueries;\n\n\t\ti = liveQueries.length;\n\t\twhile ( i-- ) {\n\t\t\tvar query = liveQueries[i];\n\n\t\t\tif ( query.test( component ) ) {\n\t\t\t\tqueries.push( query );\n\t\t\t}\n\t\t}\n\n\t\tif ( !remote && instance.component && instance.component.target === false ) { remote = true; }\n\t\tremotes[ instance._guid ] = remote;\n\t} while ( instance = instance.parent );\n\n\ti = queries.length;\n\twhile ( i-- ) {\n\t\tvar query$1 = queries[i];\n\t\tif ( query$1.remote || !remotes[ query$1.ractive._guid ] ) {\n\t\t\tquery$1.add( component.instance );\n\t\t\t// keep register of applicable selectors, for when we teardown\n\t\t\tcomponent.liveQueries.push( query$1 );\n\t\t}\n\t}\n}\n\nfunction findAnchors ( fragment, name ) {\n\tif ( name === void 0 ) name = null;\n\n\tvar res = [];\n\n\tfindAnchorsIn( fragment, name, res );\n\n\treturn res;\n}\n\nfunction findAnchorsIn ( item, name, result ) {\n\tif ( item.isAnchor ) {\n\t\tif ( !name || item.name === name ) {\n\t\t\tresult.push( item );\n\t\t}\n\t} else if ( item.items ) {\n\t\titem.items.forEach( function (i) { return findAnchorsIn( i, name, result ); } );\n\t} else if ( item.iterations ) {\n\t\titem.iterations.forEach( function (i) { return findAnchorsIn( i, name, result ); } );\n\t} else if ( item.fragment && !item.component ) {\n\t\tfindAnchorsIn( item.fragment, name, result );\n\t}\n}\n\nfunction updateAnchors ( instance, name ) {\n\tif ( name === void 0 ) name = null;\n\n\tvar anchors = findAnchors( instance.fragment, name );\n\tvar idxs = {};\n\tvar children = instance._children.byName;\n\n\tanchors.forEach( function (a) {\n\t\tvar name = a.name;\n\t\tif ( !( name in idxs ) ) { idxs[name] = 0; }\n\t\tvar idx = idxs[name];\n\t\tvar child = ( children[name] || [] )[idx];\n\n\t\tif ( child && child.lastBound !== a ) {\n\t\t\tif ( child.lastBound ) { child.lastBound.removeChild( child ); }\n\t\t\ta.addChild( child );\n\t\t}\n\n\t\tidxs[name]++;\n\t});\n}\n\nfunction unrenderChild ( meta ) {\n\tif ( meta.instance.fragment.rendered ) {\n\t\tmeta.shouldDestroy = true;\n\t\tmeta.instance.unrender();\n\t}\n\tmeta.instance.el = null;\n}\n\nvar attachHook = new Hook( 'attachchild' );\n\nfunction attachChild ( child, options ) {\n\tif ( options === void 0 ) options = {};\n\n\tvar children = this._children;\n\n\tif ( child.parent && child.parent !== this ) { throw new Error( (\"Instance \" + (child._guid) + \" is already attached to a different instance \" + (child.parent._guid) + \". Please detach it from the other instance using detachChild first.\") ); }\n\telse if ( child.parent ) { throw new Error( (\"Instance \" + (child._guid) + \" is already attached to this instance.\") ); }\n\n\tvar meta = {\n\t\tinstance: child,\n\t\tractive: this,\n\t\tname: options.name || child.constructor.name || 'Ractive',\n\t\tliveQueries: [],\n\t\ttarget: options.target || false,\n\t\tbubble: bubble$1,\n\t\tfindNextNode: findNextNode$1,\n\t\tremoveFromQuery: removeFromQuery$1\n\t};\n\tmeta.nameOption = options.name;\n\n\t// child is managing itself\n\tif ( !meta.target ) {\n\t\tmeta.parentFragment = this.fragment;\n\t\tmeta.external = true;\n\t} else {\n\t\tvar list;\n\t\tif ( !( list = children.byName[ meta.target ] ) ) {\n\t\t\tlist = [];\n\t\t\tthis.set( (\"@this.children.byName.\" + (meta.target)), list );\n\t\t}\n\t\tvar idx = options.prepend ? 0 : options.insertAt || list.length;\n\t\tlist.splice( idx, 0, meta );\n\t}\n\n\tchild.set({\n\t\t'@this.parent': this,\n\t\t'@this.root': this.root\n\t});\n\tchild.component = meta;\n\tchildren.push( meta );\n\n\tattachHook.fire( child );\n\n\tvar promise = runloop.start( child, true );\n\n\tif ( meta.target ) {\n\t\tunrenderChild( meta );\n\t\tthis.merge( (\"@this.children.byName.\" + (meta.target)) );\n\t\tupdateAnchors( this, meta.target );\n\t} else {\n\t\tif ( !child.isolated ) { child.viewmodel.attached( this.fragment ); }\n\t\tif ( child.fragment.rendered ) {\n\t\t\tchild.findAll( '*' ).forEach( function (el) { return updateLiveQueries( el._ractive.proxy ); } );\n\t\t\tchild.findAllComponents().forEach( function (cmp) { return updateLiveQueries$1( cmp.component ); } );\n\t\t\tupdateLiveQueries$1( meta );\n\t\t}\n\t}\n\n\trunloop.end();\n\n\tpromise.ractive = child;\n\treturn promise.then( function () { return child; } );\n}\n\nfunction bubble$1 () { runloop.addFragment( this.instance.fragment ); }\n\nfunction removeFromQuery$1 ( query ) {\n\tquery.remove( this.instance );\n\tremoveFromArray( this.liveQueries, query );\n}\n\nfunction findNextNode$1 () {\n\tif ( this.anchor ) { return this.anchor.findNextNode(); }\n}\n\nvar detachHook = new Hook( 'detach' );\n\nfunction Ractive$detach () {\n\tif ( this.isDetached ) {\n\t\treturn this.el;\n\t}\n\n\tif ( this.el ) {\n\t\tremoveFromArray( this.el.__ractive_instances__, this );\n\t}\n\n\tthis.el = this.fragment.detach();\n\tthis.isDetached = true;\n\n\tdetachHook.fire( this );\n\treturn this.el;\n}\n\nvar detachHook$1 = new Hook( 'detachchild' );\n\nfunction detachChild ( child ) {\n\tvar this$1 = this;\n\n\tvar children = this._children;\n\tvar meta, index;\n\n\tvar i = children.length;\n\twhile ( i-- ) {\n\t\tif ( children[i].instance === child ) {\n\t\t\tindex = i;\n\t\t\tmeta = children[i];\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif ( !meta || child.parent !== this ) { throw new Error( (\"Instance \" + (child._guid) + \" is not attached to this instance.\") ); }\n\n\tvar promise = runloop.start( child, true );\n\n\tif ( meta.anchor ) { meta.anchor.removeChild( meta ); }\n\tif ( !child.isolated ) { child.viewmodel.detached(); }\n\n\trunloop.end();\n\n\tchildren.splice( index, 1 );\n\tif ( meta.target ) {\n\t\tvar list = children.byName[ meta.target ];\n\t\tlist.splice( list.indexOf( meta ), 1 );\n\t\tthis.merge( (\"@this.children.byName.\" + (meta.target)) );\n\t\tupdateAnchors( this, meta.target );\n\t}\n\tchild.set({\n\t\t'@this.parent': undefined,\n\t\t'@this.root': child\n\t});\n\tchild.component = null;\n\n\tdetachHook$1.fire( child );\n\n\tif ( !meta.target && child.fragment.rendered ) {\n\t\t// keep live queries up to date\n\t\tchild.findAll( '*' ).forEach( function (el) {\n\t\t\tel._ractive.proxy.liveQueries.forEach( function (q) {\n\t\t\t\t// remove from non-self queries\n\t\t\t\tif ( isParent( this$1, q.ractive ) ) { el._ractive.proxy.removeFromQuery( q ); }\n\t\t\t});\n\t\t});\n\n\t\t// keep live component queries up to date\n\t\tchild.findAllComponents().forEach( function (cmp) {\n\t\t\tcmp.component.liveQueries.forEach( function (q) {\n\t\t\t\tif ( isParent( this$1, q.ractive ) ) { cmp.component.removeFromQuery( q ); }\n\t\t\t});\n\t\t});\n\n\t\tmeta.liveQueries.forEach( function (q) { return meta.removeFromQuery( q ); } );\n\t}\n\n\tpromise.ractive = child;\n\treturn promise.then( function () { return child; } );\n}\n\nfunction isParent ( target, check ) {\n\twhile ( target ) {\n\t\tif ( target === check ) { return true; }\n\t\ttarget = target.parent;\n\t}\n}\n\nfunction Ractive$find ( selector, options ) {\n\tvar this$1 = this;\n\tif ( options === void 0 ) options = {};\n\n\tif ( !this.el ) { throw new Error( (\"Cannot call ractive.find('\" + selector + \"') unless instance is rendered to the DOM\") ); }\n\n\tvar node = this.fragment.find( selector, options );\n\tif ( node ) { return node; }\n\n\tif ( options.remote ) {\n\t\tfor ( var i = 0; i < this._children.length; i++ ) {\n\t\t\tif ( !this$1._children[i].instance.fragment.rendered ) { continue; }\n\t\t\tnode = this$1._children[i].instance.find( selector, options );\n\t\t\tif ( node ) { return node; }\n\t\t}\n\t}\n}\n\nfunction sortByDocumentPosition ( node, otherNode ) {\n\tif ( node.compareDocumentPosition ) {\n\t\tvar bitmask = node.compareDocumentPosition( otherNode );\n\t\treturn ( bitmask & 2 ) ? 1 : -1;\n\t}\n\n\t// In old IE, we can piggy back on the mechanism for\n\t// comparing component positions\n\treturn sortByItemPosition( node, otherNode );\n}\n\nfunction sortByItemPosition ( a, b ) {\n\tvar baseA = a.component || a._ractive.proxy;\n\tvar baseB = b.component || b._ractive.proxy;\n\n\t// allow for attached childdren outside the template\n\tif ( baseA.target === false && baseB.target === false ) { return 0; }\n\telse if ( baseA.target === false ) { return 1; }\n\telse if ( baseB.target === false ) { return -1; }\n\n\tvar ancestryA = getAncestry( baseA );\n\tvar ancestryB = getAncestry( baseB );\n\n\tvar oldestA = lastItem( ancestryA );\n\tvar oldestB = lastItem( ancestryB );\n\tvar mutualAncestor;\n\n\t// remove items from the end of both ancestries as long as they are identical\n\t// - the final one removed is the closest mutual ancestor\n\twhile ( oldestA && ( oldestA === oldestB ) ) {\n\t\tancestryA.pop();\n\t\tancestryB.pop();\n\n\t\tmutualAncestor = oldestA;\n\n\t\toldestA = lastItem( ancestryA );\n\t\toldestB = lastItem( ancestryB );\n\t}\n\n\t// now that we have the mutual ancestor, we can find which is earliest\n\toldestA = oldestA.component || oldestA;\n\toldestB = oldestB.component || oldestB;\n\n\tvar fragmentA = oldestA.parentFragment;\n\tvar fragmentB = oldestB.parentFragment;\n\n\t// if both items share a parent fragment, our job is easy\n\tif ( fragmentA === fragmentB ) {\n\t\tvar indexA = fragmentA.items.indexOf( oldestA );\n\t\tvar indexB = fragmentB.items.indexOf( oldestB );\n\n\t\t// if it's the same index, it means one contains the other,\n\t\t// so we see which has the longest ancestry\n\t\treturn ( indexA - indexB ) || ancestryA.length - ancestryB.length;\n\t}\n\n\t// if mutual ancestor is a section, we first test to see which section\n\t// fragment comes first\n\tvar fragments = mutualAncestor.iterations;\n\tif ( fragments ) {\n\t\tvar indexA$1 = fragments.indexOf( fragmentA );\n\t\tvar indexB$1 = fragments.indexOf( fragmentB );\n\n\t\treturn ( indexA$1 - indexB$1 ) || ancestryA.length - ancestryB.length;\n\t}\n\n\tthrow new Error( 'An unexpected condition was met while comparing the position of two components. Please file an issue at https://github.com/ractivejs/ractive/issues - thanks!' );\n}\n\nfunction getParent ( item ) {\n\tvar parentFragment = item.parentFragment;\n\n\tif ( parentFragment ) { return parentFragment.owner; }\n\n\tif ( item.component && ( parentFragment = item.component.parentFragment ) ) {\n\t\treturn parentFragment.owner;\n\t}\n}\n\nfunction getAncestry ( item ) {\n\tvar ancestry = [ item ];\n\tvar ancestor = getParent( item );\n\n\twhile ( ancestor ) {\n\t\tancestry.push( ancestor );\n\t\tancestor = getParent( ancestor );\n\t}\n\n\treturn ancestry;\n}\n\n\nvar Query = function Query ( ractive, selector, live, isComponentQuery ) {\n\tvar this$1 = this;\n\n\tthis.ractive = ractive;\n\tthis.selector = selector;\n\tthis.live = live;\n\tthis.isComponentQuery = isComponentQuery;\n\n\tthis.refs = 1;\n\n\tthis.result = [];\n\tthis.result.cancel = function () { return this$1.cancel(); };\n\n\tthis.dirty = true;\n};\n\nQuery.prototype.add = function add ( item ) {\n\tif ( !~this.result.indexOf( item ) ) {\n\t\tthis.result.push( item );\n\t\tthis.makeDirty();\n\t}\n};\n\nQuery.prototype.cancel = function cancel () {\n\t\tvar this$1 = this;\n\n\tif ( --this.refs ) { return; }\n\n\tthis.cancelled = true;\n\n\tvar liveQueries = this.ractive[ this.isComponentQuery ? '_liveComponentQueries' : '_liveQueries' ];\n\n\tvar index = liveQueries.indexOf( this );\n\n\tif ( index !== -1 ) {\n\t\tliveQueries.splice( index, 1 );\n\t}\n\n\tthis.result.forEach( function (item) {\n\t\titem = this$1.isComponentQuery ? item.component : item._ractive.proxy;\n\t\titem.removeFromQuery( this$1 );\n\t});\n};\n\nQuery.prototype.init = function init () {\n\tthis.dirty = false;\n};\n\nQuery.prototype.makeDirty = function makeDirty () {\n\t\tvar this$1 = this;\n\n\tif ( !this.dirty ) {\n\t\tthis.dirty = true;\n\n\t\t// Once the DOM has been updated, ensure the query\n\t\t// is correctly ordered\n\t\trunloop.scheduleTask( function () { return this$1.update(); } );\n\t}\n};\n\nQuery.prototype.remove = function remove ( item ) {\n\tif ( !this.cancelled ) {\n\t\tvar index = this.result.indexOf( item );\n\t\tif ( index !== -1 ) { this.result.splice( index, 1 ); }\n\t}\n};\n\nQuery.prototype.update = function update () {\n\tthis.result.sort( this.isComponentQuery ? sortByItemPosition : sortByDocumentPosition );\n\tthis.dirty = false;\n};\n\nQuery.prototype.test = function test ( item ) {\n\treturn this.isComponentQuery ?\n\t\t( !this.selector || item.name === this.selector ) :\n\t\t( item ? matches( item, this.selector ) : null );\n};\n\nfunction Ractive$findAll ( selector, options ) {\n\tif ( options === void 0 ) options = {};\n\n\tif ( !this.el ) { throw new Error( (\"Cannot call ractive.findAll('\" + selector + \"', ...) unless instance is rendered to the DOM\") ); }\n\n\tvar query = options._query;\n\n\tif ( !query ) {\n\t\tvar liveQueries = this._liveQueries;\n\n\t\t// Shortcut: if we're maintaining a live query with this\n\t\t// selector, we don't need to traverse the parallel DOM\n\t\tquery = find$1( liveQueries, function (q) { return q.selector === selector && q.remote === options.remote; } );\n\t\tif ( query ) {\n\t\t\tif ( options.live ) { query.refs++; }\n\t\t\t// Either return the exact same query, or (if not live) a snapshot\n\t\t\treturn options.live ? query : query.slice();\n\t\t}\n\n\t\tquery = new Query( this, selector, !!options.live, false );\n\t\toptions._query = query;\n\t\tquery.remote = options.remote;\n\n\t\t// Add this to the list of live queries Ractive needs to maintain,\n\t\t// if applicable\n\t\tif ( query.live ) {\n\t\t\tliveQueries.push( query );\n\t\t}\n\t}\n\n\tthis.fragment.findAll( selector, query );\n\n\tif ( query.remote ) {\n\t\t// seach non-fragment children\n\t\tthis._children.forEach( function (c) {\n\t\t\tif ( !c.target && c.instance.fragment && c.instance.fragment.rendered ) {\n\t\t\t\tc.instance.findAll( selector, options );\n\t\t\t}\n\t\t});\n\t}\n\n\tquery.init();\n\treturn query.result;\n}\n\nfunction Ractive$findAllComponents ( selector, options ) {\n\tif ( !options && typeof selector === 'object' ) {\n\t\toptions = selector;\n\t\tselector = '';\n\t}\n\n\toptions = options || {};\n\n\tvar query = options._query;\n\n\tif ( !query ) {\n\t\tvar liveQueries = this._liveComponentQueries;\n\n\t\t// Shortcut: if we're maintaining a live query with this\n\t\t// selector, we don't need to traverse the parallel DOM\n\t\tquery = find$1( liveQueries, function (q) { return q.selector === selector && q.remote === options.remote; } );\n\t\tif ( query ) {\n\t\t\tif ( options.live ) { query.refs++; }\n\t\t\t// Either return the exact same query, or (if not live) a snapshot\n\t\t\treturn ( options.live ) ? query : query.slice();\n\t\t}\n\n\t\tquery = new Query( this, selector, !!options.live, true );\n\t\toptions._query = query;\n\t\tquery.remote = options.remote;\n\n\t\t// Add this to the list of live queries Ractive needs to maintain,\n\t\t// if applicable\n\t\tif ( query.live ) {\n\t\t\tliveQueries.push( query );\n\t\t}\n\t}\n\n\tthis.fragment.findAllComponents( selector, query );\n\n\tif ( query.remote ) {\n\t\t// search non-fragment children\n\t\tthis._children.forEach( function (c) {\n\t\t\tif ( !c.target && c.instance.fragment && c.instance.fragment.rendered ) {\n\t\t\t\tif ( query.test( c ) ) {\n\t\t\t\t\tquery.add( c.instance );\n\t\t\t\t\tc.liveQueries.push( query );\n\t\t\t\t}\n\n\t\t\t\tc.instance.findAllComponents( selector, options );\n\t\t\t}\n\t\t});\n\t}\n\n\tquery.init();\n\treturn query.result;\n}\n\nfunction Ractive$findComponent ( selector, options ) {\n\tvar this$1 = this;\n\tif ( options === void 0 ) options = {};\n\n\tif ( typeof selector === 'object' ) {\n\t\toptions = selector;\n\t\tselector = '';\n\t}\n\n\tvar child = this.fragment.findComponent( selector, options );\n\tif ( child ) { return child; }\n\n\tif ( options.remote ) {\n\t\tif ( !selector && this._children.length ) { return this._children[0].instance; }\n\t\tfor ( var i = 0; i < this._children.length; i++ ) {\n\t\t\t// skip children that are or should be in an anchor\n\t\t\tif ( this$1._children[i].target ) { continue; }\n\t\t\tif ( this$1._children[i].name === selector ) { return this$1._children[i].instance; }\n\t\t\tchild = this$1._children[i].instance.findComponent( selector, options );\n\t\t\tif ( child ) { return child; }\n\t\t}\n\t}\n}\n\nfunction Ractive$findContainer ( selector ) {\n\tif ( this.container ) {\n\t\tif ( this.container.component && this.container.component.name === selector ) {\n\t\t\treturn this.container;\n\t\t} else {\n\t\t\treturn this.container.findContainer( selector );\n\t\t}\n\t}\n\n\treturn null;\n}\n\nfunction Ractive$findParent ( selector ) {\n\n\tif ( this.parent ) {\n\t\tif ( this.parent.component && this.parent.component.name === selector ) {\n\t\t\treturn this.parent;\n\t\t} else {\n\t\t\treturn this.parent.findParent ( selector );\n\t\t}\n\t}\n\n\treturn null;\n}\n\nfunction Ractive$fire ( eventName ) {\n\tvar args = [], len = arguments.length - 1;\n\twhile ( len-- > 0 ) args[ len ] = arguments[ len + 1 ];\n\n\treturn fireEvent( this, eventName, { args: args });\n}\n\nvar stack = [];\nvar captureGroup;\n\nfunction startCapturing () {\n\tstack.push( captureGroup = [] );\n}\n\nfunction stopCapturing () {\n\tvar dependencies = stack.pop();\n\tcaptureGroup = stack[ stack.length - 1 ];\n\treturn dependencies;\n}\n\nfunction capture ( model ) {\n\tif ( captureGroup ) {\n\t\tcaptureGroup.push( model );\n\t}\n}\n\nvar KeyModel = function KeyModel ( key, parent ) {\n\tthis.value = key;\n\tthis.isReadonly = this.isKey = true;\n\tthis.deps = [];\n\tthis.links = [];\n\tthis.parent = parent;\n};\n\nKeyModel.prototype.get = function get ( shouldCapture ) {\n\tif ( shouldCapture ) { capture( this ); }\n\treturn unescapeKey( this.value );\n};\n\nKeyModel.prototype.getKeypath = function getKeypath () {\n\treturn unescapeKey( this.value );\n};\n\nKeyModel.prototype.rebinding = function rebinding ( next, previous ) {\n\t\tvar this$1 = this;\n\n\tvar i = this.deps.length;\n\twhile ( i-- ) { this$1.deps[i].rebinding( next, previous, false ); }\n\n\ti = this.links.length;\n\twhile ( i-- ) { this$1.links[i].rebinding( next, previous, false ); }\n};\n\nKeyModel.prototype.register = function register ( dependant ) {\n\tthis.deps.push( dependant );\n};\n\nKeyModel.prototype.registerLink = function registerLink ( link ) {\n\taddToArray( this.links, link );\n};\n\nKeyModel.prototype.unregister = function unregister ( dependant ) {\n\tremoveFromArray( this.deps, dependant );\n};\n\nKeyModel.prototype.unregisterLink = function unregisterLink ( link ) {\n\tremoveFromArray( this.links, link );\n};\n\nfunction bind$1$1               ( x ) { x.bind(); }\nfunction cancel$1             ( x ) { x.cancel(); }\nfunction destroyed$1$1          ( x ) { x.destroyed(); }\nfunction handleChange$1$1       ( x ) { x.handleChange(); }\nfunction mark$1$1               ( x ) { x.mark(); }\nfunction marked             ( x ) { x.marked(); }\nfunction markedAll          ( x ) { x.markedAll(); }\nfunction notifiedUpstream   ( x ) { x.notifiedUpstream(); }\nfunction render$1$1             ( x ) { x.render(); }\nfunction shuffled$1$1           ( x )  { x.shuffled(); }\nfunction teardown$1$1           ( x ) { x.teardown(); }\nfunction unbind$1$1             ( x ) { x.unbind(); }\nfunction unrender$1$1           ( x ) { x.unrender(); }\nfunction unrenderAndDestroy ( x ) { x.unrender( true ); }\nfunction update$1$1             ( x ) { x.update(); }\nfunction toString$2           ( x ) { return x.toString(); }\nfunction toEscapedString    ( x ) { return x.toString( true ); }\n\nvar KeypathModel = function KeypathModel ( parent, ractive ) {\n\tthis.parent = parent;\n\tthis.ractive = ractive;\n\tthis.value = ractive ? parent.getKeypath( ractive ) : parent.getKeypath();\n\tthis.deps = [];\n\tthis.children = {};\n\tthis.isReadonly = this.isKeypath = true;\n};\n\nKeypathModel.prototype.get = function get ( shouldCapture ) {\n\tif ( shouldCapture ) { capture( this ); }\n\treturn this.value;\n};\n\nKeypathModel.prototype.getChild = function getChild ( ractive ) {\n\tif ( !( ractive._guid in this.children ) ) {\n\t\tvar model = new KeypathModel( this.parent, ractive );\n\t\tthis.children[ ractive._guid ] = model;\n\t\tmodel.owner = this;\n\t}\n\treturn this.children[ ractive._guid ];\n};\n\nKeypathModel.prototype.getKeypath = function getKeypath () {\n\treturn this.value;\n};\n\nKeypathModel.prototype.handleChange = function handleChange$1 () {\n\t\tvar this$1 = this;\n\n\tvar keys = Object.keys( this.children );\n\tvar i = keys.length;\n\twhile ( i-- ) {\n\t\tthis$1.children[ keys[i] ].handleChange();\n\t}\n\n\tthis.deps.forEach( handleChange$1$1 );\n};\n\nKeypathModel.prototype.rebindChildren = function rebindChildren ( next ) {\n\t\tvar this$1 = this;\n\n\tvar keys = Object.keys( this.children );\n\tvar i = keys.length;\n\twhile ( i-- ) {\n\t\tvar child = this$1.children[keys[i]];\n\t\tchild.value = next.getKeypath( child.ractive );\n\t\tchild.handleChange();\n\t}\n};\n\nKeypathModel.prototype.rebinding = function rebinding ( next, previous ) {\n\t\tvar this$1 = this;\n\n\tvar model = next ? next.getKeypathModel( this.ractive ) : undefined;\n\n\tvar keys = Object.keys( this.children );\n\tvar i = keys.length;\n\twhile ( i-- ) {\n\t\tthis$1.children[ keys[i] ].rebinding( next, previous, false );\n\t}\n\n\ti = this.deps.length;\n\twhile ( i-- ) {\n\t\tthis$1.deps[i].rebinding( model, this$1, false );\n\t}\n};\n\nKeypathModel.prototype.register = function register ( dep ) {\n\tthis.deps.push( dep );\n};\n\nKeypathModel.prototype.removeChild = function removeChild ( model ) {\n\tif ( model.ractive ) { delete this.children[ model.ractive._guid ]; }\n};\n\nKeypathModel.prototype.teardown = function teardown () {\n\t\tvar this$1 = this;\n\n\tif ( this.owner ) { this.owner.removeChild( this ); }\n\n\tvar keys = Object.keys( this.children );\n\tvar i = keys.length;\n\twhile ( i-- ) {\n\t\tthis$1.children[ keys[i] ].teardown();\n\t}\n};\n\nKeypathModel.prototype.unregister = function unregister ( dep ) {\n\tremoveFromArray( this.deps, dep );\n\tif ( !this.deps.length ) { this.teardown(); }\n};\n\nfunction bind$2 ( fn, context ) {\n\tif ( !/this/.test( fn.toString() ) ) { return fn; }\n\n\tvar bound = fn.bind( context );\n\tfor ( var prop in fn ) { bound[ prop ] = fn[ prop ]; }\n\n\treturn bound;\n}\n\nvar hasProp = Object.prototype.hasOwnProperty;\n\nvar shuffleTasks = { early: [], mark: [] };\nvar registerQueue = { early: [], mark: [] };\n\nvar ModelBase = function ModelBase ( parent ) {\n\tthis.deps = [];\n\n\tthis.children = [];\n\tthis.childByKey = {};\n\tthis.links = [];\n\n\tthis.keyModels = {};\n\n\tthis.unresolved = [];\n\tthis.unresolvedByKey = {};\n\n\tthis.bindings = [];\n\tthis.patternObservers = [];\n\n\tif ( parent ) {\n\t\tthis.parent = parent;\n\t\tthis.root = parent.root;\n\t}\n};\n\nModelBase.prototype.addUnresolved = function addUnresolved ( key, resolver ) {\n\tif ( !this.unresolvedByKey[ key ] ) {\n\t\tthis.unresolved.push( key );\n\t\tthis.unresolvedByKey[ key ] = [];\n\t}\n\n\tthis.unresolvedByKey[ key ].push( resolver );\n};\n\nModelBase.prototype.addShuffleTask = function addShuffleTask ( task, stage ) {\n\tif ( stage === void 0 ) stage = 'early';\n shuffleTasks[stage].push( task ); };\nModelBase.prototype.addShuffleRegister = function addShuffleRegister ( item, stage ) {\n\tif ( stage === void 0 ) stage = 'early';\n registerQueue[stage].push({ model: this, item: item }); };\n\nModelBase.prototype.clearUnresolveds = function clearUnresolveds ( specificKey ) {\n\t\tvar this$1 = this;\n\n\tvar i = this.unresolved.length;\n\n\twhile ( i-- ) {\n\t\tvar key = this$1.unresolved[i];\n\n\t\tif ( specificKey && key !== specificKey ) { continue; }\n\n\t\tvar resolvers = this$1.unresolvedByKey[ key ];\n\t\tvar hasKey = this$1.has( key );\n\n\t\tvar j = resolvers.length;\n\t\twhile ( j-- ) {\n\t\t\tif ( hasKey ) { resolvers[j].attemptResolution(); }\n\t\t\tif ( resolvers[j].resolved ) { resolvers.splice( j, 1 ); }\n\t\t}\n\n\t\tif ( !resolvers.length ) {\n\t\t\tthis$1.unresolved.splice( i, 1 );\n\t\t\tthis$1.unresolvedByKey[ key ] = null;\n\t\t}\n\t}\n};\n\nModelBase.prototype.findMatches = function findMatches ( keys ) {\n\tvar len = keys.length;\n\n\tvar existingMatches = [ this ];\n\tvar matches;\n\tvar i;\n\n\tvar loop = function (  ) {\n\t\tvar key = keys[i];\n\n\t\tif ( key === '*' ) {\n\t\t\tmatches = [];\n\t\t\texistingMatches.forEach( function (model) {\n\t\t\t\tmatches.push.apply( matches, model.getValueChildren( model.get() ) );\n\t\t\t});\n\t\t} else {\n\t\t\tmatches = existingMatches.map( function (model) { return model.joinKey( key ); } );\n\t\t}\n\n\t\texistingMatches = matches;\n\t};\n\n\t\tfor ( i = 0; i < len; i += 1 ) loop(  );\n\n\treturn matches;\n};\n\nModelBase.prototype.getKeyModel = function getKeyModel ( key, skip ) {\n\tif ( key !== undefined && !skip ) { return this.parent.getKeyModel( key, true ); }\n\n\tif ( !( key in this.keyModels ) ) { this.keyModels[ key ] = new KeyModel( escapeKey( key ), this ); }\n\n\treturn this.keyModels[ key ];\n};\n\nModelBase.prototype.getKeypath = function getKeypath ( ractive ) {\n\tif ( ractive !== this.ractive && this._link ) { return this._link.target.getKeypath( ractive ); }\n\n\tif ( !this.keypath ) {\n\t\tthis.keypath = this.parent.isRoot ? this.key : ((this.parent.getKeypath( ractive )) + \".\" + (escapeKey( this.key )));\n\t}\n\n\treturn this.keypath;\n};\n\nModelBase.prototype.getValueChildren = function getValueChildren ( value ) {\n\t\tvar this$1 = this;\n\n\tvar children;\n\tif ( isArray( value ) ) {\n\t\tchildren = [];\n\t\tif ( 'length' in this && this.length !== value.length ) {\n\t\t\tchildren.push( this.joinKey( 'length' ) );\n\t\t}\n\t\tvalue.forEach( function ( m, i ) {\n\t\t\tchildren.push( this$1.joinKey( i ) );\n\t\t});\n\t}\n\n\telse if ( isObject( value ) || typeof value === 'function' ) {\n\t\tchildren = Object.keys( value ).map( function (key) { return this$1.joinKey( key ); } );\n\t}\n\n\telse if ( value != null ) {\n\t\treturn [];\n\t}\n\n\treturn children;\n};\n\nModelBase.prototype.getVirtual = function getVirtual ( shouldCapture ) {\n\t\tvar this$1 = this;\n\n\tvar value = this.get( shouldCapture, { virtual: false } );\n\tif ( isObject( value ) ) {\n\t\tvar result = isArray( value ) ? [] : {};\n\n\t\tvar keys = Object.keys( value );\n\t\tvar i = keys.length;\n\t\twhile ( i-- ) {\n\t\t\tvar child = this$1.childByKey[ keys[i] ];\n\t\t\tif ( !child ) { result[ keys[i] ] = value[ keys[i] ]; }\n\t\t\telse if ( child._link ) { result[ keys[i] ] = child._link.getVirtual(); }\n\t\t\telse { result[ keys[i] ] = child.getVirtual(); }\n\t\t}\n\n\t\ti = this.children.length;\n\t\twhile ( i-- ) {\n\t\t\tvar child$1 = this$1.children[i];\n\t\t\tif ( !( child$1.key in result ) && child$1._link ) {\n\t\t\t\tresult[ child$1.key ] = child$1._link.getVirtual();\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t} else { return value; }\n};\n\nModelBase.prototype.has = function has ( key ) {\n\tif ( this._link ) { return this._link.has( key ); }\n\n\tvar value = this.get();\n\tif ( !value ) { return false; }\n\n\tkey = unescapeKey( key );\n\tif ( hasProp.call( value, key ) ) { return true; }\n\n\t// We climb up the constructor chain to find if one of them contains the key\n\tvar constructor = value.constructor;\n\twhile ( constructor !== Function && constructor !== Array && constructor !== Object ) {\n\t\tif ( hasProp.call( constructor.prototype, key ) ) { return true; }\n\t\tconstructor = constructor.constructor;\n\t}\n\n\treturn false;\n};\n\nModelBase.prototype.joinAll = function joinAll ( keys, opts ) {\n\tvar model = this;\n\tfor ( var i = 0; i < keys.length; i += 1 ) {\n\t\tif ( opts && opts.lastLink === false && i + 1 === keys.length && model.childByKey[keys[i]] && model.childByKey[keys[i]]._link ) { return model.childByKey[keys[i]]; }\n\t\tmodel = model.joinKey( keys[i], opts );\n\t}\n\n\treturn model;\n};\n\nModelBase.prototype.notifyUpstream = function notifyUpstream () {\n\tvar parent = this.parent;\n\tvar path = [ this.key ];\n\twhile ( parent ) {\n\t\tif ( parent.patternObservers.length ) { parent.patternObservers.forEach( function (o) { return o.notify( path.slice() ); } ); }\n\t\tpath.unshift( parent.key );\n\t\tparent.links.forEach( notifiedUpstream );\n\t\tparent.deps.forEach( handleChange$1$1 );\n\t\tparent = parent.parent;\n\t}\n};\n\nModelBase.prototype.rebinding = function rebinding ( next, previous, safe ) {\n\t\tvar this$1 = this;\n\n\t// tell the deps to move to the new target\n\tvar i = this.deps.length;\n\twhile ( i-- ) {\n\t\tif ( this$1.deps[i].rebinding ) { this$1.deps[i].rebinding( next, previous, safe ); }\n\t}\n\n\ti = this.links.length;\n\twhile ( i-- ) {\n\t\tvar link = this$1.links[i];\n\t\t// only relink the root of the link tree\n\t\tif ( link.owner._link ) { link.relinking( next, true, safe ); }\n\t}\n\n\ti = this.children.length;\n\twhile ( i-- ) {\n\t\tvar child = this$1.children[i];\n\t\tchild.rebinding( next ? next.joinKey( child.key ) : undefined, child, safe );\n\t}\n\n\ti = this.unresolved.length;\n\twhile ( i-- ) {\n\t\tvar unresolved = this$1.unresolvedByKey[ this$1.unresolved[i] ];\n\t\tvar c = unresolved.length;\n\t\twhile ( c-- ) {\n\t\t\tunresolved[c].rebinding( next, previous );\n\t\t}\n\t}\n\n\tif ( this.keypathModel ) { this.keypathModel.rebinding( next, previous, false ); }\n\n\ti = this.bindings.length;\n\twhile ( i-- ) {\n\t\tthis$1.bindings[i].rebinding( next, previous, safe );\n\t}\n};\n\nModelBase.prototype.register = function register ( dep ) {\n\tthis.deps.push( dep );\n};\n\nModelBase.prototype.registerChange = function registerChange ( key, value ) {\n\tif ( !this.isRoot ) {\n\t\tthis.root.registerChange( key, value );\n\t} else {\n\t\tthis.changes[ key ] = value;\n\t\trunloop.addInstance( this.root.ractive );\n\t}\n};\n\nModelBase.prototype.registerLink = function registerLink ( link ) {\n\taddToArray( this.links, link );\n};\n\nModelBase.prototype.registerPatternObserver = function registerPatternObserver ( observer ) {\n\tthis.patternObservers.push( observer );\n\tthis.register( observer );\n};\n\nModelBase.prototype.registerTwowayBinding = function registerTwowayBinding ( binding ) {\n\tthis.bindings.push( binding );\n};\n\nModelBase.prototype.removeUnresolved = function removeUnresolved ( key, resolver ) {\n\tvar resolvers = this.unresolvedByKey[ key ];\n\n\tif ( resolvers ) {\n\t\tremoveFromArray( resolvers, resolver );\n\t}\n};\n\nModelBase.prototype.shuffled = function shuffled () {\n\t\tvar this$1 = this;\n\n\tvar i = this.children.length;\n\twhile ( i-- ) {\n\t\tthis$1.children[i].shuffled();\n\t}\n\tif ( this.wrapper ) {\n\t\tthis.wrapper.teardown();\n\t\tthis.wrapper = null;\n\t\tthis.rewrap = true;\n\t}\n};\n\nModelBase.prototype.unregister = function unregister ( dependant ) {\n\tremoveFromArray( this.deps, dependant );\n};\n\nModelBase.prototype.unregisterLink = function unregisterLink ( link ) {\n\tremoveFromArray( this.links, link );\n};\n\nModelBase.prototype.unregisterPatternObserver = function unregisterPatternObserver ( observer ) {\n\tremoveFromArray( this.patternObservers, observer );\n\tthis.unregister( observer );\n};\n\nModelBase.prototype.unregisterTwowayBinding = function unregisterTwowayBinding ( binding ) {\n\tremoveFromArray( this.bindings, binding );\n};\n\nModelBase.prototype.updateFromBindings = function updateFromBindings$1 ( cascade ) {\n\t\tvar this$1 = this;\n\n\tvar i = this.bindings.length;\n\twhile ( i-- ) {\n\t\tvar value = this$1.bindings[i].getValue();\n\t\tif ( value !== this$1.value ) { this$1.set( value ); }\n\t}\n\n\t// check for one-way bindings if there are no two-ways\n\tif ( !this.bindings.length ) {\n\t\tvar oneway = findBoundValue( this.deps );\n\t\tif ( oneway && oneway.value !== this.value ) { this.set( oneway.value ); }\n\t}\n\n\tif ( cascade ) {\n\t\tthis.children.forEach( updateFromBindings );\n\t\tthis.links.forEach( updateFromBindings );\n\t\tif ( this._link ) { this._link.updateFromBindings( cascade ); }\n\t}\n};\n\n// TODO: this may be better handled by overreiding `get` on models with a parent that isRoot\nfunction maybeBind ( model, value, shouldBind ) {\n\tif ( shouldBind && typeof value === 'function' && model.parent && model.parent.isRoot ) {\n\t\tif ( !model.boundValue ) {\n\t\t\tmodel.boundValue = bind$2( value._r_unbound || value, model.parent.ractive );\n\t\t}\n\n\t\treturn model.boundValue;\n\t}\n\n\treturn value;\n}\n\nfunction updateFromBindings ( model ) {\n\tmodel.updateFromBindings( true );\n}\n\nfunction findBoundValue( list ) {\n\tvar i = list.length;\n\twhile ( i-- ) {\n\t\tif ( list[i].bound ) {\n\t\t\tvar owner = list[i].owner;\n\t\t\tif ( owner ) {\n\t\t\t\tvar value = owner.name === 'checked' ?\n\t\t\t\t\towner.node.checked :\n\t\t\t\t\towner.node.value;\n\t\t\t\treturn { value: value };\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction fireShuffleTasks ( stage ) {\n\tif ( !stage ) {\n\t\tfireShuffleTasks( 'early' );\n\t\tfireShuffleTasks( 'mark' );\n\t} else {\n\t\tvar tasks = shuffleTasks[stage];\n\t\tshuffleTasks[stage] = [];\n\t\tvar i = tasks.length;\n\t\twhile ( i-- ) { tasks[i](); }\n\n\t\tvar register = registerQueue[stage];\n\t\tregisterQueue[stage] = [];\n\t\ti = register.length;\n\t\twhile ( i-- ) { register[i].model.register( register[i].item ); }\n\t}\n}\n\nfunction shuffle$1$1 ( model, newIndices, link ) {\n\tmodel.shuffling = true;\n\n\tvar i = newIndices.length;\n\twhile ( i-- ) {\n\t\tvar idx = newIndices[ i ];\n\t\t// nothing is actually changing, so move in the index and roll on\n\t\tif ( i === idx ) {\n\t\t\tcontinue;\n\t\t}\n\n\t\t// rebind the children on i to idx\n\t\tif ( i in model.childByKey ) { model.childByKey[ i ].rebinding( !~idx ? undefined : model.joinKey( idx ), model.childByKey[ i ], true ); }\n\n\t\tif ( !~idx && model.keyModels[ i ] ) {\n\t\t\tmodel.keyModels[i].rebinding( undefined, model.keyModels[i], false );\n\t\t} else if ( ~idx && model.keyModels[ i ] ) {\n\t\t\tif ( !model.keyModels[ idx ] ) { model.childByKey[ idx ].getKeyModel( idx ); }\n\t\t\tmodel.keyModels[i].rebinding( model.keyModels[ idx ], model.keyModels[i], false );\n\t\t}\n\t}\n\n\tvar upstream = model.source().length !== model.source().value.length;\n\n\tmodel.links.forEach( function (l) { return l.shuffle( newIndices ); } );\n\tif ( !link ) { fireShuffleTasks( 'early' ); }\n\n\ti = model.deps.length;\n\twhile ( i-- ) {\n\t\tif ( model.deps[i].shuffle ) { model.deps[i].shuffle( newIndices ); }\n\t}\n\n\tmodel[ link ? 'marked' : 'mark' ]();\n\tif ( !link ) { fireShuffleTasks( 'mark' ); }\n\n\tif ( upstream ) { model.notifyUpstream(); }\n\n\tmodel.shuffling = false;\n}\n\nKeyModel.prototype.addShuffleTask = ModelBase.prototype.addShuffleTask;\nKeyModel.prototype.addShuffleRegister = ModelBase.prototype.addShuffleRegister;\nKeypathModel.prototype.addShuffleTask = ModelBase.prototype.addShuffleTask;\nKeypathModel.prototype.addShuffleRegister = ModelBase.prototype.addShuffleRegister;\n\n// this is the dry method of checking to see if a rebind applies to\n// a particular keypath because in some cases, a dep may be bound\n// directly to a particular keypath e.g. foo.bars.0.baz and need\n// to avoid getting kicked to foo.bars.1.baz if foo.bars is unshifted\nfunction rebindMatch ( template, next, previous ) {\n\tvar keypath = template.r || template;\n\n\t// no valid keypath, go with next\n\tif ( !keypath || typeof keypath !== 'string' ) { return next; }\n\n\t// completely contextual ref, go with next\n\tif ( keypath === '.' || keypath[0] === '@' || (next || previous).isKey || (next || previous).isKeypath ) { return next; }\n\n\tvar parts = keypath.split( '/' );\n\tvar keys = splitKeypath( parts[ parts.length - 1 ] );\n\n\t// check the keypath against the model keypath to see if it matches\n\tvar model = next || previous;\n\tvar i = keys.length;\n\tvar match = true;\n\tvar shuffling = false;\n\n\twhile ( model && i-- ) {\n\t\tif ( model.shuffling ) { shuffling = true; }\n\t\t// non-strict comparison to account for indices in keypaths\n\t\tif ( keys[i] != model.key ) { match = false; }\n\t\tmodel = model.parent;\n\t}\n\n\t// next is undefined, but keypath is shuffling and previous matches\n\tif ( !next && match && shuffling ) { return previous; }\n\t// next is defined, but doesn't match the keypath\n\telse if ( next && !match && shuffling ) { return previous; }\n\telse { return next; }\n}\n\n// temporary placeholder target for detached implicit links\nvar Missing = {\n\tkey: '@missing',\n\tanimate: noop,\n\tapplyValue: noop,\n\tget: noop,\n\tgetKeypath: function getKeypath () { return this.key; },\n\tjoinAll: function joinAll () { return this; },\n\tjoinKey: function joinKey () { return this; },\n\tmark: noop,\n\tregisterLink: noop,\n\tshufle: noop,\n\tset: noop,\n\tunregisterLink: noop\n};\nMissing.parent = Missing;\n\nvar LinkModel = (function (ModelBase$$1) {\n\tfunction LinkModel ( parent, owner, target, key ) {\n\t\tModelBase$$1.call( this, parent );\n\n\t\tthis.owner = owner;\n\t\tthis.target = target;\n\t\tthis.key = key === undefined ? owner.key : key;\n\t\tif ( owner.isLink ) { this.sourcePath = (owner.sourcePath) + \".\" + (this.key); }\n\n\t\ttarget.registerLink( this );\n\n\t\tif ( parent ) { this.isReadonly = parent.isReadonly; }\n\n\t\tthis.isLink = true;\n\t}\n\n\tif ( ModelBase$$1 ) LinkModel.__proto__ = ModelBase$$1;\n\tLinkModel.prototype = Object.create( ModelBase$$1 && ModelBase$$1.prototype );\n\tLinkModel.prototype.constructor = LinkModel;\n\n\tLinkModel.prototype.animate = function animate ( from, to, options, interpolator ) {\n\t\tthis.target.animate( from, to, options, interpolator );\n\t};\n\n\tLinkModel.prototype.applyValue = function applyValue ( value ) {\n\t\tif ( this.boundValue ) { this.boundValue = null; }\n\t\tthis.target.applyValue( value );\n\t};\n\n\tLinkModel.prototype.attach = function attach ( fragment ) {\n\t\tvar model = resolveReference( fragment, this.key );\n\t\tif ( model ) {\n\t\t\tthis.relinking( model, true, false );\n\t\t} else { // if there is no link available, move everything here to real models\n\t\t\tthis.owner.unlink();\n\t\t}\n\t};\n\n\tLinkModel.prototype.detach = function detach () {\n\t\tthis.relinking( Missing, true, false );\n\t};\n\n\tLinkModel.prototype.get = function get ( shouldCapture, opts ) {\n\t\tif ( opts === void 0 ) opts = {};\n\n\t\tif ( shouldCapture ) {\n\t\t\tcapture( this );\n\n\t\t\t// may need to tell the target to unwrap\n\t\t\topts.unwrap = true;\n\t\t}\n\n\t\tvar bind$$1 = 'shouldBind' in opts ? opts.shouldBind : true;\n\t\topts.shouldBind = false;\n\n\t\treturn maybeBind( this, this.target.get( false, opts ), bind$$1 );\n\t};\n\n\tLinkModel.prototype.getKeypath = function getKeypath ( ractive ) {\n\t\tif ( ractive && ractive !== this.root.ractive ) { return this.target.getKeypath( ractive ); }\n\n\t\treturn ModelBase$$1.prototype.getKeypath.call( this, ractive );\n\t};\n\n\tLinkModel.prototype.getKeypathModel = function getKeypathModel ( ractive ) {\n\t\tif ( !this.keypathModel ) { this.keypathModel = new KeypathModel( this ); }\n\t\tif ( ractive && ractive !== this.root.ractive ) { return this.keypathModel.getChild( ractive ); }\n\t\treturn this.keypathModel;\n\t};\n\n\tLinkModel.prototype.handleChange = function handleChange$1 () {\n\t\tthis.deps.forEach( handleChange$1$1 );\n\t\tthis.links.forEach( handleChange$1$1 );\n\t\tthis.notifyUpstream();\n\t};\n\n\tLinkModel.prototype.isDetached = function isDetached () { return this.virtual && this.target === Missing; };\n\n\tLinkModel.prototype.joinKey = function joinKey ( key ) {\n\t\t// TODO: handle nested links\n\t\tif ( key === undefined || key === '' ) { return this; }\n\n\t\tif ( !this.childByKey.hasOwnProperty( key ) ) {\n\t\t\tvar child = new LinkModel( this, this, this.target.joinKey( key ), key );\n\t\t\tthis.children.push( child );\n\t\t\tthis.childByKey[ key ] = child;\n\t\t}\n\n\t\treturn this.childByKey[ key ];\n\t};\n\n\tLinkModel.prototype.mark = function mark () {\n\t\tthis.target.mark();\n\t};\n\n\tLinkModel.prototype.marked = function marked$1 () {\n\t\tif ( this.boundValue ) { this.boundValue = null; }\n\n\t\tthis.links.forEach( marked );\n\n\t\tthis.deps.forEach( handleChange$1$1 );\n\t\tthis.clearUnresolveds();\n\t};\n\n\tLinkModel.prototype.markedAll = function markedAll$1 () {\n\t\tthis.children.forEach( markedAll );\n\t\tthis.marked();\n\t};\n\n\tLinkModel.prototype.notifiedUpstream = function notifiedUpstream$1 () {\n\t\tthis.links.forEach( notifiedUpstream );\n\t\tthis.deps.forEach( handleChange$1$1 );\n\t};\n\n\tLinkModel.prototype.relinked = function relinked () {\n\t\tthis.target.registerLink( this );\n\t\tthis.children.forEach( function (c) { return c.relinked(); } );\n\t};\n\n\tLinkModel.prototype.relinking = function relinking ( target, root, safe ) {\n\t\tvar this$1 = this;\n\n\t\tif ( root && this.sourcePath ) { target = rebindMatch( this.sourcePath, target, this.target ); }\n\t\tif ( !target || this.target === target ) { return; }\n\n\t\tthis.target.unregisterLink( this );\n\t\tif ( this.keypathModel ) { this.keypathModel.rebindChildren( target ); }\n\n\t\tthis.target = target;\n\t\tthis.children.forEach( function (c) {\n\t\t\tc.relinking( target.joinKey( c.key ), false, safe );\n\t\t});\n\n\t\tif ( root ) { this.addShuffleTask( function () {\n\t\t\tthis$1.relinked();\n\t\t\tif ( !safe ) { this$1.notifyUpstream(); }\n\t\t}); }\n\t};\n\n\tLinkModel.prototype.set = function set ( value ) {\n\t\tif ( this.boundValue ) { this.boundValue = null; }\n\t\tthis.target.set( value );\n\t};\n\n\tLinkModel.prototype.shuffle = function shuffle$1 ( newIndices ) {\n\t\t// watch for extra shuffles caused by a shuffle in a downstream link\n\t\tif ( this.shuffling ) { return; }\n\n\t\t// let the real model handle firing off shuffles\n\t\tif ( !this.target.shuffling ) {\n\t\t\tthis.target.shuffle( newIndices );\n\t\t} else {\n\t\t\tshuffle$1$1( this, newIndices, true );\n\t\t}\n\n\t};\n\n\tLinkModel.prototype.source = function source () {\n\t\tif ( this.target.source ) { return this.target.source(); }\n\t\telse { return this.target; }\n\t};\n\n\tLinkModel.prototype.teardown = function teardown$1 () {\n\t\tif ( this._link ) { this._link.teardown(); }\n\t\tthis.children.forEach( teardown$1$1 );\n\t};\n\n\treturn LinkModel;\n}(ModelBase));\n\nModelBase.prototype.link = function link ( model, keypath, options ) {\n\tvar lnk = this._link || new LinkModel( this.parent, this, model, this.key );\n\tlnk.implicit = options && options.implicit;\n\tlnk.sourcePath = keypath;\n\tif ( this._link ) { this._link.relinking( model, true, false ); }\n\tthis.rebinding( lnk, this, false );\n\tfireShuffleTasks();\n\n\tvar unresolved = !this._link;\n\tthis._link = lnk;\n\tif ( unresolved && this.parent ) { this.parent.clearUnresolveds(); }\n\tlnk.marked();\n\treturn lnk;\n};\n\nModelBase.prototype.unlink = function unlink () {\n\tif ( this._link ) {\n\t\tvar ln = this._link;\n\t\tthis._link = undefined;\n\t\tln.rebinding( this, this._link );\n\t\tfireShuffleTasks();\n\t\tln.teardown();\n\t}\n};\n\nvar requestAnimationFrame;\n\n// If window doesn't exist, we don't need requestAnimationFrame\nif ( !win ) {\n\trequestAnimationFrame = null;\n} else {\n\t// https://gist.github.com/paulirish/1579671\n\t(function ( vendors$$1, lastTime, win$$1 ) {\n\n\t\tvar x, setTimeout;\n\n\t\tif ( win$$1.requestAnimationFrame ) {\n\t\t\treturn;\n\t\t}\n\n\t\tfor ( x = 0; x < vendors$$1.length && !win$$1.requestAnimationFrame; ++x ) {\n\t\t\twin$$1.requestAnimationFrame = win$$1[ vendors$$1[x] + 'RequestAnimationFrame' ];\n\t\t}\n\n\t\tif ( !win$$1.requestAnimationFrame ) {\n\t\t\tsetTimeout = win$$1.setTimeout;\n\n\t\t\twin$$1.requestAnimationFrame = function ( callback ) {\n\t\t\t\tvar currTime = Date.now();\n\t\t\t\tvar timeToCall = Math.max( 0, 16 - ( currTime - lastTime ) );\n\t\t\t\tvar id = setTimeout( function () { callback(currTime + timeToCall); }, timeToCall );\n\n\t\t\t\tlastTime = currTime + timeToCall;\n\t\t\t\treturn id;\n\t\t\t};\n\t\t}\n\n\t}( vendors, 0, win ));\n\n\trequestAnimationFrame = win.requestAnimationFrame;\n}\n\nvar rAF = requestAnimationFrame;\n\nvar getTime = ( win && win.performance && typeof win.performance.now === 'function' ) ?\n\tfunction () { return win.performance.now(); } :\n\tfunction () { return Date.now(); };\n\n// TODO what happens if a transition is aborted?\n\nvar tickers = [];\nvar running = false;\n\nfunction tick () {\n\trunloop.start();\n\n\tvar now = getTime();\n\n\tvar i;\n\tvar ticker;\n\n\tfor ( i = 0; i < tickers.length; i += 1 ) {\n\t\tticker = tickers[i];\n\n\t\tif ( !ticker.tick( now ) ) {\n\t\t\t// ticker is complete, remove it from the stack, and decrement i so we don't miss one\n\t\t\ttickers.splice( i--, 1 );\n\t\t}\n\t}\n\n\trunloop.end();\n\n\tif ( tickers.length ) {\n\t\trAF( tick );\n\t} else {\n\t\trunning = false;\n\t}\n}\n\nvar Ticker = function Ticker ( options ) {\n\tthis.duration = options.duration;\n\tthis.step = options.step;\n\tthis.complete = options.complete;\n\tthis.easing = options.easing;\n\n\tthis.start = getTime();\n\tthis.end = this.start + this.duration;\n\n\tthis.running = true;\n\n\ttickers.push( this );\n\tif ( !running ) { rAF( tick ); }\n};\n\nTicker.prototype.tick = function tick$1 ( now ) {\n\tif ( !this.running ) { return false; }\n\n\tif ( now > this.end ) {\n\t\tif ( this.step ) { this.step( 1 ); }\n\t\tif ( this.complete ) { this.complete( 1 ); }\n\n\t\treturn false;\n\t}\n\n\tvar elapsed = now - this.start;\n\tvar eased = this.easing( elapsed / this.duration );\n\n\tif ( this.step ) { this.step( eased ); }\n\n\treturn true;\n};\n\nTicker.prototype.stop = function stop () {\n\tif ( this.abort ) { this.abort(); }\n\tthis.running = false;\n};\n\nvar prefixers = {};\n\n// TODO this is legacy. sooner we can replace the old adaptor API the better\nfunction prefixKeypath ( obj, prefix ) {\n\tvar prefixed = {};\n\n\tif ( !prefix ) {\n\t\treturn obj;\n\t}\n\n\tprefix += '.';\n\n\tfor ( var key in obj ) {\n\t\tif ( obj.hasOwnProperty( key ) ) {\n\t\t\tprefixed[ prefix + key ] = obj[ key ];\n\t\t}\n\t}\n\n\treturn prefixed;\n}\n\nfunction getPrefixer ( rootKeypath ) {\n\tvar rootDot;\n\n\tif ( !prefixers[ rootKeypath ] ) {\n\t\trootDot = rootKeypath ? rootKeypath + '.' : '';\n\n\t\tprefixers[ rootKeypath ] = function ( relativeKeypath, value ) {\n\t\t\tvar obj;\n\n\t\t\tif ( typeof relativeKeypath === 'string' ) {\n\t\t\t\tobj = {};\n\t\t\t\tobj[ rootDot + relativeKeypath ] = value;\n\t\t\t\treturn obj;\n\t\t\t}\n\n\t\t\tif ( typeof relativeKeypath === 'object' ) {\n\t\t\t\t// 'relativeKeypath' is in fact a hash, not a keypath\n\t\t\t\treturn rootDot ? prefixKeypath( relativeKeypath, rootKeypath ) : relativeKeypath;\n\t\t\t}\n\t\t};\n\t}\n\n\treturn prefixers[ rootKeypath ];\n}\n\nvar Model = (function (ModelBase$$1) {\n\tfunction Model ( parent, key ) {\n\t\tModelBase$$1.call( this, parent );\n\n\t\tthis.ticker = null;\n\n\t\tif ( parent ) {\n\t\t\tthis.key = unescapeKey( key );\n\t\t\tthis.isReadonly = parent.isReadonly;\n\n\t\t\tif ( parent.value ) {\n\t\t\t\tthis.value = parent.value[ this.key ];\n\t\t\t\tif ( isArray( this.value ) ) { this.length = this.value.length; }\n\t\t\t\tthis.adapt();\n\t\t\t}\n\t\t}\n\t}\n\n\tif ( ModelBase$$1 ) Model.__proto__ = ModelBase$$1;\n\tModel.prototype = Object.create( ModelBase$$1 && ModelBase$$1.prototype );\n\tModel.prototype.constructor = Model;\n\n\tModel.prototype.adapt = function adapt () {\n\t\tvar this$1 = this;\n\n\t\tvar adaptors = this.root.adaptors;\n\t\tvar len = adaptors.length;\n\n\t\tthis.rewrap = false;\n\n\t\t// Exit early if no adaptors\n\t\tif ( len === 0 ) { return; }\n\n\t\tvar value = this.wrapper ? ( 'newWrapperValue' in this ? this.newWrapperValue : this.wrapperValue ) : this.value;\n\n\t\t// TODO remove this legacy nonsense\n\t\tvar ractive = this.root.ractive;\n\t\tvar keypath = this.getKeypath();\n\n\t\t// tear previous adaptor down if present\n\t\tif ( this.wrapper ) {\n\t\t\tvar shouldTeardown = this.wrapperValue === value ? false : !this.wrapper.reset || this.wrapper.reset( value ) === false;\n\n\t\t\tif ( shouldTeardown ) {\n\t\t\t\tthis.wrapper.teardown();\n\t\t\t\tthis.wrapper = null;\n\n\t\t\t\t// don't branch for undefined values\n\t\t\t\tif ( this.value !== undefined ) {\n\t\t\t\t\tvar parentValue = this.parent.value || this.parent.createBranch( this.key );\n\t\t\t\t\tif ( parentValue[ this.key ] !== value ) { parentValue[ this.key ] = value; }\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tdelete this.newWrapperValue;\n\t\t\t\tthis.wrapperValue = value;\n\t\t\t\tthis.value = this.wrapper.get();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tvar i;\n\n\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\tvar adaptor = adaptors[i];\n\t\t\tif ( adaptor.filter( value, keypath, ractive ) ) {\n\t\t\t\tthis$1.wrapper = adaptor.wrap( ractive, value, keypath, getPrefixer( keypath ) );\n\t\t\t\tthis$1.wrapperValue = value;\n\t\t\t\tthis$1.wrapper.__model = this$1; // massive temporary hack to enable array adaptor\n\n\t\t\t\tthis$1.value = this$1.wrapper.get();\n\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t};\n\n\tModel.prototype.animate = function animate ( from, to, options, interpolator ) {\n\t\tvar this$1 = this;\n\n\t\tif ( this.ticker ) { this.ticker.stop(); }\n\n\t\tvar fulfilPromise;\n\t\tvar promise = new Promise$1( function (fulfil) { return fulfilPromise = fulfil; } );\n\n\t\tthis.ticker = new Ticker({\n\t\t\tduration: options.duration,\n\t\t\teasing: options.easing,\n\t\t\tstep: function (t) {\n\t\t\t\tvar value = interpolator( t );\n\t\t\t\tthis$1.applyValue( value );\n\t\t\t\tif ( options.step ) { options.step( t, value ); }\n\t\t\t},\n\t\t\tcomplete: function () {\n\t\t\t\tthis$1.applyValue( to );\n\t\t\t\tif ( options.complete ) { options.complete( to ); }\n\n\t\t\t\tthis$1.ticker = null;\n\t\t\t\tfulfilPromise();\n\t\t\t}\n\t\t});\n\n\t\tpromise.stop = this.ticker.stop;\n\t\treturn promise;\n\t};\n\n\tModel.prototype.applyValue = function applyValue ( value ) {\n\t\tif ( isEqual( value, this.value ) ) { return; }\n\t\tif ( this.boundValue ) { this.boundValue = null; }\n\n\t\t// TODO deprecate this nonsense\n\t\tthis.registerChange( this.getKeypath(), value );\n\n\t\tif ( this.parent.wrapper && this.parent.wrapper.set ) {\n\t\t\tthis.parent.wrapper.set( this.key, value );\n\t\t\tthis.parent.value = this.parent.wrapper.get();\n\n\t\t\tthis.value = this.parent.value[ this.key ];\n\t\t\tif ( this.wrapper ) { this.newWrapperValue = this.value; }\n\t\t\tthis.adapt();\n\t\t} else if ( this.wrapper ) {\n\t\t\tthis.newWrapperValue = value;\n\t\t\tthis.adapt();\n\t\t} else {\n\t\t\tvar parentValue = this.parent.value || this.parent.createBranch( this.key );\n\t\t\tif ( isObjectLike( parentValue ) ) {\n\t\t\t\tparentValue[ this.key ] = value;\n\t\t\t} else {\n\t\t\t\twarnIfDebug( (\"Attempted to set a property of a non-object '\" + (this.getKeypath()) + \"'\") );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.value = value;\n\t\t\tthis.adapt();\n\t\t}\n\n\t\tthis.parent.clearUnresolveds();\n\t\tthis.clearUnresolveds();\n\n\t\t// keep track of array length\n\t\tif ( isArray( value ) ) { this.length = value.length; }\n\n\t\t// notify dependants\n\t\tthis.links.forEach( handleChange$1$1 );\n\t\tthis.children.forEach( mark$1$1 );\n\t\tthis.deps.forEach( handleChange$1$1 );\n\n\t\tthis.notifyUpstream();\n\n\t\tif ( this.key === 'length' && isArray( this.parent.value ) ) { this.parent.length = this.parent.value.length; }\n\t};\n\n\tModel.prototype.createBranch = function createBranch ( key ) {\n\t\tvar branch = isNumeric( key ) ? [] : {};\n\t\tthis.set( branch );\n\n\t\treturn branch;\n\t};\n\n\tModel.prototype.get = function get ( shouldCapture, opts ) {\n\t\tif ( this._link ) { return this._link.get( shouldCapture, opts ); }\n\t\tif ( shouldCapture ) { capture( this ); }\n\t\t// if capturing, this value needs to be unwrapped because it's for external use\n\t\tif ( opts && opts.virtual ) { return this.getVirtual( false ); }\n\t\treturn maybeBind( this, ( shouldCapture || ( opts && opts.unwrap ) ) && this.wrapper ? this.wrapperValue : this.value, !opts || opts.shouldBind !== false );\n\t};\n\n\tModel.prototype.getKeypathModel = function getKeypathModel () {\n\t\tif ( !this.keypathModel ) { this.keypathModel = new KeypathModel( this ); }\n\t\treturn this.keypathModel;\n\t};\n\n\tModel.prototype.joinKey = function joinKey ( key, opts ) {\n\t\tif ( this._link ) {\n\t\t\tif ( opts && opts.lastLink !== false && ( key === undefined || key === '' ) ) { return this; }\n\t\t\treturn this._link.joinKey( key );\n\t\t}\n\n\t\tif ( key === undefined || key === '' ) { return this; }\n\n\n\t\tif ( !this.childByKey.hasOwnProperty( key ) ) {\n\t\t\tvar child = new Model( this, key );\n\t\t\tthis.children.push( child );\n\t\t\tthis.childByKey[ key ] = child;\n\t\t}\n\n\t\tif ( this.childByKey[ key ]._link && ( !opts || opts.lastLink !== false ) ) { return this.childByKey[ key ]._link; }\n\t\treturn this.childByKey[ key ];\n\t};\n\n\tModel.prototype.mark = function mark$1 () {\n\t\tif ( this._link ) { return this._link.mark(); }\n\n\t\tvar value = this.retrieve();\n\n\t\tif ( !isEqual( value, this.value ) ) {\n\t\t\tvar old = this.value;\n\t\t\tthis.value = value;\n\t\t\tif ( this.boundValue ) { this.boundValue = null; }\n\n\t\t\t// make sure the wrapper stays in sync\n\t\t\tif ( old !== value || this.rewrap ) {\n\t\t\t\tif ( this.wrapper ) { this.newWrapperValue = value; }\n\t\t\t\tthis.adapt();\n\t\t\t}\n\n\t\t\t// keep track of array lengths\n\t\t\tif ( isArray( value ) ) { this.length = value.length; }\n\n\t\t\tthis.children.forEach( mark$1$1 );\n\t\t\tthis.links.forEach( marked );\n\n\t\t\tthis.deps.forEach( handleChange$1$1 );\n\t\t\tthis.clearUnresolveds();\n\t\t}\n\t};\n\n\tModel.prototype.merge = function merge ( array, comparator ) {\n\t\tvar oldArray = this.value;\n\t\tvar newArray = array;\n\t\tif ( oldArray === newArray ) { oldArray = recreateArray( this ); }\n\t\tif ( comparator ) {\n\t\t\toldArray = oldArray.map( comparator );\n\t\t\tnewArray = newArray.map( comparator );\n\t\t}\n\n\t\tvar oldLength = oldArray.length;\n\n\t\tvar usedIndices = {};\n\t\tvar firstUnusedIndex = 0;\n\n\t\tvar newIndices = oldArray.map( function (item) {\n\t\t\tvar index;\n\t\t\tvar start = firstUnusedIndex;\n\n\t\t\tdo {\n\t\t\t\tindex = newArray.indexOf( item, start );\n\n\t\t\t\tif ( index === -1 ) {\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\n\t\t\t\tstart = index + 1;\n\t\t\t} while ( ( usedIndices[ index ] === true ) && start < oldLength );\n\n\t\t\t// keep track of the first unused index, so we don't search\n\t\t\t// the whole of newArray for each item in oldArray unnecessarily\n\t\t\tif ( index === firstUnusedIndex ) {\n\t\t\t\tfirstUnusedIndex += 1;\n\t\t\t}\n\t\t\t// allow next instance of next \"equal\" to be found item\n\t\t\tusedIndices[ index ] = true;\n\t\t\treturn index;\n\t\t});\n\n\t\tthis.parent.value[ this.key ] = array;\n\t\tthis.shuffle( newIndices );\n\t};\n\n\tModel.prototype.retrieve = function retrieve () {\n\t\treturn this.parent.value ? this.parent.value[ this.key ] : undefined;\n\t};\n\n\tModel.prototype.set = function set ( value ) {\n\t\tif ( this.ticker ) { this.ticker.stop(); }\n\t\tthis.applyValue( value );\n\t};\n\n\tModel.prototype.shuffle = function shuffle$1 ( newIndices ) {\n\t\tshuffle$1$1( this, newIndices, false );\n\t};\n\n\tModel.prototype.source = function source () { return this; };\n\n\tModel.prototype.teardown = function teardown$1 () {\n\t\tif ( this._link ) { this._link.teardown(); }\n\t\tthis.children.forEach( teardown$1$1 );\n\t\tif ( this.wrapper ) { this.wrapper.teardown(); }\n\t\tif ( this.keypathModel ) { this.keypathModel.teardown(); }\n\t};\n\n\treturn Model;\n}(ModelBase));\n\nfunction recreateArray( model ) {\n\tvar array = [];\n\n\tfor ( var i = 0; i < model.length; i++ ) {\n\t\tarray[ i ] = (model.childByKey[i] || {}).value;\n\t}\n\n\treturn array;\n}\n\n/* global global */\nvar data = {};\n\nvar SharedModel = (function (Model$$1) {\n\tfunction SharedModel ( value, name ) {\n\t\tModel$$1.call( this, null, (\"@\" + name) );\n\t\tthis.value = value;\n\t\tthis.isRoot = true;\n\t\tthis.root = this;\n\t\tthis.adaptors = [];\n\t}\n\n\tif ( Model$$1 ) SharedModel.__proto__ = Model$$1;\n\tSharedModel.prototype = Object.create( Model$$1 && Model$$1.prototype );\n\tSharedModel.prototype.constructor = SharedModel;\n\n\tSharedModel.prototype.getKeypath = function getKeypath () {\n\t\treturn this.key;\n\t};\n\n\t// shared model doesn't contribute changes events because it has no instance\n\tSharedModel.prototype.registerChange = function registerChange () {};\n\n\treturn SharedModel;\n}(Model));\n\nvar SharedModel$1 = new SharedModel( data, 'shared' );\n\nvar GlobalModel = new SharedModel( typeof global !== 'undefined' ? global : window, 'global' );\n\nvar keypathExpr = /^@[^\\(]+\\(([^\\)]+)\\)/;\n\nfunction resolveReference ( fragment, ref ) {\n\tvar initialFragment = fragment;\n\t// current context ref\n\tif ( ref === '.' ) { return fragment.findContext(); }\n\n\t// ancestor references\n\tif ( ref[0] === '~' ) { return fragment.ractive.viewmodel.joinAll( splitKeypath( ref.slice( 2 ) ) ); }\n\n\t// scoped references\n\tif ( ref[0] === '.' || ref[0] === '^' ) {\n\t\tvar frag = fragment;\n\t\tvar parts = ref.split( '/' );\n\t\tvar explicitContext = parts[0] === '^^';\n\t\tvar context$1 = explicitContext ? null : fragment.findContext();\n\n\t\t// account for the first context hop\n\t\tif ( explicitContext ) { parts.unshift( '^^' ); }\n\n\t\t// walk up the context chain\n\t\twhile ( parts[0] === '^^' ) {\n\t\t\tparts.shift();\n\t\t\tcontext$1 = null;\n\t\t\twhile ( frag && !context$1 ) {\n\t\t\t\tcontext$1 = frag.context;\n\t\t\t\tfrag = frag.parent.component ? frag.parent.component.parentFragment : frag.parent;\n\t\t\t}\n\t\t}\n\n\t\tif ( !context$1 && explicitContext ) {\n\t\t\tthrow new Error( (\"Invalid context parent reference ('\" + ref + \"'). There is not context at that level.\") );\n\t\t}\n\n\t\t// walk up the context path\n\t\twhile ( parts[0] === '.' || parts[0] === '..' ) {\n\t\t\tvar part = parts.shift();\n\n\t\t\tif ( part === '..' ) {\n\t\t\t\tcontext$1 = context$1.parent;\n\t\t\t}\n\t\t}\n\n\t\tref = parts.join( '/' );\n\n\t\t// special case - `{{.foo}}` means the same as `{{./foo}}`\n\t\tif ( ref[0] === '.' ) { ref = ref.slice( 1 ); }\n\t\treturn context$1.joinAll( splitKeypath( ref ) );\n\t}\n\n\tvar keys = splitKeypath( ref );\n\tif ( !keys.length ) { return; }\n\tvar base = keys.shift();\n\n\t// special refs\n\tif ( base[0] === '@' ) {\n\t\t// shorthand from outside the template\n\t\t// @this referring to local ractive instance\n\t\tif ( base === '@this' || base === '@' ) {\n\t\t\treturn fragment.ractive.viewmodel.getRactiveModel().joinAll( keys );\n\t\t}\n\n\t\t// @index or @key referring to the nearest repeating index or key\n\t\telse if ( base === '@index' || base === '@key' ) {\n\t\t\tif ( keys.length ) { badReference( base ); }\n\t\t\tvar repeater = fragment.findRepeatingFragment();\n\t\t\t// make sure the found fragment is actually an iteration\n\t\t\tif ( !repeater.isIteration ) { return; }\n\t\t\treturn repeater.context.getKeyModel( repeater[ ref[1] === 'i' ? 'index' : 'key' ] );\n\t\t}\n\n\t\t// @global referring to window or global\n\t\telse if ( base === '@global' ) {\n\t\t\treturn GlobalModel.joinAll( keys );\n\t\t}\n\n\t\t// @global referring to window or global\n\t\telse if ( base === '@shared' ) {\n\t\t\treturn SharedModel$1.joinAll( keys );\n\t\t}\n\n\t\t// @keypath or @rootpath, the current keypath string, which may also be used to resolve relative keypaths\n\t\telse if ( base.indexOf( '@keypath' ) === 0 || base.indexOf( '@rootpath' ) === 0 ) {\n\t\t\tvar root = ref[1] === 'r' ? fragment.ractive.root : null;\n\t\t\tvar context$2 = fragment.findContext();\n\n\t\t\t// skip over component roots, which provide no context\n\t\t\twhile ( root && context$2.isRoot && context$2.ractive.component ) {\n\t\t\t\tcontext$2 = context$2.ractive.component.parentFragment.findContext();\n\t\t\t}\n\n\t\t\tvar match = keypathExpr.exec( ref );\n\t\t\tif ( match && match[1] ) {\n\t\t\t\tvar model = resolveReference( fragment, match[1] );\n\t\t\t\tif ( model ) { return model.getKeypathModel( root ); }\n\t\t\t}\n\n\t\t\treturn context$2.getKeypathModel( root );\n\t\t}\n\n\t\t// nope\n\t\telse {\n\t\t\tthrow new Error( (\"Invalid special reference '\" + base + \"'\") );\n\t\t}\n\t}\n\n\tvar context = fragment.findContext();\n\n\t// check immediate context for a match\n\tif ( context.has( base ) ) {\n\t\treturn context.joinKey( base ).joinAll( keys );\n\t}\n\n\t// walk up the fragment hierarchy looking for a matching ref, alias, or key in a context\n\tvar hasContextChain;\n\tvar crossedComponentBoundary;\n\tvar shouldWarn = fragment.ractive.warnAboutAmbiguity;\n\n\twhile ( fragment ) {\n\t\t// repeated fragments\n\t\tif ( fragment.isIteration ) {\n\t\t\tif ( base === fragment.parent.keyRef ) {\n\t\t\t\tif ( keys.length ) { badReference( base ); }\n\t\t\t\treturn fragment.context.getKeyModel( fragment.key );\n\t\t\t}\n\n\t\t\tif ( base === fragment.parent.indexRef ) {\n\t\t\t\tif ( keys.length ) { badReference( base ); }\n\t\t\t\treturn fragment.context.getKeyModel( fragment.index );\n\t\t\t}\n\t\t}\n\n\t\t// alias node or iteration\n\t\tif ( fragment.aliases  && fragment.aliases.hasOwnProperty( base ) ) {\n\t\t\tvar model$1 = fragment.aliases[ base ];\n\n\t\t\tif ( keys.length === 0 ) { return model$1; }\n\t\t\telse if ( typeof model$1.joinAll === 'function' ) {\n\t\t\t\treturn model$1.joinAll( keys );\n\t\t\t}\n\t\t}\n\n\t\t// check fragment context to see if it has the key we need\n\t\tif ( fragment.context ) {\n\t\t\tif ( !fragment.isRoot || fragment.ractive.component ) { hasContextChain = true; }\n\n\t\t\tif ( fragment.context.has( base ) ) {\n\t\t\t\t// this is an implicit mapping\n\t\t\t\tif ( crossedComponentBoundary ) {\n\t\t\t\t\tif ( shouldWarn ) { warnIfDebug( (\"'\" + ref + \"' resolved but is ambiguous and will create a mapping to a parent component.\") ); }\n\t\t\t\t\treturn context.root.createLink( base, fragment.context.joinKey( base ), base, { implicit: true } ).joinAll( keys );\n\t\t\t\t}\n\n\t\t\t\tif ( shouldWarn ) { warnIfDebug( (\"'\" + ref + \"' resolved but is ambiguous.\") ); }\n\t\t\t\treturn fragment.context.joinKey( base ).joinAll( keys );\n\t\t\t}\n\t\t}\n\n\t\tif ( ( fragment.componentParent || ( !fragment.parent && fragment.ractive.component ) ) && !fragment.ractive.isolated ) {\n\t\t\t// ascend through component boundary\n\t\t\tfragment = fragment.componentParent || fragment.ractive.component.parentFragment;\n\t\t\tcrossedComponentBoundary = true;\n\t\t} else {\n\t\t\tfragment = fragment.parent;\n\t\t}\n\t}\n\n\t// if enabled, check the instance for a match\n\tif ( initialFragment.ractive.resolveInstanceMembers ) {\n\t\tvar model$2 = initialFragment.ractive.viewmodel.getRactiveModel();\n\t\tif ( model$2.has( base ) ) {\n\t\t\treturn model$2.joinKey( base ).joinAll( keys );\n\t\t}\n\t}\n\n\tif ( shouldWarn ) {\n\t\twarnIfDebug( (\"'\" + ref + \"' is ambiguous and did not resolve.\") );\n\t}\n\n\t// didn't find anything, so go ahead and create the key on the local model\n\tif ( !hasContextChain ) {\n\t\treturn context.root.joinKey( base ).joinAll( keys );\n\t}\n}\n\nfunction badReference ( key ) {\n\tthrow new Error( (\"An index or key reference (\" + key + \") cannot have child properties\") );\n}\n\nfunction Ractive$get ( keypath, opts ) {\n\tif ( typeof keypath !== 'string' ) { return this.viewmodel.get( true, keypath ); }\n\n\tvar keys = splitKeypath( keypath );\n\tvar key = keys[0];\n\n\tvar model;\n\n\tif ( !this.viewmodel.has( key ) ) {\n\t\t// if this is an inline component, we may need to create\n\t\t// an implicit mapping\n\t\tif ( this.component && !this.isolated ) {\n\t\t\tmodel = resolveReference( this.component.parentFragment, key );\n\n\t\t\tif ( model ) {\n\t\t\t\tthis.viewmodel.map( key, model, { implicit: true } );\n\t\t\t}\n\t\t}\n\t}\n\n\tmodel = this.viewmodel.joinAll( keys );\n\treturn model.get( true, opts );\n}\n\n// This function takes an array, the name of a mutator method, and the\n// arguments to call that mutator method with, and returns an array that\n// maps the old indices to their new indices.\n\n// So if you had something like this...\n//\n//     array = [ 'a', 'b', 'c', 'd' ];\n//     array.push( 'e' );\n//\n// ...you'd get `[ 0, 1, 2, 3 ]` - in other words, none of the old indices\n// have changed. If you then did this...\n//\n//     array.unshift( 'z' );\n//\n// ...the indices would be `[ 1, 2, 3, 4, 5 ]` - every item has been moved\n// one higher to make room for the 'z'. If you removed an item, the new index\n// would be -1...\n//\n//     array.splice( 2, 2 );\n//\n// ...this would result in [ 0, 1, -1, -1, 2, 3 ].\n//\n// This information is used to enable fast, non-destructive shuffling of list\n// sections when you do e.g. `ractive.splice( 'items', 2, 2 );\n\nfunction getNewIndices ( length, methodName, args ) {\n\tvar newIndices = [];\n\n\tvar spliceArguments = getSpliceEquivalent( length, methodName, args );\n\n\tif ( !spliceArguments ) {\n\t\treturn null; // TODO support reverse and sort?\n\t}\n\n\tvar balance = ( spliceArguments.length - 2 ) - spliceArguments[1];\n\n\tvar removeStart = Math.min( length, spliceArguments[0] );\n\tvar removeEnd = removeStart + spliceArguments[1];\n\tnewIndices.startIndex = removeStart;\n\n\tvar i;\n\tfor ( i = 0; i < removeStart; i += 1 ) {\n\t\tnewIndices.push( i );\n\t}\n\n\tfor ( ; i < removeEnd; i += 1 ) {\n\t\tnewIndices.push( -1 );\n\t}\n\n\tfor ( ; i < length; i += 1 ) {\n\t\tnewIndices.push( i + balance );\n\t}\n\n\t// there is a net shift for the rest of the array starting with index + balance\n\tif ( balance !== 0 ) {\n\t\tnewIndices.touchedFrom = spliceArguments[0];\n\t} else {\n\t\tnewIndices.touchedFrom = length;\n\t}\n\n\treturn newIndices;\n}\n\n\n// The pop, push, shift an unshift methods can all be represented\n// as an equivalent splice\nfunction getSpliceEquivalent ( length, methodName, args ) {\n\tswitch ( methodName ) {\n\t\tcase 'splice':\n\t\t\tif ( args[0] !== undefined && args[0] < 0 ) {\n\t\t\t\targs[0] = length + Math.max( args[0], -length );\n\t\t\t}\n\n\t\t\tif ( args[0] === undefined ) { args[0] = 0; }\n\n\t\t\twhile ( args.length < 2 ) {\n\t\t\t\targs.push( length - args[0] );\n\t\t\t}\n\n\t\t\tif ( typeof args[1] !== 'number' ) {\n\t\t\t\targs[1] = length - args[0];\n\t\t\t}\n\n\t\t\t// ensure we only remove elements that exist\n\t\t\targs[1] = Math.min( args[1], length - args[0] );\n\n\t\t\treturn args;\n\n\t\tcase 'sort':\n\t\tcase 'reverse':\n\t\t\treturn null;\n\n\t\tcase 'pop':\n\t\t\tif ( length ) {\n\t\t\t\treturn [ length - 1, 1 ];\n\t\t\t}\n\t\t\treturn [ 0, 0 ];\n\n\t\tcase 'push':\n\t\t\treturn [ length, 0 ].concat( args );\n\n\t\tcase 'shift':\n\t\t\treturn [ 0, length ? 1 : 0 ];\n\n\t\tcase 'unshift':\n\t\t\treturn [ 0, 0 ].concat( args );\n\t}\n}\n\nvar arrayProto = Array.prototype;\n\nvar makeArrayMethod = function ( methodName ) {\n\tfunction path ( keypath ) {\n\t\tvar args = [], len = arguments.length - 1;\n\t\twhile ( len-- > 0 ) args[ len ] = arguments[ len + 1 ];\n\n\t\treturn model( this.viewmodel.joinAll( splitKeypath( keypath ) ), args );\n\t}\n\n\tfunction model ( mdl, args ) {\n\t\tvar array = mdl.get();\n\n\t\tif ( !isArray( array ) ) {\n\t\t\tif ( array === undefined ) {\n\t\t\t\tarray = [];\n\t\t\t\tvar result$1 = arrayProto[ methodName ].apply( array, args );\n\t\t\t\tvar promise$1 = runloop.start( this, true ).then( function () { return result$1; } );\n\t\t\t\tmdl.set( array );\n\t\t\t\trunloop.end();\n\t\t\t\treturn promise$1;\n\t\t\t} else {\n\t\t\t\tthrow new Error( (\"shuffle array method \" + methodName + \" called on non-array at \" + (mdl.getKeypath())) );\n\t\t\t}\n\t\t}\n\n\t\tvar newIndices = getNewIndices( array.length, methodName, args );\n\t\tvar result = arrayProto[ methodName ].apply( array, args );\n\n\t\tvar promise = runloop.start( this, true ).then( function () { return result; } );\n\t\tpromise.result = result;\n\n\t\tif ( newIndices ) {\n\t\t\tmdl.shuffle( newIndices );\n\t\t} else {\n\t\t\tmdl.set( result );\n\t\t}\n\n\t\trunloop.end();\n\n\t\treturn promise;\n\t}\n\n\treturn { path: path, model: model };\n};\n\nvar comparators = {};\n\nfunction getComparator ( option ) {\n\tif ( !option ) { return null; } // use existing arrays\n\tif ( option === true ) { return JSON.stringify; }\n\tif ( typeof option === 'function' ) { return option; }\n\n\tif ( typeof option === 'string' ) {\n\t\treturn comparators[ option ] || ( comparators[ option ] = function (thing) { return thing[ option ]; } );\n\t}\n\n\tthrow new Error( 'If supplied, options.compare must be a string, function, or `true`' ); // TODO link to docs\n}\n\nfunction merge$2 ( ractive, model, array, options ) {\n\tvar promise = runloop.start( ractive, true );\n\tvar value = model.get();\n\tif ( array === undefined ) { array = value; }\n\n\tif ( !isArray( value ) || !isArray( array ) ) {\n\t\tthrow new Error( 'You cannot merge an array with a non-array' );\n\t}\n\n\tvar comparator = getComparator( options && options.compare );\n\tmodel.merge( array, comparator );\n\n\trunloop.end();\n\treturn promise;\n}\n\nfunction thisRactive$merge ( keypath, array, options ) {\n\treturn merge$2( this, this.viewmodel.joinAll( splitKeypath( keypath ) ), array, options );\n}\n\nvar updateHook = new Hook( 'update' );\n\nfunction update$3 ( ractive, model ) {\n\t// if the parent is wrapped, the adaptor will need to be updated before\n\t// updating on this keypath\n\tif ( model.parent && model.parent.wrapper ) {\n\t\tmodel.parent.adapt();\n\t}\n\n\tvar promise = runloop.start( ractive, true );\n\n\tmodel.mark();\n\tmodel.registerChange( model.getKeypath(), model.get() );\n\n\tif ( !model.isRoot ) {\n\t\t// there may be unresolved refs that are now resolvable up the context tree\n\t\tvar parent = model.parent;\n\t\tvar key = model.key;\n\t\twhile ( parent && !parent.isRoot ) {\n\t\t\tif ( parent.clearUnresolveds ) { parent.clearUnresolveds( key ); }\n\t\t\tkey = parent.key;\n\t\t\tparent = parent.parent;\n\t\t}\n\t}\n\n\t// notify upstream of changes\n\tmodel.notifyUpstream();\n\n\trunloop.end();\n\n\tupdateHook.fire( ractive, model );\n\n\treturn promise;\n}\n\nfunction Ractive$update ( keypath ) {\n\tif ( keypath ) { keypath = splitKeypath( keypath ); }\n\n\treturn update$3( this, keypath ? this.viewmodel.joinAll( keypath ) : this.viewmodel );\n}\n\nvar modelPush = makeArrayMethod( 'push' ).model;\nvar modelPop = makeArrayMethod( 'pop' ).model;\nvar modelShift = makeArrayMethod( 'shift' ).model;\nvar modelUnshift = makeArrayMethod( 'unshift' ).model;\nvar modelSort = makeArrayMethod( 'sort' ).model;\nvar modelSplice = makeArrayMethod( 'splice' ).model;\nvar modelReverse = makeArrayMethod( 'reverse' ).model;\n\n// TODO: at some point perhaps this could support relative * keypaths?\nfunction build$1 ( el, keypath, value ) {\n\tvar sets = [];\n\n\t// set multiple keypaths in one go\n\tif ( isObject( keypath ) ) {\n\t\tfor ( var k in keypath ) {\n\t\t\tif ( keypath.hasOwnProperty( k ) ) {\n\t\t\t\tsets.push( [ findModel( el, k ).model, keypath[k] ] );\n\t\t\t}\n\t\t}\n\n\t}\n\t// set a single keypath\n\telse {\n\t\tsets.push( [ findModel( el, keypath ).model, value ] );\n\t}\n\n\treturn sets;\n}\n\n// get relative keypaths and values\nfunction get$1$1 ( keypath ) {\n\tif ( !keypath ) { return this._element.parentFragment.findContext().get( true ); }\n\n\tvar model = resolveReference( this._element.parentFragment, keypath );\n\n\treturn model ? model.get( true ) : undefined;\n}\n\nfunction resolve$2 ( path, ractive ) {\n\tvar ref = findModel( this, path );\n\tvar model = ref.model;\n\tvar instance = ref.instance;\n\treturn model ? model.getKeypath( ractive || instance ) : path;\n}\n\nfunction findModel ( el, path ) {\n\tvar frag = el._element.parentFragment;\n\n\tif ( typeof path !== 'string' ) {\n\t\treturn { model: frag.findContext(), instance: path };\n\t}\n\n\treturn { model: resolveReference( frag, path ), instance: frag.ractive };\n}\n\n// the usual mutation suspects\nfunction add$2 ( keypath, value ) {\n\tif ( value === undefined ) { value = 1; }\n\tif ( !isNumeric( value ) ) { throw new Error( 'Bad arguments' ); }\n\treturn set$1( this.ractive, build$1( this, keypath, value ).map( function (pair) {\n\t\tvar model = pair[0];\n\t\tvar val = pair[1];\n\t\tvar value = model.get();\n\t\tif ( !isNumeric( val ) || !isNumeric( value ) ) { throw new Error( 'Cannot add non-numeric value' ); }\n\t\treturn [ model, value + val ];\n\t}) );\n}\n\nfunction animate$2 ( keypath, value, options ) {\n\tvar model = findModel( this, keypath ).model;\n\treturn animate$1( this.ractive, model, value, options );\n}\n\nfunction link$1 ( source, dest ) {\n\tvar there = findModel( this, source ).model;\n\tvar here = findModel( this, dest ).model;\n\tvar promise = runloop.start( this.ractive, true );\n\there.link( there, source );\n\trunloop.end();\n\treturn promise;\n}\n\nfunction merge$1 ( keypath, array, options ) {\n\treturn merge$2( this.ractive, findModel( this, keypath ).model, array, options );\n}\n\nfunction observe ( keypath, callback, options ) {\n\tif ( options === void 0 ) options = {};\n\n\tif ( isObject( keypath ) ) { options = callback || {}; }\n\toptions.fragment = this._element.parentFragment;\n\treturn this.ractive.observe( keypath, callback, options );\n}\n\nfunction observeOnce ( keypath, callback, options ) {\n\tif ( options === void 0 ) options = {};\n\n\tif ( isObject( keypath ) ) { options = callback || {}; }\n\toptions.fragment = this._element.parentFragment;\n\treturn this.ractive.observeOnce( keypath, callback, options );\n}\n\nfunction pop ( keypath ) {\n\treturn modelPop( findModel( this, keypath ).model, [] );\n}\n\nfunction push ( keypath ) {\n\tvar values = [], len = arguments.length - 1;\n\twhile ( len-- > 0 ) values[ len ] = arguments[ len + 1 ];\n\n\treturn modelPush( findModel( this, keypath ).model, values );\n}\n\nfunction raise ( name, event ) {\n\tvar args = [], len = arguments.length - 2;\n\twhile ( len-- > 0 ) args[ len ] = arguments[ len + 2 ];\n\n\tvar element = this._element;\n\n\twhile ( element ) {\n\t\tvar events = element.events;\n\t\tfor ( var i = 0; i < events.length; i++ ) {\n\t\t\tvar event$1 = events[i];\n\t\t\tif ( ~event$1.template.n.indexOf( name ) ) {\n\t\t\t\tevent$1.fire( event$1, args );\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\telement = element.parent;\n\t}\n}\n\nfunction reverse ( keypath ) {\n\treturn modelReverse( findModel( this, keypath ).model, [] );\n}\n\nfunction set$2 ( keypath, value ) {\n\treturn set$1( this.ractive, build$1( this, keypath, value ) );\n}\n\nfunction shift ( keypath ) {\n\treturn modelShift( findModel( this, keypath ).model, [] );\n}\n\nfunction splice ( keypath, index, drop ) {\n\tvar add = [], len = arguments.length - 3;\n\twhile ( len-- > 0 ) add[ len ] = arguments[ len + 3 ];\n\n\tadd.unshift( index, drop );\n\treturn modelSplice( findModel( this, keypath ).model, add );\n}\n\nfunction sort ( keypath ) {\n\treturn modelSort( findModel( this, keypath ).model, [] );\n}\n\nfunction subtract ( keypath, value ) {\n\tif ( value === undefined ) { value = 1; }\n\tif ( !isNumeric( value ) ) { throw new Error( 'Bad arguments' ); }\n\treturn set$1( this.ractive, build$1( this, keypath, value ).map( function (pair) {\n\t\tvar model = pair[0];\n\t\tvar val = pair[1];\n\t\tvar value = model.get();\n\t\tif ( !isNumeric( val ) || !isNumeric( value ) ) { throw new Error( 'Cannot add non-numeric value' ); }\n\t\treturn [ model, value - val ];\n\t}) );\n}\n\nfunction toggle ( keypath ) {\n\tvar ref = findModel( this, keypath );\n\tvar model = ref.model;\n\treturn set$1( this.ractive, [ [ model, !model.get() ] ] );\n}\n\nfunction unlink$1 ( dest ) {\n\tvar here = findModel( this, dest ).model;\n\tvar promise = runloop.start( this.ractive, true );\n\tif ( here.owner && here.owner._link ) { here.owner.unlink(); }\n\trunloop.end();\n\treturn promise;\n}\n\nfunction unshift ( keypath ) {\n\tvar add = [], len = arguments.length - 1;\n\twhile ( len-- > 0 ) add[ len ] = arguments[ len + 1 ];\n\n\treturn modelUnshift( findModel( this, keypath ).model, add );\n}\n\nfunction update$2 ( keypath ) {\n\treturn update$3( this.ractive, findModel( this, keypath ).model );\n}\n\nfunction updateModel$1 ( keypath, cascade ) {\n\tvar ref = findModel( this, keypath );\n\tvar model = ref.model;\n\tvar promise = runloop.start( this.ractive, true );\n\tmodel.updateFromBindings( cascade );\n\trunloop.end();\n\treturn promise;\n}\n\n// two-way binding related helpers\nfunction isBound () {\n\tvar ref = getBindingModel( this );\n\tvar model = ref.model;\n\treturn !!model;\n}\n\nfunction getBindingPath ( ractive ) {\n\tvar ref = getBindingModel( this );\n\tvar model = ref.model;\n\tvar instance = ref.instance;\n\tif ( model ) { return model.getKeypath( ractive || instance ); }\n}\n\nfunction getBinding () {\n\tvar ref = getBindingModel( this );\n\tvar model = ref.model;\n\tif ( model ) { return model.get( true ); }\n}\n\nfunction getBindingModel ( ctx ) {\n\tvar el = ctx._element;\n\treturn { model: el.binding && el.binding.model, instance: el.parentFragment.ractive };\n}\n\nfunction setBinding ( value ) {\n\tvar ref = getBindingModel( this );\n\tvar model = ref.model;\n\treturn set$1( this.ractive, [ [ model, value ] ] );\n}\n\nfunction addHelpers ( obj, element ) {\n\tdefineProperties( obj, {\n\t\t_element: { value: element },\n\t\tractive: { value: element.parentFragment.ractive },\n\t\tresolve: { value: resolve$2 },\n\t\tget: { value: get$1$1 },\n\n\t\tadd: { value: add$2 },\n\t\tanimate: { value: animate$2 },\n\t\tlink: { value: link$1 },\n\t\tmerge: { value: merge$1 },\n\t\tobserve: { value: observe },\n\t\tobserveOnce: { value: observeOnce },\n\t\tpop: { value: pop },\n\t\tpush: { value: push },\n\t\traise: { value: raise },\n\t\treverse: { value: reverse },\n\t\tset: { value: set$2 },\n\t\tshift: { value: shift },\n\t\tsort: { value: sort },\n\t\tsplice: { value: splice },\n\t\tsubtract: { value: subtract },\n\t\ttoggle: { value: toggle },\n\t\tunlink: { value: unlink$1 },\n\t\tunshift: { value: unshift },\n\t\tupdate: { value: update$2 },\n\t\tupdateModel: { value: updateModel$1 },\n\n\t\tisBound: { value: isBound },\n\t\tgetBindingPath: { value: getBindingPath },\n\t\tgetBinding: { value: getBinding },\n\t\tsetBinding: { value: setBinding },\n\n\t\tdecorators: {\n\t\t\tget: function get$1 () {\n\t\t\t\tvar items = {};\n\t\t\t\telement.decorators.forEach( function (d) { return items[ d.name ] = d.intermediary; } );\n\t\t\t\treturn items;\n\t\t\t}\n\t\t}\n\t});\n\n\treturn obj;\n}\n\nvar query = doc && doc.querySelector;\n\nvar staticInfo = function( node ) {\n\tif ( typeof node === 'string' && query ) {\n\t\tnode = query.call( document, node );\n\t}\n\n\tif ( !node || !node._ractive ) { return {}; }\n\n\tvar storage = node._ractive;\n\n\treturn addHelpers( {}, storage.proxy );\n};\n\nfunction getNodeInfo( node, options ) {\n\tif ( typeof node === 'string' ) {\n\t\tnode = this.find( node, options );\n\t}\n\n\treturn staticInfo( node );\n}\n\nvar insertHook = new Hook( 'insert' );\n\nfunction Ractive$insert ( target, anchor ) {\n\tif ( !this.fragment.rendered ) {\n\t\t// TODO create, and link to, documentation explaining this\n\t\tthrow new Error( 'The API has changed - you must call `ractive.render(target[, anchor])` to render your Ractive instance. Once rendered you can use `ractive.insert()`.' );\n\t}\n\n\ttarget = getElement( target );\n\tanchor = getElement( anchor ) || null;\n\n\tif ( !target ) {\n\t\tthrow new Error( 'You must specify a valid target to insert into' );\n\t}\n\n\ttarget.insertBefore( this.detach(), anchor );\n\tthis.el = target;\n\n\t( target.__ractive_instances__ || ( target.__ractive_instances__ = [] ) ).push( this );\n\tthis.isDetached = false;\n\n\tfireInsertHook( this );\n}\n\nfunction fireInsertHook( ractive ) {\n\tinsertHook.fire( ractive );\n\n\tractive.findAllComponents('*').forEach( function (child) {\n\t\tfireInsertHook( child.instance );\n\t});\n}\n\nfunction link$2( there, here, options ) {\n\tif ( here === there || (there + '.').indexOf( here + '.' ) === 0 || (here + '.').indexOf( there + '.' ) === 0 ) {\n\t\tthrow new Error( 'A keypath cannot be linked to itself.' );\n\t}\n\n\tvar promise = runloop.start();\n\tvar model;\n\tvar target = ( options && options.ractive ) || this;\n\n\t// may need to allow a mapping to resolve implicitly\n\tvar sourcePath = splitKeypath( there );\n\tif ( !target.viewmodel.has( sourcePath[0] ) && target.component ) {\n\t\tmodel = resolveReference( target.component.parentFragment, sourcePath[0] );\n\t\tmodel = model.joinAll( sourcePath.slice( 1 ) );\n\t}\n\n\tthis.viewmodel.joinAll( splitKeypath( here ) ).link( model || target.viewmodel.joinAll( sourcePath ), there );\n\n\trunloop.end();\n\n\treturn promise;\n}\n\nfunction observe$1 ( keypath, callback, options ) {\n\tvar this$1 = this;\n\n\tvar observers = [];\n\tvar map;\n\n\tif ( isObject( keypath ) ) {\n\t\tmap = keypath;\n\t\toptions = callback || {};\n\t} else {\n\t\tif ( typeof keypath === 'function' ) {\n\t\t\tmap = { '': keypath };\n\t\t\toptions = callback;\n\t\t} else {\n\t\t\tmap = {};\n\t\t\tmap[ keypath ] = callback;\n\t\t}\n\t}\n\n\tObject.keys( map ).forEach( function (keypath) {\n\t\tvar callback = map[ keypath ];\n\n\t\tvar keypaths = keypath.split( ' ' );\n\t\tif ( keypaths.length > 1 ) { keypaths = keypaths.filter( function (k) { return k; } ); }\n\n\t\tkeypaths.forEach( function (keypath) {\n\t\t\tobservers.push( createObserver( this$1, keypath, callback, options || {} ) );\n\t\t});\n\t});\n\n\t// add observers to the Ractive instance, so they can be\n\t// cancelled on ractive.teardown()\n\tthis._observers.push.apply( this._observers, observers );\n\n\treturn {\n\t\tcancel: function () {\n\t\t\tobservers.forEach( function ( observer ) {\n\t\t\t\tremoveFromArray ( this$1._observers, observer );\n\t\t\t\tobserver.cancel();\n\t\t\t} );\n\t\t}\n\t};\n}\n\nfunction createObserver ( ractive, keypath, callback, options ) {\n\tvar keys = splitKeypath( keypath );\n\tvar wildcardIndex = keys.indexOf( '*' );\n\toptions.keypath = keypath;\n\toptions.fragment = options.fragment || ractive.fragment;\n\n\tvar model;\n\tif ( !options.fragment ) {\n\t\tmodel = ractive.viewmodel.joinKey( keys[0] );\n\t} else {\n\t\t// .*.whatever relative wildcard is a special case because splitkeypath doesn't handle the leading .\n\t\tif ( keys[0] === '.*' ) {\n\t\t\tmodel = options.fragment.findContext();\n\t\t\twildcardIndex = 0;\n\t\t\tkeys[0] = '*';\n\t\t} else {\n\t\t\tmodel = wildcardIndex === 0 ? options.fragment.findContext() : resolveReference( options.fragment, keys[0] );\n\t\t}\n\t}\n\n\t// the model may not exist key\n\tif ( !model ) { model = ractive.viewmodel.joinKey( keys[0] ); }\n\n\tif ( !~wildcardIndex ) {\n\t\tmodel = model.joinAll( keys.slice( 1 ) );\n\t\treturn new Observer( ractive, model, callback, options );\n\t} else {\n\t\tmodel = model.joinAll( keys.slice( 1, wildcardIndex ) );\n\t\treturn new PatternObserver( ractive, model, keys.slice( wildcardIndex ), callback, options );\n\t}\n}\n\nvar Observer = function Observer ( ractive, model, callback, options ) {\n\tthis.context = options.context || ractive;\n\tthis.callback = callback;\n\tthis.ractive = ractive;\n\n\tif ( model ) { this.resolved( model ); }\n\n\tif ( options.init !== false ) {\n\t\tthis.dirty = true;\n\t\tthis.dispatch();\n\t} else {\n\t\tthis.oldValue = this.newValue;\n\t}\n\n\tthis.defer = options.defer;\n\tthis.once = options.once;\n\tthis.strict = options.strict;\n\n\tthis.dirty = false;\n};\n\nObserver.prototype.cancel = function cancel () {\n\tthis.cancelled = true;\n\tif ( this.model ) {\n\t\tthis.model.unregister( this );\n\t} else {\n\t\tthis.resolver.unbind();\n\t}\n};\n\nObserver.prototype.dispatch = function dispatch () {\n\tif ( !this.cancelled ) {\n\t\tthis.callback.call( this.context, this.newValue, this.oldValue, this.keypath );\n\t\tthis.oldValue = this.model ? this.model.get() : this.newValue;\n\t\tthis.dirty = false;\n\t}\n};\n\nObserver.prototype.handleChange = function handleChange () {\n\t\tvar this$1 = this;\n\n\tif ( !this.dirty ) {\n\t\tvar newValue = this.model.get();\n\t\tif ( isEqual( newValue, this.oldValue ) ) { return; }\n\n\t\tthis.newValue = newValue;\n\n\t\tif ( this.strict && this.newValue === this.oldValue ) { return; }\n\n\t\trunloop.addObserver( this, this.defer );\n\t\tthis.dirty = true;\n\n\t\tif ( this.once ) { runloop.scheduleTask( function () { return this$1.cancel(); } ); }\n\t}\n};\n\nObserver.prototype.rebinding = function rebinding ( next, previous ) {\n\t\tvar this$1 = this;\n\n\tnext = rebindMatch( this.keypath, next, previous );\n\t// TODO: set up a resolver if next is undefined?\n\tif ( next === this.model ) { return false; }\n\n\tif ( this.model ) { this.model.unregister( this ); }\n\tif ( next ) { next.addShuffleTask( function () { return this$1.resolved( next ); } ); }\n};\n\nObserver.prototype.resolved = function resolved ( model ) {\n\tthis.model = model;\n\tthis.keypath = model.getKeypath( this.ractive );\n\n\tthis.oldValue = undefined;\n\tthis.newValue = model.get();\n\n\tmodel.register( this );\n};\n\nvar PatternObserver = function PatternObserver ( ractive, baseModel, keys, callback, options ) {\n\tvar this$1 = this;\n\n\tthis.context = options.context || ractive;\n\tthis.ractive = ractive;\n\tthis.baseModel = baseModel;\n\tthis.keys = keys;\n\tthis.callback = callback;\n\n\tvar pattern = keys.join( '\\\\.' ).replace( /\\*/g, '(.+)' );\n\tvar baseKeypath = baseModel.getKeypath( ractive );\n\tthis.pattern = new RegExp( (\"^\" + (baseKeypath ? baseKeypath + '\\\\.' : '') + pattern + \"$\") );\n\n\tthis.oldValues = {};\n\tthis.newValues = {};\n\n\tthis.defer = options.defer;\n\tthis.once = options.once;\n\tthis.strict = options.strict;\n\n\tthis.dirty = false;\n\tthis.changed = [];\n\tthis.partial = false;\n\n\tvar models = baseModel.findMatches( this.keys );\n\n\tmodels.forEach( function (model) {\n\t\tthis$1.newValues[ model.getKeypath( this$1.ractive ) ] = model.get();\n\t});\n\n\tif ( options.init !== false ) {\n\t\tthis.dispatch();\n\t} else {\n\t\tthis.oldValues = this.newValues;\n\t}\n\n\tbaseModel.registerPatternObserver( this );\n};\n\nPatternObserver.prototype.cancel = function cancel () {\n\tthis.baseModel.unregisterPatternObserver( this );\n};\n\nPatternObserver.prototype.dispatch = function dispatch () {\n\t\tvar this$1 = this;\n\n\tObject.keys( this.newValues ).forEach( function (keypath) {\n\t\tif ( this$1.newKeys && !this$1.newKeys[ keypath ] ) { return; }\n\n\t\tvar newValue = this$1.newValues[ keypath ];\n\t\tvar oldValue = this$1.oldValues[ keypath ];\n\n\t\tif ( this$1.strict && newValue === oldValue ) { return; }\n\t\tif ( isEqual( newValue, oldValue ) ) { return; }\n\n\t\tvar args = [ newValue, oldValue, keypath ];\n\t\tif ( keypath ) {\n\t\t\tvar wildcards = this$1.pattern.exec( keypath );\n\t\t\tif ( wildcards ) {\n\t\t\t\targs = args.concat( wildcards.slice( 1 ) );\n\t\t\t}\n\t\t}\n\n\t\tthis$1.callback.apply( this$1.context, args );\n\t});\n\n\tif ( this.partial ) {\n\t\tfor ( var k in this.newValues ) {\n\t\t\tthis$1.oldValues[k] = this$1.newValues[k];\n\t\t}\n\t} else {\n\t\tthis.oldValues = this.newValues;\n\t}\n\n\tthis.newKeys = null;\n\tthis.dirty = false;\n};\n\nPatternObserver.prototype.notify = function notify ( key ) {\n\tthis.changed.push( key );\n};\n\nPatternObserver.prototype.shuffle = function shuffle ( newIndices ) {\n\t\tvar this$1 = this;\n\n\tif ( !isArray( this.baseModel.value ) ) { return; }\n\n\tvar base = this.baseModel.getKeypath( this.ractive );\n\tvar max = this.baseModel.value.length;\n\tvar suffix = this.keys.length > 1 ? '.' + this.keys.slice( 1 ).join( '.' ) : '';\n\n\tthis.newKeys = {};\n\tfor ( var i = 0; i < newIndices.length; i++ ) {\n\t\tif ( newIndices[ i ] === -1 || newIndices[ i ] === i ) { continue; }\n\t\tthis$1.newKeys[ (base + \".\" + i + suffix) ] = true;\n\t}\n\n\tfor ( var i$1 = newIndices.touchedFrom; i$1 < max; i$1++ ) {\n\t\tthis$1.newKeys[ (base + \".\" + i$1 + suffix) ] = true;\n\t}\n};\n\nPatternObserver.prototype.handleChange = function handleChange () {\n\t\tvar this$1 = this;\n\n\tif ( !this.dirty || this.changed.length ) {\n\t\tif ( !this.dirty ) { this.newValues = {}; }\n\n\t\t// handle case where previously extant keypath no longer exists -\n\t\t// observer should still fire, with undefined as new value\n\t\t// TODO huh. according to the test suite that's not the case...\n\t\t// NOTE: I don't think this will work with partial updates\n\t\t// Object.keys( this.oldValues ).forEach( keypath => {\n\t\t// this.newValues[ keypath ] = undefined;\n\t\t// });\n\n\t\tif ( !this.changed.length ) {\n\t\t\tthis.baseModel.findMatches( this.keys ).forEach( function (model) {\n\t\t\t\tvar keypath = model.getKeypath( this$1.ractive );\n\t\t\t\tthis$1.newValues[ keypath ] = model.get();\n\t\t\t});\n\t\t\tthis.partial = false;\n\t\t} else {\n\t\t\tvar count = 0;\n\t\t\tvar ok = this.baseModel.isRoot ?\n\t\t\t\tthis.changed.map( function (keys) { return keys.map( escapeKey ).join( '.' ); } ) :\n\t\t\t\tthis.changed.map( function (keys) { return this$1.baseModel.getKeypath( this$1.ractive ) + '.' + keys.map( escapeKey ).join( '.' ); } );\n\n\t\t\tthis.baseModel.findMatches( this.keys ).forEach( function (model) {\n\t\t\t\tvar keypath = model.getKeypath( this$1.ractive );\n\t\t\t\t// is this model on a changed keypath?\n\t\t\t\tif ( ok.filter( function (k) { return keypath.indexOf( k ) === 0 || k.indexOf( keypath ) === 0; } ).length ) {\n\t\t\t\t\tcount++;\n\t\t\t\t\tthis$1.newValues[ keypath ] = model.get();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// no valid change triggered, so bail to avoid breakage\n\t\t\tif ( !count ) { return; }\n\n\t\t\tthis.partial = true;\n\t\t}\n\n\t\trunloop.addObserver( this, this.defer );\n\t\tthis.dirty = true;\n\t\tthis.changed.length = 0;\n\n\t\tif ( this.once ) { this.cancel(); }\n\t}\n};\n\nfunction observeList ( keypath, callback, options ) {\n\tif ( typeof keypath !== 'string' ) {\n\t\tthrow new Error( 'ractive.observeList() must be passed a string as its first argument' );\n\t}\n\n\tvar model = this.viewmodel.joinAll( splitKeypath( keypath ) );\n\tvar observer = new ListObserver( this, model, callback, options || {} );\n\n\t// add observer to the Ractive instance, so it can be\n\t// cancelled on ractive.teardown()\n\tthis._observers.push( observer );\n\n\treturn {\n\t\tcancel: function cancel () {\n\t\t\tobserver.cancel();\n\t\t}\n\t};\n}\n\nfunction negativeOne () {\n\treturn -1;\n}\n\nvar ListObserver = function ListObserver ( context, model, callback, options ) {\n\tthis.context = context;\n\tthis.model = model;\n\tthis.keypath = model.getKeypath();\n\tthis.callback = callback;\n\n\tthis.pending = null;\n\n\tmodel.register( this );\n\n\tif ( options.init !== false ) {\n\t\tthis.sliced = [];\n\t\tthis.shuffle([]);\n\t\tthis.handleChange();\n\t} else {\n\t\tthis.sliced = this.slice();\n\t}\n};\n\nListObserver.prototype.handleChange = function handleChange () {\n\tif ( this.pending ) {\n\t\t// post-shuffle\n\t\tthis.callback( this.pending );\n\t\tthis.pending = null;\n\t}\n\n\telse {\n\t\t// entire array changed\n\t\tthis.shuffle( this.sliced.map( negativeOne ) );\n\t\tthis.handleChange();\n\t}\n};\n\nListObserver.prototype.shuffle = function shuffle ( newIndices ) {\n\t\tvar this$1 = this;\n\n\tvar newValue = this.slice();\n\n\tvar inserted = [];\n\tvar deleted = [];\n\tvar start;\n\n\tvar hadIndex = {};\n\n\tnewIndices.forEach( function ( newIndex, oldIndex ) {\n\t\thadIndex[ newIndex ] = true;\n\n\t\tif ( newIndex !== oldIndex && start === undefined ) {\n\t\t\tstart = oldIndex;\n\t\t}\n\n\t\tif ( newIndex === -1 ) {\n\t\t\tdeleted.push( this$1.sliced[ oldIndex ] );\n\t\t}\n\t});\n\n\tif ( start === undefined ) { start = newIndices.length; }\n\n\tvar len = newValue.length;\n\tfor ( var i = 0; i < len; i += 1 ) {\n\t\tif ( !hadIndex[i] ) { inserted.push( newValue[i] ); }\n\t}\n\n\tthis.pending = { inserted: inserted, deleted: deleted, start: start };\n\tthis.sliced = newValue;\n};\n\nListObserver.prototype.slice = function slice () {\n\tvar value = this.model.get();\n\treturn isArray( value ) ? value.slice() : [];\n};\n\nvar onceOptions = { init: false, once: true };\n\nfunction observeOnce$1 ( keypath, callback, options ) {\n\tif ( isObject( keypath ) || typeof keypath === 'function' ) {\n\t\toptions = extend$1( callback || {}, onceOptions );\n\t\treturn this.observe( keypath, options );\n\t}\n\n\toptions = extend$1( options || {}, onceOptions );\n\treturn this.observe( keypath, callback, options );\n}\n\nvar trim = function (str) { return str.trim(); };\n\nvar notEmptyString = function (str) { return str !== ''; };\n\nfunction Ractive$off ( eventName, callback ) {\n\tvar this$1 = this;\n\n\t// if no arguments specified, remove all callbacks\n\tif ( !eventName ) {\n\t\t// TODO use this code instead, once the following issue has been resolved\n\t\t// in PhantomJS (tests are unpassable otherwise!)\n\t\t// https://github.com/ariya/phantomjs/issues/11856\n\t\t// defineProperty( this, '_subs', { value: create( null ), configurable: true });\n\t\tfor ( eventName in this._subs ) {\n\t\t\tdelete this$1._subs[ eventName ];\n\t\t}\n\t}\n\n\telse {\n\t\t// Handle multiple space-separated event names\n\t\tvar eventNames = eventName.split( ' ' ).map( trim ).filter( notEmptyString );\n\n\t\teventNames.forEach( function (eventName) {\n\t\t\tvar subscribers = this$1._subs[ eventName ];\n\n\t\t\t// If we have subscribers for this event...\n\t\t\tif ( subscribers ) {\n\t\t\t\t// ...if a callback was specified, only remove that\n\t\t\t\tif ( callback ) {\n\t\t\t\t\t// flag this callback as off so that any in-flight firings don't call\n\t\t\t\t\t// a cancelled handler - this is _slightly_ hacky\n\t\t\t\t\tcallback.off = true;\n\t\t\t\t\tvar index = subscribers.indexOf( callback );\n\t\t\t\t\tif ( index !== -1 ) {\n\t\t\t\t\t\tsubscribers.splice( index, 1 );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// ...otherwise remove all callbacks\n\t\t\t\telse {\n\t\t\t\t\tthis$1._subs[ eventName ] = [];\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\treturn this;\n}\n\nfunction Ractive$on ( eventName, callback ) {\n\tvar this$1 = this;\n\n\t// allow multiple listeners to be bound in one go\n\tif ( typeof eventName === 'object' ) {\n\t\tvar listeners = [];\n\t\tvar n;\n\n\t\tfor ( n in eventName ) {\n\t\t\tif ( eventName.hasOwnProperty( n ) ) {\n\t\t\t\tlisteners.push( this$1.on( n, eventName[ n ] ) );\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tcancel: function cancel () {\n\t\t\t\tvar listener;\n\t\t\t\twhile ( listener = listeners.pop() ) { listener.cancel(); }\n\t\t\t}\n\t\t};\n\t}\n\n\t// Handle multiple space-separated event names\n\tvar eventNames = eventName.split( ' ' ).map( trim ).filter( notEmptyString );\n\n\teventNames.forEach( function (eventName) {\n\t\t( this$1._subs[ eventName ] || ( this$1._subs[ eventName ] = [] ) ).push( callback );\n\t});\n\n\treturn {\n\t\tcancel: function () { return this$1.off( eventName, callback ); }\n\t};\n}\n\nfunction Ractive$once ( eventName, handler ) {\n\tvar listener = this.on( eventName, function () {\n\t\thandler.apply( this, arguments );\n\t\tlistener.cancel();\n\t});\n\n\t// so we can still do listener.cancel() manually\n\treturn listener;\n}\n\nvar pop$1 = makeArrayMethod( 'pop' ).path;\n\nvar push$1 = makeArrayMethod( 'push' ).path;\n\nvar PREFIX = '/* Ractive.js component styles */';\n\n// Holds current definitions of styles.\nvar styleDefinitions = [];\n\n// Flag to tell if we need to update the CSS\nvar isDirty = false;\n\n// These only make sense on the browser. See additional setup below.\nvar styleElement = null;\nvar useCssText = null;\n\nfunction addCSS( styleDefinition ) {\n\tstyleDefinitions.push( styleDefinition );\n\tisDirty = true;\n}\n\nfunction applyCSS() {\n\n\t// Apply only seems to make sense when we're in the DOM. Server-side renders\n\t// can call toCSS to get the updated CSS.\n\tif ( !doc || !isDirty ) { return; }\n\n\tif ( useCssText ) {\n\t\tstyleElement.styleSheet.cssText = getCSS( null );\n\t} else {\n\t\tstyleElement.innerHTML = getCSS( null );\n\t}\n\n\tisDirty = false;\n}\n\nfunction getCSS( cssIds ) {\n\n\tvar filteredStyleDefinitions = cssIds ? styleDefinitions.filter( function (style) { return ~cssIds.indexOf( style.id ); } ) : styleDefinitions;\n\n\treturn filteredStyleDefinitions.reduce( function ( styles, style ) { return (styles + \"\\n\\n/* {\" + (style.id) + \"} */\\n\" + (style.styles)); }, PREFIX );\n\n}\n\n// If we're on the browser, additional setup needed.\nif ( doc && ( !styleElement || !styleElement.parentNode ) ) {\n\n\tstyleElement = doc.createElement( 'style' );\n\tstyleElement.type = 'text/css';\n\n\tdoc.getElementsByTagName( 'head' )[ 0 ].appendChild( styleElement );\n\n\tuseCssText = !!styleElement.styleSheet;\n}\n\nvar adaptConfigurator = {\n\textend: function ( Parent, proto, options ) {\n\t\tproto.adapt = combine( proto.adapt, ensureArray( options.adapt ) );\n\t},\n\n\tinit: function init () {}\n};\n\nfunction combine ( a, b ) {\n\tvar c = a.slice();\n\tvar i = b.length;\n\n\twhile ( i-- ) {\n\t\tif ( !~c.indexOf( b[i] ) ) {\n\t\t\tc.push( b[i] );\n\t\t}\n\t}\n\n\treturn c;\n}\n\nvar selectorsPattern = /(?:^|\\})?\\s*([^\\{\\}]+)\\s*\\{/g;\nvar commentsPattern = /\\/\\*[\\s\\S]*?\\*\\//g;\nvar selectorUnitPattern = /((?:(?:\\[[^\\]+]\\])|(?:[^\\s\\+\\>~:]))+)((?:::?[^\\s\\+\\>\\~\\(:]+(?:\\([^\\)]+\\))?)*\\s*[\\s\\+\\>\\~]?)\\s*/g;\nvar excludePattern = /^(?:@|\\d+%)/;\nvar dataRvcGuidPattern = /\\[data-ractive-css~=\"\\{[a-z0-9-]+\\}\"]/g;\n\nfunction trim$1 ( str ) {\n\treturn str.trim();\n}\n\nfunction extractString ( unit ) {\n\treturn unit.str;\n}\n\nfunction transformSelector ( selector, parent ) {\n\tvar selectorUnits = [];\n\tvar match;\n\n\twhile ( match = selectorUnitPattern.exec( selector ) ) {\n\t\tselectorUnits.push({\n\t\t\tstr: match[0],\n\t\t\tbase: match[1],\n\t\t\tmodifiers: match[2]\n\t\t});\n\t}\n\n\t// For each simple selector within the selector, we need to create a version\n\t// that a) combines with the id, and b) is inside the id\n\tvar base = selectorUnits.map( extractString );\n\n\tvar transformed = [];\n\tvar i = selectorUnits.length;\n\n\twhile ( i-- ) {\n\t\tvar appended = base.slice();\n\n\t\t// Pseudo-selectors should go after the attribute selector\n\t\tvar unit = selectorUnits[i];\n\t\tappended[i] = unit.base + parent + unit.modifiers || '';\n\n\t\tvar prepended = base.slice();\n\t\tprepended[i] = parent + ' ' + prepended[i];\n\n\t\ttransformed.push( appended.join( ' ' ), prepended.join( ' ' ) );\n\t}\n\n\treturn transformed.join( ', ' );\n}\n\nfunction transformCss ( css, id ) {\n\tvar dataAttr = \"[data-ractive-css~=\\\"{\" + id + \"}\\\"]\";\n\n\tvar transformed;\n\n\tif ( dataRvcGuidPattern.test( css ) ) {\n\t\ttransformed = css.replace( dataRvcGuidPattern, dataAttr );\n\t} else {\n\t\ttransformed = css\n\t\t.replace( commentsPattern, '' )\n\t\t.replace( selectorsPattern, function ( match, $1 ) {\n\t\t\t// don't transform at-rules and keyframe declarations\n\t\t\tif ( excludePattern.test( $1 ) ) { return match; }\n\n\t\t\tvar selectors = $1.split( ',' ).map( trim$1 );\n\t\t\tvar transformed = selectors\n\t\t\t\t.map( function (selector) { return transformSelector( selector, dataAttr ); } )\n\t\t\t\t.join( ', ' ) + ' ';\n\n\t\t\treturn match.replace( $1, transformed );\n\t\t});\n\t}\n\n\treturn transformed;\n}\n\nfunction s4() {\n\treturn Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1);\n}\n\nfunction uuid() {\n\treturn s4() + s4() + '-' + s4() + '-' + s4() + '-' + s4() + '-' + s4() + s4() + s4();\n}\n\nvar cssConfigurator = {\n\tname: 'css',\n\n\t// Called when creating a new component definition\n\textend: function ( Parent, proto, options ) {\n\t\tif ( !options.css ) { return; }\n\n\t\tvar id = uuid();\n\t\tvar styles = options.noCssTransform ? options.css : transformCss( options.css, id );\n\n\t\tproto.cssId = id;\n\n\t\taddCSS( { id: id, styles: styles } );\n\n\t},\n\n\t// Called when creating a new component instance\n\tinit: function ( Parent, target, options ) {\n\t\tif ( !options.css ) { return; }\n\n\t\twarnIfDebug( \"\\nThe css option is currently not supported on a per-instance basis and will be discarded. Instead, we recommend instantiating from a component definition with a css option.\\n\\nconst Component = Ractive.extend({\\n\\t...\\n\\tcss: '/* your css */',\\n\\t...\\n});\\n\\nconst componentInstance = new Component({ ... })\\n\\t\\t\" );\n\t}\n\n};\n\nfunction validate ( data ) {\n\t// Warn if userOptions.data is a non-POJO\n\tif ( data && data.constructor !== Object ) {\n\t\tif ( typeof data === 'function' ) {\n\t\t\t// TODO do we need to support this in the new Ractive() case?\n\t\t} else if ( typeof data !== 'object' ) {\n\t\t\tfatal( (\"data option must be an object or a function, `\" + data + \"` is not valid\") );\n\t\t} else {\n\t\t\twarnIfDebug( 'If supplied, options.data should be a plain JavaScript object - using a non-POJO as the root object may work, but is discouraged' );\n\t\t}\n\t}\n}\n\nvar dataConfigurator = {\n\tname: 'data',\n\n\textend: function ( Parent, proto, options ) {\n\t\tvar key;\n\t\tvar value;\n\n\t\t// check for non-primitives, which could cause mutation-related bugs\n\t\tif ( options.data && isObject( options.data ) ) {\n\t\t\tfor ( key in options.data ) {\n\t\t\t\tvalue = options.data[ key ];\n\n\t\t\t\tif ( value && typeof value === 'object' ) {\n\t\t\t\t\tif ( isObject( value ) || isArray( value ) ) {\n\t\t\t\t\t\twarnIfDebug( \"Passing a `data` option with object and array properties to Ractive.extend() is discouraged, as mutating them is likely to cause bugs. Consider using a data function instead:\\n\\n  // this...\\n  data: function () {\\n    return {\\n      myObject: {}\\n    };\\n  })\\n\\n  // instead of this:\\n  data: {\\n    myObject: {}\\n  }\" );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tproto.data = combine$1( proto.data, options.data );\n\t},\n\n\tinit: function ( Parent, ractive, options ) {\n\t\tvar result = combine$1( Parent.prototype.data, options.data );\n\n\t\tif ( typeof result === 'function' ) { result = result.call( ractive ); }\n\n\t\t// bind functions to the ractive instance at the top level,\n\t\t// unless it's a non-POJO (in which case alarm bells should ring)\n\t\tif ( result && result.constructor === Object ) {\n\t\t\tfor ( var prop in result ) {\n\t\t\t\tif ( typeof result[ prop ] === 'function' ) {\n\t\t\t\t\tvar value = result[ prop ];\n\t\t\t\t\tresult[ prop ] = bind$2( value, ractive );\n\t\t\t\t\tresult[ prop ]._r_unbound = value;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn result || {};\n\t},\n\n\treset: function reset ( ractive ) {\n\t\tvar result = this.init( ractive.constructor, ractive, ractive.viewmodel );\n\t\tractive.viewmodel.root.set( result );\n\t\treturn true;\n\t}\n};\n\nfunction combine$1 ( parentValue, childValue ) {\n\tvalidate( childValue );\n\n\tvar parentIsFn = typeof parentValue === 'function';\n\tvar childIsFn = typeof childValue === 'function';\n\n\t// Very important, otherwise child instance can become\n\t// the default data object on Ractive or a component.\n\t// then ractive.set() ends up setting on the prototype!\n\tif ( !childValue && !parentIsFn ) {\n\t\tchildValue = {};\n\t}\n\n\t// Fast path, where we just need to copy properties from\n\t// parent to child\n\tif ( !parentIsFn && !childIsFn ) {\n\t\treturn fromProperties( childValue, parentValue );\n\t}\n\n\treturn function () {\n\t\tvar child = childIsFn ? callDataFunction( childValue, this ) : childValue;\n\t\tvar parent = parentIsFn ? callDataFunction( parentValue, this ) : parentValue;\n\n\t\treturn fromProperties( child, parent );\n\t};\n}\n\nfunction callDataFunction ( fn, context ) {\n\tvar data = fn.call( context );\n\n\tif ( !data ) { return; }\n\n\tif ( typeof data !== 'object' ) {\n\t\tfatal( 'Data function must return an object' );\n\t}\n\n\tif ( data.constructor !== Object ) {\n\t\twarnOnceIfDebug( 'Data function returned something other than a plain JavaScript object. This might work, but is strongly discouraged' );\n\t}\n\n\treturn data;\n}\n\nfunction fromProperties ( primary, secondary ) {\n\tif ( primary && secondary ) {\n\t\tfor ( var key in secondary ) {\n\t\t\tif ( !( key in primary ) ) {\n\t\t\t\tprimary[ key ] = secondary[ key ];\n\t\t\t}\n\t\t}\n\n\t\treturn primary;\n\t}\n\n\treturn primary || secondary;\n}\n\nvar TEMPLATE_VERSION = 4;\n\nvar pattern = /\\$\\{([^\\}]+)\\}/g;\n\nfunction fromExpression ( body, length ) {\n\tif ( length === void 0 ) length = 0;\n\n\tvar args = new Array( length );\n\n\twhile ( length-- ) {\n\t\targs[length] = \"_\" + length;\n\t}\n\n\t// Functions created directly with new Function() look like this:\n\t//     function anonymous (_0 /**/) { return _0*2 }\n\t//\n\t// With this workaround, we get a little more compact:\n\t//     function (_0){return _0*2}\n\treturn new Function( [], (\"return function (\" + (args.join(',')) + \"){return(\" + body + \");};\") )();\n}\n\nfunction fromComputationString ( str, bindTo ) {\n\tvar hasThis;\n\n\tvar functionBody = 'return (' + str.replace( pattern, function ( match, keypath ) {\n\t\thasThis = true;\n\t\treturn (\"__ractive.get(\\\"\" + keypath + \"\\\")\");\n\t}) + ');';\n\n\tif ( hasThis ) { functionBody = \"var __ractive = this; \" + functionBody; }\n\tvar fn = new Function( functionBody );\n\treturn hasThis ? fn.bind( bindTo ) : fn;\n}\n\nvar functions = create( null );\n\nfunction getFunction ( str, i ) {\n\tif ( functions[ str ] ) { return functions[ str ]; }\n\treturn functions[ str ] = createFunction( str, i );\n}\n\nfunction addFunctions( template ) {\n\tif ( !template ) { return; }\n\n\tvar exp = template.e;\n\n\tif ( !exp ) { return; }\n\n\tObject.keys( exp ).forEach( function ( str ) {\n\t\tif ( functions[ str ] ) { return; }\n\t\tfunctions[ str ] = exp[ str ];\n\t});\n}\n\nvar parse$1$1 = null;\n\nvar parseOptions = [\n\t'delimiters',\n\t'tripleDelimiters',\n\t'staticDelimiters',\n\t'staticTripleDelimiters',\n\t'csp',\n\t'interpolate',\n\t'preserveWhitespace',\n\t'sanitize',\n\t'stripComments',\n\t'contextLines'\n];\n\nvar TEMPLATE_INSTRUCTIONS = \"Either preparse or use a ractive runtime source that includes the parser. \";\n\nvar COMPUTATION_INSTRUCTIONS = \"Either use:\\n\\n\\tRactive.parse.computedStrings( component.computed )\\n\\nat build time to pre-convert the strings to functions, or use functions instead of strings in computed properties.\";\n\n\nfunction throwNoParse ( method, error, instructions ) {\n\tif ( !method ) {\n\t\tfatal( (\"Missing Ractive.parse - cannot parse \" + error + \". \" + instructions) );\n\t}\n}\n\nfunction createFunction ( body, length ) {\n\tthrowNoParse( fromExpression, 'new expression function', TEMPLATE_INSTRUCTIONS );\n\treturn fromExpression( body, length );\n}\n\nfunction createFunctionFromString ( str, bindTo ) {\n\tthrowNoParse( fromComputationString, 'compution string \"${str}\"', COMPUTATION_INSTRUCTIONS );\n\treturn fromComputationString( str, bindTo );\n}\n\nvar parser = {\n\n\tfromId: function fromId ( id, options ) {\n\t\tif ( !doc ) {\n\t\t\tif ( options && options.noThrow ) { return; }\n\t\t\tthrow new Error( (\"Cannot retrieve template #\" + id + \" as Ractive is not running in a browser.\") );\n\t\t}\n\n\t\tif ( id ) { id = id.replace( /^#/, '' ); }\n\n\t\tvar template;\n\n\t\tif ( !( template = doc.getElementById( id ) )) {\n\t\t\tif ( options && options.noThrow ) { return; }\n\t\t\tthrow new Error( (\"Could not find template element with id #\" + id) );\n\t\t}\n\n\t\tif ( template.tagName.toUpperCase() !== 'SCRIPT' ) {\n\t\t\tif ( options && options.noThrow ) { return; }\n\t\t\tthrow new Error( (\"Template element with id #\" + id + \", must be a <script> element\") );\n\t\t}\n\n\t\treturn ( 'textContent' in template ? template.textContent : template.innerHTML );\n\n\t},\n\n\tisParsed: function isParsed ( template) {\n\t\treturn !( typeof template === 'string' );\n\t},\n\n\tgetParseOptions: function getParseOptions ( ractive ) {\n\t\t// Could be Ractive or a Component\n\t\tif ( ractive.defaults ) { ractive = ractive.defaults; }\n\n\t\treturn parseOptions.reduce( function ( val, key ) {\n\t\t\tval[ key ] = ractive[ key ];\n\t\t\treturn val;\n\t\t}, {});\n\t},\n\n\tparse: function parse$1 ( template, options ) {\n\t\tthrowNoParse( parse$1$1, 'template', TEMPLATE_INSTRUCTIONS );\n\t\tvar parsed = parse$1$1( template, options );\n\t\taddFunctions( parsed );\n\t\treturn parsed;\n\t},\n\n\tparseFor: function parseFor( template, ractive ) {\n\t\treturn this.parse( template, this.getParseOptions( ractive ) );\n\t}\n};\n\nvar templateConfigurator = {\n\tname: 'template',\n\n\textend: function extend ( Parent, proto, options ) {\n\t\t// only assign if exists\n\t\tif ( 'template' in options ) {\n\t\t\tvar template = options.template;\n\n\t\t\tif ( typeof template === 'function' ) {\n\t\t\t\tproto.template = template;\n\t\t\t} else {\n\t\t\t\tproto.template = parseTemplate( template, proto );\n\t\t\t}\n\t\t}\n\t},\n\n\tinit: function init ( Parent, ractive, options ) {\n\t\t// TODO because of prototypal inheritance, we might just be able to use\n\t\t// ractive.template, and not bother passing through the Parent object.\n\t\t// At present that breaks the test mocks' expectations\n\t\tvar template = 'template' in options ? options.template : Parent.prototype.template;\n\t\ttemplate = template || { v: TEMPLATE_VERSION, t: [] };\n\n\t\tif ( typeof template === 'function' ) {\n\t\t\tvar fn = template;\n\t\t\ttemplate = getDynamicTemplate( ractive, fn );\n\n\t\t\tractive._config.template = {\n\t\t\t\tfn: fn,\n\t\t\t\tresult: template\n\t\t\t};\n\t\t}\n\n\t\ttemplate = parseTemplate( template, ractive );\n\n\t\t// TODO the naming of this is confusing - ractive.template refers to [...],\n\t\t// but Component.prototype.template refers to {v:1,t:[],p:[]}...\n\t\t// it's unnecessary, because the developer never needs to access\n\t\t// ractive.template\n\t\tractive.template = template.t;\n\n\t\tif ( template.p ) {\n\t\t\textendPartials( ractive.partials, template.p );\n\t\t}\n\t},\n\n\treset: function reset ( ractive ) {\n\t\tvar result = resetValue( ractive );\n\n\t\tif ( result ) {\n\t\t\tvar parsed = parseTemplate( result, ractive );\n\n\t\t\tractive.template = parsed.t;\n\t\t\textendPartials( ractive.partials, parsed.p, true );\n\n\t\t\treturn true;\n\t\t}\n\t}\n};\n\nfunction resetValue ( ractive ) {\n\tvar initial = ractive._config.template;\n\n\t// If this isn't a dynamic template, there's nothing to do\n\tif ( !initial || !initial.fn ) {\n\t\treturn;\n\t}\n\n\tvar result = getDynamicTemplate( ractive, initial.fn );\n\n\t// TODO deep equality check to prevent unnecessary re-rendering\n\t// in the case of already-parsed templates\n\tif ( result !== initial.result ) {\n\t\tinitial.result = result;\n\t\treturn result;\n\t}\n}\n\nfunction getDynamicTemplate ( ractive, fn ) {\n\treturn fn.call( ractive, {\n\t\tfromId: parser.fromId,\n\t\tisParsed: parser.isParsed,\n\t\tparse: function parse ( template, options ) {\n\t\t\tif ( options === void 0 ) options = parser.getParseOptions( ractive );\n\n\t\t\treturn parser.parse( template, options );\n\t\t}\n\t});\n}\n\nfunction parseTemplate ( template, ractive ) {\n\tif ( typeof template === 'string' ) {\n\t\t// parse will validate and add expression functions\n\t\ttemplate = parseAsString( template, ractive );\n\t}\n\telse {\n\t\t// need to validate and add exp for already parsed template\n\t\tvalidate$1( template );\n\t\taddFunctions( template );\n\t}\n\n\treturn template;\n}\n\nfunction parseAsString ( template, ractive ) {\n\t// ID of an element containing the template?\n\tif ( template[0] === '#' ) {\n\t\ttemplate = parser.fromId( template );\n\t}\n\n\treturn parser.parseFor( template, ractive );\n}\n\nfunction validate$1( template ) {\n\n\t// Check that the template even exists\n\tif ( template == undefined ) {\n\t\tthrow new Error( (\"The template cannot be \" + template + \".\") );\n\t}\n\n\t// Check the parsed template has a version at all\n\telse if ( typeof template.v !== 'number' ) {\n\t\tthrow new Error( 'The template parser was passed a non-string template, but the template doesn\\'t have a version.  Make sure you\\'re passing in the template you think you are.' );\n\t}\n\n\t// Check we're using the correct version\n\telse if ( template.v !== TEMPLATE_VERSION ) {\n\t\tthrow new Error( (\"Mismatched template version (expected \" + TEMPLATE_VERSION + \", got \" + (template.v) + \") Please ensure you are using the latest version of Ractive.js in your build process as well as in your app\") );\n\t}\n}\n\nfunction extendPartials ( existingPartials, newPartials, overwrite ) {\n\tif ( !newPartials ) { return; }\n\n\t// TODO there's an ambiguity here - we need to overwrite in the `reset()`\n\t// case, but not initially...\n\n\tfor ( var key in newPartials ) {\n\t\tif ( overwrite || !existingPartials.hasOwnProperty( key ) ) {\n\t\t\texistingPartials[ key ] = newPartials[ key ];\n\t\t}\n\t}\n}\n\nvar registryNames = [\n\t'adaptors',\n\t'components',\n\t'computed',\n\t'decorators',\n\t'easing',\n\t'events',\n\t'interpolators',\n\t'partials',\n\t'transitions'\n];\n\nvar Registry = function Registry ( name, useDefaults ) {\n\tthis.name = name;\n\tthis.useDefaults = useDefaults;\n};\n\nRegistry.prototype.extend = function extend ( Parent, proto, options ) {\n\tthis.configure(\n\t\tthis.useDefaults ? Parent.defaults : Parent,\n\t\tthis.useDefaults ? proto : proto.constructor,\n\t\toptions );\n};\n\nRegistry.prototype.init = function init () {\n\t// noop\n};\n\nRegistry.prototype.configure = function configure ( Parent, target, options ) {\n\tvar name = this.name;\n\tvar option = options[ name ];\n\n\tvar registry = create( Parent[name] );\n\n\tfor ( var key in option ) {\n\t\tregistry[ key ] = option[ key ];\n\t}\n\n\ttarget[ name ] = registry;\n};\n\nRegistry.prototype.reset = function reset ( ractive ) {\n\tvar registry = ractive[ this.name ];\n\tvar changed = false;\n\n\tObject.keys( registry ).forEach( function (key) {\n\t\tvar item = registry[ key ];\n\t\t\t\n\t\tif ( item._fn ) {\n\t\t\tif ( item._fn.isOwner ) {\n\t\t\t\tregistry[key] = item._fn;\n\t\t\t} else {\n\t\t\t\tdelete registry[key];\n\t\t\t}\n\t\t\tchanged = true;\n\t\t}\n\t});\n\n\treturn changed;\n};\n\nvar registries = registryNames.map( function (name) { return new Registry( name, name === 'computed' ); } );\n\nfunction wrap$1 ( parent, name, method ) {\n\tif ( !/_super/.test( method ) ) { return method; }\n\n\tfunction wrapper () {\n\t\tvar superMethod = getSuperMethod( wrapper._parent, name );\n\t\tvar hasSuper = '_super' in this;\n\t\tvar oldSuper = this._super;\n\n\t\tthis._super = superMethod;\n\n\t\tvar result = method.apply( this, arguments );\n\n\t\tif ( hasSuper ) {\n\t\t\tthis._super = oldSuper;\n\t\t} else {\n\t\t\tdelete this._super;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\twrapper._parent = parent;\n\twrapper._method = method;\n\n\treturn wrapper;\n}\n\nfunction getSuperMethod ( parent, name ) {\n\tif ( name in parent ) {\n\t\tvar value = parent[ name ];\n\n\t\treturn typeof value === 'function' ?\n\t\t\tvalue :\n\t\t\tfunction () { return value; };\n\t}\n\n\treturn noop;\n}\n\nfunction getMessage( deprecated, correct, isError ) {\n\treturn \"options.\" + deprecated + \" has been deprecated in favour of options.\" + correct + \".\"\n\t\t+ ( isError ? (\" You cannot specify both options, please use options.\" + correct + \".\") : '' );\n}\n\nfunction deprecateOption ( options, deprecatedOption, correct ) {\n\tif ( deprecatedOption in options ) {\n\t\tif( !( correct in options ) ) {\n\t\t\twarnIfDebug( getMessage( deprecatedOption, correct ) );\n\t\t\toptions[ correct ] = options[ deprecatedOption ];\n\t\t} else {\n\t\t\tthrow new Error( getMessage( deprecatedOption, correct, true ) );\n\t\t}\n\t}\n}\n\nfunction deprecate ( options ) {\n\tdeprecateOption( options, 'beforeInit', 'onconstruct' );\n\tdeprecateOption( options, 'init', 'onrender' );\n\tdeprecateOption( options, 'complete', 'oncomplete' );\n\tdeprecateOption( options, 'eventDefinitions', 'events' );\n\n\t// Using extend with Component instead of options,\n\t// like Human.extend( Spider ) means adaptors as a registry\n\t// gets copied to options. So we have to check if actually an array\n\tif ( isArray( options.adaptors ) ) {\n\t\tdeprecateOption( options, 'adaptors', 'adapt' );\n\t}\n}\n\nvar custom = {\n\tadapt: adaptConfigurator,\n\tcss: cssConfigurator,\n\tdata: dataConfigurator,\n\ttemplate: templateConfigurator\n};\n\nvar defaultKeys = Object.keys( defaults );\n\nvar isStandardKey = makeObj( defaultKeys.filter( function (key) { return !custom[ key ]; } ) );\n\n// blacklisted keys that we don't double extend\nvar isBlacklisted = makeObj( defaultKeys.concat( registries.map( function (r) { return r.name; } ) ) );\n\nvar order = [].concat(\n\tdefaultKeys.filter( function (key) { return !registries[ key ] && !custom[ key ]; } ),\n\tregistries,\n\t//custom.data,\n\tcustom.template,\n\tcustom.css\n);\n\nvar config = {\n\textend: function ( Parent, proto, options ) { return configure$1( 'extend', Parent, proto, options ); },\n\n\tinit: function ( Parent, ractive, options ) { return configure$1( 'init', Parent, ractive, options ); },\n\n\treset: function (ractive) {\n\t\treturn order.filter( function (c) {\n\t\t\treturn c.reset && c.reset( ractive );\n\t\t}).map( function (c) { return c.name; } );\n\t},\n\n\t// this defines the order. TODO this isn't used anywhere in the codebase,\n\t// only in the test suite - should get rid of it\n\torder: order\n};\n\nfunction configure$1 ( method, Parent, target, options ) {\n\tdeprecate( options );\n\n\tfor ( var key in options ) {\n\t\tif ( isStandardKey.hasOwnProperty( key ) ) {\n\t\t\tvar value = options[ key ];\n\n\t\t\t// warn the developer if they passed a function and ignore its value\n\n\t\t\t// NOTE: we allow some functions on \"el\" because we duck type element lists\n\t\t\t// and some libraries or ef'ed-up virtual browsers (phantomJS) return a\n\t\t\t// function object as the result of querySelector methods\n\t\t\tif ( key !== 'el' && typeof value === 'function' ) {\n\t\t\t\twarnIfDebug( (key + \" is a Ractive option that does not expect a function and will be ignored\"),\n\t\t\t\t\tmethod === 'init' ? target : null );\n\t\t\t}\n\t\t\telse {\n\t\t\t\ttarget[ key ] = value;\n\t\t\t}\n\t\t}\n\t}\n\n\t// disallow combination of `append` and `enhance`\n\tif ( options.append && options.enhance ) {\n\t\tthrow new Error( 'Cannot use append and enhance at the same time' );\n\t}\n\n\tregistries.forEach( function (registry) {\n\t\tregistry[ method ]( Parent, target, options );\n\t});\n\n\tadaptConfigurator[ method ]( Parent, target, options );\n\ttemplateConfigurator[ method ]( Parent, target, options );\n\tcssConfigurator[ method ]( Parent, target, options );\n\n\textendOtherMethods( Parent.prototype, target, options );\n}\n\nfunction extendOtherMethods ( parent, target, options ) {\n\tfor ( var key in options ) {\n\t\tif ( !isBlacklisted[ key ] && options.hasOwnProperty( key ) ) {\n\t\t\tvar member = options[ key ];\n\n\t\t\t// if this is a method that overwrites a method, wrap it:\n\t\t\tif ( typeof member === 'function' ) {\n\t\t\t\tmember = wrap$1( parent, key, member );\n\t\t\t}\n\n\t\t\ttarget[ key ] = member;\n\t\t}\n\t}\n}\n\nfunction makeObj ( array ) {\n\tvar obj = {};\n\tarray.forEach( function (x) { return obj[x] = true; } );\n\treturn obj;\n}\n\nvar TEXT              = 1;\nvar INTERPOLATOR      = 2;\nvar TRIPLE            = 3;\nvar SECTION           = 4;\nvar INVERTED          = 5;\n\nvar ELEMENT           = 7;\nvar PARTIAL           = 8;\n\n\nvar ANCHOR            = 11;\nvar ATTRIBUTE         = 13;\n\nvar COMPONENT         = 15;\nvar YIELDER           = 16;\n\nvar DOCTYPE           = 18;\nvar ALIAS             = 19;\n\nvar NUMBER_LITERAL    = 20;\nvar STRING_LITERAL    = 21;\n\n\n\n\n\n\n\n\n\nvar REFERENCE         = 30;\n\n\n\n\n\n\n\n\n\nvar SECTION_IF        = 50;\nvar SECTION_UNLESS    = 51;\nvar SECTION_EACH      = 52;\nvar SECTION_WITH      = 53;\nvar SECTION_IF_WITH   = 54;\n\n\n\n\nvar EVENT             = 70;\nvar DECORATOR         = 71;\nvar TRANSITION        = 72;\nvar BINDING_FLAG      = 73;\n\nvar Item = function Item ( options ) {\n\tthis.parentFragment = options.parentFragment;\n\tthis.ractive = options.parentFragment.ractive;\n\n\tthis.template = options.template;\n\tthis.index = options.index;\n\tthis.type = options.template.t;\n\n\tthis.dirty = false;\n};\n\nItem.prototype.bubble = function bubble () {\n\tif ( !this.dirty ) {\n\t\tthis.dirty = true;\n\t\tthis.parentFragment.bubble();\n\t}\n};\n\nItem.prototype.destroyed = function destroyed () {\n\tif ( this.fragment ) { this.fragment.destroyed(); }\n};\n\nItem.prototype.find = function find () {\n\treturn null;\n};\n\nItem.prototype.findAll = function findAll () {\n\t// noop\n};\n\nItem.prototype.findComponent = function findComponent () {\n\treturn null;\n};\n\nItem.prototype.findAllComponents = function findAllComponents () {\n\t// noop;\n};\n\nItem.prototype.findNextNode = function findNextNode () {\n\treturn this.parentFragment.findNextNode( this );\n};\n\nItem.prototype.shuffled = function shuffled () {\n\tif ( this.fragment ) { this.fragment.shuffled(); }\n};\n\nItem.prototype.valueOf = function valueOf () {\n\treturn this.toString();\n};\n\nvar ContainerItem = (function (Item) {\n\tfunction ContainerItem ( options ) {\n\t\tItem.call( this, options );\n\t}\n\n\tif ( Item ) ContainerItem.__proto__ = Item;\n\tContainerItem.prototype = Object.create( Item && Item.prototype );\n\tContainerItem.prototype.constructor = ContainerItem;\n\n\tContainerItem.prototype.detach = function detach () {\n\t\treturn this.fragment ? this.fragment.detach() : createDocumentFragment();\n\t};\n\n\tContainerItem.prototype.find = function find ( selector ) {\n\t\tif ( this.fragment ) {\n\t\t\treturn this.fragment.find( selector );\n\t\t}\n\t};\n\n\tContainerItem.prototype.findAll = function findAll ( selector, query ) {\n\t\tif ( this.fragment ) {\n\t\t\tthis.fragment.findAll( selector, query );\n\t\t}\n\t};\n\n\tContainerItem.prototype.findComponent = function findComponent ( name ) {\n\t\tif ( this.fragment ) {\n\t\t\treturn this.fragment.findComponent( name );\n\t\t}\n\t};\n\n\tContainerItem.prototype.findAllComponents = function findAllComponents ( name, query ) {\n\t\tif ( this.fragment ) {\n\t\t\tthis.fragment.findAllComponents( name, query );\n\t\t}\n\t};\n\n\tContainerItem.prototype.firstNode = function firstNode ( skipParent ) {\n\t\treturn this.fragment && this.fragment.firstNode( skipParent );\n\t};\n\n\tContainerItem.prototype.toString = function toString ( escape ) {\n\t\treturn this.fragment ? this.fragment.toString( escape ) : '';\n\t};\n\n\treturn ContainerItem;\n}(Item));\n\nvar ComputationChild = (function (Model$$1) {\n\tfunction ComputationChild ( parent, key ) {\n\t\tModel$$1.call( this, parent, key );\n\n\t\tthis.isReadonly = !this.root.ractive.syncComputedChildren;\n\t\tthis.dirty = true;\n\t}\n\n\tif ( Model$$1 ) ComputationChild.__proto__ = Model$$1;\n\tComputationChild.prototype = Object.create( Model$$1 && Model$$1.prototype );\n\tComputationChild.prototype.constructor = ComputationChild;\n\n\tComputationChild.prototype.applyValue = function applyValue ( value ) {\n\t\tModel$$1.prototype.applyValue.call( this, value );\n\n\t\tif ( !this.isReadonly ) {\n\t\t\tvar source = this.parent;\n\t\t\t// computed models don't have a shuffle method\n\t\t\twhile ( source && source.shuffle ) {\n\t\t\t\tsource = source.parent;\n\t\t\t}\n\n\t\t\tif ( source ) {\n\t\t\t\tsource.dependencies.forEach( mark$1$1 );\n\t\t\t}\n\t\t}\n\t};\n\n\tComputationChild.prototype.get = function get ( shouldCapture ) {\n\t\tif ( shouldCapture ) { capture( this ); }\n\n\t\tif ( this.dirty ) {\n\t\t\tthis.dirty = false;\n\t\t\tvar parentValue = this.parent.get();\n\t\t\tthis.value = parentValue ? parentValue[ this.key ] : undefined;\n\t\t}\n\n\t\treturn this.value;\n\t};\n\n\tComputationChild.prototype.handleChange = function handleChange$1 () {\n\t\tthis.dirty = true;\n\n\t\tif ( this.boundValue ) { this.boundValue = null; }\n\n\t\tthis.links.forEach( marked );\n\t\tthis.deps.forEach( handleChange$1$1 );\n\t\tthis.children.forEach( handleChange$1$1 );\n\t\tthis.clearUnresolveds(); // TODO is this necessary?\n\t};\n\n\tComputationChild.prototype.joinKey = function joinKey ( key ) {\n\t\tif ( key === undefined || key === '' ) { return this; }\n\n\t\tif ( !this.childByKey.hasOwnProperty( key ) ) {\n\t\t\tvar child = new ComputationChild( this, key );\n\t\t\tthis.children.push( child );\n\t\t\tthis.childByKey[ key ] = child;\n\t\t}\n\n\t\treturn this.childByKey[ key ];\n\t};\n\n\treturn ComputationChild;\n}(Model));\n\n/* global console */\n/* eslint no-console:\"off\" */\n\n// TODO this is probably a bit anal, maybe we should leave it out\nfunction prettify ( fnBody ) {\n\tvar lines = fnBody\n\t\t.replace( /^\\t+/gm, function (tabs) { return tabs.split( '\\t' ).join( '  ' ); } )\n\t\t.split( '\\n' );\n\n\tvar minIndent = lines.length < 2 ? 0 :\n\t\tlines.slice( 1 ).reduce( function ( prev, line ) {\n\t\t\treturn Math.min( prev, /^\\s*/.exec( line )[0].length );\n\t\t}, Infinity );\n\n\treturn lines.map( function ( line, i ) {\n\t\treturn '    ' + ( i ? line.substring( minIndent ) : line );\n\t}).join( '\\n' );\n}\n\n// Ditto. This function truncates the stack to only include app code\nfunction truncateStack ( stack ) {\n\tif ( !stack ) { return ''; }\n\n\tvar lines = stack.split( '\\n' );\n\tvar name = Computation.name + '.getValue';\n\n\tvar truncated = [];\n\n\tvar len = lines.length;\n\tfor ( var i = 1; i < len; i += 1 ) {\n\t\tvar line = lines[i];\n\n\t\tif ( ~line.indexOf( name ) ) {\n\t\t\treturn truncated.join( '\\n' );\n\t\t} else {\n\t\t\ttruncated.push( line );\n\t\t}\n\t}\n}\n\nvar Computation = (function (Model$$1) {\n\tfunction Computation ( viewmodel, signature, key ) {\n\t\tModel$$1.call( this, null, null );\n\n\t\tthis.root = this.parent = viewmodel;\n\t\tthis.signature = signature;\n\n\t\tthis.key = key; // not actually used, but helps with debugging\n\t\tthis.isExpression = key && key[0] === '@';\n\n\t\tthis.isReadonly = !this.signature.setter;\n\n\t\tthis.context = viewmodel.computationContext;\n\n\t\tthis.dependencies = [];\n\n\t\tthis.children = [];\n\t\tthis.childByKey = {};\n\n\t\tthis.deps = [];\n\n\t\tthis.dirty = true;\n\n\t\t// TODO: is there a less hackish way to do this?\n\t\tthis.shuffle = undefined;\n\t}\n\n\tif ( Model$$1 ) Computation.__proto__ = Model$$1;\n\tComputation.prototype = Object.create( Model$$1 && Model$$1.prototype );\n\tComputation.prototype.constructor = Computation;\n\n\tComputation.prototype.get = function get ( shouldCapture ) {\n\t\tif ( shouldCapture ) { capture( this ); }\n\n\t\tif ( this.dirty ) {\n\t\t\tthis.dirty = false;\n\t\t\tthis.value = this.getValue();\n\t\t\tif ( this.wrapper ) { this.newWrapperValue = this.value; }\n\t\t\tthis.adapt();\n\t\t}\n\n\t\t// if capturing, this value needs to be unwrapped because it's for external use\n\t\treturn maybeBind( this, shouldCapture && this.wrapper ? this.wrapperValue : this.value );\n\t};\n\n\tComputation.prototype.getValue = function getValue () {\n\t\tstartCapturing();\n\t\tvar result;\n\n\t\ttry {\n\t\t\tresult = this.signature.getter.call( this.context );\n\t\t} catch ( err ) {\n\t\t\twarnIfDebug( (\"Failed to compute \" + (this.getKeypath()) + \": \" + (err.message || err)) );\n\n\t\t\t// TODO this is all well and good in Chrome, but...\n\t\t\t// ...also, should encapsulate this stuff better, and only\n\t\t\t// show it if Ractive.DEBUG\n\t\t\tif ( hasConsole ) {\n\t\t\t\tif ( console.groupCollapsed ) { console.groupCollapsed( '%cshow details', 'color: rgb(82, 140, 224); font-weight: normal; text-decoration: underline;' ); }\n\t\t\t\tvar functionBody = prettify( this.signature.getterString );\n\t\t\t\tvar stack = this.signature.getterUseStack ? '\\n\\n' + truncateStack( err.stack ) : '';\n\t\t\t\tconsole.error( ((err.name) + \": \" + (err.message) + \"\\n\\n\" + functionBody + stack) );\n\t\t\t\tif ( console.groupCollapsed ) { console.groupEnd(); }\n\t\t\t}\n\t\t}\n\n\t\tvar dependencies = stopCapturing();\n\t\tthis.setDependencies( dependencies );\n\n\t\t// if not the first computation and the value is not the same,\n\t\t// register the change for change events\n\t\tif ( 'value' in this && result !== this.value ) {\n\t\t\tthis.registerChange( this.getKeypath(), result );\n\t\t}\n\n\t\treturn result;\n\t};\n\n\tComputation.prototype.mark = function mark () {\n\t\tthis.handleChange();\n\t};\n\n\tComputation.prototype.rebinding = function rebinding ( next, previous ) {\n\t\t// computations will grab all of their deps again automagically\n\t\tif ( next !== previous ) { this.handleChange(); }\n\t};\n\n\tComputation.prototype.set = function set ( value ) {\n\t\tif ( this.isReadonly ) {\n\t\t\tthrow new Error( (\"Cannot set read-only computed value '\" + (this.key) + \"'\") );\n\t\t}\n\n\t\tthis.signature.setter( value );\n\t\tthis.mark();\n\t};\n\n\tComputation.prototype.setDependencies = function setDependencies ( dependencies ) {\n\t\tvar this$1 = this;\n\n\t\t// unregister any soft dependencies we no longer have\n\t\tvar i = this.dependencies.length;\n\t\twhile ( i-- ) {\n\t\t\tvar model = this$1.dependencies[i];\n\t\t\tif ( !~dependencies.indexOf( model ) ) { model.unregister( this$1 ); }\n\t\t}\n\n\t\t// and add any new ones\n\t\ti = dependencies.length;\n\t\twhile ( i-- ) {\n\t\t\tvar model$1 = dependencies[i];\n\t\t\tif ( !~this$1.dependencies.indexOf( model$1 ) ) { model$1.register( this$1 ); }\n\t\t}\n\n\t\tthis.dependencies = dependencies;\n\t};\n\n\tComputation.prototype.teardown = function teardown () {\n\t\tvar this$1 = this;\n\n\t\tvar i = this.dependencies.length;\n\t\twhile ( i-- ) {\n\t\t\tif ( this$1.dependencies[i] ) { this$1.dependencies[i].unregister( this$1 ); }\n\t\t}\n\t\tif ( this.root.computations[this.key] === this ) { delete this.root.computations[this.key]; }\n\t\tModel$$1.prototype.teardown.call(this);\n\t};\n\n\treturn Computation;\n}(Model));\n\nvar prototype$1 = Computation.prototype;\nvar child = ComputationChild.prototype;\nprototype$1.handleChange = child.handleChange;\nprototype$1.joinKey = child.joinKey;\n\nfunction createResolver ( proxy, ref, index ) {\n\tvar resolver = proxy.fragment.resolve( ref, function (model) {\n\t\tremoveFromArray( proxy.resolvers, resolver );\n\t\tproxy.models[ index ] = model;\n\t\tproxy.bubble();\n\t});\n\n\tproxy.resolvers.push( resolver );\n}\n\nvar ExpressionProxy = (function (Model$$1) {\n\tfunction ExpressionProxy ( fragment, template ) {\n\t\tvar this$1 = this;\n\n\t\tModel$$1.call( this, fragment.ractive.viewmodel, null );\n\n\t\tthis.fragment = fragment;\n\t\tthis.template = template;\n\n\t\tthis.isReadonly = true;\n\t\tthis.dirty = true;\n\n\t\tthis.fn = getFunction( template.s, template.r.length );\n\n\t\tthis.resolvers = [];\n\t\tthis.models = this.template.r.map( function ( ref, index ) {\n\t\t\tvar model = resolveReference( this$1.fragment, ref );\n\n\t\t\tif ( !model ) {\n\t\t\t\tcreateResolver( this$1, ref, index );\n\t\t\t}\n\n\t\t\treturn model;\n\t\t});\n\t\tthis.dependencies = [];\n\n\t\tthis.shuffle = undefined;\n\n\t\tthis.bubble();\n\t}\n\n\tif ( Model$$1 ) ExpressionProxy.__proto__ = Model$$1;\n\tExpressionProxy.prototype = Object.create( Model$$1 && Model$$1.prototype );\n\tExpressionProxy.prototype.constructor = ExpressionProxy;\n\n\tExpressionProxy.prototype.bubble = function bubble ( actuallyChanged ) {\n\t\tif ( actuallyChanged === void 0 ) actuallyChanged = true;\n\n\t\t// refresh the keypath\n\t\tthis.keypath = undefined;\n\n\t\tif ( actuallyChanged ) {\n\t\t\tthis.handleChange();\n\t\t}\n\t};\n\n\tExpressionProxy.prototype.getKeypath = function getKeypath () {\n\t\tvar this$1 = this;\n\n\t\tif ( !this.template ) { return '@undefined'; }\n\t\tif ( !this.keypath ) {\n\t\t\tthis.keypath = '@' + this.template.s.replace( /_(\\d+)/g, function ( match, i ) {\n\t\t\t\tif ( i >= this$1.models.length ) { return match; }\n\n\t\t\t\tvar model = this$1.models[i];\n\t\t\t\treturn model ? model.getKeypath() : '@undefined';\n\t\t\t});\n\t\t}\n\n\t\treturn this.keypath;\n\t};\n\n\tExpressionProxy.prototype.getValue = function getValue () {\n\t\tvar this$1 = this;\n\n\t\tstartCapturing();\n\t\tvar result;\n\n\t\ttry {\n\t\t\tvar params = this.models.map( function (m) { return m ? m.get( true ) : undefined; } );\n\t\t\tresult = this.fn.apply( this.fragment.ractive, params );\n\t\t} catch ( err ) {\n\t\t\twarnIfDebug( (\"Failed to compute \" + (this.getKeypath()) + \": \" + (err.message || err)) );\n\t\t}\n\n\t\tvar dependencies = stopCapturing();\n\t\t// remove missing deps\n\t\tthis.dependencies.filter( function (d) { return !~dependencies.indexOf( d ); } ).forEach( function (d) {\n\t\t\td.unregister( this$1 );\n\t\t\tremoveFromArray( this$1.dependencies, d );\n\t\t});\n\t\t// register new deps\n\t\tdependencies.filter( function (d) { return !~this$1.dependencies.indexOf( d ); } ).forEach( function (d) {\n\t\t\td.register( this$1 );\n\t\t\tthis$1.dependencies.push( d );\n\t\t});\n\n\t\treturn result;\n\t};\n\n\tExpressionProxy.prototype.rebinding = function rebinding ( next, previous, safe ) {\n\t\tvar idx = this.models.indexOf( previous );\n\n\t\tif ( ~idx ) {\n\t\t\tnext = rebindMatch( this.template.r[idx], next, previous );\n\t\t\tif ( next !== previous ) {\n\t\t\t\tprevious.unregister( this );\n\t\t\t\tthis.models.splice( idx, 1, next );\n\t\t\t\t// TODO: set up a resolver if there is no next?\n\t\t\t\tif ( next ) { next.addShuffleRegister( this, 'mark' ); }\n\t\t\t}\n\t\t}\n\t\tthis.bubble( !safe );\n\t};\n\n\tExpressionProxy.prototype.retrieve = function retrieve () {\n\t\treturn this.get();\n\t};\n\n\tExpressionProxy.prototype.teardown = function teardown () {\n\t\tvar this$1 = this;\n\n\t\tthis.unbind();\n\t\tthis.fragment = undefined;\n\t\tif ( this.dependencies ) { this.dependencies.forEach( function (d) { return d.unregister( this$1 ); } ); }\n\t\tModel$$1.prototype.teardown.call(this);\n\t};\n\n\tExpressionProxy.prototype.unregister = function unregister ( dep ) {\n\t\tModel$$1.prototype.unregister.call( this, dep );\n\t\tif ( !this.deps.length ) { this.teardown(); }\n\t};\n\n\tExpressionProxy.prototype.unbind = function unbind$1 () {\n\t\tthis.resolvers.forEach( unbind$1$1 );\n\t};\n\n\treturn ExpressionProxy;\n}(Model));\n\nvar prototype = ExpressionProxy.prototype;\nvar computation = Computation.prototype;\nprototype.get = computation.get;\nprototype.handleChange = computation.handleChange;\nprototype.joinKey = computation.joinKey;\nprototype.mark = computation.mark;\n\nvar ReferenceExpressionChild = (function (Model$$1) {\n\tfunction ReferenceExpressionChild ( parent, key ) {\n\t\tModel$$1.call ( this, parent, key );\n\t}\n\n\tif ( Model$$1 ) ReferenceExpressionChild.__proto__ = Model$$1;\n\tReferenceExpressionChild.prototype = Object.create( Model$$1 && Model$$1.prototype );\n\tReferenceExpressionChild.prototype.constructor = ReferenceExpressionChild;\n\n\tReferenceExpressionChild.prototype.applyValue = function applyValue ( value ) {\n\t\tif ( isEqual( value, this.value ) ) { return; }\n\n\t\tvar parent = this.parent;\n\t\tvar keys = [ this.key ];\n\t\twhile ( parent ) {\n\t\t\tif ( parent.base ) {\n\t\t\t\tvar target = parent.model.joinAll( keys );\n\t\t\t\ttarget.applyValue( value );\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tkeys.unshift( parent.key );\n\n\t\t\tparent = parent.parent;\n\t\t}\n\t};\n\n\tReferenceExpressionChild.prototype.joinKey = function joinKey ( key ) {\n\t\tif ( key === undefined || key === '' ) { return this; }\n\n\t\tif ( !this.childByKey.hasOwnProperty( key ) ) {\n\t\t\tvar child = new ReferenceExpressionChild( this, key );\n\t\t\tthis.children.push( child );\n\t\t\tthis.childByKey[ key ] = child;\n\t\t}\n\n\t\treturn this.childByKey[ key ];\n\t};\n\n\tReferenceExpressionChild.prototype.retrieve = function retrieve () {\n\t\tvar parent = this.parent.get();\n\t\treturn parent && this.key in parent ? parent[ this.key ] : undefined;\n\t};\n\n\treturn ReferenceExpressionChild;\n}(Model));\n\nvar ReferenceExpressionProxy = (function (Model$$1) {\n\tfunction ReferenceExpressionProxy ( fragment, template ) {\n\t\tvar this$1 = this;\n\n\t\tModel$$1.call( this, null, null );\n\t\tthis.dirty = true;\n\t\tthis.root = fragment.ractive.viewmodel;\n\t\tthis.template = template;\n\n\t\tthis.resolvers = [];\n\n\t\tthis.base = resolve$3( fragment, template );\n\t\tvar baseResolver;\n\n\t\tif ( !this.base ) {\n\t\t\tbaseResolver = fragment.resolve( template.r, function (model) {\n\t\t\t\tthis$1.base = model;\n\t\t\t\tthis$1.bubble();\n\n\t\t\t\tremoveFromArray( this$1.resolvers, baseResolver );\n\t\t\t});\n\n\t\t\tthis.resolvers.push( baseResolver );\n\t\t}\n\n\t\tvar intermediary = this.intermediary = {\n\t\t\thandleChange: function () { return this$1.handleChange(); },\n\t\t\trebinding: function ( next, previous ) {\n\t\t\t\tif ( previous === this$1.base ) {\n\t\t\t\t\tnext = rebindMatch( template, next, previous );\n\t\t\t\t\tif ( next !== this$1.base ) {\n\t\t\t\t\t\tthis$1.base.unregister( intermediary );\n\t\t\t\t\t\tthis$1.base = next;\n\t\t\t\t\t\t// TODO: if there is no next, set up a resolver?\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tvar idx = this$1.members.indexOf( previous );\n\t\t\t\t\tif ( ~idx ) {\n\t\t\t\t\t\t// only direct references will rebind... expressions handle themselves\n\t\t\t\t\t\tnext = rebindMatch( template.m[idx].n, next, previous );\n\t\t\t\t\t\tif ( next !== this$1.members[idx] ) {\n\t\t\t\t\t\t\tthis$1.members.splice( idx, 1, next );\n\t\t\t\t\t\t\t// TODO: if there is no next, set up a resolver?\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( next !== previous ) { previous.unregister( intermediary ); }\n\t\t\t\tif ( next ) { next.addShuffleTask( function () { return next.register( intermediary ); } ); }\n\n\t\t\t\tthis$1.bubble();\n\t\t\t}\n\t\t};\n\n\t\tthis.members = template.m.map( function ( template, i ) {\n\t\t\tif ( typeof template === 'string' ) {\n\t\t\t\treturn { get: function () { return template; } };\n\t\t\t}\n\n\t\t\tvar model;\n\t\t\tvar resolver;\n\n\t\t\tif ( template.t === REFERENCE ) {\n\t\t\t\tmodel = resolveReference( fragment, template.n );\n\n\t\t\t\tif ( model ) {\n\t\t\t\t\tmodel.register( intermediary );\n\t\t\t\t} else {\n\t\t\t\t\tresolver = fragment.resolve( template.n, function (model) {\n\t\t\t\t\t\tthis$1.members[i] = model;\n\n\t\t\t\t\t\tmodel.register( intermediary );\n\t\t\t\t\t\tthis$1.handleChange();\n\n\t\t\t\t\t\tremoveFromArray( this$1.resolvers, resolver );\n\t\t\t\t\t});\n\n\t\t\t\t\tthis$1.resolvers.push( resolver );\n\t\t\t\t}\n\n\t\t\t\treturn model;\n\t\t\t}\n\n\t\t\tmodel = new ExpressionProxy( fragment, template );\n\t\t\tmodel.register( intermediary );\n\t\t\treturn model;\n\t\t});\n\n\t\tthis.isUnresolved = true;\n\t\tthis.bubble();\n\t}\n\n\tif ( Model$$1 ) ReferenceExpressionProxy.__proto__ = Model$$1;\n\tReferenceExpressionProxy.prototype = Object.create( Model$$1 && Model$$1.prototype );\n\tReferenceExpressionProxy.prototype.constructor = ReferenceExpressionProxy;\n\n\tReferenceExpressionProxy.prototype.bubble = function bubble () {\n\t\tif ( !this.base ) { return; }\n\t\tif ( !this.dirty ) { this.handleChange(); }\n\t};\n\n\tReferenceExpressionProxy.prototype.forceResolution = function forceResolution () {\n\t\tthis.resolvers.forEach( function (resolver) { return resolver.forceResolution(); } );\n\t\tthis.dirty = true;\n\t\tthis.bubble();\n\t};\n\n\tReferenceExpressionProxy.prototype.get = function get ( shouldCapture ) {\n\t\tvar this$1 = this;\n\n\t\tif ( this.dirty ) {\n\t\t\tthis.bubble();\n\n\t\t\tvar i = this.members.length;\n\t\t\tvar resolved = true;\n\t\t\twhile ( resolved && i-- ) {\n\t\t\t\tif ( !this$1.members[i] ) { resolved = false; }\n\t\t\t}\n\n\t\t\tif ( this.base && resolved ) {\n\t\t\t\tvar keys = this.members.map( function (m) { return escapeKey( String( m.get() ) ); } );\n\t\t\t\tvar model = this.base.joinAll( keys );\n\n\t\t\t\tif ( model !== this.model ) {\n\t\t\t\t\tif ( this.model ) {\n\t\t\t\t\t\tthis.model.unregister( this );\n\t\t\t\t\t\tthis.model.unregisterTwowayBinding( this );\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.model = model;\n\t\t\t\t\tthis.parent = model.parent;\n\t\t\t\t\tthis.model.register( this );\n\t\t\t\t\tthis.model.registerTwowayBinding( this );\n\n\t\t\t\t\tif ( this.keypathModel ) { this.keypathModel.handleChange(); }\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.value = this.model ? this.model.get( shouldCapture ) : undefined;\n\t\t\tthis.dirty = false;\n\t\t\tthis.mark();\n\t\t\treturn this.value;\n\t\t} else {\n\t\t\treturn this.model ? this.model.get( shouldCapture ) : undefined;\n\t\t}\n\t};\n\n\t// indirect two-way bindings\n\tReferenceExpressionProxy.prototype.getValue = function getValue () {\n\t\tvar this$1 = this;\n\n\t\tthis.value = this.model ? this.model.get() : undefined;\n\n\t\tvar i = this.bindings.length;\n\t\twhile ( i-- ) {\n\t\t\tvar value = this$1.bindings[i].getValue();\n\t\t\tif ( value !== this$1.value ) { return value; }\n\t\t}\n\n\t\t// check one-way bindings\n\t\tvar oneway = findBoundValue( this.deps );\n\t\tif ( oneway ) { return oneway.value; }\n\n\t\treturn this.value;\n\t};\n\n\tReferenceExpressionProxy.prototype.getKeypath = function getKeypath () {\n\t\treturn this.model ? this.model.getKeypath() : '@undefined';\n\t};\n\n\tReferenceExpressionProxy.prototype.handleChange = function handleChange$1 () {\n\t\tthis.dirty = true;\n\t\tthis.mark();\n\t};\n\n\tReferenceExpressionProxy.prototype.joinKey = function joinKey ( key ) {\n\t\tif ( key === undefined || key === '' ) { return this; }\n\n\t\tif ( !this.childByKey.hasOwnProperty( key ) ) {\n\t\t\tvar child = new ReferenceExpressionChild( this, key );\n\t\t\tthis.children.push( child );\n\t\t\tthis.childByKey[ key ] = child;\n\t\t}\n\n\t\treturn this.childByKey[ key ];\n\t};\n\n\tReferenceExpressionProxy.prototype.mark = function mark$1 () {\n\t\tif ( this.dirty ) {\n\t\t\tthis.deps.forEach( handleChange$1$1 );\n\t\t}\n\n\t\tthis.links.forEach( marked );\n\t\tthis.children.forEach( mark$1$1 );\n\t\tthis.clearUnresolveds();\n\t};\n\n\tReferenceExpressionProxy.prototype.retrieve = function retrieve () {\n\t\treturn this.value;\n\t};\n\n\tReferenceExpressionProxy.prototype.rebinding = function rebinding () { }; // NOOP\n\n\tReferenceExpressionProxy.prototype.set = function set ( value ) {\n\t\tif ( !this.model ) { throw new Error( 'Unresolved reference expression. This should not happen!' ); }\n\t\tthis.model.set( value );\n\t};\n\n\tReferenceExpressionProxy.prototype.unbind = function unbind$1 () {\n\t\tthis.resolvers.forEach( unbind$1$1 );\n\t\tif ( this.model ) {\n\t\t\tthis.model.unregister( this );\n\t\t\tthis.model.unregisterTwowayBinding( this );\n\t\t}\n\t};\n\n\treturn ReferenceExpressionProxy;\n}(Model));\n\nfunction resolve$3 ( fragment, template ) {\n\tif ( template.r ) {\n\t\treturn resolveReference( fragment, template.r );\n\t}\n\n\telse if ( template.x ) {\n\t\treturn new ExpressionProxy( fragment, template.x );\n\t}\n\n\telse if ( template.rx ) {\n\t\treturn new ReferenceExpressionProxy( fragment, template.rx );\n\t}\n}\n\nfunction resolveAliases( aliases, fragment ) {\n\tvar resolved = {};\n\n\tfor ( var i = 0; i < aliases.length; i++ ) {\n\t\tresolved[ aliases[i].n ] = resolve$3( fragment, aliases[i].x );\n\t}\n\n\treturn resolved;\n}\n\nvar Alias = (function (ContainerItem$$1) {\n\tfunction Alias ( options ) {\n\t\tContainerItem$$1.call( this, options );\n\n\t\tthis.fragment = null;\n\t}\n\n\tif ( ContainerItem$$1 ) Alias.__proto__ = ContainerItem$$1;\n\tAlias.prototype = Object.create( ContainerItem$$1 && ContainerItem$$1.prototype );\n\tAlias.prototype.constructor = Alias;\n\n\tAlias.prototype.bind = function bind () {\n\t\tthis.fragment = new Fragment({\n\t\t\towner: this,\n\t\t\ttemplate: this.template.f\n\t\t});\n\n\t\tthis.fragment.aliases = resolveAliases( this.template.z, this.parentFragment );\n\t\tthis.fragment.bind();\n\t};\n\n\tAlias.prototype.rebinding = function rebinding () {\n\t\tvar this$1 = this;\n\n\t\tif ( this.locked ) { return; }\n\t\tthis.locked = true;\n\t\trunloop.scheduleTask( function () {\n\t\t\tthis$1.locked = false;\n\t\t\tthis$1.fragment.aliases = resolveAliases( this$1.template.z, this$1.parentFragment );\n\t\t});\n\t};\n\n\tAlias.prototype.render = function render ( target ) {\n\t\tthis.rendered = true;\n\t\tif ( this.fragment ) { this.fragment.render( target ); }\n\t};\n\n\tAlias.prototype.unbind = function unbind () {\n\t\tthis.fragment.aliases = {};\n\t\tif ( this.fragment ) { this.fragment.unbind(); }\n\t};\n\n\tAlias.prototype.unrender = function unrender ( shouldDestroy ) {\n\t\tif ( this.rendered && this.fragment ) { this.fragment.unrender( shouldDestroy ); }\n\t\tthis.rendered = false;\n\t};\n\n\tAlias.prototype.update = function update () {\n\t\tif ( this.dirty ) {\n\t\t\tthis.dirty = false;\n\t\t\tthis.fragment.update();\n\t\t}\n\t};\n\n\treturn Alias;\n}(ContainerItem));\n\nfunction findElement( start, orComponent, name ) {\n\tif ( orComponent === void 0 ) orComponent = true;\n\n\twhile ( start && ( start.type !== ELEMENT || ( name && start.name !== name ) ) && ( !orComponent || ( start.type !== COMPONENT && start.type !== ANCHOR ) ) ) {\n\t\t// start is a fragment - look at the owner\n\t\tif ( start.owner ) { start = start.owner; }\n\t\t// start is a component or yielder - look at the container\n\t\telse if ( start.component ) { start = start.containerFragment || start.component.parentFragment; }\n\t\t// start is an item - look at the parent\n\t\telse if ( start.parent ) { start = start.parent; }\n\t\t// start is an item without a parent - look at the parent fragment\n\t\telse if ( start.parentFragment ) { start = start.parentFragment; }\n\n\t\telse { start = undefined; }\n\t}\n\n\treturn start;\n}\n\nvar camelCase = function ( hyphenatedStr ) {\n\treturn hyphenatedStr.replace( /-([a-zA-Z])/g, function ( match, $1 ) {\n\t\treturn $1.toUpperCase();\n\t});\n};\n\nvar space = /\\s+/;\nvar specials = { float: 'cssFloat' };\nvar remove$1 = /\\/\\*(?:[\\s\\S]*?)\\*\\//g;\nvar escape = /url\\(\\s*(['\"])(?:\\\\[\\s\\S]|(?!\\1).)*\\1\\s*\\)|url\\((?:\\\\[\\s\\S]|[^)])*\\)|(['\"])(?:\\\\[\\s\\S]|(?!\\1).)*\\2/gi;\nvar value = /\\0(\\d+)/g;\n\nfunction readStyle ( css ) {\n\tvar values = [];\n\n\tif ( typeof css !== 'string' ) { return {}; }\n\n\treturn css.replace( escape, function (match) { return (\"\\u0000\" + (values.push( match ) - 1)); })\n        .replace( remove$1, '' )\n        .split( ';' )\n        .filter( function (rule) { return !!rule.trim(); } )\n        .map( function (rule) { return rule.replace( value, function ( match, n ) { return values[ n ]; } ); } )\n        .reduce(function ( rules, rule ) {\n\tvar i = rule.indexOf(':');\n\tvar name = camelCase( rule.substr( 0, i ).trim() );\n\trules[ specials[ name ] || name ] = rule.substr( i + 1 ).trim();\n\treturn rules;\n}, {});\n}\n\nfunction readClass ( str ) {\n\tvar list = str.split( space );\n\n  // remove any empty entries\n\tvar i = list.length;\n\twhile ( i-- ) {\n\t\tif ( !list[i] ) { list.splice( i, 1 ); }\n\t}\n\n\treturn list;\n}\n\nvar textTypes = [ undefined, 'text', 'search', 'url', 'email', 'hidden', 'password', 'search', 'reset', 'submit' ];\n\nfunction getUpdateDelegate ( attribute ) {\n\tvar element = attribute.element;\n\tvar name = attribute.name;\n\n\tif ( name === 'id' ) { return updateId; }\n\n\tif ( name === 'value' ) {\n\t\tif ( attribute.interpolator ) { attribute.interpolator.bound = true; }\n\n\t\t// special case - selects\n\t\tif ( element.name === 'select' && name === 'value' ) {\n\t\t\treturn element.getAttribute( 'multiple' ) ? updateMultipleSelectValue : updateSelectValue;\n\t\t}\n\n\t\tif ( element.name === 'textarea' ) { return updateStringValue; }\n\n\t\t// special case - contenteditable\n\t\tif ( element.getAttribute( 'contenteditable' ) != null ) { return updateContentEditableValue; }\n\n\t\t// special case - <input>\n\t\tif ( element.name === 'input' ) {\n\t\t\tvar type = element.getAttribute( 'type' );\n\n\t\t\t// type='file' value='{{fileList}}'>\n\t\t\tif ( type === 'file' ) { return noop; } // read-only\n\n\t\t\t// type='radio' name='{{twoway}}'\n\t\t\tif ( type === 'radio' && element.binding && element.binding.attribute.name === 'name' ) { return updateRadioValue; }\n\n\t\t\tif ( ~textTypes.indexOf( type ) ) { return updateStringValue; }\n\t\t}\n\n\t\treturn updateValue;\n\t}\n\n\tvar node = element.node;\n\n\t// special case - <input type='radio' name='{{twoway}}' value='foo'>\n\tif ( attribute.isTwoway && name === 'name' ) {\n\t\tif ( node.type === 'radio' ) { return updateRadioName; }\n\t\tif ( node.type === 'checkbox' ) { return updateCheckboxName; }\n\t}\n\n\tif ( name === 'style' ) { return updateStyleAttribute; }\n\n\tif ( name.indexOf( 'style-' ) === 0 ) { return updateInlineStyle; }\n\n\t// special case - class names. IE fucks things up, again\n\tif ( name === 'class' && ( !node.namespaceURI || node.namespaceURI === html ) ) { return updateClassName; }\n\n\tif ( name.indexOf( 'class-' ) === 0 ) { return updateInlineClass; }\n\n\tif ( attribute.isBoolean ) {\n\t\tvar type$1 = element.getAttribute( 'type' );\n\t\tif ( attribute.interpolator && name === 'checked' && ( type$1 === 'checkbox' || type$1 === 'radio' ) ) { attribute.interpolator.bound = true; }\n\t\treturn updateBoolean;\n\t}\n\n\tif ( attribute.namespace && attribute.namespace !== attribute.node.namespaceURI ) { return updateNamespacedAttribute; }\n\n\treturn updateAttribute;\n}\n\nfunction updateId ( reset ) {\n\tvar ref = this;\n\tvar node = ref.node;\n\tvar value = this.getValue();\n\n\t// remove the mapping to this node if it hasn't already been replaced\n\tif ( this.ractive.nodes[ node.id ] === node ) { delete this.ractive.nodes[ node.id ]; }\n\tif ( reset ) { return node.removeAttribute( 'id' ); }\n\n\tthis.ractive.nodes[ value ] = node;\n\n\tnode.id = value;\n}\n\nfunction updateMultipleSelectValue ( reset ) {\n\tvar value = this.getValue();\n\n\tif ( !isArray( value ) ) { value = [ value ]; }\n\n\tvar options = this.node.options;\n\tvar i = options.length;\n\n\tif ( reset ) {\n\t\twhile ( i-- ) { options[i].selected = false; }\n\t} else {\n\t\twhile ( i-- ) {\n\t\t\tvar option = options[i];\n\t\t\tvar optionValue = option._ractive ?\n\t\t\t\toption._ractive.value :\n\t\t\t\toption.value; // options inserted via a triple don't have _ractive\n\n\t\t\toption.selected = arrayContains( value, optionValue );\n\t\t}\n\t}\n}\n\nfunction updateSelectValue ( reset ) {\n\tvar value = this.getValue();\n\n\tif ( !this.locked ) { // TODO is locked still a thing?\n\t\tthis.node._ractive.value = value;\n\n\t\tvar options = this.node.options;\n\t\tvar i = options.length;\n\t\tvar wasSelected = false;\n\n\t\tif ( reset ) {\n\t\t\twhile ( i-- ) { options[i].selected = false; }\n\t\t} else {\n\t\t\twhile ( i-- ) {\n\t\t\t\tvar option = options[i];\n\t\t\t\tvar optionValue = option._ractive ?\n\t\t\t\t\toption._ractive.value :\n\t\t\t\t\toption.value; // options inserted via a triple don't have _ractive\n\t\t\t\tif ( option.disabled && option.selected ) { wasSelected = true; }\n\n\t\t\t\tif ( optionValue == value ) { // double equals as we may be comparing numbers with strings\n\t\t\t\t\toption.selected = true;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif ( !wasSelected ) { this.node.selectedIndex = -1; }\n\t}\n}\n\n\nfunction updateContentEditableValue ( reset ) {\n\tvar value = this.getValue();\n\n\tif ( !this.locked ) {\n\t\tif ( reset ) { this.node.innerHTML = ''; }\n\t\telse { this.node.innerHTML = value === undefined ? '' : value; }\n\t}\n}\n\nfunction updateRadioValue ( reset ) {\n\tvar node = this.node;\n\tvar wasChecked = node.checked;\n\n\tvar value = this.getValue();\n\n\tif ( reset ) { return node.checked = false; }\n\n\t//node.value = this.element.getAttribute( 'value' );\n\tnode.value = this.node._ractive.value = value;\n\tnode.checked = value === this.element.getAttribute( 'name' );\n\n\t// This is a special case - if the input was checked, and the value\n\t// changed so that it's no longer checked, the twoway binding is\n\t// most likely out of date. To fix it we have to jump through some\n\t// hoops... this is a little kludgy but it works\n\tif ( wasChecked && !node.checked && this.element.binding && this.element.binding.rendered ) {\n\t\tthis.element.binding.group.model.set( this.element.binding.group.getValue() );\n\t}\n}\n\nfunction updateValue ( reset ) {\n\tif ( !this.locked ) {\n\t\tif ( reset ) {\n\t\t\tthis.node.removeAttribute( 'value' );\n\t\t\tthis.node.value = this.node._ractive.value = null;\n\t\t} else {\n\t\t\tvar value = this.getValue();\n\n\t\t\tthis.node.value = this.node._ractive.value = value;\n\t\t\tthis.node.setAttribute( 'value', value );\n\t\t}\n\t}\n}\n\nfunction updateStringValue ( reset ) {\n\tif ( !this.locked ) {\n\t\tif ( reset ) {\n\t\t\tthis.node._ractive.value = '';\n\t\t\tthis.node.removeAttribute( 'value' );\n\t\t} else {\n\t\t\tvar value = this.getValue();\n\n\t\t\tthis.node._ractive.value = value;\n\n\t\t\tthis.node.value = safeToStringValue( value );\n\t\t\tthis.node.setAttribute( 'value', safeToStringValue( value ) );\n\t\t}\n\t}\n}\n\nfunction updateRadioName ( reset ) {\n\tif ( reset ) { this.node.checked = false; }\n\telse { this.node.checked = ( this.getValue() == this.node._ractive.value ); }\n}\n\nfunction updateCheckboxName ( reset ) {\n\tvar ref = this;\n\tvar element = ref.element;\n\tvar node = ref.node;\n\tvar binding = element.binding;\n\n\tvar value = this.getValue();\n\tvar valueAttribute = element.getAttribute( 'value' );\n\n\tif ( reset ) {\n\t\t// TODO: WAT?\n\t}\n\n\tif ( !isArray( value ) ) {\n\t\tbinding.isChecked = node.checked = ( value == valueAttribute );\n\t} else {\n\t\tvar i = value.length;\n\t\twhile ( i-- ) {\n\t\t\tif ( valueAttribute == value[i] ) {\n\t\t\t\tbinding.isChecked = node.checked = true;\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tbinding.isChecked = node.checked = false;\n\t}\n}\n\nfunction updateStyleAttribute ( reset ) {\n\tvar props = reset ? {} : readStyle( this.getValue() || '' );\n\tvar style = this.node.style;\n\tvar keys = Object.keys( props );\n\tvar prev = this.previous || [];\n\n\tvar i = 0;\n\twhile ( i < keys.length ) {\n\t\tif ( keys[i] in style ) { style[ keys[i] ] = props[ keys[i] ]; }\n\t\ti++;\n\t}\n\n\t// remove now-missing attrs\n\ti = prev.length;\n\twhile ( i-- ) {\n\t\tif ( !~keys.indexOf( prev[i] ) && prev[i] in style ) { style[ prev[i] ] = ''; }\n\t}\n\n\tthis.previous = keys;\n}\n\nfunction updateInlineStyle ( reset ) {\n\tif ( !this.styleName ) {\n\t\tthis.styleName = camelize( this.name.substr( 6 ) );\n\t}\n\n\tthis.node.style[ this.styleName ] = reset ? '' : this.getValue();\n}\n\nfunction updateClassName ( reset ) {\n\tvar value = reset ? [] : readClass( safeToStringValue( this.getValue() ) );\n\tvar attr = readClass( this.node.className );\n\tvar prev = this.previous || attr.slice( 0 );\n\n\tvar i = 0;\n\twhile ( i < value.length ) {\n\t\tif ( !~attr.indexOf( value[i] ) ) { attr.push( value[i] ); }\n\t\ti++;\n\t}\n\n\t// remove now-missing classes\n\ti = prev.length;\n\twhile ( i-- ) {\n\t\tif ( !~value.indexOf( prev[i] ) ) {\n\t\t\tvar idx = attr.indexOf( prev[i] );\n\t\t\tif ( ~idx ) { attr.splice( idx, 1 ); }\n\t\t}\n\t}\n\n\tvar className = attr.join( ' ' );\n\n\tif ( className !== this.node.className ) {\n\t\tthis.node.className = className;\n\t}\n\n\tthis.previous = value;\n}\n\nfunction updateInlineClass ( reset ) {\n\tvar name = this.name.substr( 6 );\n\tvar attr = readClass( this.node.className );\n\tvar value = reset ? false : this.getValue();\n\n\tif ( !this.inlineClass ) { this.inlineClass = name; }\n\n\tif ( value && !~attr.indexOf( name ) ) { attr.push( name ); }\n\telse if ( !value && ~attr.indexOf( name ) ) { attr.splice( attr.indexOf( name ), 1 ); }\n\n\tthis.node.className = attr.join( ' ' );\n}\n\nfunction updateBoolean ( reset ) {\n\t// with two-way binding, only update if the change wasn't initiated by the user\n\t// otherwise the cursor will often be sent to the wrong place\n\tif ( !this.locked ) {\n\t\tif ( reset ) {\n\t\t\tif ( this.useProperty ) { this.node[ this.propertyName ] = false; }\n\t\t\tthis.node.removeAttribute( this.propertyName );\n\t\t} else {\n\t\t\tif ( this.useProperty ) {\n\t\t\t\tthis.node[ this.propertyName ] = this.getValue();\n\t\t\t} else {\n\t\t\t\tif ( this.getValue() ) {\n\t\t\t\t\tthis.node.setAttribute( this.propertyName, '' );\n\t\t\t\t} else {\n\t\t\t\t\tthis.node.removeAttribute( this.propertyName );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction updateAttribute ( reset ) {\n\tif ( reset ) { this.node.removeAttribute( this.name ); }\n\telse { this.node.setAttribute( this.name, safeToStringValue( this.getString() ) ); }\n}\n\nfunction updateNamespacedAttribute ( reset ) {\n\tif ( reset ) { this.node.removeAttributeNS( this.namespace, this.name.slice( this.name.indexOf( ':' ) + 1 ) ); }\n\telse { this.node.setAttributeNS( this.namespace, this.name.slice( this.name.indexOf( ':' ) + 1 ), safeToStringValue( this.getString() ) ); }\n}\n\nvar propertyNames = {\n\t'accept-charset': 'acceptCharset',\n\taccesskey: 'accessKey',\n\tbgcolor: 'bgColor',\n\tclass: 'className',\n\tcodebase: 'codeBase',\n\tcolspan: 'colSpan',\n\tcontenteditable: 'contentEditable',\n\tdatetime: 'dateTime',\n\tdirname: 'dirName',\n\tfor: 'htmlFor',\n\t'http-equiv': 'httpEquiv',\n\tismap: 'isMap',\n\tmaxlength: 'maxLength',\n\tnovalidate: 'noValidate',\n\tpubdate: 'pubDate',\n\treadonly: 'readOnly',\n\trowspan: 'rowSpan',\n\ttabindex: 'tabIndex',\n\tusemap: 'useMap'\n};\n\n// https://github.com/kangax/html-minifier/issues/63#issuecomment-37763316\nvar booleanAttributes = /^(allowFullscreen|async|autofocus|autoplay|checked|compact|controls|declare|default|defaultChecked|defaultMuted|defaultSelected|defer|disabled|enabled|formNoValidate|hidden|indeterminate|inert|isMap|itemScope|loop|multiple|muted|noHref|noResize|noShade|noValidate|noWrap|open|pauseOnExit|readOnly|required|reversed|scoped|seamless|selected|sortable|translate|trueSpeed|typeMustMatch|visible)$/i;\nvar voidElementNames = /^(?:area|base|br|col|command|doctype|embed|hr|img|input|keygen|link|meta|param|source|track|wbr)$/i;\n\nvar htmlEntities = { quot: 34, amp: 38, apos: 39, lt: 60, gt: 62, nbsp: 160, iexcl: 161, cent: 162, pound: 163, curren: 164, yen: 165, brvbar: 166, sect: 167, uml: 168, copy: 169, ordf: 170, laquo: 171, not: 172, shy: 173, reg: 174, macr: 175, deg: 176, plusmn: 177, sup2: 178, sup3: 179, acute: 180, micro: 181, para: 182, middot: 183, cedil: 184, sup1: 185, ordm: 186, raquo: 187, frac14: 188, frac12: 189, frac34: 190, iquest: 191, Agrave: 192, Aacute: 193, Acirc: 194, Atilde: 195, Auml: 196, Aring: 197, AElig: 198, Ccedil: 199, Egrave: 200, Eacute: 201, Ecirc: 202, Euml: 203, Igrave: 204, Iacute: 205, Icirc: 206, Iuml: 207, ETH: 208, Ntilde: 209, Ograve: 210, Oacute: 211, Ocirc: 212, Otilde: 213, Ouml: 214, times: 215, Oslash: 216, Ugrave: 217, Uacute: 218, Ucirc: 219, Uuml: 220, Yacute: 221, THORN: 222, szlig: 223, agrave: 224, aacute: 225, acirc: 226, atilde: 227, auml: 228, aring: 229, aelig: 230, ccedil: 231, egrave: 232, eacute: 233, ecirc: 234, euml: 235, igrave: 236, iacute: 237, icirc: 238, iuml: 239, eth: 240, ntilde: 241, ograve: 242, oacute: 243, ocirc: 244, otilde: 245, ouml: 246, divide: 247, oslash: 248, ugrave: 249, uacute: 250, ucirc: 251, uuml: 252, yacute: 253, thorn: 254, yuml: 255, OElig: 338, oelig: 339, Scaron: 352, scaron: 353, Yuml: 376, fnof: 402, circ: 710, tilde: 732, Alpha: 913, Beta: 914, Gamma: 915, Delta: 916, Epsilon: 917, Zeta: 918, Eta: 919, Theta: 920, Iota: 921, Kappa: 922, Lambda: 923, Mu: 924, Nu: 925, Xi: 926, Omicron: 927, Pi: 928, Rho: 929, Sigma: 931, Tau: 932, Upsilon: 933, Phi: 934, Chi: 935, Psi: 936, Omega: 937, alpha: 945, beta: 946, gamma: 947, delta: 948, epsilon: 949, zeta: 950, eta: 951, theta: 952, iota: 953, kappa: 954, lambda: 955, mu: 956, nu: 957, xi: 958, omicron: 959, pi: 960, rho: 961, sigmaf: 962, sigma: 963, tau: 964, upsilon: 965, phi: 966, chi: 967, psi: 968, omega: 969, thetasym: 977, upsih: 978, piv: 982, ensp: 8194, emsp: 8195, thinsp: 8201, zwnj: 8204, zwj: 8205, lrm: 8206, rlm: 8207, ndash: 8211, mdash: 8212, lsquo: 8216, rsquo: 8217, sbquo: 8218, ldquo: 8220, rdquo: 8221, bdquo: 8222, dagger: 8224, Dagger: 8225, bull: 8226, hellip: 8230, permil: 8240, prime: 8242, Prime: 8243, lsaquo: 8249, rsaquo: 8250, oline: 8254, frasl: 8260, euro: 8364, image: 8465, weierp: 8472, real: 8476, trade: 8482, alefsym: 8501, larr: 8592, uarr: 8593, rarr: 8594, darr: 8595, harr: 8596, crarr: 8629, lArr: 8656, uArr: 8657, rArr: 8658, dArr: 8659, hArr: 8660, forall: 8704, part: 8706, exist: 8707, empty: 8709, nabla: 8711, isin: 8712, notin: 8713, ni: 8715, prod: 8719, sum: 8721, minus: 8722, lowast: 8727, radic: 8730, prop: 8733, infin: 8734, ang: 8736, and: 8743, or: 8744, cap: 8745, cup: 8746, int: 8747, there4: 8756, sim: 8764, cong: 8773, asymp: 8776, ne: 8800, equiv: 8801, le: 8804, ge: 8805, sub: 8834, sup: 8835, nsub: 8836, sube: 8838, supe: 8839, oplus: 8853, otimes: 8855, perp: 8869, sdot: 8901, lceil: 8968, rceil: 8969, lfloor: 8970, rfloor: 8971, lang: 9001, rang: 9002, loz: 9674, spades: 9824, clubs: 9827, hearts: 9829, diams: 9830\t};\nvar controlCharacters = [ 8364, 129, 8218, 402, 8222, 8230, 8224, 8225, 710, 8240, 352, 8249, 338, 141, 381, 143, 144, 8216, 8217, 8220, 8221, 8226, 8211, 8212, 732, 8482, 353, 8250, 339, 157, 382, 376 ];\nvar entityPattern = new RegExp( '&(#?(?:x[\\\\w\\\\d]+|\\\\d+|' + Object.keys( htmlEntities ).join( '|' ) + '));?', 'g' );\nvar codePointSupport = typeof String.fromCodePoint === 'function';\nvar codeToChar = codePointSupport ? String.fromCodePoint : String.fromCharCode;\n\nfunction decodeCharacterReferences ( html ) {\n\treturn html.replace( entityPattern, function ( match, entity ) {\n\t\tvar code;\n\n\t\t// Handle named entities\n\t\tif ( entity[0] !== '#' ) {\n\t\t\tcode = htmlEntities[ entity ];\n\t\t} else if ( entity[1] === 'x' ) {\n\t\t\tcode = parseInt( entity.substring( 2 ), 16 );\n\t\t} else {\n\t\t\tcode = parseInt( entity.substring( 1 ), 10 );\n\t\t}\n\n\t\tif ( !code ) {\n\t\t\treturn match;\n\t\t}\n\n\t\treturn codeToChar( validateCode( code ) );\n\t});\n}\n\nvar lessThan = /</g;\nvar greaterThan = />/g;\nvar amp = /&/g;\nvar invalid = 65533;\n\nfunction escapeHtml ( str ) {\n\treturn str\n\t\t.replace( amp, '&amp;' )\n\t\t.replace( lessThan, '&lt;' )\n\t\t.replace( greaterThan, '&gt;' );\n}\n\n// some code points are verboten. If we were inserting HTML, the browser would replace the illegal\n// code points with alternatives in some cases - since we're bypassing that mechanism, we need\n// to replace them ourselves\n//\n// Source: http://en.wikipedia.org/wiki/Character_encodings_in_HTML#Illegal_characters\nfunction validateCode ( code ) {\n\tif ( !code ) {\n\t\treturn invalid;\n\t}\n\n\t// line feed becomes generic whitespace\n\tif ( code === 10 ) {\n\t\treturn 32;\n\t}\n\n\t// ASCII range. (Why someone would use HTML entities for ASCII characters I don't know, but...)\n\tif ( code < 128 ) {\n\t\treturn code;\n\t}\n\n\t// code points 128-159 are dealt with leniently by browsers, but they're incorrect. We need\n\t// to correct the mistake or we'll end up with missing € signs and so on\n\tif ( code <= 159 ) {\n\t\treturn controlCharacters[ code - 128 ];\n\t}\n\n\t// basic multilingual plane\n\tif ( code < 55296 ) {\n\t\treturn code;\n\t}\n\n\t// UTF-16 surrogate halves\n\tif ( code <= 57343 ) {\n\t\treturn invalid;\n\t}\n\n\t// rest of the basic multilingual plane\n\tif ( code <= 65535 ) {\n\t\treturn code;\n\t} else if ( !codePointSupport ) {\n\t\treturn invalid;\n\t}\n\n\t// supplementary multilingual plane 0x10000 - 0x1ffff\n\tif ( code >= 65536 && code <= 131071 ) {\n\t\treturn code;\n\t}\n\n\t// supplementary ideographic plane 0x20000 - 0x2ffff\n\tif ( code >= 131072 && code <= 196607 ) {\n\t\treturn code;\n\t}\n\n\treturn invalid;\n}\n\nfunction lookupNamespace ( node, prefix ) {\n\tvar qualified = \"xmlns:\" + prefix;\n\n\twhile ( node ) {\n\t\tif ( node.hasAttribute && node.hasAttribute( qualified ) ) { return node.getAttribute( qualified ); }\n\t\tnode = node.parentNode;\n\t}\n\n\treturn namespaces[ prefix ];\n}\n\nvar Attribute = (function (Item$$1) {\n\tfunction Attribute ( options ) {\n\t\tItem$$1.call( this, options );\n\n\t\tthis.name = options.template.n;\n\t\tthis.namespace = null;\n\n\t\tthis.owner = options.owner || options.parentFragment.owner || options.element || findElement( options.parentFragment );\n\t\tthis.element = options.element || (this.owner.attributeByName ? this.owner : findElement( options.parentFragment ) );\n\t\tthis.parentFragment = options.parentFragment; // shared\n\t\tthis.ractive = this.parentFragment.ractive;\n\n\t\tthis.rendered = false;\n\t\tthis.updateDelegate = null;\n\t\tthis.fragment = null;\n\n\t\tthis.element.attributeByName[ this.name ] = this;\n\n\t\tif ( !isArray( options.template.f ) ) {\n\t\t\tthis.value = options.template.f;\n\t\t\tif ( this.value === 0 ) {\n\t\t\t\tthis.value = '';\n\t\t\t}\n\t\t} else {\n\t\t\tthis.fragment = new Fragment({\n\t\t\t\towner: this,\n\t\t\t\ttemplate: options.template.f\n\t\t\t});\n\t\t}\n\n\t\tthis.interpolator = this.fragment &&\n\t\t\tthis.fragment.items.length === 1 &&\n\t\t\tthis.fragment.items[0].type === INTERPOLATOR &&\n\t\t\tthis.fragment.items[0];\n\n\t\tif ( this.interpolator ) { this.interpolator.owner = this; }\n\t}\n\n\tif ( Item$$1 ) Attribute.__proto__ = Item$$1;\n\tAttribute.prototype = Object.create( Item$$1 && Item$$1.prototype );\n\tAttribute.prototype.constructor = Attribute;\n\n\tAttribute.prototype.bind = function bind () {\n\t\tif ( this.fragment ) {\n\t\t\tthis.fragment.bind();\n\t\t}\n\t};\n\n\tAttribute.prototype.bubble = function bubble () {\n\t\tif ( !this.dirty ) {\n\t\t\tthis.parentFragment.bubble();\n\t\t\tthis.element.bubble();\n\t\t\tthis.dirty = true;\n\t\t}\n\t};\n\n\tAttribute.prototype.destroyed = function destroyed () {\n\t\tthis.updateDelegate( true );\n\t};\n\n\tAttribute.prototype.getString = function getString () {\n\t\treturn this.fragment ?\n\t\t\tthis.fragment.toString() :\n\t\t\tthis.value != null ? '' + this.value : '';\n\t};\n\n\t// TODO could getValue ever be called for a static attribute,\n\t// or can we assume that this.fragment exists?\n\tAttribute.prototype.getValue = function getValue () {\n\t\treturn this.fragment ? this.fragment.valueOf() : booleanAttributes.test( this.name ) ? true : this.value;\n\t};\n\n\tAttribute.prototype.render = function render () {\n\t\tvar node = this.element.node;\n\t\tthis.node = node;\n\n\t\t// should we use direct property access, or setAttribute?\n\t\tif ( !node.namespaceURI || node.namespaceURI === namespaces.html ) {\n\t\t\tthis.propertyName = propertyNames[ this.name ] || this.name;\n\n\t\t\tif ( node[ this.propertyName ] !== undefined ) {\n\t\t\t\tthis.useProperty = true;\n\t\t\t}\n\n\t\t\t// is attribute a boolean attribute or 'value'? If so we're better off doing e.g.\n\t\t\t// node.selected = true rather than node.setAttribute( 'selected', '' )\n\t\t\tif ( booleanAttributes.test( this.name ) || this.isTwoway ) {\n\t\t\t\tthis.isBoolean = true;\n\t\t\t}\n\n\t\t\tif ( this.propertyName === 'value' ) {\n\t\t\t\tnode._ractive.value = this.value;\n\t\t\t}\n\t\t}\n\n\t\tif ( node.namespaceURI ) {\n\t\t\tvar index = this.name.indexOf( ':' );\n\t\t\tif ( index !== -1 ) {\n\t\t\t\tthis.namespace = lookupNamespace( node, this.name.slice( 0, index ) );\n\t\t\t} else {\n\t\t\t\tthis.namespace = node.namespaceURI;\n\t\t\t}\n\t\t}\n\n\t\tthis.rendered = true;\n\t\tthis.updateDelegate = getUpdateDelegate( this );\n\t\tthis.updateDelegate();\n\t};\n\n\tAttribute.prototype.toString = function toString () {\n\t\tvar value = this.getValue();\n\n\t\t// Special case - select and textarea values (should not be stringified)\n\t\tif ( this.name === 'value' && ( this.element.getAttribute( 'contenteditable' ) !== undefined || ( this.element.name === 'select' || this.element.name === 'textarea' ) ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Special case – bound radio `name` attributes\n\t\tif ( this.name === 'name' && this.element.name === 'input' && this.interpolator && this.element.getAttribute( 'type' ) === 'radio' ) {\n\t\t\treturn (\"name=\\\"{{\" + (this.interpolator.model.getKeypath()) + \"}}\\\"\");\n\t\t}\n\n\t\t// Special case - style and class attributes and directives\n\t\tif ( this.owner === this.element && ( this.name === 'style' || this.name === 'class' || this.styleName || this.inlineClass ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( !this.rendered && this.owner === this.element && ( !this.name.indexOf( 'style-' ) || !this.name.indexOf( 'class-' ) ) ) {\n\t\t\tif ( !this.name.indexOf( 'style-' ) ) {\n\t\t\t\tthis.styleName = camelize( this.name.substr( 6 ) );\n\t\t\t} else {\n\t\t\t\tthis.inlineClass = this.name.substr( 6 );\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tif ( booleanAttributes.test( this.name ) ) { return value ? this.name : ''; }\n\t\tif ( value == null ) { return ''; }\n\n\t\tvar str = safeAttributeString( this.getString() );\n\t\treturn str ?\n\t\t\t((this.name) + \"=\\\"\" + str + \"\\\"\") :\n\t\t\tthis.name;\n\t};\n\n\tAttribute.prototype.unbind = function unbind () {\n\t\tif ( this.fragment ) { this.fragment.unbind(); }\n\t};\n\n\tAttribute.prototype.unrender = function unrender () {\n\t\tthis.updateDelegate( true );\n\n\t\tthis.rendered = false;\n\t};\n\n\tAttribute.prototype.update = function update () {\n\t\tif ( this.dirty ) {\n\t\t\tthis.dirty = false;\n\t\t\tif ( this.fragment ) { this.fragment.update(); }\n\t\t\tif ( this.rendered ) { this.updateDelegate(); }\n\t\t\tif ( this.isTwoway && !this.locked ) {\n\t\t\t\tthis.interpolator.twowayBinding.lastVal( true, this.interpolator.model.get() );\n\t\t\t}\n\t\t}\n\t};\n\n\treturn Attribute;\n}(Item));\n\nvar BindingFlag = (function (Item$$1) {\n\tfunction BindingFlag ( options ) {\n\t\tItem$$1.call( this, options );\n\n\t\tthis.owner = options.owner || options.parentFragment.owner || findElement( options.parentFragment );\n\t\tthis.element = this.owner.attributeByName ? this.owner : findElement( options.parentFragment );\n\t\tthis.flag = options.template.v === 'l' ? 'lazy' : 'twoway';\n\n\t\tif ( this.element.type === ELEMENT ) {\n\t\t\tif ( isArray( options.template.f ) ) {\n\t\t\t\tthis.fragment = new Fragment({\n\t\t\t\t\towner: this,\n\t\t\t\t\ttemplate: options.template.f\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.interpolator = this.fragment &&\n\t\t\t\t\t\t\t\tthis.fragment.items.length === 1 &&\n\t\t\t\t\t\t\t\tthis.fragment.items[0].type === INTERPOLATOR &&\n\t\t\t\t\t\t\t\tthis.fragment.items[0];\n\t\t}\n\t}\n\n\tif ( Item$$1 ) BindingFlag.__proto__ = Item$$1;\n\tBindingFlag.prototype = Object.create( Item$$1 && Item$$1.prototype );\n\tBindingFlag.prototype.constructor = BindingFlag;\n\n\tBindingFlag.prototype.bind = function bind () {\n\t\tif ( this.fragment ) { this.fragment.bind(); }\n\t\tset$3( this, this.getValue(), true );\n\t};\n\n\tBindingFlag.prototype.bubble = function bubble () {\n\t\tif ( !this.dirty ) {\n\t\t\tthis.element.bubble();\n\t\t\tthis.dirty = true;\n\t\t}\n\t};\n\n\tBindingFlag.prototype.getValue = function getValue () {\n\t\tif ( this.fragment ) { return this.fragment.valueOf(); }\n\t\telse if ( 'value' in this ) { return this.value; }\n\t\telse if ( 'f' in this.template ) { return this.template.f; }\n\t\telse { return true; }\n\t};\n\n\tBindingFlag.prototype.render = function render () {\n\t\tset$3( this, this.getValue(), true );\n\t};\n\n\tBindingFlag.prototype.toString = function toString () { return ''; };\n\n\tBindingFlag.prototype.unbind = function unbind () {\n\t\tif ( this.fragment ) { this.fragment.unbind(); }\n\n\t\tdelete this.element[ this.flag ];\n\t};\n\n\tBindingFlag.prototype.unrender = function unrender () {\n\t\tif ( this.element.rendered ) { this.element.recreateTwowayBinding(); }\n\t};\n\n\tBindingFlag.prototype.update = function update () {\n\t\tif ( this.dirty ) {\n\t\t\tif ( this.fragment ) { this.fragment.update(); }\n\t\t\tset$3( this, this.getValue(), true );\n\t\t}\n\t};\n\n\treturn BindingFlag;\n}(Item));\n\nfunction set$3 ( flag, value, update ) {\n\tif ( value === 0 ) {\n\t\tflag.value = true;\n\t} else if ( value === 'true' ) {\n\t\tflag.value = true;\n\t} else if ( value === 'false' || value === '0' ) {\n\t\tflag.value = false;\n\t} else {\n\t\tflag.value = value;\n\t}\n\n\tvar current = flag.element[ flag.flag ];\n\tflag.element[ flag.flag ] = flag.value;\n\tif ( update && !flag.element.attributes.binding && current !== flag.value ) {\n\t\tflag.element.recreateTwowayBinding();\n\t}\n\n\treturn flag.value;\n}\n\nvar div$1 = doc ? createElement( 'div' ) : null;\n\nvar attributes = false;\nfunction inAttributes() { return attributes; }\nfunction doInAttributes( fn ) {\n\tattributes = true;\n\tfn();\n\tattributes = false;\n}\n\nvar ConditionalAttribute = (function (Item$$1) {\n\tfunction ConditionalAttribute ( options ) {\n\t\tItem$$1.call( this, options );\n\n\t\tthis.attributes = [];\n\n\t\tthis.owner = options.owner;\n\n\t\tthis.fragment = new Fragment({\n\t\t\tractive: this.ractive,\n\t\t\towner: this,\n\t\t\ttemplate: this.template\n\t\t});\n\t\t// this fragment can't participate in node-y things\n\t\tthis.fragment.findNextNode = noop;\n\n\t\tthis.dirty = false;\n\t}\n\n\tif ( Item$$1 ) ConditionalAttribute.__proto__ = Item$$1;\n\tConditionalAttribute.prototype = Object.create( Item$$1 && Item$$1.prototype );\n\tConditionalAttribute.prototype.constructor = ConditionalAttribute;\n\n\tConditionalAttribute.prototype.bind = function bind () {\n\t\tthis.fragment.bind();\n\t};\n\n\tConditionalAttribute.prototype.bubble = function bubble () {\n\t\tif ( !this.dirty ) {\n\t\t\tthis.dirty = true;\n\t\t\tthis.owner.bubble();\n\t\t}\n\t};\n\n\tConditionalAttribute.prototype.render = function render () {\n\t\tthis.node = this.owner.node;\n\t\tif ( this.node ) {\n\t\t\tthis.isSvg = this.node.namespaceURI === svg$1;\n\t\t}\n\n\t\tattributes = true;\n\t\tif ( !this.rendered ) { this.fragment.render(); }\n\t\tattributes = false;\n\n\t\tthis.rendered = true;\n\t\tthis.dirty = true; // TODO this seems hacky, but necessary for tests to pass in browser AND node.js\n\t\tthis.update();\n\t};\n\n\tConditionalAttribute.prototype.toString = function toString () {\n\t\treturn this.fragment.toString();\n\t};\n\n\tConditionalAttribute.prototype.unbind = function unbind () {\n\t\tthis.fragment.unbind();\n\t};\n\n\tConditionalAttribute.prototype.unrender = function unrender () {\n\t\tthis.rendered = false;\n\t\tthis.fragment.unrender();\n\t};\n\n\tConditionalAttribute.prototype.update = function update () {\n\t\tvar this$1 = this;\n\n\t\tvar str;\n\t\tvar attrs;\n\n\t\tif ( this.dirty ) {\n\t\t\tthis.dirty = false;\n\n\t\t\tattributes = true;\n\t\t\tthis.fragment.update();\n\t\t\tattributes = false;\n\n\t\t\tif ( this.rendered && this.node ) {\n\t\t\t\tstr = this.fragment.toString();\n\t\t\t\tattrs = parseAttributes( str, this.isSvg );\n\n\t\t\t\t// any attributes that previously existed but no longer do\n\t\t\t\t// must be removed\n\t\t\t\tthis.attributes.filter( function (a) { return notIn( attrs, a ); } ).forEach( function (a) {\n\t\t\t\t\tthis$1.node.removeAttribute( a.name );\n\t\t\t\t});\n\n\t\t\t\tattrs.forEach( function (a) {\n\t\t\t\t\tthis$1.node.setAttribute( a.name, a.value );\n\t\t\t\t});\n\n\t\t\t\tthis.attributes = attrs;\n\t\t\t}\n\t\t}\n\t};\n\n\treturn ConditionalAttribute;\n}(Item));\n\nfunction parseAttributes ( str, isSvg ) {\n\tvar tagName = isSvg ? 'svg' : 'div';\n\treturn str\n\t\t? (div$1.innerHTML = \"<\" + tagName + \" \" + str + \"></\" + tagName + \">\") &&\n\t\t\ttoArray(div$1.childNodes[0].attributes)\n\t\t: [];\n}\n\nfunction notIn ( haystack, needle ) {\n\tvar i = haystack.length;\n\n\twhile ( i-- ) {\n\t\tif ( haystack[i].name === needle.name ) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn true;\n}\n\nvar processWrapper = function ( wrapper, array, methodName, newIndices ) {\n\tvar __model = wrapper.__model;\n\n\tif ( newIndices ) {\n\t\t__model.shuffle( newIndices );\n\t} else {\n\t\t// If this is a sort or reverse, we just do root.set()...\n\t\t// TODO use merge logic?\n\t\t//root.viewmodel.mark( keypath );\n\t}\n};\n\nvar mutatorMethods = [ 'pop', 'push', 'reverse', 'shift', 'sort', 'splice', 'unshift' ];\nvar patchedArrayProto = [];\n\nmutatorMethods.forEach( function (methodName) {\n\tvar method = function () {\n\t\tvar this$1 = this;\n\t\tvar args = [], len = arguments.length;\n\t\twhile ( len-- ) args[ len ] = arguments[ len ];\n\n\t\tvar newIndices = getNewIndices( this.length, methodName, args );\n\n\t\t// lock any magic array wrappers, so that things don't get fudged\n\t\tthis._ractive.wrappers.forEach( function (r) { if ( r.magic ) { r.magic.locked = true; } } );\n\n\t\t// apply the underlying method\n\t\tvar result = Array.prototype[ methodName ].apply( this, arguments );\n\n\t\t// trigger changes\n\t\trunloop.start();\n\n\t\tthis._ractive.setting = true;\n\t\tvar i = this._ractive.wrappers.length;\n\t\twhile ( i-- ) {\n\t\t\tprocessWrapper( this$1._ractive.wrappers[i], this$1, methodName, newIndices );\n\t\t}\n\n\t\trunloop.end();\n\n\t\tthis._ractive.setting = false;\n\n\t\t// unlock the magic arrays... magic... bah\n\t\tthis._ractive.wrappers.forEach( function (r) { if ( r.magic ) { r.magic.locked = false; } } );\n\n\t\treturn result;\n\t};\n\n\tdefineProperty( patchedArrayProto, methodName, {\n\t\tvalue: method,\n\t\tconfigurable: true\n\t});\n});\n\nvar patchArrayMethods;\nvar unpatchArrayMethods;\n\n// can we use prototype chain injection?\n// http://perfectionkills.com/how-ecmascript-5-still-does-not-allow-to-subclass-an-array/#wrappers_prototype_chain_injection\nif ( ({}).__proto__ ) {\n\t// yes, we can\n\tpatchArrayMethods = function (array) { return array.__proto__ = patchedArrayProto; };\n\tunpatchArrayMethods = function (array) { return array.__proto__ = Array.prototype; };\n}\n\nelse {\n\t// no, we can't\n\tpatchArrayMethods = function (array) {\n\t\tvar i = mutatorMethods.length;\n\t\twhile ( i-- ) {\n\t\t\tvar methodName = mutatorMethods[i];\n\t\t\tdefineProperty( array, methodName, {\n\t\t\t\tvalue: patchedArrayProto[ methodName ],\n\t\t\t\tconfigurable: true\n\t\t\t});\n\t\t}\n\t};\n\n\tunpatchArrayMethods = function (array) {\n\t\tvar i = mutatorMethods.length;\n\t\twhile ( i-- ) {\n\t\t\tdelete array[ mutatorMethods[i] ];\n\t\t}\n\t};\n}\n\npatchArrayMethods.unpatch = unpatchArrayMethods; // TODO export separately?\nvar patch = patchArrayMethods;\n\nvar errorMessage$1 = 'Something went wrong in a rather interesting way';\n\nvar arrayAdaptor = {\n\tfilter: function filter ( object ) {\n\t\t// wrap the array if a) b) it's an array, and b) either it hasn't been wrapped already,\n\t\t// or the array didn't trigger the get() itself\n\t\treturn isArray( object ) && ( !object._ractive || !object._ractive.setting );\n\t},\n\twrap: function wrap ( ractive, array, keypath ) {\n\t\treturn new ArrayWrapper( ractive, array, keypath );\n\t}\n};\n\nvar ArrayWrapper = function ArrayWrapper ( ractive, array ) {\n\tthis.root = ractive;\n\tthis.value = array;\n\tthis.__model = null; // filled in later\n\n\t// if this array hasn't already been ractified, ractify it\n\tif ( !array._ractive ) {\n\t\t// define a non-enumerable _ractive property to store the wrappers\n\t\tdefineProperty( array, '_ractive', {\n\t\t\tvalue: {\n\t\t\t\twrappers: [],\n\t\t\t\tinstances: [],\n\t\t\t\tsetting: false\n\t\t\t},\n\t\t\tconfigurable: true\n\t\t});\n\n\t\tpatch( array );\n\t}\n\n\t// store the ractive instance, so we can handle transitions later\n\tif ( !array._ractive.instances[ ractive._guid ] ) {\n\t\tarray._ractive.instances[ ractive._guid ] = 0;\n\t\tarray._ractive.instances.push( ractive );\n\t}\n\n\tarray._ractive.instances[ ractive._guid ] += 1;\n\tarray._ractive.wrappers.push( this );\n};\n\nArrayWrapper.prototype.get = function get () {\n\treturn this.value;\n};\n\nArrayWrapper.prototype.reset = function reset ( value ) {\n\treturn this.value === value;\n};\n\nArrayWrapper.prototype.teardown = function teardown () {\n\tvar array = this.value;\n\tvar storage = array._ractive;\n\tvar wrappers = storage.wrappers;\n\tvar instances = storage.instances;\n\n\t// if teardown() was invoked because we're clearing the cache as a result of\n\t// a change that the array itself triggered, we can save ourselves the teardown\n\t// and immediate setup\n\tif ( storage.setting ) {\n\t\treturn false; // so that we don't remove it from cached wrappers\n\t}\n\n\tvar index = wrappers.indexOf( this );\n\tif ( index === -1 ) {\n\t\tthrow new Error( errorMessage$1 );\n\t}\n\n\twrappers.splice( index, 1 );\n\n\t// if nothing else depends on this array, we can revert it to its\n\t// natural state\n\tif ( !wrappers.length ) {\n\t\tdelete array._ractive;\n\t\tpatch.unpatch( this.value );\n\t}\n\n\telse {\n\t\t// remove ractive instance if possible\n\t\tinstances[ this.root._guid ] -= 1;\n\t\tif ( !instances[ this.root._guid ] ) {\n\t\t\tindex = instances.indexOf( this.root );\n\n\t\t\tif ( index === -1 ) {\n\t\t\t\tthrow new Error( errorMessage$1 );\n\t\t\t}\n\n\t\t\tinstances.splice( index, 1 );\n\t\t}\n\t}\n};\n\nvar magicAdaptor;\n\ntry {\n\tObject.defineProperty({}, 'test', { get: function get() {}, set: function set() {} });\n\n\tmagicAdaptor = {\n\t\tfilter: function filter ( value ) {\n\t\t\treturn value && typeof value === 'object';\n\t\t},\n\t\twrap: function wrap ( ractive, value, keypath ) {\n\t\t\treturn new MagicWrapper( ractive, value, keypath );\n\t\t}\n\t};\n} catch ( err ) {\n\tmagicAdaptor = false;\n}\n\nvar magicAdaptor$1 = magicAdaptor;\n\nfunction createOrWrapDescriptor ( originalDescriptor, ractive, keypath, wrapper ) {\n\tif ( originalDescriptor.set && originalDescriptor.set.__magic ) {\n\t\toriginalDescriptor.set.__magic.dependants.push({ ractive: ractive, keypath: keypath });\n\t\treturn originalDescriptor;\n\t}\n\n\tvar setting;\n\n\tvar dependants = [{ ractive: ractive, keypath: keypath }];\n\n\tvar descriptor = {\n\t\tget: function get () {\n\t\t\treturn 'value' in originalDescriptor ? originalDescriptor.value : originalDescriptor.get.call( this );\n\t\t},\n\t\tset: function set (value) {\n\t\t\tif ( setting ) { return; }\n\n\t\t\tif ( 'value' in originalDescriptor ) {\n\t\t\t\toriginalDescriptor.value = value;\n\t\t\t} else {\n\t\t\t\toriginalDescriptor.set.call( this, value );\n\t\t\t}\n\n\t\t\tif ( wrapper.locked ) { return; }\n\t\t\tsetting = true;\n\t\t\tdependants.forEach( function (ref) {\n\t\t\t\tvar ractive = ref.ractive;\n\t\t\t\tvar keypath = ref.keypath;\n\n\t\t\t\tractive.set( keypath, value );\n\t\t\t});\n\t\t\tsetting = false;\n\t\t},\n\t\tenumerable: true\n\t};\n\n\tdescriptor.set.__magic = { dependants: dependants, originalDescriptor: originalDescriptor };\n\n\treturn descriptor;\n}\n\nfunction revert ( descriptor, ractive, keypath ) {\n\tif ( !descriptor.set || !descriptor.set.__magic ) { return true; }\n\n\tvar dependants = descriptor.set.__magic;\n\tvar i = dependants.length;\n\twhile ( i-- ) {\n\t\tvar dependant = dependants[i];\n\t\tif ( dependant.ractive === ractive && dependant.keypath === keypath ) {\n\t\t\tdependants.splice( i, 1 );\n\t\t\treturn false;\n\t\t}\n\t}\n}\n\nvar MagicWrapper = function MagicWrapper ( ractive, value, keypath ) {\n\tvar this$1 = this;\n\n\tthis.ractive = ractive;\n\tthis.value = value;\n\tthis.keypath = keypath;\n\n\tthis.originalDescriptors = {};\n\n\t// wrap all properties with getters\n\tObject.keys( value ).forEach( function (key) {\n\t\tvar originalDescriptor = Object.getOwnPropertyDescriptor( this$1.value, key );\n\t\tthis$1.originalDescriptors[ key ] = originalDescriptor;\n\n\t\tvar childKeypath = keypath ? (keypath + \".\" + (escapeKey( key ))) : escapeKey( key );\n\n\t\tvar descriptor = createOrWrapDescriptor( originalDescriptor, ractive, childKeypath, this$1 );\n\n\n\n\t\tObject.defineProperty( this$1.value, key, descriptor );\n\t});\n};\n\nMagicWrapper.prototype.get = function get () {\n\treturn this.value;\n};\n\nMagicWrapper.prototype.reset = function reset ( value ) {\n\treturn this.value === value;\n};\n\nMagicWrapper.prototype.set = function set ( key, value ) {\n\tthis.value[ key ] = value;\n};\n\nMagicWrapper.prototype.teardown = function teardown () {\n\t\tvar this$1 = this;\n\n\tObject.keys( this.value ).forEach( function (key) {\n\t\tvar descriptor = Object.getOwnPropertyDescriptor( this$1.value, key );\n\t\tif ( !descriptor.set || !descriptor.set.__magic ) { return; }\n\n\t\trevert( descriptor );\n\n\t\tif ( descriptor.set.__magic.dependants.length === 1 ) {\n\t\t\tObject.defineProperty( this$1.value, key, descriptor.set.__magic.originalDescriptor );\n\t\t}\n\t});\n};\n\nvar MagicArrayWrapper = function MagicArrayWrapper ( ractive, array, keypath ) {\n\tthis.value = array;\n\n\tthis.magic = true;\n\n\tthis.magicWrapper = magicAdaptor$1.wrap( ractive, array, keypath );\n\tthis.arrayWrapper = arrayAdaptor.wrap( ractive, array, keypath );\n\tthis.arrayWrapper.magic = this.magicWrapper;\n\n\t// ugh, this really is a terrible hack\n\tObject.defineProperty( this, '__model', {\n\t\tget: function get () {\n\t\t\treturn this.arrayWrapper.__model;\n\t\t},\n\t\tset: function set ( model ) {\n\t\t\tthis.arrayWrapper.__model = model;\n\t\t}\n\t});\n};\n\nMagicArrayWrapper.prototype.get = function get () {\n\treturn this.value;\n};\n\nMagicArrayWrapper.prototype.teardown = function teardown () {\n\tthis.arrayWrapper.teardown();\n\tthis.magicWrapper.teardown();\n};\n\nMagicArrayWrapper.prototype.reset = function reset ( value ) {\n\treturn this.arrayWrapper.reset( value ) && this.magicWrapper.reset( value );\n};\n\nvar magicArrayAdaptor = {\n\tfilter: function filter ( object, keypath, ractive ) {\n\t\treturn magicAdaptor$1.filter( object, keypath, ractive ) && arrayAdaptor.filter( object );\n\t},\n\n\twrap: function wrap ( ractive, array, keypath ) {\n\t\treturn new MagicArrayWrapper( ractive, array, keypath );\n\t}\n};\n\nvar RactiveModel = (function (Model$$1) {\n\tfunction RactiveModel ( ractive ) {\n\t\tModel$$1.call( this, null, '' );\n\t\tthis.value = ractive;\n\t\tthis.isRoot = true;\n\t\tthis.root = this;\n\t\tthis.adaptors = [];\n\t\tthis.ractive = ractive;\n\t\tthis.changes = {};\n\t}\n\n\tif ( Model$$1 ) RactiveModel.__proto__ = Model$$1;\n\tRactiveModel.prototype = Object.create( Model$$1 && Model$$1.prototype );\n\tRactiveModel.prototype.constructor = RactiveModel;\n\n\tRactiveModel.prototype.joinKey = function joinKey ( key ) {\n\t\tvar model = Model$$1.prototype.joinKey.call( this, key );\n\n\t\tif ( ( key === 'root' || key === 'parent' ) && !model.isLink ) { return initLink( model, key ); }\n\t\telse if ( key === 'data' ) { return this.ractive.viewmodel; }\n\n\t\treturn model;\n\t};\n\n\tRactiveModel.prototype.getKeypath = function getKeypath () {\n\t\treturn '@this';\n\t};\n\n\tRactiveModel.prototype.retrieve = function retrieve () {\n\t\treturn this.ractive;\n\t};\n\n\treturn RactiveModel;\n}(Model));\n\nfunction initLink ( model, key ) {\n\tmodel.applyValue = function ( value ) {\n\t\tthis.parent.value[ key ] = value;\n\t\tif ( value && value.viewmodel ) {\n\t\t\tthis.link( value.viewmodel.getRactiveModel(), key );\n\t\t\tthis._link.markedAll();\n\t\t} else {\n\t\t\tthis.link( Object.create( Missing ), key );\n\t\t\tthis._link.markedAll();\n\t\t}\n\t};\n\n\tmodel.applyValue( model.parent.ractive[ key ], key );\n\tmodel._link.set = function (v) { return model.applyValue( v ); };\n\tmodel._link.applyValue = function (v) { return model.applyValue( v ); };\n\treturn model._link;\n}\n\nvar hasProp$1 = Object.prototype.hasOwnProperty;\n\nvar RootModel = (function (Model$$1) {\n\tfunction RootModel ( options ) {\n\t\tModel$$1.call( this, null, null );\n\n\t\t// TODO deprecate this\n\t\tthis.changes = {};\n\n\t\tthis.isRoot = true;\n\t\tthis.root = this;\n\t\tthis.ractive = options.ractive; // TODO sever this link\n\n\t\tthis.value = options.data;\n\t\tthis.adaptors = options.adapt;\n\t\tthis.adapt();\n\n\t\tthis.computationContext = options.ractive;\n\t\tthis.computations = {};\n\t}\n\n\tif ( Model$$1 ) RootModel.__proto__ = Model$$1;\n\tRootModel.prototype = Object.create( Model$$1 && Model$$1.prototype );\n\tRootModel.prototype.constructor = RootModel;\n\n\tRootModel.prototype.applyChanges = function applyChanges () {\n\t\tthis._changeHash = {};\n\t\tthis.flush();\n\n\t\treturn this._changeHash;\n\t};\n\n\tRootModel.prototype.attached = function attached ( fragment ) {\n\t\tattachImplicits( this, fragment );\n\t};\n\n\tRootModel.prototype.compute = function compute ( key, signature ) {\n\t\tvar computation = new Computation( this, signature, key );\n\t\tthis.computations[ key ] = computation;\n\n\t\treturn computation;\n\t};\n\n\tRootModel.prototype.createLink = function createLink ( keypath, target, targetPath, options ) {\n\t\tvar this$1 = this;\n\n\t\tvar keys = splitKeypath( keypath );\n\n\t\tvar model = this;\n\t\twhile ( keys.length ) {\n\t\t\tvar key = keys.shift();\n\t\t\tmodel = this$1.childByKey[ key ] || this$1.joinKey( key );\n\t\t}\n\n\t\treturn model.link( target, targetPath, options );\n\t};\n\n\tRootModel.prototype.detached = function detached () {\n\t\tdetachImplicits( this );\n\t};\n\n\tRootModel.prototype.get = function get ( shouldCapture, options ) {\n\t\tvar this$1 = this;\n\n\t\tif ( shouldCapture ) { capture( this ); }\n\n\t\tif ( !options || options.virtual !== false ) {\n\t\t\tvar result = this.getVirtual();\n\t\t\tvar keys = Object.keys( this.computations );\n\t\t\tvar i = keys.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tresult[ keys[i] ] = this$1.computations[ keys[i] ].get();\n\t\t\t}\n\n\t\t\treturn result;\n\t\t} else {\n\t\t\treturn this.value;\n\t\t}\n\t};\n\n\tRootModel.prototype.getKeypath = function getKeypath () {\n\t\treturn '';\n\t};\n\n\tRootModel.prototype.getRactiveModel = function getRactiveModel () {\n\t\treturn this.ractiveModel || ( this.ractiveModel = new RactiveModel( this.ractive ) );\n\t};\n\n\tRootModel.prototype.getValueChildren = function getValueChildren () {\n\t\tvar this$1 = this;\n\n\t\tvar children = Model$$1.prototype.getValueChildren.call( this, this.value );\n\n\t\tthis.children.forEach( function (child) {\n\t\t\tif ( child._link ) {\n\t\t\t\tvar idx = children.indexOf( child );\n\t\t\t\tif ( ~idx ) { children.splice( idx, 1, child._link ); }\n\t\t\t\telse { children.push( child._link ); }\n\t\t\t}\n\t\t});\n\n\t\tfor ( var k in this.computations ) {\n\t\t\tchildren.push( this$1.computations[k] );\n\t\t}\n\n\t\treturn children;\n\t};\n\n\tRootModel.prototype.handleChange = function handleChange$1 () {\n\t\tthis.deps.forEach( handleChange$1$1 );\n\t};\n\n\tRootModel.prototype.has = function has ( key ) {\n\t\tvar value = this.value;\n\n\t\tkey = unescapeKey( key );\n\t\tif ( key === '@this' || key === '@global' || key === '@shared' ) { return true; }\n\t\tif ( key[0] === '~' && key[1] === '/' ) { key = key.slice( 2 ); }\n\t\tif ( hasProp$1.call( value, key ) ) { return true; }\n\n\t\t// mappings/links and computations\n\t\tif ( key in this.computations || this.childByKey[key] && this.childByKey[key]._link ) { return true; }\n\n\t\t// We climb up the constructor chain to find if one of them contains the key\n\t\tvar constructor = value.constructor;\n\t\twhile ( constructor !== Function && constructor !== Array && constructor !== Object ) {\n\t\t\tif ( hasProp$1.call( constructor.prototype, key ) ) { return true; }\n\t\t\tconstructor = constructor.constructor;\n\t\t}\n\n\t\treturn false;\n\t};\n\n\tRootModel.prototype.joinKey = function joinKey ( key, opts ) {\n\t\tif ( key[0] === '@' ) {\n\t\t\tif ( key === '@this' || key === '@' ) { return this.getRactiveModel(); }\n\t\t\tif ( key === '@global' ) { return GlobalModel; }\n\t\t\tif ( key === '@shared' ) { return SharedModel$1; }\n\t\t\treturn;\n\t\t}\n\n\t\tif ( key[0] === '~' && key[1] === '/' ) { key = key.slice( 2 ); }\n\n\t\treturn this.computations.hasOwnProperty( key ) ? this.computations[ key ] :\n\t\t       Model$$1.prototype.joinKey.call( this, key, opts );\n\t};\n\n\t// TODO: this should go away\n\tRootModel.prototype.map = function map ( localKey, origin, options ) {\n\t\tvar local = this.joinKey( localKey );\n\t\tlocal.link( origin, localKey, options );\n\t};\n\n\tRootModel.prototype.rebinding = function rebinding () {\n\t};\n\n\tRootModel.prototype.set = function set ( value ) {\n\t\t// TODO wrapping root node is a baaaad idea. We should prevent this\n\t\tvar wrapper = this.wrapper;\n\t\tif ( wrapper ) {\n\t\t\tvar shouldTeardown = !wrapper.reset || wrapper.reset( value ) === false;\n\n\t\t\tif ( shouldTeardown ) {\n\t\t\t\twrapper.teardown();\n\t\t\t\tthis.wrapper = null;\n\t\t\t\tthis.value = value;\n\t\t\t\tthis.adapt();\n\t\t\t}\n\t\t} else {\n\t\t\tthis.value = value;\n\t\t\tthis.adapt();\n\t\t}\n\n\t\tthis.deps.forEach( handleChange$1$1 );\n\t\tthis.children.forEach( mark$1$1 );\n\t\tthis.clearUnresolveds(); // TODO do we need to do this with primitive values? if not, what about e.g. unresolved `length` property of null -> string?\n\t};\n\n\tRootModel.prototype.retrieve = function retrieve () {\n\t\treturn this.wrapper ? this.wrapper.get() : this.value;\n\t};\n\n\tRootModel.prototype.update = function update () {\n\t\t// noop\n\t};\n\n\treturn RootModel;\n}(Model));\n\nfunction attachImplicits ( model, fragment ) {\n\tif ( model._link && model._link.implicit && model._link.isDetached() ) {\n\t\tmodel.attach( fragment );\n\t}\n\n\t// look for unresolveds\n\tvar i = model.unresolved.length;\n\twhile ( i-- ) {\n\t\tvar mdl = resolveReference( fragment, model.unresolved[i] );\n\t\tif ( mdl ) {\n\t\t\tmodel.joinKey( mdl.key ).link( mdl, mdl.key, { implicit: true } );\n\t\t}\n\t}\n\n\t// look for virtual children to relink and cascade\n\tfor ( var k in model.childByKey ) {\n\t\tif ( k in model.value ) {\n\t\t\tattachImplicits( model.childByKey[k], fragment );\n\t\t} else if ( !model.childByKey[k]._link || model.childByKey[k]._link.isDetached() ) {\n\t\t\tvar mdl$1 = resolveReference( fragment, k );\n\t\t\tif ( mdl$1 ) {\n\t\t\t\tmodel.childByKey[k].link( mdl$1, k, { implicit: true } );\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction detachImplicits ( model ) {\n\tif ( model._link && model._link.implicit ) {\n\t\tmodel.unlink();\n\t}\n\n\tfor ( var k in model.childByKey ) {\n\t\tdetachImplicits( model.childByKey[k] );\n\t}\n}\n\nfunction getComputationSignature ( ractive, key, signature ) {\n\tvar getter;\n\tvar setter;\n\n\t// useful for debugging\n\tvar getterString;\n\tvar getterUseStack;\n\tvar setterString;\n\n\tif ( typeof signature === 'function' ) {\n\t\tgetter = bind$2( signature, ractive );\n\t\tgetterString = signature.toString();\n\t\tgetterUseStack = true;\n\t}\n\n\tif ( typeof signature === 'string' ) {\n\t\tgetter = createFunctionFromString( signature, ractive );\n\t\tgetterString = signature;\n\t}\n\n\tif ( typeof signature === 'object' ) {\n\t\tif ( typeof signature.get === 'string' ) {\n\t\t\tgetter = createFunctionFromString( signature.get, ractive );\n\t\t\tgetterString = signature.get;\n\t\t} else if ( typeof signature.get === 'function' ) {\n\t\t\tgetter = bind$2( signature.get, ractive );\n\t\t\tgetterString = signature.get.toString();\n\t\t\tgetterUseStack = true;\n\t\t} else {\n\t\t\tfatal( '`%s` computation must have a `get()` method', key );\n\t\t}\n\n\t\tif ( typeof signature.set === 'function' ) {\n\t\t\tsetter = bind$2( signature.set, ractive );\n\t\t\tsetterString = signature.set.toString();\n\t\t}\n\t}\n\n\treturn {\n\t\tgetter: getter,\n\t\tsetter: setter,\n\t\tgetterString: getterString,\n\t\tsetterString: setterString,\n\t\tgetterUseStack: getterUseStack\n\t};\n}\n\nvar constructHook = new Hook( 'construct' );\n\nvar registryNames$1 = [\n\t'adaptors',\n\t'components',\n\t'decorators',\n\t'easing',\n\t'events',\n\t'interpolators',\n\t'partials',\n\t'transitions'\n];\n\nvar uid = 0;\n\nfunction construct ( ractive, options ) {\n\tif ( Ractive.DEBUG ) { welcome(); }\n\n\tinitialiseProperties( ractive );\n\n\t// TODO don't allow `onconstruct` with `new Ractive()`, there's no need for it\n\tconstructHook.fire( ractive, options );\n\n\t// Add registries\n\tregistryNames$1.forEach( function (name) {\n\t\tractive[ name ] = extend$1( create( ractive.constructor[ name ] || null ), options[ name ] );\n\t});\n\n\t// Create a viewmodel\n\tvar viewmodel = new RootModel({\n\t\tadapt: getAdaptors( ractive, ractive.adapt, options ),\n\t\tdata: dataConfigurator.init( ractive.constructor, ractive, options ),\n\t\tractive: ractive\n\t});\n\n\tractive.viewmodel = viewmodel;\n\n\t// Add computed properties\n\tvar computed = extend$1( create( ractive.constructor.prototype.computed ), options.computed );\n\n\tfor ( var key in computed ) {\n\t\tvar signature = getComputationSignature( ractive, key, computed[ key ] );\n\t\tviewmodel.compute( key, signature );\n\t}\n}\n\nfunction combine$2 ( arrays ) {\n\tvar res = [];\n\tvar args = res.concat.apply( res, arrays );\n\n\tvar i = args.length;\n\twhile ( i-- ) {\n\t\tif ( !~res.indexOf( args[i] ) ) {\n\t\t\tres.unshift( args[i] );\n\t\t}\n\t}\n\n\treturn res;\n}\n\nfunction getAdaptors ( ractive, protoAdapt, options ) {\n\tprotoAdapt = protoAdapt.map( lookup );\n\tvar adapt = ensureArray( options.adapt ).map( lookup );\n\n\tvar builtins = [];\n\tvar srcs = [ protoAdapt, adapt ];\n\tif ( ractive.parent && !ractive.isolated ) {\n\t\tsrcs.push( ractive.parent.viewmodel.adaptors );\n\t}\n\tsrcs.push( builtins );\n\n\tvar magic$$1 = 'magic' in options ? options.magic : ractive.magic;\n\tvar modifyArrays = 'modifyArrays' in options ? options.modifyArrays : ractive.modifyArrays;\n\n\tif ( magic$$1 ) {\n\t\tif ( !magic ) {\n\t\t\tthrow new Error( 'Getters and setters (magic mode) are not supported in this browser' );\n\t\t}\n\n\t\tif ( modifyArrays ) {\n\t\t\tbuiltins.push( magicArrayAdaptor );\n\t\t}\n\n\t\tbuiltins.push( magicAdaptor$1 );\n\t}\n\n\tif ( modifyArrays ) {\n\t\tbuiltins.push( arrayAdaptor );\n\t}\n\n\treturn combine$2( srcs );\n\n\n\tfunction lookup ( adaptor ) {\n\t\tif ( typeof adaptor === 'string' ) {\n\t\t\tadaptor = findInViewHierarchy( 'adaptors', ractive, adaptor );\n\n\t\t\tif ( !adaptor ) {\n\t\t\t\tfatal( missingPlugin( adaptor, 'adaptor' ) );\n\t\t\t}\n\t\t}\n\n\t\treturn adaptor;\n\t}\n}\n\nfunction initialiseProperties ( ractive ) {\n\t// Generate a unique identifier, for places where you'd use a weak map if it\n\t// existed\n\tractive._guid = 'r-' + uid++;\n\n\t// events\n\tractive._subs = create( null );\n\n\t// storage for item configuration from instantiation to reset,\n\t// like dynamic functions or original values\n\tractive._config = {};\n\n\t// nodes registry\n\tractive.nodes = {};\n\n\t// events\n\tractive.event = null;\n\tractive._eventQueue = [];\n\n\t// live queries\n\tractive._liveQueries = [];\n\tractive._liveComponentQueries = [];\n\n\t// observers\n\tractive._observers = [];\n\n\t// external children\n\tractive._children = [];\n\tractive._children.byName = {};\n\tractive.children = ractive._children;\n\n\tif ( !ractive.component ) {\n\t\tractive.root = ractive;\n\t\tractive.parent = ractive.container = null; // TODO container still applicable?\n\t}\n}\n\nvar teardownHook = new Hook( 'teardown' );\nvar destructHook = new Hook( 'destruct' );\n\n// Teardown. This goes through the root fragment and all its children, removing observers\n// and generally cleaning up after itself\n\nfunction Ractive$teardown () {\n\tvar this$1 = this;\n\n\tif ( this.torndown ) {\n\t\twarnIfDebug( 'ractive.teardown() was called on a Ractive instance that was already torn down' );\n\t\treturn Promise$1.resolve();\n\t}\n\n\tthis.shouldDestroy = true;\n\treturn teardown$2( this, function () { return this$1.fragment.rendered ? this$1.unrender() : Promise$1.resolve(); } );\n}\n\nfunction teardown$2 ( instance, getPromise ) {\n\tinstance.torndown = true;\n\tinstance.viewmodel.teardown();\n\tinstance.fragment.unbind();\n\tinstance._observers.forEach( cancel$1 );\n\n\tif ( instance.fragment.rendered && instance.el.__ractive_instances__ ) {\n\t\tremoveFromArray( instance.el.__ractive_instances__, instance );\n\t}\n\n\tvar promise = getPromise();\n\n\tteardownHook.fire( instance );\n\tpromise.then( function () { return destructHook.fire( instance ); } );\n\n\treturn promise;\n}\n\nfunction makeDirty$1 ( query ) {\n\tquery.makeDirty();\n}\n\nvar Component = (function (Item$$1) {\n\tfunction Component ( options, ComponentConstructor ) {\n\t\tvar this$1 = this;\n\n\t\tItem$$1.call( this, options );\n\t\tthis.isAnchor = this.template.t === ANCHOR;\n\t\tthis.type = this.isAnchor ? ANCHOR : COMPONENT; // override ELEMENT from super\n\n\t\tvar partials = options.template.p || {};\n\t\tif ( !( 'content' in partials ) ) { partials.content = options.template.f || []; }\n\t\tthis._partials = partials; // TEMP\n\n\t\tif ( this.isAnchor ) {\n\t\t\tthis.name = options.template.n;\n\n\t\t\tthis.addChild = addChild$1;\n\t\t\tthis.removeChild = removeChild$1;\n\t\t} else {\n\t\t\tvar instance = create( ComponentConstructor.prototype );\n\n\t\t\tthis.instance = instance;\n\t\t\tthis.name = options.template.e;\n\n\t\t\tif ( instance.el ) {\n\t\t\t\twarnIfDebug( (\"The <\" + (this.name) + \"> component has a default 'el' property; it has been disregarded\") );\n\t\t\t}\n\n\t\t\tthis.liveQueries = [];\n\n\t\t\t// find container\n\t\t\tvar fragment = options.parentFragment;\n\t\t\tvar container;\n\t\t\twhile ( fragment ) {\n\t\t\t\tif ( fragment.owner.type === YIELDER ) {\n\t\t\t\t\tcontainer = fragment.owner.container;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tfragment = fragment.parent;\n\t\t\t}\n\n\t\t\t// add component-instance-specific properties\n\t\t\tinstance.parent = this.parentFragment.ractive;\n\t\t\tinstance.container = container || null;\n\t\t\tinstance.root = instance.parent.root;\n\t\t\tinstance.component = this;\n\n\t\t\tconstruct( this.instance, { partials: partials });\n\n\t\t\t// for hackability, this could be an open option\n\t\t\t// for any ractive instance, but for now, just\n\t\t\t// for components and just for ractive...\n\t\t\tinstance._inlinePartials = partials;\n\t\t}\n\n\t\tthis.attributeByName = {};\n\n\t\tthis.events = [];\n\t\tthis.attributes = [];\n\t\tvar leftovers = [];\n\t\t( this.template.m || [] ).forEach( function (template) {\n\t\t\tswitch ( template.t ) {\n\t\t\t\tcase ATTRIBUTE:\n\t\t\t\tcase EVENT:\n\t\t\t\t\tthis$1.attributes.push( createItem({\n\t\t\t\t\t\towner: this$1,\n\t\t\t\t\t\tparentFragment: this$1.parentFragment,\n\t\t\t\t\t\ttemplate: template\n\t\t\t\t\t}) );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase TRANSITION:\n\t\t\t\tcase BINDING_FLAG:\n\t\t\t\tcase DECORATOR:\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tleftovers.push( template );\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\n\t\tif ( leftovers.length ) {\n\t\t\tthis.attributes.push( new ConditionalAttribute({\n\t\t\t\towner: this,\n\t\t\t\tparentFragment: this.parentFragment,\n\t\t\t\ttemplate: leftovers\n\t\t\t}) );\n\t\t}\n\n\t\tthis.eventHandlers = [];\n\t}\n\n\tif ( Item$$1 ) Component.__proto__ = Item$$1;\n\tComponent.prototype = Object.create( Item$$1 && Item$$1.prototype );\n\tComponent.prototype.constructor = Component;\n\n\tComponent.prototype.bind = function bind$1 () {\n\t\tif ( !this.isAnchor ) {\n\t\t\tthis.attributes.forEach( bind$1$1 );\n\n\t\t\tinitialise( this.instance, {\n\t\t\t\tpartials: this._partials\n\t\t\t}, {\n\t\t\t\tcssIds: this.parentFragment.cssIds\n\t\t\t});\n\n\t\t\tthis.eventHandlers.forEach( bind$1$1 );\n\n\t\t\tthis.bound = true;\n\t\t}\n\t};\n\n\tComponent.prototype.bubble = function bubble () {\n\t\tif ( !this.dirty ) {\n\t\t\tthis.dirty = true;\n\t\t\tthis.parentFragment.bubble();\n\t\t}\n\t};\n\n\tComponent.prototype.destroyed = function destroyed () {\n\t\tif ( !this.isAnchor && this.instance.fragment ) { this.instance.fragment.destroyed(); }\n\t};\n\n\tComponent.prototype.detach = function detach () {\n\t\tif ( this.isAnchor ) {\n\t\t\tif ( this.instance ) { return this.instance.fragment.detach(); }\n\t\t\treturn createDocumentFragment();\n\t\t}\n\n\t\treturn this.instance.fragment.detach();\n\t};\n\n\tComponent.prototype.find = function find ( selector, options ) {\n\t\tif ( this.instance ) { return this.instance.fragment.find( selector, options ); }\n\t};\n\n\tComponent.prototype.findAll = function findAll ( selector, query ) {\n\t\tif ( this.instance ) { this.instance.fragment.findAll( selector, query ); }\n\t};\n\n\tComponent.prototype.findComponent = function findComponent ( name, options ) {\n\t\tif ( !name || this.name === name ) { return this.instance; }\n\n\t\tif ( this.instance.fragment ) {\n\t\t\treturn this.instance.fragment.findComponent( name, options );\n\t\t}\n\t};\n\n\tComponent.prototype.findAllComponents = function findAllComponents ( name, query ) {\n\t\tif ( this.instance && query.test( this ) ) {\n\t\t\tquery.add( this.instance );\n\n\t\t\tif ( query.live ) {\n\t\t\t\tthis.liveQueries.push( query );\n\t\t\t}\n\t\t}\n\n\t\tif ( this.instance ) { this.instance.findAllComponents( name, { _query: query } ); }\n\t};\n\n\tComponent.prototype.firstNode = function firstNode ( skipParent ) {\n\t\tif ( this.instance ) { return this.instance.fragment.firstNode( skipParent ); }\n\t};\n\n\tComponent.prototype.removeFromQuery = function removeFromQuery ( query ) {\n\t\tif ( this.instance ) { query.remove( this.instance ); }\n\t\tremoveFromArray( this.liveQueries, query );\n\t};\n\n\tComponent.prototype.render = function render$1 ( target, occupants ) {\n\t\tif ( this.isAnchor ) {\n\t\t\tthis.target = target;\n\t\t\tif ( !checking.length ) {\n\t\t\t\tchecking.push( this.ractive );\n\t\t\t\trunloop.scheduleTask( checkAnchors, true );\n\t\t\t}\n\t\t} else {\n\t\t\trender$2( this.instance, target, null, occupants );\n\n\t\t\tthis.attributes.forEach( render$1$1 );\n\t\t\tthis.eventHandlers.forEach( render$1$1 );\n\t\t\tupdateLiveQueries$1( this );\n\t\t}\n\t\tthis.rendered = true;\n\t};\n\n\tComponent.prototype.shuffled = function shuffled () {\n\t\tif ( this.instance ) { this.liveQueries.forEach( makeDirty$1 ); }\n\t\tItem$$1.prototype.shuffled.call(this);\n\t};\n\n\tComponent.prototype.toString = function toString () {\n\t\tif ( this.instance ) { return this.instance.toHTML(); }\n\t};\n\n\tComponent.prototype.unbind = function unbind$1 () {\n\t\tif ( !this.isAnchor ) {\n\t\t\tthis.bound = false;\n\n\t\t\tthis.attributes.forEach( unbind$1$1 );\n\n\t\t\tteardown$2( this.instance, function () { return runloop.promise(); } );\n\t\t}\n\t};\n\n\tComponent.prototype.unrender = function unrender$1 ( shouldDestroy ) {\n\t\tvar this$1 = this;\n\n\t\tthis.shouldDestroy = shouldDestroy;\n\n\t\tif ( this.isAnchor ) {\n\t\t\tif ( this.item ) { unrenderItem( this, this.item ); }\n\t\t\tthis.target = null;\n\t\t\tif ( !checking.length ) {\n\t\t\t\tchecking.push( this.ractive );\n\t\t\t\trunloop.scheduleTask( checkAnchors, true );\n\t\t\t}\n\t\t} else {\n\t\t\tthis.instance.unrender();\n\t\t\tthis.instance.el = this.instance.target = null;\n\t\t\tthis.attributes.forEach( unrender$1$1 );\n\t\t\tthis.eventHandlers.forEach( unrender$1$1 );\n\n\t\t\tthis.liveQueries.forEach( function (query) { return query.remove( this$1.instance ); } );\n\t\t\tthis.liveQueries = [];\n\t\t}\n\n\t\tthis.rendered = false;\n\t};\n\n\tComponent.prototype.update = function update$1 () {\n\t\tthis.dirty = false;\n\t\tif ( this.instance ) {\n\t\t\tthis.instance.fragment.update();\n\t\t\tthis.attributes.forEach( update$1$1 );\n\t\t\tthis.eventHandlers.forEach( update$1$1 );\n\t\t}\n\t};\n\n\treturn Component;\n}(Item));\n\nfunction addChild$1 ( meta ) {\n\tif ( this.item ) { this.removeChild( this.item ); }\n\n\tvar child = meta.instance;\n\tmeta.anchor = this;\n\n\tmeta.parentFragment = this.parentFragment;\n\tmeta.name = meta.nameOption || this.name;\n\tthis.name = meta.name;\n\n\n\tif ( !child.isolated ) { child.viewmodel.attached( this.parentFragment ); }\n\n\t// render as necessary\n\tif ( this.rendered ) {\n\t\trenderItem( this, meta );\n\t}\n}\n\nfunction removeChild$1 ( meta ) {\n\t// unrender as necessary\n\tif ( this.item === meta ) {\n\t\tunrenderItem( this, meta );\n\t\tthis.name = this.template.n;\n\t}\n}\n\nfunction renderItem ( anchor, meta ) {\n\tif ( !anchor.rendered ) { return; }\n\n\tmeta.shouldDestroy = false;\n\tmeta.parentFragment = anchor.parentFragment;\n\n\tanchor.item = meta;\n\tanchor.instance = meta.instance;\n\tanchor.liveQueries = meta.liveQueries;\n\tvar nextNode = anchor.parentFragment.findNextNode( anchor );\n\n\tif ( meta.instance.fragment.rendered ) {\n\t\tmeta.instance.unrender();\n\t}\n\n\tmeta.partials = meta.instance.partials;\n\tmeta.instance.partials = extend$1( {}, meta.partials, anchor._partials );\n\n\tmeta.instance.fragment.unbind();\n\tmeta.instance.fragment.bind( meta.instance.viewmodel );\n\n\tanchor.attributes.forEach( bind$1$1 );\n\tanchor.eventHandlers.forEach( bind$1$1 );\n\tanchor.attributes.forEach( render$1$1 );\n\tanchor.eventHandlers.forEach( render$1$1 );\n\n\tvar target = anchor.parentFragment.findParentNode();\n\trender$2( meta.instance, target, target.contains( nextNode ) ? nextNode : null );\n\n\tif ( meta.lastBound !== anchor ) {\n\t\tmeta.lastBound = anchor;\n\t}\n\n\tupdateLiveQueries$1( meta );\n}\n\nfunction unrenderItem ( anchor, meta ) {\n\tif ( !anchor.rendered ) { return; }\n\n\tmeta.shouldDestroy = true;\n\tmeta.instance.unrender();\n\n\tanchor.eventHandlers.forEach( unrender$1$1 );\n\tanchor.attributes.forEach( unrender$1$1 );\n\tanchor.eventHandlers.forEach( unbind$1$1 );\n\tanchor.attributes.forEach( unbind$1$1 );\n\n\tmeta.instance.el = meta.instance.anchor = null;\n\tmeta.parentFragment = null;\n\tmeta.anchor = null;\n\tanchor.item = null;\n\tanchor.instance = null;\n\n\tmeta.liveQueries.forEach( function (q) { return q.remove( meta.instance ); } );\n\tmeta.liveQueries = [];\n\tanchor.liveQueries = null;\n}\n\nvar checking = [];\nfunction checkAnchors () {\n\tvar list = checking;\n\tchecking = [];\n\n\tlist.forEach( updateAnchors );\n}\n\nfunction setupArgsFn ( item, template, fragment, opts ) {\n\tif ( opts === void 0 ) opts = {};\n\n\tif ( template && template.f && template.f.s ) {\n\t\titem.resolvers = [];\n\t\titem.models = template.f.r.map( function ( ref, i ) {\n\t\t\tvar resolver, model;\n\n\t\t\tif ( opts.specialRef && ( model = opts.specialRef( ref, i ) ) ) { return model; }\n\n\t\t\tmodel = resolveReference( fragment, ref );\n\t\t\tif ( !model ) {\n\t\t\t\tresolver = fragment.resolve( ref, function (model) {\n\t\t\t\t\titem.models[i] = model;\n\t\t\t\t\tremoveFromArray( item.resolvers, resolver );\n\t\t\t\t\tmodel.register( item );\n\t\t\t\t});\n\n\t\t\t\titem.resolvers.push( resolver );\n\t\t\t} else { model.register( item ); }\n\n\t\t\treturn model;\n\t\t});\n\t\titem.fn = getFunction( template.f.s, template.f.r.length );\n\t}\n}\n\nfunction teardownArgsFn ( item, template ) {\n\tif ( template && template.f && template.f.s ) {\n\t\tif ( item.resolvers ) { item.resolvers.forEach( unbind$1$1 ); }\n\t\titem.resolvers = [];\n\n\t\tif ( item.models ) { item.models.forEach( function (m) {\n\t\t\tif ( m && m.unregister ) { m.unregister( item ); }\n\t\t}); }\n\t\titem.models = null;\n\t}\n}\n\nvar missingDecorator = {\n\tupdate: noop,\n\tteardown: noop\n};\n\nvar Decorator = function Decorator ( options ) {\n\tthis.owner = options.owner || options.parentFragment.owner || findElement( options.parentFragment );\n\tthis.element = this.owner.attributeByName ? this.owner : findElement( options.parentFragment );\n\tthis.parentFragment = this.owner.parentFragment;\n\tthis.ractive = this.owner.ractive;\n\tvar template = this.template = options.template;\n\n\tthis.name = template.n;\n\tthis.args = [];\n\n\tthis.node = null;\n\tthis.intermediary = null;\n\n\tthis.element.decorators.push( this );\n};\n\nDecorator.prototype.bind = function bind () {\n\tsetupArgsFn( this, this.template, this.parentFragment );\n};\n\nDecorator.prototype.bubble = function bubble () {\n\tif ( !this.dirty ) {\n\t\tthis.dirty = true;\n\t\tthis.owner.bubble();\n\t}\n};\n\nDecorator.prototype.destroyed = function destroyed () {\n\tif ( this.intermediary ) { this.intermediary.teardown(); }\n};\n\nDecorator.prototype.handleChange = function handleChange () { this.bubble(); };\n\nDecorator.prototype.rebinding = function rebinding ( next, previous, safe ) {\n\tvar idx = this.models.indexOf( previous );\n\tif ( !~idx ) { return; }\n\n\tnext = rebindMatch( this.template.f.r[ idx ], next, previous );\n\tif ( next === previous ) { return; }\n\n\tprevious.unregister( this );\n\tthis.models.splice( idx, 1, next );\n\tif ( next ) { next.addShuffleRegister( this, 'mark' ); }\n\n\tif ( !safe ) { this.bubble(); }\n};\n\nDecorator.prototype.render = function render () {\n\t\tvar this$1 = this;\n\n\trunloop.scheduleTask( function () {\n\t\tvar fn = findInViewHierarchy( 'decorators', this$1.ractive, this$1.name );\n\n\t\tif ( !fn ) {\n\t\t\twarnOnce( missingPlugin( this$1.name, 'decorator' ) );\n\t\t\tthis$1.intermediary = missingDecorator;\n\t\t\treturn;\n\t\t}\n\n\t\tthis$1.node = this$1.element.node;\n\n\t\tvar args;\n\t\tif ( this$1.fn ) {\n\t\t\targs = this$1.models.map( function (model) {\n\t\t\t\tif ( !model ) { return undefined; }\n\n\t\t\t\treturn model.get();\n\t\t\t});\n\t\t\targs = this$1.fn.apply( this$1.ractive, args );\n\t\t}\n\n\t\tthis$1.intermediary = fn.apply( this$1.ractive, [ this$1.node ].concat( args ) );\n\n\t\tif ( !this$1.intermediary || !this$1.intermediary.teardown ) {\n\t\t\tthrow new Error( (\"The '\" + (this$1.name) + \"' decorator must return an object with a teardown method\") );\n\t\t}\n\t}, true );\n\tthis.rendered = true;\n};\n\nDecorator.prototype.toString = function toString () { return ''; };\n\nDecorator.prototype.unbind = function unbind () {\n\tteardownArgsFn( this, this.template );\n};\n\nDecorator.prototype.unrender = function unrender ( shouldDestroy ) {\n\tif ( ( !shouldDestroy || this.element.rendered ) && this.intermediary ) { this.intermediary.teardown(); }\n\tthis.rendered = false;\n};\n\nDecorator.prototype.update = function update () {\n\tif ( !this.dirty ) { return; }\n\n\tthis.dirty = false;\n\n\tif ( this.intermediary ) {\n\t\tif ( !this.intermediary.update ) {\n\t\t\tthis.unrender();\n\t\t\tthis.render();\n\t\t}\n\t\telse {\n\t\t\tif ( this.fn ) {\n\t\t\t\tvar args = this.models.map( function (model) {\n\t\t\t\t\tif ( !model ) { return undefined; }\n\n\t\t\t\t\treturn model.get();\n\t\t\t\t});\n\t\t\t\tthis.intermediary.update.apply( this.ractive, this.fn.apply( this.ractive, args ) );\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.intermediary.update.apply( this.ractive, this.args );\n\t\t\t}\n\t\t}\n\t}\n};\n\nvar Doctype = (function (Item$$1) {\n\tfunction Doctype () {\n\t\tItem$$1.apply(this, arguments);\n\t}\n\n\tif ( Item$$1 ) Doctype.__proto__ = Item$$1;\n\tDoctype.prototype = Object.create( Item$$1 && Item$$1.prototype );\n\tDoctype.prototype.constructor = Doctype;\n\n\tDoctype.prototype.bind = function bind () {\n\t\t// noop\n\t};\n\n\tDoctype.prototype.render = function render () {\n\t\t// noop\n\t};\n\n\tDoctype.prototype.teardown = function teardown () {\n\t\t// noop\n\t};\n\n\tDoctype.prototype.toString = function toString () {\n\t\treturn '<!DOCTYPE' + this.template.a + '>';\n\t};\n\n\tDoctype.prototype.unbind = function unbind () {\n\t\t// noop\n\t};\n\n\tDoctype.prototype.unrender = function unrender () {\n\t\t// noop\n\t};\n\n\tDoctype.prototype.update = function update () {\n\t\t// noop\n\t};\n\n\treturn Doctype;\n}(Item));\n\nfunction warnAboutAmbiguity ( description, ractive ) {\n\twarnOnceIfDebug( (\"The \" + description + \" being used for two-way binding is ambiguous, and may cause unexpected results. Consider initialising your data to eliminate the ambiguity\"), { ractive: ractive });\n}\n\nvar Binding = function Binding ( element, name ) {\n\tif ( name === void 0 ) name = 'value';\n\n\tthis.element = element;\n\tthis.ractive = element.ractive;\n\tthis.attribute = element.attributeByName[ name ];\n\n\tvar interpolator = this.attribute.interpolator;\n\tinterpolator.twowayBinding = this;\n\n\tvar model = interpolator.model;\n\n\t// not bound?\n\tif ( !model ) {\n\t\t// try to force resolution\n\t\tinterpolator.resolver.forceResolution();\n\t\tmodel = interpolator.model;\n\n\t\twarnAboutAmbiguity( (\"'\" + (interpolator.template.r) + \"' reference\"), this.ractive );\n\t\t}\n\n\t\telse if ( model.isUnresolved ) {\n\t\t\t// reference expressions (e.g. foo[bar])\n\t\t\tmodel.forceResolution();\n\t\t\twarnAboutAmbiguity( 'expression', this.ractive );\n\t}\n\n\t// TODO include index/key/keypath refs as read-only\n\telse if ( model.isReadonly ) {\n\t\tvar keypath = model.getKeypath().replace( /^@/, '' );\n\t\twarnOnceIfDebug( (\"Cannot use two-way binding on <\" + (element.name) + \"> element: \" + keypath + \" is read-only. To suppress this warning use <\" + (element.name) + \" twoway='false'...>\"), { ractive: this.ractive });\n\t\treturn false;\n\t}\n\n\tthis.attribute.isTwoway = true;\n\tthis.model = model;\n\n\t// initialise value, if it's undefined\n\tvar value = model.get();\n\tthis.wasUndefined = value === undefined;\n\n\tif ( value === undefined && this.getInitialValue ) {\n\t\tvalue = this.getInitialValue();\n\t\tmodel.set( value );\n\t}\n\tthis.lastVal( true, value );\n\n\tvar parentForm = findElement( this.element, false, 'form' );\n\tif ( parentForm ) {\n\t\tthis.resetValue = value;\n\t\tparentForm.formBindings.push( this );\n\t}\n};\n\nBinding.prototype.bind = function bind () {\n\tthis.model.registerTwowayBinding( this );\n};\n\nBinding.prototype.handleChange = function handleChange () {\n\t\tvar this$1 = this;\n\n\tvar value = this.getValue();\n\tif ( this.lastVal() === value ) { return; }\n\n\trunloop.start( this.root );\n\tthis.attribute.locked = true;\n\tthis.model.set( value );\n\tthis.lastVal( true, value );\n\n\t// if the value changes before observers fire, unlock to be updatable cause something weird and potentially freezy is up\n\tif ( this.model.get() !== value ) { this.attribute.locked = false; }\n\telse { runloop.scheduleTask( function () { return this$1.attribute.locked = false; } ); }\n\n\trunloop.end();\n};\n\nBinding.prototype.lastVal = function lastVal ( setting, value ) {\n\tif ( setting ) { this.lastValue = value; }\n\telse { return this.lastValue; }\n};\n\nBinding.prototype.rebinding = function rebinding ( next, previous ) {\n\t\tvar this$1 = this;\n\n\tif ( this.model && this.model === previous ) { previous.unregisterTwowayBinding( this ); }\n\tif ( next ) {\n\t\tthis.model = next;\n\t\trunloop.scheduleTask( function () { return next.registerTwowayBinding( this$1 ); } );\n\t}\n};\n\nBinding.prototype.render = function render () {\n\tthis.node = this.element.node;\n\tthis.node._ractive.binding = this;\n\tthis.rendered = true; // TODO is this used anywhere?\n};\n\n\tBinding.prototype.setFromNode = function setFromNode ( node ) {\n\t\tthis.model.set( node.value );\n};\n\nBinding.prototype.unbind = function unbind () {\n\tthis.model.unregisterTwowayBinding( this );\n};\n\nBinding.prototype.unrender = function unrender () {\n\t\t// noop?\n\t};\n\n// This is the handler for DOM events that would lead to a change in the model\n// (i.e. change, sometimes, input, and occasionally click and keyup)\nfunction handleDomEvent () {\n\tthis._ractive.binding.handleChange();\n}\n\nvar CheckboxBinding = (function (Binding$$1) {\n\tfunction CheckboxBinding ( element ) {\n\t\tBinding$$1.call( this, element, 'checked' );\n\t}\n\n\tif ( Binding$$1 ) CheckboxBinding.__proto__ = Binding$$1;\n\tCheckboxBinding.prototype = Object.create( Binding$$1 && Binding$$1.prototype );\n\tCheckboxBinding.prototype.constructor = CheckboxBinding;\n\n\tCheckboxBinding.prototype.render = function render () {\n\t\tBinding$$1.prototype.render.call(this);\n\n\t\tthis.node.addEventListener( 'change', handleDomEvent, false );\n\n\t\tif ( this.node.attachEvent ) {\n\t\t\tthis.node.addEventListener( 'click', handleDomEvent, false );\n\t\t}\n\t};\n\n\tCheckboxBinding.prototype.unrender = function unrender () {\n\t\tthis.node.removeEventListener( 'change', handleDomEvent, false );\n\t\tthis.node.removeEventListener( 'click', handleDomEvent, false );\n\t};\n\n\tCheckboxBinding.prototype.getInitialValue = function getInitialValue () {\n\t\treturn !!this.element.getAttribute( 'checked' );\n\t};\n\n\tCheckboxBinding.prototype.getValue = function getValue () {\n\t\treturn this.node.checked;\n\t};\n\n\tCheckboxBinding.prototype.setFromNode = function setFromNode ( node ) {\n\t\tthis.model.set( node.checked );\n\t};\n\n\treturn CheckboxBinding;\n}(Binding));\n\nfunction getBindingGroup ( group, model, getValue ) {\n\tvar hash = group + \"-bindingGroup\";\n\treturn model[hash] || ( model[ hash ] = new BindingGroup( hash, model, getValue ) );\n}\n\nvar BindingGroup = function BindingGroup ( hash, model, getValue ) {\n\tvar this$1 = this;\n\n\tthis.model = model;\n\tthis.hash = hash;\n\tthis.getValue = function () {\n\t\tthis$1.value = getValue.call(this$1);\n\t\treturn this$1.value;\n\t};\n\n\tthis.bindings = [];\n};\n\nBindingGroup.prototype.add = function add ( binding ) {\n\tthis.bindings.push( binding );\n};\n\nBindingGroup.prototype.bind = function bind () {\n\tthis.value = this.model.get();\n\tthis.model.registerTwowayBinding( this );\n\tthis.bound = true;\n};\n\nBindingGroup.prototype.remove = function remove ( binding ) {\n\tremoveFromArray( this.bindings, binding );\n\tif ( !this.bindings.length ) {\n\t\tthis.unbind();\n\t}\n};\n\nBindingGroup.prototype.unbind = function unbind () {\n\tthis.model.unregisterTwowayBinding( this );\n\tthis.bound = false;\n\tdelete this.model[this.hash];\n};\n\nvar push$2 = [].push;\n\nfunction getValue$1$1() {\n\tvar all = this.bindings.filter(function (b) { return b.node && b.node.checked; }).map(function (b) { return b.element.getAttribute( 'value' ); });\n\tvar res = [];\n\tall.forEach(function (v) { if ( !arrayContains( res, v ) ) { res.push( v ); } });\n\treturn res;\n}\n\nvar CheckboxNameBinding = (function (Binding$$1) {\n\tfunction CheckboxNameBinding ( element ) {\n\t\tBinding$$1.call( this, element, 'name' );\n\n\t\tthis.checkboxName = true; // so that ractive.updateModel() knows what to do with this\n\n\t\t// Each input has a reference to an array containing it and its\n\t\t// group, as two-way binding depends on being able to ascertain\n\t\t// the status of all inputs within the group\n\t\tthis.group = getBindingGroup( 'checkboxes', this.model, getValue$1$1 );\n\t\tthis.group.add( this );\n\n\t\tif ( this.noInitialValue ) {\n\t\t\tthis.group.noInitialValue = true;\n\t\t}\n\n\t\t// If no initial value was set, and this input is checked, we\n\t\t// update the model\n\t\tif ( this.group.noInitialValue && this.element.getAttribute( 'checked' ) ) {\n\t\t\tvar existingValue = this.model.get();\n\t\t\tvar bindingValue = this.element.getAttribute( 'value' );\n\n\t\t\tif ( !arrayContains( existingValue, bindingValue ) ) {\n\t\t\t\tpush$2.call( existingValue, bindingValue ); // to avoid triggering runloop with array adaptor\n\t\t\t}\n\t\t}\n\t}\n\n\tif ( Binding$$1 ) CheckboxNameBinding.__proto__ = Binding$$1;\n\tCheckboxNameBinding.prototype = Object.create( Binding$$1 && Binding$$1.prototype );\n\tCheckboxNameBinding.prototype.constructor = CheckboxNameBinding;\n\n\tCheckboxNameBinding.prototype.bind = function bind () {\n\t\tif ( !this.group.bound ) {\n\t\t\tthis.group.bind();\n\t\t}\n\t};\n\n\tCheckboxNameBinding.prototype.changed = function changed () {\n\t\tvar wasChecked = !!this.isChecked;\n\t\tthis.isChecked = this.node.checked;\n\t\treturn this.isChecked === wasChecked;\n\t};\n\n\tCheckboxNameBinding.prototype.getInitialValue = function getInitialValue () {\n\t\t// This only gets called once per group (of inputs that\n\t\t// share a name), because it only gets called if there\n\t\t// isn't an initial value. By the same token, we can make\n\t\t// a note of that fact that there was no initial value,\n\t\t// and populate it using any `checked` attributes that\n\t\t// exist (which users should avoid, but which we should\n\t\t// support anyway to avoid breaking expectations)\n\t\tthis.noInitialValue = true; // TODO are noInitialValue and wasUndefined the same thing?\n\t\treturn [];\n\t};\n\n\tCheckboxNameBinding.prototype.getValue = function getValue$1 () {\n\t\treturn this.group.value;\n\t};\n\n\tCheckboxNameBinding.prototype.handleChange = function handleChange () {\n\t\tthis.isChecked = this.element.node.checked;\n\t\tthis.group.value = this.model.get();\n\t\tvar value = this.element.getAttribute( 'value' );\n\t\tif ( this.isChecked && !arrayContains( this.group.value, value ) ) {\n\t\t\tthis.group.value.push( value );\n\t\t} else if ( !this.isChecked && arrayContains( this.group.value, value ) ) {\n\t\t\tremoveFromArray( this.group.value, value );\n\t\t}\n\t\t// make sure super knows there's a change\n\t\tthis.lastValue = null;\n\t\tBinding$$1.prototype.handleChange.call(this);\n\t};\n\n\tCheckboxNameBinding.prototype.render = function render () {\n\t\tBinding$$1.prototype.render.call(this);\n\n\t\tvar node = this.node;\n\n\t\tvar existingValue = this.model.get();\n\t\tvar bindingValue = this.element.getAttribute( 'value' );\n\n\t\tif ( isArray( existingValue ) ) {\n\t\t\tthis.isChecked = arrayContains( existingValue, bindingValue );\n\t\t} else {\n\t\t\tthis.isChecked = existingValue == bindingValue;\n\t\t}\n\n\t\tnode.name = '{{' + this.model.getKeypath() + '}}';\n\t\tnode.checked = this.isChecked;\n\n\t\tnode.addEventListener( 'change', handleDomEvent, false );\n\n\t\t// in case of IE emergency, bind to click event as well\n\t\tif ( node.attachEvent ) {\n\t\t\tnode.addEventListener( 'click', handleDomEvent, false );\n\t\t}\n\t};\n\n\tCheckboxNameBinding.prototype.setFromNode = function setFromNode ( node ) {\n\t\tthis.group.bindings.forEach( function (binding) { return binding.wasUndefined = true; } );\n\n\t\tif ( node.checked ) {\n\t\t\tvar valueSoFar = this.group.getValue();\n\t\t\tvalueSoFar.push( this.element.getAttribute( 'value' ) );\n\n\t\t\tthis.group.model.set( valueSoFar );\n\t\t}\n\t};\n\n\tCheckboxNameBinding.prototype.unbind = function unbind () {\n\t\tthis.group.remove( this );\n\t};\n\n\tCheckboxNameBinding.prototype.unrender = function unrender () {\n\t\tvar node = this.element.node;\n\n\t\tnode.removeEventListener( 'change', handleDomEvent, false );\n\t\tnode.removeEventListener( 'click', handleDomEvent, false );\n\t};\n\n\treturn CheckboxNameBinding;\n}(Binding));\n\nvar ContentEditableBinding = (function (Binding$$1) {\n\tfunction ContentEditableBinding () {\n\t\tBinding$$1.apply(this, arguments);\n\t}\n\n\tif ( Binding$$1 ) ContentEditableBinding.__proto__ = Binding$$1;\n\tContentEditableBinding.prototype = Object.create( Binding$$1 && Binding$$1.prototype );\n\tContentEditableBinding.prototype.constructor = ContentEditableBinding;\n\n\tContentEditableBinding.prototype.getInitialValue = function getInitialValue () {\n\t\treturn this.element.fragment ? this.element.fragment.toString() : '';\n\t};\n\n\tContentEditableBinding.prototype.getValue = function getValue () {\n\t\treturn this.element.node.innerHTML;\n\t};\n\n\tContentEditableBinding.prototype.render = function render () {\n\t\tBinding$$1.prototype.render.call(this);\n\n\t\tvar node = this.node;\n\n\t\tnode.addEventListener( 'change', handleDomEvent, false );\n\t\tnode.addEventListener( 'blur', handleDomEvent, false );\n\n\t\tif ( !this.ractive.lazy ) {\n\t\t\tnode.addEventListener( 'input', handleDomEvent, false );\n\n\t\t\tif ( node.attachEvent ) {\n\t\t\t\tnode.addEventListener( 'keyup', handleDomEvent, false );\n\t\t\t}\n\t\t}\n\t};\n\n\tContentEditableBinding.prototype.setFromNode = function setFromNode ( node ) {\n\t\tthis.model.set( node.innerHTML );\n\t};\n\n\tContentEditableBinding.prototype.unrender = function unrender () {\n\t\tvar node = this.node;\n\n\t\tnode.removeEventListener( 'blur', handleDomEvent, false );\n\t\tnode.removeEventListener( 'change', handleDomEvent, false );\n\t\tnode.removeEventListener( 'input', handleDomEvent, false );\n\t\tnode.removeEventListener( 'keyup', handleDomEvent, false );\n\t};\n\n\treturn ContentEditableBinding;\n}(Binding));\n\nfunction handleBlur () {\n\thandleDomEvent.call( this );\n\n\tvar value = this._ractive.binding.model.get();\n\tthis.value = value == undefined ? '' : value;\n}\n\nfunction handleDelay ( delay ) {\n\tvar timeout;\n\n\treturn function () {\n\t\tvar this$1 = this;\n\n\t\tif ( timeout ) { clearTimeout( timeout ); }\n\n\t\ttimeout = setTimeout( function () {\n\t\t\tvar binding = this$1._ractive.binding;\n\t\t\tif ( binding.rendered ) { handleDomEvent.call( this$1 ); }\n\t\t\ttimeout = null;\n\t\t}, delay );\n\t};\n}\n\nvar GenericBinding = (function (Binding$$1) {\n\tfunction GenericBinding () {\n\t\tBinding$$1.apply(this, arguments);\n\t}\n\n\tif ( Binding$$1 ) GenericBinding.__proto__ = Binding$$1;\n\tGenericBinding.prototype = Object.create( Binding$$1 && Binding$$1.prototype );\n\tGenericBinding.prototype.constructor = GenericBinding;\n\n\tGenericBinding.prototype.getInitialValue = function getInitialValue () {\n\t\treturn '';\n\t};\n\n\tGenericBinding.prototype.getValue = function getValue () {\n\t\treturn this.node.value;\n\t};\n\n\tGenericBinding.prototype.render = function render () {\n\t\tBinding$$1.prototype.render.call(this);\n\n\t\t// any lazy setting for this element overrides the root\n\t\t// if the value is a number, it's a timeout\n\t\tvar lazy = this.ractive.lazy;\n\t\tvar timeout = false;\n\n\t\tif ( 'lazy' in this.element ) {\n\t\t\tlazy = this.element.lazy;\n\t\t}\n\n\t\tif ( isNumeric( lazy ) ) {\n\t\t\ttimeout = +lazy;\n\t\t\tlazy = false;\n\t\t}\n\n\t\tthis.handler = timeout ? handleDelay( timeout ) : handleDomEvent;\n\n\t\tvar node = this.node;\n\n\t\tnode.addEventListener( 'change', handleDomEvent, false );\n\n\t\tif ( !lazy ) {\n\t\t\tnode.addEventListener( 'input', this.handler, false );\n\n\t\t\tif ( node.attachEvent ) {\n\t\t\t\tnode.addEventListener( 'keyup', this.handler, false );\n\t\t\t}\n\t\t}\n\n\t\tnode.addEventListener( 'blur', handleBlur, false );\n\t};\n\n\tGenericBinding.prototype.unrender = function unrender () {\n\t\tvar node = this.element.node;\n\t\tthis.rendered = false;\n\n\t\tnode.removeEventListener( 'change', handleDomEvent, false );\n\t\tnode.removeEventListener( 'input', this.handler, false );\n\t\tnode.removeEventListener( 'keyup', this.handler, false );\n\t\tnode.removeEventListener( 'blur', handleBlur, false );\n\t};\n\n\treturn GenericBinding;\n}(Binding));\n\nvar FileBinding = (function (GenericBinding$$1) {\n\tfunction FileBinding () {\n\t\tGenericBinding$$1.apply(this, arguments);\n\t}\n\n\tif ( GenericBinding$$1 ) FileBinding.__proto__ = GenericBinding$$1;\n\tFileBinding.prototype = Object.create( GenericBinding$$1 && GenericBinding$$1.prototype );\n\tFileBinding.prototype.constructor = FileBinding;\n\n\tFileBinding.prototype.getInitialValue = function getInitialValue () {\n\t\treturn undefined;\n\t};\n\n\tFileBinding.prototype.getValue = function getValue () {\n\t\treturn this.node.files;\n\t};\n\n\tFileBinding.prototype.render = function render () {\n\t\tthis.element.lazy = false;\n\t\tGenericBinding$$1.prototype.render.call(this);\n\t};\n\n\tFileBinding.prototype.setFromNode = function setFromNode ( node ) {\n\t\tthis.model.set( node.files );\n\t};\n\n\treturn FileBinding;\n}(GenericBinding));\n\nfunction getSelectedOptions ( select ) {\n\treturn select.selectedOptions\n\t\t? toArray( select.selectedOptions )\n\t\t: select.options\n\t\t\t? toArray( select.options ).filter( function (option) { return option.selected; } )\n\t\t\t: [];\n}\n\nvar MultipleSelectBinding = (function (Binding$$1) {\n\tfunction MultipleSelectBinding () {\n\t\tBinding$$1.apply(this, arguments);\n\t}\n\n\tif ( Binding$$1 ) MultipleSelectBinding.__proto__ = Binding$$1;\n\tMultipleSelectBinding.prototype = Object.create( Binding$$1 && Binding$$1.prototype );\n\tMultipleSelectBinding.prototype.constructor = MultipleSelectBinding;\n\n\tMultipleSelectBinding.prototype.forceUpdate = function forceUpdate () {\n\t\tvar this$1 = this;\n\n\t\tvar value = this.getValue();\n\n\t\tif ( value !== undefined ) {\n\t\t\tthis.attribute.locked = true;\n\t\t\trunloop.scheduleTask( function () { return this$1.attribute.locked = false; } );\n\t\t\tthis.model.set( value );\n\t\t}\n\t};\n\n\tMultipleSelectBinding.prototype.getInitialValue = function getInitialValue () {\n\t\treturn this.element.options\n\t\t\t.filter( function (option) { return option.getAttribute( 'selected' ); } )\n\t\t\t.map( function (option) { return option.getAttribute( 'value' ); } );\n\t};\n\n\tMultipleSelectBinding.prototype.getValue = function getValue () {\n\t\tvar options = this.element.node.options;\n\t\tvar len = options.length;\n\n\t\tvar selectedValues = [];\n\n\t\tfor ( var i = 0; i < len; i += 1 ) {\n\t\t\tvar option = options[i];\n\n\t\t\tif ( option.selected ) {\n\t\t\t\tvar optionValue = option._ractive ? option._ractive.value : option.value;\n\t\t\t\tselectedValues.push( optionValue );\n\t\t\t}\n\t\t}\n\n\t\treturn selectedValues;\n\t};\n\n\tMultipleSelectBinding.prototype.handleChange = function handleChange () {\n\t\tvar attribute = this.attribute;\n\t\tvar previousValue = attribute.getValue();\n\n\t\tvar value = this.getValue();\n\n\t\tif ( previousValue === undefined || !arrayContentsMatch( value, previousValue ) ) {\n\t\t\tBinding$$1.prototype.handleChange.call(this);\n\t\t}\n\n\t\treturn this;\n\t};\n\n\tMultipleSelectBinding.prototype.render = function render () {\n\t\tBinding$$1.prototype.render.call(this);\n\n\t\tthis.node.addEventListener( 'change', handleDomEvent, false );\n\n\t\tif ( this.model.get() === undefined ) {\n\t\t\t// get value from DOM, if possible\n\t\t\tthis.handleChange();\n\t\t}\n\t};\n\n\tMultipleSelectBinding.prototype.setFromNode = function setFromNode ( node ) {\n\t\tvar selectedOptions = getSelectedOptions( node );\n\t\tvar i = selectedOptions.length;\n\t\tvar result = new Array( i );\n\n\t\twhile ( i-- ) {\n\t\t\tvar option = selectedOptions[i];\n\t\t\tresult[i] = option._ractive ? option._ractive.value : option.value;\n\t\t}\n\n\t\tthis.model.set( result );\n\t};\n\n\tMultipleSelectBinding.prototype.setValue = function setValue () {\n\t\tthrow new Error( 'TODO not implemented yet' );\n\t};\n\n\tMultipleSelectBinding.prototype.unrender = function unrender () {\n\t\tthis.node.removeEventListener( 'change', handleDomEvent, false );\n\t};\n\n\tMultipleSelectBinding.prototype.updateModel = function updateModel () {\n\t\tif ( this.attribute.value === undefined || !this.attribute.value.length ) {\n\t\t\tthis.keypath.set( this.initialValue );\n\t\t}\n\t};\n\n\treturn MultipleSelectBinding;\n}(Binding));\n\nvar NumericBinding = (function (GenericBinding$$1) {\n\tfunction NumericBinding () {\n\t\tGenericBinding$$1.apply(this, arguments);\n\t}\n\n\tif ( GenericBinding$$1 ) NumericBinding.__proto__ = GenericBinding$$1;\n\tNumericBinding.prototype = Object.create( GenericBinding$$1 && GenericBinding$$1.prototype );\n\tNumericBinding.prototype.constructor = NumericBinding;\n\n\tNumericBinding.prototype.getInitialValue = function getInitialValue () {\n\t\treturn undefined;\n\t};\n\n\tNumericBinding.prototype.getValue = function getValue () {\n\t\tvar value = parseFloat( this.node.value );\n\t\treturn isNaN( value ) ? undefined : value;\n\t};\n\n\tNumericBinding.prototype.setFromNode = function setFromNode ( node ) {\n\t\tvar value = parseFloat( node.value );\n\t\tif ( !isNaN( value ) ) { this.model.set( value ); }\n\t};\n\n\treturn NumericBinding;\n}(GenericBinding));\n\nvar siblings = {};\n\nfunction getSiblings ( hash ) {\n\treturn siblings[ hash ] || ( siblings[ hash ] = [] );\n}\n\nvar RadioBinding = (function (Binding$$1) {\n\tfunction RadioBinding ( element ) {\n\t\tBinding$$1.call( this, element, 'checked' );\n\n\t\tthis.siblings = getSiblings( this.ractive._guid + this.element.getAttribute( 'name' ) );\n\t\tthis.siblings.push( this );\n\t}\n\n\tif ( Binding$$1 ) RadioBinding.__proto__ = Binding$$1;\n\tRadioBinding.prototype = Object.create( Binding$$1 && Binding$$1.prototype );\n\tRadioBinding.prototype.constructor = RadioBinding;\n\n\tRadioBinding.prototype.getValue = function getValue () {\n\t\treturn this.node.checked;\n\t};\n\n\tRadioBinding.prototype.handleChange = function handleChange () {\n\t\trunloop.start( this.root );\n\n\t\tthis.siblings.forEach( function (binding) {\n\t\t\tbinding.model.set( binding.getValue() );\n\t\t});\n\n\t\trunloop.end();\n\t};\n\n\tRadioBinding.prototype.render = function render () {\n\t\tBinding$$1.prototype.render.call(this);\n\n\t\tthis.node.addEventListener( 'change', handleDomEvent, false );\n\n\t\tif ( this.node.attachEvent ) {\n\t\t\tthis.node.addEventListener( 'click', handleDomEvent, false );\n\t\t}\n\t};\n\n\tRadioBinding.prototype.setFromNode = function setFromNode ( node ) {\n\t\tthis.model.set( node.checked );\n\t};\n\n\tRadioBinding.prototype.unbind = function unbind () {\n\t\tremoveFromArray( this.siblings, this );\n\t};\n\n\tRadioBinding.prototype.unrender = function unrender () {\n\t\tthis.node.removeEventListener( 'change', handleDomEvent, false );\n\t\tthis.node.removeEventListener( 'click', handleDomEvent, false );\n\t};\n\n\treturn RadioBinding;\n}(Binding));\n\nfunction getValue$2() {\n\tvar checked = this.bindings.filter( function (b) { return b.node.checked; } );\n\tif ( checked.length > 0 ) {\n\t\treturn checked[0].element.getAttribute( 'value' );\n\t}\n}\n\nvar RadioNameBinding = (function (Binding$$1) {\n\tfunction RadioNameBinding ( element ) {\n\t\tBinding$$1.call( this, element, 'name' );\n\n\t\tthis.group = getBindingGroup( 'radioname', this.model, getValue$2 );\n\t\tthis.group.add( this );\n\n\t\tif ( element.checked ) {\n\t\t\tthis.group.value = this.getValue();\n\t\t}\n\t}\n\n\tif ( Binding$$1 ) RadioNameBinding.__proto__ = Binding$$1;\n\tRadioNameBinding.prototype = Object.create( Binding$$1 && Binding$$1.prototype );\n\tRadioNameBinding.prototype.constructor = RadioNameBinding;\n\n\tRadioNameBinding.prototype.bind = function bind () {\n\t\tvar this$1 = this;\n\n\t\tif ( !this.group.bound ) {\n\t\t\tthis.group.bind();\n\t\t}\n\n\t\t// update name keypath when necessary\n\t\tthis.nameAttributeBinding = {\n\t\t\thandleChange: function () { return this$1.node.name = \"{{\" + (this$1.model.getKeypath()) + \"}}\"; }\n\t\t};\n\n\t\tthis.model.getKeypathModel().register( this.nameAttributeBinding );\n\t};\n\n\tRadioNameBinding.prototype.getInitialValue = function getInitialValue () {\n\t\tif ( this.element.getAttribute( 'checked' ) ) {\n\t\t\treturn this.element.getAttribute( 'value' );\n\t\t}\n\t};\n\n\tRadioNameBinding.prototype.getValue = function getValue$1 () {\n\t\treturn this.element.getAttribute( 'value' );\n\t};\n\n\tRadioNameBinding.prototype.handleChange = function handleChange () {\n\t\t// If this <input> is the one that's checked, then the value of its\n\t\t// `name` model gets set to its value\n\t\tif ( this.node.checked ) {\n\t\t\tthis.group.value = this.getValue();\n\t\t\tBinding$$1.prototype.handleChange.call(this);\n\t\t}\n\t};\n\n\tRadioNameBinding.prototype.lastVal = function lastVal ( setting, value ) {\n\t\tif ( !this.group ) { return; }\n\t\tif ( setting ) { this.group.lastValue = value; }\n\t\telse { return this.group.lastValue; }\n\t};\n\n\tRadioNameBinding.prototype.render = function render () {\n\t\tBinding$$1.prototype.render.call(this);\n\n\t\tvar node = this.node;\n\n\t\tnode.name = \"{{\" + (this.model.getKeypath()) + \"}}\";\n\t\tnode.checked = this.model.get() == this.element.getAttribute( 'value' );\n\n\t\tnode.addEventListener( 'change', handleDomEvent, false );\n\n\t\tif ( node.attachEvent ) {\n\t\t\tnode.addEventListener( 'click', handleDomEvent, false );\n\t\t}\n\t};\n\n\tRadioNameBinding.prototype.setFromNode = function setFromNode ( node ) {\n\t\tif ( node.checked ) {\n\t\t\tthis.group.model.set( this.element.getAttribute( 'value' ) );\n\t\t}\n\t};\n\n\tRadioNameBinding.prototype.unbind = function unbind () {\n\t\tthis.group.remove( this );\n\n\t\tthis.model.getKeypathModel().unregister( this.nameAttributeBinding );\n\t};\n\n\tRadioNameBinding.prototype.unrender = function unrender () {\n\t\tvar node = this.node;\n\n\t\tnode.removeEventListener( 'change', handleDomEvent, false );\n\t\tnode.removeEventListener( 'click', handleDomEvent, false );\n\t};\n\n\treturn RadioNameBinding;\n}(Binding));\n\nvar SingleSelectBinding = (function (Binding$$1) {\n\tfunction SingleSelectBinding () {\n\t\tBinding$$1.apply(this, arguments);\n\t}\n\n\tif ( Binding$$1 ) SingleSelectBinding.__proto__ = Binding$$1;\n\tSingleSelectBinding.prototype = Object.create( Binding$$1 && Binding$$1.prototype );\n\tSingleSelectBinding.prototype.constructor = SingleSelectBinding;\n\n\tSingleSelectBinding.prototype.forceUpdate = function forceUpdate () {\n\t\tvar this$1 = this;\n\n\t\tvar value = this.getValue();\n\n\t\tif ( value !== undefined ) {\n\t\t\tthis.attribute.locked = true;\n\t\t\trunloop.scheduleTask( function () { return this$1.attribute.locked = false; } );\n\t\t\tthis.model.set( value );\n\t\t}\n\t};\n\n\tSingleSelectBinding.prototype.getInitialValue = function getInitialValue () {\n\t\tif ( this.element.getAttribute( 'value' ) !== undefined ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar options = this.element.options;\n\t\tvar len = options.length;\n\n\t\tif ( !len ) { return; }\n\n\t\tvar value;\n\t\tvar optionWasSelected;\n\t\tvar i = len;\n\n\t\t// take the final selected option...\n\t\twhile ( i-- ) {\n\t\t\tvar option = options[i];\n\n\t\t\tif ( option.getAttribute( 'selected' ) ) {\n\t\t\t\tif ( !option.getAttribute( 'disabled' ) ) {\n\t\t\t\t\tvalue = option.getAttribute( 'value' );\n\t\t\t\t}\n\n\t\t\t\toptionWasSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\t// or the first non-disabled option, if none are selected\n\t\tif ( !optionWasSelected ) {\n\t\t\twhile ( ++i < len ) {\n\t\t\t\tif ( !options[i].getAttribute( 'disabled' ) ) {\n\t\t\t\t\tvalue = options[i].getAttribute( 'value' );\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// This is an optimisation (aka hack) that allows us to forgo some\n\t\t// other more expensive work\n\t\t// TODO does it still work? seems at odds with new architecture\n\t\tif ( value !== undefined ) {\n\t\t\tthis.element.attributeByName.value.value = value;\n\t\t}\n\n\t\treturn value;\n\t};\n\n\tSingleSelectBinding.prototype.getValue = function getValue () {\n\t\tvar options = this.node.options;\n\t\tvar len = options.length;\n\n\t\tvar i;\n\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\tvar option = options[i];\n\n\t\t\tif ( options[i].selected && !options[i].disabled ) {\n\t\t\t\treturn option._ractive ? option._ractive.value : option.value;\n\t\t\t}\n\t\t}\n\t};\n\n\tSingleSelectBinding.prototype.render = function render () {\n\t\tBinding$$1.prototype.render.call(this);\n\t\tthis.node.addEventListener( 'change', handleDomEvent, false );\n\t};\n\n\tSingleSelectBinding.prototype.setFromNode = function setFromNode ( node ) {\n\t\tvar option = getSelectedOptions( node )[0];\n\t\tthis.model.set( option._ractive ? option._ractive.value : option.value );\n\t};\n\n\t// TODO this method is an anomaly... is it necessary?\n\tSingleSelectBinding.prototype.setValue = function setValue ( value ) {\n\t\tthis.model.set( value );\n\t};\n\n\tSingleSelectBinding.prototype.unrender = function unrender () {\n\t\tthis.node.removeEventListener( 'change', handleDomEvent, false );\n\t};\n\n\treturn SingleSelectBinding;\n}(Binding));\n\nfunction isBindable ( attribute ) {\n\treturn attribute &&\n\t\t   attribute.template.f &&\n\t       attribute.template.f.length === 1 &&\n\t       attribute.template.f[0].t === INTERPOLATOR &&\n\t       !attribute.template.f[0].s;\n}\n\nfunction selectBinding ( element ) {\n\tvar attributes = element.attributeByName;\n\n\t// contenteditable - bind if the contenteditable attribute is true\n\t// or is bindable and may thus become true...\n\tif ( element.getAttribute( 'contenteditable' ) || isBindable( attributes.contenteditable ) ) {\n\t\t// ...and this element also has a value attribute to bind\n\t\treturn isBindable( attributes.value ) ? ContentEditableBinding : null;\n\t}\n\n\t// <input>\n\tif ( element.name === 'input' ) {\n\t\tvar type = element.getAttribute( 'type' );\n\n\t\tif ( type === 'radio' || type === 'checkbox' ) {\n\t\t\tvar bindName = isBindable( attributes.name );\n\t\t\tvar bindChecked = isBindable( attributes.checked );\n\n\t\t\t// for radios we can either bind the name attribute, or the checked attribute - not both\n\t\t\tif ( bindName && bindChecked ) {\n\t\t\t\tif ( type === 'radio' ) {\n\t\t\t\t\twarnIfDebug( 'A radio input can have two-way binding on its name attribute, or its checked attribute - not both', { ractive: element.root });\n\t\t\t\t} else {\n\t\t\t\t\t// A checkbox with bindings for both name and checked - see https://github.com/ractivejs/ractive/issues/1749\n\t\t\t\t\treturn CheckboxBinding;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( bindName ) {\n\t\t\t\treturn type === 'radio' ? RadioNameBinding : CheckboxNameBinding;\n\t\t\t}\n\n\t\t\tif ( bindChecked ) {\n\t\t\t\treturn type === 'radio' ? RadioBinding : CheckboxBinding;\n\t\t\t}\n\t\t}\n\n\t\tif ( type === 'file' && isBindable( attributes.value ) ) {\n\t\t\treturn FileBinding;\n\t\t}\n\n\t\tif ( isBindable( attributes.value ) ) {\n\t\t\treturn ( type === 'number' || type === 'range' ) ? NumericBinding : GenericBinding;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t// <select>\n\tif ( element.name === 'select' && isBindable( attributes.value ) ) {\n\t\treturn element.getAttribute( 'multiple' ) ? MultipleSelectBinding : SingleSelectBinding;\n\t}\n\n\t// <textarea>\n\tif ( element.name === 'textarea' && isBindable( attributes.value ) ) {\n\t\treturn GenericBinding;\n\t}\n}\n\nfunction makeDirty$2 ( query ) {\n\tquery.makeDirty();\n}\n\nvar endsWithSemi = /;\\s*$/;\n\nvar Element = (function (ContainerItem$$1) {\n\tfunction Element ( options ) {\n\t\tvar this$1 = this;\n\n\t\tContainerItem$$1.call( this, options );\n\n\t\tthis.liveQueries = []; // TODO rare case. can we handle differently?\n\n\t\tthis.name = options.template.e.toLowerCase();\n\t\tthis.isVoid = voidElementNames.test( this.name );\n\n\t\t// find parent element\n\t\tthis.parent = findElement( this.parentFragment, false );\n\n\t\tif ( this.parent && this.parent.name === 'option' ) {\n\t\t\tthrow new Error( (\"An <option> element cannot contain other elements (encountered <\" + (this.name) + \">)\") );\n\t\t}\n\n\t\tthis.decorators = [];\n\t\tthis.events = [];\n\n\t\t// create attributes\n\t\tthis.attributeByName = {};\n\n\t\tthis.attributes = [];\n\t\tvar leftovers = [];\n\t\t( this.template.m || [] ).forEach( function (template) {\n\t\t\tswitch ( template.t ) {\n\t\t\t\tcase ATTRIBUTE:\n\t\t\t\tcase BINDING_FLAG:\n\t\t\t\tcase DECORATOR:\n\t\t\t\tcase EVENT:\n\t\t\t\tcase TRANSITION:\n\t\t\t\t\tthis$1.attributes.push( createItem({\n\t\t\t\t\t\towner: this$1,\n\t\t\t\t\t\tparentFragment: this$1.parentFragment,\n\t\t\t\t\t\ttemplate: template\n\t\t\t\t\t}) );\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tleftovers.push( template );\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\n\t\tif ( leftovers.length ) {\n\t\t\tthis.attributes.push( new ConditionalAttribute({\n\t\t\t\towner: this,\n\t\t\t\tparentFragment: this.parentFragment,\n\t\t\t\ttemplate: leftovers\n\t\t\t}) );\n\t\t}\n\n\t\tthis.attributes.sort( sortAttributes );\n\n\t\t// create children\n\t\tif ( options.template.f && !options.deferContent ) {\n\t\t\tthis.fragment = new Fragment({\n\t\t\t\ttemplate: options.template.f,\n\t\t\t\towner: this,\n\t\t\t\tcssIds: null\n\t\t\t});\n\t\t}\n\n\t\tthis.binding = null; // filled in later\n\t}\n\n\tif ( ContainerItem$$1 ) Element.__proto__ = ContainerItem$$1;\n\tElement.prototype = Object.create( ContainerItem$$1 && ContainerItem$$1.prototype );\n\tElement.prototype.constructor = Element;\n\n\tElement.prototype.bind = function bind$1 () {\n\t\tthis.attributes.binding = true;\n\t\tthis.attributes.forEach( bind$1$1 );\n\t\tthis.attributes.binding = false;\n\n\t\tif ( this.fragment ) { this.fragment.bind(); }\n\n\t\t// create two-way binding if necessary\n\t\tif ( !this.binding ) { this.recreateTwowayBinding(); }\n\t};\n\n\tElement.prototype.createTwowayBinding = function createTwowayBinding () {\n\t\tif ( 'twoway' in this ? this.twoway : this.ractive.twoway ) {\n\t\t\tvar Binding = selectBinding( this );\n\t\t\tif ( Binding ) {\n\t\t\t\tvar binding = new Binding( this );\n\t\t\t\tif ( binding && binding.model ) { return binding; }\n\t\t\t}\n\t\t}\n\t};\n\n\tElement.prototype.destroyed = function destroyed$1 () {\n\t\tthis.attributes.forEach( destroyed$1$1 );\n\t\tif ( this.fragment ) { this.fragment.destroyed(); }\n\t};\n\n\tElement.prototype.detach = function detach () {\n\t\t// if this element is no longer rendered, the transitions are complete and the attributes can be torn down\n\t\tif ( !this.rendered ) { this.destroyed(); }\n\n\t\treturn detachNode( this.node );\n\t};\n\n\tElement.prototype.find = function find ( selector, options ) {\n\t\tif ( this.node && matches( this.node, selector ) ) { return this.node; }\n\t\tif ( this.fragment ) {\n\t\t\treturn this.fragment.find( selector, options );\n\t\t}\n\t};\n\n\tElement.prototype.findAll = function findAll ( selector, query ) {\n\t\t// Add this node to the query, if applicable, and register the\n\t\t// query on this element\n\t\tvar matches$$1 = query.test( this.node );\n\t\tif ( matches$$1 ) {\n\t\t\tquery.add( this.node );\n\t\t\tif ( query.live ) { this.liveQueries.push( query ); }\n\t\t}\n\n\t\tif ( this.fragment ) {\n\t\t\tthis.fragment.findAll( selector, query );\n\t\t}\n\t};\n\n\tElement.prototype.findNextNode = function findNextNode () {\n\t\treturn null;\n\t};\n\n\tElement.prototype.firstNode = function firstNode () {\n\t\treturn this.node;\n\t};\n\n\tElement.prototype.getAttribute = function getAttribute ( name ) {\n\t\tvar attribute = this.attributeByName[ name ];\n\t\treturn attribute ? attribute.getValue() : undefined;\n\t};\n\n\tElement.prototype.recreateTwowayBinding = function recreateTwowayBinding () {\n\t\tif ( this.binding ) {\n\t\t\tthis.binding.unbind();\n\t\t\tthis.binding.unrender();\n\t\t}\n\n\t\tif ( this.binding = this.createTwowayBinding() ) {\n\t\t\tthis.binding.bind();\n\t\t\tif ( this.rendered ) { this.binding.render(); }\n\t\t}\n\t};\n\n\tElement.prototype.removeFromQuery = function removeFromQuery ( query ) {\n\t\tquery.remove( this.node );\n\t\tremoveFromArray( this.liveQueries, query );\n\t};\n\n\tElement.prototype.render = function render$1 ( target, occupants ) {\n\t\tvar this$1 = this;\n\n\t\t// TODO determine correct namespace\n\t\tthis.namespace = getNamespace( this );\n\n\t\tvar node;\n\t\tvar existing = false;\n\n\t\tif ( occupants ) {\n\t\t\tvar n;\n\t\t\twhile ( ( n = occupants.shift() ) ) {\n\t\t\t\tif ( n.nodeName.toUpperCase() === this$1.template.e.toUpperCase() && n.namespaceURI === this$1.namespace ) {\n\t\t\t\t\tthis$1.node = node = n;\n\t\t\t\t\texisting = true;\n\t\t\t\t\tbreak;\n\t\t\t\t} else {\n\t\t\t\t\tdetachNode( n );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif ( !node ) {\n\t\t\tnode = createElement( this.template.e, this.namespace, this.getAttribute( 'is' ) );\n\t\t\tthis.node = node;\n\t\t}\n\n\t\t// tie the node to this vdom element\n\t\tdefineProperty( node, '_ractive', {\n\t\t\tvalue: {\n\t\t\t\tproxy: this\n\t\t\t}\n\t\t});\n\n\t\t// Is this a top-level node of a component? If so, we may need to add\n\t\t// a data-ractive-css attribute, for CSS encapsulation\n\t\tif ( this.parentFragment.cssIds ) {\n\t\t\tnode.setAttribute( 'data-ractive-css', this.parentFragment.cssIds.map( function (x) { return (\"{\" + x + \"}\"); } ).join( ' ' ) );\n\t\t}\n\n\t\tif ( existing && this.foundNode ) { this.foundNode( node ); }\n\n\t\tif ( this.fragment ) {\n\t\t\tvar children = existing ? toArray( node.childNodes ) : undefined;\n\n\t\t\tthis.fragment.render( node, children );\n\n\t\t\t// clean up leftover children\n\t\t\tif ( children ) {\n\t\t\t\tchildren.forEach( detachNode );\n\t\t\t}\n\t\t}\n\n\t\tif ( existing ) {\n\t\t\t// store initial values for two-way binding\n\t\t\tif ( this.binding && this.binding.wasUndefined ) { this.binding.setFromNode( node ); }\n\t\t\t// remove unused attributes\n\t\t\tvar i = node.attributes.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tvar name = node.attributes[i].name;\n\t\t\t\tif ( !( name in this$1.attributeByName ) ) { node.removeAttribute( name ); }\n\t\t\t}\n\t\t}\n\n\t\tthis.attributes.forEach( render$1$1 );\n\n\t\tif ( this.binding ) { this.binding.render(); }\n\n\t\tupdateLiveQueries( this );\n\n\t\tif ( this._introTransition && this.ractive.transitionsEnabled ) {\n\t\t\tthis._introTransition.isIntro = true;\n\t\t\trunloop.registerTransition( this._introTransition );\n\t\t}\n\n\t\tif ( !existing ) {\n\t\t\ttarget.appendChild( node );\n\t\t}\n\n\t\tthis.rendered = true;\n\t};\n\n\tElement.prototype.shuffled = function shuffled () {\n\t\tthis.liveQueries.forEach( makeDirty$2 );\n\t\tContainerItem$$1.prototype.shuffled.call(this);\n\t};\n\n\tElement.prototype.toString = function toString () {\n\t\tvar tagName = this.template.e;\n\n\t\tvar attrs = this.attributes.map( stringifyAttribute ).join( '' );\n\n\t\t// Special case - selected options\n\t\tif ( this.name === 'option' && this.isSelected() ) {\n\t\t\tattrs += ' selected';\n\t\t}\n\n\t\t// Special case - two-way radio name bindings\n\t\tif ( this.name === 'input' && inputIsCheckedRadio( this ) ) {\n\t\t\tattrs += ' checked';\n\t\t}\n\n\t\t// Special case style and class attributes and directives\n\t\tvar style, cls;\n\t\tthis.attributes.forEach( function (attr) {\n\t\t\tif ( attr.name === 'class' ) {\n\t\t\t\tcls = ( cls || '' ) + ( cls ? ' ' : '' ) + safeAttributeString( attr.getString() );\n\t\t\t} else if ( attr.name === 'style' ) {\n\t\t\t\tstyle = ( style || '' ) + ( style ? ' ' : '' ) + safeAttributeString( attr.getString() );\n\t\t\t\tif ( style && !endsWithSemi.test( style ) ) { style += ';'; }\n\t\t\t} else if ( attr.styleName ) {\n\t\t\t\tstyle = ( style || '' ) + ( style ? ' ' : '' ) +  (decamelize( attr.styleName )) + \": \" + (safeAttributeString( attr.getString() )) + \";\";\n\t\t\t} else if ( attr.inlineClass && attr.getValue() ) {\n\t\t\t\tcls = ( cls || '' ) + ( cls ? ' ' : '' ) + attr.inlineClass;\n\t\t\t}\n\t\t});\n\t\t// put classes first, then inline style\n\t\tif ( style !== undefined ) { attrs = ' style' + ( style ? (\"=\\\"\" + style + \"\\\"\") : '' ) + attrs; }\n\t\tif ( cls !== undefined ) { attrs = ' class' + (cls ? (\"=\\\"\" + cls + \"\\\"\") : '') + attrs; }\n\n\t\tvar str = \"<\" + tagName + attrs + \">\";\n\n\t\tif ( this.isVoid ) { return str; }\n\n\t\t// Special case - textarea\n\t\tif ( this.name === 'textarea' && this.getAttribute( 'value' ) !== undefined ) {\n\t\t\tstr += escapeHtml( this.getAttribute( 'value' ) );\n\t\t}\n\n\t\t// Special case - contenteditable\n\t\telse if ( this.getAttribute( 'contenteditable' ) !== undefined ) {\n\t\t\tstr += ( this.getAttribute( 'value' ) || '' );\n\t\t}\n\n\t\tif ( this.fragment ) {\n\t\t\tstr += this.fragment.toString( !/^(?:script|style)$/i.test( this.template.e ) ); // escape text unless script/style\n\t\t}\n\n\t\tstr += \"</\" + tagName + \">\";\n\t\treturn str;\n\t};\n\n\tElement.prototype.unbind = function unbind$1 () {\n\t\tthis.attributes.forEach( unbind$1$1 );\n\n\t\tif ( this.binding ) { this.binding.unbind(); }\n\t\tif ( this.fragment ) { this.fragment.unbind(); }\n\t};\n\n\tElement.prototype.unrender = function unrender ( shouldDestroy ) {\n\t\tvar this$1 = this;\n\n\t\tif ( !this.rendered ) { return; }\n\t\tthis.rendered = false;\n\n\t\t// unrendering before intro completed? complete it now\n\t\t// TODO should be an API for aborting transitions\n\t\tvar transition = this._introTransition;\n\t\tif ( transition && transition.complete ) { transition.complete(); }\n\n\t\t// Detach as soon as we can\n\t\tif ( this.name === 'option' ) {\n\t\t\t// <option> elements detach immediately, so that\n\t\t\t// their parent <select> element syncs correctly, and\n\t\t\t// since option elements can't have transitions anyway\n\t\t\tthis.detach();\n\t\t} else if ( shouldDestroy ) {\n\t\t\trunloop.detachWhenReady( this );\n\t\t}\n\n\t\tif ( this.fragment ) { this.fragment.unrender(); }\n\n\t\tif ( this.binding ) { this.binding.unrender(); }\n\n\t\t// outro transition\n\t\tif ( this._outroTransition && this.ractive.transitionsEnabled ) {\n\t\t\tthis._outroTransition.isIntro = false;\n\t\t\trunloop.registerTransition( this._outroTransition );\n\t\t}\n\n\t\tthis.liveQueries.forEach( function (query) { return query.remove( this$1.node ); } );\n\t\tthis.liveQueries = [];\n\t\t// TODO forms are a special case\n\t};\n\n\tElement.prototype.update = function update$1 () {\n\t\tif ( this.dirty ) {\n\t\t\tthis.dirty = false;\n\n\t\t\tthis.attributes.forEach( update$1$1 );\n\n\t\t\tif ( this.fragment ) { this.fragment.update(); }\n\t\t}\n\t};\n\n\treturn Element;\n}(ContainerItem));\n\nvar toFront = [ 'min', 'max', 'class', 'type' ];\nfunction sortAttributes ( left, right ) {\n\tleft = left.name;\n\tright = right.name;\n\tvar l = left === 'value' ? 1 : ~toFront.indexOf( left );\n\tvar r = right === 'value' ? 1 : ~toFront.indexOf( right );\n\treturn l < r ? -1 : l > r ? 1 : 0;\n}\n\nfunction inputIsCheckedRadio ( element ) {\n\tvar nameAttr = element.attributeByName.name;\n\treturn element.getAttribute( 'type' ) === 'radio' &&\n\t\t( nameAttr || {} ).interpolator &&\n\t\telement.getAttribute( 'value' ) === nameAttr.interpolator.model.get();\n}\n\nfunction stringifyAttribute ( attribute ) {\n\tvar str = attribute.toString();\n\treturn str ? ' ' + str : '';\n}\n\nfunction getNamespace ( element ) {\n\t// Use specified namespace...\n\tvar xmlns$$1 = element.getAttribute( 'xmlns' );\n\tif ( xmlns$$1 ) { return xmlns$$1; }\n\n\t// ...or SVG namespace, if this is an <svg> element\n\tif ( element.name === 'svg' ) { return svg$1; }\n\n\tvar parent = element.parent;\n\n\tif ( parent ) {\n\t\t// ...or HTML, if the parent is a <foreignObject>\n\t\tif ( parent.name === 'foreignobject' ) { return html; }\n\n\t\t// ...or inherit from the parent node\n\t\treturn parent.node.namespaceURI;\n\t}\n\n\treturn element.ractive.el.namespaceURI;\n}\n\nvar Form = (function (Element$$1) {\n\tfunction Form ( options ) {\n\t\tElement$$1.call( this, options );\n\t\tthis.formBindings = [];\n\t}\n\n\tif ( Element$$1 ) Form.__proto__ = Element$$1;\n\tForm.prototype = Object.create( Element$$1 && Element$$1.prototype );\n\tForm.prototype.constructor = Form;\n\n\tForm.prototype.render = function render ( target, occupants ) {\n\t\tElement$$1.prototype.render.call( this, target, occupants );\n\t\tthis.node.addEventListener( 'reset', handleReset, false );\n\t};\n\n\tForm.prototype.unrender = function unrender ( shouldDestroy ) {\n\t\tthis.node.removeEventListener( 'reset', handleReset, false );\n\t\tElement$$1.prototype.unrender.call( this, shouldDestroy );\n\t};\n\n\treturn Form;\n}(Element));\n\nfunction handleReset () {\n\tvar element = this._ractive.proxy;\n\n\trunloop.start();\n\telement.formBindings.forEach( updateModel$2 );\n\trunloop.end();\n}\n\nfunction updateModel$2 ( binding ) {\n\tbinding.model.set( binding.resetValue );\n}\n\nvar DOMEvent = function DOMEvent ( name, owner ) {\n\tif ( name.indexOf( '*' ) !== -1 ) {\n\t\tfatal( (\"Only component proxy-events may contain \\\"*\\\" wildcards, <\" + (owner.name) + \" on-\" + name + \"=\\\"...\\\"/> is not valid\") );\n\t}\n\n\tthis.name = name;\n\tthis.owner = owner;\n\tthis.node = null;\n\tthis.handler = null;\n};\n\nDOMEvent.prototype.listen = function listen ( directive ) {\n\t\tvar node = this.node = this.owner.node;\n\tvar name = this.name;\n\n\t// this is probably a custom event fired from a decorator or manually\n\t\tif ( !( (\"on\" + name) in node ) ) { return; }\n\n\tnode.addEventListener( name, this.handler = function( event ) {\n\t\tdirective.fire({\n\t\t\tnode: node,\n\t\t\toriginal: event\n\t\t});\n\t}, false );\n};\n\nDOMEvent.prototype.unlisten = function unlisten () {\n\tif ( this.handler ) { this.node.removeEventListener( this.name, this.handler, false ); }\n};\n\nvar CustomEvent = function CustomEvent ( eventPlugin, owner ) {\n\tthis.eventPlugin = eventPlugin;\n\tthis.owner = owner;\n\tthis.handler = null;\n};\n\nCustomEvent.prototype.listen = function listen ( directive ) {\n\tvar node = this.owner.node;\n\n\tthis.handler = this.eventPlugin( node, function ( event ) {\n\t\t\tif ( event === void 0 ) event = {};\n\n\t\tevent.node = event.node || node;\n\t\tdirective.fire( event );\n\t\t});\n\t};\n\n\tCustomEvent.prototype.unlisten = function unlisten () {\n\t\tthis.handler.teardown();\n};\n\nvar RactiveEvent = function RactiveEvent ( component, name ) {\n\tthis.component = component;\n\tthis.name = name;\n\tthis.handler = null;\n};\n\nRactiveEvent.prototype.listen = function listen ( directive ) {\n\tvar ractive = this.component.instance;\n\n\tthis.handler = ractive.on( this.name, function () {\n\t\tvar event;\n\n\t\t// semi-weak test, but what else? tag the event obj ._isEvent ?\n\t\tif ( arguments.length && arguments[0] && arguments[0].node ) {\n\t\t\tevent = Array.prototype.shift.call( arguments );\n\t\t\tevent.component = ractive;\n\t\t}\n\n\t\tvar args = Array.prototype.slice.call( arguments );\n\t\tdirective.fire( event, args );\n\n\t\t// cancel bubbling\n\t\treturn false;\n\t});\n};\n\nRactiveEvent.prototype.unlisten = function unlisten () {\n\tthis.handler.cancel();\n};\n\nvar specialPattern = /^(event|arguments)(\\..+)?$/;\nvar dollarArgsPattern = /^\\$(\\d+)(\\..+)?$/;\n\nvar EventDirective = function EventDirective ( options ) {\n\tvar this$1 = this;\n\n\tthis.owner = options.owner || options.parentFragment.owner || findElement( options.parentFragment );\n\tthis.element = this.owner.attributeByName ? this.owner : findElement( options.parentFragment, true );\n\tthis.template = options.template;\n\tthis.parentFragment = options.parentFragment;\n\tthis.ractive = options.parentFragment.ractive;\n\n\tthis.events = [];\n\n\tif ( this.element.type === COMPONENT || this.element.type === ANCHOR ) {\n\t\tthis.template.n.forEach( function (n) {\n\t\t\tthis$1.events.push( new RactiveEvent( this$1.element, n ) );\n\t\t});\n\t} else {\n\t\tthis.template.n.forEach( function (n) {\n\t\t\tvar fn = findInViewHierarchy( 'events', this$1.ractive, n );\n\t\t\t// we need to pass in \"this\" in order to get\n\t\t\t// access to node when it is created.\n\t\t\tthis$1.events.push( fn ? new CustomEvent( fn, this$1.element ) : new DOMEvent( n, this$1.element ) );\n\t\t});\n\t}\n\n\t// method calls\n\tthis.resolvers = null;\n\tthis.models = null;\n};\n\nEventDirective.prototype.bind = function bind () {\n\taddToArray( this.element.events, this );\n\n\tsetupArgsFn( this, this.template, this.parentFragment, {\n\t\tspecialRef: function specialRef ( ref ) {\n\t\t\tvar specialMatch = specialPattern.exec( ref );\n\t\t\tif ( specialMatch ) {\n\t\t\t\t// on-click=\"foo(event.node)\"\n\t\t\t\treturn {\n\t\t\t\t\tspecial: specialMatch[1],\n\t\t\t\t\tkeys: specialMatch[2] ? splitKeypath( specialMatch[2].substr(1) ) : []\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tvar dollarMatch = dollarArgsPattern.exec( ref );\n\t\t\tif ( dollarMatch ) {\n\t\t\t\t// on-click=\"foo($1)\"\n\t\t\t\treturn {\n\t\t\t\t\tspecial: 'arguments',\n\t\t\t\t\tkeys: [ dollarMatch[1] - 1 ].concat( dollarMatch[2] ? splitKeypath( dollarMatch[2].substr( 1 ) ) : [] )\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t});\n\tif ( !this.fn ) { this.action = this.template.f; }\n};\n\nEventDirective.prototype.bubble = function bubble () {\n\tif ( !this.dirty ) {\n\t\tthis.dirty = true;\n\t\tthis.owner.bubble();\n\t}\n};\n\nEventDirective.prototype.destroyed = function destroyed () {\n\tthis.events.forEach( function (e) { return e.unlisten(); } );\n};\n\nEventDirective.prototype.fire = function fire ( event, passedArgs ) {\n\t\tif ( passedArgs === void 0 ) passedArgs = [];\n\n\n\t// augment event object\n\tif ( event && !event.hasOwnProperty( '_element' ) ) {\n\t\t   addHelpers( event, this.owner );\n\t}\n\n\tif ( this.fn ) {\n\t\tvar values = [];\n\n\t\tif ( event ) { passedArgs.unshift( event ); }\n\n\t\tif ( this.models ) {\n\t\t\tthis.models.forEach( function (model) {\n\t\t\t\tif ( !model ) { return values.push( undefined ); }\n\n\t\t\t\tif ( model.special ) {\n\t\t\t\t\tvar obj = model.special === 'event' ? event : passedArgs;\n\t\t\t\t\tvar keys = model.keys.slice();\n\n\t\t\t\t\twhile ( keys.length ) { obj = obj[ keys.shift() ]; }\n\t\t\t\t\treturn values.push( obj );\n\t\t\t\t}\n\n\t\t\t\tif ( model.wrapper ) {\n\t\t\t\t\treturn values.push( model.wrapperValue );\n\t\t\t\t}\n\n\t\t\t\tvalues.push( model.get() );\n\t\t\t});\n\t\t}\n\n\t\t// make event available as `this.event`\n\t\tvar ractive = this.ractive;\n\t\tvar oldEvent = ractive.event;\n\n\t\tractive.event = event;\n\t\tvar result = this.fn.apply( ractive, values ).pop();\n\n\t\t// Auto prevent and stop if return is explicitly false\n\t\tif ( result === false ) {\n\t\t\tvar original = event ? event.original : undefined;\n\t\t\tif ( original ) {\n\t\t\t\toriginal.preventDefault && original.preventDefault();\n\t\t\t\toriginal.stopPropagation && original.stopPropagation();\n\t\t\t} else {\n\t\t\t\twarnOnceIfDebug( (\"handler '\" + (this.template.n.join( ' ' )) + \"' returned false, but there is no event available to cancel\") );\n\t\t\t}\n\t\t}\n\n\t\tractive.event = oldEvent;\n\t}\n\n\telse {\n\t\tvar args = [];\n\t\tif ( passedArgs.length ) { args = args.concat( passedArgs ); }\n\t\tif ( event ) { event.name = this.action; }\n\n\t\tfireEvent( this.ractive, this.action, {\n\t\t\tevent: event,\n\t\t\targs: args\n\t\t});\n\t}\n};\n\nEventDirective.prototype.handleChange = function handleChange () {};\n\nEventDirective.prototype.rebinding = function rebinding ( next, previous ) {\n\t\tvar this$1 = this;\n\n\tif ( !this.models ) { return; }\n\tvar idx = this.models.indexOf( previous );\n\n\tif ( ~idx ) {\n\t\tthis.models.splice( idx, 1, next );\n\t\tprevious.unregister( this );\n\t\tif ( next ) { next.addShuffleTask( function () { return next.register( this$1 ); } ); }\n\t}\n};\n\nEventDirective.prototype.render = function render () {\n\t\tvar this$1 = this;\n\n\t// render events after everything else, so they fire after bindings\n\trunloop.scheduleTask( function () { return this$1.events.forEach( function (e) { return e.listen( this$1 ); }, true ); } );\n};\n\nEventDirective.prototype.toString = function toString () { return ''; };\n\nEventDirective.prototype.unbind = function unbind () {\n\tremoveFromArray( this.element.events, this );\n\n\tteardownArgsFn( this, this.template );\n};\n\nEventDirective.prototype.unrender = function unrender () {\n\tthis.events.forEach( function (e) { return e.unlisten(); } );\n};\n\nEventDirective.prototype.update = function update () {\n\t// noop\n};\n\nvar Mustache = (function (Item$$1) {\n\tfunction Mustache ( options ) {\n\t\tItem$$1.call( this, options );\n\n\t\tthis.parentFragment = options.parentFragment;\n\t\tthis.template = options.template;\n\t\tthis.index = options.index;\n\t\tif ( options.owner ) { this.parent = options.owner; }\n\n\t\tthis.isStatic = !!options.template.s;\n\n\t\tthis.model = null;\n\t\tthis.dirty = false;\n\t}\n\n\tif ( Item$$1 ) Mustache.__proto__ = Item$$1;\n\tMustache.prototype = Object.create( Item$$1 && Item$$1.prototype );\n\tMustache.prototype.constructor = Mustache;\n\n\tMustache.prototype.bind = function bind () {\n\t\tvar this$1 = this;\n\n\t\t// yield mustaches should resolve in container context\n\t\tvar start = this.containerFragment || this.parentFragment;\n\t\t// try to find a model for this view\n\t\tvar model = resolve$3( start, this.template );\n\t\tvar value = model ? model.get() : undefined;\n\n\t\tif ( this.isStatic ) {\n\t\t\tthis.model = { get: function () { return value; } };\n\t\t\treturn;\n\t\t}\n\n\t\tif ( model ) {\n\t\t\tmodel.register( this );\n\t\t\tthis.model = model;\n\t\t} else {\n\t\t\tthis.resolver = start.resolve( this.template.r, function (model) {\n\t\t\t\tthis$1.model = model;\n\t\t\t\tmodel.register( this$1 );\n\n\t\t\t\tthis$1.handleChange();\n\t\t\t\tthis$1.resolver = null;\n\t\t\t});\n\t\t}\n\t};\n\n\tMustache.prototype.handleChange = function handleChange () {\n\t\tthis.bubble();\n\t};\n\n\tMustache.prototype.rebinding = function rebinding ( next, previous, safe ) {\n\t\tnext = rebindMatch( this.template, next, previous );\n\t\tif ( this.static ) { return false; }\n\t\tif ( next === this.model ) { return false; }\n\n\t\tif ( this.model ) {\n\t\t\tthis.model.unregister( this );\n\t\t}\n\t\tif ( next ) { next.addShuffleRegister( this, 'mark' ); }\n\t\tthis.model = next;\n\t\tif ( !safe ) { this.handleChange(); }\n\t\treturn true;\n\t};\n\n\tMustache.prototype.unbind = function unbind () {\n\t\tif ( !this.isStatic ) {\n\t\t\tthis.model && this.model.unregister( this );\n\t\t\tthis.model = undefined;\n\t\t\tthis.resolver && this.resolver.unbind();\n\t\t}\n\t};\n\n\treturn Mustache;\n}(Item));\n\nvar MustacheContainer = (function (ContainerItem$$1) {\n\tfunction MustacheContainer ( options ) {\n\t\tContainerItem$$1.call( this, options );\n\t}\n\n\tif ( ContainerItem$$1 ) MustacheContainer.__proto__ = ContainerItem$$1;\n\tMustacheContainer.prototype = Object.create( ContainerItem$$1 && ContainerItem$$1.prototype );\n\tMustacheContainer.prototype.constructor = MustacheContainer;\n\n\treturn MustacheContainer;\n}(ContainerItem));\nvar proto$1 = MustacheContainer.prototype;\nvar mustache = Mustache.prototype;\nproto$1.bind = mustache.bind;\nproto$1.handleChange = mustache.handleChange;\nproto$1.rebinding = mustache.rebinding;\nproto$1.unbind = mustache.unbind;\n\nvar Interpolator = (function (Mustache$$1) {\n\tfunction Interpolator () {\n\t\tMustache$$1.apply(this, arguments);\n\t}\n\n\tif ( Mustache$$1 ) Interpolator.__proto__ = Mustache$$1;\n\tInterpolator.prototype = Object.create( Mustache$$1 && Mustache$$1.prototype );\n\tInterpolator.prototype.constructor = Interpolator;\n\n\tInterpolator.prototype.bubble = function bubble () {\n\t\tif ( this.owner ) { this.owner.bubble(); }\n\t\tMustache$$1.prototype.bubble.call(this);\n\t};\n\n\tInterpolator.prototype.detach = function detach () {\n\t\treturn detachNode( this.node );\n\t};\n\n\tInterpolator.prototype.firstNode = function firstNode () {\n\t\treturn this.node;\n\t};\n\n\tInterpolator.prototype.getString = function getString () {\n\t\treturn this.model ? safeToStringValue( this.model.get() ) : '';\n\t};\n\n\tInterpolator.prototype.render = function render ( target, occupants ) {\n\t\tif ( inAttributes() ) { return; }\n\t\tvar value = this.getString();\n\n\t\tthis.rendered = true;\n\n\t\tif ( occupants ) {\n\t\t\tvar n = occupants[0];\n\t\t\tif ( n && n.nodeType === 3 ) {\n\t\t\t\toccupants.shift();\n\t\t\t\tif ( n.nodeValue !== value ) {\n\t\t\t\t\tn.nodeValue = value;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tn = this.node = doc.createTextNode( value );\n\t\t\t\tif ( occupants[0] ) {\n\t\t\t\t\ttarget.insertBefore( n, occupants[0] );\n\t\t\t\t} else {\n\t\t\t\t\ttarget.appendChild( n );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.node = n;\n\t\t} else {\n\t\t\tthis.node = doc.createTextNode( value );\n\t\t\ttarget.appendChild( this.node );\n\t\t}\n\t};\n\n\tInterpolator.prototype.toString = function toString ( escape ) {\n\t\tvar string = this.getString();\n\t\treturn escape ? escapeHtml( string ) : string;\n\t};\n\n\tInterpolator.prototype.unrender = function unrender ( shouldDestroy ) {\n\t\tif ( shouldDestroy ) { this.detach(); }\n\t\tthis.rendered = false;\n\t};\n\n\tInterpolator.prototype.update = function update () {\n\t\tif ( this.dirty ) {\n\t\t\tthis.dirty = false;\n\t\t\tif ( this.rendered ) {\n\t\t\t\tthis.node.data = this.getString();\n\t\t\t}\n\t\t}\n\t};\n\n\tInterpolator.prototype.valueOf = function valueOf () {\n\t\treturn this.model ? this.model.get() : undefined;\n\t};\n\n\treturn Interpolator;\n}(Mustache));\n\nvar Input = (function (Element$$1) {\n\tfunction Input () {\n\t\tElement$$1.apply(this, arguments);\n\t}\n\n\tif ( Element$$1 ) Input.__proto__ = Element$$1;\n\tInput.prototype = Object.create( Element$$1 && Element$$1.prototype );\n\tInput.prototype.constructor = Input;\n\n\tInput.prototype.render = function render ( target, occupants ) {\n\t\tElement$$1.prototype.render.call( this, target, occupants );\n\t\tthis.node.defaultValue = this.node.value;\n\t};\n\n\treturn Input;\n}(Element));\n\nvar leadingWhitespace = /^\\s+/;\n\nvar ParseError = function ( message ) {\n\tthis.name = 'ParseError';\n\tthis.message = message;\n\ttry {\n\t\tthrow new Error(message);\n\t} catch (e) {\n\t\tthis.stack = e.stack;\n\t}\n};\n\nParseError.prototype = Error.prototype;\n\nvar Parser = function ( str, options ) {\n\tvar item;\n\tvar lineStart = 0;\n\n\tthis.str = str;\n\tthis.options = options || {};\n\tthis.pos = 0;\n\n\tthis.lines = this.str.split( '\\n' );\n\tthis.lineEnds = this.lines.map( function (line) {\n\t\tvar lineEnd = lineStart + line.length + 1; // +1 for the newline\n\n\t\tlineStart = lineEnd;\n\t\treturn lineEnd;\n\t}, 0 );\n\n\t// Custom init logic\n\tif ( this.init ) { this.init( str, options ); }\n\n\tvar items = [];\n\n\twhile ( ( this.pos < this.str.length ) && ( item = this.read() ) ) {\n\t\titems.push( item );\n\t}\n\n\tthis.leftover = this.remaining();\n\tthis.result = this.postProcess ? this.postProcess( items, options ) : items;\n};\n\nParser.prototype = {\n\tread: function read ( converters ) {\n\t\tvar this$1 = this;\n\n\t\tvar i, item;\n\n\t\tif ( !converters ) { converters = this.converters; }\n\n\t\tvar pos = this.pos;\n\n\t\tvar len = converters.length;\n\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\tthis$1.pos = pos; // reset for each attempt\n\n\t\t\tif ( item = converters[i]( this$1 ) ) {\n\t\t\t\treturn item;\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t},\n\n\tgetContextMessage: function getContextMessage ( pos, message ) {\n\t\tvar ref = this.getLinePos( pos );\n\t\tvar lineNum = ref[0];\n\t\tvar columnNum = ref[1];\n\t\tif ( this.options.contextLines === -1 ) {\n\t\t\treturn [ lineNum, columnNum, (message + \" at line \" + lineNum + \" character \" + columnNum) ];\n\t\t}\n\n\t\tvar line = this.lines[ lineNum - 1 ];\n\n\t\tvar contextUp = '';\n\t\tvar contextDown = '';\n\t\tif ( this.options.contextLines ) {\n\t\t\tvar start = lineNum - 1 - this.options.contextLines < 0 ? 0 : lineNum - 1 - this.options.contextLines;\n\t\t\tcontextUp = this.lines.slice( start, lineNum - 1 - start ).join( '\\n' ).replace( /\\t/g, '  ' );\n\t\t\tcontextDown = this.lines.slice( lineNum, lineNum + this.options.contextLines ).join( '\\n' ).replace( /\\t/g, '  ' );\n\t\t\tif ( contextUp ) {\n\t\t\t\tcontextUp += '\\n';\n\t\t\t}\n\t\t\tif ( contextDown ) {\n\t\t\t\tcontextDown = '\\n' + contextDown;\n\t\t\t}\n\t\t}\n\n\t\tvar numTabs = 0;\n\t\tvar annotation = contextUp + line.replace( /\\t/g, function ( match, char ) {\n\t\t\tif ( char < columnNum ) {\n\t\t\t\tnumTabs += 1;\n\t\t\t}\n\n\t\t\treturn '  ';\n\t\t}) + '\\n' + new Array( columnNum + numTabs ).join( ' ' ) + '^----' + contextDown;\n\n\t\treturn [ lineNum, columnNum, (message + \" at line \" + lineNum + \" character \" + columnNum + \":\\n\" + annotation) ];\n\t},\n\n\tgetLinePos: function getLinePos ( char ) {\n\t\tvar this$1 = this;\n\n\t\tvar lineNum = 0;\n\t\tvar lineStart = 0;\n\n\t\twhile ( char >= this.lineEnds[ lineNum ] ) {\n\t\t\tlineStart = this$1.lineEnds[ lineNum ];\n\t\t\tlineNum += 1;\n\t\t}\n\n\t\tvar columnNum = char - lineStart;\n\t\treturn [ lineNum + 1, columnNum + 1, char ]; // line/col should be one-based, not zero-based!\n\t},\n\n\terror: function error ( message ) {\n\t\tvar ref = this.getContextMessage( this.pos, message );\n\t\tvar lineNum = ref[0];\n\t\tvar columnNum = ref[1];\n\t\tvar msg = ref[2];\n\n\t\tvar error = new ParseError( msg );\n\n\t\terror.line = lineNum;\n\t\terror.character = columnNum;\n\t\terror.shortMessage = message;\n\n\t\tthrow error;\n\t},\n\n\tmatchString: function matchString ( string ) {\n\t\tif ( this.str.substr( this.pos, string.length ) === string ) {\n\t\t\tthis.pos += string.length;\n\t\t\treturn string;\n\t\t}\n\t},\n\n\tmatchPattern: function matchPattern ( pattern ) {\n\t\tvar match;\n\n\t\tif ( match = pattern.exec( this.remaining() ) ) {\n\t\t\tthis.pos += match[0].length;\n\t\t\treturn match[1] || match[0];\n\t\t}\n\t},\n\n\tallowWhitespace: function allowWhitespace () {\n\t\tthis.matchPattern( leadingWhitespace );\n\t},\n\n\tremaining: function remaining () {\n\t\treturn this.str.substring( this.pos );\n\t},\n\n\tnextChar: function nextChar () {\n\t\treturn this.str.charAt( this.pos );\n\t}\n};\n\nParser.extend = function ( proto ) {\n\tvar Parent = this;\n\tvar Child = function ( str, options ) {\n\t\tParser.call( this, str, options );\n\t};\n\n\tChild.prototype = create( Parent.prototype );\n\n\tfor ( var key in proto ) {\n\t\tif ( hasOwn.call( proto, key ) ) {\n\t\t\tChild.prototype[ key ] = proto[ key ];\n\t\t}\n\t}\n\n\tChild.extend = Parser.extend;\n\treturn Child;\n};\n\n// Match one or more characters until: \", ', \\, or EOL/EOF.\n// EOL/EOF is written as (?!.) (meaning there's no non-newline char next).\nvar stringMiddlePattern = /^(?=.)[^\"'\\\\]+?(?:(?!.)|(?=[\"'\\\\]))/;\n\n// Match one escape sequence, including the backslash.\nvar escapeSequencePattern = /^\\\\(?:['\"\\\\bfnrt]|0(?![0-9])|x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|(?=.)[^ux0-9])/;\n\n// Match one ES5 line continuation (backslash + line terminator).\nvar lineContinuationPattern = /^\\\\(?:\\r\\n|[\\u000A\\u000D\\u2028\\u2029])/;\n\n// Helper for defining getDoubleQuotedString and getSingleQuotedString.\nvar makeQuotedStringMatcher = function ( okQuote ) {\n\treturn function ( parser ) {\n\t\tvar literal = '\"';\n\t\tvar done = false;\n\t\tvar next;\n\n\t\twhile ( !done ) {\n\t\t\tnext = ( parser.matchPattern( stringMiddlePattern ) || parser.matchPattern( escapeSequencePattern ) ||\n\t\t\t\tparser.matchString( okQuote ) );\n\t\t\tif ( next ) {\n\t\t\t\tif ( next === \"\\\"\" ) {\n\t\t\t\t\tliteral += \"\\\\\\\"\";\n\t\t\t\t} else if ( next === \"\\\\'\" ) {\n\t\t\t\t\tliteral += \"'\";\n\t\t\t\t} else {\n\t\t\t\t\tliteral += next;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tnext = parser.matchPattern( lineContinuationPattern );\n\t\t\t\tif ( next ) {\n\t\t\t\t\t// convert \\(newline-like) into a \\u escape, which is allowed in JSON\n\t\t\t\t\tliteral += '\\\\u' + ( '000' + next.charCodeAt(1).toString(16) ).slice( -4 );\n\t\t\t\t} else {\n\t\t\t\t\tdone = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tliteral += '\"';\n\n\t\t// use JSON.parse to interpret escapes\n\t\treturn JSON.parse( literal );\n\t};\n};\n\nvar getSingleQuotedString = makeQuotedStringMatcher( \"\\\"\" );\nvar getDoubleQuotedString = makeQuotedStringMatcher( \"'\" );\n\nvar readStringLiteral = function ( parser ) {\n\tvar start = parser.pos;\n\n\tif ( parser.matchString( '\"' ) ) {\n\t\tvar string = getDoubleQuotedString( parser );\n\n\t\tif ( !parser.matchString( '\"' ) ) {\n\t\t\tparser.pos = start;\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\tt: STRING_LITERAL,\n\t\t\tv: string\n\t\t};\n\t}\n\n\tif ( parser.matchString( \"'\" ) ) {\n\t\tvar string$1 = getSingleQuotedString( parser );\n\n\t\tif ( !parser.matchString( \"'\" ) ) {\n\t\t\tparser.pos = start;\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\tt: STRING_LITERAL,\n\t\t\tv: string$1\n\t\t};\n\t}\n\n\treturn null;\n};\n\n// bulletproof number regex from https://gist.github.com/Rich-Harris/7544330\nvar numberPattern$1 = /^(?:[+-]?)0*(?:(?:(?:[1-9]\\d*)?\\.\\d+)|(?:(?:0|[1-9]\\d*)\\.)|(?:0|[1-9]\\d*))(?:[eE][+-]?\\d+)?/;\n\nfunction readNumberLiteral ( parser ) {\n\tvar result;\n\n\tif ( result = parser.matchPattern( numberPattern$1 ) ) {\n\t\treturn {\n\t\t\tt: NUMBER_LITERAL,\n\t\t\tv: result\n\t\t};\n\t}\n\n\treturn null;\n}\n\nvar name = /^[a-zA-Z_$][a-zA-Z_$0-9]*/;\n\nvar identifier = /^[a-zA-Z_$][a-zA-Z_$0-9]*$/;\n\n// http://mathiasbynens.be/notes/javascript-properties\n// can be any name, string literal, or number literal\nfunction readKey ( parser ) {\n\tvar token;\n\n\tif ( token = readStringLiteral( parser ) ) {\n\t\treturn identifier.test( token.v ) ? token.v : '\"' + token.v.replace( /\"/g, '\\\\\"' ) + '\"';\n\t}\n\n\tif ( token = readNumberLiteral( parser ) ) {\n\t\treturn token.v;\n\t}\n\n\tif ( token = parser.matchPattern( name ) ) {\n\t\treturn token;\n\t}\n\n\treturn null;\n}\n\n// simple JSON parser, without the restrictions of JSON parse\n// (i.e. having to double-quote keys).\n//\n// If passed a hash of values as the second argument, ${placeholders}\n// will be replaced with those values\n\nvar specials$1 = {\n\ttrue: true,\n\tfalse: false,\n\tnull: null,\n\tundefined: undefined\n};\n\nvar specialsPattern = new RegExp( '^(?:' + Object.keys( specials$1 ).join( '|' ) + ')' );\nvar numberPattern = /^(?:[+-]?)(?:(?:(?:0|[1-9]\\d*)?\\.\\d+)|(?:(?:0|[1-9]\\d*)\\.)|(?:0|[1-9]\\d*))(?:[eE][+-]?\\d+)?/;\nvar placeholderPattern = /\\$\\{([^\\}]+)\\}/g;\nvar placeholderAtStartPattern = /^\\$\\{([^\\}]+)\\}/;\nvar onlyWhitespace = /^\\s*$/;\n\nvar JsonParser = Parser.extend({\n\tinit: function init ( str, options ) {\n\t\tthis.values = options.values;\n\t\tthis.allowWhitespace();\n\t},\n\n\tpostProcess: function postProcess ( result ) {\n\t\tif ( result.length !== 1 || !onlyWhitespace.test( this.leftover ) ) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn { value: result[0].v };\n\t},\n\n\tconverters: [\n\t\tfunction getPlaceholder ( parser ) {\n\t\t\tif ( !parser.values ) { return null; }\n\n\t\t\tvar placeholder = parser.matchPattern( placeholderAtStartPattern );\n\n\t\t\tif ( placeholder && ( parser.values.hasOwnProperty( placeholder ) ) ) {\n\t\t\t\treturn { v: parser.values[ placeholder ] };\n\t\t\t}\n\t\t},\n\n\t\tfunction getSpecial ( parser ) {\n\t\t\tvar special = parser.matchPattern( specialsPattern );\n\t\t\tif ( special ) { return { v: specials$1[ special ] }; }\n\t\t},\n\n\t\tfunction getNumber ( parser ) {\n\t\t\tvar number = parser.matchPattern( numberPattern );\n\t\t\tif ( number ) { return { v: +number }; }\n\t\t},\n\n\t\tfunction getString ( parser ) {\n\t\t\tvar stringLiteral = readStringLiteral( parser );\n\t\t\tvar values = parser.values;\n\n\t\t\tif ( stringLiteral && values ) {\n\t\t\t\treturn {\n\t\t\t\t\tv: stringLiteral.v.replace( placeholderPattern, function ( match, $1 ) { return ( $1 in values ? values[ $1 ] : $1 ); } )\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn stringLiteral;\n\t\t},\n\n\t\tfunction getObject ( parser ) {\n\t\t\tif ( !parser.matchString( '{' ) ) { return null; }\n\n\t\t\tvar result = {};\n\n\t\t\tparser.allowWhitespace();\n\n\t\t\tif ( parser.matchString( '}' ) ) {\n\t\t\t\treturn { v: result };\n\t\t\t}\n\n\t\t\tvar pair;\n\t\t\twhile ( pair = getKeyValuePair( parser ) ) {\n\t\t\t\tresult[ pair.key ] = pair.value;\n\n\t\t\t\tparser.allowWhitespace();\n\n\t\t\t\tif ( parser.matchString( '}' ) ) {\n\t\t\t\t\treturn { v: result };\n\t\t\t\t}\n\n\t\t\t\tif ( !parser.matchString( ',' ) ) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\n\t\tfunction getArray ( parser ) {\n\t\t\tif ( !parser.matchString( '[' ) ) { return null; }\n\n\t\t\tvar result = [];\n\n\t\t\tparser.allowWhitespace();\n\n\t\t\tif ( parser.matchString( ']' ) ) {\n\t\t\t\treturn { v: result };\n\t\t\t}\n\n\t\t\tvar valueToken;\n\t\t\twhile ( valueToken = parser.read() ) {\n\t\t\t\tresult.push( valueToken.v );\n\n\t\t\t\tparser.allowWhitespace();\n\n\t\t\t\tif ( parser.matchString( ']' ) ) {\n\t\t\t\t\treturn { v: result };\n\t\t\t\t}\n\n\t\t\t\tif ( !parser.matchString( ',' ) ) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tparser.allowWhitespace();\n\t\t\t}\n\n\t\t\treturn null;\n\t\t}\n\t]\n});\n\nfunction getKeyValuePair ( parser ) {\n\tparser.allowWhitespace();\n\n\tvar key = readKey( parser );\n\n\tif ( !key ) { return null; }\n\n\tvar pair = { key: key };\n\n\tparser.allowWhitespace();\n\tif ( !parser.matchString( ':' ) ) {\n\t\treturn null;\n\t}\n\tparser.allowWhitespace();\n\n\tvar valueToken = parser.read();\n\n\tif ( !valueToken ) { return null; }\n\n\tpair.value = valueToken.v;\n\treturn pair;\n}\n\nvar parseJSON = function ( str, values ) {\n\tvar parser = new JsonParser( str, { values: values });\n\treturn parser.result;\n};\n\nvar Mapping = (function (Item$$1) {\n\tfunction Mapping ( options ) {\n\t\tItem$$1.call( this, options );\n\n\t\tthis.name = options.template.n;\n\n\t\tthis.owner = options.owner || options.parentFragment.owner || options.element || findElement( options.parentFragment );\n\t\tthis.element = options.element || (this.owner.attributeByName ? this.owner : findElement( options.parentFragment ) );\n\t\tthis.parentFragment = this.element.parentFragment; // shared\n\t\tthis.ractive = this.parentFragment.ractive;\n\n\t\tthis.fragment = null;\n\n\t\tthis.element.attributeByName[ this.name ] = this;\n\n\t\tthis.value = options.template.f;\n\t}\n\n\tif ( Item$$1 ) Mapping.__proto__ = Item$$1;\n\tMapping.prototype = Object.create( Item$$1 && Item$$1.prototype );\n\tMapping.prototype.constructor = Mapping;\n\n\tMapping.prototype.bind = function bind () {\n\t\tif ( this.fragment ) {\n\t\t\tthis.fragment.bind();\n\t\t}\n\n\t\tvar template = this.template.f;\n\t\tvar viewmodel = this.element.instance.viewmodel;\n\n\t\tif ( template === 0 ) {\n\t\t\t// empty attributes are `true`\n\t\t\tviewmodel.joinKey( this.name ).set( true );\n\t\t}\n\n\t\telse if ( typeof template === 'string' ) {\n\t\t\tvar parsed = parseJSON( template );\n\t\t\tviewmodel.joinKey( this.name ).set( parsed ? parsed.value : template );\n\t\t}\n\n\t\telse if ( isArray( template ) ) {\n\t\t\tcreateMapping( this, true );\n\t\t}\n\t};\n\n\tMapping.prototype.render = function render () {};\n\n\tMapping.prototype.unbind = function unbind () {\n\t\tif ( this.fragment ) { this.fragment.unbind(); }\n\t\tif ( this.boundFragment ) { this.boundFragment.unbind(); }\n\n\t\tif ( this.element.bound ) {\n\t\t\tif ( this.link.target === this.model ) { this.link.owner.unlink(); }\n\t\t}\n\t};\n\n\tMapping.prototype.unrender = function unrender () {};\n\n\tMapping.prototype.update = function update () {\n\t\tif ( this.dirty ) {\n\t\t\tthis.dirty = false;\n\t\t\tif ( this.fragment ) { this.fragment.update(); }\n\t\t\tif ( this.boundFragment ) { this.boundFragment.update(); }\n\t\t\tif ( this.rendered ) { this.updateDelegate(); }\n\t\t}\n\t};\n\n\treturn Mapping;\n}(Item));\n\nfunction createMapping ( item ) {\n\tvar template = item.template.f;\n\tvar viewmodel = item.element.instance.viewmodel;\n\tvar childData = viewmodel.value;\n\n\tif ( template.length === 1 && template[0].t === INTERPOLATOR ) {\n\t\titem.model = resolve$3( item.parentFragment, template[0] );\n\n\t\tif ( !item.model ) {\n\t\t\twarnOnceIfDebug( (\"The \" + (item.name) + \"='{{\" + (template[0].r) + \"}}' mapping is ambiguous, and may cause unexpected results. Consider initialising your data to eliminate the ambiguity\"), { ractive: item.element.instance }); // TODO add docs page explaining item\n\t\t\titem.parentFragment.ractive.get( item.name ); // side-effect: create mappings as necessary\n\t\t\titem.model = item.parentFragment.findContext().joinKey( item.name );\n\t\t}\n\n\t\titem.link = viewmodel.createLink( item.name, item.model, template[0].r );\n\n\t\tif ( item.model.get() === undefined && item.name in childData ) {\n\t\t\titem.model.set( childData[ item.name ] );\n\t\t}\n\t}\n\n\telse {\n\t\titem.boundFragment = new Fragment({\n\t\t\towner: item,\n\t\t\ttemplate: template\n\t\t}).bind();\n\n\t\titem.model = viewmodel.joinKey( item.name );\n\t\titem.model.set( item.boundFragment.valueOf() );\n\n\t\t// item is a *bit* of a hack\n\t\titem.boundFragment.bubble = function () {\n\t\t\tFragment.prototype.bubble.call( item.boundFragment );\n\t\t\t// defer this to avoid mucking around model deps if there happens to be an expression involved\n\t\t\trunloop.scheduleTask(function () {\n\t\t\t\titem.boundFragment.update();\n\t\t\t\titem.model.set( item.boundFragment.valueOf() );\n\t\t\t});\n\t\t};\n\t}\n}\n\nvar Option = (function (Element$$1) {\n\tfunction Option ( options ) {\n\t\tvar template = options.template;\n\t\tif ( !template.a ) { template.a = {}; }\n\n\t\t// If the value attribute is missing, use the element's content,\n\t\t// as long as it isn't disabled\n\t\tif ( template.a.value === undefined && !( 'disabled' in template.a ) ) {\n\t\t\ttemplate.a.value = template.f || '';\n\t\t}\n\n\t\tElement$$1.call( this, options );\n\n\t\tthis.select = findElement( this.parent || this.parentFragment, false, 'select' );\n\t}\n\n\tif ( Element$$1 ) Option.__proto__ = Element$$1;\n\tOption.prototype = Object.create( Element$$1 && Element$$1.prototype );\n\tOption.prototype.constructor = Option;\n\n\tOption.prototype.bind = function bind () {\n\t\tif ( !this.select ) {\n\t\t\tElement$$1.prototype.bind.call(this);\n\t\t\treturn;\n\t\t}\n\n\t\t// If the select has a value, it overrides the `selected` attribute on\n\t\t// this option - so we delete the attribute\n\t\tvar selectedAttribute = this.attributeByName.selected;\n\t\tif ( selectedAttribute && this.select.getAttribute( 'value' ) !== undefined ) {\n\t\t\tvar index = this.attributes.indexOf( selectedAttribute );\n\t\t\tthis.attributes.splice( index, 1 );\n\t\t\tdelete this.attributeByName.selected;\n\t\t}\n\n\t\tElement$$1.prototype.bind.call(this);\n\t\tthis.select.options.push( this );\n\t};\n\n\tOption.prototype.bubble = function bubble () {\n\t\t// if we're using content as value, may need to update here\n\t\tvar value = this.getAttribute( 'value' );\n\t\tif ( this.node && this.node.value !== value ) {\n\t\t\tthis.node._ractive.value = value;\n\t\t}\n\t\tElement$$1.prototype.bubble.call(this);\n\t};\n\n\tOption.prototype.getAttribute = function getAttribute ( name ) {\n\t\tvar attribute = this.attributeByName[ name ];\n\t\treturn attribute ? attribute.getValue() : name === 'value' && this.fragment ? this.fragment.valueOf() : undefined;\n\t};\n\n\tOption.prototype.isSelected = function isSelected () {\n\t\tvar optionValue = this.getAttribute( 'value' );\n\n\t\tif ( optionValue === undefined || !this.select ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tvar selectValue = this.select.getAttribute( 'value' );\n\n\t\tif ( selectValue == optionValue ) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif ( this.select.getAttribute( 'multiple' ) && isArray( selectValue ) ) {\n\t\t\tvar i = selectValue.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tif ( selectValue[i] == optionValue ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\tOption.prototype.render = function render ( target, occupants ) {\n\t\tElement$$1.prototype.render.call( this, target, occupants );\n\n\t\tif ( !this.attributeByName.value ) {\n\t\t\tthis.node._ractive.value = this.getAttribute( 'value' );\n\t\t}\n\t};\n\n\tOption.prototype.unbind = function unbind () {\n\t\tElement$$1.prototype.unbind.call(this);\n\n\t\tif ( this.select ) {\n\t\t\tremoveFromArray( this.select.options, this );\n\t\t}\n\t};\n\n\treturn Option;\n}(Element));\n\nfunction getPartialTemplate ( ractive, name, parentFragment ) {\n\t// If the partial in instance or view heirarchy instances, great\n\tvar partial = getPartialFromRegistry( ractive, name, parentFragment || {} );\n\tif ( partial ) { return partial; }\n\n\t// Does it exist on the page as a script tag?\n\tpartial = parser.fromId( name, { noThrow: true } );\n\tif ( partial ) {\n\t\t// parse and register to this ractive instance\n\t\tvar parsed = parser.parseFor( partial, ractive );\n\n\t\t// register extra partials on the ractive instance if they don't already exist\n\t\tif ( parsed.p ) { fillGaps( ractive.partials, parsed.p ); }\n\n\t\t// register (and return main partial if there are others in the template)\n\t\treturn ractive.partials[ name ] = parsed.t;\n\t}\n}\n\nfunction getPartialFromRegistry ( ractive, name, parentFragment ) {\n\t// if there was an instance up-hierarchy, cool\n\tvar partial = findParentPartial( name, parentFragment.owner );\n\tif ( partial ) { return partial; }\n\n\t// find first instance in the ractive or view hierarchy that has this partial\n\tvar instance = findInstance( 'partials', ractive, name );\n\n\tif ( !instance ) { return; }\n\n\tpartial = instance.partials[ name ];\n\n\t// partial is a function?\n\tvar fn;\n\tif ( typeof partial === 'function' ) {\n\t\tfn = partial.bind( instance );\n\t\tfn.isOwner = instance.partials.hasOwnProperty(name);\n\t\tpartial = fn.call( ractive, parser );\n\t}\n\n\tif ( !partial && partial !== '' ) {\n\t\twarnIfDebug( noRegistryFunctionReturn, name, 'partial', 'partial', { ractive: ractive });\n\t\treturn;\n\t}\n\n\t// If this was added manually to the registry,\n\t// but hasn't been parsed, parse it now\n\tif ( !parser.isParsed( partial ) ) {\n\t\t// use the parseOptions of the ractive instance on which it was found\n\t\tvar parsed = parser.parseFor( partial, instance );\n\n\t\t// Partials cannot contain nested partials!\n\t\t// TODO add a test for this\n\t\tif ( parsed.p ) {\n\t\t\twarnIfDebug( 'Partials ({{>%s}}) cannot contain nested inline partials', name, { ractive: ractive });\n\t\t}\n\n\t\t// if fn, use instance to store result, otherwise needs to go\n\t\t// in the correct point in prototype chain on instance or constructor\n\t\tvar target = fn ? instance : findOwner( instance, name );\n\n\t\t// may be a template with partials, which need to be registered and main template extracted\n\t\ttarget.partials[ name ] = partial = parsed.t;\n\t}\n\n\t// store for reset\n\tif ( fn ) { partial._fn = fn; }\n\n\treturn partial.v ? partial.t : partial;\n}\n\nfunction findOwner ( ractive, key ) {\n\treturn ractive.partials.hasOwnProperty( key )\n\t\t? ractive\n\t\t: findConstructor( ractive.constructor, key);\n}\n\nfunction findConstructor ( constructor, key ) {\n\tif ( !constructor ) { return; }\n\treturn constructor.partials.hasOwnProperty( key )\n\t\t? constructor\n\t\t: findConstructor( constructor._Parent, key );\n}\n\nfunction findParentPartial( name, parent ) {\n\tif ( parent ) {\n\t\tif ( parent.template && parent.template.p && parent.template.p[name] ) {\n\t\t\treturn parent.template.p[name];\n\t\t} else if ( parent.parentFragment && parent.parentFragment.owner ) {\n\t\t\treturn findParentPartial( name, parent.parentFragment.owner );\n\t\t}\n\t}\n}\n\nvar Partial = (function (MustacheContainer$$1) {\n\tfunction Partial ( options ) {\n\t\tMustacheContainer$$1.call( this, options );\n\n\t\tthis.yielder = options.template.t === YIELDER;\n\n\t\tif ( this.yielder ) {\n\t\t\tthis.container = options.parentFragment.ractive;\n\t\t\tthis.component = this.container.component;\n\n\t\t\tthis.containerFragment = options.parentFragment;\n\t\t\tthis.parentFragment = this.component.parentFragment;\n\n\t\t\t// {{yield}} is equivalent to {{yield content}}\n\t\t\tif ( !options.template.r && !options.template.rx && !options.template.x ) { options.template.r = 'content'; }\n\t\t}\n\t}\n\n\tif ( MustacheContainer$$1 ) Partial.__proto__ = MustacheContainer$$1;\n\tPartial.prototype = Object.create( MustacheContainer$$1 && MustacheContainer$$1.prototype );\n\tPartial.prototype.constructor = Partial;\n\n\tPartial.prototype.bind = function bind () {\n\t\tvar this$1 = this;\n\n\t\t// keep track of the reference name for future resets\n\t\tthis.refName = this.template.r;\n\n\t\t// name matches take priority over expressions\n\t\tvar template = this.refName ? getPartialTemplate( this.ractive, this.refName, this.parentFragment ) || null : null;\n\t\tvar templateObj;\n\n\t\tif ( template ) {\n\t\t\tthis.named = true;\n\t\t\tthis.setTemplate( this.template.r, template );\n\t\t}\n\n\t\tif ( !template ) {\n\t\t\tMustacheContainer$$1.prototype.bind.call(this);\n\t\t\tif ( this.model && ( templateObj = this.model.get() ) && typeof templateObj === 'object' && ( typeof templateObj.template === 'string' || isArray( templateObj.t ) ) ) {\n\t\t\t\tif ( templateObj.template ) {\n\t\t\t\t\tthis.source = templateObj.template;\n\t\t\t\t\ttemplateObj = parsePartial( this.template.r, templateObj.template, this.ractive );\n\t\t\t\t} else {\n\t\t\t\t\tthis.source = templateObj.t;\n\t\t\t\t}\n\t\t\t\tthis.setTemplate( this.template.r, templateObj.t );\n\t\t\t} else if ( ( !this.model || typeof this.model.get() !== 'string' ) && this.refName ) {\n\t\t\t\tthis.setTemplate( this.refName, template );\n\t\t\t} else {\n\t\t\t\tthis.setTemplate( this.model.get() );\n\t\t\t}\n\t\t}\n\n\t\tvar options = {\n\t\t\towner: this,\n\t\t\ttemplate: this.partialTemplate\n\t\t};\n\n\t\tif ( this.template.c ) {\n\t\t\toptions.template = [{ t: SECTION, n: SECTION_WITH, f: options.template }];\n\t\t\tfor ( var k in this.template.c ) {\n\t\t\t\toptions.template[0][k] = this$1.template.c[k];\n\t\t\t}\n\t\t}\n\n\t\tif ( this.yielder ) {\n\t\t\toptions.ractive = this.container.parent;\n\t\t}\n\n\t\tthis.fragment = new Fragment(options);\n\t\tif ( this.template.z ) {\n\t\t\tthis.fragment.aliases = resolveAliases( this.template.z, this.yielder ? this.containerFragment : this.parentFragment );\n\t\t}\n\t\tthis.fragment.bind();\n\t};\n\n\tPartial.prototype.bubble = function bubble () {\n\t\tif ( this.yielder && !this.dirty ) {\n\t\t\tthis.containerFragment.bubble();\n\t\t\tthis.dirty = true;\n\t\t} else {\n\t\t\tMustacheContainer$$1.prototype.bubble.call(this);\n\t\t}\n\t};\n\n\tPartial.prototype.findNextNode = function findNextNode () {\n\t\treturn this.yielder ? this.containerFragment.findNextNode( this ) : MustacheContainer$$1.prototype.findNextNode.call(this);\n\t};\n\n\tPartial.prototype.forceResetTemplate = function forceResetTemplate () {\n\t\tvar this$1 = this;\n\n\t\tthis.partialTemplate = undefined;\n\n\t\t// on reset, check for the reference name first\n\t\tif ( this.refName ) {\n\t\t\tthis.partialTemplate = getPartialTemplate( this.ractive, this.refName, this.parentFragment );\n\t\t}\n\n\t\t// then look for the resolved name\n\t\tif ( !this.partialTemplate ) {\n\t\t\tthis.partialTemplate = getPartialTemplate( this.ractive, this.name, this.parentFragment );\n\t\t}\n\n\t\tif ( !this.partialTemplate ) {\n\t\t\twarnOnceIfDebug( (\"Could not find template for partial '\" + (this.name) + \"'\") );\n\t\t\tthis.partialTemplate = [];\n\t\t}\n\n\t\tif ( this.inAttribute ) {\n\t\t\tdoInAttributes( function () { return this$1.fragment.resetTemplate( this$1.partialTemplate ); } );\n\t\t} else {\n\t\t\tthis.fragment.resetTemplate( this.partialTemplate );\n\t\t}\n\n\t\tthis.bubble();\n\t};\n\n\tPartial.prototype.rebinding = function rebinding () {\n\t\tvar this$1 = this;\n\n\t\tif ( this.locked || !this.template.z ) { return; }\n\t\tthis.locked = true;\n\t\trunloop.scheduleTask( function () {\n\t\t\tthis$1.locked = false;\n\t\t\tthis$1.fragment.aliases = resolveAliases( this$1.template.z, this$1.containerFragment );\n\t\t});\n\t};\n\n\tPartial.prototype.render = function render ( target, occupants ) {\n\t\treturn this.fragment.render( target, occupants );\n\t};\n\n\tPartial.prototype.setTemplate = function setTemplate ( name, template ) {\n\t\tthis.name = name;\n\n\t\tif ( !template && template !== null ) { template = getPartialTemplate( this.ractive, name, this.parentFragment ); }\n\n\t\tif ( !template ) {\n\t\t\twarnOnceIfDebug( (\"Could not find template for partial '\" + name + \"'\") );\n\t\t}\n\n\t\tthis.partialTemplate = template || [];\n\t};\n\n\tPartial.prototype.unbind = function unbind () {\n\t\tMustacheContainer$$1.prototype.unbind.call(this);\n\t\tthis.fragment.aliases = {};\n\t\tthis.fragment.unbind();\n\t};\n\n\tPartial.prototype.unrender = function unrender ( shouldDestroy ) {\n\t\tthis.fragment.unrender( shouldDestroy );\n\t};\n\n\tPartial.prototype.update = function update () {\n\t\tvar template;\n\n\t\tif ( this.dirty ) {\n\t\t\tthis.dirty = false;\n\n\t\t\tif ( !this.named ) {\n\t\t\t\tif ( this.model ) {\n\t\t\t\t\ttemplate = this.model.get();\n\t\t\t\t}\n\n\t\t\t\tif ( template && typeof template === 'string' && template !== this.name ) {\n\t\t\t\t\tthis.setTemplate( template );\n\t\t\t\t\tthis.fragment.resetTemplate( this.partialTemplate );\n\t\t\t\t} else if ( template && typeof template === 'object' && ( typeof template.template === 'string' || isArray( template.t ) ) ) {\n\t\t\t\t\tif ( template.t !== this.source && template.template !== this.source ) {\n\t\t\t\t\t\tif ( template.template ) {\n\t\t\t\t\t\t\tthis.source = template.template;\n\t\t\t\t\t\t\ttemplate = parsePartial( this.name, template.template, this.ractive );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.source = template.t;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.setTemplate( this.name, template.t );\n\t\t\t\t\t\tthis.fragment.resetTemplate( this.partialTemplate );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.fragment.update();\n\t\t}\n\t};\n\n\treturn Partial;\n}(MustacheContainer));\n\nfunction parsePartial( name, partial, ractive ) {\n\tvar parsed;\n\n\ttry {\n\t\tparsed = parser.parse( partial, parser.getParseOptions( ractive ) );\n\t} catch (e) {\n\t\twarnIfDebug( (\"Could not parse partial from expression '\" + name + \"'\\n\" + (e.message)) );\n\t}\n\n\treturn parsed || { t: [] };\n}\n\nvar RepeatedFragment = function RepeatedFragment ( options ) {\n\tthis.parent = options.owner.parentFragment;\n\n\t// bit of a hack, so reference resolution works without another\n\t// layer of indirection\n\tthis.parentFragment = this;\n\tthis.owner = options.owner;\n\tthis.ractive = this.parent.ractive;\n\n\t// encapsulated styles should be inherited until they get applied by an element\n\tthis.cssIds = 'cssIds' in options ? options.cssIds : ( this.parent ? this.parent.cssIds : null );\n\n\tthis.context = null;\n\tthis.rendered = false;\n\tthis.iterations = [];\n\n\tthis.template = options.template;\n\n\tthis.indexRef = options.indexRef;\n\tthis.keyRef = options.keyRef;\n\n\tthis.pendingNewIndices = null;\n\tthis.previousIterations = null;\n\n\t// track array versus object so updates of type rest\n\tthis.isArray = false;\n};\n\nRepeatedFragment.prototype.bind = function bind ( context ) {\n\t\tvar this$1 = this;\n\n\tthis.context = context;\n\tvar value = context.get();\n\n\t// {{#each array}}...\n\tif ( this.isArray = isArray( value ) ) {\n\t\t// we can't use map, because of sparse arrays\n\t\tthis.iterations = [];\n\t\tvar max = value.length;\n\t\tfor ( var i = 0; i < max; i += 1 ) {\n\t\t\tthis$1.iterations[i] = this$1.createIteration( i, i );\n\t\t}\n\t}\n\n\t// {{#each object}}...\n\telse if ( isObject( value ) ) {\n\t\tthis.isArray = false;\n\n\t\t// TODO this is a dreadful hack. There must be a neater way\n\t\tif ( this.indexRef ) {\n\t\t\tvar refs = this.indexRef.split( ',' );\n\t\t\tthis.keyRef = refs[0];\n\t\t\tthis.indexRef = refs[1];\n\t\t}\n\n\t\tthis.iterations = Object.keys( value ).map( function ( key, index ) {\n\t\t\treturn this$1.createIteration( key, index );\n\t\t});\n\t}\n\n\treturn this;\n};\n\nRepeatedFragment.prototype.bubble = function bubble () {\n\tthis.owner.bubble();\n};\n\nRepeatedFragment.prototype.createIteration = function createIteration ( key, index ) {\n\tvar fragment = new Fragment({\n\t\towner: this,\n\t\ttemplate: this.template\n\t});\n\n\t// TODO this is a bit hacky\n\tfragment.key = key;\n\tfragment.index = index;\n\tfragment.isIteration = true;\n\n\tvar model = this.context.joinKey( key );\n\n\t// set up an iteration alias if there is one\n\tif ( this.owner.template.z ) {\n\t\tfragment.aliases = {};\n\t\tfragment.aliases[ this.owner.template.z[0].n ] = model;\n\t}\n\n\treturn fragment.bind( model );\n};\n\nRepeatedFragment.prototype.destroyed = function destroyed$1 () {\n\tthis.iterations.forEach( destroyed$1$1 );\n};\n\nRepeatedFragment.prototype.detach = function detach () {\n\tvar docFrag = createDocumentFragment();\n\tthis.iterations.forEach( function (fragment) { return docFrag.appendChild( fragment.detach() ); } );\n\treturn docFrag;\n};\n\nRepeatedFragment.prototype.find = function find ( selector, options ) {\n\treturn findMap( this.iterations, function (i) { return i.find( selector, options ); } );\n};\n\nRepeatedFragment.prototype.findAll = function findAll ( selector, query ) {\n\treturn this.iterations.forEach( function (i) { return i.findAll( selector, query ); } );\n};\n\nRepeatedFragment.prototype.findComponent = function findComponent ( name, options ) {\n\treturn findMap( this.iterations, function (i) { return i.findComponent( name, options ); } );\n};\n\nRepeatedFragment.prototype.findAllComponents = function findAllComponents ( name, query ) {\n\treturn this.iterations.forEach( function (i) { return i.findAllComponents( name, query ); } );\n};\n\nRepeatedFragment.prototype.findNextNode = function findNextNode ( iteration ) {\n\t\tvar this$1 = this;\n\n\tif ( iteration.index < this.iterations.length - 1 ) {\n\t\tfor ( var i = iteration.index + 1; i < this.iterations.length; i++ ) {\n\t\t\tvar node = this$1.iterations[ i ].firstNode( true );\n\t\t\tif ( node ) { return node; }\n\t\t}\n\t}\n\n\treturn this.owner.findNextNode();\n};\n\nRepeatedFragment.prototype.firstNode = function firstNode ( skipParent ) {\n\treturn this.iterations[0] ? this.iterations[0].firstNode( skipParent ) : null;\n};\n\nRepeatedFragment.prototype.rebinding = function rebinding ( next ) {\n\t\tvar this$1 = this;\n\n\tthis.context = next;\n\tthis.iterations.forEach( function (fragment) {\n\t\tvar model = next ? next.joinKey( fragment.key ) : undefined;\n\t\tfragment.context = model;\n\t\tif ( this$1.owner.template.z ) {\n\t\t\tfragment.aliases = {};\n\t\t\tfragment.aliases[ this$1.owner.template.z[0].n ] = model;\n\t\t}\n\t});\n};\n\nRepeatedFragment.prototype.render = function render ( target, occupants ) {\n\t// TODO use docFrag.cloneNode...\n\n\tif ( this.iterations ) {\n\t\tthis.iterations.forEach( function (fragment) { return fragment.render( target, occupants ); } );\n\t}\n\n\tthis.rendered = true;\n};\n\nRepeatedFragment.prototype.shuffle = function shuffle ( newIndices ) {\n\t\tvar this$1 = this;\n\n\tif ( !this.pendingNewIndices ) { this.previousIterations = this.iterations.slice(); }\n\n\tif ( !this.pendingNewIndices ) { this.pendingNewIndices = []; }\n\n\tthis.pendingNewIndices.push( newIndices );\n\n\tvar iterations = [];\n\n\tnewIndices.forEach( function ( newIndex, oldIndex ) {\n\t\tif ( newIndex === -1 ) { return; }\n\n\t\tvar fragment = this$1.iterations[ oldIndex ];\n\t\titerations[ newIndex ] = fragment;\n\n\t\tif ( newIndex !== oldIndex && fragment ) { fragment.dirty = true; }\n\t});\n\n\tthis.iterations = iterations;\n\n\tthis.bubble();\n};\n\nRepeatedFragment.prototype.shuffled = function shuffled$1 () {\n\tthis.iterations.forEach( shuffled$1$1 );\n};\n\nRepeatedFragment.prototype.toString = function toString$1 ( escape ) {\n\treturn this.iterations ?\n\t\tthis.iterations.map( escape ? toEscapedString : toString$2 ).join( '' ) :\n\t\t'';\n};\n\nRepeatedFragment.prototype.unbind = function unbind$1 () {\n\tthis.iterations.forEach( unbind$1$1 );\n\treturn this;\n};\n\nRepeatedFragment.prototype.unrender = function unrender$1 ( shouldDestroy ) {\n\tthis.iterations.forEach( shouldDestroy ? unrenderAndDestroy : unrender$1$1 );\n\tif ( this.pendingNewIndices && this.previousIterations ) {\n\t\tthis.previousIterations.forEach( function (fragment) {\n\t\t\tif ( fragment.rendered ) { shouldDestroy ? unrenderAndDestroy( fragment ) : unrender$1$1( fragment ); }\n\t\t});\n\t}\n\tthis.rendered = false;\n};\n\n// TODO smart update\nRepeatedFragment.prototype.update = function update$1 () {\n\t\tvar this$1 = this;\n\n\t// skip dirty check, since this is basically just a facade\n\n\tif ( this.pendingNewIndices ) {\n\t\tthis.updatePostShuffle();\n\t\treturn;\n\t}\n\n\tif ( this.updating ) { return; }\n\tthis.updating = true;\n\n\tvar value = this.context.get();\n\tvar wasArray = this.isArray;\n\n\tvar toRemove;\n\tvar oldKeys;\n\tvar reset = true;\n\tvar i;\n\n\tif ( this.isArray = isArray( value ) ) {\n\t\tif ( wasArray ) {\n\t\t\treset = false;\n\t\t\tif ( this.iterations.length > value.length ) {\n\t\t\t\ttoRemove = this.iterations.splice( value.length );\n\t\t\t}\n\t\t}\n\t} else if ( isObject( value ) && !wasArray ) {\n\t\treset = false;\n\t\ttoRemove = [];\n\t\toldKeys = {};\n\t\ti = this.iterations.length;\n\n\t\twhile ( i-- ) {\n\t\t\tvar fragment$1 = this$1.iterations[i];\n\t\t\tif ( fragment$1.key in value ) {\n\t\t\t\toldKeys[ fragment$1.key ] = true;\n\t\t\t} else {\n\t\t\t\tthis$1.iterations.splice( i, 1 );\n\t\t\t\ttoRemove.push( fragment$1 );\n\t\t\t}\n\t\t}\n\t}\n\n\tif ( reset ) {\n\t\ttoRemove = this.iterations;\n\t\tthis.iterations = [];\n\t}\n\n\tif ( toRemove ) {\n\t\ttoRemove.forEach( function (fragment) {\n\t\t\tfragment.unbind();\n\t\t\tfragment.unrender( true );\n\t\t});\n\t}\n\n\t// update the remaining ones\n\tthis.iterations.forEach( update$1$1 );\n\n\t// add new iterations\n\tvar newLength = isArray( value ) ?\n\t\tvalue.length :\n\t\tisObject( value ) ?\n\t\t\tObject.keys( value ).length :\n\t\t\t0;\n\n\tvar docFrag;\n\tvar fragment;\n\n\tif ( newLength > this.iterations.length ) {\n\t\tdocFrag = this.rendered ? createDocumentFragment() : null;\n\t\ti = this.iterations.length;\n\n\t\tif ( isArray( value ) ) {\n\t\t\twhile ( i < value.length ) {\n\t\t\t\tfragment = this$1.createIteration( i, i );\n\n\t\t\t\tthis$1.iterations.push( fragment );\n\t\t\t\tif ( this$1.rendered ) { fragment.render( docFrag ); }\n\n\t\t\t\ti += 1;\n\t\t\t}\n\t\t}\n\n\t\telse if ( isObject( value ) ) {\n\t\t\t// TODO this is a dreadful hack. There must be a neater way\n\t\t\tif ( this.indexRef && !this.keyRef ) {\n\t\t\t\tvar refs = this.indexRef.split( ',' );\n\t\t\t\tthis.keyRef = refs[0];\n\t\t\t\tthis.indexRef = refs[1];\n\t\t\t}\n\n\t\t\tObject.keys( value ).forEach( function (key) {\n\t\t\t\tif ( !oldKeys || !( key in oldKeys ) ) {\n\t\t\t\t\tfragment = this$1.createIteration( key, i );\n\n\t\t\t\t\tthis$1.iterations.push( fragment );\n\t\t\t\t\tif ( this$1.rendered ) { fragment.render( docFrag ); }\n\n\t\t\t\t\ti += 1;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif ( this.rendered ) {\n\t\t\tvar parentNode = this.parent.findParentNode();\n\t\t\tvar anchor = this.parent.findNextNode( this.owner );\n\n\t\t\tparentNode.insertBefore( docFrag, anchor );\n\t\t}\n\t}\n\n\tthis.updating = false;\n};\n\nRepeatedFragment.prototype.updatePostShuffle = function updatePostShuffle () {\n\t\tvar this$1 = this;\n\n\tvar newIndices = this.pendingNewIndices[ 0 ];\n\n\t// map first shuffle through\n\tthis.pendingNewIndices.slice( 1 ).forEach( function (indices) {\n\t\tnewIndices.forEach( function ( newIndex, oldIndex ) {\n\t\t\tnewIndices[ oldIndex ] = indices[ newIndex ];\n\t\t});\n\t});\n\n\t// This algorithm (for detaching incorrectly-ordered fragments from the DOM and\n\t// storing them in a document fragment for later reinsertion) seems a bit hokey,\n\t// but it seems to work for now\n\tvar len = this.context.get().length;\n\tvar oldLen = this.previousIterations.length;\n\tvar removed = {};\n\tvar i;\n\n\tnewIndices.forEach( function ( newIndex, oldIndex ) {\n\t\tvar fragment = this$1.previousIterations[ oldIndex ];\n\t\tthis$1.previousIterations[ oldIndex ] = null;\n\n\t\tif ( newIndex === -1 ) {\n\t\t\tremoved[ oldIndex ] = fragment;\n\t\t} else if ( fragment.index !== newIndex ) {\n\t\t\tvar model = this$1.context.joinKey( newIndex );\n\t\t\tfragment.index = newIndex;\n\t\t\tfragment.context = model;\n\t\t\tif ( this$1.owner.template.z ) {\n\t\t\t\tfragment.aliases = {};\n\t\t\t\tfragment.aliases[ this$1.owner.template.z[0].n ] = model;\n\t\t\t}\n\t\t}\n\t});\n\n\t// if the array was spliced outside of ractive, sometimes there are leftover fragments not in the newIndices\n\tthis.previousIterations.forEach( function ( frag, i ) {\n\t\tif ( frag ) { removed[ i ] = frag; }\n\t});\n\n\t// create new/move existing iterations\n\tvar docFrag = this.rendered ? createDocumentFragment() : null;\n\tvar parentNode = this.rendered ? this.parent.findParentNode() : null;\n\n\tvar contiguous = 'startIndex' in newIndices;\n\ti = contiguous ? newIndices.startIndex : 0;\n\n\tfor ( i; i < len; i++ ) {\n\t\tvar frag = this$1.iterations[i];\n\n\t\tif ( frag && contiguous ) {\n\t\t\t// attach any built-up iterations\n\t\t\tif ( this$1.rendered ) {\n\t\t\t\tif ( removed[i] ) { docFrag.appendChild( removed[i].detach() ); }\n\t\t\t\tif ( docFrag.childNodes.length  ) { parentNode.insertBefore( docFrag, frag.firstNode() ); }\n\t\t\t}\n\t\t\tcontinue;\n\t\t}\n\n\t\tif ( !frag ) { this$1.iterations[i] = this$1.createIteration( i, i ); }\n\n\t\tif ( this$1.rendered ) {\n\t\t\tif ( removed[i] ) { docFrag.appendChild( removed[i].detach() ); }\n\n\t\t\tif ( frag ) { docFrag.appendChild( frag.detach() ); }\n\t\t\telse {\n\t\t\t\tthis$1.iterations[i].render( docFrag );\n\t\t\t}\n\t\t}\n\t}\n\n\t// append any leftovers\n\tif ( this.rendered ) {\n\t\tfor ( i = len; i < oldLen; i++ ) {\n\t\t\tif ( removed[i] ) { docFrag.appendChild( removed[i].detach() ); }\n\t\t}\n\n\t\tif ( docFrag.childNodes.length ) {\n\t\t\tparentNode.insertBefore( docFrag, this.owner.findNextNode() );\n\t\t}\n\t}\n\n\t// trigger removal on old nodes\n\tObject.keys( removed ).forEach( function (k) { return removed[k].unbind().unrender( true ); } );\n\n\tthis.iterations.forEach( update$1$1 );\n\n\tthis.pendingNewIndices = null;\n\n\tthis.shuffled();\n};\n\nfunction isEmpty ( value ) {\n\treturn !value ||\n\t       ( isArray( value ) && value.length === 0 ) ||\n\t\t   ( isObject( value ) && Object.keys( value ).length === 0 );\n}\n\nfunction getType ( value, hasIndexRef ) {\n\tif ( hasIndexRef || isArray( value ) ) { return SECTION_EACH; }\n\tif ( isObject( value ) || typeof value === 'function' ) { return SECTION_IF_WITH; }\n\tif ( value === undefined ) { return null; }\n\treturn SECTION_IF;\n}\n\nvar Section = (function (MustacheContainer$$1) {\n\tfunction Section ( options ) {\n\t\tMustacheContainer$$1.call( this, options );\n\n\t\tthis.sectionType = options.template.n || null;\n\t\tthis.templateSectionType = this.sectionType;\n\t\tthis.subordinate = options.template.l === 1;\n\t\tthis.fragment = null;\n\t}\n\n\tif ( MustacheContainer$$1 ) Section.__proto__ = MustacheContainer$$1;\n\tSection.prototype = Object.create( MustacheContainer$$1 && MustacheContainer$$1.prototype );\n\tSection.prototype.constructor = Section;\n\n\tSection.prototype.bind = function bind () {\n\t\tMustacheContainer$$1.prototype.bind.call(this);\n\n\t\tif ( this.subordinate ) {\n\t\t\tthis.sibling = this.parentFragment.items[ this.parentFragment.items.indexOf( this ) - 1 ];\n\t\t\tthis.sibling.nextSibling = this;\n\t\t}\n\n\t\t// if we managed to bind, we need to create children\n\t\tif ( this.model ) {\n\t\t\tthis.dirty = true;\n\t\t\tthis.update();\n\t\t} else if ( this.sectionType && this.sectionType === SECTION_UNLESS && ( !this.sibling || !this.sibling.isTruthy() ) ) {\n\t\t\tthis.fragment = new Fragment({\n\t\t\t\towner: this,\n\t\t\t\ttemplate: this.template.f\n\t\t\t}).bind();\n\t\t}\n\t};\n\n\tSection.prototype.isTruthy = function isTruthy () {\n\t\tif ( this.subordinate && this.sibling.isTruthy() ) { return true; }\n\t\tvar value = !this.model ? undefined : this.model.isRoot ? this.model.value : this.model.get();\n\t\treturn !!value && ( this.templateSectionType === SECTION_IF_WITH || !isEmpty( value ) );\n\t};\n\n\tSection.prototype.rebinding = function rebinding ( next, previous, safe ) {\n\t\tif ( MustacheContainer$$1.prototype.rebinding.call( this, next, previous, safe ) ) {\n\t\t\tif ( this.fragment && this.sectionType !== SECTION_IF && this.sectionType !== SECTION_UNLESS ) {\n\t\t\t\tthis.fragment.rebinding( next, previous );\n\t\t\t}\n\t\t}\n\t};\n\n\tSection.prototype.render = function render ( target, occupants ) {\n\t\tthis.rendered = true;\n\t\tif ( this.fragment ) { this.fragment.render( target, occupants ); }\n\t};\n\n\tSection.prototype.shuffle = function shuffle ( newIndices ) {\n\t\tif ( this.fragment && this.sectionType === SECTION_EACH ) {\n\t\t\tthis.fragment.shuffle( newIndices );\n\t\t}\n\t};\n\n\tSection.prototype.unbind = function unbind () {\n\t\tMustacheContainer$$1.prototype.unbind.call(this);\n\t\tif ( this.fragment ) { this.fragment.unbind(); }\n\t};\n\n\tSection.prototype.unrender = function unrender ( shouldDestroy ) {\n\t\tif ( this.rendered && this.fragment ) { this.fragment.unrender( shouldDestroy ); }\n\t\tthis.rendered = false;\n\t};\n\n\tSection.prototype.update = function update () {\n\t\tif ( !this.dirty ) { return; }\n\n\t\tif ( this.fragment && this.sectionType !== SECTION_IF && this.sectionType !== SECTION_UNLESS ) {\n\t\t\tthis.fragment.context = this.model;\n\t\t}\n\n\t\tif ( !this.model && this.sectionType !== SECTION_UNLESS ) { return; }\n\n\t\tthis.dirty = false;\n\n\t\tvar value = !this.model ? undefined : this.model.isRoot ? this.model.value : this.model.get();\n\t\tvar siblingFalsey = !this.subordinate || !this.sibling.isTruthy();\n\t\tvar lastType = this.sectionType;\n\n\t\t// watch for switching section types\n\t\tif ( this.sectionType === null || this.templateSectionType === null ) { this.sectionType = getType( value, this.template.i ); }\n\t\tif ( lastType && lastType !== this.sectionType && this.fragment ) {\n\t\t\tif ( this.rendered ) {\n\t\t\t\tthis.fragment.unbind().unrender( true );\n\t\t\t}\n\n\t\t\tthis.fragment = null;\n\t\t}\n\n\t\tvar newFragment;\n\n\t\tvar fragmentShouldExist = this.sectionType === SECTION_EACH || // each always gets a fragment, which may have no iterations\n\t\t                            this.sectionType === SECTION_WITH || // with (partial context) always gets a fragment\n\t\t                            ( siblingFalsey && ( this.sectionType === SECTION_UNLESS ? !this.isTruthy() : this.isTruthy() ) ); // if, unless, and if-with depend on siblings and the condition\n\n\t\tif ( fragmentShouldExist ) {\n\t\t\tif ( this.fragment ) {\n\t\t\t\tthis.fragment.update();\n\t\t\t} else {\n\t\t\t\tif ( this.sectionType === SECTION_EACH ) {\n\t\t\t\t\tnewFragment = new RepeatedFragment({\n\t\t\t\t\t\towner: this,\n\t\t\t\t\t\ttemplate: this.template.f,\n\t\t\t\t\t\tindexRef: this.template.i\n\t\t\t\t\t}).bind( this.model );\n\t\t\t\t} else {\n\t\t\t\t\t// only with and if-with provide context - if and unless do not\n\t\t\t\t\tvar context = this.sectionType !== SECTION_IF && this.sectionType !== SECTION_UNLESS ? this.model : null;\n\t\t\t\t\tnewFragment = new Fragment({\n\t\t\t\t\t\towner: this,\n\t\t\t\t\t\ttemplate: this.template.f\n\t\t\t\t\t}).bind( context );\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tif ( this.fragment && this.rendered ) {\n\t\t\t\tthis.fragment.unbind().unrender( true );\n\t\t\t}\n\n\t\t\tthis.fragment = null;\n\t\t}\n\n\t\tif ( newFragment ) {\n\t\t\tif ( this.rendered ) {\n\t\t\t\tvar parentNode = this.parentFragment.findParentNode();\n\t\t\t\tvar anchor = this.parentFragment.findNextNode( this );\n\n\t\t\t\tif ( anchor ) {\n\t\t\t\t\tvar docFrag = createDocumentFragment();\n\t\t\t\t\tnewFragment.render( docFrag );\n\n\t\t\t\t\t// we use anchor.parentNode, not parentNode, because the sibling\n\t\t\t\t\t// may be temporarily detached as a result of a shuffle\n\t\t\t\t\tanchor.parentNode.insertBefore( docFrag, anchor );\n\t\t\t\t} else {\n\t\t\t\t\tnewFragment.render( parentNode );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.fragment = newFragment;\n\t\t}\n\n\t\tif ( this.nextSibling ) {\n\t\t\tthis.nextSibling.dirty = true;\n\t\t\tthis.nextSibling.update();\n\t\t}\n\t};\n\n\treturn Section;\n}(MustacheContainer));\n\nfunction valueContains ( selectValue, optionValue ) {\n\tvar i = selectValue.length;\n\twhile ( i-- ) {\n\t\tif ( selectValue[i] == optionValue ) { return true; }\n\t}\n}\n\nvar Select = (function (Element$$1) {\n\tfunction Select ( options ) {\n\t\tElement$$1.call( this, options );\n\t\tthis.options = [];\n\t}\n\n\tif ( Element$$1 ) Select.__proto__ = Element$$1;\n\tSelect.prototype = Object.create( Element$$1 && Element$$1.prototype );\n\tSelect.prototype.constructor = Select;\n\n\tSelect.prototype.foundNode = function foundNode ( node ) {\n\t\tif ( this.binding ) {\n\t\t\tvar selectedOptions = getSelectedOptions( node );\n\n\t\t\tif ( selectedOptions.length > 0 ) {\n\t\t\t\tthis.selectedOptions = selectedOptions;\n\t\t\t}\n\t\t}\n\t};\n\n\tSelect.prototype.render = function render ( target, occupants ) {\n\t\tElement$$1.prototype.render.call( this, target, occupants );\n\t\tthis.sync();\n\n\t\tvar node = this.node;\n\n\t\tvar i = node.options.length;\n\t\twhile ( i-- ) {\n\t\t\tnode.options[i].defaultSelected = node.options[i].selected;\n\t\t}\n\n\t\tthis.rendered = true;\n\t};\n\n\tSelect.prototype.sync = function sync () {\n\t\tvar this$1 = this;\n\n\t\tvar selectNode = this.node;\n\n\t\tif ( !selectNode ) { return; }\n\n\t\tvar options = toArray( selectNode.options );\n\n\t\tif ( this.selectedOptions ) {\n\t\t\toptions.forEach( function (o) {\n\t\t\t\tif ( this$1.selectedOptions.indexOf( o ) >= 0 ) { o.selected = true; }\n\t\t\t\telse { o.selected = false; }\n\t\t\t});\n\t\t\tthis.binding.setFromNode( selectNode );\n\t\t\tdelete this.selectedOptions;\n\t\t\treturn;\n\t\t}\n\n\t\tvar selectValue = this.getAttribute( 'value' );\n\t\tvar isMultiple = this.getAttribute( 'multiple' );\n\n\t\t// If the <select> has a specified value, that should override\n\t\t// these options\n\t\tif ( selectValue !== undefined ) {\n\t\t\tvar optionWasSelected;\n\n\t\t\toptions.forEach( function (o) {\n\t\t\t\tvar optionValue = o._ractive ? o._ractive.value : o.value;\n\t\t\t\tvar shouldSelect = isMultiple ? valueContains( selectValue, optionValue ) : selectValue == optionValue;\n\n\t\t\t\tif ( shouldSelect ) {\n\t\t\t\t\toptionWasSelected = true;\n\t\t\t\t}\n\n\t\t\t\to.selected = shouldSelect;\n\t\t\t});\n\n\t\t\tif ( !optionWasSelected && !isMultiple ) {\n\t\t\t\tif ( this.binding ) {\n\t\t\t\t\tthis.binding.forceUpdate();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Otherwise the value should be initialised according to which\n\t\t// <option> element is selected, if twoway binding is in effect\n\t\telse if ( this.binding ) {\n\t\t\tthis.binding.forceUpdate();\n\t\t}\n\t};\n\n\tSelect.prototype.update = function update () {\n\t\tElement$$1.prototype.update.call(this);\n\t\tthis.sync();\n\t};\n\n\treturn Select;\n}(Element));\n\nvar Textarea = (function (Input$$1) {\n\tfunction Textarea( options ) {\n\t\tvar template = options.template;\n\n\t\toptions.deferContent = true;\n\n\t\tInput$$1.call( this, options );\n\n\t\t// check for single interpolator binding\n\t\tif ( !this.attributeByName.value ) {\n\t\t\tif ( template.f && isBindable( { template: template } ) ) {\n\t\t\t\tthis.attributes.push( createItem( {\n\t\t\t\t\towner: this,\n\t\t\t\t\ttemplate: { t: ATTRIBUTE, f: template.f, n: 'value' },\n\t\t\t\t\tparentFragment: this.parentFragment\n\t\t\t\t} ) );\n\t\t\t} else {\n\t\t\t\tthis.fragment = new Fragment({ owner: this, cssIds: null, template: template.f });\n\t\t\t}\n\t\t}\n\t}\n\n\tif ( Input$$1 ) Textarea.__proto__ = Input$$1;\n\tTextarea.prototype = Object.create( Input$$1 && Input$$1.prototype );\n\tTextarea.prototype.constructor = Textarea;\n\n\tTextarea.prototype.bubble = function bubble () {\n\t\tvar this$1 = this;\n\n\t\tif ( !this.dirty ) {\n\t\t\tthis.dirty = true;\n\n\t\t\tif ( this.rendered && !this.binding && this.fragment ) {\n\t\t\t\trunloop.scheduleTask( function () {\n\t\t\t\t\tthis$1.dirty = false;\n\t\t\t\t\tthis$1.node.value = this$1.fragment.toString();\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.parentFragment.bubble(); // default behaviour\n\t\t}\n\t};\n\n\treturn Textarea;\n}(Input));\n\nvar Text = (function (Item$$1) {\n\tfunction Text ( options ) {\n\t\tItem$$1.call( this, options );\n\t\tthis.type = TEXT;\n\t}\n\n\tif ( Item$$1 ) Text.__proto__ = Item$$1;\n\tText.prototype = Object.create( Item$$1 && Item$$1.prototype );\n\tText.prototype.constructor = Text;\n\n\tText.prototype.bind = function bind () {\n\t\t// noop\n\t};\n\n\tText.prototype.detach = function detach () {\n\t\treturn detachNode( this.node );\n\t};\n\n\tText.prototype.firstNode = function firstNode () {\n\t\treturn this.node;\n\t};\n\n\tText.prototype.render = function render ( target, occupants ) {\n\t\tif ( inAttributes() ) { return; }\n\t\tthis.rendered = true;\n\n\t\tif ( occupants ) {\n\t\t\tvar n = occupants[0];\n\t\t\tif ( n && n.nodeType === 3 ) {\n\t\t\t\toccupants.shift();\n\t\t\t\tif ( n.nodeValue !== this.template ) {\n\t\t\t\t\tn.nodeValue = this.template;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tn = this.node = doc.createTextNode( this.template );\n\t\t\t\tif ( occupants[0] ) {\n\t\t\t\t\ttarget.insertBefore( n, occupants[0] );\n\t\t\t\t} else {\n\t\t\t\t\ttarget.appendChild( n );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.node = n;\n\t\t} else {\n\t\t\tthis.node = doc.createTextNode( this.template );\n\t\t\ttarget.appendChild( this.node );\n\t\t}\n\t};\n\n\tText.prototype.toString = function toString ( escape ) {\n\t\treturn escape ? escapeHtml( this.template ) : this.template;\n\t};\n\n\tText.prototype.unbind = function unbind () {\n\t\t// noop\n\t};\n\n\tText.prototype.unrender = function unrender ( shouldDestroy ) {\n\t\tif ( this.rendered && shouldDestroy ) { this.detach(); }\n\t\tthis.rendered = false;\n\t};\n\n\tText.prototype.update = function update () {\n\t\t// noop\n\t};\n\n\tText.prototype.valueOf = function valueOf () {\n\t\treturn this.template;\n\t};\n\n\treturn Text;\n}(Item));\n\nvar prefix;\n\nif ( !isClient ) {\n\tprefix = null;\n} else {\n\tvar prefixCache = {};\n\tvar testStyle = createElement( 'div' ).style;\n\n\tprefix = function ( prop ) {\n\t\tprop = camelCase( prop );\n\n\t\tif ( !prefixCache[ prop ] ) {\n\t\t\tif ( testStyle[ prop ] !== undefined ) {\n\t\t\t\tprefixCache[ prop ] = prop;\n\t\t\t}\n\n\t\t\telse {\n\t\t\t\t// test vendors...\n\t\t\t\tvar capped = prop.charAt( 0 ).toUpperCase() + prop.substring( 1 );\n\n\t\t\t\tvar i = vendors.length;\n\t\t\t\twhile ( i-- ) {\n\t\t\t\t\tvar vendor = vendors[i];\n\t\t\t\t\tif ( testStyle[ vendor + capped ] !== undefined ) {\n\t\t\t\t\t\tprefixCache[ prop ] = vendor + capped;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn prefixCache[ prop ];\n\t};\n}\n\nvar prefix$1 = prefix;\n\nvar visible;\nvar hidden = 'hidden';\n\nif ( doc ) {\n\tvar prefix$2;\n\n\tif ( hidden in doc ) {\n\t\tprefix$2 = '';\n\t} else {\n\t\tvar i$1 = vendors.length;\n\t\twhile ( i$1-- ) {\n\t\t\tvar vendor = vendors[i$1];\n\t\t\thidden = vendor + 'Hidden';\n\n\t\t\tif ( hidden in doc ) {\n\t\t\t\tprefix$2 = vendor;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tif ( prefix$2 !== undefined ) {\n\t\tdoc.addEventListener( prefix$2 + 'visibilitychange', onChange );\n\t\tonChange();\n\t} else {\n\t\t// gah, we're in an old browser\n\t\tif ( 'onfocusout' in doc ) {\n\t\t\tdoc.addEventListener( 'focusout', onHide );\n\t\t\tdoc.addEventListener( 'focusin', onShow );\n\t\t}\n\n\t\telse {\n\t\t\twin.addEventListener( 'pagehide', onHide );\n\t\t\twin.addEventListener( 'blur', onHide );\n\n\t\t\twin.addEventListener( 'pageshow', onShow );\n\t\t\twin.addEventListener( 'focus', onShow );\n\t\t}\n\n\t\tvisible = true; // until proven otherwise. Not ideal but hey\n\t}\n}\n\nfunction onChange () {\n\tvisible = !doc[ hidden ];\n}\n\nfunction onHide () {\n\tvisible = false;\n}\n\nfunction onShow () {\n\tvisible = true;\n}\n\nvar unprefixPattern = new RegExp( '^-(?:' + vendors.join( '|' ) + ')-' );\n\nvar unprefix = function ( prop ) {\n\treturn prop.replace( unprefixPattern, '' );\n};\n\nvar vendorPattern = new RegExp( '^(?:' + vendors.join( '|' ) + ')([A-Z])' );\n\nvar hyphenate = function ( str ) {\n\tif ( !str ) { return ''; } // edge case\n\n\tif ( vendorPattern.test( str ) ) { str = '-' + str; }\n\n\treturn str.replace( /[A-Z]/g, function (match) { return '-' + match.toLowerCase(); } );\n};\n\nvar createTransitions;\n\nif ( !isClient ) {\n\tcreateTransitions = null;\n} else {\n\tvar testStyle$1 = createElement( 'div' ).style;\n\tvar linear$2 = function (x) { return x; };\n\n\tvar canUseCssTransitions = {};\n\tvar cannotUseCssTransitions = {};\n\n\t// determine some facts about our environment\n\tvar TRANSITION$1;\n\tvar TRANSITIONEND;\n\tvar CSS_TRANSITIONS_ENABLED;\n\tvar TRANSITION_DURATION;\n\tvar TRANSITION_PROPERTY;\n\tvar TRANSITION_TIMING_FUNCTION;\n\n\tif ( testStyle$1.transition !== undefined ) {\n\t\tTRANSITION$1 = 'transition';\n\t\tTRANSITIONEND = 'transitionend';\n\t\tCSS_TRANSITIONS_ENABLED = true;\n\t} else if ( testStyle$1.webkitTransition !== undefined ) {\n\t\tTRANSITION$1 = 'webkitTransition';\n\t\tTRANSITIONEND = 'webkitTransitionEnd';\n\t\tCSS_TRANSITIONS_ENABLED = true;\n\t} else {\n\t\tCSS_TRANSITIONS_ENABLED = false;\n\t}\n\n\tif ( TRANSITION$1 ) {\n\t\tTRANSITION_DURATION = TRANSITION$1 + 'Duration';\n\t\tTRANSITION_PROPERTY = TRANSITION$1 + 'Property';\n\t\tTRANSITION_TIMING_FUNCTION = TRANSITION$1 + 'TimingFunction';\n\t}\n\n\tcreateTransitions = function ( t, to, options, changedProperties, resolve ) {\n\n\t\t// Wait a beat (otherwise the target styles will be applied immediately)\n\t\t// TODO use a fastdom-style mechanism?\n\t\tsetTimeout( function () {\n\t\t\tvar jsTransitionsComplete;\n\t\t\tvar cssTransitionsComplete;\n\t\t\tvar cssTimeout; // eslint-disable-line prefer-const\n\n\t\t\tfunction transitionDone () { clearTimeout( cssTimeout ); }\n\n\t\t\tfunction checkComplete () {\n\t\t\t\tif ( jsTransitionsComplete && cssTransitionsComplete ) {\n\t\t\t\t\tt.unregisterCompleteHandler( transitionDone );\n\t\t\t\t\t// will changes to events and fire have an unexpected consequence here?\n\t\t\t\t\tt.ractive.fire( t.name + ':end', t.node, t.isIntro );\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// this is used to keep track of which elements can use CSS to animate\n\t\t\t// which properties\n\t\t\tvar hashPrefix = ( t.node.namespaceURI || '' ) + t.node.tagName;\n\n\t\t\t// need to reset transition properties\n\t\t\tvar style = t.node.style;\n\t\t\tvar previous = {\n\t\t\t\tproperty: style[ TRANSITION_PROPERTY ],\n\t\t\t\ttiming: style[ TRANSITION_TIMING_FUNCTION ],\n\t\t\t\tduration: style[ TRANSITION_DURATION ]\n\t\t\t};\n\n\t\t\tstyle[ TRANSITION_PROPERTY ] = changedProperties.map( prefix$1 ).map( hyphenate ).join( ',' );\n\t\t\tstyle[ TRANSITION_TIMING_FUNCTION ] = hyphenate( options.easing || 'linear' );\n\t\t\tstyle[ TRANSITION_DURATION ] = ( options.duration / 1000 ) + 's';\n\n\t\t\tfunction transitionEndHandler ( event ) {\n\t\t\t\tvar index = changedProperties.indexOf( camelCase( unprefix( event.propertyName ) ) );\n\n\t\t\t\tif ( index !== -1 ) {\n\t\t\t\t\tchangedProperties.splice( index, 1 );\n\t\t\t\t}\n\n\t\t\t\tif ( changedProperties.length ) {\n\t\t\t\t\t// still transitioning...\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tclearTimeout( cssTimeout );\n\t\t\t\tcssTransitionsDone();\n\t\t\t}\n\n\t\t\tfunction cssTransitionsDone () {\n\t\t\t\tstyle[ TRANSITION_PROPERTY ] = previous.property;\n\t\t\t\tstyle[ TRANSITION_TIMING_FUNCTION ] = previous.duration;\n\t\t\t\tstyle[ TRANSITION_DURATION ] = previous.timing;\n\n\t\t\t\tt.node.removeEventListener( TRANSITIONEND, transitionEndHandler, false );\n\n\t\t\t\tcssTransitionsComplete = true;\n\t\t\t\tcheckComplete();\n\t\t\t}\n\n\t\t\tt.node.addEventListener( TRANSITIONEND, transitionEndHandler, false );\n\n\t\t\t// safety net in case transitionend never fires\n\t\t\tcssTimeout = setTimeout( function () {\n\t\t\t\tchangedProperties = [];\n\t\t\t\tcssTransitionsDone();\n\t\t\t}, options.duration + ( options.delay || 0 ) + 50 );\n\t\t\tt.registerCompleteHandler( transitionDone );\n\n\t\t\tsetTimeout( function () {\n\t\t\t\tvar i = changedProperties.length;\n\t\t\t\tvar hash;\n\t\t\t\tvar originalValue;\n\t\t\t\tvar index;\n\t\t\t\tvar propertiesToTransitionInJs = [];\n\t\t\t\tvar prop;\n\t\t\t\tvar suffix;\n\t\t\t\tvar interpolator;\n\n\t\t\t\twhile ( i-- ) {\n\t\t\t\t\tprop = changedProperties[i];\n\t\t\t\t\thash = hashPrefix + prop;\n\n\t\t\t\t\tif ( CSS_TRANSITIONS_ENABLED && !cannotUseCssTransitions[ hash ] ) {\n\t\t\t\t\t\tstyle[ prefix$1( prop ) ] = to[ prop ];\n\n\t\t\t\t\t\t// If we're not sure if CSS transitions are supported for\n\t\t\t\t\t\t// this tag/property combo, find out now\n\t\t\t\t\t\tif ( !canUseCssTransitions[ hash ] ) {\n\t\t\t\t\t\t\toriginalValue = t.getStyle( prop );\n\n\t\t\t\t\t\t\t// if this property is transitionable in this browser,\n\t\t\t\t\t\t\t// the current style will be different from the target style\n\t\t\t\t\t\t\tcanUseCssTransitions[ hash ] = ( t.getStyle( prop ) != to[ prop ] );\n\t\t\t\t\t\t\tcannotUseCssTransitions[ hash ] = !canUseCssTransitions[ hash ];\n\n\t\t\t\t\t\t\t// Reset, if we're going to use timers after all\n\t\t\t\t\t\t\tif ( cannotUseCssTransitions[ hash ] ) {\n\t\t\t\t\t\t\t\tstyle[ prefix$1( prop ) ] = originalValue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( !CSS_TRANSITIONS_ENABLED || cannotUseCssTransitions[ hash ] ) {\n\t\t\t\t\t\t// we need to fall back to timer-based stuff\n\t\t\t\t\t\tif ( originalValue === undefined ) {\n\t\t\t\t\t\t\toriginalValue = t.getStyle( prop );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// need to remove this from changedProperties, otherwise transitionEndHandler\n\t\t\t\t\t\t// will get confused\n\t\t\t\t\t\tindex = changedProperties.indexOf( prop );\n\t\t\t\t\t\tif ( index === -1 ) {\n\t\t\t\t\t\t\twarnIfDebug( 'Something very strange happened with transitions. Please raise an issue at https://github.com/ractivejs/ractive/issues - thanks!', { node: t.node });\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tchangedProperties.splice( index, 1 );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// TODO Determine whether this property is animatable at all\n\n\t\t\t\t\t\tsuffix = /[^\\d]*$/.exec( to[ prop ] )[0];\n\t\t\t\t\t\tinterpolator = interpolate( parseFloat( originalValue ), parseFloat( to[ prop ] ) ) || ( function () { return to[ prop ]; } );\n\n\t\t\t\t\t\t// ...then kick off a timer-based transition\n\t\t\t\t\t\tpropertiesToTransitionInJs.push({\n\t\t\t\t\t\t\tname: prefix$1( prop ),\n\t\t\t\t\t\t\tinterpolator: interpolator,\n\t\t\t\t\t\t\tsuffix: suffix\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// javascript transitions\n\t\t\t\tif ( propertiesToTransitionInJs.length ) {\n\t\t\t\t\tvar easing;\n\n\t\t\t\t\tif ( typeof options.easing === 'string' ) {\n\t\t\t\t\t\teasing = t.ractive.easing[ options.easing ];\n\n\t\t\t\t\t\tif ( !easing ) {\n\t\t\t\t\t\t\twarnOnceIfDebug( missingPlugin( options.easing, 'easing' ) );\n\t\t\t\t\t\t\teasing = linear$2;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if ( typeof options.easing === 'function' ) {\n\t\t\t\t\t\teasing = options.easing;\n\t\t\t\t\t} else {\n\t\t\t\t\t\teasing = linear$2;\n\t\t\t\t\t}\n\n\t\t\t\t\tnew Ticker({\n\t\t\t\t\t\tduration: options.duration,\n\t\t\t\t\t\teasing: easing,\n\t\t\t\t\t\tstep: function step ( pos ) {\n\t\t\t\t\t\t\tvar i = propertiesToTransitionInJs.length;\n\t\t\t\t\t\t\twhile ( i-- ) {\n\t\t\t\t\t\t\t\tvar prop = propertiesToTransitionInJs[i];\n\t\t\t\t\t\t\t\tt.node.style[ prop.name ] = prop.interpolator( pos ) + prop.suffix;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcomplete: function complete () {\n\t\t\t\t\t\t\tjsTransitionsComplete = true;\n\t\t\t\t\t\t\tcheckComplete();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tjsTransitionsComplete = true;\n\t\t\t\t}\n\n\t\t\t\tif ( !changedProperties.length ) {\n\t\t\t\t\t// We need to cancel the transitionEndHandler, and deal with\n\t\t\t\t\t// the fact that it will never fire\n\t\t\t\t\tt.node.removeEventListener( TRANSITIONEND, transitionEndHandler, false );\n\t\t\t\t\tcssTransitionsComplete = true;\n\t\t\t\t\tcheckComplete();\n\t\t\t\t}\n\t\t\t}, 0 );\n\t\t}, options.delay || 0 );\n\t};\n}\n\nvar createTransitions$1 = createTransitions;\n\nfunction resetStyle ( node, style ) {\n\tif ( style ) {\n\t\tnode.setAttribute( 'style', style );\n\t} else {\n\t\t// Next line is necessary, to remove empty style attribute!\n\t\t// See http://stackoverflow.com/a/7167553\n\t\tnode.getAttribute( 'style' );\n\t\tnode.removeAttribute( 'style' );\n\t}\n}\n\nvar getComputedStyle = win && ( win.getComputedStyle || legacy.getComputedStyle );\nvar resolved$1 = Promise$1.resolve();\n\nvar names = {\n\tt0: 'intro-outro',\n\tt1: 'intro',\n\tt2: 'outro'\n};\n\nvar Transition = function Transition ( options ) {\n\tthis.owner = options.owner || options.parentFragment.owner || findElement( options.parentFragment );\n\tthis.element = this.owner.attributeByName ? this.owner : findElement( options.parentFragment );\n\tthis.ractive = this.owner.ractive;\n\tthis.template = options.template;\n\tthis.parentFragment = options.parentFragment;\n\tthis.options = options;\n\tthis.onComplete = [];\n};\n\nTransition.prototype.animateStyle = function animateStyle ( style, value, options ) {\n\t\tvar this$1 = this;\n\n\tif ( arguments.length === 4 ) {\n\t\tthrow new Error( 't.animateStyle() returns a promise - use .then() instead of passing a callback' );\n\t}\n\n\t// Special case - page isn't visible. Don't animate anything, because\n\t// that way you'll never get CSS transitionend events\n\tif ( !visible ) {\n\t\tthis.setStyle( style, value );\n\t\treturn resolved$1;\n\t}\n\n\tvar to;\n\n\tif ( typeof style === 'string' ) {\n\t\tto = {};\n\t\tto[ style ] = value;\n\t} else {\n\t\tto = style;\n\n\t\t// shuffle arguments\n\t\toptions = value;\n\t}\n\n\t// As of 0.3.9, transition authors should supply an `option` object with\n\t// `duration` and `easing` properties (and optional `delay`), plus a\n\t// callback function that gets called after the animation completes\n\n\t// TODO remove this check in a future version\n\tif ( !options ) {\n\t\twarnOnceIfDebug( 'The \"%s\" transition does not supply an options object to `t.animateStyle()`. This will break in a future version of Ractive. For more info see https://github.com/RactiveJS/Ractive/issues/340', this.name );\n\t\toptions = this;\n\t}\n\n\treturn new Promise$1( function (fulfil) {\n\t\t// Edge case - if duration is zero, set style synchronously and complete\n\t\tif ( !options.duration ) {\n\t\t\tthis$1.setStyle( to );\n\t\t\tfulfil();\n\t\t\treturn;\n\t\t}\n\n\t\t// Get a list of the properties we're animating\n\t\tvar propertyNames = Object.keys( to );\n\t\tvar changedProperties = [];\n\n\t\t// Store the current styles\n\t\tvar computedStyle = getComputedStyle( this$1.owner.node );\n\n\t\tvar i = propertyNames.length;\n\t\twhile ( i-- ) {\n\t\t\tvar prop = propertyNames[i];\n\t\t\tvar current = computedStyle[ prefix$1( prop ) ];\n\n\t\t\tif ( current === '0px' ) { current = 0; }\n\n\t\t\t// we need to know if we're actually changing anything\n\t\t\tif ( current != to[ prop ] ) { // use != instead of !==, so we can compare strings with numbers\n\t\t\t\tchangedProperties.push( prop );\n\n\t\t\t\t// make the computed style explicit, so we can animate where\n\t\t\t\t// e.g. height='auto'\n\t\t\t\tthis$1.owner.node.style[ prefix$1( prop ) ] = current;\n\t\t\t}\n\t\t}\n\n\t\t// If we're not actually changing anything, the transitionend event\n\t\t// will never fire! So we complete early\n\t\tif ( !changedProperties.length ) {\n\t\t\tfulfil();\n\t\t\treturn;\n\t\t}\n\n\t\tcreateTransitions$1( this$1, to, options, changedProperties, fulfil );\n\t});\n};\n\nTransition.prototype.bind = function bind () {\n\tvar options = this.options;\n\tif ( options.template ) {\n\t\tif ( options.template.v === 't0' || options.template.v == 't1' ) { this.element._introTransition = this; }\n\t\tif ( options.template.v === 't0' || options.template.v == 't2' ) { this.element._outroTransition = this; }\n\t\tthis.eventName = names[ options.template.v ];\n\t}\n\n\tvar ractive = this.owner.ractive;\n\n\tthis.name = options.name || options.template.n;\n\n\tif ( options.params ) {\n\t\tthis.params = options.params;\n\t}\n\n\tif ( typeof this.name === 'function' ) {\n\t\tthis._fn = this.name;\n\t\tthis.name = this._fn.name;\n\t} else {\n\t\tthis._fn = findInViewHierarchy( 'transitions', ractive, this.name );\n\t}\n\n\tif ( !this._fn ) {\n\t\twarnOnceIfDebug( missingPlugin( this.name, 'transition' ), { ractive: ractive });\n\t}\n\n\tsetupArgsFn( this, options.template, this.parentFragment );\n};\n\nTransition.prototype.destroyed = function destroyed () {};\n\nTransition.prototype.getStyle = function getStyle ( props ) {\n\tvar computedStyle = getComputedStyle( this.owner.node );\n\n\tif ( typeof props === 'string' ) {\n\t\tvar value = computedStyle[ prefix$1( props ) ];\n\t\treturn value === '0px' ? 0 : value;\n\t}\n\n\tif ( !isArray( props ) ) {\n\t\tthrow new Error( 'Transition$getStyle must be passed a string, or an array of strings representing CSS properties' );\n\t}\n\n\tvar styles = {};\n\n\tvar i = props.length;\n\twhile ( i-- ) {\n\t\tvar prop = props[i];\n\t\tvar value$1 = computedStyle[ prefix$1( prop ) ];\n\n\t\tif ( value$1 === '0px' ) { value$1 = 0; }\n\t\tstyles[ prop ] = value$1;\n\t}\n\n\treturn styles;\n};\n\nTransition.prototype.processParams = function processParams ( params, defaults ) {\n\tif ( typeof params === 'number' ) {\n\t\tparams = { duration: params };\n\t}\n\n\telse if ( typeof params === 'string' ) {\n\t\tif ( params === 'slow' ) {\n\t\t\tparams = { duration: 600 };\n\t\t} else if ( params === 'fast' ) {\n\t\t\tparams = { duration: 200 };\n\t\t} else {\n\t\t\tparams = { duration: 400 };\n\t\t}\n\t} else if ( !params ) {\n\t\tparams = {};\n\t}\n\n\treturn extend$1( {}, defaults, params );\n};\n\nTransition.prototype.rebinding = function rebinding ( next, previous ) {\n\tvar idx = this.models.indexOf( previous );\n\tif ( !~idx ) { return; }\n\n\tnext = rebindMatch( this.template.f.r[ idx ], next, previous );\n\tif ( next === previous ) { return; }\n\n\tprevious.unregister( this );\n\tthis.models.splice( idx, 1, next );\n\tif ( next ) { next.addShuffleRegister( this, 'mark' ); }\n};\n\nTransition.prototype.registerCompleteHandler = function registerCompleteHandler ( fn ) {\n\taddToArray( this.onComplete, fn );\n};\n\nTransition.prototype.render = function render () {};\n\nTransition.prototype.setStyle = function setStyle ( style, value ) {\n\t\tvar this$1 = this;\n\n\tif ( typeof style === 'string' ) {\n\t\tthis.owner.node.style[ prefix$1( style ) ] = value;\n\t}\n\n\telse {\n\t\tvar prop;\n\t\tfor ( prop in style ) {\n\t\t\tif ( style.hasOwnProperty( prop ) ) {\n\t\t\t\tthis$1.owner.node.style[ prefix$1( prop ) ] = style[ prop ];\n\t\t\t}\n\t\t}\n\t}\n\n\treturn this;\n};\n\nTransition.prototype.start = function start () {\n\t\tvar this$1 = this;\n\n\tvar node = this.node = this.element.node;\n\tvar originalStyle = node.getAttribute( 'style' );\n\n\tvar completed;\n\tvar args = this.params;\n\n\t// create t.complete() - we don't want this on the prototype,\n\t// because we don't want `this` silliness when passing it as\n\t// an argument\n\tthis.complete = function (noReset) {\n\t\tif ( completed ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis$1.onComplete.forEach( function (fn) { return fn(); } );\n\t\tif ( !noReset && this$1.isIntro ) {\n\t\t\tresetStyle( node, originalStyle);\n\t\t}\n\n\t\tthis$1._manager.remove( this$1 );\n\n\t\tif ( this$1.shouldUnbind ) { teardownArgsFn( this$1, this$1.options.template ); }\n\n\t\tcompleted = true;\n\t};\n\n\t// If the transition function doesn't exist, abort\n\tif ( !this._fn ) {\n\t\tthis.complete();\n\t\treturn;\n\t}\n\n\t// get expression args if supplied\n\tif ( this.fn ) {\n\t\tvar values = this.models.map( function (model) {\n\t\t\tif ( !model ) { return undefined; }\n\n\t\t\treturn model.get();\n\t\t});\n\t\targs = this.fn.apply( this.ractive, values );\n\t}\n\n\tvar promise = this._fn.apply( this.ractive, [ this ].concat( args ) );\n\tif ( promise ) { promise.then( this.complete ); }\n};\n\nTransition.prototype.toString = function toString () { return ''; };\n\nTransition.prototype.unbind = function unbind () {\n\tthis.shouldUnbind = true;\n};\n\nTransition.prototype.unregisterCompleteHandler = function unregisterCompleteHandler ( fn ) {\n\tremoveFromArray( this.onComplete, fn );\n};\n\nTransition.prototype.unrender = function unrender () {};\n\nTransition.prototype.update = function update () {};\n\nvar elementCache = {};\n\nvar ieBug;\nvar ieBlacklist;\n\ntry {\n\tcreateElement( 'table' ).innerHTML = 'foo';\n} catch ( err ) {\n\tieBug = true;\n\n\tieBlacklist = {\n\t\tTABLE:  [ '<table class=\"x\">', '</table>' ],\n\t\tTHEAD:  [ '<table><thead class=\"x\">', '</thead></table>' ],\n\t\tTBODY:  [ '<table><tbody class=\"x\">', '</tbody></table>' ],\n\t\tTR:     [ '<table><tr class=\"x\">', '</tr></table>' ],\n\t\tSELECT: [ '<select class=\"x\">', '</select>' ]\n\t};\n}\n\nvar insertHtml = function ( html$$1, node, docFrag ) {\n\tvar nodes = [];\n\n\t// render 0 and false\n\tif ( html$$1 == null || html$$1 === '' ) { return nodes; }\n\n\tvar container;\n\tvar wrapper;\n\tvar selectedOption;\n\n\tif ( ieBug && ( wrapper = ieBlacklist[ node.tagName ] ) ) {\n\t\tcontainer = element( 'DIV' );\n\t\tcontainer.innerHTML = wrapper[0] + html$$1 + wrapper[1];\n\t\tcontainer = container.querySelector( '.x' );\n\n\t\tif ( container.tagName === 'SELECT' ) {\n\t\t\tselectedOption = container.options[ container.selectedIndex ];\n\t\t}\n\t}\n\n\telse if ( node.namespaceURI === svg$1 ) {\n\t\tcontainer = element( 'DIV' );\n\t\tcontainer.innerHTML = '<svg class=\"x\">' + html$$1 + '</svg>';\n\t\tcontainer = container.querySelector( '.x' );\n\t}\n\n\telse if ( node.tagName === 'TEXTAREA' ) {\n\t\tcontainer = createElement( 'div' );\n\n\t\tif ( typeof container.textContent !== 'undefined' ) {\n\t\t\tcontainer.textContent = html$$1;\n\t\t} else {\n\t\t\tcontainer.innerHTML = html$$1;\n\t\t}\n\t}\n\n\telse {\n\t\tcontainer = element( node.tagName );\n\t\tcontainer.innerHTML = html$$1;\n\n\t\tif ( container.tagName === 'SELECT' ) {\n\t\t\tselectedOption = container.options[ container.selectedIndex ];\n\t\t}\n\t}\n\n\tvar child;\n\twhile ( child = container.firstChild ) {\n\t\tnodes.push( child );\n\t\tdocFrag.appendChild( child );\n\t}\n\n\t// This is really annoying. Extracting <option> nodes from the\n\t// temporary container <select> causes the remaining ones to\n\t// become selected. So now we have to deselect them. IE8, you\n\t// amaze me. You really do\n\t// ...and now Chrome too\n\tvar i;\n\tif ( node.tagName === 'SELECT' ) {\n\t\ti = nodes.length;\n\t\twhile ( i-- ) {\n\t\t\tif ( nodes[i] !== selectedOption ) {\n\t\t\t\tnodes[i].selected = false;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn nodes;\n};\n\nfunction element ( tagName ) {\n\treturn elementCache[ tagName ] || ( elementCache[ tagName ] = createElement( tagName ) );\n}\n\nvar Triple = (function (Mustache$$1) {\n\tfunction Triple ( options ) {\n\t\tMustache$$1.call( this, options );\n\t}\n\n\tif ( Mustache$$1 ) Triple.__proto__ = Mustache$$1;\n\tTriple.prototype = Object.create( Mustache$$1 && Mustache$$1.prototype );\n\tTriple.prototype.constructor = Triple;\n\n\tTriple.prototype.detach = function detach () {\n\t\tvar docFrag = createDocumentFragment();\n\t\tthis.nodes.forEach( function (node) { return docFrag.appendChild( node ); } );\n\t\treturn docFrag;\n\t};\n\n\tTriple.prototype.find = function find ( selector ) {\n\t\tvar this$1 = this;\n\n\t\tvar len = this.nodes.length;\n\t\tvar i;\n\n\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\tvar node = this$1.nodes[i];\n\n\t\t\tif ( node.nodeType !== 1 ) { continue; }\n\n\t\t\tif ( matches( node, selector ) ) { return node; }\n\n\t\t\tvar queryResult = node.querySelector( selector );\n\t\t\tif ( queryResult ) { return queryResult; }\n\t\t}\n\n\t\treturn null;\n\t};\n\n\tTriple.prototype.findAll = function findAll ( selector, query ) {\n\t\tvar this$1 = this;\n\n\t\tvar len = this.nodes.length;\n\t\tvar i;\n\n\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\tvar node = this$1.nodes[i];\n\n\t\t\tif ( node.nodeType !== 1 ) { continue; }\n\n\t\t\tif ( query.test( node ) ) { query.add( node ); }\n\n\t\t\tvar queryAllResult = node.querySelectorAll( selector );\n\t\t\tif ( queryAllResult ) {\n\t\t\t\tvar numNodes = queryAllResult.length;\n\t\t\t\tvar j = (void 0);\n\n\t\t\t\tfor ( j = 0; j < numNodes; j += 1 ) {\n\t\t\t\t\tquery.add( queryAllResult[j] );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\tTriple.prototype.findComponent = function findComponent () {\n\t\treturn null;\n\t};\n\n\tTriple.prototype.firstNode = function firstNode () {\n\t\treturn this.nodes[0];\n\t};\n\n\tTriple.prototype.render = function render ( target ) {\n\t\tvar html = this.model ? this.model.get() : '';\n\t\tthis.nodes = insertHtml( html, this.parentFragment.findParentNode(), target );\n\t\tthis.rendered = true;\n\t};\n\n\tTriple.prototype.toString = function toString () {\n\t\treturn this.model && this.model.get() != null ? decodeCharacterReferences( '' + this.model.get() ) : '';\n\t};\n\n\tTriple.prototype.unrender = function unrender () {\n\t\tif ( this.nodes ) { this.nodes.forEach( function (node) { return detachNode( node ); } ); }\n\t\tthis.rendered = false;\n\t};\n\n\tTriple.prototype.update = function update () {\n\t\tif ( this.rendered && this.dirty ) {\n\t\t\tthis.dirty = false;\n\n\t\t\tthis.unrender();\n\t\t\tvar docFrag = createDocumentFragment();\n\t\t\tthis.render( docFrag );\n\n\t\t\tvar parentNode = this.parentFragment.findParentNode();\n\t\t\tvar anchor = this.parentFragment.findNextNode( this );\n\n\t\t\tparentNode.insertBefore( docFrag, anchor );\n\t\t} else {\n\t\t\t// make sure to reset the dirty flag even if not rendered\n\t\t\tthis.dirty = false;\n\t\t}\n\t};\n\n\treturn Triple;\n}(Mustache));\n\n// finds the component constructor in the registry or view hierarchy registries\nfunction getComponentConstructor ( ractive, name ) {\n\tvar instance = findInstance( 'components', ractive, name );\n\tvar Component;\n\n\tif ( instance ) {\n\t\tComponent = instance.components[ name ];\n\n\t\t// best test we have for not Ractive.extend\n\t\tif ( !Component._Parent ) {\n\t\t\t// function option, execute and store for reset\n\t\t\tvar fn = Component.bind( instance );\n\t\t\tfn.isOwner = instance.components.hasOwnProperty( name );\n\t\t\tComponent = fn();\n\n\t\t\tif ( !Component ) {\n\t\t\t\twarnIfDebug( noRegistryFunctionReturn, name, 'component', 'component', { ractive: ractive });\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( typeof Component === 'string' ) {\n\t\t\t\t// allow string lookup\n\t\t\t\tComponent = getComponentConstructor( ractive, Component );\n\t\t\t}\n\n\t\t\tComponent._fn = fn;\n\t\t\tinstance.components[ name ] = Component;\n\t\t}\n\t}\n\n\treturn Component;\n}\n\n//import Yielder from './Yielder';\nvar constructors = {};\nconstructors[ ALIAS ] = Alias;\nconstructors[ ANCHOR ] = Component;\nconstructors[ DOCTYPE ] = Doctype;\nconstructors[ INTERPOLATOR ] = Interpolator;\nconstructors[ PARTIAL ] = Partial;\nconstructors[ SECTION ] = Section;\nconstructors[ TRIPLE ] = Triple;\nconstructors[ YIELDER ] = Partial;\n\nconstructors[ ATTRIBUTE ] = Attribute;\nconstructors[ BINDING_FLAG ] = BindingFlag;\nconstructors[ DECORATOR ] = Decorator;\nconstructors[ EVENT ] = EventDirective;\nconstructors[ TRANSITION ] = Transition;\n\nvar specialElements = {\n\tdoctype: Doctype,\n\tform: Form,\n\tinput: Input,\n\toption: Option,\n\tselect: Select,\n\ttextarea: Textarea\n};\n\nfunction createItem ( options ) {\n\tif ( typeof options.template === 'string' ) {\n\t\treturn new Text( options );\n\t}\n\n\tif ( options.template.t === ELEMENT ) {\n\t\t// could be component or element\n\t\tvar ComponentConstructor = getComponentConstructor( options.parentFragment.ractive, options.template.e );\n\t\tif ( ComponentConstructor ) {\n\t\t\treturn new Component( options, ComponentConstructor );\n\t\t}\n\n\t\tvar tagName = options.template.e.toLowerCase();\n\n\t\tvar ElementConstructor = specialElements[ tagName ] || Element;\n\t\treturn new ElementConstructor( options );\n\t}\n\n\tvar Item;\n\n\t// component mappings are a special case of attribute\n\tif ( options.template.t === ATTRIBUTE ) {\n\t\tvar el = options.owner;\n\t\tif ( !el || ( el.type !== ANCHOR && el.type !== COMPONENT && el.type !== ELEMENT ) ) {\n\t\t\tel = findElement( options.parentFragment );\n\t\t}\n\t\toptions.element = el;\n\n\t\tItem = el.type === COMPONENT || el.type === ANCHOR ? Mapping : Attribute;\n\t} else {\n\t\tItem = constructors[ options.template.t ];\n\t}\n\n\tif ( !Item ) { throw new Error( (\"Unrecognised item type \" + (options.template.t)) ); }\n\n\treturn new Item( options );\n}\n\nvar ReferenceResolver = function ReferenceResolver ( fragment, reference, callback ) {\n\tvar this$1 = this;\n\n\tthis.fragment = fragment;\n\tthis.reference = normalise( reference );\n\tthis.callback = callback;\n\n\tthis.keys = splitKeypath( reference );\n\tthis.resolved = false;\n\n\tthis.contexts = [];\n\n\t// TODO the consumer should take care of addUnresolved\n\t// we attach to all the contexts between here and the root\n\t// - whenever their values change, they can quickly\n\t// check to see if we can resolve\n\twhile ( fragment ) {\n\t\tif ( fragment.context ) {\n\t\t\tfragment.context.addUnresolved( this$1.keys[0], this$1 );\n\t\t\tthis$1.contexts.push( fragment.context );\n\t\t}\n\n\t\tfragment = fragment.componentParent || fragment.parent;\n\t}\n};\n\nReferenceResolver.prototype.attemptResolution = function attemptResolution () {\n\tif ( this.resolved ) { return; }\n\n\tvar model = resolveReference( this.fragment, this.reference );\n\n\tif ( model ) {\n\t\tthis.resolved = true;\n\t\tthis.callback( model );\n\t}\n};\n\nReferenceResolver.prototype.forceResolution = function forceResolution () {\n\tif ( this.resolved ) { return; }\n\n\tvar model = this.fragment.findContext().joinAll( this.keys );\n\tthis.callback( model );\n\tthis.resolved = true;\n};\n\nReferenceResolver.prototype.rebinding = function rebinding ( next, previous ) {\n\t\tvar this$1 = this;\n\n\tif ( previous ) { previous.removeUnresolved( this.keys[0], this ); }\n\tif ( next ) { runloop.scheduleTask( function () { return next.addUnresolved( this$1.keys[0], this$1 ); } ); }\n};\n\nReferenceResolver.prototype.unbind = function unbind () {\n\t\tvar this$1 = this;\n\n\tif ( this.fragment ) { removeFromArray( this.fragment.unresolved, this ); }\n\n\tif ( this.resolved ) { return; }\n\n\tthis.contexts.forEach( function (c) { return c.removeUnresolved( this$1.keys[0], this$1 ); } );\n};\n\n// TODO all this code needs to die\nfunction processItems ( items, values, guid, counter ) {\n\tif ( counter === void 0 ) counter = 0;\n\n\treturn items.map( function (item) {\n\t\tif ( item.type === TEXT ) {\n\t\t\treturn item.template;\n\t\t}\n\n\t\tif ( item.fragment ) {\n\t\t\tif ( item.fragment.iterations ) {\n\t\t\t\treturn item.fragment.iterations.map( function (fragment) {\n\t\t\t\t\treturn processItems( fragment.items, values, guid, counter );\n\t\t\t\t}).join( '' );\n\t\t\t} else {\n\t\t\t\treturn processItems( item.fragment.items, values, guid, counter );\n\t\t\t}\n\t\t}\n\n\t\tvar placeholderId = guid + \"-\" + (counter++);\n\t\tvar model = item.model || item.newModel;\n\n\t\tvalues[ placeholderId ] = model ?\n\t\t\tmodel.wrapper ?\n\t\t\t\tmodel.wrapperValue :\n\t\t\t\tmodel.get() :\n\t\t\tundefined;\n\n\t\treturn '${' + placeholderId + '}';\n\t}).join( '' );\n}\n\nfunction unrenderAndDestroy$1 ( item ) {\n\titem.unrender( true );\n}\n\nvar Fragment = function Fragment ( options ) {\n\tthis.owner = options.owner; // The item that owns this fragment - an element, section, partial, or attribute\n\n\tthis.isRoot = !options.owner.parentFragment;\n\tthis.parent = this.isRoot ? null : this.owner.parentFragment;\n\tthis.ractive = options.ractive || ( this.isRoot ? options.owner : this.parent.ractive );\n\n\tthis.componentParent = ( this.isRoot && this.ractive.component ) ? this.ractive.component.parentFragment : null;\n\n\tthis.context = null;\n\tthis.rendered = false;\n\n\t// encapsulated styles should be inherited until they get applied by an element\n\tthis.cssIds = 'cssIds' in options ? options.cssIds : ( this.parent ? this.parent.cssIds : null );\n\n\tthis.resolvers = [];\n\n\tthis.dirty = false;\n\tthis.dirtyValue = true; // used for attribute values\n\n\tthis.template = options.template || [];\n\tthis.createItems();\n};\n\nFragment.prototype.bind = function bind$1 ( context ) {\n\tthis.context = context;\n\tthis.items.forEach( bind$1$1 );\n\tthis.bound = true;\n\n\t// in rare cases, a forced resolution (or similar) will cause the\n\t// fragment to be dirty before it's even finished binding. In those\n\t// cases we update immediately\n\tif ( this.dirty ) { this.update(); }\n\n\treturn this;\n};\n\nFragment.prototype.bubble = function bubble () {\n\tthis.dirtyValue = true;\n\n\tif ( !this.dirty ) {\n\t\tthis.dirty = true;\n\n\t\tif ( this.isRoot ) { // TODO encapsulate 'is component root, but not overall root' check?\n\t\t\tif ( this.ractive.component ) {\n\t\t\t\tthis.ractive.component.bubble();\n\t\t\t} else if ( this.bound ) {\n\t\t\t\trunloop.addFragment( this );\n\t\t\t}\n\t\t} else {\n\t\t\tthis.owner.bubble();\n\t\t}\n\t}\n};\n\nFragment.prototype.createItems = function createItems () {\n\t\tvar this$1 = this;\n\n\t// this is a hot code path\n\tvar max = this.template.length;\n\tthis.items = [];\n\tfor ( var i = 0; i < max; i++ ) {\n\t\tthis$1.items[i] = createItem({ parentFragment: this$1, template: this$1.template[i], index: i });\n\t}\n};\n\nFragment.prototype.destroyed = function destroyed$1 () {\n\tthis.items.forEach( destroyed$1$1 );\n};\n\nFragment.prototype.detach = function detach () {\n\tvar docFrag = createDocumentFragment();\n\tthis.items.forEach( function (item) { return docFrag.appendChild( item.detach() ); } );\n\treturn docFrag;\n};\n\nFragment.prototype.find = function find ( selector, options ) {\n\treturn findMap( this.items, function (i) { return i.find( selector, options ); } );\n};\n\nFragment.prototype.findAll = function findAll ( selector, query ) {\n\tif ( this.items ) {\n\t\tthis.items.forEach( function (i) { return i.findAll && i.findAll( selector, query ); } );\n\t}\n};\n\nFragment.prototype.findComponent = function findComponent ( name, options ) {\n\treturn findMap( this.items, function (i) { return i.findComponent( name, options ); } );\n};\n\nFragment.prototype.findAllComponents = function findAllComponents ( name, query ) {\n\tif ( this.items ) {\n\t\tthis.items.forEach( function (i) { return i.findAllComponents && i.findAllComponents( name, query ); } );\n\t}\n};\n\nFragment.prototype.findContext = function findContext () {\n\tvar fragment = this;\n\twhile ( fragment && !fragment.context ) { fragment = fragment.parent; }\n\tif ( !fragment ) { return this.ractive.viewmodel; }\n\telse { return fragment.context; }\n};\n\nFragment.prototype.findNextNode = function findNextNode ( item ) {\n\t\tvar this$1 = this;\n\n\t// search for the next node going forward\n\tif ( item ) {\n\t\tfor ( var i = item.index + 1; i < this.items.length; i++ ) {\n\t\t\tif ( !this$1.items[ i ] ) { continue; }\n\n\t\t\tvar node = this$1.items[ i ].firstNode( true );\n\t\t\tif ( node ) { return node; }\n\t\t}\n\t}\n\n\t// if this is the root fragment, and there are no more items,\n\t// it means we're at the end...\n\tif ( this.isRoot ) {\n\t\tif ( this.ractive.component ) {\n\t\t\treturn this.ractive.component.parentFragment.findNextNode( this.ractive.component );\n\t\t}\n\n\t\t// TODO possible edge case with other content\n\t\t// appended to this.ractive.el?\n\t\treturn null;\n\t}\n\n\tif ( this.parent ) { return this.owner.findNextNode( this ); } // the argument is in case the parent is a RepeatedFragment\n};\n\nFragment.prototype.findParentNode = function findParentNode () {\n\tvar fragment = this;\n\n\tdo {\n\t\tif ( fragment.owner.type === ELEMENT ) {\n\t\t\treturn fragment.owner.node;\n\t\t}\n\n\t\tif ( fragment.isRoot && !fragment.ractive.component ) { // TODO encapsulate check\n\t\t\treturn fragment.ractive.el;\n\t\t}\n\n\t\tif ( fragment.owner.type === YIELDER ) {\n\t\t\tfragment = fragment.owner.containerFragment;\n\t\t} else {\n\t\t\tfragment = fragment.componentParent || fragment.parent; // TODO ugh\n\t\t}\n\t} while ( fragment );\n\n\tthrow new Error( 'Could not find parent node' ); // TODO link to issue tracker\n};\n\nFragment.prototype.findRepeatingFragment = function findRepeatingFragment () {\n\tvar fragment = this;\n\t// TODO better check than fragment.parent.iterations\n\twhile ( ( fragment.parent || fragment.componentParent ) && !fragment.isIteration ) {\n\t\tfragment = fragment.parent || fragment.componentParent;\n\t}\n\n\treturn fragment;\n};\n\nFragment.prototype.firstNode = function firstNode ( skipParent ) {\n\tvar node = findMap( this.items, function (i) { return i.firstNode( true ); } );\n\tif ( node ) { return node; }\n\tif ( skipParent ) { return null; }\n\n\treturn this.parent.findNextNode( this.owner );\n};\n\nFragment.prototype.rebinding = function rebinding ( next ) {\n\tthis.context = next;\n};\n\nFragment.prototype.render = function render ( target, occupants ) {\n\tif ( this.rendered ) { throw new Error( 'Fragment is already rendered!' ); }\n\tthis.rendered = true;\n\n\tthis.items.forEach( function (item) { return item.render( target, occupants ); } );\n};\n\nFragment.prototype.resetTemplate = function resetTemplate ( template ) {\n\tvar wasBound = this.bound;\n\tvar wasRendered = this.rendered;\n\n\t// TODO ensure transitions are disabled globally during reset\n\n\tif ( wasBound ) {\n\t\tif ( wasRendered ) { this.unrender( true ); }\n\t\tthis.unbind();\n\t}\n\n\tthis.template = template;\n\tthis.createItems();\n\n\tif ( wasBound ) {\n\t\tthis.bind( this.context );\n\n\t\tif ( wasRendered ) {\n\t\t\tvar parentNode = this.findParentNode();\n\t\t\tvar anchor = this.findNextNode();\n\n\t\t\tif ( anchor ) {\n\t\t\t\tvar docFrag = createDocumentFragment();\n\t\t\t\tthis.render( docFrag );\n\t\t\t\tparentNode.insertBefore( docFrag, anchor );\n\t\t\t} else {\n\t\t\t\tthis.render( parentNode );\n\t\t\t}\n\t\t}\n\t}\n};\n\nFragment.prototype.resolve = function resolve ( template, callback ) {\n\tif ( !this.context && this.parent.resolve ) {\n\t\treturn this.parent.resolve( template, callback );\n\t}\n\n\tvar resolver = new ReferenceResolver( this, template, callback );\n\tthis.resolvers.push( resolver );\n\n\treturn resolver; // so we can e.g. force resolution\n};\n\nFragment.prototype.shuffled = function shuffled$1 () {\n\tthis.items.forEach( shuffled$1$1 );\n};\n\nFragment.prototype.toHtml = function toHtml () {\n\treturn this.toString();\n};\n\nFragment.prototype.toString = function toString$1 ( escape ) {\n\treturn this.items.map( escape ? toEscapedString : toString$2 ).join( '' );\n};\n\nFragment.prototype.unbind = function unbind$1 () {\n\tthis.items.forEach( unbind$1$1 );\n\tthis.bound = false;\n\n\treturn this;\n};\n\nFragment.prototype.unrender = function unrender$1 ( shouldDestroy ) {\n\tthis.items.forEach( shouldDestroy ? unrenderAndDestroy$1 : unrender$1$1 );\n\tthis.rendered = false;\n};\n\nFragment.prototype.update = function update$1 () {\n\tif ( this.dirty ) {\n\t\tif ( !this.updating ) {\n\t\t\tthis.dirty = false;\n\t\t\tthis.updating = true;\n\t\t\tthis.items.forEach( update$1$1 );\n\t\t\tthis.updating = false;\n\t\t} else if ( this.isRoot ) {\n\t\t\trunloop.addFragmentToRoot( this );\n\t\t}\n\t}\n};\n\nFragment.prototype.valueOf = function valueOf () {\n\tif ( this.items.length === 1 ) {\n\t\treturn this.items[0].valueOf();\n\t}\n\n\tif ( this.dirtyValue ) {\n\t\tvar values = {};\n\t\tvar source = processItems( this.items, values, this.ractive._guid );\n\t\tvar parsed = parseJSON( source, values );\n\n\t\tthis.value = parsed ?\n\t\t\tparsed.value :\n\t\t\tthis.toString();\n\n\t\tthis.dirtyValue = false;\n\t}\n\n\treturn this.value;\n};\n\nfunction getChildQueue ( queue, ractive ) {\n\treturn queue[ ractive._guid ] || ( queue[ ractive._guid ] = [] );\n}\n\nfunction fire$1 ( hookQueue, ractive ) {\n\tvar childQueue = getChildQueue( hookQueue.queue, ractive );\n\n\thookQueue.hook.fire( ractive );\n\n\t// queue is \"live\" because components can end up being\n\t// added while hooks fire on parents that modify data values.\n\twhile ( childQueue.length ) {\n\t\tfire$1( hookQueue, childQueue.shift() );\n\t}\n\n\tdelete hookQueue.queue[ ractive._guid ];\n}\n\nvar HookQueue = function HookQueue ( event ) {\n\tthis.hook = new Hook( event );\n\tthis.inProcess = {};\n\tthis.queue = {};\n};\n\nHookQueue.prototype.begin = function begin ( ractive ) {\n\tthis.inProcess[ ractive._guid ] = true;\n};\n\nHookQueue.prototype.end = function end ( ractive ) {\n\tvar parent = ractive.parent;\n\n\t// If this is *isn't* a child of a component that's in process,\n\t// it should call methods or fire at this point\n\tif ( !parent || !this.inProcess[ parent._guid ] ) {\n\t\tfire$1( this, ractive );\n\t}\n\t// elsewise, handoff to parent to fire when ready\n\telse {\n\t\tgetChildQueue( this.queue, parent ).push( ractive );\n\t}\n\n\tdelete this.inProcess[ ractive._guid ];\n};\n\nvar configHook = new Hook( 'config' );\nvar initHook = new HookQueue( 'init' );\n\nfunction initialise ( ractive, userOptions, options ) {\n\tObject.keys( ractive.viewmodel.computations ).forEach( function (key) {\n\t\tvar computation = ractive.viewmodel.computations[ key ];\n\n\t\tif ( ractive.viewmodel.value.hasOwnProperty( key ) ) {\n\t\t\tcomputation.set( ractive.viewmodel.value[ key ] );\n\t\t}\n\t});\n\n\t// init config from Parent and options\n\tconfig.init( ractive.constructor, ractive, userOptions );\n\n\tconfigHook.fire( ractive );\n\tinitHook.begin( ractive );\n\n\tvar fragment = ractive.fragment = createFragment( ractive, options );\n\tif ( fragment ) { fragment.bind( ractive.viewmodel ); }\n\n\tinitHook.end( ractive );\n\n\tif ( fragment ) {\n\t\t// render automatically ( if `el` is specified )\n\t\tvar el = getElement( ractive.el || ractive.target );\n\t\tif ( el ) {\n\t\t\tvar promise = ractive.render( el, ractive.append );\n\n\t\t\tif ( Ractive.DEBUG_PROMISES ) {\n\t\t\t\tpromise.catch( function (err) {\n\t\t\t\t\twarnOnceIfDebug( 'Promise debugging is enabled, to help solve errors that happen asynchronously. Some browsers will log unhandled promise rejections, in which case you can safely disable promise debugging:\\n  Ractive.DEBUG_PROMISES = false;' );\n\t\t\t\t\twarnIfDebug( 'An error happened during rendering', { ractive: ractive });\n\t\t\t\t\tlogIfDebug( err );\n\n\t\t\t\t\tthrow err;\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction createFragment ( ractive, options ) {\n\tif ( options === void 0 ) options = {};\n\n\tif ( ractive.template ) {\n\t\tvar cssIds;\n\n\t\tif ( options.cssIds || ractive.cssId ) {\n\t\t\tcssIds = options.cssIds ? options.cssIds.slice() : [];\n\n\t\t\tif ( ractive.cssId ) {\n\t\t\t\tcssIds.push( ractive.cssId );\n\t\t\t}\n\t\t}\n\n\t\treturn new Fragment({\n\t\t\towner: ractive,\n\t\t\ttemplate: ractive.template,\n\t\t\tcssIds: cssIds\n\t\t});\n\t}\n}\n\nvar renderHook = new Hook( 'render' );\nvar completeHook = new Hook( 'complete' );\n\nfunction render$2 ( ractive, target, anchor, occupants ) {\n\t// if `noIntro` is `true`, temporarily disable transitions\n\tvar transitionsEnabled = ractive.transitionsEnabled;\n\tif ( ractive.noIntro ) { ractive.transitionsEnabled = false; }\n\n\tvar promise = runloop.start( ractive, true );\n\trunloop.scheduleTask( function () { return renderHook.fire( ractive ); }, true );\n\n\tif ( ractive.fragment.rendered ) {\n\t\tthrow new Error( 'You cannot call ractive.render() on an already rendered instance! Call ractive.unrender() first' );\n\t}\n\n\tif ( ractive.destroyed ) {\n\t\tractive.destroyed = false;\n\t\tractive.fragment = createFragment( ractive ).bind( ractive.viewmodel );\n\t}\n\n\tanchor = getElement( anchor ) || ractive.anchor;\n\n\tractive.el = ractive.target = target;\n\tractive.anchor = anchor;\n\n\t// ensure encapsulated CSS is up-to-date\n\tif ( ractive.cssId ) { applyCSS(); }\n\n\tif ( target ) {\n\t\t( target.__ractive_instances__ || ( target.__ractive_instances__ = [] ) ).push( ractive );\n\n\t\tif ( anchor ) {\n\t\t\tvar docFrag = doc.createDocumentFragment();\n\t\t\tractive.fragment.render( docFrag );\n\t\t\ttarget.insertBefore( docFrag, anchor );\n\t\t} else {\n\t\t\tractive.fragment.render( target, occupants );\n\t\t}\n\t}\n\n\trunloop.end();\n\tractive.transitionsEnabled = transitionsEnabled;\n\n\treturn promise.then( function () { return completeHook.fire( ractive ); } );\n}\n\nfunction Ractive$render ( target, anchor ) {\n\tif ( this.torndown ) {\n\t\twarnIfDebug( 'ractive.render() was called on a Ractive instance that was already torn down' );\n\t\treturn Promise.resolve();\n\t}\n\n\ttarget = getElement( target ) || this.el;\n\n\tif ( !this.append && target ) {\n\t\t// Teardown any existing instances *before* trying to set up the new one -\n\t\t// avoids certain weird bugs\n\t\tvar others = target.__ractive_instances__;\n\t\tif ( others ) { others.forEach( teardown$1$1 ); }\n\n\t\t// make sure we are the only occupants\n\t\tif ( !this.enhance ) {\n\t\t\ttarget.innerHTML = ''; // TODO is this quicker than removeChild? Initial research inconclusive\n\t\t}\n\t}\n\n\tvar occupants = this.enhance ? toArray( target.childNodes ) : null;\n\tvar promise = render$2( this, target, anchor, occupants );\n\n\tif ( occupants ) {\n\t\twhile ( occupants.length ) { target.removeChild( occupants.pop() ); }\n\t}\n\n\treturn promise;\n}\n\nvar shouldRerender = [ 'template', 'partials', 'components', 'decorators', 'events' ];\n\nvar completeHook$1 = new Hook( 'complete' );\nvar resetHook = new Hook( 'reset' );\nvar renderHook$1 = new Hook( 'render' );\nvar unrenderHook = new Hook( 'unrender' );\n\nfunction Ractive$reset ( data ) {\n\tdata = data || {};\n\n\tif ( typeof data !== 'object' ) {\n\t\tthrow new Error( 'The reset method takes either no arguments, or an object containing new data' );\n\t}\n\n\t// TEMP need to tidy this up\n\tdata = dataConfigurator.init( this.constructor, this, { data: data });\n\n\tvar promise = runloop.start( this, true );\n\n\t// If the root object is wrapped, try and use the wrapper's reset value\n\tvar wrapper = this.viewmodel.wrapper;\n\tif ( wrapper && wrapper.reset ) {\n\t\tif ( wrapper.reset( data ) === false ) {\n\t\t\t// reset was rejected, we need to replace the object\n\t\t\tthis.viewmodel.set( data );\n\t\t}\n\t} else {\n\t\tthis.viewmodel.set( data );\n\t}\n\n\t// reset config items and track if need to rerender\n\tvar changes = config.reset( this );\n\tvar rerender;\n\n\tvar i = changes.length;\n\twhile ( i-- ) {\n\t\tif ( shouldRerender.indexOf( changes[i] ) > -1 ) {\n\t\t\trerender = true;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif ( rerender ) {\n\t\tunrenderHook.fire( this );\n\t\tthis.fragment.resetTemplate( this.template );\n\t\trenderHook$1.fire( this );\n\t\tcompleteHook$1.fire( this );\n\t}\n\n\trunloop.end();\n\n\tresetHook.fire( this, data );\n\n\treturn promise;\n}\n\nfunction collect( source, name, attr, dest ) {\n\tsource.forEach( function (item) {\n\t\t// queue to rerender if the item is a partial and the current name matches\n\t\tif ( item.type === PARTIAL && ( item.refName ===  name || item.name === name ) ) {\n\t\t\titem.inAttribute = attr;\n\t\t\tdest.push( item );\n\t\t\treturn; // go no further\n\t\t}\n\n\t\t// if it has a fragment, process its items\n\t\tif ( item.fragment ) {\n\t\t\tcollect( item.fragment.iterations || item.fragment.items, name, attr, dest );\n\t\t}\n\n\t\t// or if it is itself a fragment, process its items\n\t\telse if ( isArray( item.items ) ) {\n\t\t\tcollect( item.items, name, attr, dest );\n\t\t}\n\n\t\t// or if it is a component, step in and process its items\n\t\telse if ( item.type === COMPONENT && item.instance ) {\n\t\t\t// ...unless the partial is shadowed\n\t\t\tif ( item.instance.partials[ name ] ) { return; }\n\t\t\tcollect( item.instance.fragment.items, name, attr, dest );\n\t\t}\n\n\t\t// if the item is an element, process its attributes too\n\t\tif ( item.type === ELEMENT ) {\n\t\t\tif ( isArray( item.attributes ) ) {\n\t\t\t\tcollect( item.attributes, name, true, dest );\n\t\t\t}\n\t\t}\n\t});\n}\n\nfunction forceResetTemplate$1 ( partial ) {\n\tpartial.forceResetTemplate();\n}\n\nvar resetPartial = function ( name, partial ) {\n\tvar collection = [];\n\tcollect( this.fragment.items, name, false, collection );\n\n\tvar promise = runloop.start( this, true );\n\n\tthis.partials[ name ] = partial;\n\tcollection.forEach( forceResetTemplate$1 );\n\n\trunloop.end();\n\n\treturn promise;\n};\n\n// TODO should resetTemplate be asynchronous? i.e. should it be a case\n// of outro, update template, intro? I reckon probably not, since that\n// could be achieved with unrender-resetTemplate-render. Also, it should\n// conceptually be similar to resetPartial, which couldn't be async\n\nfunction Ractive$resetTemplate ( template ) {\n\ttemplateConfigurator.init( null, this, { template: template });\n\n\tvar transitionsEnabled = this.transitionsEnabled;\n\tthis.transitionsEnabled = false;\n\n\t// Is this is a component, we need to set the `shouldDestroy`\n\t// flag, otherwise it will assume by default that a parent node\n\t// will be detached, and therefore it doesn't need to bother\n\t// detaching its own nodes\n\tvar component = this.component;\n\tif ( component ) { component.shouldDestroy = true; }\n\tthis.unrender();\n\tif ( component ) { component.shouldDestroy = false; }\n\n\tvar promise = runloop.start();\n\n\t// remove existing fragment and create new one\n\tthis.fragment.unbind().unrender( true );\n\n\tthis.fragment = new Fragment({\n\t\ttemplate: this.template,\n\t\troot: this,\n\t\towner: this\n\t});\n\n\tvar docFrag = createDocumentFragment();\n\tthis.fragment.bind( this.viewmodel ).render( docFrag );\n\n\t// if this is a component, its el may not be valid, so find a\n\t// target based on the component container\n\tif ( component && !component.external ) {\n\t\tthis.fragment.findParentNode().insertBefore( docFrag, component.findNextNode() );\n\t} else {\n\t\tthis.el.insertBefore( docFrag, this.anchor );\n\t}\n\n\trunloop.end();\n\n\tthis.transitionsEnabled = transitionsEnabled;\n\n\treturn promise;\n}\n\nvar reverse$1 = makeArrayMethod( 'reverse' ).path;\n\nfunction Ractive$set ( keypath, value ) {\n\tvar ractive = this;\n\n\treturn set$1( ractive, build( ractive, keypath, value ) );\n}\n\nvar shift$1 = makeArrayMethod( 'shift' ).path;\n\nvar sort$1 = makeArrayMethod( 'sort' ).path;\n\nvar splice$1 = makeArrayMethod( 'splice' ).path;\n\nfunction Ractive$subtract ( keypath, d ) {\n\treturn add$1( this, keypath, ( d === undefined ? -1 : -d ) );\n}\n\nfunction Ractive$toggle ( keypath ) {\n\tif ( typeof keypath !== 'string' ) {\n\t\tthrow new TypeError( badArguments );\n\t}\n\n\treturn set$1( this, gather( this, keypath ).map( function (m) { return [ m, !m.get() ]; } ) );\n}\n\nfunction Ractive$toCSS() {\n\tvar cssIds = [ this.cssId ].concat( this.findAllComponents().map( function (c) { return c.cssId; } ) );\n\tvar uniqueCssIds = Object.keys(cssIds.reduce( function ( ids, id ) { return (ids[id] = true, ids); }, {}));\n\treturn getCSS( uniqueCssIds );\n}\n\nfunction Ractive$toHTML () {\n\treturn this.fragment.toString( true );\n}\n\nfunction toText () {\n\treturn this.fragment.toString( false );\n}\n\nfunction Ractive$transition ( name, node, params ) {\n\n\tif ( node instanceof HTMLElement ) {\n\t\t// good to go\n\t}\n\telse if ( isObject( node ) ) {\n\t\t// omitted, use event node\n\t\tparams = node;\n\t}\n\n\t// if we allow query selector, then it won't work\n\t// simple params like \"fast\"\n\n\t// else if ( typeof node === 'string' ) {\n\t// \t// query selector\n\t// \tnode = this.find( node )\n\t// }\n\n\tnode = node || this.event.node;\n\n\tif ( !node || !node._ractive ) {\n\t\tfatal( (\"No node was supplied for transition \" + name) );\n\t}\n\n\tparams = params || {};\n\tvar owner = node._ractive.proxy;\n\tvar transition = new Transition({ owner: owner, parentFragment: owner.parentFragment, name: name, params: params });\n\ttransition.bind();\n\n\tvar promise = runloop.start( this, true );\n\trunloop.registerTransition( transition );\n\trunloop.end();\n\n\tpromise.then( function () { return transition.unbind(); } );\n\treturn promise;\n}\n\nfunction unlink$2( here ) {\n\tvar promise = runloop.start();\n\tthis.viewmodel.joinAll( splitKeypath( here ), { lastLink: false } ).unlink();\n\trunloop.end();\n\treturn promise;\n}\n\nvar unrenderHook$1 = new Hook( 'unrender' );\n\nfunction Ractive$unrender () {\n\tif ( !this.fragment.rendered ) {\n\t\twarnIfDebug( 'ractive.unrender() was called on a Ractive instance that was not rendered' );\n\t\treturn Promise$1.resolve();\n\t}\n\n\tvar promise = runloop.start( this, true );\n\n\t// If this is a component, and the component isn't marked for destruction,\n\t// don't detach nodes from the DOM unnecessarily\n\tvar shouldDestroy = !this.component || ( this.component.anchor || {} ).shouldDestroy || this.component.shouldDestroy || this.shouldDestroy;\n\tthis.fragment.unrender( shouldDestroy );\n\tif ( shouldDestroy ) { this.destroyed = true; }\n\n\tremoveFromArray( this.el.__ractive_instances__, this );\n\n\tunrenderHook$1.fire( this );\n\n\trunloop.end();\n\treturn promise;\n}\n\nvar unshift$1 = makeArrayMethod( 'unshift' ).path;\n\nfunction Ractive$updateModel ( keypath, cascade ) {\n\tvar promise = runloop.start( this, true );\n\n\tif ( !keypath ) {\n\t\tthis.viewmodel.updateFromBindings( true );\n\t} else {\n\t\tthis.viewmodel.joinAll( splitKeypath( keypath ) ).updateFromBindings( cascade !== false );\n\t}\n\n\trunloop.end();\n\n\treturn promise;\n}\n\nvar proto = {\n\tadd: Ractive$add,\n\tanimate: Ractive$animate,\n\tattachChild: attachChild,\n\tdetach: Ractive$detach,\n\tdetachChild: detachChild,\n\tfind: Ractive$find,\n\tfindAll: Ractive$findAll,\n\tfindAllComponents: Ractive$findAllComponents,\n\tfindComponent: Ractive$findComponent,\n\tfindContainer: Ractive$findContainer,\n\tfindParent: Ractive$findParent,\n\tfire: Ractive$fire,\n\tget: Ractive$get,\n\tgetNodeInfo: getNodeInfo,\n\tinsert: Ractive$insert,\n\tlink: link$2,\n\tmerge: thisRactive$merge,\n\tobserve: observe$1,\n\tobserveList: observeList,\n\tobserveOnce: observeOnce$1,\n\t// TODO reinstate these\n\t// observeListOnce,\n\toff: Ractive$off,\n\ton: Ractive$on,\n\tonce: Ractive$once,\n\tpop: pop$1,\n\tpush: push$1,\n\trender: Ractive$render,\n\treset: Ractive$reset,\n\tresetPartial: resetPartial,\n\tresetTemplate: Ractive$resetTemplate,\n\treverse: reverse$1,\n\tset: Ractive$set,\n\tshift: shift$1,\n\tsort: sort$1,\n\tsplice: splice$1,\n\tsubtract: Ractive$subtract,\n\tteardown: Ractive$teardown,\n\ttoggle: Ractive$toggle,\n\ttoCSS: Ractive$toCSS,\n\ttoCss: Ractive$toCSS,\n\ttoHTML: Ractive$toHTML,\n\ttoHtml: Ractive$toHTML,\n\ttoText: toText,\n\ttransition: Ractive$transition,\n\tunlink: unlink$2,\n\tunrender: Ractive$unrender,\n\tunshift: unshift$1,\n\tupdate: Ractive$update,\n\tupdateModel: Ractive$updateModel\n};\n\nvar wrap$2 = function ( method, superMethod, force ) {\n\n\tif ( force || needsSuper( method, superMethod ) )  {\n\n\t\treturn function () {\n\n\t\t\tvar hasSuper = ( '_super' in this );\n\t\t\tvar _super = this._super;\n\n\t\t\tthis._super = superMethod;\n\n\t\t\tvar result = method.apply( this, arguments );\n\n\t\t\tif ( hasSuper ) {\n\t\t\t\tthis._super = _super;\n\t\t\t}\n\n\t\t\treturn result;\n\t\t};\n\t}\n\n\telse {\n\t\treturn method;\n\t}\n};\n\nfunction needsSuper ( method, superMethod ) {\n\treturn typeof superMethod === 'function' && /_super/.test( method );\n}\n\nfunction unwrap ( Child ) {\n\tvar options = {};\n\n\twhile ( Child ) {\n\t\taddRegistries( Child, options );\n\t\taddOtherOptions( Child, options );\n\n\t\tif ( Child._Parent !== Ractive ) {\n\t\t\tChild = Child._Parent;\n\t\t} else {\n\t\t\tChild = false;\n\t\t}\n\t}\n\n\treturn options;\n}\n\nfunction addRegistries ( Child, options ) {\n\tregistries.forEach( function (r) {\n\t\taddRegistry(\n\t\t\tr.useDefaults ? Child.prototype : Child,\n\t\t\toptions, r.name );\n\t});\n}\n\nfunction addRegistry ( target, options, name ) {\n\tvar registry;\n\tvar keys = Object.keys( target[ name ] );\n\n\tif ( !keys.length ) { return; }\n\n\tif ( !( registry = options[ name ] ) ) {\n\t\tregistry = options[ name ] = {};\n\t}\n\n\tkeys\n\t\t.filter( function (key) { return !( key in registry ); } )\n\t\t.forEach( function (key) { return registry[ key ] = target[ name ][ key ]; } );\n}\n\nfunction addOtherOptions ( Child, options ) {\n\tObject.keys( Child.prototype ).forEach( function (key) {\n\t\tif ( key === 'computed' ) { return; }\n\n\t\tvar value = Child.prototype[ key ];\n\n\t\tif ( !( key in options ) ) {\n\t\t\toptions[ key ] = value._method ? value._method : value;\n\t\t}\n\n\t\t// is it a wrapped function?\n\t\telse if ( typeof options[ key ] === 'function'\n\t\t\t\t&& typeof value === 'function'\n\t\t\t\t&& options[ key ]._method ) {\n\n\t\t\tvar needsSuper = value._method;\n\n\t\t\tif ( needsSuper ) { value = value._method; }\n\n\t\t\t// rewrap bound directly to parent fn\n\t\t\tvar result = wrap$2( options[ key ]._method, value );\n\n\t\t\tif ( needsSuper ) { result._method = result; }\n\n\t\t\toptions[ key ] = result;\n\t\t}\n\t});\n}\n\nfunction extend$3 () {\n\tvar options = [], len = arguments.length;\n\twhile ( len-- ) options[ len ] = arguments[ len ];\n\n\tif( !options.length ) {\n\t\treturn extendOne( this );\n\t} else {\n\t\treturn options.reduce( extendOne, this );\n\t}\n}\n\nfunction extendOne ( Parent, options ) {\n\tif ( options === void 0 ) options = {};\n\n\t// if we're extending with another Ractive instance...\n\t//\n\t//   var Human = Ractive.extend(...), Spider = Ractive.extend(...);\n\t//   var Spiderman = Human.extend( Spider );\n\t//\n\t// ...inherit prototype methods and default options as well\n\tif ( options.prototype instanceof Ractive ) {\n\t\toptions = unwrap( options );\n\t}\n\n\tvar Child = function ( options ) {\n\t\tif ( !( this instanceof Child ) ) { return new Child( options ); }\n\n\t\tconstruct( this, options || {} );\n\t\tinitialise( this, options || {}, {} );\n\t};\n\n\tvar proto = create( Parent.prototype );\n\tproto.constructor = Child;\n\n\t// Static properties\n\tdefineProperties( Child, {\n\t\t// alias prototype as defaults\n\t\tdefaults: { value: proto },\n\n\t\t// extendable\n\t\textend: { value: extend$3, writable: true, configurable: true },\n\n\t\t// Parent - for IE8, can't use Object.getPrototypeOf\n\t\t_Parent: { value: Parent }\n\t});\n\n\t// extend configuration\n\tconfig.extend( Parent, proto, options );\n\n\tdataConfigurator.extend( Parent, proto, options );\n\n\tif ( options.computed ) {\n\t\tproto.computed = extend$1( create( Parent.prototype.computed ), options.computed );\n\t}\n\n\tChild.prototype = proto;\n\n\treturn Child;\n}\n\nfunction joinKeys () {\n\tvar keys = [], len = arguments.length;\n\twhile ( len-- ) keys[ len ] = arguments[ len ];\n\n\treturn keys.map( escapeKey ).join( '.' );\n}\n\nfunction splitKeypath$1 ( keypath ) {\n\treturn splitKeypath( keypath ).map( unescapeKey );\n}\n\nvar delimiters = {\n\tstatic:       [ '[[', ']]' ],\n\tstaticTriple: [ '[[[', ']]]' ],\n\tplain:        [ '{{', '}}' ],\n\ttriple:       [ '{{{', '}}}' ]\n};\n\nvar Template = function Template ( fragment, owner ) {\n\tif ( !fragment ) { fragment = []; }\n\tif ( fragment.t ) {\n\t\tthis.expressions = fragment.e;\n\t\tfragment = fragment.t;\n\t}\n\tthis.owner = owner;\n\n\t// start the root with a defensive copy so that any modifications don't affect other instances later\n\tthis.fragment = !owner ? JSON.parse( JSON.stringify( fragment ) ) : fragment;\n};\n\nvar prototypeAccessors = { content: {},elements: {},root: {} };\n\nprototypeAccessors.content.get = function () {\n\t\tvar this$1 = this;\n\n\treturn this.fragment.map( function (i) {\n\t\tif ( typeof i === 'string' ) { return new Text$2( i, this$1 ); }\n\n\t\tswitch ( i.t ) {\n\t\t\tcase ELEMENT:\n\t\t\tcase COMPONENT:\n\t\t\tcase ANCHOR:\n\t\t\t\treturn new Element$2( i, this$1 );\n\t\t\tcase PARTIAL:\n\t\t\tcase INTERPOLATOR:\n\t\t\tcase TRIPLE:\n\t\t\tcase YIELDER:\n\t\t\t\treturn new Inline( i, this$1 );\n\t\t\tcase SECTION:\n\t\t\tcase INVERTED:\n\t\t\tcase ALIAS:\n\t\t\t\treturn new Block( i, this$1 );\n\t\t\tcase ATTRIBUTE:\n\t\t\tcase BINDING_FLAG:\n\t\t\tcase DECORATOR:\n\t\t\tcase EVENT:\n\t\t\tcase TRANSITION:\n\t\t\t\treturn new Attribute$2( i, this$1 );\n\t\t}\n\t});\n};\n\nprototypeAccessors.elements.get = function () { return this.content.filter( function (i) { return i instanceof Element$2; } ); };\n\nprototypeAccessors.root.get = function () {\n\tif ( !this.owner ) { return this; }\n\treturn this.owner.root;\n};\n\n// stringify a template\nTemplate.prototype.toString = function toString ( options ) {\n\t\tif ( options === void 0 ) options = {};\n\n\t// some attributes have an expression as their fragment\n\tif ( this.fragment.s ) {\n\t\tvar list = refToString({ x: this.fragment });\n\t\treturn list.substring( 1, list.length - 1 );\n\t}\n\treturn this.content.map( function (i) { return i.toString( options ); } ).join( '' );\n};\n\n// clone this bit of template as a new base template\nTemplate.prototype.toTemplate = function toTemplate () {\n\treturn { e: this.root.e, t: this.item ? [ this.item ] : this.fragment };\n};\n\nObject.defineProperties( Template.prototype, prototypeAccessors );\n\nvar Text$2 = (function (Template) {\n\tfunction Text () {\n\t\tTemplate.apply(this, arguments);\n\t}\n\n\tif ( Template ) Text.__proto__ = Template;\n\tText.prototype = Object.create( Template && Template.prototype );\n\tText.prototype.constructor = Text;\n\n\tvar prototypeAccessors$1 = { content: {} };\n\n\tprototypeAccessors$1.content.get = function () { return []; };\n\n\tText.prototype.toString = function toString () {\n\t\treturn this.fragment;\n\t};\n\n\tObject.defineProperties( Text.prototype, prototypeAccessors$1 );\n\n\treturn Text;\n}(Template));\n\nvar Element$2 = (function (Template) {\n\tfunction Element ( item, owner ) {\n\t\tTemplate.call( this, item.f, owner );\n\t\tthis.item = item;\n\t}\n\n\tif ( Template ) Element.__proto__ = Template;\n\tElement.prototype = Object.create( Template && Template.prototype );\n\tElement.prototype.constructor = Element;\n\n\tvar prototypeAccessors$2 = { attributes: {},attributeContent: {},events: {},decorators: {},bindingFlags: {},transitions: {},partials: {},attributeFragment: {},isAnchor: {},name: {} };\n\n\tprototypeAccessors$2.attributes.get = function () { return this.attributeFragment.content.filter( function (i) { return i.isAttribute; } ); };\n\tprototypeAccessors$2.attributeContent.get = function () { return this.attributeFragment.content; };\n\tprototypeAccessors$2.events.get = function () { return this.attributeFragment.content.filter( function (i) { return i.isEvent; } ); };\n\tprototypeAccessors$2.decorators.get = function () { return this.attributeFragment.content.filter( function (i) { return i.isDecorator; } ); };\n\tprototypeAccessors$2.bindingFlags.get = function () { return this.attributeFragment.content.filter( function (i) { return i.isBindingFlag; } ); };\n\tprototypeAccessors$2.transitions.get = function () { return this.attributeFragment.content.filter( function (i) { return i.isTransition; } ); };\n\tprototypeAccessors$2.partials.get = function () {\n\t\tvar this$1 = this;\n\n\t\tvar list = [];\n\t\tif ( this.item.p ) {\n\t\t\tfor ( var name in this.item.p ) {\n\t\t\t\tvar fragment = this$1.item.p[name];\n\t\t\t\tvar partial = new Partial$2( name, fragment, this$1 );\n\t\t\t\tlist.push( partial );\n\t\t\t\tlist[ name ] = partial;\n\t\t\t}\n\t\t}\n\t\treturn list;\n\t};\n\n\tprototypeAccessors$2.attributeFragment.get = function () {\n\t\treturn new Template( this.item.m || [], this );\n\t};\n\n\tprototypeAccessors$2.isAnchor.get = function () { return this.item.t === ANCHOR; };\n\n\tprototypeAccessors$2.name.get = function () { return this.item.e; };\n\tprototypeAccessors$2.name.set = function ( name ) { this.item.e = name; };\n\n\tElement.prototype.remove = function remove () {\n\t\tthis.owner.fragment.splice( this.owner.fragment.indexOf( this.item ), 1 )[0];\n\t\treturn this;\n\t};\n\n\tElement.prototype.toString = function toString ( options ) {\n\t\tif ( options === void 0 ) options = {};\n\n\t\treturn (\"<\" + (this.item.e) + (this.attributeFragment.toString(options)) + \">\" + (this.item.p ? this.partials.map(function (p) { return p.toString(options); }).join('') : '') + (Template.prototype.toString.call(this, options)) + \"</\" + (this.item.e) + \">\");\n\t};\n\n\tObject.defineProperties( Element.prototype, prototypeAccessors$2 );\n\n\treturn Element;\n}(Template));\n\nvar Attribute$2 = (function (Template) {\n\tfunction Attribute ( item, owner ) {\n\t\tTemplate.call( this, typeof item.f === 'string' ? [] : item.f, owner );\n\t\tif ( typeof item.f === 'string' ) { this.text = item.f; }\n\t\tthis.item = item;\n\t}\n\n\tif ( Template ) Attribute.__proto__ = Template;\n\tAttribute.prototype = Object.create( Template && Template.prototype );\n\tAttribute.prototype.constructor = Attribute;\n\n\tvar prototypeAccessors$3 = { isAttribute: {},isEvent: {},isDecorator: {},isBindingFlag: {},isTransition: {},name: {} };\n\n\tprototypeAccessors$3.isAttribute.get = function () { return this.item.t === ATTRIBUTE; };\n\tprototypeAccessors$3.isEvent.get = function () { return this.item.t === EVENT; };\n\tprototypeAccessors$3.isDecorator.get = function () { return this.item.t === DECORATOR; };\n\tprototypeAccessors$3.isBindingFlag.get = function () { return this.item.t === BINDING_FLAG; };\n\tprototypeAccessors$3.isTransition.get = function () { return this.item.t === TRANSITION; };\n\n\tprototypeAccessors$3.name.get = function () { return this.item.n; };\n\tprototypeAccessors$3.name.set = function ( name ) { return this.item.n = name; };\n\n\tAttribute.prototype.remove = function remove () {\n\t\tvar owner = this.owner.item ? this.owner.item.m || [] : this.owner.fragment;\n\t\towner.splice( owner.indexOf( this.item ), 1 );\n\t\treturn this;\n\t};\n\n\tAttribute.prototype.toString = function toString ( options ) {\n\t\tvar name = this.isTransition ?\n\t\t\tthis.name + ( this.item.v === 't0' ? '-in-out' : this.item.v === 't1' ? '-in' : '-out' ) :\n\t\t\tthis.isDecorator ? (\"as-\" + (this.name)) :\n\t\t\tthis.isEvent ? (\"on-\" + (this.item.n.map(function (n) { return n.replace( /-/g, '\\\\-' ); }).join( '-' ))) :\n\t\t\tthis.name;\n\t\treturn (\" \" + name + \"=\\\"\" + (this.text ? this.text : '') + (Template.prototype.toString.call(this, options)) + \"\\\"\");\n\t};\n\n\tObject.defineProperties( Attribute.prototype, prototypeAccessors$3 );\n\n\treturn Attribute;\n}(Template));\n\nvar Block = (function (Template) {\n\tfunction Block ( item, owner ) {\n\t\tTemplate.call( this, item.f, owner );\n\t\tthis.item = item;\n\t}\n\n\tif ( Template ) Block.__proto__ = Template;\n\tBlock.prototype = Object.create( Template && Template.prototype );\n\tBlock.prototype.constructor = Block;\n\n\tvar prototypeAccessors$4 = { isAlias: {},isEach: {},isIf: {},isPlain: {},isUnless: {},isWith: {},isStatic: {} };\n\n\tprototypeAccessors$4.isAlias.get = function () { return this.item.t === ALIAS; };\n\tprototypeAccessors$4.isEach.get = function () { return this.item.t === SECTION && this.item.n === SECTION_EACH; };\n\tprototypeAccessors$4.isIf.get = function () { return this.item.t === SECTION && this.item.n === SECTION_IF; };\n\tprototypeAccessors$4.isPlain.get = function () { return this.item.t === SECTION && !this.item.n; };\n\tprototypeAccessors$4.isUnless.get = function () { return this.item.t === INVERTED || ( this.item.t === SECTION && this.item.n === SECTION_UNLESS ); };\n\tprototypeAccessors$4.isWith.get = function () { return this.item.t === SECTION && this.item.n === SECTION_IF_WITH; };\n\n\tprototypeAccessors$4.isStatic.get = function () { return this.item.s; };\n\n\tBlock.prototype.toString = function toString ( options ) {\n\t\tif ( options === void 0 ) options = {};\n\n\t\tvar delims = !this.isStatic ?\n\t\t\toptions.delimiters || delimiters.plain :\n\t\t\toptions.staticDelimiters || delimiters.static;\n\t\tvar tag = this.isIf ? ( this.item.l ? 'elseif' : 'if' ) : this.isAlias || this.isWith ? 'with' : this.isUnless ? ( this.item.l ? 'else' : 'unless' ) : this.isEach ? 'each' : '';\n\n\t\treturn (\"\" + (delims[0]) + (tag !== 'else' && tag !== 'elseif' ? '#' : '') + (tag ? (tag + \" \") : '') + (refToString(this.item)) + (this.item.z && this.item.z.length ? ( this.isAlias ? '' : ' ' ) + aliasesToString(this.item) : '') + (this.item.i ? (\":\" + (this.item.i)) : '') + (delims[1]) + (Template.prototype.toString.call(this, options)) + (delims[0]) + \"/\" + tag + (delims[1]));\n\t};\n\n\tObject.defineProperties( Block.prototype, prototypeAccessors$4 );\n\n\treturn Block;\n}(Template));\n\nvar Inline = (function (Template) {\n\tfunction Inline ( item, owner ) {\n\t\tTemplate.call( this, [], owner );\n\t\tthis.item = item;\n\t}\n\n\tif ( Template ) Inline.__proto__ = Template;\n\tInline.prototype = Object.create( Template && Template.prototype );\n\tInline.prototype.constructor = Inline;\n\n\tvar prototypeAccessors$5 = { isExpression: {},isInterpolator: {},isPartial: {},isReference: {},isStatic: {},isUnescaped: {},isYielder: {} };\n\n\tprototypeAccessors$5.isExpression.get = function () { return this.item.f && this.item.f.x; };\n\tprototypeAccessors$5.isInterpolator.get = function () { return this.item.t === INTERPOLATOR; };\n\tprototypeAccessors$5.isPartial.get = function () { return this.item.t === PARTIAL; };\n\tprototypeAccessors$5.isReference.get = function () { return this.item.f && this.item.f.r; };\n\tprototypeAccessors$5.isStatic.get = function () { return this.item.s; };\n\tprototypeAccessors$5.isUnescaped.get = function () { return this.item.t === TRIPLE; };\n\tprototypeAccessors$5.isYielder.get = function () { return this.item.t === YIELDER; };\n\n\tInline.prototype.toString = function toString ( options ) {\n\t\tif ( options === void 0 ) options = {};\n\n\t\tvar delims = !this.isStatic && !this.isUnescaped ?\n\t\t\t( options.delimiters || delimiters.plain ) :\n\t\t\t!this.isStatic && this.isUnescaped ?\n\t\t\t( options.tripleDelimiters || delimiters.triple ) :\n\t\t\tthis.isStatic && !this.isUnescaped ?\n\t\t\t( options.staticDelimiters || delimiters.static ) :\n\t\t\t( options.staticTripleDelimiters || delimiters.staticTriple );\n\n\t\treturn (\"\" + (delims[0]) + (this.isPartial ? '> ' : this.isYielder ? 'yield ' : '') + (refToString(this.item)) + (this.isPartial && this.item.c ? (\" \" + (refToString(this.item.c))) : '') + (this.item.z ? (\" \" + (this.isYielder ? ' with ' : ' ') + (aliasesToString(this.item))) : '') + (delims[1]));\n\t};\n\n\tObject.defineProperties( Inline.prototype, prototypeAccessors$5 );\n\n\treturn Inline;\n}(Template));\n\nvar Partial$2 = (function (Template) {\n\tfunction Partial ( name, fragment, owner ) {\n\t\tTemplate.call( this, fragment, owner );\n\t\tthis.name = name;\n\t}\n\n\tif ( Template ) Partial.__proto__ = Template;\n\tPartial.prototype = Object.create( Template && Template.prototype );\n\tPartial.prototype.constructor = Partial;\n\n\tPartial.prototype.toString = function toString ( options ) {\n\t\tif ( options === void 0 ) options = {};\n\n\t\tvar delims = options.delimiters || delimiters.plain;\n\t\treturn ((delims[0]) + \"#partial \" + (this.name) + (delims[1]) + (Template.prototype.toString.call(this, options)) + (delims[0]) + \"/partial\" + (delims[1]));\n\t};\n\n\treturn Partial;\n}(Template));\n\nfunction refToString ( item ) {\n\tif ( item.r ) { return item.r; }\n\telse if ( item.rx ) { return (\"\" + (item.r) + (item.m.map(function (r) { return (\"[\" + r + \"]\"); }).join(''))); }\n\telse if ( item.x ) { return item.x.r.reduce( function ( a, c, i ) { return a.replace( (\"_\" + i), c ); }, item.x.s ); }\n\telse { return ''; }\n}\n\nfunction aliasesToString ( item ) {\n\tif ( item.z ) { return item.z.reduce( function ( a, c ) { return (\"\" + a + (a ? ', ' : '') + (refToString(c.x)) + \" as \" + (c.n)); }, '' ); }\n\telse { return ''; }\n}\n\nfunction readTemplate ( template ) {\n\treturn new Template( template );\n}\n\n// Ractive.js makes liberal use of things like Array.prototype.indexOf. In\n// older browsers, these are made available via a shim - here, we do a quick\n// pre-flight check to make sure that either a) we're not in a shit browser,\n// or b) we're using a Ractive-legacy.js build\nvar FUNCTION = 'function';\n\nif (\n\ttypeof Date.now !== FUNCTION                 ||\n\ttypeof String.prototype.trim !== FUNCTION    ||\n\ttypeof Object.keys !== FUNCTION              ||\n\ttypeof Array.prototype.indexOf !== FUNCTION  ||\n\ttypeof Array.prototype.forEach !== FUNCTION  ||\n\ttypeof Array.prototype.map !== FUNCTION      ||\n\ttypeof Array.prototype.filter !== FUNCTION   ||\n\t( win && typeof win.addEventListener !== FUNCTION )\n) {\n\tthrow new Error( 'It looks like you\\'re attempting to use Ractive.js in an older browser. You\\'ll need to use one of the \\'legacy builds\\' in order to continue - see http://docs.ractivejs.org/latest/legacy-builds for more information.' );\n}\n\nfunction Ractive ( options ) {\n\tif ( !( this instanceof Ractive ) ) { return new Ractive( options ); }\n\n\tconstruct( this, options || {} );\n\tinitialise( this, options || {}, {} );\n}\n\n// check to see if we're being asked to force Ractive as a global for some weird environments\nif ( win && !win.Ractive ) {\n\tvar opts = '';\n\tvar script = document.currentScript || document.querySelector( 'script[data-ractive-options]' );\n\n\tif ( script ) {\n\t\topts = script.getAttribute( 'data-ractive-options' ) || '';\n\t}\n\n\tif ( ~opts.indexOf( 'ForceGlobal' ) ) {\n\t\twin.Ractive = Ractive;\n\t}\n}\n\nextend$1( Ractive.prototype, proto, defaults );\nRactive.prototype.constructor = Ractive;\n\n// alias prototype as `defaults`\nRactive.defaults = Ractive.prototype;\n\n// static properties\ndefineProperties( Ractive, {\n\n\t// debug flag\n\tDEBUG:          { writable: true, value: true },\n\tDEBUG_PROMISES: { writable: true, value: true },\n\n\t// static methods:\n\textend:         { value: extend$3 },\n\tescapeKey:      { value: escapeKey },\n\tgetNodeInfo:    { value: staticInfo },\n\tjoinKeys:       { value: joinKeys },\n\tparse:          { value: parse$1$1 },\n\tsplitKeypath:   { value: splitKeypath$1 },\n\tunescapeKey:    { value: unescapeKey },\n\tgetCSS:         { value: getCSS },\n\ttemplate:       { value: readTemplate },\n\n\t// namespaced constructors\n\tPromise:        { value: Promise$1 },\n\n\t// support\n\tenhance:        { writable: true, value: false },\n\tsvg:            { value: svg },\n\tmagic:          { value: magic },\n\n\t// version\n\tVERSION:        { value: '0.9.0-edge-3cba8c713ddf8f6209ab82d2ae6c0192860c6601' },\n\n\t// plugins\n\tadaptors:       { writable: true, value: {} },\n\tcomponents:     { writable: true, value: {} },\n\tdecorators:     { writable: true, value: {} },\n\teasing:         { writable: true, value: easing },\n\tevents:         { writable: true, value: {} },\n\tinterpolators:  { writable: true, value: interpolators },\n\tpartials:       { writable: true, value: {} },\n\ttransitions:    { writable: true, value: {} }\n});\n\nreturn Ractive;\n\n})));\n"],"names":["wasBound","this","bind","context","wasRendered","parentNode","findParentNode","anchor","findNextNode","docFrag","createDocumentFragment","render","insertBefore","Fragment","prototype","resolve","template","callback","parent","resolver","ReferenceResolver","resolvers","push","shuffled","items","forEach","shuffled$1$1","toHtml","toString","escape","map","toEscapedString","toString$2","join","unbind","unbind$1$1","bound","unrender","shouldDestroy","unrenderAndDestroy$1","unrender$1$1","rendered","update","dirty","updating","isRoot","runloop","addFragmentToRoot","update$1$1","valueOf","length","dirtyValue","values","source","processItems","ractive","_guid","parsed","parseJSON","value","HookQueue","event","hook","Hook","inProcess","queue","begin","end","getChildQueue","fire$1","configHook","initHook","renderHook","completeHook","shouldRerender","completeHook$1","resetHook","renderHook$1","unrenderHook","resetPartial","name","partial","collection","collect","fragment","promise","start","partials","forceResetTemplate$1","reverse$1","makeArrayMethod","path","shift$1","sort$1","splice$1","unrenderHook$1","unshift$1","proto","add","Ractive$add","animate","Ractive$animate","attachChild","detach","Ractive$detach","detachChild","find","Ractive$find","findAll","Ractive$findAll","findAllComponents","Ractive$findAllComponents","findComponent","Ractive$findComponent","findContainer","Ractive$findContainer","findParent","Ractive$findParent","fire","Ractive$fire","get","Ractive$get","getNodeInfo","insert","Ractive$insert","link","link$2","merge","thisRactive$merge","observe","observe$1","observeList","observeOnce","observeOnce$1","off","Ractive$off","on","Ractive$on","once","Ractive$once","pop","pop$1","push$1","Ractive$render","reset","Ractive$reset","resetTemplate","Ractive$resetTemplate","reverse","set","Ractive$set","shift","sort","splice","subtract","Ractive$subtract","teardown","Ractive$teardown","toggle","Ractive$toggle","toCSS","Ractive$toCSS","toCss","toHTML","Ractive$toHTML","toText","transition","Ractive$transition","unlink","unlink$2","Ractive$unrender","unshift","Ractive$update","updateModel","Ractive$updateModel","wrap$2","method","superMethod","force","needsSuper","hasSuper","_super","result","apply","arguments","delimiters","static","staticTriple","plain","triple","Template","owner","t","expressions","e","JSON","parse","stringify","prototypeAccessors","content","elements","root","this$1","i","Text$2","ELEMENT","COMPONENT","ANCHOR","Element$2","PARTIAL","INTERPOLATOR","TRIPLE","YIELDER","Inline","SECTION","INVERTED","ALIAS","Block","ATTRIBUTE","BINDING_FLAG","DECORATOR","EVENT","TRANSITION","Attribute$2","filter","options","s","list","refToString","x","substring","toTemplate","item","Object","defineProperties","Text","__proto__","create","constructor","prototypeAccessors$1","Element","call","f","prototypeAccessors$2","attributes","attributeContent","events","decorators","bindingFlags","transitions","attributeFragment","isAnchor","isAttribute","isEvent","isDecorator","isBindingFlag","isTransition","p","Partial$2","m","remove","indexOf","Attribute","text","prototypeAccessors$3","n","v","replace","prototypeAccessors$4","isAlias","isEach","isIf","isPlain","isUnless","isWith","isStatic","SECTION_EACH","SECTION_IF","SECTION_UNLESS","SECTION_IF_WITH","delims","staticDelimiters","tag","l","z","aliasesToString","prototypeAccessors$5","isExpression","isInterpolator","isPartial","isReference","isUnescaped","isYielder","r","tripleDelimiters","staticTripleDelimiters","c","Partial","FUNCTION","Date","now","String","trim","keys","Array","win","addEventListener","Error","Ractive","opts","script","document","currentScript","querySelector","getAttribute","extend$1","defaults","DEBUG","writable","DEBUG_PROMISES","extend","extend$3","escapeKey","staticInfo","joinKeys","parse$1$1","splitKeypath","splitKeypath$1","unescapeKey","getCSS","readTemplate","Promise","Promise$1","enhance","svg","magic","VERSION","adaptors","components","easing","interpolators","Parser","Parent","Child","str","key","hasOwn","stringMiddlePattern","escapeSequencePattern","lineContinuationPattern","makeQuotedStringMatcher","okQuote","parser","next","literal","done","matchPattern","matchString","charCodeAt","slice","getSingleQuotedString","getDoubleQuotedString","readStringLiteral","pos","string","STRING_LITERAL","string$1","numberPattern$1","identifier","specials$1","true","false","null","undefined","specialsPattern","RegExp","numberPattern","placeholderPattern","placeholderAtStartPattern","onlyWhitespace","JsonParser","init","allowWhitespace","postProcess","test","leftover","converters","placeholder","hasOwnProperty","special","number","stringLiteral","match","$1","pair","getKeyValuePair","valueToken","read","Mapping","Item$$1","parentFragment","element","findElement","attributeByName","viewmodel","instance","joinKey","isArray","createMapping","boundFragment","target","model","updateDelegate","Item","Option","Element$$1","a","select","selectedAttribute","selected","index","bubble","node","_ractive","attribute","getValue","isSelected","optionValue","selectValue","occupants","removeFromArray","MustacheContainer$$1","yielder","container","component","containerFragment","rx","refName","templateObj","getPartialTemplate","named","setTemplate","parsePartial","partialTemplate","SECTION_WITH","k","aliases","resolveAliases","forceResetTemplate","warnOnceIfDebug","inAttribute","doInAttributes","rebinding","locked","scheduleTask","MustacheContainer","RepeatedFragment","cssIds","iterations","indexRef","keyRef","pendingNewIndices","previousIterations","max","createIteration","isObject","refs","split","isIteration","destroyed","destroyed$1$1","appendChild","selector","findMap","query","iteration","firstNode","skipParent","shuffle","newIndices","newIndex","oldIndex","unrenderAndDestroy","updatePostShuffle","toRemove","oldKeys","wasArray","fragment$1","newLength","indices","len","oldLen","removed","frag","contiguous","startIndex","childNodes","prefix","Section","sectionType","templateSectionType","subordinate","sibling","nextSibling","isTruthy","isEmpty","previous","safe","siblingFalsey","lastType","getType","newFragment","fragmentShouldExist","Select","foundNode","binding","selectedOptions","getSelectedOptions","sync","defaultSelected","selectNode","toArray","o","setFromNode","isMultiple","optionWasSelected","shouldSelect","valueContains","forceUpdate","Textarea","Input$$1","deferContent","isBindable","createItem","Input","type","TEXT","detachNode","inAttributes","nodeType","nodeValue","doc","createTextNode","escapeHtml","isClient","prefixCache","testStyle","createElement","style","prop","camelCase","capped","charAt","toUpperCase","vendors","vendor","visible","prefix$1","hidden","prefix$2","i$1","onChange","onHide","onShow","createTransitions","unprefixPattern","unprefix","vendorPattern","hyphenate","toLowerCase","TRANSITION$1","TRANSITIONEND","CSS_TRANSITIONS_ENABLED","TRANSITION_DURATION","TRANSITION_PROPERTY","TRANSITION_TIMING_FUNCTION","testStyle$1","linear$2","canUseCssTransitions","cannotUseCssTransitions","webkitTransition","to","changedProperties","setTimeout","transitionDone","clearTimeout","cssTimeout","checkComplete","jsTransitionsComplete","cssTransitionsComplete","unregisterCompleteHandler","isIntro","transitionEndHandler","propertyName","cssTransitionsDone","property","duration","timing","removeEventListener","hashPrefix","namespaceURI","tagName","delay","registerCompleteHandler","hash","originalValue","suffix","interpolator","propertiesToTransitionInJs","getStyle","warnIfDebug","exec","interpolate","parseFloat","missingPlugin","Ticker","step","complete","createTransitions$1","getComputedStyle","legacy","resolved$1","names","t0","t1","t2","Transition","onComplete","animateStyle","setStyle","fulfil","propertyNames","computedStyle","current","_introTransition","_outroTransition","eventName","params","_fn","findInViewHierarchy","setupArgsFn","props","styles","value$1","processParams","idx","models","rebindMatch","unregister","addShuffleRegister","fn","addToArray","completed","originalStyle","args","noReset","resetStyle","_manager","shouldUnbind","teardownArgsFn","concat","then","ieBug","ieBlacklist","elementCache","innerHTML","err","TABLE","THEAD","TBODY","TR","SELECT","insertHtml","html$$1","nodes","wrapper","selectedOption","selectedIndex","svg$1","textContent","child","firstChild","Triple","Mustache$$1","matches","queryResult","queryAllResult","querySelectorAll","numNodes","j","html","decodeCharacterReferences","Mustache","constructors","Alias","Component","DOCTYPE","Doctype","Interpolator","BindingFlag","Decorator","EventDirective","specialElements","doctype","form","Form","input","option","textarea","reference","normalise","resolved","contexts","addUnresolved","componentParent","attemptResolution","resolveReference","forceResolution","findContext","joinAll","removeUnresolved","unresolved","createItems","bind$1$1","addFragment","el","findRepeatingFragment","ComponentConstructor","_partials","addChild","addChild$1","removeChild","removeChild$1","liveQueries","construct","_inlinePartials","leftovers","ConditionalAttribute","eventHandlers","initialise","live","_query","removeFromQuery","checking","checkAnchors","render$2","render$1$1","updateLiveQueries$1","makeDirty$1","teardown$2","unrenderItem","missingDecorator","noop","intermediary","handleChange","warnOnce","Binding","twowayBinding","isUnresolved","warnAboutAmbiguity","isReadonly","keypath","getKeypath","isTwoway","wasUndefined","getInitialValue","lastVal","parentForm","resetValue","formBindings","registerTwowayBinding","setting","lastValue","unregisterTwowayBinding","CheckboxBinding","Binding$$1","handleDomEvent","attachEvent","checked","BindingGroup","bindings","push$2","CheckboxNameBinding","checkboxName","group","getBindingGroup","getValue$1$1","noInitialValue","existingValue","bindingValue","arrayContains","changed","wasChecked","isChecked","valueSoFar","ContentEditableBinding","lazy","GenericBinding","timeout","isNumeric","handler","handleDelay","handleBlur","FileBinding","GenericBinding$$1","files","MultipleSelectBinding","selectedValues","previousValue","arrayContentsMatch","setValue","initialValue","NumericBinding","isNaN","siblings","RadioBinding","getSiblings","RadioNameBinding","getValue$2","nameAttributeBinding","getKeypathModel","register","SingleSelectBinding","disabled","endsWithSemi","ContainerItem$$1","isVoid","voidElementNames","sortAttributes","recreateTwowayBinding","createTwowayBinding","twoway","selectBinding","matches$$1","namespace","getNamespace","existing","nodeName","defineProperty","proxy","setAttribute","children","removeAttribute","updateLiveQueries","transitionsEnabled","registerTransition","makeDirty$2","attrs","stringifyAttribute","inputIsCheckedRadio","cls","attr","safeAttributeString","getString","styleName","decamelize","inlineClass","detachWhenReady","ContainerItem","toFront","handleReset","DOMEvent","fatal","listen","directive","original","unlisten","CustomEvent","eventPlugin","RactiveEvent","cancel","specialPattern","dollarArgsPattern","specialRef","ref","specialMatch","substr","dollarMatch","action","passedArgs","addHelpers","obj","wrapperValue","oldEvent","preventDefault","stopPropagation","fireEvent","addShuffleTask","resolve$3","proto$1","mustache","safeToStringValue","data","defaultValue","leadingWhitespace","ParseError","message","stack","lineStart","lines","lineEnds","line","lineEnd","remaining","getContextMessage","getLinePos","lineNum","columnNum","contextLines","contextUp","contextDown","numTabs","annotation","char","error","msg","character","shortMessage","pattern","nextChar","styleElement","getElementsByTagName","useCssText","styleSheet","adaptConfigurator","adapt","combine","ensureArray","selectorsPattern","commentsPattern","selectorUnitPattern","excludePattern","dataRvcGuidPattern","cssConfigurator","css","id","uuid","noCssTransform","transformCss","cssId","addCSS","dataConfigurator","combine$1","bind$2","_r_unbound","TEMPLATE_VERSION","functions","parseOptions","TEMPLATE_INSTRUCTIONS","COMPUTATION_INSTRUCTIONS","fromId","noThrow","getElementById","isParsed","getParseOptions","reduce","val","throwNoParse","addFunctions","parseFor","templateConfigurator","parseTemplate","getDynamicTemplate","_config","extendPartials","registryNames","Registry","useDefaults","configure","registry","isOwner","registries","custom","defaultKeys","isStandardKey","makeObj","isBlacklisted","order","config","configure$1","NUMBER_LITERAL","REFERENCE","ComputationChild","Model$$1","syncComputedChildren","applyValue","dependencies","mark$1$1","shouldCapture","capture","parentValue","boundValue","links","marked","deps","handleChange$1$1","clearUnresolveds","childByKey","Model","Computation","signature","setter","computationContext","newWrapperValue","maybeBind","startCapturing","getter","hasConsole","console","groupCollapsed","functionBody","prettify","getterString","getterUseStack","truncateStack","groupEnd","stopCapturing","setDependencies","registerChange","mark","model$1","computations","prototype$1","ExpressionProxy","getFunction","createResolver","actuallyChanged","d","retrieve","dep","computation","ReferenceExpressionChild","isEqual","base","ReferenceExpressionProxy","baseResolver","members","keypathModel","oneway","findBoundValue","hyphenatedStr","space","specials","float","remove$1","textTypes","accept-charset","accesskey","bgcolor","class","codebase","colspan","contenteditable","datetime","dirname","for","http-equiv","ismap","maxlength","novalidate","pubdate","readonly","rowspan","tabindex","usemap","booleanAttributes","htmlEntities","quot","amp","apos","lt","gt","nbsp","iexcl","cent","pound","curren","yen","brvbar","sect","uml","copy","ordf","laquo","not","shy","reg","macr","deg","plusmn","sup2","sup3","acute","micro","para","middot","cedil","sup1","ordm","raquo","frac14","frac12","frac34","iquest","Agrave","Aacute","Acirc","Atilde","Auml","Aring","AElig","Ccedil","Egrave","Eacute","Ecirc","Euml","Igrave","Iacute","Icirc","Iuml","ETH","Ntilde","Ograve","Oacute","Ocirc","Otilde","Ouml","times","Oslash","Ugrave","Uacute","Ucirc","Uuml","Yacute","THORN","szlig","agrave","aacute","acirc","atilde","auml","aring","aelig","ccedil","egrave","eacute","ecirc","euml","igrave","iacute","icirc","iuml","eth","ntilde","ograve","oacute","ocirc","otilde","ouml","divide","oslash","ugrave","uacute","ucirc","uuml","yacute","thorn","yuml","OElig","oelig","Scaron","scaron","Yuml","fnof","circ","tilde","Alpha","Beta","Gamma","Delta","Epsilon","Zeta","Eta","Theta","Iota","Kappa","Lambda","Mu","Nu","Xi","Omicron","Pi","Rho","Sigma","Tau","Upsilon","Phi","Chi","Psi","Omega","alpha","beta","gamma","delta","epsilon","zeta","eta","theta","iota","kappa","lambda","mu","nu","xi","omicron","pi","rho","sigmaf","sigma","tau","upsilon","phi","chi","psi","omega","thetasym","upsih","piv","ensp","emsp","thinsp","zwnj","zwj","lrm","rlm","ndash","mdash","lsquo","rsquo","sbquo","ldquo","rdquo","bdquo","dagger","Dagger","bull","hellip","permil","prime","Prime","lsaquo","rsaquo","oline","frasl","euro","image","weierp","real","trade","alefsym","larr","uarr","rarr","darr","harr","crarr","lArr","uArr","rArr","dArr","hArr","forall","part","exist","empty","nabla","isin","notin","ni","prod","sum","minus","lowast","radic","infin","ang","and","or","cap","cup","int","there4","sim","cong","asymp","ne","equiv","le","ge","sub","sup","nsub","sube","supe","oplus","otimes","perp","sdot","lceil","rceil","lfloor","rfloor","lang","rang","loz","spades","clubs","hearts","diams","controlCharacters","entityPattern","codePointSupport","fromCodePoint","codeToChar","fromCharCode","lessThan","greaterThan","invalid","namespaces","useProperty","isBoolean","lookupNamespace","getUpdateDelegate","camelize","flag","set$3","div$1","isSvg","parseAttributes","notIn","processWrapper","array","methodName","__model","mutatorMethods","patchedArrayProto","getNewIndices","wrappers","configurable","patchArrayMethods","unpatchArrayMethods","unpatch","patch","errorMessage$1","arrayAdaptor","object","wrap","ArrayWrapper","instances","storage","magicAdaptor","MagicWrapper","magicAdaptor$1","originalDescriptors","originalDescriptor","getOwnPropertyDescriptor","childKeypath","descriptor","createOrWrapDescriptor","__magic","revert","dependants","MagicArrayWrapper","magicWrapper","arrayWrapper","magicArrayAdaptor","RactiveModel","changes","isLink","initLink","hasProp$1","RootModel","applyChanges","_changeHash","flush","attached","attachImplicits","compute","createLink","targetPath","detached","detachImplicits","virtual","getVirtual","getRactiveModel","ractiveModel","getValueChildren","_link","has","Function","GlobalModel","SharedModel$1","localKey","origin","local","shouldTeardown","constructHook","registryNames$1","uid","teardownHook","destructHook","exportedShims","getPixelSize","fontSize","sizeWithSuffix","size","getBorderPixelSize","parentElement","currentStyle","rootSize","clientWidth","clientHeight","div","bcr","borderSizes","display","position","width","height","borderRight","getBoundingClientRect","right","left","setShortStyleProperty","borderSuffix","b","CSSStyleDeclaration","normalProps","fontWeight","lineHeight","letterSpacing","getPropertyPriority","getPropertyValue","removeProperty","setProperty","getPropertyCSSValue","methodNames","unprefixed","prefixed","makeFunction","mathml","xlink","xml","xmlns","ns","createElementNS","cloneNode","camel","decamel","desc","F","log","printWarning","welcome","toString$1$1","alreadyWarned","welcomeIntro","welcomeMessage","WELCOME_MESSAGE","hasGroup","warn","badArguments","noRegistryFunctionReturn","from","intermediate","Math","min","properties","snap","prop$1","refPattern","splitPattern","escapeKeyPattern","unescapeKeyPattern","starMaps","wildcardCache","arg","_Promise","PENDING","FULFILLED","REJECTED","dispatchHandlers","fulfilledHandlers","rejectedHandlers","state","makeResolver","newState","makeDispatcher","wait","reject","onFulfilled","onRejected","promise2","processResolutionHandler","handlers","forward","p1result","resolve$1","all","promises","pending","processPromise","reason","TransitionManager","intros","outros","totalChildren","outroChildren","detachQueue","outrosComplete","decrementOutros","check","decrementTotal","detachNodes","detach$1","_detachNodes","ready","detachImmediate","batch","changeHook","fulfilPromise","previousBatch","transitionManager","fragments","tasks","immediateObservers","deferredObservers","ractives","flushChanges","addInstance","addObserver","observer","defer","thing","task","postRender","_batch","star","errorMessage","noAnimation","linear$1","linear","attachHook","detachHook","detachHook$1","Query","isComponentQuery","makeDirty","cancelled","sortByItemPosition","sortByDocumentPosition","captureGroup","KeyModel","isKey","dependant","registerLink","unregisterLink","KeypathModel","isKeypath","getChild","rebindChildren","hasProp","shuffleTasks","early","registerQueue","ModelBase","keyModels","unresolvedByKey","patternObservers","stage","specificKey","hasKey","findMatches","existingMatches","loop","getKeyModel","skip","child$1","lastLink","notifyUpstream","notify","notifiedUpstream","relinking","registerPatternObserver","rewrap","unregisterPatternObserver","updateFromBindings","cascade","Missing","shufle","LinkModel","ModelBase$$1","sourcePath","attach","unwrap","bind$$1","shouldBind","isDetached","markedAll","relinked","shuffling","shuffle$1$1","teardown$1$1","lnk","implicit","fireShuffleTasks","ln","requestAnimationFrame","vendors$$1","lastTime","win$$1","currTime","timeToCall","rAF","getTime","performance","tickers","running","tick","elapsed","eased","stop","abort","prefixers","ticker","createBranch","adaptor","getPrefixer","isObjectLike","branch","old","comparator","oldArray","newArray","recreateArray","oldLength","usedIndices","firstUnusedIndex","SharedModel","global","window","keypathExpr","arrayProto","mdl","result$1","promise$1","comparators","updateHook","modelPush","modelPop","modelShift","modelUnshift","modelSort","modelSplice","modelReverse","insertHook","Observer","dispatch","oldValue","newValue","strict","PatternObserver","baseModel","baseKeypath","oldValues","newValues","newKeys","wildcards","touchedFrom","count","ok","ListObserver","sliced","negativeOne","inserted","deleted","hadIndex","onceOptions","notEmptyString","PREFIX","styleDefinitions","isDirty","validate$1","existingPartials","newPartials","overwrite","wrap$1","getSuperMethod","_parent","oldSuper","_method","getMessage","deprecated","correct","isError","deprecateOption","deprecatedOption","deprecate","append","extendOtherMethods","member","fnBody","tabs","minIndent","prev","Infinity","truncated","orComponent","readStyle","rule","rules","readClass","updateId","updateMultipleSelectValue","updateSelectValue","updateStringValue","updateContentEditableValue","updateRadioValue","updateValue","updateRadioName","updateCheckboxName","updateStyleAttribute","updateInlineStyle","updateClassName","updateInlineClass","type$1","updateBoolean","updateNamespacedAttribute","updateAttribute","wasSelected","valueAttribute","className","removeAttributeNS","setAttributeNS","entity","code","parseInt","validateCode","qualified","hasAttribute","haystack","needle","enumerable","mdl$1","getComputationSignature","setterString","createFunctionFromString","initialiseProperties","getAdaptors","computed","combine$2","arrays","res","protoAdapt","lookup","builtins","srcs","isolated","magic$$1","modifyArrays","_subs","_eventQueue","_liveQueries","_liveComponentQueries","_observers","_children","byName","torndown","getPromise","cancel$1","__ractive_instances__","meta","nameOption","renderItem","nextNode","contains","lastBound","q","updateAnchors","description","bindName","bindChecked","nameAttr","xmlns$$1","updateModel$2","readNumberLiteral","readKey","token","childData","getPartialFromRegistry","fillGaps","findParentPartial","findInstance","findOwner","findConstructor","_Parent","hasIndexRef","getComponentConstructor","ElementConstructor","guid","counter","placeholderId","newModel","hookQueue","childQueue","userOptions","createFragment","getElement","catch","logIfDebug","noIntro","applyCSS","others","rerender","dest","external","set$1","build","add$1","TypeError","gather","uniqueCssIds","ids","HTMLElement","here","addRegistries","addOtherOptions","addRegistry","extendOne","csp","preserveWhitespace","sanitize","stripComments","resolveInstanceMembers","easeIn","pow","easeOut","easeInOut","navigator","appName","implementation","hasFeature","Temp","freeze","hasDontEnumBug","propertyIsEnumerable","dontEnums","dontEnumsLength","mapper","isActuallyString","mapped","opt_initialValue","valueIsSet","filtered","every","iterator","Empty","ctx","doc$$1","appearsToBeIELessEqual8","Event","currentTarget","srcElement","timeStamp","returnValue","cancelBubble","listener","listeners","detachEvent","origCreateElement","head","factory","exports","module","define","amd","noConflict","output","sources","isFinite","format","registryName","interpol","enqueue","dequeue","getPotentialWildcardMatches","starMap","wildcardKeypath","getStarMap","num","binary","ones","digit","_noArg","eventNames","getWildcardNames","fireEventAs","initialFire","subscribers","notifySubscribers","fullName","originalEvent","stopEvent","lastItem","arrayLike","find$1","called","resolvePromise","y","rejectPromise","tm","notifiedTotal","manager","trans","collectAllOutros","dispatch$1","which","ractive$1","pairs","sets","getOptions","easing$$1","animate$1","queries","remotes","remote","query$1","findAnchors","findAnchorsIn","anchors","idxs","unrenderChild","bubble$1","findNextNode$1","removeFromQuery$1","prepend","insertAt","@this.parent","@this.root","cmp","isParent","otherNode","compareDocumentPosition","bitmask","baseA","baseB","mutualAncestor","ancestryA","getAncestry","ancestryB","oldestA","oldestB","fragmentA","fragmentB","indexA","indexB","indexA$1","indexB$1","getParent","ancestry","ancestor","upstream","parts","prefixKeypath","rootKeypath","rootDot","relativeKeypath","initialFragment","explicitContext","context$1","badReference","repeater","context$2","hasContextChain","crossedComponentBoundary","shouldWarn","model$2","spliceArguments","getSpliceEquivalent","balance","removeStart","removeEnd","getComparator","merge$2","compare","update$3","build$1","findModel","get$1$1","_element","resolve$2","add$2","animate$2","link$1","there","merge$1","raise","event$1","set$2","drop","unlink$1","update$2","updateModel$1","isBound","getBindingModel","getBindingPath","getBinding","setBinding","fireInsertHook","observers","keypaths","createObserver","wildcardIndex","styleDefinition","cssText","filteredStyleDefinitions","trim$1","extractString","unit","transformSelector","selectorUnits","modifiers","transformed","appended","prepended","dataAttr","selectors","s4","floor","random","validate","childValue","parentIsFn","childIsFn","callDataFunction","fromProperties","primary","secondary","fromExpression","body","fromComputationString","bindTo","hasThis","createFunction","exp","instructions","initial","parseAsString"],"mappings":"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AKC,MAAO,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,KAAM,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,KAAM,IAAKC,IAAK,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,KAAM,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,KAAM,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,KAAM,IAAKC,MAAO,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,KAAM,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,KAAM,IAAKC,IAAK,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,KAAM,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,KAAM,IAAKC,OAAQ,IAAKC,MAAO,IAAKC,KAAM,IAAKC,MAAO,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,OAAQ,IAAKC,KAAM,IAAKC,KAAM,IAAKC,KAAM,IAAKC,MAAO,IAAKC,MAAO,IAAKC,KAAM,IAAKC,MAAO,IAAKC,MAAO,IAAKC,QAAS,IAAKC,KAAM,IAAKC,IAAK,IAAKC,MAAO,IAAKC,KAAM,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,GAAI,IAAKC,GAAI,IAAKC,GAAI,IAAKC,QAAS,IAAKC,GAAI,IAAKC,IAAK,IAAKC,MAAO,IAAKC,IAAK,IAAKC,QAAS,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,MAAO,IAAKC,MAAO,IAAKC,KAAM,IAAKC,MAAO,IAAKC,MAAO,IAAKC,QAAS,IAAKC,KAAM,IAAKC,IAAK,IAAKC,MAAO,IAAKC,KAAM,IAAKC,MAAO,IAAKC,OAAQ,IAAKC,GAAI,IAAKC,GAAI,IAAKC,GAAI,IAAKC,QAAS,IAAKC,GAAI,IAAKC,IAAK,IAAKC,OAAQ,IAAKC,MAAO,IAA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"}