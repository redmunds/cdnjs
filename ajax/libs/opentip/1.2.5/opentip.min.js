var Opentip={Version:"1.2.5",REQUIRED_PROTOTYPE_VERSION:"1.6.0",REQUIRED_SCRIPTACULOUS_VERSION:"1.8.0",cached:{},debugging:!1,load:function(){function t(t){var e=t.split(".");return 1e5*parseInt(e[0])+1e3*parseInt(e[1])+parseInt(e[2])}if("undefined"==typeof Prototype||"undefined"==typeof Element||"undefined"==typeof Element.Methods||t(Prototype.Version)<t(Opentip.REQUIRED_PROTOTYPE_VERSION))throw"Opentip requires the Prototype JavaScript framework >= "+Opentip.REQUIRED_PROTOTYPE_VERSION;if("undefined"==typeof Scriptaculous||"undefined"==typeof Effect||t(Scriptaculous.Version)<t(Opentip.REQUIRED_SCRIPTACULOUS_VERSION))throw"Opentip requires the Scriptaculous JavaScript framework >= "+Opentip.REQUIRED_SCRIPTACULOUS_VERSION},debug:function(){this.debugging&&"undefined"!=typeof console&&"undefined"!=typeof console.debug&&console.debug.apply(console,arguments)},IEVersion:function(){if("undefined"!=typeof Opentip.cached.IEVersion)return Opentip.cached.IEVersion;if(Prototype.Browser.IE)var t=navigator.userAgent.match("MSIE ([\\d.]+)"),e=t?parseFloat(t[1]):!1;else e=!1;return Opentip.cached.IEVersion=e,e},objectIsEvent:function(t){return"object"==typeof t&&t.type&&t.screenX},useIFrame:function(){return Opentip.IEVersion()?Opentip.IEVersion()<=6:!1},lastTipId:1,lastZIndex:100,documentIsLoaded:!1,postponeCreation:function(t){Opentip.documentIsLoaded||!Opentip.IEVersion?t():Event.observe(window,"load",t)}};Opentip.load(),Event.observe(window,Opentip.IEVersion?"load":"dom:loaded",function(){Opentip.documentIsLoaded=!0}),Opentip.styles={standard:{className:"standard",stem:!1,delay:null,hideDelay:.1,fixed:!1,showOn:"mouseover",hideTrigger:"trigger",hideOn:null,offset:[0,0],containInViewport:!0,autoOffset:!0,showEffect:"appear",hideEffect:"fade",showEffectDuration:.3,hideEffectDuration:.2,stemSize:8,tipJoint:["left","top"],target:null,targetJoint:null,ajax:!1,group:null},slick:{className:"slick",stem:!0},rounded:{className:"rounded",stem:!0},glass:{className:"glass"}},Opentip.defaultStyle="standard";var Tips={list:[],append:function(t){this.list.push(t)},remove:function(t){if(t.element)var e=this.list.find(function(e){return e===t});else var e=this.list.find(function(e){return e.triggerElement===t});e&&(e.deactivate(),e.destroyAllElements(),this.list=this.list.without(e))},add:function(t,e){if(t._opentipAddedTips){var i=this.list.find(function(e){return e.triggerElement===t});return"creation"==i.options.showOn&&i.show(),void Opentip.debug("Using an existing opentip")}setTimeout(function(){t._opentipAddedTips=!0},1),Opentip.debug("Creating new opentip");var s=[];$A(arguments).each(function(t,e){1!=e||Opentip.objectIsEvent(t)||s.push(null),s.push(t)});var o=this,n=function(){o.append(new TipClass(s[0],s[1],s[2],s[3],s[4]))};Opentip.postponeCreation(n)},hideGroup:function(t){this.list.findAll(function(e){return e.options.group==t}).invoke("doHide")}},Tip=function(){Tips.add.apply(Tips,arguments)};Element.addMethods({addTip:function(t){return t=$(t),Tips.add.apply(Tips,arguments),t}});var TipClass=Class.create({initialize:function(t,e){this.id=Opentip.lastTipId++,t=$(t),this.triggerElement=t,this.loaded=!1,this.loading=!1,this.visible=!1,this.waitingToShow=!1,this.waitingToHide=!1,this.lastPosition={left:0,top:0},this.dimensions=[100,50];var i={};this.content="","object"==typeof arguments[2]?(this.content="",i=arguments[2]):"object"==typeof arguments[3]?(this.content=arguments[2],i=arguments[3]):"object"==typeof arguments[4]?(this.content=arguments[2],i=arguments[4],i.title=arguments[3]):((Object.isString(arguments[2])||Object.isFunction(arguments[2]))&&(this.content=arguments[2]),Object.isString(arguments[3])&&(i.title=arguments[3])),!i.showOn&&e&&(i.showOn=e.type),i.ajax&&!i.ajax.url&&("a"==this.triggerElement.tagName.toLowerCase()?("object"!=typeof i.ajax&&(i.ajax={}),i.ajax.url=this.triggerElement.href):i.ajax=!1),"click"==i.showOn&&"a"==this.triggerElement.tagName.toLowerCase()&&(e&&e.stop(),this.triggerElement.observe("click",function(t){t.stop()})),i.style||(i.style=Opentip.defaultStyle);var s=Object.extend({},Opentip.styles.standard);if("standard"!=i.style&&Object.extend(s,Opentip.styles[i.style]),i=Object.extend(s,i),i.target&&(i.fixed=!0),i.stem===!0&&(i.stem=i.tipJoint),i.target===!0?i.target=this.triggerElement:i.target&&(i.target=$(i.target)),this.currentStemPosition=i.stem,null===i.delay&&("mouseover"==i.showOn?i.delay=.2:i.delay=0),null==i.targetJoint&&(i.targetJoint=[],i.targetJoint[0]="left"==i.tipJoint[0]?"right":"right"==i.tipJoint[0]?"left":"center",i.targetJoint[1]="top"==i.tipJoint[1]?"bottom":"bottom"==i.tipJoint[1]?"top":"middle"),this.options=i,this.buildContainer(),this.options.showTriggerElementsWhenHidden=[],this.options.showOn&&"creation"!=this.options.showOn&&this.options.showTriggerElementsWhenHidden.push({element:this.triggerElement,event:this.options.showOn}),this.options.showTriggerElementsWhenVisible=[],this.options.hideTriggerElements=[],this.options.hideTrigger){var o=null,n=null;switch(this.options.hideTrigger){case"trigger":o=this.options.hideOn?this.options.hideOn:"mouseout",n=this.triggerElement;break;case"tip":o=this.options.hideOn?this.options.hideOn:"mouseover",n=this.container;break;case"target":o=this.options.hideOn?this.options.hideOn:"mouseover",n=this.options.target;break;case"closeButton":break;default:o=this.options.hideOn?this.options.hideOn:"mouseover",n=$(this.options.hideTrigger)}n&&(this.options.hideTriggerElements.push({element:n,event:o}),"mouseout"==o&&this.options.showTriggerElementsWhenVisible.push({element:n,event:"mouseover"}))}this.activate(),(e||"creation"==this.options.showOn)&&this.show(e)},activate:function(){this.bound={},this.bound.doShow=this.doShow.bindAsEventListener(this),this.bound.show=this.show.bindAsEventListener(this),this.bound.doHide=this.doHide.bindAsEventListener(this),this.bound.hide=this.hide.bindAsEventListener(this),this.bound.position=this.position.bindAsEventListener(this),(this.options.showEffect||this.options.hideEffect)&&(this.queue={limit:1,position:"end",scope:this.container.identify()}),this.setupObserversForReallyHiddenTip(),this.setupObserversForHiddenTip()},deactivate:function(){this.doHide(),this.setupObserversForReallyHiddenTip()},buildContainer:function(){this.container=$(Builder.node("div",{className:"opentipContainer style-"+this.options.className+(this.options.ajax?" loading":"")})).setStyle({display:"none",position:"absolute"})},buildElements:function(){if(this.options.stem){"-"+this.options.stemSize+"px";this.container.appendChild(Builder.node("div",{className:"stemContainer "+this.options.stem[0]+" "+this.options.stem[1]},Builder.node("div",{className:"stem"},Builder.node("div",""))))}var t=[],e=[];this.options.title&&e.push(Builder.node("div",{className:"title"},this.options.title)),t.push(Builder.node("div",{className:"header"},e)),t.push($(Builder.node("div",{className:"content"})).update(this.content)),this.options.ajax&&t.push($(Builder.node("div",{className:"loadingIndication"},Builder.node("span","Loading...")))),this.tooltipElement=$(Builder.node("div",{className:"opentip"},t)),this.container.appendChild(this.tooltipElement);var i=this.container.appendChild(Builder.node("div",{className:"opentipButtons"}));"closeButton"==this.options.hideTrigger&&i.appendChild(Builder.node("a",{href:"javascript:undefined",className:"close"},Builder.node("span","x"))),Opentip.useIFrame()&&(this.iFrameElement=this.container.appendChild($(Builder.node("iframe",{className:"opentipIFrame",src:"javascript:false;"})).setStyle({display:"none",zIndex:100}).setOpacity(0))),document.body.appendChild(this.container),this.storeAndFixDimensions()},storeAndFixDimensions:function(){this.container.setStyle({width:"auto",left:"0px",top:"0px"}),this.dimensions=this.container.getDimensions(),this.container.setStyle({width:this.dimensions.width+"px",left:this.lastPosition.left+"px",top:this.lastPosition.top+"px"})},destroyAllElements:function(){this.container&&this.container.remove()},clearShowTimeout:function(){window.clearTimeout(this.timeoutId)},clearHideTimeout:function(){window.clearTimeout(this.hideTimeoutId)},clearTimeouts:function(){this.clearShowTimeout(),this.clearHideTimeout()},setupObserversForReallyVisibleTip:function(){this.options.showTriggerElementsWhenVisible.each(function(t){$(t.element).observe(t.event,this.bound.show)},this)},setupObserversForVisibleTip:function(){this.options.hideTriggerElements.each(function(t){$(t.element).observe(t.event,this.bound.hide)},this),this.options.showTriggerElementsWhenHidden.each(function(t){$(t.element).stopObserving(t.event,this.bound.show)},this),Event.observe(document.onresize?document:window,"resize",this.bound.position),Event.observe(window,"scroll",this.bound.position)},setupObserversForReallyHiddenTip:function(){this.options.showTriggerElementsWhenVisible.each(function(t){$(t.element).stopObserving(t.event,this.bound.show)},this)},setupObserversForHiddenTip:function(){this.options.showTriggerElementsWhenHidden.each(function(t){$(t.element).observe(t.event,this.bound.show)},this),this.options.hideTriggerElements.each(function(t){$(t.element).stopObserving(t.event,this.bound.hide)},this),Event.stopObserving(document.onresize?document:window,"resize",this.bound.position),Event.stopObserving(window,"scroll",this.bound.position)},show:function(t){this.waitingToHide&&(this.clearTimeouts(),this.waitingToHide=!1,this.setupObserversForVisibleTip()),this.visible||(Opentip.debug("Show",this.id),this.waitingToShow=!0,this.setupObserversForVisibleTip(),this.followMousePosition(),this.position(t),this.options.delay?this.timeoutId=this.bound.doShow.delay(this.options.delay):this.bound.doShow(t))},doShow:function(){this.clearTimeouts(),this.visible||(Opentip.debug("DoShow",this.id),this.options.group&&Tips.hideGroup(this.options.group),this.visible=!0,this.waitingToShow=!1,Object.isFunction(this.content)&&(Opentip.debug("Executing content function..."),this.content=this.content(this)),this.tooltipElement||this.buildElements(),this.options.ajax&&!this.loaded&&this.loadAjax(),this.searchAndActivateHideButtons(),this.ensureElement(),this.container.setStyle({zIndex:Opentip.lastZIndex+=1}),this.setupObserversForReallyVisibleTip(),this.setupObserversForVisibleTip(),(this.options.showEffect||this.options.hideEffect)&&this.cancelEffects(),this.options.showEffect?this.container[this.options.showEffect]({duration:this.options.showEffectDuration,queue:this.queue,afterFinish:this.afterShowEffect.bind(this)}):this.container.show(),Opentip.useIFrame()&&this.iFrameElement.show(),this.activateFirstInput(),this.position())},loadAjax:function(){if(!this.loading){this.loading=!0,this.container.addClassName("loading");var t=this;new Ajax.Request(this.options.ajax.url,Object.extend({onSuccess:function(e){t.content=e.responseText;var i=t.container.down(".content");i&&(i.update(t.content),t.searchAndActivateHideButtons()),t.loaded=!0,t.loading=!1,t.container.removeClassName("loading"),t.storeAndFixDimensions(),t.position(),this.activateFirstInput()}},this.options.ajax.options||{}))}},afterShowEffect:function(){this.activateFirstInput(),this.position()},activateFirstInput:function(){var t=this.container.down("input"),e=this.container.down("textarea");t?t.focus():e&&e.focus()},searchAndActivateHideButtons:function(){"closeButton"!=this.options.hideTrigger&&this.options.hideTrigger||(this.options.hideTriggerElements=[],this.container.select(".close").each(function(t){this.options.hideTriggerElements.push({element:t,event:"click"})},this),this.visible&&this.setupObserversForVisibleTip())},hide:function(t){this.waitingToShow&&(this.clearTimeouts(),this.stopFollowingMousePosition(),this.waitingToShow=!1,this.setupObserversForHiddenTip()),this.visible&&(Opentip.debug("Hide",this.id),this.waitingToHide=!0,this.setupObserversForHiddenTip(),this.hideTimeoutId=this.bound.doHide.delay(this.options.hideDelay,t))},doHide:function(t){if(this.clearTimeouts(),this.visible){if(this.visible=!1,this.waitingToHide=!1,Opentip.debug("DoHide",this.id),this.deactivateElementEnsurance(),this.setupObserversForReallyHiddenTip(),this.setupObserversForHiddenTip(),this.options.fixed||this.stopFollowingMousePosition(),(this.options.showEffect||this.options.hideEffect)&&this.cancelEffects(),this.options.hideEffect){var e={duration:this.options.hideEffectDuration,queue:this.queue};t&&Object.isFunction(t)&&(e.afterFinish=t),this.container[this.options.hideEffect](e)}else this.container.hide();Opentip.useIFrame()&&this.iFrameElement.hide()}},cancelEffects:function(){Effect.Queues.get(this.queue.scope).invoke("cancel")},followMousePosition:function(){this.options.fixed||$(document.body).observe("mousemove",this.bound.position)},stopFollowingMousePosition:function(){this.options.fixed||$(document.body).stopObserving("mousemove",this.bound.position)},positionsEqual:function(t,e){return t.left==e.left&&t.top==e.top},position:function(t){var t=t||this.lastEvt;this.currentStemPosition=this.options.stem;var e=this.ensureViewportContainment(t,this.getPosition(t));if(this.positionsEqual(e,this.lastPosition))return void this.positionStem();if(this.lastPosition=e,e){var i={left:e.left+"px",top:e.top+"px"};this.container.setStyle(i),Opentip.useIFrame()&&this.iFrameElement&&this.iFrameElement.setStyle({width:this.container.getWidth()+"px",height:this.container.getHeight()+"px"});var s=this.container;(function(){s.style.visibility="hidden";s.offsetHeight;s.style.visibility="visible"}).defer()}this.positionStem()},getPosition:function(t,e,i,s){var e=e||this.options.tipJoint,i=i||this.options.targetJoint,o={};if(this.options.target){var n=this.options.target.cumulativeOffset();o.left=n[0],o.top=n[1],"right"==i[0]?"undefined"!=typeof this.options.target.getBoundingClientRect?o.left=this.options.target.getBoundingClientRect().right+$(document.viewport).getScrollOffsets().left:o.left=o.left+this.options.target.getWidth():"center"==i[0]&&(o.left+=Math.round(this.options.target.getWidth()/2)),"bottom"==i[1]?o.top+=this.options.target.getHeight():"middle"==i[1]&&(o.top+=Math.round(this.options.target.getHeight()/2))}else{if(!t)return;this.lastEvt=t,o.left=Event.pointerX(t),o.top=Event.pointerY(t)}if(this.options.autoOffset){var h=this.options.stem?this.options.stemSize:0,r=h&&this.options.fixed?2:10,p="middle"!=e[1]||this.options.fixed?0:15,a="center"!=e[0]||this.options.fixed?0:15;if("right"==e[0]?o.left-=r+p:"left"==e[0]&&(o.left+=r+p),"bottom"==e[1]?o.top-=r+a:"top"==e[1]&&(o.top+=r+a),h){var s=s||this.options.stem;"right"==s[0]?o.left-=h:"left"==s[0]&&(o.left+=h),"bottom"==s[1]?o.top-=h:"top"==s[1]&&(o.top+=h)}}return o.left+=this.options.offset[0],o.top+=this.options.offset[1],"right"==e[0]&&(o.left-=this.container.getWidth()),"center"==e[0]&&(o.left-=Math.round(this.container.getWidth()/2)),"bottom"==e[1]&&(o.top-=this.container.getHeight()),"middle"==e[1]&&(o.top-=Math.round(this.container.getHeight()/2)),o},ensureViewportContainment:function(t,e){if(!this.visible)return e;var i=[this.sticksOutX(e),this.sticksOutY(e)];if(!i[0]&&!i[1])return e;var s=this.options.tipJoint.clone(),o=this.options.targetJoint.clone(),n=$(document.viewport).getScrollOffsets(),h=this.dimensions,r={left:e.left-n.left,top:e.top-n.top},p=document.viewport.getDimensions(),a=!1;if(p.width>=h.width&&(r.left<0?(a=!0,s[0]="left",this.options.target&&"left"==o[0]&&(o[0]="right")):r.left+h.width>p.width&&(a=!0,s[0]="right",this.options.target&&"right"==o[0]&&(o[0]="left"))),p.height>=h.height&&(r.top<0?(a=!0,s[1]="top",this.options.target&&"top"==o[1]&&(o[1]="bottom")):r.top+h.height>p.height&&(a=!0,s[1]="bottom",this.options.target&&"bottom"==o[1]&&(o[1]="top"))),a){for(var d=this.getPosition(t,s,o,s),l=[this.sticksOutX(d),this.sticksOutY(d)],u=0,c=0;1>=c;c++)l[c]&&l[c]!=i[c]&&(u++,s[c]=this.options.tipJoint[c],this.options.target&&(o[c]=this.options.targetJoint[c]));if(2>u)return this.currentStemPosition=s,this.getPosition(t,s,o,s)}return e},sticksOut:function(t){return this.sticksOutX(t)||this.sticksOutY(t)},sticksOutX:function(t){var e=$(document.viewport).getScrollOffsets(),i={left:t.left-e.left,top:t.top-e.top};return i.left<0?1:i.left+this.dimensions.width>document.viewport.getDimensions().width?2:void 0},sticksOutY:function(t){var e=$(document.viewport).getScrollOffsets(),i={left:t.left-e.left,top:t.top-e.top};return i.top<0?1:i.top+this.dimensions.height>document.viewport.getDimensions().height?2:void 0},getStemElement:function(){return this.container.down(".stem")},stemPositionsEqual:function(t,e){return t&&e&&t[0]==e[0]&&t[1]==e[1]},positionStem:function(){if(this.options.stem){var t=this.getStemElement();if(t&&!this.stemPositionsEqual(this.lastStemPosition,this.currentStemPosition)){Opentip.debug("Setting stem style"),this.lastStemPosition=this.currentStemPosition;var e=this.currentStemPosition,i=this.options.stemSize,s=[320,160],o={width:i+"px",height:i+"px"};switch(o.left=o.top="0",e[0]){case"center":o.width=2*i+"px";case"left":o.left="-"+i+"px"}switch(e[1]){case"middle":o.height=2*i+"px";case"top":o.top="-"+i+"px"}"center"!=e[0]&&"middle"!=e[1]&&(o.width=o.height=2*i+"px");var n={left:0,top:0};switch(e[0]+"-"+e[1]){case"left-middle":n.left="-"+Math.round(.5*s[0])+"px",n.top="-"+Math.round(.5*s[1]-i)+"px";break;case"center-top":n.left="-"+Math.round(.75*s[0]-i)+"px";break;case"center-bottom":n.left="-"+Math.round(.75*s[0]-i)+"px",n.top="-"+Math.round(s[1]-i)+"px";break;case"right-middle":n.left="-"+Math.round(s[0]-i)+"px",n.top="-"+Math.round(s[1]/2-i)+"px";break;case"left-top":break;case"right-top":n.left="-"+Math.round(.5*s[0]-2*i)+"px",o.top="-"+i+"px",o.left="-"+i+"px";break;case"right-bottom":n.left="-"+Math.round(.5*s[0]-2*i)+"px",n.top="-"+Math.round(s[1]-2*i)+"px",o.left="-"+i+"px",o.top="-"+i+"px";break;case"left-bottom":n.top="-"+Math.round(s[1]-2*i)+"px",o.left="-"+i+"px",o.top="-"+i+"px"}t.down("div").setStyle(n),t.setStyle(o),t._appliedStyle=!0,t.up(".stemContainer").removeClassName("left").removeClassName("right").removeClassName("center").removeClassName("top").removeClassName("bottom").removeClassName("middle").addClassName(e[0]+" "+e[1])}}},ensureElementInterval:1e3,ensureElement:function(){this.deactivateElementEnsurance(),this.triggerElement.parentNode&&this.triggerElement.visible()&&this.triggerElement.descendantOf(document.body)||this.deactivate(),this.ensureElementTimeoutId=setTimeout(this.ensureElement.bind(this),this.ensureElementInterval)},deactivateElementEnsurance:function(){clearTimeout(this.ensureElementTimeoutId)}});