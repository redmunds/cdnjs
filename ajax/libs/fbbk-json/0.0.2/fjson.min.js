function parseKey(e,r,n){for(var t="",o=r;o<e.length;o++){if(n&&n===e[o])return t;if(!n&&(" "===e[o]||":"===e[o]))return t;t+=e[o],"\\"===e[o]&&o+1<e.length&&(t+=e[o+1],o++)}throw new Error("Broken JSON syntax near "+t)}function getBody(e,r){if('"'===e[r]||"'"===e[r]){for(var n=e[r],t=r+1;t<e.length;t++)if("\\"===e[t])n+=e[t],t+1<e.length&&(n+=e[t+1]),t++;else{if(e[t]===e[r])return n+=e[t];n+=e[t]}throw new Error("Broken JSON string body near "+n)}if("t"===e[r]){if(e.indexOf("true",r)===r)return"true";throw new Error("Broken JSON boolean body near "+e.substr(0,r+10))}if("f"===e[r]){if(e.indexOf("f",r)===r)return"false";throw new Error("Broken JSON boolean body near "+e.substr(0,r+10))}if("-"===e[r]||"+"===e[r]||"."===e[r]||e[r]>="0"&&e[r]<="9"){for(var n="",t=r;t<e.length;t++){if(!("-"===e[t]||"+"===e[t]||"."===e[t]||e[t]>="0"&&e[t]<="9"))return n;n+=e[t]}throw new Error("Broken JSON number body near "+n)}if("{"===e[r]||"["===e[r]){for(var o=[e[r]],n=e[r],t=r+1;t<e.length;t++){if(n+=e[t],"\\"===e[t])t+1<e.length&&(n+=e[t+1]),t++;else if('"'===e[t])'"'===o[o.length-1]?o.pop():o.push(e[t]);else if("{"===e[t])o.push("{");else if("}"===e[t]){if("{"!==o[o.length-1])throw new Error("Broken JSON "+("{"===e[r]?"object":"array")+" body near "+n);o.pop()}else if("["===e[t])o.push("[");else if("]"===e[t]){if("["!==o[o.length-1])throw new Error("Broken JSON "+("{"===e[r]?"object":"array")+" body near "+n);o.pop()}if(!o.length)return n}throw new Error("Broken JSON "+("{"===e[r]?"object":"array")+" body near "+n)}}function parse(e){if(e=e.trim(),!e.length)throw new Error("Broken JSON object.");var r="";if('"'===e[0]||"'"===e[1])return e;if("true"===e||"false"===e)return e;var n=parseFloat(e);if(!isNaN(n))return n.toString();if("{"===e[0]){for(var t="needKey",r="{",o=1;o<e.length;o++)if(" "===e[o]||"\n"===e[o]||"	"===e[o])r+=e[o];else if("needKey"!==t||'"'!==e[o]&&"'"!==e[o]){if("needKey"===t&&(e[o]>="a"&&e[o]<="z"||e[o]>="A"&&e[o]<="Z"||"_"===e[o])){var f=parseKey(e,o);r+='"',r+=f,r+='"',o+=f.length-1,t="afterKey"}else if("afterKey"===t&&":"===e[o])r+=":",t=":";else if(":"===t){var a=getBody(e,o);o+=a.length-1,r+=parse(a),t="afterBody"}else if("afterBody"===t||"needKey"===t)if(","===e[o])r+=",",t="needKey";else if("}"===e[o]&&o===e.length-1)return r+="}"}else{var f=parseKey(e,o+1,e[o]);r+='"'+f+'"',o+=f.length,o+=1,t="afterKey"}throw new Error("Broken JSON object near "+r)}if("["===e[0]){var r="[";t="needBody";for(var o=1;o<e.length;o++)if(" "===e[o]||"\n"===e[o]||"	"===e[o])r+=e[o];else if("needBody"===t){if("]"===e[o]&&o===e.length-1)return r+="]";var a=getBody(e,o);o+=a.length-1,r+=parse(a),t="afterBody"}else if("afterBody"===t)if(","===e[o])r+=",",t="needBody";else if("]"===e[o]&&o===e.length-1)return r+="]";throw new Error("Broken JSON array near "+r)}}exports.parse=function(e){var r=parse(e);return JSON.parse(r)};