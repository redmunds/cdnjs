!function(e){function t(){this.parent=null,this.nested=[],this.nodes=[],this.context=null,this.onRender=null,this.onUpdate=null,this.onRemove=null}function n(){this.items=Object.create(null),this.length=0,this.next=0}function o(e,t,n,o){if(o){var r={__index__:n};return r[o.value]=e[n],o.key&&(r[o.key]=n),r}return e[n]}function r(e,t,n,o){if(o){var r={__index__:n};return r[o.value]=e[t[n]],o.key&&(r[o.key]=t[n]),r}return e[t[n]]}t.render=function(e,t,n){var o;return o=n&&n.noCache?new e:e.pool.pop()||new e,8==t.nodeType?o.insertBefore(t):o.appendTo(t),n&&n.context&&(o.context=n.context),o.onRender&&o.onRender(),o},t.prerender=function(e,t){for(;t--;)e.pool.push(new e)},t.loop=function(e,n,i,s,h,u){var d,p,f,l,a,c,m=i.length;Array.isArray(h)?(a=o,c=h.length):(a=r,l=Object.keys(h),c=l.length),f=m-c;for(d in i.items){if(!(f-- >0))break;i.items[d].remove()}p=0;for(d in i.items)i.items[d].update(a(h,l,p,u)),p++;for(p=m,f=c;f>p;p++){var v=t.render(s,n);v.parent=e,e.nested.push(v),e.context&&(v.context=e.context),d=i.push(v),v.onRemove=function(e){return function(){i.remove(e)}}(d),v.update(a(h,l,p,u))}},t.cond=function(e,n,o,r,i){if(o.ref)i||o.ref.remove();else if(i){var s=t.render(r,n);s.parent=e,e.nested.push(s),e.context&&(s.context=e.context),o.ref=s,s.onRemove=function(){o.ref=null}}return i},t.insert=function(e,n,o,r,i){if(o.ref)o.ref.update(i);else{var s=t.render(r,n);s.parent=e,e.nested.push(s),e.context&&(s.context=e.context),o.ref=s,s.onRemove=function(){o.ref=null},s.update(i)}},t.prototype.remove=function(){for(var e=this.nodes.length;e--;)this.nodes[e].parentNode.removeChild(this.nodes[e]);for(this.onRemove&&this.onRemove(),e=this.nested.length;e--;)this.nested[e].remove();this.parent&&(e=this.parent.nested.indexOf(this),this.parent.nested.splice(e,1),this.parent=null),this.constructor.pool.push(this)},t.prototype.appendTo=function(e){for(var t=0,n=this.nodes.length;n>t;t++)e.appendChild(this.nodes[t])},t.prototype.insertBefore=function(e){if(!e.parentNode)throw new Error("Can not insert child view into parent node. You need append your view first and then update.");for(var t=0,n=this.nodes.length;n>t;t++)e.parentNode.insertBefore(this.nodes[t],e)},t.prototype.createDocument=function(){if(1==this.nodes.length)return this.nodes[0];for(var t=e.createDocumentFragment(),n=0,o=this.nodes.length;o>n;n++)t.appendChild(this.nodes[n]);return t},t.prototype.querySelector=function(e){for(var t=0;t<this.nodes.length;t++){if(this.nodes[t].matches&&this.nodes[t].matches(e))return this.nodes[t];if(8===this.nodes[t].nodeType)throw"Can not use querySelector with non-element nodes on first level.";if(this.nodes[t].querySelector){var n=this.nodes[t].querySelector(e);if(n)return n}}return null},n.prototype.push=function(e){return this.items[this.next]=e,this.length+=1,this.next+=1,this.next-1},n.prototype.remove=function(e){if(!(e in this.items))throw new Error('You are trying to delete not existing element "'+e+'" form map.');delete this.items[e],this.length-=1},n.prototype.forEach=function(e){for(var t in this.items)e(this.items[t])},t.Map=n,"undefined"!=typeof module?module.exports=t:window.Monkberry=t}(window.document);
//# sourceMappingURL=monkberry.min.js.map