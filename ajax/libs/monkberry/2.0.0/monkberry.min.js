!function(e){function t(){this.pool=new o,this.templates={},this.filters={},this.wrappers={}}function n(){this.name="",this.parent=null,this.nested=[],this.nodes=[]}function o(){this.store={}}function r(){this.items=Object.create(null),this.length=0,this.next=0}function i(e,t,n,o){if(o){var r=e;return r[o.valueName]=t,o.keyName&&(r[o.keyName]=n),r}return t}t.prototype.foreach=function(e,t,n,o,r,s,p){var h,a,u,d=n.length;u=d-s.length;for(h in n.items){if(!(u-- >0))break;n.items[h].remove()}a=0;for(h in n.items)n.items[h].update(i(r,s[a],a,p)),a++;for(a=d,u=s.length;u>a;a++){var f=this.render(o);f.parent=e,e.nested.push(f),8==t.nodeType?f.insertBefore(t):f.appendTo(t),f.update(i(r,s[a],a,p)),h=n.push(f),f.onRemove=function(e){return function(){n.remove(e)}}(h)}},t.prototype.insert=function(e,t,n,o,r,i){if(n.ref)i?n.ref.update(r):n.ref.remove();else if(i){var s=this.render(o);s.parent=e,e.nested.push(s),8==t.nodeType?s.insertBefore(t):s.appendTo(t),s.update(r),n.ref=s,s.onRemove=function(){n.ref=null}}},t.prototype.render=function(e,t,n){if(n=n||!1,this.templates[e]){var o;return n?(o=this.templates[e](),o.name=e,o.pool=this.pool):(o=this.pool.pull(e),o||(o=this.templates[e](),o.name=e,o.pool=this.pool)),void 0!==t&&o.update(t),o.wrapped=o.wrapped||{},this.wrappers[e]&&!o.wrapped[e]&&(o=this.wrappers[e](o),o.wrapped[e]=!0),o}throw new Error('Template with name "'+e+'" does not found.')},t.prototype.prerender=function(e,t){for(;t--;)this.pool.push(e,this.render(e,void 0,!0))},t.prototype.mount=function(t){var n=this;"function"==typeof t&&(t=t(this,e)),Object.keys(t).forEach(function(e){n.templates[e]=t[e]})},t.prototype.extend=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},t.prototype.view=function(){return new n},t.prototype.map=function(){return new r},n.prototype.appendTo=function(e){for(var t=0,n=this.nodes.length;n>t;t++)e.appendChild(this.nodes[t])},n.prototype.update=function(e){var t=this,n="object"==typeof e?Object.keys(e):[];t.__cache__&&n.forEach(function(e){e in t.__cache__&&delete t.__cache__[e]}),t.set&&n.forEach(function(n){t.set.hasOwnProperty(n)&&t.set[n](e,e[n])}),t._update&&t._update(e)},n.prototype.insertBefore=function(e){for(var t=0,n=this.nodes.length;n>t;t++){if(!e.parentNode)throw new Error("Can not insert child view into parent node.You need append your view first and then update.");e.parentNode.insertBefore(this.nodes[t],e)}},n.prototype.dom=function(t){if(1==this.nodes.length)return this.nodes[0];for(var n=e.createDocumentFragment(),o=0,r=this.nodes.length;r>o;o++)n.appendChild(this.nodes[o]);return n},n.prototype.remove=function(){for(var e=this.nodes.length;e--;)this.nodes[e].parentNode.removeChild(this.nodes[e]);for(this.onRemove&&this.onRemove(),e=this.nested.length;e--;)this.nested[e].remove();this.parent&&(e=this.parent.nested.indexOf(this),this.parent.nested.splice(e,1)),this.pool.push(this.name,this)},o.prototype.push=function(e,t){this.store[e]||(this.store[e]=[]),this.store[e].push(t)},o.prototype.pull=function(e){return this.store[e]?this.store[e].pop():void 0},r.prototype.push=function(e){return this.items[this.next]=e,this.length+=1,this.next+=1,this.next-1},r.prototype.remove=function(e){if(!(e in this.items))throw new Error('You are trying to delete not existing element "'+e+'" form map.');delete this.items[e],this.length-=1},"undefined"!=typeof module?module.exports=new t:window.monkberry=new t}(window.document);
//# sourceMappingURL=monkberry.min.js.map