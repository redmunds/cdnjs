!function(e){var t,a,i,r="_DATA_";i=/<\/?[^>]+>/gi,t=function(e,t){var a,i="a"===e.get(0).tagName.toLowerCase()?e:e.children("a"),r=t.data.grid.columns[0].width;a=i.parentsUntil(t.get_container().get(0).tagName+".jstree").filter("li").length,r-=18*a,i.css({width:r,"vertical-align":"top",overflow:"hidden"})},a=function(e,t,a){var s,d="a"===e.get(0).tagName.toLowerCase()?e:e.children("a"),l=a.data.grid.columns[0];s="",l.title&&(l.title===r?s=a.get_text(t):t.attr(l.title)&&(s=t.attr(l.title))),s=s.replace(i,""),s&&d.attr("title",s)},e.jstree.plugin("grid",{__init:function(){var a=this._get_settings().grid||{};this.data.grid.columns=a.columns||[],this.data.grid.treeClass="jstree-grid",this.data.grid.columnWidth=a.width,this.data.grid.defaultConf={display:"inline-block"},this.data.grid.isThemeroller=!!this.data.themeroller,e.browser.msie&&parseInt(e.browser.version.substr(0,1),10)<8&&(this.data.grid.defaultConf.display="inline",this.data.grid.defaultConf.zoom="1"),this.data.grid.isThemeroller?e('<style type="text/css">.jstree-grid-header {border-width: 0 1px 0 0; padding: 1px 3px;}\n.jstree-grid-cell {padding-left: 4px; border: none !important; background: transparent !important;}</style>').appendTo(e("head")):e('<style type="text/css">.jstree-grid-header {border-left: 1px solid #eeeeee;border-right: 1px solid #d0d0d0;background-color: #EBF3FD;}\n.jstree-grid-cell {padding-left: 4px;}</style>').appendTo(e("head")),this.get_container().bind("open_node.jstree create_node.jstree clean_node.jstree change_node.jstree",e.proxy(function(t,a){var i=a&&a.rslt&&a.rslt.obj?a.rslt.obj:t.target;i=e(i),this._prepare_grid(i)},this)).bind("loaded.jstree",e.proxy(function(e){this._prepare_headers(),this._prepare_grid(),this.get_container().trigger("loaded_grid.jstree")},this)).bind("move_node.jstree",e.proxy(function(a,i){var r=i.rslt.o;t(r,this),r.find("li > a").each(e.proxy(function(a,i){t(e(i),this)},this))},this)),this.data.grid.isThemeroller&&this.get_container().bind("select_node.jstree",e.proxy(function(e,t){t.rslt.obj.children("a").nextAll("div").addClass("ui-state-active")},this)).bind("deselect_node.jstree deselect_all.jstree",e.proxy(function(e,t){t.rslt.obj.children("a").nextAll("div").removeClass("ui-state-active")},this)).bind("hover_node.jstree",e.proxy(function(e,t){t.rslt.obj.children("a").nextAll("div").addClass("ui-state-hover")},this)).bind("dehover_node.jstree",e.proxy(function(e,t){t.rslt.obj.children("a").nextAll("div").removeClass("ui-state-hover")},this))},__destroy:function(){var t=this.data.grid.parent,a=this.get_container();a.detach(),e("div.jstree-grid-wrapper",t).remove(),t.append(a)},defaults:{width:25},_fn:{_prepare_headers:function(){var t,a,i,r,s,d,l,n=this.data.grid.columns||[],o=this.data.grid.columnWidth,h=this.data.grid.isThemeroller,g=this.get_container(),c=g.parent(),p=0,u=this.data.grid.defaultConf;for(this.data.grid.parent=c,t=this.data.grid.header||e("<div></div>").addClass((h?"ui-widget-header ":"")+"jstree-grid-header"),a=0;a<n.length;a++)r=n[a].headerClass||"",s=n[a].header||"",s&&(p=!0),i=n[a].width||o,i-=h?7:10,d=0===a?3:0,l=e("<div></div>").css(u).css({"margin-left":d,width:i,padding:"1 3 2 5"}).addClass((h?"ui-widget-header ":"")+"jstree-grid-header "+r).text(s).appendTo(t);l.addClass((h?"ui-widget-header ":"")+"jstree-grid-header"),p&&(e("<div></div>").addClass("jstree-grid-wrapper").appendTo(c).append(t).append(g),this.data.grid.divOffset=t.parent().offset().left,this.data.grid.header=t)},_prepare_grid:function(r){var s,d,l,n=this.data.grid.treeClass,o=this,h=this.data.grid.columns||[],g=this.data.grid.isThemeroller,c=this.data.grid.columnWidth,p=(this.data.grid.divOffset,this.data.grid.defaultConf);r=r&&-1!==r?this._get_node(r):this.get_container(),r.each(function(){var r,u,f,v,_,C,m,j,x,w,b,y,T,A,P;if(s=e(this),_=s.children("a"),y=_.hasClass(n),1===_.length){for(_.addClass(n),t(_,o),a(_,s,o),C=_,r=1;r<h.length;r++)T=h[r],P=T.source||"attr",f=T.cellClass||"",v=T.wideCellClass||"","attr"===P?u=T.value&&s.attr(T.value)?s.attr(T.value):"":"metadata"===P&&(u=T.value&&s.data(T.value)?s.data(T.value):""),T.images?(l=T.images[u]||T.images["default"],l&&(A="*"===l[0]?'<span class="'+l.substr(1)+'"></span>':'<img src="'+l+'">')):A=u,m=T.valueClass&&s.attr(T.valueClass)?s.attr(T.valueClass):"",m&&T.valueClassPrefix&&""!==T.valueClassPrefix&&(m=T.valueClassPrefix+m),j=T.wideValueClass&&s.attr(T.wideValueClass)?s.attr(T.wideValueClass):"",j&&T.wideValueClassPrefix&&""!==T.wideValueClassPrefix&&(j=T.wideValueClassPrefix+j),b=T.title&&s.attr(T.title)?s.attr(T.title):"",b=b.replace(i,""),w=7,d=T.width||c,d-=w,C=y?_.nextAll("div:eq("+(r-1)+")"):e("<div></div>").insertAfter(C),x=y?C.children("span"):e("<span></span>").appendTo(C),x.addClass(f+" "+m).css("display","inline-block").html(A).click(function(){e(this).trigger("select_cell.jstree-grid",[{value:u,column:T.header,node:e(this).closest("li"),sourceName:T.value,sourceType:P}])}),C=C.css(p).css({width:d,"padding-left":w+"px"}).addClass("jstree-grid-cell "+v+" "+j+(g?" ui-state-default":"")),b&&x.attr("title",b);C.addClass("jstree-grid-cell-last"+(g?" ui-state-default":""))}}),r.is("li")?this._repair_state(r):r.find("> ul > li").each(function(){o._repair_state(this)})}}})}(jQuery);
//# sourceMappingURL=jstreegrid.min.js.map