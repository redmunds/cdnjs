// XHook - v1.2.2 - https://github.com/jpillora/xhook
// Jaime Pillora <dev@jpillora.com> - MIT Copyright 2014
(function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};p=a.document,d="before",c="after",k="readyState",j="addEventListener",i="removeEventListener",g="dispatchEvent",n="XMLHttpRequest",h="FormData",l=["load","loadend","loadstart"],e=["progress","abort","error","timeout"],(v=Array.prototype).indexOf||(v.indexOf=function(a){var b,c,d,e;for(b=d=0,e=this.length;e>d;b=++d)if(c=this[b],c===a)return b;return-1}),t=function(a,b){return Array.prototype.slice.call(a,b)},r=function(a,b){var c,d;for(c in a)if(d=a[c],"returnValue"!==c)try{b[c]=a[c]}catch(e){}return b},s=function(a,b,c){var d,e,f,h;for(e=function(a){return function(d){var e,f,h;e={};for(f in d)"returnValue"!==f&&(h=d[f],e[f]=h===b?c:h);return c[g](a,e)}},f=0,h=a.length;h>f;f++)d=a[f],b["on"+d]=e(d)},q=function(a){var b;if(null!=p.createEventObject)return b=p.createEventObject(),b.type=a,b;try{return new Event(a)}catch(c){return{type:a}}},f=function(a){var c,d,e;return d={},e=function(a){return d[a]||[]},c={},c[j]=function(a,c,f){d[a]=e(a),d[a].indexOf(c)>=0||(f=f===b?d[a].length:f,d[a].splice(f,0,c))},c[i]=function(a,b){var c;c=e(a).indexOf(b),-1!==c&&e(a).splice(c,1)},c[g]=function(){var d,f,g,h,i,j,k,l;for(d=t(arguments),f=d.shift(),a||(d[0]=r(d[0],q(f))),h=c["on"+f],h&&h.apply(b,d),l=e(f).concat(e("*")),g=j=0,k=l.length;k>j;g=++j)i=l[g],i.apply(b,d)},a&&(c.listeners=function(a){return t(e(a))},c.on=c[j],c.off=c[i],c.fire=c[g],c.once=function(a,b){var d;return d=function(){return c.off(a,d),b.apply(null,arguments)},c.on(a,d)},c.destroy=function(){return d={}}),c},u=f(!0),u.EventEmitter=f,u[d]=function(a,b){if(a.length<1||a.length>2)throw"invalid hook";return u[j](d,a,b)},u[c]=function(a,b){if(a.length<2||a.length>3)throw"invalid hook";return u[j](c,a,b)},u.enable=function(){a[n]=m},u.disable=function(){a[n]=u[n]},o=u.headers=function(a,b){var c,d,e,f,g,h,i,j,k;switch(null==b&&(b={}),typeof a){case"object":d=[];for(e in a)g=a[e],f=e.toLowerCase(),d.push(""+f+":	"+g);return d.join("\n");case"string":for(d=a.split("\n"),i=0,j=d.length;j>i;i++)c=d[i],/([^:]+):\s*(.+)/.test(c)&&(f=null!=(k=RegExp.$1)?k.toLowerCase():void 0,h=RegExp.$2,null==b[f]&&(b[f]=h));return b}},(u[h]=a[h])&&(a[h]=function(a){var b,c=this;this.fd=new u[h](a),this.form=a,b=[],Object.defineProperty(this,"entries",{get:function(){var c;return c=a?t(a.querySelectorAll("input,select")).filter(function(a){var b;return"checkbox"!==(b=a.type)&&"radio"!==b||a.checked}).map(function(a){return[a.name,"file"===a.type?a.files:a.value]}):[],c.concat(b)}}),this.append=function(){var a;return a=t(arguments),b.push(a),c.fd.append.apply(c.fd,a)}}),u[n]=a[n],m=a[n]=function(){var b,i,m,p,q,t,v,x,y,z,A,B,C,D,E;return E=new u[n],q=!1,B=!1,y={},y.headers={},z={},z.headers={},x=function(){var a,b,c,d;z.status=E.status,z.statusText=E.statusText,d=o(E.getAllResponseHeaders());for(a in d)c=d[a],z.headers[a]||(b=a.toLowerCase(),z.headers[b]=c)},v=function(){try{z.text=E.responseText}catch(a){}try{z.xml=E.responseXML}catch(a){}z.data=E.response||z.text},D=function(){p.status=z.status,p.statusText=z.statusText},C=function(){z.hasOwnProperty("text")&&(p.responseText=z.text),z.hasOwnProperty("xml")&&(p.responseXML=z.xml),p.response=z.data||null},m=function(a){for(;a>b&&4>b;)p[k]=++b,1===b&&p[g]("loadstart",{}),2===b&&D(),4===b&&(D(),C()),p[g]("readystatechange",{}),4===b&&setTimeout(i,0)},i=function(){q||p[g]("load",{}),p[g]("loadend",{}),q&&(p[k]=0)},b=0,A=function(a){var b,d;return 4!==a?(m(a),void 0):(b=u.listeners(c),d=function(){var a;return b.length?(a=b.shift(),2===a.length?(a(y,z),d()):3===a.length&&y.async?a(y,z,d):d()):m(4)},d(),void 0)},p=y.xhr=f(),E.onreadystatechange=function(){try{2===E[k]&&x()}catch(a){}4===E[k]&&(B=!1,x(),v()),A(E[k])},t=function(){q=!0},p[j]("error",t),p[j]("timeout",t),p[j]("abort",t),p[j]("progress",function(){3>b?A(3):p[g]("readystatechange",{})}),s(e,E,p),("withCredentials"in E||u.addWithCredentials)&&(p.withCredentials=!1),p.status=0,p.open=function(a,b,c,d,e){y.method=a,y.url=b,y.async=c!==!1,y.user=d,y.pass=e,A(1)},p.send=function(b){var c,e,f,g,i,j,k,l;for(l=["type","timeout","withCredentials"],j=0,k=l.length;k>j;j++)e=l[j],f="type"===e?"responseType":e,f in p&&(y[e]=p[f]);y.body=b,i=function(){var b,c,d,g,i,j;for(B=!0,E.open(y.method,y.url,y.async,y.user,y.pass),i=["type","timeout","withCredentials"],d=0,g=i.length;g>d;d++)e=i[d],f="type"===e?"responseType":e,e in y&&(E[f]=y[e]);j=y.headers;for(b in j)c=j[b],E.setRequestHeader(b,c);a[h]&&y.body instanceof a[h]&&(y.body=y.body.fd),E.send(y.body)},c=u.listeners(d),g=function(){var a,b;return c.length?(a=function(a){return"object"!=typeof a||"number"!=typeof a.status&&"number"!=typeof z.status?(g(),void 0):(r(a,z),w.call(a,"data")<0&&(a.data=a.response||a.text),A(4),void 0)},a.head=function(a){return r(a,z),A(2)},a.progress=function(a){return r(a,z),A(3)},b=c.shift(),1===b.length?a(b(y)):2===b.length&&y.async?b(y,a):a()):i()},g()},p.abort=function(){B?E.abort():p[g]("abort",{})},p.setRequestHeader=function(a,b){var c;c=null!=a?a.toLowerCase():void 0,y.headers[c]=b},p.getResponseHeader=function(a){var b;return b=null!=a?a.toLowerCase():void 0,z.headers[b]},p.getAllResponseHeaders=function(){return o(z.headers)},E.overrideMimeType&&(p.overrideMimeType=function(){return E.overrideMimeType.apply(E,arguments)}),E.upload&&(p.upload=y.upload=f(),s(e.concat(l),E.upload,p.upload)),p},"function"==typeof this.define&&this.define.amd?define("xhook",[],function(){return u}):(this.exports||this).xhook=u}).call(this,window);