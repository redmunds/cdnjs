(function(){var t,e,n,r,i,o,s,l,u=[].slice,a={}.hasOwnProperty,c=function(t,e){return function(){return t.apply(e,arguments)}},p=function(t,e){function n(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};o=function(){var t,e,n,r,i,o,s;if(t=arguments[0],n=2<=arguments.length?u.call(arguments,1):[])for(o=0,s=n.length;o<s;o++)if(r=n[o])for(e in r)a.call(r,e)&&(i=r[e],t[e]=i);return t},l=function(t){return!!t&&t.constructor.prototype===Object.prototype},s=function(t){return t.constructor.prototype===Array.prototype},i=function(t){var e,n,r;if(!t)return t;if("function"==typeof t.clone)return t.clone();if(l(t)||s(t)){n=new t.constructor;for(e in t)a.call(t,e)&&(r=t[e],"function"!=typeof r&&(n[e]=i(r)));return n}return JSON.parse(JSON.stringify(t))},e=function(t,e,n){var r,i,o;if("function"!=typeof e&&"string"!=typeof e)throw new Error("type must be a class constructor or string denoting 'typeof' result");if("function"!=typeof n)throw new Error("handler must be a function");for(i=0,o=t.length;i<o;i++)if(r=t[i],r.type===e)return void(r.handler=n);return t.push({type:e,handler:n})},t=function(){var t,e,n,r,i,o,s,l;for(r=arguments[0],t=2<=arguments.length?u.call(arguments,1):[],i=0,s=t.length;i<s;i++)for(e=t[i],o=0,l=e.length;o<l;o++)if(n=e[o],n.type===typeof r||"string"!=typeof n.type&&r instanceof n.type)return n.handler},r=function(n){var r,s,h,f,d,_,y,b;return null==n&&(n=null),r={},r.DefaultQueryBuilderOptions={autoQuoteTableNames:!1,autoQuoteFieldNames:!1,autoQuoteAliasNames:!0,useAsForTableAliasNames:!1,nameQuoteCharacter:"`",tableAliasQuoteCharacter:"`",fieldAliasQuoteCharacter:'"',valueHandlers:[],parameterCharacter:"?",numberedParameters:!1,numberedParametersPrefix:"$",numberedParametersStartAt:1,replaceSingleQuotes:!1,singleQuoteReplacement:"''",separator:" "},r.globalValueHandlers=[],r.registerValueHandler=function(t,n){return e(r.globalValueHandlers,t,n)},r.Cloneable=function(){function t(){}return t.prototype.clone=function(){var t;return t=new this.constructor,o(t,i(o({},this)))},t}(),r.BaseBuilder=function(n){function i(t){this._sanitizeNestableQuery=c(this._sanitizeNestableQuery,this);var e;e=JSON.parse(JSON.stringify(r.DefaultQueryBuilderOptions)),this.options=o({},e,t)}return p(i,n),i.prototype.registerValueHandler=function(t,n){return e(this.options.valueHandlers,t,n),this},i.prototype._getObjectClassName=function(t){var e;if(t&&t.constructor&&t.constructor.toString&&(e=t.constructor.toString().match(/function\s*(\w+)/),e&&2===e.length))return e[1]},i.prototype._sanitizeCondition=function(t){if(!(t instanceof r.Expression)&&"string"!=typeof t)throw new Error("condition must be a string or Expression instance");return t},i.prototype._sanitizeName=function(t,e){if("string"!=typeof t)throw new Error(""+e+" must be a string");return t},i.prototype._sanitizeField=function(t,e){var n;return null==e&&(e={}),t instanceof r.QueryBuilder?t="("+t+")":(t=this._sanitizeName(t,"field name"),this.options.autoQuoteFieldNames&&(n=this.options.nameQuoteCharacter,t=e.ignorePeriodsForFieldNameQuotes?""+n+t+n:t.split(".").map(function(t){return"*"===t?t:""+n+t+n}).join("."))),t},i.prototype._sanitizeNestableQuery=function(t){if(t instanceof r.QueryBuilder&&t.isNestable())return t;throw new Error("must be a nestable query, e.g. SELECT")},i.prototype._sanitizeTable=function(t,e){var n,r;if(null==e&&(e=!1),e)if("string"==typeof t)r=t;else try{r=this._sanitizeNestableQuery(t)}catch(t){throw n=t,new Error("table name must be a string or a nestable query instance")}else r=this._sanitizeName(t,"table name");return this.options.autoQuoteTableNames?""+this.options.nameQuoteCharacter+r+this.options.nameQuoteCharacter:r},i.prototype._sanitizeTableAlias=function(t){var e;return e=this._sanitizeName(t,"table alias"),this.options.autoQuoteAliasNames&&(e=""+this.options.tableAliasQuoteCharacter+e+this.options.tableAliasQuoteCharacter),this.options.useAsForTableAliasNames?"AS "+e:e},i.prototype._sanitizeFieldAlias=function(t){var e;return e=this._sanitizeName(t,"field alias"),this.options.autoQuoteAliasNames?""+this.options.fieldAliasQuoteCharacter+e+this.options.fieldAliasQuoteCharacter:e},i.prototype._sanitizeLimitOffset=function(t){if(t=parseInt(t),0>t||isNaN(t))throw new Error("limit/offset must be >= 0");return t},i.prototype._sanitizeValue=function(e){var n,i;if(n=typeof e,null===e);else if("string"===n||"number"===n||"boolean"===n);else if(e instanceof r.QueryBuilder&&e.isNestable());else if(e instanceof r.FunctionBlock);else if(i=void 0!==t(e,this.options.valueHandlers,r.globalValueHandlers),!i)throw new Error("field value must be a string, number, boolean, null or one of the registered custom value types");return e},i.prototype._escapeValue=function(t){return!0!==this.options.replaceSingleQuotes?t:t.replace(/\'/g,this.options.singleQuoteReplacement)},i.prototype._formatCustomValue=function(e,n){var i;return null==n&&(n=!1),i=t(e,this.options.valueHandlers,r.globalValueHandlers),i&&(e=i(e,n)),e},i.prototype._formatValueAsParam=function(t){var e,n=this;return Array.isArray(t)?t.map(function(t){return n._formatValueAsParam(t)}):t instanceof r.QueryBuilder&&t.isNestable()?(t.updateOptions({nestedBuilder:!0}),e=t.toParam()):t instanceof r.Expression?e=t.toParam():this._formatCustomValue(t,!0)},i.prototype._formatValue=function(t,e){var n,i,o=this;return null==e&&(e={}),n=this._formatCustomValue(t),n!==t?"("+n+")":(Array.isArray(t)?(t=t.map(function(t){return o._formatValue(t)}),t="("+t.join(", ")+")"):null===t?t="NULL":"boolean"==typeof t?t=t?"TRUE":"FALSE":t instanceof r.QueryBuilder?t="("+t+")":t instanceof r.Expression?t="("+t+")":"number"!=typeof t&&(e.dontQuote?t=""+t:(i=this._escapeValue(t),t="'"+i+"'")),t)},i}(r.Cloneable),r.Expression=function(t){function e(t){var n,i=this;e.__super__.constructor.call(this),n=JSON.parse(JSON.stringify(r.DefaultQueryBuilderOptions)),this.options=o({},n,t),this.tree={nodes:[]},this.current=this.tree,this.stack=[],this._begin=function(t){var e,n;return n={type:t,nodes:[]},e=i._current(),i.stack.push(e.nodes.length),e.nodes.push(n),i},this._current=function(){var t,e,n,r;for(t=i.tree,e=n=0,r=i.stack.length;0<=r?n<r:n>r;e=0<=r?++n:--n)t=t.nodes[i.stack[e]];return t}}return p(e,t),e.prototype.tree=null,e.prototype.stack=null,e.prototype.and_begin=function(){return this._begin("AND")},e.prototype.or_begin=function(){return this._begin("OR")},e.prototype.end=function(){if(!this.stack.length)throw new Error("begin() needs to be called");return this.stack.pop(),this},e.prototype.and=function(t,e){if(!t||"string"!=typeof t)throw new Error("expr must be a string");return this._current().nodes.push({type:"AND",expr:t,para:e}),this},e.prototype.or=function(t,e){if(!t||"string"!=typeof t)throw new Error("expr must be a string");return this._current().nodes.push({type:"OR",expr:t,para:e}),this},e.prototype.toString=function(){if(this.stack.length)throw new Error("end() needs to be called");return this._toString(this.tree)},e.prototype.toParam=function(){if(this.stack.length)throw new Error("end() needs to be called");return this._toString(this.tree,!0)},e.prototype._toString=function(t,e){var n,r,i,o,s,l,u,a,c,p=this;for(null==e&&(e=!1),l="",s=[],c=t.nodes,u=0,a=c.length;u<a;u++)n=c[u],null!=n.expr?(o=n.expr,void 0!==n.para&&(e?(r=this._formatValueAsParam(n.para),null!=(null!=r?r.text:void 0)?(s=s.concat(r.values),o=o.replace(this.options.parameterCharacter,"("+r.text+")")):s=s.concat(r),Array.isArray(n.para)&&(i=Array.apply(null,new Array(n.para.length)).map(function(){return p.options.parameterCharacter}),o=o.replace(this.options.parameterCharacter,"("+i.join(", ")+")"))):o=o.replace(this.options.parameterCharacter,this._formatValue(n.para)))):(o=this._toString(n,e),e&&(s=s.concat(o.values),o=o.text),""!==o&&(o="("+o+")")),""!==o&&(""!==l&&(l+=" "+n.type+" "),l+=o);return e?{text:l,values:s}:l},e}(r.BaseBuilder),r.Case=function(t){function e(t,n){null==n&&(n={}),e.__super__.constructor.call(this),l(t)&&(n=t,t=null),t&&(this.fieldName=this._sanitizeField(t)),this.options=o({},r.DefaultQueryBuilderOptions,n),this.cases=[]}return p(e,t),e.prototype.cases=null,e.prototype.elseValue=null,e.prototype.when=function(){var t,e;return t=arguments[0],e=2<=arguments.length?u.call(arguments,1):[],this.cases.unshift({expression:t,values:e}),this},e.prototype.then=function(t){if(0===this.cases.length)throw new Error("when() needs to be called first");return this.cases[0].result=t,this},e.prototype.else=function(t){return this.elseValue=t,this},e.prototype.toString=function(){return this._toString(this.cases,this.elseValue)},e.prototype.toParam=function(){return this._toString(this.cases,this.elseValue,!0)},e.prototype._toString=function(t,e,n){var i,o,s=this;return null==n&&(n=!1),0===t.length?this._formatValue(e):(o=[],t=t.map(function(t){var e,i;return e=new r.AbstractConditionBlock("WHEN"),e._condition.apply(e,[t.expression].concat(t.values)),i="",n?(e=e.buildParam(),i=e.text,o=o.concat(e.values)):i=e.buildStr(),i+" THEN "+s._formatValue(t.result)}),i=t.join(" ")+" ELSE "+this._formatValue(e)+" END",this.fieldName&&(i=this.fieldName+" "+i),i="CASE "+i,n?{text:i,values:o}:i)},e}(r.BaseBuilder),r.Block=function(t){function e(){return s=e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.exposedMethods=function(){var t,e,n;e={};for(t in this)n=this[t],"function"!=typeof n||"_"===t.charAt(0)||r.Block.prototype[t]||(e[t]=n);return e},e.prototype.buildStr=function(t){return""},e.prototype.buildParam=function(t){return{text:this.buildStr(t),values:[]}},e}(r.BaseBuilder),r.StringBlock=function(t){function e(t,n){e.__super__.constructor.call(this,t),this.str=n}return p(e,t),e.prototype.buildStr=function(t){return this.str},e}(r.Block),r.AbstractValueBlock=function(t){function e(t){e.__super__.constructor.call(this,t),this._str="",this._values=[]}return p(e,t),e.prototype._setValue=function(){var t,e;return t=arguments[0],e=2<=arguments.length?u.call(arguments,1):[],this._str=t,this._values=e,this},e.prototype.buildStr=function(t){var e,n,r,i,o,s,l;for(i=this._str,n="",o=[].concat(this._values),r=s=0,l=i.length;0<=l?s<l:s>l;r=0<=l?++s:--s)e=i.charAt(r),this.options.parameterCharacter===e&&0<o.length&&(e=o.shift()),n+=e;return n},e.prototype.buildParam=function(t){return{text:this._str,values:this._values}},e}(r.Block),r.FunctionBlock=function(t){function e(){return h=e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.function=function(){var t,e;return t=arguments[0],e=2<=arguments.length?u.call(arguments,1):[],this._setValue.apply(this,[t].concat(e))},e}(r.AbstractValueBlock),r.fval=function(){var t,e,n;return e=arguments[0],n=2<=arguments.length?u.call(arguments,1):[],t=new r.FunctionBlock,t.function.apply(t,[e].concat(n))},r.registerValueHandler(r.FunctionBlock,function(t,e){return null==e&&(e=!1),e?t.buildParam():t.buildStr()}),r.AbstractTableBlock=function(t){function e(t){e.__super__.constructor.call(this,t),this.tables=[]}return p(e,t),e.prototype._table=function(t,e){return null==e&&(e=null),e&&(e=this._sanitizeTableAlias(e)),t=this._sanitizeTable(t,this.options.allowNested||!1),this.options.singleTable&&(this.tables=[]),this.tables.push({table:t,alias:e})},e.prototype._hasTable=function(){return 0<this.tables.length},e.prototype.buildStr=function(t){var e,n,r,i,o;if(!this._hasTable())return"";for(n="",o=this.tables,r=0,i=o.length;r<i;r++)e=o[r],""!==n&&(n+=", "),n+="string"==typeof e.table?e.table:"("+e.table+")",e.alias&&(n+=" "+e.alias);return n},e.prototype._buildParam=function(t,e){var n,i,o,s,l,u,a,c,p,h,f,d,_,y;if(null==e&&(e=null),l={text:"",values:[]},s=[],o="",!this._hasTable())return l;for(_=this.tables,a=0,h=_.length;a<h;a++)n=_[a],"string"==typeof n.table?i={text:""+n.table,values:[]}:n.table instanceof r.QueryBuilder?(n.table.updateOptions({nestedBuilder:!0}),i=n.table.toParam()):(n.updateOptions({nestedBuilder:!0}),i=n.buildParam(t)),i.table=n,s.push(i);for(c=0,f=s.length;c<f;c++)for(i=s[c],""!==o?o+=", ":null!=e&&""!==e&&(o+=""+e+" "+o),o+="string"==typeof i.table.table?""+i.text:"("+i.text+")",null!=i.table.alias&&(o+=" "+i.table.alias),y=i.values,p=0,d=y.length;p<d;p++)u=y[p],l.values.push(this._formatCustomValue(u));return l.text+=o,l},e.prototype.buildParam=function(t){return this._buildParam(t)},e}(r.Block),r.UpdateTableBlock=function(t){function e(){return f=e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.table=function(t,e){return null==e&&(e=null),this._table(t,e)},e}(r.AbstractTableBlock),r.FromTableBlock=function(t){function e(){return d=e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.from=function(t,e){return null==e&&(e=null),this._table(t,e)},e.prototype.buildStr=function(t){var n;return n=e.__super__.buildStr.call(this,t),n.length?"FROM "+n:""},e.prototype.buildParam=function(t){return this._buildParam(t,"FROM")},e}(r.AbstractTableBlock),r.IntoTableBlock=function(t){function e(t){e.__super__.constructor.call(this,t),this.table=null}return p(e,t),e.prototype.into=function(t){return this.table=this._sanitizeTable(t,!1)},e.prototype.buildStr=function(t){if(!this.table)throw new Error("into() needs to be called");return"INTO "+this.table},e}(r.Block),r.GetFieldBlock=function(t){function e(t){e.__super__.constructor.call(this,t),this._fieldAliases={},this._fields=[]}return p(e,t),e.prototype.fields=function(t,e){var n,r,i,o,s,l;if(null==e&&(e={}),Array.isArray(t)){for(s=[],i=0,o=t.length;i<o;i++)r=t[i],s.push(this.field(r,null,e));return s}l=[];for(r in t)n=t[r],l.push(this.field(r,n,e));return l},e.prototype.field=function(t,e,n){var i;if(null==e&&(e=null),null==n&&(n={}),e&&(e=this._sanitizeFieldAlias(e)),this._fieldAliases[t]!==e)return i={alias:e},t instanceof r.Case?i.func=t:i.name=this._sanitizeField(t,n),n.aggregation&&(i.aggregation=n.aggregation),this._fieldAliases[t]=e,this._fields.push(i)},e.prototype.buildStr=function(t){return this._build(t)},e.prototype.buildParam=function(t){return this._build(t,!0)},e.prototype._build=function(t,e){var n,i,o,s,l,u,a;if(null==e&&(e=!1),!t.getBlock(r.FromTableBlock)._hasTable())return e?{text:"",values:[]}:"";for(o="",s=[],a=this._fields,l=0,u=a.length;l<u;l++)i=a[l],""!==o&&(o+=", "),i.aggregation&&(o+=i.aggregation+"("),i.func?e?(n=i.func.toParam(),o+=n.text,s=s.concat(n.values)):o+=i.func.toString():o+=i.name,i.aggregation&&(o+=")"),i.alias&&(o+=" AS "+i.alias);return""===o&&(o="*"),e?{text:o,values:s}:o},e}(r.Block),r.AbstractSetFieldBlock=function(t){function e(t){e.__super__.constructor.call(this,t),this.fieldOptions=[],this.fields=[],this.values=[]}return p(e,t),e.prototype._set=function(t,e,n){var r;if(null==n&&(n={}),this.values.length>1)throw new Error("Cannot call set or setFields on multiple rows of fields.");return void 0!==e&&(e=this._sanitizeValue(e)),r=this.fields.indexOf(this._sanitizeField(t,n)),r!==-1?(this.values[0][r]=e,this.fieldOptions[0][r]=n):(this.fields.push(this._sanitizeField(t,n)),r=this.fields.length-1,Array.isArray(this.values[0])?(this.values[0][r]=e,this.fieldOptions[0][r]=n):(this.values.push([e]),this.fieldOptions.push([n]))),this},e.prototype._setFields=function(t,e){var n;if(null==e&&(e={}),"object"!=typeof t)throw new Error("Expected an object but got "+typeof t);for(n in t)a.call(t,n)&&this._set(n,t[n],e);return this},e.prototype._setFieldsRows=function(t,e){var n,r,i,o,s,l,u;if(null==e&&(e={}),!Array.isArray(t))throw new Error("Expected an array of objects but got "+typeof t);for(this.fields=[],this.values=[],r=s=0,l=t.length;0<=l?s<l:s>l;r=0<=l?++s:--s){u=t[r];for(n in u)if(a.call(u,n)){if(i=this.fields.indexOf(this._sanitizeField(n,e)),0<r&&-1===i)throw new Error("All fields in subsequent rows must match the fields in the first row");-1===i&&(this.fields.push(this._sanitizeField(n,e)),i=this.fields.length-1),o=this._sanitizeValue(t[r][n]),Array.isArray(this.values[r])?(this.values[r][i]=o,this.fieldOptions[r][i]=e):(this.values[r]=[o],this.fieldOptions[r]=[e])}}return this},e.prototype.buildStr=function(){throw new Error("Not yet implemented")},e.prototype.buildParam=function(){throw new Error("Not yet implemented")},e}(r.Block),r.SetFieldBlock=function(t){function e(){return _=e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.set=function(t,e,n){return this._set(t,e,n)},e.prototype.setFields=function(t,e){return this._setFields(t,e)},e.prototype.buildStr=function(t){var e,n,r,i,o,s,l;if(0>=this.fields.length)throw new Error("set() needs to be called");for(i="",r=s=0,l=this.fields.length;0<=l?s<l:s>l;r=0<=l?++s:--s)e=this.fields[r],""!==i&&(i+=", "),o=this.values[0][r],n=this.fieldOptions[0][r],i+="undefined"==typeof o?e:""+e+" = "+this._formatValue(o,n);return"SET "+i},e.prototype.buildParam=function(t){var e,n,r,i,o,s,l,u,a,c,p,h;if(0>=this.fields.length)throw new Error("set() needs to be called");for(i="",s=[],n=u=0,p=this.fields.length;0<=p?u<p:u>p;n=0<=p?++u:--u)if(e=this.fields[n],""!==i&&(i+=", "),l=this.values[0][n],"undefined"==typeof l)i+=e;else if(r=this._formatValueAsParam(l),null!=(null!=r?r.text:void 0))for(i+=""+e+" = ("+r.text+")",h=r.values,a=0,c=h.length;a<c;a++)o=h[a],s.push(o);else i+=""+e+" = "+this.options.parameterCharacter,s.push(r);return{text:"SET "+i,values:s}},e}(r.AbstractSetFieldBlock),r.InsertFieldValueBlock=function(t){function e(){return y=e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.set=function(t,e,n){return null==n&&(n={}),this._set(t,e,n)},e.prototype.setFields=function(t,e){return this._setFields(t,e)},e.prototype.setFieldsRows=function(t,e){return this._setFieldsRows(t,e)},e.prototype._buildVals=function(){var t,e,n,r,i,o,s,l;for(r=[],e=i=0,s=this.values.length;0<=s?i<s:i>s;e=0<=s?++i:--i)for(n=o=0,l=this.values[e].length;0<=l?o<l:o>l;n=0<=l?++o:--o)t=this._formatValue(this.values[e][n],this.fieldOptions[e][n]),"string"==typeof r[e]?r[e]+=", "+t:r[e]=""+t;return r},e.prototype._buildValParams=function(){var t,e,n,r,i,o,s,l,u,a,c,p,h,f;for(s=[],r=[],t=l=0,p=this.values.length;0<=p?l<p:l>p;t=0<=p?++l:--l)for(e=u=0,h=this.values[t].length;0<=h?u<h:u>h;e=0<=h?++u:--u){if(n=this._formatValueAsParam(this.values[t][e]),null!=(null!=n?n.text:void 0))for(i=n.text,f=n.values,a=0,c=f.length;a<c;a++)o=f[a],r.push(o);else i=this.options.parameterCharacter,r.push(n);"string"==typeof s[t]?s[t]+=", "+i:s[t]=""+i}return{vals:s,params:r}},e.prototype.buildStr=function(t){return 0>=this.fields.length?"":"("+this.fields.join(", ")+") VALUES ("+this._buildVals().join("), (")+")"},e.prototype.buildParam=function(t){var e,n,r,i,o,s,l;if(0>=this.fields.length)return{text:"",values:[]};for(r="",s=this._buildValParams(),i=s.vals,n=s.params,e=o=0,l=this.fields.length;0<=l?o<l:o>l;e=0<=l?++o:--o)""!==r&&(r+=", "),r+=this.fields[e];return{text:"("+r+") VALUES ("+i.join("), (")+")",values:n}},e}(r.AbstractSetFieldBlock),r.InsertFieldsFromQueryBlock=function(t){function e(t){e.__super__.constructor.call(this,t),this._fields=[],this._query=null}return p(e,t),e.prototype.fromQuery=function(t,e){var n=this;return this._fields=t.map(function(t){return n._sanitizeField(t)}),this._query=this._sanitizeNestableQuery(e)},e.prototype.buildStr=function(t){return 0>=this._fields.length?"":"("+this._fields.join(", ")+") ("+this._query.toString()+")"},e.prototype.buildParam=function(t){var e;return 0>=this._fields.length?{text:"",values:[]}:(e=this._query.toParam(),{text:"("+this._fields.join(", ")+") ("+e.text+")",values:e.values})},e}(r.Block),r.DistinctBlock=function(t){function e(t){e.__super__.constructor.call(this,t),this.useDistinct=!1}return p(e,t),e.prototype.distinct=function(){return this.useDistinct=!0},e.prototype.buildStr=function(t){return this.useDistinct?"DISTINCT":""},e}(r.Block),r.GroupByBlock=function(t){function e(t){e.__super__.constructor.call(this,t),this.groups=[]}return p(e,t),e.prototype.group=function(t){return t=this._sanitizeField(t),this.groups.push(t)},e.prototype.buildStr=function(t){var e,n,r,i,o;if(n="",0<this.groups.length){for(o=this.groups,r=0,i=o.length;r<i;r++)e=o[r],""!==n&&(n+=", "),n+=e;n="GROUP BY "+n}return n},e}(r.Block),r.OffsetBlock=function(t){function e(t){e.__super__.constructor.call(this,t),this.offsets=null}return p(e,t),e.prototype.offset=function(t){return t=this._sanitizeLimitOffset(t),this.offsets=t},e.prototype.buildStr=function(t){return this.offsets?"OFFSET "+this.offsets:""},e}(r.Block),r.AbstractConditionBlock=function(t){function e(t,n){this.conditionVerb=t,e.__super__.constructor.call(this,n),this.conditions=[]}return p(e,t),e.prototype._condition=function(){var t,e,n,i,o,s,l,a,c,p,h,f,d,_;if(e=arguments[0],p=2<=arguments.length?u.call(arguments,1):[],e=this._sanitizeCondition(e),n="",i=[],e instanceof r.Expression)c=e.toParam(),n=c.text,i=c.values;else for(o=h=0,_=e.length;0<=_?h<_:h>_;o=0<=_?++h:--h)if(t=e.charAt(o),this.options.parameterCharacter===t&&0<p.length)if(a=p.shift(),Array.isArray(a)){for(s=[],f=0,d=a.length;f<d;f++)l=a[f],s.push(this._sanitizeValue(l));i=i.concat(s),n+="("+function(){var t,e,n;for(n=[],t=0,e=s.length;t<e;t++)l=s[t],n.push(this.options.parameterCharacter);return n}.call(this).join(", ")+")"}else n+=this.options.parameterCharacter,i.push(this._sanitizeValue(a));else n+=t;if(""!==n)return this.conditions.push({text:n,values:i})},e.prototype.buildStr=function(t){var e,n,r,i,o,s,l,u,a,c;if(0>=this.conditions.length)return"";for(r="",a=this.conditions,s=0,u=a.length;s<u;s++)if(n=a[s],""!==r&&(r+=") AND ("),0<n.values.length)for(o=0,i=l=0,c=n.text.length;0<=c?l<c:l>c;i=0<=c?++l:--l)e=n.text.charAt(i),r+=this.options.parameterCharacter===e?this._formatValue(n.values[o++]):e;else r+=n.text;return""+this.conditionVerb+" ("+r+")"},e.prototype.buildParam=function(t){var e,n,r,i,o,s,l,u,a,c,p,h,f,d,_,y,b;if(s={text:"",values:[]},0>=this.conditions.length)return s;for(n="",_=this.conditions,a=0,h=_.length;a<h;a++){for(e=_[a],""!==n&&(n+=") AND ("),l=e.text.split(this.options.parameterCharacter),r=0,y=e.values,c=0,f=y.length;c<f;c++){if(u=y[c],null!=l[r]&&(n+=""+l[r]),i=this._formatValueAsParam(u),null!=(null!=i?i.text:void 0))for(n+="("+i.text+")",b=i.values,p=0,d=b.length;p<d;p++)o=b[p],s.values.push(o);else n+=this.options.parameterCharacter,s.values.push(i);r+=1}null!=l[r]&&(n+=""+l[r])}return s.text=""+this.conditionVerb+" ("+n+")",s},e}(r.Block),r.WhereBlock=function(t){function e(t){e.__super__.constructor.call(this,"WHERE",t)}return p(e,t),e.prototype.where=function(){var t,e;return t=arguments[0],e=2<=arguments.length?u.call(arguments,1):[],this._condition.apply(this,[t].concat(u.call(e)))},e}(r.AbstractConditionBlock),r.HavingBlock=function(t){function e(t){e.__super__.constructor.call(this,"HAVING",t)}return p(e,t),e.prototype.having=function(){var t,e;return t=arguments[0],e=2<=arguments.length?u.call(arguments,1):[],this._condition.apply(this,[t].concat(u.call(e)))},e}(r.AbstractConditionBlock),r.OrderByBlock=function(t){function e(t){e.__super__.constructor.call(this,t),this.orders=[],this._values=[]}return p(e,t),e.prototype.order=function(){var t,e,n;return e=arguments[0],t=arguments[1],n=3<=arguments.length?u.call(arguments,2):[],e=this._sanitizeField(e),void 0===t&&(t=!0),null!==t&&(t=!!t),this._values=n,this.orders.push({field:e,dir:t})},e.prototype._buildStr=function(t){var e,n,r,i,o,s,l,u,a,c,p;if(null==t&&(t=!1),0<this.orders.length){for(s=0,o="",c=this.orders,l=0,a=c.length;l<a;l++){if(i=c[l],""!==o&&(o+=", "),n="",t)n=i.field;else for(r=u=0,p=i.field.length;0<=p?u<p:u>p;r=0<=p?++u:--u)e=i.field.charAt(r),n+=this.options.parameterCharacter===e?this._formatValue(this._values[s++]):e;o+=""+n,null!==i.dir&&(o+=" "+(i.dir?"ASC":"DESC"))}return"ORDER BY "+o}return""},e.prototype.buildStr=function(t){return this._buildStr()},e.prototype.buildParam=function(t){var e=this;return{text:this._buildStr(!0),values:this._values.map(function(t){return e._formatValueAsParam(t)})}},e}(r.Block),r.LimitBlock=function(t){function e(t){e.__super__.constructor.call(this,t),this.limits=null}return p(e,t),e.prototype.limit=function(t){return t=this._sanitizeLimitOffset(t),this.limits=t},e.prototype.buildStr=function(t){return this.limits||0===this.limits?"LIMIT "+this.limits:""},e}(r.Block),r.JoinBlock=function(t){function e(t){e.__super__.constructor.call(this,t),this.joins=[]}return p(e,t),e.prototype.join=function(t,e,n,r){return null==e&&(e=null),null==n&&(n=null),null==r&&(r="INNER"),t=this._sanitizeTable(t,!0),e&&(e=this._sanitizeTableAlias(e)),n&&(n=this._sanitizeCondition(n)),this.joins.push({type:r,table:t,alias:e,condition:n}),this},e.prototype.left_join=function(t,e,n){return null==e&&(e=null),null==n&&(n=null),this.join(t,e,n,"LEFT")},e.prototype.right_join=function(t,e,n){return null==e&&(e=null),null==n&&(n=null),this.join(t,e,n,"RIGHT")},e.prototype.outer_join=function(t,e,n){return null==e&&(e=null),null==n&&(n=null),this.join(t,e,n,"OUTER")},e.prototype.left_outer_join=function(t,e,n){return null==e&&(e=null),null==n&&(n=null),this.join(t,e,n,"LEFT OUTER")},e.prototype.full_join=function(t,e,n){return null==e&&(e=null),null==n&&(n=null),this.join(t,e,n,"FULL")},e.prototype.cross_join=function(t,e,n){return null==e&&(e=null),null==n&&(n=null),this.join(t,e,n,"CROSS")},e.prototype.buildStr=function(t){var e,n,r,i,o;for(n="",o=this.joins||[],r=0,i=o.length;r<i;r++)e=o[r],""!==n&&(n+=" "),n+=""+e.type+" JOIN ",n+="string"==typeof e.table?e.table:"("+e.table+")",e.alias&&(n+=" "+e.alias),e.condition&&(n+=" ON ("+e.condition+")");return n},e.prototype.buildParam=function(t){var e,n,i,o,s,l,u,a,c,p,h,f,d,_,y;if(l={text:"",values:[]},s=[],i="",0>=this.joins.length)return l;for(_=this.joins,a=0,h=_.length;a<h;a++)e=_[a],"string"==typeof e.table?o={text:""+e.table,values:[]}:e.table instanceof r.QueryBuilder?(e.table.updateOptions({nestedBuilder:!0}),o=e.table.toParam()):(e.updateOptions({nestedBuilder:!0}),o=e.buildParam(t)),e.condition instanceof r.Expression?(n=e.condition.toParam(),o.condition=n.text,o.values=o.values.concat(n.values)):o.condition=e.condition,o.join=e,s.push(o);for(c=0,f=s.length;c<f;c++)for(o=s[c],""!==i&&(i+=" "),i+=""+o.join.type+" JOIN ",i+="string"==typeof o.join.table?o.text:"("+o.text+")",o.join.alias&&(i+=" "+o.join.alias),o.condition&&(i+=" ON ("+o.condition+")"),y=o.values,p=0,d=y.length;p<d;p++)u=y[p],l.values.push(this._formatCustomValue(u));return l.text+=i,l},e}(r.Block),r.UnionBlock=function(t){function e(t){e.__super__.constructor.call(this,t),this.unions=[]}return p(e,t),e.prototype.union=function(t,e){return null==e&&(e="UNION"),t=this._sanitizeTable(t,!0),this.unions.push({type:e,table:t}),this},e.prototype.union_all=function(t){return this.union(t,"UNION ALL")},e.prototype.buildStr=function(t){var e,n,r,i,o;for(n="",o=this.unions||[],r=0,i=o.length;r<i;r++)e=o[r],""!==n&&(n+=" "),n+=""+e.type+" ",n+="string"==typeof e.table?e.table:"("+e.table+")";return n},e.prototype.buildParam=function(t){var e,n,i,o,s,l,u,a,c,p,h,f,d,_;if(o={text:"",values:[]},i=[],s="",0>=this.unions.length)return o;for(d=this.unions||[],u=0,p=d.length;u<p;u++)e=d[u],"string"==typeof e.table?n={text:""+e.table,values:[]}:e.table instanceof r.QueryBuilder?(e.table.updateOptions({nestedBuilder:!0}),n=e.table.toParam()):(e.updateOptions({nestedBuilder:!0}),n=e.buildParam(t)),n.type=e.type,i.push(n);for(a=0,h=i.length;a<h;a++)for(n=i[a],""!==s&&(s+=" "),s+=""+n.type+" ("+n.text+")",_=n.values,c=0,f=_.length;c<f;c++)l=_[c],o.values.push(this._formatCustomValue(l));return o.text+=s,o},e}(r.Block),r.QueryBuilder=function(t){function e(t,n){var r,i,o,s,l,u,a,c,p=this;for(e.__super__.constructor.call(this,t),this.blocks=n||[],a=this.blocks,l=0,u=a.length;l<u;l++){r=a[l],c=r.exposedMethods(),s=function(t,e,n){return p[e]=function(){return n.apply(t,arguments),p}};for(o in c){if(i=c[o],null!=this[o])throw new Error(""+this._getObjectClassName(this)+" already has a builder method called: "+o);s(r,o,i)}}}return p(e,t),e.prototype.registerValueHandler=function(t,n){var r,i,o,s;for(s=this.blocks,i=0,o=s.length;i<o;i++)r=s[i],r.registerValueHandler(t,n);return e.__super__.registerValueHandler.call(this,t,n),this},e.prototype.updateOptions=function(t){var e,n,r,i,s;for(this.options=o({},this.options,t),i=this.blocks,s=[],n=0,r=i.length;n<r;n++)e=i[n],s.push(e.options=o({},e.options,t));return s},e.prototype.toString=function(){var t;return function(){var e,n,r,i;for(r=this.blocks,i=[],e=0,n=r.length;e<n;e++)t=r[e],i.push(t.buildStr(this));return i}.call(this).filter(function(t){return 0<t.length}).join(this.options.separator)},e.prototype.toParam=function(t){var e,n,r,i,s,l,u,a=this;return null==t&&(t=void 0),i=this.options,null!=t&&(this.options=o({},this.options,t)),l={text:"",values:[]},n=function(){var t,n,r,i;for(r=this.blocks,i=[],t=0,n=r.length;t<n;t++)e=r[t],i.push(e.buildParam(this));return i}.call(this),l.text=function(){var t,r,i;for(i=[],t=0,r=n.length;t<r;t++)e=n[t],i.push(e.text);return i}().filter(function(t){return 0<t.length}).join(this.options.separator),l.values=(u=[]).concat.apply(u,function(){var t,r,i;for(i=[],t=0,r=n.length;t<r;t++)e=n[t],i.push(e.values);return i}()),null==this.options.nestedBuilder&&(this.options.numberedParameters||null!=(null!=t?t.numberedParametersStartAt:void 0))&&(r=1,null!=this.options.numberedParametersStartAt&&(r=this.options.numberedParametersStartAt),s=new RegExp("\\"+this.options.parameterCharacter,"g"),l.text=l.text.replace(s,function(){return""+a.options.numberedParametersPrefix+r++})),this.options=i,l},e.prototype.clone=function(){var t;return new this.constructor(this.options,function(){var e,n,r,i;for(r=this.blocks,i=[],e=0,n=r.length;e<n;e++)t=r[e],i.push(t.clone());return i}.call(this))},e.prototype.isNestable=function(){return!1},e.prototype.getBlock=function(t){return this.blocks.filter(function(e){return e instanceof t})[0]},e}(r.BaseBuilder),r.Select=function(t){function e(t,n){null==n&&(n=null),n||(n=[new r.StringBlock(t,"SELECT"),new r.FunctionBlock(t),new r.DistinctBlock(t),new r.GetFieldBlock(t),new r.FromTableBlock(o({},t,{allowNested:!0})),new r.JoinBlock(o({},t,{allowNested:!0})),new r.WhereBlock(t),new r.GroupByBlock(t),new r.HavingBlock(t),new r.OrderByBlock(t),new r.LimitBlock(t),new r.OffsetBlock(t),new r.UnionBlock(o({},t,{allowNested:!0}))]),e.__super__.constructor.call(this,t,n)}return p(e,t),e.prototype.isNestable=function(){return!0},e}(r.QueryBuilder),r.Update=function(t){function e(t,n){null==n&&(n=null),n||(n=[new r.StringBlock(t,"UPDATE"),new r.UpdateTableBlock(t),new r.SetFieldBlock(t),new r.WhereBlock(t),new r.OrderByBlock(t),new r.LimitBlock(t)]),e.__super__.constructor.call(this,t,n)}return p(e,t),e}(r.QueryBuilder),r.Delete=function(t){function e(t,n){null==n&&(n=null),n||(n=[new r.StringBlock(t,"DELETE"),new r.FromTableBlock(o({},t,{singleTable:!0})),new r.JoinBlock(t),new r.WhereBlock(t),new r.OrderByBlock(t),new r.LimitBlock(t)]),e.__super__.constructor.call(this,t,n)}return p(e,t),e}(r.QueryBuilder),r.Insert=function(t){function e(t,n){null==n&&(n=null),n||(n=[new r.StringBlock(t,"INSERT"),new r.IntoTableBlock(t),new r.InsertFieldValueBlock(t),new r.InsertFieldsFromQueryBlock(t)]),e.__super__.constructor.call(this,t,n)}return p(e,t),e}(r.QueryBuilder),b={VERSION:"4.3.2",flavour:n,expr:function(t){return new r.Expression(t)},case:function(t,e){return new r.Case(t,e)},select:function(t,e){return new r.Select(t,e)},update:function(t,e){return new r.Update(t,e)},insert:function(t,e){return new r.Insert(t,e)},delete:function(t,e){return new r.Delete(t,e)},registerValueHandler:r.registerValueHandler,fval:r.fval},b.remove=b.delete,b.cls=r,b},n=r(),("undefined"!=typeof define&&null!==define?define.amd:void 0)?define(function(){return n}):("undefined"!=typeof module&&null!==module?module.exports:void 0)?module.exports=n:"undefined"!=typeof window&&null!==window&&(window.squel=n),n.flavours={},n.useFlavour=function(t){var e;if(null==t&&(t=null),!t)return n;if(n.flavours[t]instanceof Function)return e=r(t),
n.flavours[t].call(null,e),e;throw new Error("Flavour not available: "+t)},n.flavours.postgres=function(t){var e;return e=t.cls,e.DefaultQueryBuilderOptions.numberedParameters=!0,e.DefaultQueryBuilderOptions.numberedParametersStartAt=1,e.DefaultQueryBuilderOptions.autoQuoteAliasNames=!1,e.DefaultQueryBuilderOptions.useAsForTableAliasNames=!0,e.ReturningBlock=function(t){function e(t){e.__super__.constructor.call(this,t),this._str=null}return p(e,t),e.prototype.returning=function(t){return this._str=this._sanitizeField(t)},e.prototype.buildStr=function(){return this._str?"RETURNING "+this._str:""},e}(e.Block),e.Insert=function(t){function n(t,r){null==r&&(r=null),r||(r=[new e.StringBlock(t,"INSERT"),new e.IntoTableBlock(t),new e.InsertFieldValueBlock(t),new e.InsertFieldsFromQueryBlock(t),new e.ReturningBlock(t)]),n.__super__.constructor.call(this,t,r)}return p(n,t),n}(e.QueryBuilder),e.Update=function(t){function n(t,r){null==r&&(r=null),r||(r=[new e.StringBlock(t,"UPDATE"),new e.UpdateTableBlock(t),new e.SetFieldBlock(t),new e.FromTableBlock(o({},t,{allowNested:!0})),new e.WhereBlock(t),new e.OrderByBlock(t),new e.LimitBlock(t),new e.ReturningBlock(t)]),n.__super__.constructor.call(this,t,r)}return p(n,t),n}(e.QueryBuilder),e.Delete=function(t){function n(t,r){null==r&&(r=null),r||(r=[new e.StringBlock(t,"DELETE"),new e.FromTableBlock(o({},t,{singleTable:!0})),new e.JoinBlock(t),new e.WhereBlock(t),new e.OrderByBlock(t),new e.LimitBlock(t),new e.ReturningBlock(t)]),n.__super__.constructor.call(this,t,r)}return p(n,t),n}(e.QueryBuilder)},n.flavours.mysql=function(t){var e,n,r;return e=t.cls,e.TargetTableBlock=function(t){function e(){return n=e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.target=function(t){return this._setValue(this._sanitizeTable(t))},e}(e.AbstractValueBlock),e.MysqlOnDuplicateKeyUpdateBlock=function(t){function e(){return r=e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.onDupUpdate=function(t,e,n){return this._set(t,e,n)},e.prototype.buildStr=function(){var t,e,n,r,i,o,s;for(r="",n=o=0,s=this.fields.length;0<=s?o<s:o>s;n=0<=s?++o:--o)t=this.fields[n],""!==r&&(r+=", "),i=this.values[0][n],e=this.fieldOptions[0][n],r+="undefined"==typeof i?t:""+t+" = "+this._formatValue(i,e);return""===r?"":"ON DUPLICATE KEY UPDATE "+r},e.prototype.buildParam=function(t){var e,n,r,i,o,s,l;for(r="",i=[],n=s=0,l=this.fields.length;0<=l?s<l:s>l;n=0<=l?++s:--s)e=this.fields[n],""!==r&&(r+=", "),o=this.values[0][n],"undefined"==typeof o?r+=e:(r+=""+e+" = "+this.options.parameterCharacter,i.push(this._formatValueAsParam(o)));return{text:""===r?"":"ON DUPLICATE KEY UPDATE "+r,values:i}},e}(e.AbstractSetFieldBlock),e.Insert=function(t){function n(t,r){null==r&&(r=null),r||(r=[new e.StringBlock(t,"INSERT"),new e.IntoTableBlock(t),new e.InsertFieldValueBlock(t),new e.InsertFieldsFromQueryBlock(t),new e.MysqlOnDuplicateKeyUpdateBlock(t)]),n.__super__.constructor.call(this,t,r)}return p(n,t),n}(e.QueryBuilder),e.Delete=function(t){function n(t,r){null==r&&(r=null),r||(r=[new e.StringBlock(t,"DELETE"),new e.TargetTableBlock(t),new e.FromTableBlock(o({},t,{singleTable:!0})),new e.JoinBlock(t),new e.WhereBlock(t),new e.OrderByBlock(t),new e.LimitBlock(t)]),n.__super__.constructor.call(this,t,r)}return p(n,t),n}(e.QueryBuilder)},o=function(){var t,e,n,r,i,o,s;if(t=arguments[0],n=2<=arguments.length?u.call(arguments,1):[])for(o=0,s=n.length;o<s;o++)if(r=n[o])for(e in r)a.call(r,e)&&(i=r[e],t[e]=i);return t},n.flavours.mssql=function(t){var e;return e=t.cls,e.DefaultQueryBuilderOptions.replaceSingleQuotes=!0,e.DefaultQueryBuilderOptions.autoQuoteAliasNames=!1,e.DefaultQueryBuilderOptions.numberedParametersPrefix="@",t.registerValueHandler(Date,function(t){return"'"+t.getUTCFullYear()+"-"+(t.getUTCMonth()+1)+"-"+t.getUTCDate()+" "+t.getUTCHours()+":"+t.getUTCMinutes()+":"+t.getUTCSeconds()+"'"}),e.MssqlLimitOffsetTopBlock=function(t){function n(t){n.__super__.constructor.call(this,t),this.limits=null,this.offsets=null}var r,i,o,s,l,u,a,h;return p(n,t),l=function(t){return t=this._sanitizeLimitOffset(t),this._parent.limits=t},o=function(t){function e(t){e.__super__.constructor.call(this,t.options),this._parent=t}return p(e,t),e}(e.Block),r=function(t){function e(){return u=e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.limit=l,e.prototype.buildStr=function(t){return this._parent.limits&&this._parent.offsets?"FETCH NEXT "+this._parent.limits+" ROWS ONLY":""},e}(o),s=function(t){function e(){return a=e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.top=l,e.prototype.buildStr=function(t){return this._parent.limits&&!this._parent.offsets?"TOP ("+this._parent.limits+")":""},e}(o),i=function(t){function e(){return this.offset=c(this.offset,this),h=e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.offset=function(t){return t=this._sanitizeLimitOffset(t),this._parent.offsets=t},e.prototype.buildStr=function(t){return this._parent.offsets?"OFFSET "+this._parent.offsets+" ROWS":""},e}(o),n.prototype.LIMIT=function(t){return this.constructor(t),new r(this)},n.prototype.TOP=function(t){return this.constructor(t),new s(this)},n.prototype.OFFSET=function(t){return this.constructor(t),new i(this)},n}.call(this,e.Block),e.MssqlUpdateTopBlock=function(t){function e(t){e.__super__.constructor.call(this,t),this.limits=null}var n;return p(e,t),n=function(t){return t=this._sanitizeLimitOffset(t),this.limits=t},e.prototype.limit=n,e.prototype.top=n,e.prototype.buildStr=function(t){return this.limits?"TOP ("+this.limits+")":""},e}(e.Block),e.MssqlInsertFieldValueBlock=function(t){function e(t){e.__super__.constructor.call(this,t),this.outputs=[]}return p(e,t),e.prototype.output=function(t){var e,n,r,i;if("string"==typeof t)return this.outputs.push("INSERTED."+this._sanitizeField(t));for(i=[],n=0,r=t.length;n<r;n++)e=t[n],i.push(this.outputs.push("INSERTED."+this._sanitizeField(e)));return i},e.prototype.buildStr=function(t){if(0>=this.fields.length)throw new Error("set() needs to be called");return"("+this.fields.join(", ")+") "+(0!==this.outputs.length?"OUTPUT "+this.outputs.join(", ")+" ":"")+"VALUES ("+this._buildVals().join("), (")+")"},e.prototype.buildParam=function(t){var e,n,r,i,o,s,l;if(0>=this.fields.length)throw new Error("set() needs to be called");for(r="",s=this._buildValParams(),i=s.vals,n=s.params,e=o=0,l=this.fields.length;0<=l?o<l:o>l;e=0<=l?++o:--o)""!==r&&(r+=", "),r+=this.fields[e];return{text:"("+r+") "+(0!==this.outputs.length?"OUTPUT "+this.outputs.join(", ")+" ":"")+"VALUES ("+i.join("), (")+")",values:n}},e}(e.InsertFieldValueBlock),e.MssqlUpdateDeleteOutputBlock=function(t){function e(t){e.__super__.constructor.call(this,t),this._outputs=[]}return p(e,t),e.prototype.outputs=function(t){var e,n,r;r=[];for(n in t)e=t[n],r.push(this.output(n,e));return r},e.prototype.output=function(t,e){return null==e&&(e=null),t=this._sanitizeField(t),e&&(e=this._sanitizeFieldAlias(e)),this._outputs.push({name:this.options.forDelete?"DELETED."+t:"INSERTED."+t,alias:e})},e.prototype.buildStr=function(t){var e,n,r,i,o;if(n="",this._outputs.length>0){for(o=this._outputs,r=0,i=o.length;r<i;r++)e=o[r],""!==n&&(n+=", "),n+=e.name,e.alias&&(n+=" AS "+e.alias);n="OUTPUT "+n}return n},e}(e.Block),e.Select=function(t){function n(t,r){var i;null==r&&(r=null),i=new e.MssqlLimitOffsetTopBlock(t),r||(r=[new e.StringBlock(t,"SELECT"),new e.DistinctBlock(t),i.TOP(t),new e.GetFieldBlock(t),new e.FromTableBlock(o({},t,{allowNested:!0})),new e.JoinBlock(o({},t,{allowNested:!0})),new e.WhereBlock(t),new e.GroupByBlock(t),new e.OrderByBlock(t),i.OFFSET(t),i.LIMIT(t),new e.UnionBlock(o({},t,{allowNested:!0}))]),n.__super__.constructor.call(this,t,r)}return p(n,t),n.prototype.isNestable=function(){return!0},n}(e.QueryBuilder),e.Update=function(t){function n(t,r){null==r&&(r=null),r||(r=[new e.StringBlock(t,"UPDATE"),new e.MssqlUpdateTopBlock(t),new e.UpdateTableBlock(t),new e.SetFieldBlock(t),new e.MssqlUpdateDeleteOutputBlock(t),new e.WhereBlock(t)]),n.__super__.constructor.call(this,t,r)}return p(n,t),n}(e.QueryBuilder),e.Delete=function(t){function n(t,r){null==r&&(r=null),r||(r=[new e.StringBlock(t,"DELETE"),new e.FromTableBlock(o({},t,{singleTable:!0})),new e.JoinBlock(t),new e.MssqlUpdateDeleteOutputBlock(o({},t,{forDelete:!0})),new e.WhereBlock(t),new e.OrderByBlock(t),new e.LimitBlock(t)]),n.__super__.constructor.call(this,t,r)}return p(n,t),n}(e.QueryBuilder),e.Insert=function(t){function n(t,r){null==r&&(r=null),r||(r=[new e.StringBlock(t,"INSERT"),new e.IntoTableBlock(t),new e.MssqlInsertFieldValueBlock(t),new e.InsertFieldsFromQueryBlock(t)]),n.__super__.constructor.call(this,t,r)}return p(n,t),n}(e.QueryBuilder)}}).call(this);