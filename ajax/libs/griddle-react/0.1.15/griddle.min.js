!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("React"),require("_")):"function"==typeof define&&define.amd?define(["React","_"],e):"object"==typeof exports?exports.Griddle=e(require("React"),require("_")):t.Griddle=e(t.React,t._)}(this,function(t,e){return function(t){function e(a){if(s[a])return s[a].exports;var o=s[a]={exports:{},id:a,loaded:!1};return t[a].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var s={};return e.m=t,e.c=s,e.p="/",e(0)}([function(t,e,s){var a=s(1),o=s(3),r=s(4),n=s(5),i=s(6),l=s(7),u=s(8),p=s(9),h=s(10),m=s(2),c=a.createClass({displayName:"Griddle",getDefaultProps:function(){return{columns:[],columnMetadata:[],resultsPerPage:5,results:[],getExternalResults:null,initialSort:"",gridClassName:"",tableClassName:"",customFormatClassName:"",settingsText:"Settings",filterPlaceholderText:"Filter Results",nextText:"Next",previousText:"Previous",maxRowsText:"Rows per page",enableCustomFormatText:"Enable Custom Formatting",childrenColumnName:"children",metadataColumns:[],showFilter:!1,showSettings:!1,useCustomFormat:!1,useCustomPager:!1,customFormat:{},customPager:{},allowToggleCustom:!1,noDataMessage:"There is no data to display.",customNoData:null,showTableHeading:!0,showPager:!0}},setFilter:function(t){if(t){var e=this,s={page:0,filter:t},a=function(t){t.maxPage=e.getMaxPage(t.filteredResults),e.setState(t)};this.hasExternalResults()?this.updateStateWithExternalResults(s,a):(s.filteredResults=m.filter(this.state.results,function(e){for(var s=m.values(e),a=0;a<s.length;a++)if((s[a]||"").toString().toLowerCase().indexOf(t.toLowerCase())>=0)return!0;return!1}),a(s))}else this.setState({filteredResults:null,filter:t,maxPage:this.getMaxPage(this.state.results)})},getExternalResults:function(t,e){var s,a,o,r;s=void 0!==t&&void 0!==t.filter?t.filter:this.state.filter,a=void 0!==t&&void 0!==t.sortColumn?t.sortColumn:this.state.sortColumn,o=void 0!==t&&void 0!==t.sortAscending?t.sortAscending:this.state.sortAscending,r=void 0!==t&&void 0!==t.page?t.page:this.state.page,this.props.getExternalResults(s,a,o,r,this.props.resultsPerPage,e)},updateStateWithExternalResults:function(t,e){var s=this;this.setState({isLoading:!0}),this.getExternalResults(t,function(a){t.results=a.results,t.totalResults=a.totalResults,t.maxPage=s.getMaxPage(a.results,t.totalResults),t.isLoading=!1,t.page>=t.maxPage&&(t.page=t.maxPage-1),e(t)})},hasExternalResults:function(){return"function"==typeof this.props.getExternalResults},setPageSize:function(t){this.props.resultsPerPage=t,this.setMaxPage()},toggleColumnChooser:function(){this.setState({showColumnChooser:0==this.state.showColumnChooser})},toggleCustomFormat:function(){this.setProps({useCustomFormat:0==this.props.useCustomFormat})},getMaxPage:function(t,e){e||(e=this.hasExternalResults()?this.state.totalResults:(t||this.state.filteredResults||this.state.results).length);var s=Math.ceil(e/this.props.resultsPerPage);return s},setMaxPage:function(t){var e=this.getMaxPage(t);this.state.maxPage!=e&&this.setState({maxPage:e,filteredColumns:this.props.columns})},setPage:function(t){if(t*this.props.resultsPerPage<=this.props.resultsPerPage*this.state.maxPage){var e=this,s={page:t};this.hasExternalResults()?this.updateStateWithExternalResults(s,function(t){e.setState(t)}):e.setState(s)}},getColumns:function(){var t=this;if(void 0===this.state.results||0==this.state.results.length)return[];var e=this.state.filteredColumns;if(0==this.state.filteredColumns.length){var s=[].concat(this.props.metadataColumns);s.indexOf(this.props.childrenColumnName)<0&&s.push(this.props.childrenColumnName),e=m.keys(m.omit(this.state.results[0],s))}return e=m.sortBy(e,function(e){var s=m.findWhere(t.props.columnMetadata,{columnName:e});return"undefined"==typeof s||null===s||isNaN(s.order)?100:s.order})},setColumns:function(t){t=m.isArray(t)?t:[t],this.setState({filteredColumns:t})},nextPage:function(){this.state.page<this.state.maxPage-1&&this.setPage(this.state.page+1)},previousPage:function(){this.state.page>0&&this.setPage(this.state.page-1)},changeSort:function(t){var e=this,s={page:0,sortColumn:t,sortAscending:!0};this.state.sortColumn==t&&(s.sortAscending=0==this.state.sortAscending),this.hasExternalResults()?this.updateStateWithExternalResults(s,function(t){e.setState(t)}):this.setState(s)},componentWillReceiveProps:function(t){if(this.hasExternalResults()){var e=this.state,s=this;e=this.updateStateWithExternalResults(e,function(t){s.setState(t)})}else this.setMaxPage(t.results)},getInitialState:function(){var t={maxPage:0,page:0,filteredResults:null,filteredColumns:[],filter:"",sortColumn:"",sortAscending:!0,showColumnChooser:!1,isLoading:!1};return this.hasExternalResults()?t.isLoading=!0:t.results=this.props.results,t},componentWillMount:function(){this.hasExternalResults()||this.setMaxPage()},componentDidMount:function(){var t=this.state,e=this;this.hasExternalResults()&&(t=this.updateStateWithExternalResults(t,function(t){e.setState(t),e.setMaxPage()}))},getDataForRender:function(t,e,s){var a=this;if(!this.hasExternalResults()&&(""==this.state.sortColumn&&""==this.props.initialSort||(t=m.sortBy(t,function(t){return t[a.state.sortColumn||a.props.initialSort]}),0==this.state.sortAscending&&t.reverse()),s&&this.props.resultsPerPage*(this.state.page+1)<=this.props.resultsPerPage*this.state.maxPage&&this.state.page>=0)){var o=m.rest(t,this.state.page*this.props.resultsPerPage);t=m.initial(o,o.length-this.props.resultsPerPage)}var r=[].concat(this.props.metadataColumns);r.indexOf(this.props.childrenColumnName)<0&&r.push(this.props.childrenColumnName);for(var n=[],i=0;i<t.length;i++){var l=m.pick(t[i],e.concat(r));"undefined"!=typeof l[a.props.childrenColumnName]&&l[a.props.childrenColumnName].length>0&&(l.children=a.getDataForRender(l[a.props.childrenColumnName],e,!1),"children"!==a.props.childrenColumnName&&delete l[a.props.childrenColumnName]),n.push(l)}return n},render:function(){var t=this,e=this.state.filteredResults||this.state.results,s=this.props.tableClassName+" table-header",c=this.props.showFilter?r({changeFilter:this.setFilter,placeholderText:this.props.filterPlaceholderText}):"",d=this.props.showSettings?a.DOM.span({className:"settings",onClick:this.toggleColumnChooser},this.props.settingsText," ",a.DOM.i({className:"glyphicon glyphicon-cog"})):"",g="";(this.props.showFilter||this.props.showSettings)&&(g=a.DOM.div({className:"row top-section"},a.DOM.div({className:"col-xs-6"},c),a.DOM.div({className:"col-xs-6 right"},d)));var f="",C="",x=[],v=this.getColumns();if(this.state.isLoading)f=a.DOM.div({className:"loading img-responsive center-block"});else{var P=this.getDataForRender(e,v,!0),M=this.props.metadataColumns;M.indexOf(this.props.childrenColumnName)<0&&M.push(this.props.childrenColumnName),x=m.keys(m.omit(e[0],M)),f=this.props.useCustomFormat?p({data:P,columns:v,metadataColumns:M,className:this.props.customFormatClassName,customFormat:this.props.customFormat}):o({columnMetadata:this.props.columnMetadata,data:P,columns:v,metadataColumns:M,className:this.props.tableClassName}),C=this.props.useCustomPager?h({next:this.nextPage,previous:this.previousPage,currentPage:this.state.page,maxPage:this.state.maxPage,setPage:this.setPage,nextText:this.props.nextText,previousText:this.props.previousText,customPager:this.props.customPager}):n({next:this.nextPage,previous:this.previousPage,currentPage:this.state.page,maxPage:this.state.maxPage,setPage:this.setPage,nextText:this.props.nextText,previousText:this.props.previousText})}var N=this.state.showColumnChooser?a.DOM.div({className:"row"},a.DOM.div({className:"col-md-12"},i({columns:x,selectedColumns:v,setColumns:this.setColumns,settingsText:this.props.settingsText,maxRowsText:this.props.maxRowsText,setPageSize:this.setPageSize,resultsPerPage:this.props.resultsPerPage,allowToggleCustom:this.props.allowToggleCustom,toggleCustomFormat:this.toggleCustomFormat,useCustomFormat:this.props.useCustomFormat,enableCustomFormatText:this.props.enableCustomFormatText,columnMetadata:this.props.columnMetadata}))):"",D=this.props.gridClassName.length>0?"griddle "+this.props.gridClassName:"griddle";D+=this.props.useCustomFormat?" griddle-custom":"";var O=this.props.useCustomFormat?a.DOM.div(null,f):a.DOM.div({className:"grid-body"},this.props.showTableHeading?a.DOM.table({className:s},l({columns:v,changeSort:this.changeSort,sortColumn:this.state.sortColumn,sortAscending:this.state.sortAscending,columnMetadata:this.props.columnMetadata})):"",f);if("undefined"==typeof this.state.results||0==this.state.results.length){if(null!=this.props.customNoData){var y=a.DOM.div({className:D},this.props.customNoData(null));return y}var y=a.DOM.div({className:D},u({noDataMessage:this.props.noDataMessage}));return y}return a.DOM.div({className:D},g,N,a.DOM.div({className:"grid-container panel"},O,t.props.showPager?a.DOM.div({className:"grid-footer clearfix"},C):""))}});t.exports=c},function(e,s,a){e.exports=t},function(t,s,a){t.exports=e},function(t,e,s){var a=s(1),o=s(11),r=a.createClass({displayName:"GridBody",getDefaultProps:function(){return{data:[],metadataColumns:[],className:""}},render:function(){var t=this,e=this.props.data.map(function(e,s){return o({data:e,metadataColumns:t.props.metadataColumns,columnMetadata:t.props.columnMetadata,key:s})});return a.DOM.table({className:this.props.className},e)}});t.exports=r},function(t,e,s){var a=s(1),o=a.createClass({displayName:"GridFilter",getDefaultProps:function(){return{placeholderText:""}},handleChange:function(t){this.props.changeFilter(t.target.value)},render:function(){return a.DOM.div({className:"row filter-container"},a.DOM.div({className:"col-md-6"},a.DOM.input({type:"text",name:"filter",placeholder:this.props.placeholderText,className:"form-control",onChange:this.handleChange})))}});t.exports=o},function(t,e,s){var a=s(1),o=a.createClass({displayName:"GridPagination",getDefaultProps:function(){return{maxPage:0,nextText:"",previousText:"",currentPage:0}},pageChange:function(t){this.props.setPage(parseInt(t.target.value)-1)},render:function(){var t="",e="";this.props.currentPage>0&&(t=a.DOM.span({onClick:this.props.previous,className:"previous"},a.DOM.i({className:"glyphicon glyphicon-chevron-left"}),this.props.previousText)),this.props.currentPage!=this.props.maxPage-1&&(e=a.DOM.span({onClick:this.props.next,className:"next"},this.props.nextText,a.DOM.i({className:"glyphicon glyphicon-chevron-right"})));for(var s=[],o=1;o<=this.props.maxPage;o++)s.push(a.DOM.option({value:o,key:o},o));return a.DOM.div({className:"row"},a.DOM.div({className:"col-xs-4"},t),a.DOM.div({className:"col-xs-4 center"},a.DOM.select({value:this.props.currentPage+1,onChange:this.pageChange},s)," / ",this.props.maxPage),a.DOM.div({className:"col-xs-4 right"},e))}});t.exports=o},function(t,e,s){var a=s(1),o=s(2),r=a.createClass({displayName:"GridSettings",getDefaultProps:function(){return{columns:[],columnMetadata:[],selectedColumns:[],settingsText:"",maxRowsText:"",resultsPerPage:0,allowToggleCustom:!1,useCustomFormat:!1,toggleCustomFormat:function(){}}},setPageSize:function(t){var e=parseInt(t.target.value);this.props.setPageSize(e)},handleChange:function(t){1==t.target.checked&&0==o.contains(this.props.selectedColumns,t.target.dataset.name)?(this.props.selectedColumns.push(t.target.dataset.name),this.props.setColumns(this.props.selectedColumns)):this.props.setColumns(o.without(this.props.selectedColumns,t.target.dataset.name))},render:function(){var t=this,e=[];t.props.useCustomFormat===!1&&(e=this.props.columns.map(function(e,s){var r=o.contains(t.props.selectedColumns,e),n=o.findWhere(t.props.columnMetadata,{columnName:e});return"undefined"!=typeof n&&null!=n&&n.locked?a.DOM.div({className:"column checkbox"},a.DOM.label(null,a.DOM.input({type:"checkbox",disabled:!0,name:"check",checked:r,"data-name":e}),e)):a.DOM.div({className:"column checkbox"},a.DOM.label(null,a.DOM.input({type:"checkbox",name:"check",onChange:t.handleChange,checked:r,"data-name":e}),e))}));var s=t.props.allowToggleCustom?a.DOM.div({className:"form-group"},a.DOM.label({for:"maxRows"},this.props.enableCustomFormatText,":"),a.DOM.input({type:"checkbox",checked:this.props.useCustomFormat,onChange:this.props.toggleCustomFormat})):"";return a.DOM.div({className:"griddle-settings panel"},a.DOM.h5(null,this.props.settingsText),a.DOM.div({className:"container-fluid griddle-columns"},a.DOM.div({className:"row"},e)),a.DOM.div({class:"form-group"},a.DOM.label({for:"maxRows"},this.props.maxRowsText,":"),a.DOM.select({class:"form-control",onChange:this.setPageSize,value:this.props.resultsPerPage},a.DOM.option({value:"5"},"5"),a.DOM.option({value:"10"},"10"),a.DOM.option({value:"25"},"25"),a.DOM.option({value:"50"},"50"),a.DOM.option({value:"100"},"100"))),s)}});t.exports=r},function(t,e,s){var a=s(1),o=s(2),r=a.createClass({displayName:"GridTitle",getDefaultProps:function(){return{columns:[],sortColumn:"",sortAscending:!0}},sort:function(t){this.props.changeSort(t.target.dataset.title)},render:function(){var t=this,e=this.props.columns.map(function(e,s){var r="";t.props.sortColumn==e&&t.props.sortAscending?r="sort-ascending":t.props.sortColumn==e&&0==t.props.sortAscending&&(r+="sort-descending");var n=e;if(null!=t.props.columnMetadata){var i=o.findWhere(t.props.columnMetadata,{columnName:e});r=null==i?r:(r&&r+" "||r)+i.cssClassName,"undefined"!=typeof i&&"undefined"!=typeof i.displayName&&null!=i.displayName&&(n=i.displayName)}return a.DOM.th({onClick:t.sort,"data-title":e,className:r,key:n},n)});return a.DOM.thead(null,a.DOM.tr(null,e))}});t.exports=r},function(t,e,s){var a=s(1),o=a.createClass({displayName:"GridNoData",getDefaultProps:function(){return{noDataMessage:"No Data"}},render:function(){return a.DOM.div(null,this.props.noDataMessage)}});t.exports=o},function(t,e,s){var a=s(1),o=a.createClass({displayName:"CustomFormatContainer",getDefaultProps:function(){return{data:[],metadataColumns:[],className:"",customFormat:{}}},render:function(){var t=this;if("function"!=typeof t.props.customFormat)return console.log("Couldn't find valid template."),a.DOM.div({className:this.props.className});var e=this.props.data.map(function(e,s){return t.props.customFormat({data:e,metadataColumns:t.props.metadataColumns,key:s})});return a.DOM.div({className:this.props.className},e)}});t.exports=o},function(t,e,s){var a=s(1),o=a.createClass({displayName:"CustomPaginationContainer",getDefaultProps:function(){return{maxPage:0,nextText:"",previousText:"",currentPage:0,customPager:{}}},render:function(){var t=this;return"function"!=typeof t.props.customPager?(console.log("Couldn't find valid template."),a.DOM.div(null)):t.props.customPager({maxPage:this.props.maxPage,nextText:this.props.nextText,previousText:this.props.previousText,currentPage:this.props.currentPage,setPage:this.props.setPage,previous:this.props.previous,next:this.props.next})}});t.exports=o},function(t,e,s){var a=s(1),o=s(12),r=a.createClass({displayName:"GridRowContainer",getInitialState:function(){return{data:{},metadataColumns:[]}},toggleChildren:function(){this.setState({showChildren:0==this.state.showChildren})},getInitialState:function(){return{showChildren:!1}},render:function(){var t=this;if("undefined"==typeof this.props.data)return a.DOM.tbody(null);var e=[],s="undefined"!=typeof this.props.data.children&&this.props.data.children.length>0;if(e.push(o({data:this.props.data,columnMetadata:this.props.columnMetadata,metadataColumns:t.props.metadataColumns,hasChildren:s,toggleChildren:t.toggleChildren,showChildren:t.state.showChildren,key:0})),t.state.showChildren)var r=s&&this.props.data.children.map(function(e,s){return"undefined"!=typeof e.children?a.DOM.tr(null,a.DOM.td({colSpan:Object.keys(t.props.data).length-t.props.metadataColumns.length,className:"griddle-parent"},Griddle({results:[e],tableClassName:"table",showTableHeading:!1,showPager:!1,columnMetadata:t.props.columnMetadata}))):o({data:e,metadataColumns:t.props.metadataColumns,isChildRow:!0,columnMetadata:t.props.columnMetadata})});return a.DOM.tbody(null,t.state.showChildren?e.concat(r):e)}});t.exports=r},function(t,e,s){var a=s(1),o=s(2),r=a.createClass({displayName:"GridRow",getDefaultProps:function(){return{isChildRow:!1,showChildren:!1,data:{},metadataColumns:[],hasChildren:!1,columnMetadata:null}},handleClick:function(){this.props.toggleChildren()},render:function(){var t=this,e=null,s=o.pairs(o.omit(this.props.data,this.props.metadataColumns)).map(function(s,r){if(null!=t.props.columnMetadata&&t.props.columnMetadata.length>0){var n=o.findWhere(t.props.columnMetadata,{columnName:s[0]}),i="undefined"==typeof n||"undefined"==typeof n.customComponent||null===n.customComponent?s[1]:n.customComponent({data:s[1]});e=null==n?e:a.DOM.td({onClick:t.handleClick,className:n.cssClassName,key:r},i)}return e||a.DOM.td({onClick:t.handleClick,key:r},s[1])}),r="standard-row";return t.props.isChildRow?r="child-row":t.props.hasChildren&&(r=t.props.showChildren?"parent-row expanded":"parent-row"),a.DOM.tr({className:r},s)}});t.exports=r}])});
//# sourceMappingURL=griddle.min.js.map