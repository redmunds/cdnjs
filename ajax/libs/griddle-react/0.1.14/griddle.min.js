!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("React"),require("_")):"function"==typeof define&&define.amd?define(["React","_"],t):"object"==typeof exports?exports.Griddle=t(require("React"),require("_")):e.Griddle=t(e.React,e._)}(this,function(e,t){return function(e){function t(a){if(s[a])return s[a].exports;var r=s[a]={exports:{},id:a,loaded:!1};return e[a].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var s={};return t.m=e,t.c=s,t.p="/",t(0)}([function(e,t,s){var a=s(1),r=s(3),o=s(4),n=s(5),l=s(6),i=s(7),u=s(8),p=s(9),c=s(10),m=s(2),h=a.createClass({displayName:"Griddle",getDefaultProps:function(){return{columns:[],columnMetadata:[],resultsPerPage:5,results:[],getExternalResults:null,initialSort:"",gridClassName:"",tableClassName:"",customFormatClassName:"",settingsText:"Settings",filterPlaceholderText:"Filter Results",nextText:"Next",previousText:"Previous",maxRowsText:"Rows per page",enableCustomFormatText:"Enable Custom Formatting",childrenColumnName:"children",metadataColumns:[],showFilter:!1,showSettings:!1,useCustomFormat:!1,useCustomPager:!1,customFormat:{},customPager:{},allowToggleCustom:!1,noDataMessage:"There is no data to display.",customNoData:null,showTableHeading:!0,showPager:!0}},setFilter:function(e){if(e){var t=this,s={page:0,filter:e},a=function(e){e.maxPage=t.getMaxPage(e.filteredResults),t.setState(e)};this.hasExternalResults()?this.updateStateWithExternalResults(s,a):(s.filteredResults=m.filter(this.state.results,function(t){for(var s=m.values(t),a=0;a<s.length;a++)if((s[a]||"").toString().toLowerCase().indexOf(e.toLowerCase())>=0)return!0;return!1}),a(s))}else this.setState({filteredResults:null,filter:e,maxPage:this.getMaxPage(null)})},getExternalResults:function(e,t){var s,a,r,o;s=void 0!==e&&void 0!==e.filter?e.filter:this.state.filter,a=void 0!==e&&void 0!==e.sortColumn?e.sortColumn:this.state.sortColumn,r=void 0!==e&&void 0!==e.sortAscending?e.sortAscending:this.state.sortAscending,o=void 0!==e&&void 0!==e.page?e.page:this.state.page,this.props.getExternalResults(s,a,r,o,this.props.resultsPerPage,t)},updateStateWithExternalResults:function(e,t){var s=this;this.setState({isLoading:!0}),this.getExternalResults(e,function(a){e.results=a.results,e.totalResults=a.totalResults,e.maxPage=s.getMaxPage(a.results,e.totalResults),e.isLoading=!1,e.page>=e.maxPage&&(e.page=e.maxPage-1),t(e)})},hasExternalResults:function(){return"function"==typeof this.props.getExternalResults},setPageSize:function(e){this.props.resultsPerPage=e,this.setMaxPage()},toggleColumnChooser:function(){this.setState({showColumnChooser:0==this.state.showColumnChooser})},toggleCustomFormat:function(){this.setProps({useCustomFormat:0==this.props.useCustomFormat})},getMaxPage:function(e,t){t||(t=this.hasExternalResults()?this.state.totalResults:(e||this.state.filteredResults||this.state.results).length);var s=Math.ceil(t/this.props.resultsPerPage);return s},setMaxPage:function(e){var t=this.getMaxPage(e);this.state.maxPage!=t&&this.setState({maxPage:t,filteredColumns:this.props.columns})},setPage:function(e){if(e*this.props.resultsPerPage<=this.props.resultsPerPage*this.state.maxPage){var t=this,s={page:e};this.hasExternalResults()?this.updateStateWithExternalResults(s,function(e){t.setState(e)}):t.setState(s)}},getColumns:function(){var e=this;if(void 0===this.state.results||0==this.state.results.length)return[];var t=this.state.filteredColumns;if(0==this.state.filteredColumns.length){var s=[].concat(this.props.metadataColumns);s.push(this.props.childrenColumnName),t=m.keys(m.omit(this.state.results[0],s))}return t=m.sortBy(t,function(t){var s=m.findWhere(e.props.columnMetadata,{columnName:t});return"undefined"==typeof s||null===s||isNaN(s.order)?100:s.order})},setColumns:function(e){e=m.isArray(e)?e:[e],this.setState({filteredColumns:e})},nextPage:function(){this.state.page<this.state.maxPage-1&&this.setPage(this.state.page+1)},previousPage:function(){this.state.page>0&&this.setPage(this.state.page-1)},changeSort:function(e){var t=this,s={page:0,sortColumn:e,sortAscending:!0};this.state.sortColumn==e&&(s.sortAscending=0==this.state.sortAscending),this.hasExternalResults()?this.updateStateWithExternalResults(s,function(e){t.setState(e)}):this.setState(s)},componentWillReceiveProps:function(e){if(this.hasExternalResults()){var t=this.state,s=this;t=this.updateStateWithExternalResults(t,function(e){s.setState(e)})}else this.setMaxPage(e.results)},getInitialState:function(){var e={maxPage:0,page:0,filteredResults:null,filteredColumns:[],filter:"",sortColumn:"",sortAscending:!0,showColumnChooser:!1,isLoading:!1};return this.hasExternalResults()?e.isLoading=!0:e.results=this.props.results,e},componentWillMount:function(){this.hasExternalResults()||this.setMaxPage()},componentDidMount:function(){var e=this.state,t=this;this.hasExternalResults()&&(e=this.updateStateWithExternalResults(e,function(e){t.setState(e),t.setMaxPage()}))},getDataForRender:function(e,t,s){var a=this;if(!this.hasExternalResults()&&(""==this.state.sortColumn&&""==this.props.initialSort||(e=m.sortBy(e,function(e){return e[a.state.sortColumn||a.props.initialSort]}),0==this.state.sortAscending&&e.reverse()),s&&this.props.resultsPerPage*(this.state.page+1)<=this.props.resultsPerPage*this.state.maxPage&&this.state.page>=0)){var r=m.rest(e,this.state.page*this.props.resultsPerPage);e=m.initial(r,r.length-this.props.resultsPerPage)}var o=[].concat(this.props.metadataColumns);o.push(this.props.childrenColumnName);for(var n=[],l=0;l<e.length;l++){var i=m.pick(e[l],t.concat(o));"undefined"!=typeof i[a.props.childrenColumnName]&&i[a.props.childrenColumnName].length>0&&(i.children=a.getDataForRender(i[a.props.childrenColumnName],t,!1),"children"!==a.props.childrenColumnName&&delete i[a.props.childrenColumnName]),n.push(i)}return n},render:function(){var e=this,t=this.state.filteredResults||this.state.results,s=this.props.tableClassName+" table-header",h=this.props.showFilter?a.createElement(o,{changeFilter:this.setFilter,placeholderText:this.props.filterPlaceholderText}):"",d=this.props.showSettings?a.createElement("span",{className:"settings",onClick:this.toggleColumnChooser},this.props.settingsText," ",a.createElement("i",{className:"glyphicon glyphicon-cog"})):"",g="";(this.props.showFilter||this.props.showSettings)&&(g=a.createElement("div",{className:"row top-section"},a.createElement("div",{className:"col-xs-6"},h),a.createElement("div",{className:"col-xs-6 right"},d)));var f="",C="",x=[],v=this.getColumns();if(this.state.isLoading)f=a.createElement("div",{className:"loading img-responsive center-block"});else{var P=this.getDataForRender(t,v,!0),E=this.props.metadataColumns;E.push(this.props.childrenColumnName),x=m.keys(m.omit(t[0],E)),f=this.props.useCustomFormat?a.createElement(p,{data:P,columns:v,metadataColumns:E,className:this.props.customFormatClassName,customFormat:this.props.customFormat}):a.createElement(r,{columnMetadata:this.props.columnMetadata,data:P,columns:v,metadataColumns:E,className:this.props.tableClassName}),C=this.props.useCustomPager?a.createElement(c,{next:this.nextPage,previous:this.previousPage,currentPage:this.state.page,maxPage:this.state.maxPage,setPage:this.setPage,nextText:this.props.nextText,previousText:this.props.previousText,customPager:this.props.customPager}):a.createElement(n,{next:this.nextPage,previous:this.previousPage,currentPage:this.state.page,maxPage:this.state.maxPage,setPage:this.setPage,nextText:this.props.nextText,previousText:this.props.previousText})}var N=this.state.showColumnChooser?a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-12"},a.createElement(l,{columns:x,selectedColumns:v,setColumns:this.setColumns,settingsText:this.props.settingsText,maxRowsText:this.props.maxRowsText,setPageSize:this.setPageSize,resultsPerPage:this.props.resultsPerPage,allowToggleCustom:this.props.allowToggleCustom,toggleCustomFormat:this.toggleCustomFormat,useCustomFormat:this.props.useCustomFormat,enableCustomFormatText:this.props.enableCustomFormatText,columnMetadata:this.props.columnMetadata}))):"",w=this.props.gridClassName.length>0?"griddle "+this.props.gridClassName:"griddle";w+=this.props.useCustomFormat?" griddle-custom":"";var y=this.props.useCustomFormat?a.createElement("div",null,f):a.createElement("div",{className:"grid-body"},this.props.showTableHeading?a.createElement("table",{className:s},a.createElement(i,{columns:v,changeSort:this.changeSort,sortColumn:this.state.sortColumn,sortAscending:this.state.sortAscending,columnMetadata:this.props.columnMetadata})):"",f);if("undefined"==typeof this.state.results||0==this.state.results.length){if(null!=this.props.customNoData){var R=a.createElement("div",{className:w},a.createElement(this.props.customNoData,null));return R}var R=a.createElement("div",{className:w},a.createElement(u,{noDataMessage:this.props.noDataMessage}));return R}return a.createElement("div",{className:w},g,N,a.createElement("div",{className:"grid-container panel"},y,e.props.showPager?a.createElement("div",{className:"grid-footer clearfix"},C):""))}});e.exports=h},function(t,s,a){t.exports=e},function(e,s,a){e.exports=t},function(e,t,s){var a=s(1),r=s(11),o=a.createClass({displayName:"GridBody",getDefaultProps:function(){return{data:[],metadataColumns:[],className:""}},render:function(){var e=this,t=this.props.data.map(function(t,s){return a.createElement(r,{data:t,metadataColumns:e.props.metadataColumns,columnMetadata:e.props.columnMetadata})});return a.createElement("table",{className:this.props.className},t)}});e.exports=o},function(e,t,s){var a=s(1),r=a.createClass({displayName:"GridFilter",getDefaultProps:function(){return{placeholderText:""}},handleChange:function(e){this.props.changeFilter(e.target.value)},render:function(){return a.createElement("div",{className:"row filter-container"},a.createElement("div",{className:"col-md-6"},a.createElement("input",{type:"text",name:"filter",placeholder:this.props.placeholderText,className:"form-control",onChange:this.handleChange})))}});e.exports=r},function(e,t,s){var a=s(1),r=a.createClass({displayName:"GridPagination",getDefaultProps:function(){return{maxPage:0,nextText:"",previousText:"",currentPage:0}},pageChange:function(e){this.props.setPage(parseInt(e.target.value)-1)},render:function(){var e="",t="";this.props.currentPage>0&&(e=a.createElement("span",{onClick:this.props.previous,className:"previous"},a.createElement("i",{className:"glyphicon glyphicon-chevron-left"}),this.props.previousText)),this.props.currentPage!=this.props.maxPage-1&&(t=a.createElement("span",{onClick:this.props.next,className:"next"},this.props.nextText,a.createElement("i",{className:"glyphicon glyphicon-chevron-right"})));for(var s=[],r=1;r<=this.props.maxPage;r++)s.push(a.createElement("option",{value:r},r));return a.createElement("div",{className:"row"},a.createElement("div",{className:"col-xs-4"},e),a.createElement("div",{className:"col-xs-4 center"},a.createElement("select",{value:this.props.currentPage+1,onChange:this.pageChange},s)," / ",this.props.maxPage),a.createElement("div",{className:"col-xs-4 right"},t))}});e.exports=r},function(e,t,s){var a=s(1),r=s(2),o=a.createClass({displayName:"GridSettings",getDefaultProps:function(){return{columns:[],columnMetadata:[],selectedColumns:[],settingsText:"",maxRowsText:"",resultsPerPage:0,allowToggleCustom:!1,useCustomFormat:!1,toggleCustomFormat:function(){}}},setPageSize:function(e){var t=parseInt(e.target.value);this.props.setPageSize(t)},handleChange:function(e){1==e.target.checked&&0==r.contains(this.props.selectedColumns,e.target.dataset.name)?(this.props.selectedColumns.push(e.target.dataset.name),this.props.setColumns(this.props.selectedColumns)):this.props.setColumns(r.without(this.props.selectedColumns,e.target.dataset.name))},render:function(){var e=this,t=[];e.props.useCustomFormat===!1&&(t=this.props.columns.map(function(t,s){var o=r.contains(e.props.selectedColumns,t),n=r.findWhere(e.props.columnMetadata,{columnName:t});return"undefined"!=typeof n&&null!=n&&n.locked?a.createElement("div",{className:"column checkbox"},a.createElement("label",null,a.createElement("input",{type:"checkbox",disabled:!0,name:"check",checked:o,"data-name":t}),t)):a.createElement("div",{className:"column checkbox"},a.createElement("label",null,a.createElement("input",{type:"checkbox",name:"check",onChange:e.handleChange,checked:o,"data-name":t}),t))}));var s=e.props.allowToggleCustom?a.createElement("div",{className:"form-group"},a.createElement("label",{for:"maxRows"},this.props.enableCustomFormatText,":"),a.createElement("input",{type:"checkbox",checked:this.props.useCustomFormat,onChange:this.props.toggleCustomFormat})):"";return a.createElement("div",{className:"griddle-settings panel"},a.createElement("h5",null,this.props.settingsText),a.createElement("div",{className:"container-fluid griddle-columns"},a.createElement("div",{className:"row"},t)),a.createElement("div",{class:"form-group"},a.createElement("label",{for:"maxRows"},this.props.maxRowsText,":"),a.createElement("select",{class:"form-control",onChange:this.setPageSize,value:this.props.resultsPerPage},a.createElement("option",{value:"5"},"5"),a.createElement("option",{value:"10"},"10"),a.createElement("option",{value:"25"},"25"),a.createElement("option",{value:"50"},"50"),a.createElement("option",{value:"100"},"100"))),s)}});e.exports=o},function(e,t,s){var a=s(1),r=s(2),o=a.createClass({displayName:"GridTitle",getDefaultProps:function(){return{columns:[],sortColumn:"",sortAscending:!0}},sort:function(e){this.props.changeSort(e.target.dataset.title)},render:function(){var e=this,t=this.props.columns.map(function(t,s){var o="";e.props.sortColumn==t&&e.props.sortAscending?o="sort-ascending":e.props.sortColumn==t&&0==e.props.sortAscending&&(o+="sort-descending");var n=t;if(null!=e.props.columnMetadata){var l=r.findWhere(e.props.columnMetadata,{columnName:t});o=null==l?o:(o&&o+" "||o)+l.cssClassName,"undefined"!=typeof l&&"undefined"!=typeof l.displayName&&null!=l.displayName&&(n=l.displayName)}return a.createElement("th",{onClick:e.sort,"data-title":t,className:o},n)});return a.createElement("thead",null,a.createElement("tr",null,t))}});e.exports=o},function(e,t,s){var a=s(1),r=a.createClass({displayName:"GridNoData",getDefaultProps:function(){return{noDataMessage:"No Data"}},render:function(){return a.createElement("div",null,this.props.noDataMessage)}});e.exports=r},function(e,t,s){var a=s(1),r=a.createClass({displayName:"CustomFormatContainer",getDefaultProps:function(){return{data:[],metadataColumns:[],className:"",customFormat:{}}},render:function(){var e=this;if("function"!=typeof e.props.customFormat)return console.log("Couldn't find valid template."),a.createElement("div",{className:this.props.className});var t=this.props.data.map(function(t,s){return a.createElement(e.props.customFormat,{data:t,metadataColumns:e.props.metadataColumns})});return a.createElement("div",{className:this.props.className},t)}});e.exports=r},function(e,t,s){var a=s(1),r=a.createClass({displayName:"CustomPaginationContainer",getDefaultProps:function(){return{maxPage:0,nextText:"",previousText:"",currentPage:0,customPager:{}}},render:function(){var e=this;return"function"!=typeof e.props.customPager?(console.log("Couldn't find valid template."),a.createElement("div",null)):a.createElement(e.props.customPager,{maxPage:this.props.maxPage,nextText:this.props.nextText,previousText:this.props.previousText,currentPage:this.props.currentPage,setPage:this.props.setPage,previous:this.props.previous,next:this.props.next})}});e.exports=r},function(e,t,s){var a=s(1),r=s(12),o=a.createClass({displayName:"GridRowContainer",getInitialState:function(){return{data:{},metadataColumns:[]}},toggleChildren:function(){this.setState({showChildren:0==this.state.showChildren})},getInitialState:function(){return{showChildren:!1}},render:function(){var e=this;if("undefined"==typeof this.props.data)return a.createElement("tbody",null);var t=[],s="undefined"!=typeof this.props.data.children&&this.props.data.children.length>0;if(t.push(a.createElement(r,{data:this.props.data,columnMetadata:this.props.columnMetadata,metadataColumns:e.props.metadataColumns,hasChildren:s,toggleChildren:e.toggleChildren,showChildren:e.state.showChildren})),e.state.showChildren)var o=s&&this.props.data.children.map(function(t,s){return"undefined"!=typeof t.children?a.createElement("tr",null,a.createElement("td",{colSpan:Object.keys(e.props.data).length-e.props.metadataColumns.length,className:"griddle-parent"},a.createElement(Griddle,{results:[t],tableClassName:"table",showTableHeading:!1,showPager:!1,columnMetadata:e.props.columnMetadata}))):a.createElement(r,{data:t,metadataColumns:e.props.metadataColumns,isChildRow:!0,columnMetadata:e.props.columnMetadata})});return a.createElement("tbody",null,e.state.showChildren?t.concat(o):t)}});e.exports=o},function(e,t,s){var a=s(1),r=s(2),o=a.createClass({displayName:"GridRow",getDefaultProps:function(){return{isChildRow:!1,showChildren:!1,data:{},metadataColumns:[],hasChildren:!1,columnMetadata:null}},handleClick:function(){this.props.toggleChildren()},render:function(){var e=this,t=null,s=r.pairs(r.omit(this.props.data,this.props.metadataColumns)).map(function(s,o){if(null!=e.props.columnMetadata&&e.props.columnMetadata.length>0){var n=r.findWhere(e.props.columnMetadata,{columnName:s[0]}),l="undefined"==typeof n||"undefined"==typeof n.customComponent||null===n.customComponent?s[1]:a.createElement(n.customComponent,{data:s[1]});t=null==n?t:a.createElement("td",{onClick:e.handleClick,className:n.cssClassName},l)}return t||a.createElement("td",{onClick:e.handleClick},s[1])}),o="standard-row";return e.props.isChildRow?o="child-row":e.props.hasChildren&&(o=e.props.showChildren?"parent-row expanded":"parent-row"),a.createElement("tr",{className:o},s)}});e.exports=o}])});
//# sourceMappingURL=griddle.min.js.map