/*!
 * chartjs-plugin-annotation.js
 * http://chartjs.org/
 * Version: 0.5.0
 *
 * Copyright 2016 Evert Timberg
 * Released under the MIT license
 * https://github.com/chartjs/Chart.Annotation.js/blob/master/LICENSE.md
 */
!function t(e,n,i){function a(r,l){if(!n[r]){if(!e[r]){var s="function"==typeof require&&require;if(!l&&s)return s(r,!0);if(o)return o(r,!0);var c=new Error("Cannot find module '"+r+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[r]={exports:{}};e[r][0].call(u.exports,function(t){var n=e[r][1][t];return a(n?n:t)},u,u.exports,t,e,n,i)}return n[r].exports}for(var o="function"==typeof require&&require,r=0;r<i.length;r++)a(i[r]);return a}({1:[function(t,e,n){},{}],2:[function(t,e,n){e.exports=function(t){var e=t.Element.extend({initialize:function(){this.hidden=!1,this.setDataLimits()},destroy:function(){},setDataLimits:function(){},configure:function(){},inRange:function(){},getCenterPoint:function(){},getWidth:function(){},getHeight:function(){},getArea:function(){},draw:function(){}});return e}},{}],3:[function(t,e,n){function i(t){return!isNaN(t)&&isFinite(t)}function a(t,e,n){var i="$";t[i+e]||(t[i+e]=t[e].bind(t),t[e]=function(){return n(t[i+e])})}function o(t){return"on"+t[0].toUpperCase()+t.substring(1)}function r(t,e,n,i){var a=e.filter(function(e){return!!e._model.ranges[t]}).map(function(e){return e._model.ranges[t]}),o=a.map(function(t){return Number(t.min)}).reduce(function(t,e){return isFinite(e)&&!isNaN(e)&&e<t?e:t},n),r=a.map(function(t){return Number(t.max)}).reduce(function(t,e){return isFinite(e)&&!isNaN(e)&&e>t?e:t},i);return{min:o,max:r}}function l(t,e){var n=Number.POSITIVE_INFINITY;return t.filter(function(t){return t.inRange(e.x,e.y)}).reduce(function(t,i){var a=i.getCenterPoint(),o=c.distanceBetweenPoints(e,a);return o<n?(t=[i],n=o):o===n&&t.push(i),t},[]).sort(function(t,e){var n=t.getArea(),i=e.getArea();return n>i||n<i?n-i:t._index-e._index}).slice(0,1)[0]}var s=t("chart.js");s="function"==typeof s?s:window.Chart;var c=s.helpers;e.exports={isValid:i,decorate:a,getEventHandlerName:o,getScaleLimits:r,getNearestItems:l}},{"chart.js":1}],4:[function(t,e,n){function i(t,e){s.isArray(t.annotations)&&t.annotations.forEach(function(t){t.transition(e).draw()})}function a(t){return t=s.configMerge(b,t),s.isArray(t.annotations)&&t.annotations.forEach(function(t){t.label=s.configMerge(g,t.label)}),t}function o(t,e){return t.filter(function(t){return!!h[t.type]}).map(function(t,n){var i=h[t.type],a=new i({_index:n,options:t,chartInstance:e,ctx:e.chart.ctx});return a.initialize(),a})}function r(t){var e=s.getRelativePosition(t,this.chart),n=c.getNearestItems(this.annotations,e),i=c.getEventHandlerName(t.type),a=(n||{}).options;n&&a[i]&&(t.stopImmediatePropagation(),t.preventDefault(),a[i].call(n,t))}var l=t("chart.js");l="function"==typeof l?l:window.Chart;var s=l.helpers,c=t("./helpers.js");l.Annotation=l.Annotation||{};var u="afterDraw",d="afterDatasetsDraw",f="beforeDatasetsDraw";l.Annotation.drawTimeOptions={afterDraw:u,afterDatasetsDraw:d,beforeDatasetsDraw:f},l.Annotation.Element=t("./element.js")(l);var h=l.Annotation.types={line:t("./types/line.js")(l),box:t("./types/box.js")(l)},b=l.Annotation.defaults={drawTime:u,events:[],annotations:[]},g=l.Annotation.labelDefaults={backgroundColor:"rgba(0,0,0,0.8)",fontFamily:l.defaults.global.defaultFontFamily,fontSize:l.defaults.global.defaultFontSize,fontStyle:"bold",fontColor:"#fff",xPadding:6,yPadding:6,cornerRadius:6,position:"center",xAdjust:0,yAdjust:0,enabled:!1,content:null},x={beforeInit:function(t){t.annotations=[],c.decorate(t,"buildScales",function(e){e(),Object.keys(t.scales).forEach(function(e){var n=t.scales[e];c.decorate(n,"determineDataLimits",function(i){if(i(),t.annotations){var a=c.getScaleLimits(e,t.annotations,n.min,n.max);"undefined"==typeof n.options.ticks.min&&"undefined"==typeof n.options.ticks.suggestedMin&&(n.min=a.min),"undefined"==typeof n.options.ticks.max&&"undefined"==typeof n.options.ticks.suggestedMax&&(n.max=a.max)}})})});var e=t.options.annotation||{};e.events&&(t._annotationEventHandler=r.bind(t),e.events.forEach(function(e){s.addEvent(t.chart.canvas,e,t._annotationEventHandler)}))},destroy:function(t){var e=t.annotations._config;e.events.length>0&&e.events.forEach(function(e){s.removeEvent(t.chart.canvas,e,t._annotationEventHandler)})},beforeUpdate:function(t){var e=t.options.annotation;e=a(e||{}),s.isArray(e.annotations)&&(t.annotations.forEach(function(e){e.destroy(t)}),t.annotations=o(e.annotations,t),t.annotations._config=e)},afterScaleUpdate:function(t){s.isArray(t.annotations)&&t.annotations.forEach(function(t){t.configure()})},afterDraw:function(t,e){var n=t.annotations._config;n.drawTime==u&&i(t,e)},afterDatasetsDraw:function(t,e){var n=t.annotations._config;n.drawTime==d&&i(t,e)},beforeDatasetsDraw:function(t,e){var n=t.annotations._config;n.drawTime==f&&i(t,e)}};e.exports=x,l.pluginService.register(x)},{"./element.js":2,"./helpers.js":3,"./types/box.js":5,"./types/line.js":6,"chart.js":1}],5:[function(t,e,n){var i=t("../helpers.js");e.exports=function(t){var e=t.Annotation.Element.extend({setDataLimits:function(){var t=this._model=this._model||{},e=this.options,n=this.chartInstance,a=n.scales[e.xScaleID],o=n.scales[e.yScaleID],r=n.chartArea;t.ranges={},a&&(min=i.isValid(e.xMin)?e.xMin:a.getPixelForValue(r.left),max=i.isValid(e.xMax)?e.xMax:a.getPixelForValue(r.right),t.ranges[e.xScaleID]={min:Math.min(min,max),max:Math.max(min,max)}),o&&(min=i.isValid(e.yMin)?e.yMin:o.getPixelForValue(r.bottom),max=i.isValid(e.yMax)?e.yMax:o.getPixelForValue(r.top),t.ranges[e.yScaleID]={min:Math.min(min,max),max:Math.max(min,max)})},configure:function(){var t=this._model=this._model||{},e=this.options,n=this.chartInstance,a=n.scales[e.xScaleID],o=n.scales[e.yScaleID],r=n.chartArea;t.clip={x1:r.left,x2:r.right,y1:r.top,y2:r.bottom};var l,s,c=r.left,u=r.top,d=r.right,f=r.bottom;a&&(l=i.isValid(e.xMin)?a.getPixelForValue(e.xMin):r.left,s=i.isValid(e.xMax)?a.getPixelForValue(e.xMax):r.right,c=Math.min(l,s),d=Math.max(l,s)),o&&(l=i.isValid(e.yMin)?o.getPixelForValue(e.yMin):r.bottom,s=i.isValid(e.yMax)?o.getPixelForValue(e.yMax):r.top,u=Math.min(l,s),f=Math.max(l,s)),t.left=c,t.top=u,t.right=d,t.bottom=f,t.borderColor=e.borderColor,t.borderWidth=e.borderWidth,t.backgroundColor=e.backgroundColor},inRange:function(t,e){return this._view&&t>=this._view.left&&t<=this._view.right&&e>=this._view.top&&e<=this._view.bottom},getCenterPoint:function(){return{x:(this._view.right+this._view.left)/2,y:(this._view.bottom+this._view.top)/2}},getWidth:function(){return Math.abs(this._view.right-this._view.left)},getHeight:function(){return Math.abs(this._view.bottom-this._view.top)},getArea:function(){return this.getWidth()*this.getHeight()},draw:function(){var t=this._view,e=this.ctx;e.save(),e.beginPath(),e.rect(t.clip.x1,t.clip.y1,t.clip.x2-t.clip.x1,t.clip.y2-t.clip.y1),e.clip(),e.lineWidth=t.borderWidth,e.strokeStyle=t.borderColor,e.fillStyle=t.backgroundColor;var n=t.right-t.left,i=t.bottom-t.top;e.fillRect(t.left,t.top,n,i),e.strokeRect(t.left,t.top,n,i)}});return e}},{"../helpers.js":3}],6:[function(t,e,n){var i=t("../helpers.js");e.exports=function(t){function e(t){var e=(t.x2-t.x1)/(t.y2-t.y1),n=t.x1||0;this.m=e,this.b=n,this.getX=function(i){return e*(i-t.y1)+n},this.getY=function(i){return(i-n)/e+t.y1},this.intersects=function(t,e,n){n=n||.001;var i=this.getY(t),a=this.getX(e);return(!isFinite(i)||Math.abs(e-i)<n)&&(!isFinite(a)||Math.abs(t-a)<n)}}function n(t,e,n,i,a){var l=t.line,s={},c=0,u=0;switch(!0){case t.mode==r&&"top"==t.labelPosition:u=a+t.labelYAdjust,c=e/2+t.labelXAdjust,s.y=t.y1+u,s.x=(isFinite(l.m)?l.getY(s.y):t.x1)-c;break;case t.mode==r&&"bottom"==t.labelPosition:u=n+a+t.labelYAdjust,c=e/2+t.labelXAdjust,s.y=t.y2-u,s.x=(isFinite(l.m)?l.getX(s.y):t.x1)-c;break;case t.mode==o&&"left"==t.labelPosition:c=i+t.labelXAdjust,u=-(n/2)+t.labelYAdjust,s.x=t.x1+c,s.y=l.getY(s.x)+u;break;case t.mode==o&&"right"==t.labelPosition:c=e+i+t.labelXAdjust,u=-(n/2)+t.labelYAdjust,s.x=t.x2-c,s.y=l.getY(s.x)+u;break;default:s.x=(t.x1+t.x2-e)/2+t.labelXAdjust,s.y=(t.y1+t.y2-n)/2+t.labelYAdjust}return s}var a=t.helpers,o="horizontal",r="vertical",l=t.Annotation.Element.extend({setDataLimits:function(){var t=this._model=a.clone(this._model)||{},e=this.options;t.ranges={},t.ranges[e.scaleID]={min:e.value,max:e.endValue||e.value}},configure:function(){var t,r,l=this._model=a.clone(this._model)||{},s=this.options,c=this.chartInstance,u=c.scales[s.scaleID];if(u&&(t=i.isValid(s.value)?u.getPixelForValue(s.value):NaN,r=i.isValid(s.endValue)?u.getPixelForValue(s.endValue):t),!isNaN(t)){var d=c.chartArea;l.clip={x1:d.left,x2:d.right,y1:d.top,y2:d.bottom},this.options.mode==o?(l.x1=d.left,l.x2=d.right,l.y1=t,l.y2=r):(l.y1=d.top,l.y2=d.bottom,l.x1=t,l.x2=r),l.line=new e(l),l.mode=s.mode,l.labelBackgroundColor=s.label.backgroundColor,l.labelFontFamily=s.label.fontFamily,l.labelFontSize=s.label.fontSize,l.labelFontStyle=s.label.fontStyle,l.labelFontColor=s.label.fontColor,l.labelXPadding=s.label.xPadding,l.labelYPadding=s.label.yPadding,l.labelCornerRadius=s.label.cornerRadius,l.labelPosition=s.label.position,l.labelXAdjust=s.label.xAdjust,l.labelYAdjust=s.label.yAdjust,l.labelEnabled=s.label.enabled,l.labelContent=s.label.content,ctx.font=a.fontString(l.labelFontSize,l.labelFontStyle,l.labelFontFamily);var f=ctx.measureText(l.labelContent).width,h=ctx.measureText("M").width,b=n(l,f,h,l.labelXPadding,l.labelYPadding);l.labelX=b.x-l.labelXPadding,l.labelY=b.y-l.labelYPadding,l.labelWidth=f+2*l.labelXPadding,l.labelHeight=h+2*l.labelYPadding,l.borderColor=s.borderColor,l.borderWidth=s.borderWidth,l.borderDash=s.borderDash||[],l.borderDashOffset=s.borderDashOffset||0}},inRange:function(t,e){var n=this._model||{};return n.line&&n.line.intersects(t,e,this.getHeight())},getCenterPoint:function(){return{x:(this._view.x2+this._view.x1)/2,y:(this._view.y2+this._view.y1)/2}},getWidth:function(){return Math.abs(this._view.right-this._view.left)},getHeight:function(){return this._view.borderWidth||1},getArea:function(){return Math.sqrt(Math.pow(this.getWidth(),2)+Math.pow(this.getHeight(),2))},draw:function(){var t=this._view,e=this.ctx;t.clip&&(e.save(),e.beginPath(),e.rect(t.clip.x1,t.clip.y1,t.clip.x2-t.clip.x1,t.clip.y2-t.clip.y1),e.clip(),e.lineWidth=t.borderWidth,e.strokeStyle=t.borderColor,e.setLineDash&&e.setLineDash(t.borderDash),e.lineDashOffset=t.borderDashOffset,e.beginPath(),e.moveTo(t.x1,t.y1),e.lineTo(t.x2,t.y2),e.stroke(),e.restore(),t.labelEnabled&&t.labelContent&&(e.beginPath(),e.rect(t.clip.x1,t.clip.y1,t.clip.x2-t.clip.x1,t.clip.y2-t.clip.y1),e.clip(),e.fillStyle=t.labelBackgroundColor,a.drawRoundedRectangle(e,t.labelX,t.labelY,t.labelWidth,t.labelHeight,t.labelCornerRadius),e.fill(),e.font=a.fontString(t.labelFontSize,t.labelFontStyle,t.labelFontFamily),e.fillStyle=t.labelFontColor,e.textAlign="center",e.textBaseline="middle",e.fillText(t.labelContent,t.labelX+t.labelWidth/2,t.labelY+t.labelHeight/2)))}});return l}},{"../helpers.js":3}]},{},[4]);