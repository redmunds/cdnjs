/*!
 * vimeo.ga.js | v0.4
 * Copyright (c) 2014 Sander Heilbron (http://www.sanderheilbron.nl)
 * MIT licensed
 */

(function(e){"use strict";function m(e){switch(o){case"gtm":dataLayer.push({event:"Vimeo",eventCategory:"Vimeo",eventAction:e,eventLabel:n,eventValue:undefined,eventNonInteraction:true});break;case"ua":ga("send","event","Vimeo",e,n,undefined,{nonInteraction:1});break;case"ga":_gaq.push(["_trackEvent","Vimeo",e,n,undefined,true]);break}}function g(e){if(e.origin.replace("https:","http:")!=="http://player.vimeo.com"||typeof o==="undefined"){return}var t=JSON.parse(e.data);switch(t.event){case"ready":b();break;case"playProgress":E(t.data);break;case"seek":if(s&&!p){m("Skipped video forward or backward");p=true}break;case"play":if(!l){m("Started video");l=true}else if(!h&&c){m("Resumed video");h=true}break;case"pause":w();break;case"finish":if(!d){m("Completed video");d=true}break}}function y(e,r){var i={method:e};if(r){i.value=r}t[0].contentWindow.postMessage(JSON.stringify(i),n)}function b(){y("addEventListener","play");y("addEventListener","seek");y("addEventListener","pause");y("addEventListener","finish");y("addEventListener","playProgress")}function w(){if(v<99&&!c){m("Paused video");c=true}}function E(e){v=Math.round(e.percent*100);if(!i){return}var t;if(v>24&&!u){t="Played video: 25%";u=true}if(v>49&&!a){t="Played video: 50%";a=true}if(v>74&&!f){t="Played video: 75%";f=true}if(t){m(t)}}if(!e("#vimeo-player").length){return}var t=e("#vimeo-player"),n=t.attr("src").split("?")[0],r=document.URL.split(":")[0],i=t.data("progress"),s=t.data("seek"),o,u=false,a=false,f=false,l=false,c=false,h=false,p=false,d=false,v=0;if(n.match(/^http/)===null){n=r+":"+n}if(typeof ga==="function"){o="ua"}if(typeof _gaq!=="undefined"&&typeof _gaq.push==="function"){o="ga"}if(typeof dataLayer!=="undefined"&&typeof dataLayer.push==="function"){o="gtm"}if(window.addEventListener){window.addEventListener("message",g,false)}else{window.attachEvent("onmessage",g,false)}})(jQuery)
